{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/2023/10/30/hello-world/","title":"Hello world","text":"<p>\u521d\u8bd5Mkdocs, Hello World!</p>"},{"location":"hardware/async_sram.en/","title":"Asynchronous SRAM","text":""},{"location":"hardware/async_sram.en/#features","title":"Features","text":"<p>Features of asynchronous SRAM:</p> <ol> <li>Simple interface: the controller gives the address and control signals, and the data is available after a fixed delay, no calibration is required</li> <li>MB level RAM available: single chip can provide KB to MB level RAM, larger capacity can be obtained by connecting multiple SRAMs in parallel</li> <li>High-speed asynchronous SRAM with latency in the 10ns range</li> </ol>"},{"location":"hardware/async_sram.en/#structure","title":"Structure","text":"<p>The asynchronous SRAM holds data internally as an array. For example, a 2048K x 16 asynchronous SRAM has 2048K rows, each row holds 16 bits of data, for a total of 2048\\mathrm{K} * 16\\mathrm{b} = 32 \\mathrm{Mb} of data.</p> <p>The structure of the asynchronous SRAM is shown in Figure 1. When the controller accesses the asynchronous SRAM, it gives a row address and the asynchronous SRAM reads a row of data. Since there are 2048K rows, the number of bits needed for the address is \\log_2(2048\\mathrm{K})=21, which corresponds to <code>A0-A20</code> in the figure below. The address is passed to <code>DECODER</code>, which takes the data to be accessed from the array and puts it in <code>COLUMN IO</code>.</p>    ![Async SRAM Diagram](async_sram_diagram.png){ width=\"400\" }   Asynchronous SRAM Diagram (Source ISSI Datasheet) <p>For read operations, the memory controller provides the address on <code>A0-A20</code>, reads the data through <code>DECODER</code> from <code>2048K x 16 MEMORY ARRAY</code> to <code>COLUMN IO</code>, and the control logic <code>CONTROL CIRCUIT</code> outputs the data to <code>I/O DATA CIRCUIT</code> according to the read operation (<code>WE#=1, OE#=0</code>).</p> <p>For write operations, the memory controller provides the address on <code>A0-A20</code>, the data to be written on <code>I/O</code>, and the byte enable on <code>UB#/LB#</code>. The asynchronous SRAM reads the existing data in the array from <code>MEMORY ARRAY</code>, combines <code>UB#/LB#</code> with <code>I/O</code>, calculates the new value, and writes it to memory. The <code>UB#</code> and <code>LB#</code> are byte enables (active-low) for high 8 bits and low 8 bits respectively. If the old data is <code>1234</code> and the value to be written by the memory controller is <code>5678</code>, then the value in memory is updated to</p> UB# LB# Result Description 0 0 5678 New Value 1 0 1278 Only low byte written 0 1 5634 Only high byte written 1 1 1234 Unchanged"},{"location":"hardware/async_sram.en/#interface","title":"Interface","text":"<p>Asynchronous SRAM exposes a single-port RAM interface that can only read or write at a time. A typical asynchronous SRAM includes the following signals:</p> <ol> <li>Address signal A: the bit width is determined by the depth, for example, 2048K depth corresponds to 21-bit address</li> <li>Data signal I/O: the bit width is equal to the width of SRAM, e.g. 8 or 16 bits</li> <li>Chip select CS# (or CE#): active-low, works when CS# is equal to 0</li> <li>Output enable OE#: active-low, SRAM output when OE# equals 0, SRAM input when OE# equals 1</li> <li>Write enable WE#: active-low, WE# equals 0 for write, WE# equals 1 for read</li> <li>Byte enable UB#/LB#: active-low, corresponding to two bytes, update when equal to 0, unchanged when equal to 1</li> </ol> <p>Some asynchronous SRAMs are 8 bits wide, where there is no byte enable signal.</p>"},{"location":"hardware/async_sram.en/#concatenation","title":"Concatenation","text":"<p>If you want a larger asynchronous SRAM, you can concatenate multiple asynchronous SRAMs. Concatenation can be done in two ways:</p> <p>One is to concatenate in width, e.g. concatenate two asynchronous SRAMs of the same depth and width of 16 to get an asynchronous SRAM of width 32:</p>    ![](async_sram_width_concat.png){ width=\"400\" }   Concatenate asynchronous SRAM in width <p>The address signal (A) and control signals (OE#, WE#, CE#) are connected to all asynchronous SRAMs, while the data signal (DQ) and byte enable signals (WE0-3#) are connected to different asynchronous SRAMs to form twice the data width.</p> <p>The other is to concatenate in the depth, keeping the width the same, to increase the storage capacity. For example, concatenate two asynchronous SRAMs to get an asynchronous SRAM with doubled depth. For each access, only one of the asynchronous SRAMs will be accessed, distinguished by the address.</p> <p>For example, to concatenate two asynchronous SRAMs with 21-bit addresses to get a asynchronous SRAM with 22-bit addresses, if the highest bit of the address is used to select which asynchronous SRAM to access, then you can set: <code>CS0#=CS# | A[21], CS1#=CS# | ~A[21]</code>, and the rest of the signals are connected to all the asynchronous SRAMs. When <code>CS#=1</code>, the output pins are in the high resistance state, so multiple chips can share a single data bus and only need to ensure that only one chip on the bus is outputting at the same time:</p>    ![](async_sram_depth_concat.png){ width=\"600\" }   Concatenate asynchronous SRAM in depth <p>In practice, it is possible to mix the two methods.</p>"},{"location":"hardware/async_sram.en/#timing","title":"Timing","text":""},{"location":"hardware/async_sram.en/#read-timing","title":"Read Timing","text":"<p>The asynchronous SRAM is called asynchronous because it has no clock signal. In this case, the read timing is reflected as the delay between the controller giving the address and the asynchronous SRAM giving the data. Take IS61/64WV204816ALL Asynchronous SRAM chip as an example, the read timing is shown in the following figure:</p>    ![](async_sram_read_timing.png){ width=\"600\" }   Read Timing of Asynchronous SRAM (Source ISSI Datasheet) <ul> <li>t_{RC}: read cycle time, the address remains unchanged during this time, Min 10ns</li> <li>t_{AA}: address access time, the data is given after the address change in t_{AA} time, Max 10ns</li> <li>t_{OHA}: output hold time, the data remains unchanged during this time, Min 2.5ns</li> </ul> <p>The output data is uncertain during the period between the end of t_{OHA} and the end of t_{AA}.</p>"},{"location":"hardware/async_sram.en/#write-timing","title":"Write timing","text":"<p>The write timing is more complicated, and there can be multiple write conditions, one of which is listed below:</p>    ![](async_sram_write_timing.png){ width=\"600\" }   Write timing of asynchronous SRAM (Source ISSI Datasheet) <p>The core of the write timing is the rising edge of <code>WE#</code>. Compared with this time point, there are the following important timing requirements:</p> <ul> <li>t_{WC}: The address needs to remain unchanged for t_{WC}, Min 10ns</li> <li>t_{AW}: The setup time of the address relative to the rising edge of <code>WE#</code>, Min 8ns</li> <li>t_{HA}: Hold time of the address relative to the rising edge of <code>WE#</code>, Min 0ns</li> <li>t_{PWE}: The time when <code>WE#</code> maintains 0, Min 8ns</li> <li>t_{SD}: Setup time of data relative to the rising edge of <code>WE#</code>, Min 6ns</li> <li>t_{HD}: Hold time of data relative to the rising edge of <code>WE#</code>, Min 0ns</li> <li>t_{SA}: Setup time of the address relative to the falling edge of <code>WE#</code>, Min 0ns</li> </ul>"},{"location":"hardware/async_sram.en/#sram-cell","title":"SRAM Cell","text":"<p>A typical SRAM Cell consists of 6 transistors, and the internal structure is as follows:</p>    ![6T SRAM Cell](async_sram_cell_6t.png){ width=\"400\" }   Internal Structure of 6T SRAM Cell (Source Berkeley EECS 151/251A Spring 2019) <p>Among them, M1 and M2 form an inverter, M3 and M4 form another inverter, and two inverters form the following equivalent circuit:</p>    ![SRAM Cell](async_sram_cell.png){ width=\"400\" }   Circuit in SRAM Cell (Source Berkeley EECS 151/251A Spring 2019) <p>This is a latch that can stably store 1 bit of data. The two transistors M5 and M6 are used for reading and writing. When WL is enabled, M5 and M6 are turned on, BL and Q are connected, and BLbar and Qbar are connected. At this point, you can read and write through BL and BLbar.</p>"},{"location":"hardware/async_sram.en/#acknowledgement","title":"Acknowledgement","text":"<p>The English version is kindly translated with the help of DeepL Translator and Google Translate.</p>"},{"location":"hardware/async_sram.zh/","title":"\u5f02\u6b65 SRAM","text":""},{"location":"hardware/async_sram.zh/#_1","title":"\u7279\u70b9","text":"<p>\u5f02\u6b65 SRAM \u7684\u7279\u70b9\uff1a</p> <ol> <li>\u63a5\u53e3\u7b80\u5355\uff1a\u63a7\u5236\u5668\u7ed9\u51fa\u5730\u5740\u548c\u63a7\u5236\u4fe1\u53f7\uff0c\u7ecf\u8fc7\u56fa\u5b9a\u5ef6\u8fdf\u540e\u5c31\u53ef\u4ee5\u5f97\u5230\u6570\u636e\uff0c\u4e0d\u9700\u8981\u6821\u51c6</li> <li>\u63d0\u4f9b MB \u7ea7\u522b\u7684 RAM\uff1a\u5355\u82af\u7247\u53ef\u4ee5\u63d0\u4f9b KB \u5230 MB \u7ea7\u522b\u7684 RAM\uff0c\u901a\u8fc7\u5e76\u8054\u591a\u4e2a SRAM\uff0c\u53ef\u4ee5\u5f97\u5230\u66f4\u5927\u7684\u5bb9\u91cf</li> <li>\u9ad8\u901f\u5f02\u6b65 SRAM \u5ef6\u8fdf\u5728 10ns \u7684\u7ea7\u522b</li> </ol>"},{"location":"hardware/async_sram.zh/#_2","title":"\u7ed3\u6784","text":"<p>\u5f02\u6b65 SRAM \u5185\u90e8\u4ee5\u4e00\u4e2a\u6570\u7ec4\u7684\u5f62\u5f0f\u4fdd\u5b58\u6570\u636e\u3002\u4f8b\u5982\u4e00\u4e2a 2048K x 16 \u7684\u5f02\u6b65 SRAM\uff0c\u6709 2048K \u4e2a\u884c\uff0c\u6bcf\u884c\u4fdd\u5b58\u4e86 16 \u4f4d\u7684\u6570\u636e\uff0c\u603b\u5171\u4fdd\u5b58\u4e86 2048\\mathrm{K} * 16\\mathrm{b} = 32 \\mathrm{Mb} \u7684\u6570\u636e\u3002</p> <p>\u5f02\u6b65 SRAM \u7684\u7ed3\u6784\u89c1\u56fe 1\u3002\u63a7\u5236\u5668\u5728\u8bbf\u95ee\u5f02\u6b65 SRAM \u7684\u65f6\u5019\uff0c\u7ed9\u51fa\u4e00\u4e2a\u884c\u7684\u5730\u5740\uff0c\u5f02\u6b65 SRAM \u5c31\u4f1a\u8bfb\u53d6\u4e00\u884c\u7684\u6570\u636e\u3002\u7531\u4e8e\u4e00\u5171\u6709 2048K \u4e2a\u884c\uff0c\u6240\u4ee5\u5730\u5740\u9700\u8981\u7684\u4f4d\u6570\u662f \\log_2(2048\\mathrm{K})=21\uff0c\u5bf9\u5e94\u4e0b\u56fe\u7684 <code>A0-A20</code>\u3002\u5730\u5740\u901a\u8fc7 <code>DECODER</code>\uff0c\u4ece\u6570\u7ec4\u4e2d\u53d6\u51fa\u8981\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u653e\u5230 <code>COLUMN IO</code> \u4e2d\u3002</p>    ![Async SRAM Diagram](async_sram_diagram.png){ width=\"400\" }   \u5f02\u6b65 SRAM \u7684\u7ed3\u6784\u6846\u56fe\uff08\u56fe\u6e90 ISSI Datasheet\uff09 <p>\u5bf9\u4e8e\u8bfb\u64cd\u4f5c\uff0c\u5185\u5b58\u63a7\u5236\u5668\u5728 <code>A0-A20</code> \u4e0a\u63d0\u4f9b\u5730\u5740\uff0c\u7ecf\u8fc7 <code>DECODER</code> \u4ece <code>2048K x 16 MEMORY ARRAY</code> \u4e2d\u8bfb\u53d6\u6570\u636e\u5230 <code>COLUMN IO</code>\uff0c\u63a7\u5236\u903b\u8f91 <code>CONTROL CIRCUIT</code> \u6839\u636e\u8bfb\u64cd\u4f5c\uff08<code>WE#=1, OE#=0</code>\uff09\uff0c\u628a\u6570\u636e\u8f93\u51fa\u5230 <code>I/O DATA CIRCUIT</code>\u3002</p> <p>\u5bf9\u4e8e\u5199\u64cd\u4f5c\uff0c\u5185\u5b58\u63a7\u5236\u5668\u5728 <code>A0-A20</code> \u4e0a\u63d0\u4f9b\u5730\u5740\uff0c\u5728 <code>I/O</code> \u4e0a\u63d0\u4f9b\u8981\u5199\u5165\u7684\u6570\u636e\uff0c\u5728 <code>UB#/LB#</code> \u4e0a\u63d0\u4f9b\u5b57\u8282\u4f7f\u80fd\u3002\u5f02\u6b65 SRAM \u4ece <code>MEMORY ARRAY</code> \u4e2d\u8bfb\u53d6\u6570\u7ec4\u4e2d\u73b0\u6709\u7684\u6570\u636e\uff0c\u7ed3\u5408 <code>UB#/LB#</code> \u4e0e <code>I/O</code>\uff0c\u8ba1\u7b97\u51fa\u65b0\u7684\u503c\uff0c\u518d\u5199\u5165\u5185\u5b58\u3002\u5176\u4e2d <code>UB#</code> \u548c <code>LB#</code> \u5206\u522b\u662f\u9ad8 8 \u4f4d\u548c\u4f4e 8 \u4f4d\u7684\u5b57\u8282\u4f7f\u80fd\uff08\u4f4e\u6709\u6548\uff09\u3002\u5982\u679c\u65e7\u6570\u636e\u662f <code>1234</code>\uff0c\u5185\u5b58\u63a7\u5236\u5668\u8981\u5199\u5165\u7684\u503c\u662f <code>5678</code>\uff0c\u90a3\u4e48\u5185\u5b58\u4e2d\u7684\u503c\u66f4\u65b0\u4e3a\uff1a</p> UB# LB# \u7ed3\u679c \u89e3\u91ca 0 0 5678 \u5168\u90e8\u91c7\u7528\u65b0\u503c 1 0 1278 \u4ec5\u5199\u5165\u4f4e\u5b57\u8282 0 1 5634 \u4ec5\u5199\u5165\u9ad8\u5b57\u8282 1 1 1234 \u5168\u90e8\u91c7\u7528\u65e7\u503c"},{"location":"hardware/async_sram.zh/#_3","title":"\u63a5\u53e3","text":"<p>\u5f02\u6b65 SRAM \u66b4\u9732\u4e86\u4e00\u4e2a\u5355\u53e3 RAM \u63a5\u53e3\uff0c\u540c\u65f6\u53ea\u80fd\u8fdb\u884c\u8bfb\u6216\u8005\u5199\u5176\u4e2d\u4e00\u4e2a\u64cd\u4f5c\u3002\u5178\u578b\u7684\u5f02\u6b65 SRAM \u5305\u62ec\u5982\u4e0b\u7684\u4fe1\u53f7\uff1a</p> <ol> <li>\u5730\u5740\u4fe1\u53f7 A\uff1a\u4f4d\u6570\u6839\u636e\u6df1\u5ea6\u51b3\u5b9a\uff0c\u4f8b\u5982 2048K \u7684\u6df1\u5ea6\u5bf9\u5e94 21 \u4f4d\u5730\u5740</li> <li>\u6570\u636e\u4fe1\u53f7 I/O\uff1a\u4f4d\u6570\u7b49\u4e8e\u5bbd\u5ea6\uff0c\u4f8b\u5982 8 \u6216 16 \u4f4d</li> <li>\u7247\u9009\u4fe1\u53f7 CS#\uff08\u6216\u8005\u53eb CE#\uff09\uff1a\u4f4e\u6709\u6548\uff0cCS# \u7b49\u4e8e 0 \u65f6\u5de5\u4f5c</li> <li>\u8f93\u51fa\u4f7f\u80fd\u4fe1\u53f7 OE#\uff1a\u4f4e\u6709\u6548\uff0cOE# \u7b49\u4e8e 0 \u65f6 SRAM \u8f93\u51fa\uff0cOE# \u7b49\u4e8e 1 \u65f6 SRAM \u8f93\u5165</li> <li>\u5199\u4f7f\u80fd\u4fe1\u53f7 WE#\uff1a\u4f4e\u6709\u6548\uff0cWE# \u7b49\u4e8e 0 \u65f6\u5199\uff0cWE# \u7b49\u4e8e 1 \u65f6\u8bfb</li> <li>\u5b57\u8282\u4f7f\u80fd\u4fe1\u53f7 UB#/LB#\uff1a\u4f4e\u6709\u6548\uff0c\u5bf9\u5e94\u4e24\u4e2a\u5b57\u8282\uff0c\u7b49\u4e8e 0 \u65f6\u66f4\u65b0\uff0c\u7b49\u4e8e 1 \u65f6\u4e0d\u53d8</li> </ol> <p>\u4e00\u4e9b\u5f02\u6b65 SRAM \u7684\u5bbd\u5ea6\u662f 8 \u4f4d\uff0c\u6b64\u65f6\u6ca1\u6709\u5b57\u8282\u4f7f\u80fd\u4fe1\u53f7\u3002</p>"},{"location":"hardware/async_sram.zh/#_4","title":"\u62fc\u63a5","text":"<p>\u5982\u679c\u60f3\u8981\u66f4\u5927\u5bb9\u91cf\u7684\u5f02\u6b65 SRAM\uff0c\u53ef\u4ee5\u62fc\u63a5\u591a\u4e2a\u5f02\u6b65 SRAM\u3002\u62fc\u63a5\u7684\u65f6\u5019\u53ef\u4ee5\u91c7\u7528\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <p>\u4e00\u79cd\u662f\u5728\u5bbd\u5ea6\u4e0a\u62fc\u63a5\uff0c\u4f8b\u5982\u62fc\u63a5\u4e24\u4e2a\u76f8\u540c\u6df1\u5ea6\u3001\u5bbd\u5ea6\u4e3a 16 \u7684\u5f02\u6b65 SRAM\uff0c\u5f97\u5230\u4e00\u4e2a\u5bbd\u5ea6\u4e3a 32 \u7684\u5f02\u6b65 SRAM\uff1a</p>    ![](async_sram_width_concat.png){ width=\"400\" }   \u5728\u5bbd\u5ea6\u4e0a\u62fc\u63a5\u5f02\u6b65 SRAM <p>\u5730\u5740\u4fe1\u53f7\uff08A\uff09\u548c\u63a7\u5236\u4fe1\u53f7\uff08OE#\u3001WE#\u3001CE#\uff09\u8fde\u63a5\u5230\u6240\u6709\u5f02\u6b65 SRAM\uff0c\u6570\u636e\u4fe1\u53f7\uff08DQ\uff09\u548c\u5b57\u8282\u4f7f\u80fd\u4fe1\u53f7\uff08WE0-3#\uff09\u5219\u8fde\u63a5\u5230\u4e0d\u540c\u7684\u5f02\u6b65 SRAM\uff0c\u5f62\u6210\u4e24\u500d\u7684\u6570\u636e\u5bbd\u5ea6\u3002</p> <p>\u53e6\u4e00\u79cd\u662f\u5728\u6df1\u5ea6\u4e0a\u62fc\u63a5\uff0c\u4fdd\u6301\u5bbd\u5ea6\u4e0d\u53d8\uff0c\u589e\u52a0\u5b58\u50a8\u5bb9\u91cf\u3002\u4f8b\u5982\u62fc\u63a5\u4e24\u4e2a\u5f02\u6b65 SRAM\uff0c\u5f97\u5230\u4e00\u4e2a\u6df1\u5ea6\u7ffb\u500d\u7684\u5f02\u6b65 SRAM\u3002\u6bcf\u6b21\u8bbf\u95ee\u7684\u65f6\u5019\uff0c\u53ea\u4f1a\u8bbf\u95ee\u5176\u4e2d\u4e00\u4e2a\u5f02\u6b65 SRAM\uff0c\u901a\u8fc7\u5730\u5740\u6765\u533a\u5206\u3002</p> <p>\u4f8b\u5982\u8981\u62fc\u63a5\u4e24\u4e2a 21 \u4f4d\u5730\u5740\u7684\u5f02\u6b65 SRAM\uff0c\u5f97\u5230\u4e00\u4e2a 22 \u4f4d\u5730\u5740\u7684\u5f02\u6b65 SRAM\uff0c\u5982\u679c\u7528\u5730\u5740\u7684\u6700\u9ad8\u4f4d\u6765\u9009\u62e9\u8bbf\u95ee\u54ea\u4e2a\u5f02\u6b65 SRAM\uff0c\u90a3\u4e48\u53ef\u4ee5\u8bbe\u5b9a\uff1a<code>CS0#=CS# | A[21], CS1#=CS# | ~A[21]</code>\uff0c\u5176\u4f59\u7684\u4fe1\u53f7\u90fd\u8fde\u63a5\u5230\u6240\u6709\u7684\u5f02\u6b65 SRAM\u3002\u7531\u4e8e\u5f02\u6b65 SRAM \u5728 <code>CS#=1</code> \u7684\u65f6\u5019\uff0c\u8f93\u51fa\u5f15\u811a\u5904\u4e8e\u9ad8\u963b\u6001\u72b6\u6001\uff0c\u6240\u4ee5\u591a\u4e2a\u82af\u7247\u53ef\u4ee5\u5171\u4eab\u4e00\u4e2a\u6570\u636e\u603b\u7ebf\uff0c\u53ea\u9700\u8981\u4fdd\u8bc1\u603b\u7ebf\u4e0a\u540c\u65f6\u53ea\u6709\u4e00\u4e2a\u82af\u7247\u5728\u8f93\u51fa\uff1a</p>    ![](async_sram_depth_concat.png){ width=\"600\" }   \u5728\u6df1\u5ea6\u4e0a\u62fc\u63a5\u5f02\u6b65 SRAM <p>\u5b9e\u8df5\u4e2d\uff0c\u53ef\u4ee5\u6df7\u5408\u4e24\u79cd\u62fc\u63a5\u65b9\u6cd5\u3002</p>"},{"location":"hardware/async_sram.zh/#_5","title":"\u65f6\u5e8f","text":""},{"location":"hardware/async_sram.zh/#_6","title":"\u8bfb\u65f6\u5e8f","text":"<p>\u5f02\u6b65 SRAM \u4e4b\u6240\u4ee5\u53eb\u505a\u5f02\u6b65\uff0c\u662f\u56e0\u4e3a\u5b83\u6ca1\u6709\u65f6\u949f\u4fe1\u53f7\u3002\u6b64\u65f6\u8bfb\u65f6\u5e8f\u4f53\u73b0\u4e3a\uff0c\u63a7\u5236\u5668\u7ed9\u51fa\u5730\u5740\uff0c\u5230\u5f02\u6b65 SRAM \u7ed9\u51fa\u6570\u636e\u7684\u5ef6\u8fdf\u3002\u4ee5 IS61/64WV204816ALL \u5f02\u6b65 SRAM \u82af\u7247 \u4e3a\u4f8b\uff0c\u8bfb\u65f6\u5e8f\u89c1\u4e0b\u56fe\uff1a</p>    ![](async_sram_read_timing.png){ width=\"600\" }   \u5f02\u6b65 SRAM \u8bfb\u65f6\u5e8f\uff08\u56fe\u6e90 ISSI Datasheet\uff09 <ul> <li>t_{RC}\uff1a\u8bfb\u5468\u671f\u65f6\u95f4\uff0c\u8fd9\u6bb5\u65f6\u95f4\u5185\u5730\u5740\u4e0d\u53d8\uff0cMin 10ns</li> <li>t_{AA}\uff1a\u5730\u5740\u8bbf\u95ee\u65f6\u95f4\uff0c\u6570\u636e\u5728\u5730\u5740\u6539\u53d8\u540e t_{AA} \u65f6\u95f4\u7ed9\u51fa\uff0cMax 10ns</li> <li>t_{OHA}\uff1aOutput Hold \u65f6\u95f4\uff0c\u8fd9\u6bb5\u65f6\u95f4\u5185\u6570\u636e\u4e0d\u53d8\uff0cMin 2.5ns</li> </ul> <p>\u5728 t_{OHA} \u7ed3\u675f\u5230 t_{AA} \u7ed3\u675f\u4e2d\u95f4\u7684\u8fd9\u6bb5\u65f6\u95f4\uff0c\u8f93\u51fa\u6570\u636e\u662f\u4e0d\u786e\u5b9a\u7684\u3002</p>"},{"location":"hardware/async_sram.zh/#_7","title":"\u5199\u65f6\u5e8f","text":"<p>\u5199\u65f6\u5e8f\u5219\u6bd4\u8f83\u590d\u6742\uff0c\u5e76\u4e14\u53ef\u4ee5\u6709\u591a\u79cd\u5199\u5165\u7684\u6761\u4ef6\uff0c\u4e0b\u9762\u5217\u51fa\u5176\u4e2d\u4e00\u79cd\uff1a</p>    ![](async_sram_write_timing.png){ width=\"600\" }   \u5f02\u6b65 SRAM \u5199\u65f6\u5e8f\uff08\u56fe\u6e90 ISSI Datasheet\uff09 <p>\u5199\u65f6\u5e8f\u4e2d\u6bd4\u8f83\u6838\u5fc3\u7684\u662f <code>WE#</code> \u7684\u4e0a\u5347\u6cbf\uff0c\u76f8\u5bf9\u8fd9\u4e2a\u65f6\u95f4\u70b9\uff0c\u6709\u5982\u4e0b\u6bd4\u8f83\u91cd\u8981\u65f6\u5e8f\u8981\u6c42\uff1a</p> <ul> <li>t_{WC}\uff1a\u5730\u5740\u9700\u8981\u4fdd\u6301 t_{WC} \u7684\u65f6\u95f4\u4e0d\u53d8\uff0cMin 10ns</li> <li>t_{AW}\uff1a\u5730\u5740\u76f8\u5bf9 <code>WE#</code> \u7684\u4e0a\u5347\u6cbf\u7684 Setup \u65f6\u95f4\uff0cMin 8ns</li> <li>t_{HA}\uff1a\u5730\u5740\u76f8\u5bf9 <code>WE#</code> \u7684\u4e0a\u5347\u6cbf\u7684 Hold \u65f6\u95f4\uff0cMin 0ns</li> <li>t_{PWE}\uff1a<code>WE#</code> \u7ef4\u6301 0 \u7684\u65f6\u95f4\uff0cMin 8ns</li> <li>t_{SD}\uff1a\u6570\u636e\u76f8\u5bf9 <code>WE#</code> \u7684\u4e0a\u5347\u6cbf\u7684 Setup \u65f6\u95f4\uff0cMin 6ns</li> <li>t_{HD}\uff1a\u6570\u636e\u76f8\u5bf9 <code>WE#</code> \u7684\u4e0a\u5347\u6cbf\u7684 Hold \u65f6\u95f4\uff0cMin 0ns</li> <li>t_{SA}\uff1a\u5730\u5740\u76f8\u5bf9 <code>WE#</code> \u7684\u4e0b\u964d\u6cbf\u7684 Setup \u65f6\u95f4\uff0cMin 0ns</li> </ul>"},{"location":"hardware/async_sram.zh/#sram-cell","title":"SRAM Cell","text":"<p>\u5178\u578b\u7684 SRAM Cell \u7531 6 \u4e2a\u6676\u4f53\u7ba1\u7ec4\u6210\uff0c\u5185\u90e8\u6784\u9020\u5982\u4e0b\u56fe\uff1a</p>    ![6T SRAM Cell](async_sram_cell_6t.png){ width=\"400\" }   6T SRAM Cell \u5185\u90e8\u6784\u9020\uff08\u56fe\u6e90 Berkeley EECS 151/251A Spring 2019\uff09 <p>\u5176\u4e2d M1 \u548c M2 \u7ec4\u6210\u4e00\u4e2a Inverter\uff0cM3 \u548c M4 \u7ec4\u6210\u4e00\u4e2a Inverter\uff0c\u4e24\u4e2a Inverter \u7ec4\u6210\u4e0b\u9762\u7684\u7b49\u4ef7\u7535\u8def\uff1a</p>    ![SRAM Cell](async_sram_cell.png){ width=\"400\" }   SRAM Cell \u7684\u7535\u8def\uff08\u56fe\u6e90 Berkeley EECS 151/251A Spring 2019\uff09 <p>\u8fd9\u5c31\u662f\u4e00\u4e2a latch\uff0c\u53ef\u4ee5\u7a33\u5b9a\u5730\u4fdd\u5b58 1 bit \u7684\u6570\u636e\u3002M5 \u548c M6 \u4e24\u4e2a\u6676\u4f53\u7ba1\u662f\u7528\u6765\u5b9e\u73b0\u8bfb\u548c\u5199\u7684\u3002\u5f53 WL \u4f7f\u80fd\u7684\u65f6\u5019\uff0cM5 \u548c M6 \u5bfc\u901a\uff0c\u6b64\u65f6 BL \u548c Q \u5bfc\u901a\uff0cBLbar \u548c Qbar \u5bfc\u901a\u3002\u6b64\u65f6\u5c31\u53ef\u4ee5\u901a\u8fc7 BL \u548c BLbar \u8fdb\u884c\u8bfb\u5199\u3002</p>"},{"location":"hardware/bus_protocol/","title":"\u603b\u7ebf\u534f\u8bae","text":""},{"location":"hardware/bus_protocol/#_2","title":"\u529f\u80fd","text":"<p>\u603b\u7ebf\u901a\u5e38\u7528\u4e8e\u8fde\u63a5 CPU \u548c\u5916\u8bbe\uff08\u5305\u62ec\u5185\u5b58\uff09\uff0c\u4e3a\u4e86\u66f4\u597d\u7684\u517c\u5bb9\u6027\u548c\u53ef\u590d\u7528\u6027\uff0c\u80fd\u5426\u8bbe\u8ba1\u4e00\u4e2a\u7edf\u4e00\u7684\u534f\u8bae\uff0c\u5176\u4e2d CPU \u5b9e\u73b0\u7684\u662f\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u65b9\uff08\u53c8\u79f0\u4e3a master\uff09\uff0c\u5916\u8bbe\u5b9e\u73b0\u7684\u662f\u63a5\u6536\u8bf7\u6c42\u7684\u4e00\u65b9\uff08\u53c8\u79f0\u4e3a slave\uff09\uff0c\u90a3\u4e48\u5982\u679c\u8981\u6dfb\u52a0\u5916\u8bbe\u3001\u6216\u8005\u66ff\u6362 CPU \u5b9e\u73b0\uff0c\u90fd\u4f1a\u53d8\u5f97\u6bd4\u8f83\u7b80\u5355\uff0c\u51cf\u5c11\u4e86\u8bb8\u591a\u9002\u914d\u7684\u5de5\u4f5c\u91cf\u3002</p> <p>\u4e00\u4e2a\u603b\u7ebf\u534f\u8bae\u9700\u8981\u5305\u62ec\u54ea\u4e9b\u5185\u5bb9\uff1f\u5bf9\u4e8e CPU \u6765\u8bf4\uff0c\u7a0b\u5e8f\u4f1a\u8bfb\u5199\u5185\u5b58\uff0c\u8bfb\u5199\u5185\u5b58\u5c31\u9700\u8981\u5c06\u4ee5\u4e0b\u51e0\u4e2a\u4fe1\u53f7\u4f20\u8f93\u5230\u5185\u5b58\uff1a</p> <ol> <li>\u5730\u5740\uff08<code>addr</code>\uff09\uff1a\u4f8b\u5982 32 \u4f4d\u5730\u5740</li> <li>\u6570\u636e\uff08<code>w_data</code> \u548c <code>r_data</code>\uff09\uff1a\u5206\u522b\u662f\u5199\u6570\u636e\u548c\u8bfb\u6570\u636e\uff0c\u5bbd\u5ea6\u901a\u5e38\u4e3a 32 \u4f4d\u6216 64 \u4f4d\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u53ef\u4ee5\u4f20\u8f93\u7684\u6570\u636e\u91cf</li> <li>\u8bfb\u8fd8\u662f\u5199\uff08<code>we</code>\uff09\uff1a\u9ad8\u8868\u793a\u5199\uff0c\u4f4e\u8868\u793a\u8bfb</li> <li>\u5b57\u8282\u6709\u6548\uff08<code>be</code>\uff09\uff1a\u4f8b\u5982\u4e3a\u4e86\u5b9e\u73b0\u5355\u5b57\u8282\u5199\uff0c\u867d\u7136 <code>w_data</code> \u53ef\u80fd\u662f 32 \u4f4d\u5bbd\uff0c\u4f46\u662f\u5b9e\u9645\u5199\u5165\u7684\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u5b57\u8282</li> </ol> <p>\u9664\u4e86\u8bf7\u6c42\u7684\u5185\u5bb9\u4ee5\u5916\uff0c\u4e3a\u4e86\u8868\u793a CPU \u60f3\u8981\u53d1\u9001\u8bf7\u6c42\uff0c\u8fd8\u9700\u8981\u6dfb\u52a0 <code>valid</code> \u4fe1\u53f7\uff1a\u9ad8\u8868\u793a\u53d1\u9001\u8bf7\u6c42\uff0c\u4f4e\u8868\u793a\u4e0d\u53d1\u9001\u8bf7\u6c42\u3002\u5f88\u591a\u65f6\u5019\uff0c\u5916\u8bbe\u7684\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u53ef\u80fd\u65e0\u6cd5\u4fdd\u8bc1\u6bcf\u4e2a\u5468\u671f\u90fd\u53ef\u4ee5\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u6b64\u5916\u8bbe\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a <code>ready</code> \u4fe1\u53f7\uff1a\u5f53 <code>valid=1 &amp;&amp; ready=1</code> \u7684\u65f6\u5019\uff0c\u53d1\u9001\u5e76\u5904\u7406\u8bf7\u6c42\uff1b\u5f53 <code>valid=1 &amp;&amp; ready=0</code> \u7684\u65f6\u5019\uff0c\u8868\u793a\u5916\u8bbe\u8fd8\u6ca1\u6709\u51c6\u5907\u597d\uff0c\u6b64\u65f6 CPU \u9700\u8981\u4e00\u76f4\u4fdd\u6301 <code>valid=1</code> \u4e0d\u53d8\uff0c\u7b49\u5230\u5916\u8bbe\u51c6\u5907\u597d\u540e\uff0c<code>valid=1 &amp;&amp; ready=1</code> \u8bf7\u6c42\u751f\u6548\u3002</p>"},{"location":"hardware/bus_protocol/#_3","title":"\u7b80\u6613\u603b\u7ebf\u534f\u8bae","text":"<p>\u7ed3\u5408\u4e0a\u6587\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u6613\u603b\u7ebf\u534f\u8bae\uff0c\u5206\u522b\u5f97\u5230 master \u548c slave \u7aef\u7684\u4fe1\u53f7\u5217\u8868\u3002\u7ea6\u5b9a\u5728\u547d\u540d\u7684\u65f6\u5019\u7528 <code>_o</code> \u8868\u793a\u8f93\u51fa\u3001<code>_i</code> \u8868\u793a\u8f93\u5165\uff0c\u90a3\u4e48 master \u7aef\uff08CPU \u7aef\uff09\u7684\u4fe1\u53f7\uff1a</p> <ol> <li><code>clock_i</code>\uff1a\u65f6\u949f\u8f93\u5165</li> <li><code>valid_o</code>\uff1a\u9ad8\u8868\u793a master \u60f3\u8981\u53d1\u9001\u8bf7\u6c42</li> <li><code>ready_i</code>\uff1a\u9ad8\u8868\u793a slave \u51c6\u5907\u597d\u5904\u7406\u8bf7\u6c42</li> <li><code>addr_o</code>\uff1amaster \u60f3\u8981\u8bfb\u5199\u7684\u5730\u5740</li> <li><code>we_o</code>\uff1amaster \u60f3\u8981\u8bfb\u8fd8\u662f\u5199</li> <li><code>data_o</code>\uff1amaster \u60f3\u8981\u5199\u5165\u7684\u6570\u636e</li> <li><code>be_o</code>\uff1amaster \u8bfb\u5199\u7684\u5b57\u8282\u4f7f\u80fd\uff0c\u7528\u4e8e\u5b9e\u73b0\u5355\u5b57\u8282\u5199\u7b49</li> <li><code>data_i</code>\uff1aslave \u63d0\u4f9b\u7ed9 master \u7684\u8bfb\u53d6\u7684\u6570\u636e</li> </ol> <p>\u9664\u4e86\u65f6\u949f\u90fd\u662f\u8f93\u5165\u4ee5\u5916\uff0c\u628a\u4e0a\u9762\u5176\u4f59\u7684\u4fe1\u53f7\u8f93\u5165\u3001\u8f93\u51fa\u5bf9\u79f0\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230 slave \u7aef\uff08\u5916\u8bbe\u7aef\uff09\u7684\u4fe1\u53f7\uff1a</p> <ol> <li><code>clock_i</code>\uff1a\u65f6\u949f\u8f93\u5165</li> <li><code>valid_i</code>\uff1a\u9ad8\u8868\u793a master \u60f3\u8981\u53d1\u9001\u8bf7\u6c42</li> <li><code>ready_o</code>\uff1a\u9ad8\u8868\u793a slave \u51c6\u5907\u597d\u5904\u7406\u8bf7\u6c42</li> <li><code>addr_i</code>\uff1amaster \u60f3\u8981\u8bfb\u5199\u7684\u5730\u5740</li> <li><code>we_i</code>\uff1amaster \u60f3\u8981\u8bfb\u8fd8\u662f\u5199</li> <li><code>data_i</code>\uff1amaster \u60f3\u8981\u5199\u5165\u7684\u6570\u636e</li> <li><code>be_i</code>\uff1amaster \u8bfb\u5199\u7684\u5b57\u8282\u4f7f\u80fd\uff0c\u7528\u4e8e\u5b9e\u73b0\u5355\u5b57\u8282\u5199\u7b49</li> <li><code>data_o</code>\uff1aslave \u63d0\u4f9b\u7ed9 master \u7684\u8bfb\u53d6\u7684\u6570\u636e</li> </ol> <p>\u4ee5\u4e0a\u9762\u7684\u603b\u7ebf\u534f\u8bae\u4e3a\u4f8b\uff0c\u7ed8\u5236\u51fa\u4e00\u4e2a\u53ef\u80fd\u7684\u6ce2\u5f62\u56fe\uff08\u4ee5 master \u7684\u4fe1\u53f7\u4e3a\u4f8b\uff09\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"clock\", wave: \"p.........\", node: \".abcdefgh\"},\n      { name: \"valid_o\", wave: \"0101.01..0\"},\n      { name: \"ready_i\", wave: \"010.101..0\"},\n      { name: \"addr_o\", wave: \"x=x=.x===x\", data: [\"0x01\", \"0x02\", \"0x03\", \"0x01\", \"0x02\"]},\n      { name: \"we_o\", wave: \"x1x0.x101x\"},\n      { name: \"data_o\", wave: \"x=xxxx=x=x\", data: [\"0x12\", \"0x56\", \"0x9a\"]},\n      { name: \"be_o\", wave: \"x=x=.x=x=x\", data: [\"0x1\", \"0x1\", \"0x1\", \"0x1\"]},\n      { name: \"data_i\", wave: \"xxxx=xx=xx\", data: [\"0x34\", \"0x12\"]},\n    ]\n}\n</code></pre> \u7b80\u6613\u603b\u7ebf\u534f\u8bae\u7684\u6ce2\u5f62\u56fe <ul> <li><code>a</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u8bf4\u660e\u6709\u8bf7\u6c42\u53d1\u751f\uff0c\u6b64\u65f6 <code>we_o=1</code> \u8bf4\u660e\u662f\u4e00\u4e2a\u5199\u64cd\u4f5c\uff0c\u5e76\u4e14\u5199\u5165\u5730\u5740\u662f <code>addr_o=0x01</code>\uff0c\u5199\u5165\u7684\u6570\u636e\u662f <code>data_o=0x12</code></li> <li><code>b</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=0 &amp;&amp; ready_i=0</code> \u8bf4\u660e\u65e0\u4e8b\u53d1\u751f</li> <li><code>c</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=1 &amp;&amp; ready_i=0</code> \u8bf4\u660e master \u60f3\u8981\u4ece\u5730\u5740 0x02\uff08<code>addr_o=0x02</code>\uff09\u8bfb\u53d6\u6570\u636e\uff08<code>we_o=0</code>\uff09\uff0c\u4f46\u662f slave \u6ca1\u6709\u63a5\u53d7\uff08<code>ready_i=0</code>\uff09</li> <li><code>d</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u8bf4\u660e\u6709\u8bf7\u6c42\u53d1\u751f\uff0cmaster \u4ece\u5730\u5740 0x02\uff08<code>addr_o=0x02</code>\uff09\u8bfb\u53d6\u6570\u636e\uff08<code>we_o=0</code>\uff09\uff0c\u8bfb\u53d6\u7684\u6570\u636e\u4e3a 0x34\uff08<code>data_i=0x34</code>\uff09</li> <li><code>e</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=0 &amp;&amp; ready_i=0</code> \u8bf4\u660e\u65e0\u4e8b\u53d1\u751f</li> <li><code>f</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u8bf4\u660e\u6709\u8bf7\u6c42\u53d1\u751f\uff0cmaster \u5411\u5730\u5740 0x03\uff08<code>addr_o=0x03</code>\uff09\u5199\u5165\u6570\u636e\uff08<code>we_o=1</code>\uff09\uff0c\u5199\u5165\u7684\u6570\u636e\u4e3a 0x56\uff08<code>data_i=0x56</code>\uff09</li> <li><code>g</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u8bf4\u660e\u6709\u8bf7\u6c42\u53d1\u751f\uff0cmaster \u4ece\u5730\u5740 0x01\uff08<code>addr_o=0x01</code>\uff09\u8bfb\u53d6\u6570\u636e\uff08<code>we_o=0</code>\uff09\uff0c\u8bfb\u53d6\u7684\u6570\u636e\u4e3a 0x12\uff08<code>data_i=0x12</code>\uff09</li> <li><code>h</code> \u5468\u671f\uff1a\u6b64\u65f6 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u8bf4\u660e\u6709\u8bf7\u6c42\u53d1\u751f\uff0cmaster \u5411\u5730\u5740 0x02\uff08<code>addr_o=0x02</code>\uff09\u5199\u5165\u6570\u636e\uff08<code>we_o=1</code>\uff09\uff0c\u5199\u5165\u7684\u6570\u636e\u4e3a 0x9a\uff08<code>data_i=0x9a</code>\uff09</li> </ul> <p>\u89c2\u5bdf\u4e0a\u9762\u7684\u6ce2\u5f62\uff0c\u5f97\u5230\u5982\u4e0b\u51e0\u6761\u89c4\u5f8b\uff1a</p> <ol> <li>master \u60f3\u8981\u53d1\u8d77\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5c31\u8bbe\u7f6e <code>valid_o=1</code>\uff1b\u5f53 slave \u53ef\u4ee5\u63a5\u53d7\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5c31\u8bbe\u7f6e <code>ready_i=1</code>\uff1b\u5728 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u65f6\u89c6\u4e3a\u4e00\u6b21\u8bf7\u6c42</li> <li>\u5982\u679c master \u53d1\u8d77\u8bf7\u6c42\uff0c\u540c\u65f6 slave \u4e0d\u80fd\u63a5\u6536\u8bf7\u6c42\uff0c\u5373 <code>valid_o=1 &amp;&amp; ready_i=0</code>\uff0c\u6b64\u65f6 master \u8981\u4fdd\u6301 <code>addr_o</code> <code>we_o</code> <code>data_o</code> \u548c <code>be_o</code> \u4e0d\u53d8\uff0c\u76f4\u5230\u8bf7\u6c42\u7ed3\u675f\uff0c\u8fd9\u4e00\u70b9\u975e\u5e38\u91cd\u8981</li> <li>\u5f53 master \u4e0d\u53d1\u8d77\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5373 <code>valid_o=0</code>\uff0c\u6b64\u65f6\u603b\u7ebf\u4e0a\u7684\u4fe1\u53f7\u90fd\u89c6\u4e3a\u65e0\u6548\u6570\u636e\uff0c\u4e0d\u5e94\u8be5\u8fdb\u884c\u5904\u7406\uff1b\u5bf9\u4e8e\u8bfb\u64cd\u4f5c\uff0c\u53ea\u6709\u5728 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u65f6 <code>data_i</code> \u4e0a\u7684\u6570\u636e\u662f\u6709\u6548\u7684</li> <li>\u53ef\u4ee5\u8fde\u7eed\u591a\u4e2a\u5468\u671f\u53d1\u751f\u8bf7\u6c42\uff0c\u5373 <code>valid_o=1 &amp;&amp; ready_i=1</code> \u8fde\u7eed\u591a\u4e2a\u5468\u671f\u7b49\u4e8e\u4e00\uff0c\u6b64\u65f6\u662f\u7406\u60f3\u60c5\u51b5\uff0c\u53ef\u4ee5\u8fbe\u5230\u603b\u7ebf\u6700\u9ad8\u7684\u4f20\u8f93\u901f\u5ea6</li> </ol> <p>\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7b80\u6613\u7684\u603b\u7ebf\u534f\u8bae\u3002</p>"},{"location":"hardware/bus_protocol/#wishbone","title":"Wishbone","text":"<p>Wishbone \u662f\u4e00\u4e2a\u5728\u5f00\u6e90\u793e\u533a\u5e7f\u6cdb\u4f7f\u7528\u7684\u603b\u7ebf\u534f\u8bae\uff0c\u5176\u5206\u4e3a\u591a\u4e2a\u7248\u672c\uff0c\u4e0b\u9762\u4ecb\u7ecd\u5176\u4e2d\u7684 Wishbone Classic Standard \u548c Wishbone Classic Pipelined\u3002</p>"},{"location":"hardware/bus_protocol/#wishbone-classic-standard","title":"Wishbone Classic Standard","text":"<p>\u6700\u7b80\u5355\u7684 Wishbone \u7248\u672c\u53eb\u505a Wishbone Classic Standard\uff0c\u5176\u8bbe\u8ba1\u601d\u8def\u548c\u4e0a\u9762\u7684\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u975e\u5e38\u76f8\u4f3c\uff0c\u4e0b\u9762\u5c06\u4e24\u8005\u8fdb\u884c\u4e00\u4e2a\u5bf9\u6bd4\u3002Wishbone Classic Standard \u534f\u8bae\u7684 master \u7aef\uff08CPU \u7aef\uff09\u7684\u4fe1\u53f7\uff1a</p> <ol> <li><code>CLK_I</code>: \u65f6\u949f\u8f93\u5165\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>clock_i</code></li> <li><code>STB_O</code>\uff1a\u9ad8\u8868\u793a master \u8981\u53d1\u9001\u8bf7\u6c42\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>valid_o</code></li> <li><code>ACK_I</code>\uff1a\u9ad8\u8868\u793a slave \u5904\u7406\u8bf7\u6c42\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>ready_i</code></li> <li><code>ADR_O</code>\uff1amaster \u60f3\u8981\u8bfb\u5199\u7684\u5730\u5740\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>addr_o</code></li> <li><code>WE_O</code>\uff1amaster \u60f3\u8981\u8bfb\u8fd8\u662f\u5199\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>we_o</code></li> <li><code>DAT_O</code>\uff1amaster \u60f3\u8981\u5199\u5165\u7684\u6570\u636e\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>data_o</code></li> <li><code>SEL_O</code>\uff1amaster \u8bfb\u5199\u7684\u5b57\u8282\u4f7f\u80fd\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>be_o</code></li> <li><code>DAT_I</code>\uff1amaster \u4ece slave \u8bfb\u53d6\u7684\u6570\u636e\uff0c\u5373\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4e2d\u7684 <code>data_i</code></li> <li><code>CYC_O</code>\uff1a\u603b\u7ebf\u7684\u4f7f\u80fd\u4fe1\u53f7\uff0c\u65e0\u5bf9\u5e94\u7684\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u4fe1\u53f7</li> </ol> <p>\u6b64\u5904\u5ffd\u7565\u4e86\u4e00\u4e9b\u53ef\u9009\u4fe1\u53f7\u3002\u9664\u4e86\u6700\u540e\u4e00\u4e2a <code>CYC_O</code>\uff0c\u5176\u4ed6\u7684\u4fe1\u53f7\u5176\u5b9e\u5c31\u662f\u4e0a\u6587\u7684\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u3002<code>CYC_O</code> \u7684\u53ef\u4ee5\u8ba4\u4e3a\u662f master \u60f3\u8981\u5360\u7528 slave \u7684\u603b\u7ebf\u63a5\u53e3\uff0c\u5728\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u666f\u4e0b\uff0c\u76f4\u63a5\u8ba4\u4e3a <code>CYC_O=STB_O</code>\u3002\u5b83\u7684\u7528\u9014\u662f\uff1a</p> <ol> <li>\u5360\u7528 slave \u7684\u603b\u7ebf\u63a5\u53e3\uff0c\u4e0d\u5141\u8bb8\u5176\u4ed6 master \u8bbf\u95ee</li> <li>\u7b80\u5316 interconnect \u7684\u5b9e\u73b0</li> </ol> <p>\u628a\u4e0a\u9762\u7b80\u6613\u603b\u7ebf\u534f\u8bae\u7684\u6ce2\u5f62\u56fe\u6539\u6210 Wishbone Classic Standard\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"CLK_I\", wave: \"p.........\", node: \".abcdefgh\"},\n      { name: \"CYC_O\", wave: \"0101.01..0\"},\n      { name: \"STB_O\", wave: \"0101.01..0\"},\n      { name: \"ACK_I\", wave: \"010.101..0\"},\n      { name: \"ADR_O\", wave: \"x=x=.x===x\", data: [\"0x01\", \"0x02\", \"0x03\", \"0x01\", \"0x02\"]},\n      { name: \"WE_O\", wave: \"x1x0.x101x\"},\n      { name: \"DAT_O\", wave: \"x=xxxx=x=x\", data: [\"0x12\", \"0x56\", \"0x9a\"]},\n      { name: \"SEL_O\", wave: \"x=x=.x=x=x\", data: [\"0x1\", \"0x1\", \"0x1\", \"0x1\"]},\n      { name: \"DAT_I\", wave: \"xxxx=xx=xx\", data: [\"0x34\", \"0x12\"]},\n    ]\n}\n</code></pre> Wishbone Classic Standard \u7684\u6ce2\u5f62\u56fe"},{"location":"hardware/bus_protocol/#wishbone-classic-pipelined","title":"Wishbone Classic Pipelined","text":"<p>Wishbone Classic Standard \u534f\u8bae\u975e\u5e38\u7b80\u5355\uff0c\u4f46\u662f\u4f1a\u9047\u5230\u4e00\u4e2a\u95ee\u9898\uff1a\u5047\u8bbe\u5b9e\u73b0\u7684\u662f\u4e00\u4e2a SRAM \u63a7\u5236\u5668\uff0c\u5b83\u7684\u8bfb\u64cd\u4f5c\u6709\u4e00\u4e2a\u5468\u671f\u7684\u5ef6\u8fdf\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u8fd9\u4e2a\u5468\u671f\u7ed9\u51fa\u5730\u5740\uff0c\u9700\u8981\u5728\u4e0b\u4e00\u4e2a\u5468\u671f\u624d\u53ef\u4ee5\u5f97\u5230\u7ed3\u679c\u3002\u5728 Wishbone Classic Standard \u4e2d\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e0b\u9762\u7684\u6ce2\u5f62\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"CLK_I\", wave: \"p.....\", node: \".abcd\"},\n      { name: \"CYC_O\", wave: \"01...0\"},\n      { name: \"STB_O\", wave: \"01...0\"},\n      { name: \"ACK_I\", wave: \"0.1010\"},\n      { name: \"ADR_O\", wave: \"x=.=.x\", data: [\"0x01\", \"0x02\"]},\n      { name: \"WE_O\", wave: \"x0...x\"},\n      { name: \"DAT_O\", wave: \"xxxxxx\"},\n      { name: \"SEL_O\", wave: \"x=...x\", data: [\"0x1\"]},\n      { name: \"DAT_I\", wave: \"xx=x=x\", data: [\"0x12\", \"0x34\"]},\n    ]\n}\n</code></pre> Wishbone Classic Standard \u5b9e\u73b0 SRAM \u63a7\u5236\u5668\u7684\u6ce2\u5f62\u56fe <ul> <li><code>a</code> \u5468\u671f\uff1amaster \u7ed9\u51fa\u8bfb\u5730\u5740 0x01\uff0c\u6b64\u65f6 SRAM \u63a7\u5236\u5668\u5f00\u59cb\u8bfb\u53d6\uff0c\u4f46\u662f\u6b64\u65f6\u6570\u636e\u8fd8\u6ca1\u6709\u8bfb\u53d6\u56de\u6765\uff0c\u6240\u4ee5 <code>ACK_I=0</code></li> <li><code>b</code> \u5468\u671f\uff1a\u6b64\u65f6 SRAM \u5b8c\u6210\u4e86\u8bfb\u53d6\uff0c\u628a\u8bfb\u53d6\u7684\u6570\u636e 0x12 \u653e\u5728 <code>DAT_I</code> \u5e76\u8bbe\u7f6e <code>ACK_I=1</code></li> <li><code>c</code> \u5468\u671f\uff1amaster \u7ed9\u51fa\u4e0b\u4e00\u4e2a\u8bfb\u5730\u5740 0x02\uff0cSRAM \u8981\u91cd\u65b0\u5f00\u59cb\u8bfb\u53d6</li> <li><code>d</code> \u5468\u671f\uff1a\u6b64\u65f6 SRAM \u5b8c\u6210\u4e86\u7b2c\u4e8c\u6b21\u8bfb\u53d6\uff0c\u628a\u8bfb\u53d6\u7684\u6570\u636e 0x34 \u653e\u5728 <code>DAT_I</code> \u5e76\u8bbe\u7f6e <code>ACK_I=1</code></li> </ul> <p>\u4ece\u6ce2\u5f62\u6765\u770b\uff0c\u529f\u80fd\u6ca1\u6709\u95ee\u9898\uff0c\u4f46\u662f\u6bcf\u4e24\u4e2a\u5468\u671f\u624d\u80fd\u8fdb\u884c\u4e00\u6b21\u8bfb\u64cd\u4f5c\uff0c\u53d1\u6325\u4e0d\u4e86\u6700\u9ad8\u7684\u6027\u80fd\u3002\u5728 <code>a</code> \u5468\u671f\u7ed9\u51fa\u7b2c\u4e00\u4e2a\u5730\u5740\uff0c\u5728 <code>b</code> \u5468\u671f\u5f97\u5230\u7b2c\u4e00\u4e2a\u6570\u636e\uff0c\u90a3\u4e48\u5982\u679c\u80fd\u5728 <code>b</code> \u5468\u671f\u7684\u65f6\u5019\u7ed9\u51fa\u7b2c\u4e8c\u4e2a\u5730\u5740\uff0c\u5c31\u53ef\u4ee5\u5728 <code>c</code> \u5468\u671f\u5f97\u5230\u7b2c\u4e8c\u4e2a\u6570\u636e\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6d41\u6c34\u7ebf\u5f0f\u7684\u6bcf\u4e2a\u5468\u671f\u8fdb\u884c\u4e00\u6b21\u8bfb\u64cd\u4f5c\u3002\u4f46\u662f\uff0cWishbone Classic Standard \u8981\u6c42 <code>b</code> \u5468\u671f\u65f6\u7b2c\u4e00\u6b21\u8bf7\u6c42\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u56e0\u6b64\u9700\u8981\u4fee\u6539\u534f\u8bae\uff0c\u6765\u5b9e\u73b0\u6d41\u6c34\u7ebf\u5f0f\u7684\u8bf7\u6c42\u3002</p> <p>\u5b9e\u73b0\u601d\u8def\u4e5f\u5f88\u7b80\u5355\uff1a\u65e2\u7136 Wishbone Classic Standard \u8ba4\u4e3a <code>b</code> \u5468\u671f\u65f6\uff0c\u7b2c\u4e00\u6b21\u8bf7\u6c42\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u90a3\u5c31\u8ba9\u7b2c\u4e00\u6b21\u8bf7\u6c42\u63d0\u524d\u5728 <code>a</code> \u5468\u671f\u5b8c\u6210\uff0c\u53ea\u4e0d\u8fc7\u5b83\u7684\u6570\u636e\u8981\u7b49\u5230 <code>b</code> \u5468\u671f\u624d\u80fd\u7ed9\u51fa\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u4e2a\u65f6\u5019\u7684\u4e00\u6b21\u8bfb\u64cd\u4f5c\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u5206\u6210\u4e86\u4e24\u90e8\u5206\uff1a\u9996\u5148\u662f master \u5411 slave \u53d1\u9001\u8bfb\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5728 <code>a</code> \u5468\u671f\u5b8c\u6210\uff1b\u7136\u540e\u662f slave \u5411 master \u53d1\u9001\u8bfb\u7684\u7ed3\u679c\uff0c\u8fd9\u4e2a\u7ed3\u679c\u5728 <code>b</code> \u5468\u671f\u5b8c\u6210\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u8fdb\u884c\u5982\u4e0b\u4fee\u6539\uff1a</p> <ul> <li>\u6dfb\u52a0 <code>STALL_I</code> \u4fe1\u53f7\uff1a<code>CYC_O=1 &amp;&amp; STB_O=1 &amp;&amp; STALL_I=0</code> \u8868\u793a\u8fdb\u884c\u4e00\u6b21\u8bfb\u8bf7\u6c42</li> <li>\u4fee\u6539 <code>ACK_I</code> \u4fe1\u53f7\u542b\u4e49\uff1a<code>CYC_O=1 &amp;&amp; STB_O=1 &amp;&amp; ACK_I=1</code> \u8868\u793a\u4e00\u6b21\u8bfb\u54cd\u5e94</li> </ul> <p>\u8fdb\u884c\u5982\u4e0a\u4fee\u6539\uff0c\u5c31\u5f97\u5230\u4e86 Wishbone Classic Pipelined \u603b\u7ebf\u534f\u8bae\u3002\u4e0a\u9762\u7684\u4e24\u6b21\u8fde\u7eed\u8bfb\u64cd\u4f5c\u6ce2\u5f62\u5982\u4e0b\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"CLK_I\", wave: \"p....\", node: \".abcd\"},\n      { name: \"CYC_O\", wave: \"01..0\"},\n      { name: \"STB_O\", wave: \"01.0.\"},\n      { name: \"STALL_I\", wave: \"0....\"},\n      { name: \"ACK_I\", wave: \"0.1.0\"},\n      { name: \"ADR_O\", wave: \"x==xx\", data: [\"0x01\", \"0x02\"]},\n      { name: \"WE_O\", wave: \"x0.xx\"},\n      { name: \"DAT_O\", wave: \"xxxxx\"},\n      { name: \"SEL_O\", wave: \"x=.xx\", data: [\"0x1\"]},\n      { name: \"DAT_I\", wave: \"xx==x\", data: [\"0x12\", \"0x34\"]},\n    ]\n}\n</code></pre> Wishbone Classic Pipelined \u5b9e\u73b0 SRAM \u63a7\u5236\u5668\u7684\u6ce2\u5f62\u56fe <ul> <li><code>a</code> \u5468\u671f\uff1amaster \u8bf7\u6c42\u8bfb\u5730\u5740 0x01\uff0cslave \u63a5\u6536\u8bfb\u8bf7\u6c42\uff08<code>STALL_O=0</code>\uff09</li> <li><code>b</code> \u5468\u671f\uff1aslave \u8fd4\u56de\u8bfb\u8bf7\u6c42\u7ed3\u679c 0x12\uff0c\u5e76\u8bbe\u7f6e <code>ACK_I=1</code>\uff1b\u540c\u65f6 master \u8bf7\u6c42\u8bfb\u5730\u5740 0x02\uff0cslave \u63a5\u6536\u8bfb\u8bf7\u6c42\uff08<code>STALL_O=0</code>\uff09</li> <li><code>c</code> \u5468\u671f\uff1aslave \u8fd4\u56de\u8bfb\u8bf7\u6c42\u7ed3\u679c 0x34\uff0c\u5e76\u8bbe\u7f6e <code>ACK_I=1</code>\uff1bmaster \u4e0d\u518d\u53d1\u8d77\u8bf7\u6c42\uff0c\u8bbe\u7f6e <code>STB_O=0</code></li> <li><code>d</code> \u5468\u671f\uff1a\u6240\u6709\u8bf7\u6c42\u5b8c\u6210\uff0cmaster \u8bbe\u7f6e <code>CYC_O=0</code></li> </ul> <p>\u8fd9\u6837\u5c31\u5229\u7528 Wishbone Classic Pipelined \u534f\u8bae\u5b9e\u73b0\u4e86\u4e00\u4e2a\u6bcf\u5468\u671f\u8fdb\u884c\u4e00\u6b21\u8bfb\u64cd\u4f5c\u7684 slave\u3002</p>"},{"location":"hardware/bus_protocol/#axi","title":"AXI","text":"<p>AXI \u603b\u7ebf\u534f\u8bae\u662f ARM \u516c\u53f8\u63d0\u51fa\u7684\u603b\u7ebf\u534f\u8bae\uff0c\u5728 ARM \u5904\u7406\u5668\u4ee5\u53ca Xilinx FPGA \u5185\u4f7f\u7528\u7684\u6bd4\u8f83\u5e7f\u6cdb\u3002</p> <p>AXI \u7684\u4fe1\u53f7\u5206\u6210\u4e94\u4e2a Channel\uff1a</p> <ol> <li>AW\uff08Address Write\uff09\uff1a\u5199\u8bf7\u6c42\u7684\u5730\u5740\u4f1a\u901a\u8fc7 AW Channel \u53d1\u9001\u7ed9 Slave</li> <li>W\uff08Write\uff09\uff1a\u5199\u8bf7\u6c42\u7684\u6570\u636e\u4f1a\u901a\u8fc7 W Channel \u53d1\u9001\u7ed9 Slave</li> <li>B\uff1a\u5199\u54cd\u5e94\u4f1a\u901a\u8fc7 B Channel \u53d1\u9001\u7ed9 Master</li> <li>AR\uff08Address Read\uff09\uff1a\u8bfb\u8bf7\u6c42\u7684\u5730\u5740\u4f1a\u901a\u8fc7 AR Channel \u53d1\u9001\u7ed9 Slave</li> <li>R\uff08Read\uff09\uff1a\u8bfb\u54cd\u5e94\u4f1a\u901a\u8fc7 R Channel \u53d1\u9001\u7ed9 Slave</li> </ol> <p>\u6bcf\u4e2a Channel \u90fd\u5305\u62ec <code>valid-ready</code> \u5f0f\u7684\u63e1\u624b\u4fe1\u53f7\uff0c\u5bf9\u4e8e AW\u3001W \u548c AR Channel\uff0cMaster \u662f\u53d1\u9001\u65b9\uff0cSlave \u662f\u63a5\u6536\u65b9\uff1b\u5bf9\u4e8e R \u548c B Channel\uff0cSlave \u662f\u53d1\u9001\u65b9\uff0cMaster \u662f\u63a5\u6536\u65b9\u3002</p> <p>\u53ef\u89c1 AXI \u7684\u8bbe\u8ba1\u628a\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u8fc7\u7a0b\u62c6\u5f00\uff0c\u5e76\u4e14\u5141\u8bb8\u603b\u7ebf\u4e0a\u540c\u65f6\u6709\u591a\u4e2a\u6b63\u5728\u8fdb\u884c\u7684\u8bf7\u6c42\uff1a\u4e0d\u7528\u7b49\u5f85\u54cd\u5e94\u56de\u6765\uff0c\u5c31\u53ef\u4ee5\u53d1\u9001\u65b0\u7684\u8bf7\u6c42\u3002\u56e0\u6b64 AXI \u53ef\u4ee5\u66f4\u597d\u5730\u5229\u7528\u5185\u5b58\u7684\u5e76\u884c\u5ea6\uff0c\u8fbe\u5230\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4ee3\u4ef7\u5c31\u662f\u8bbe\u8ba1\u66f4\u52a0\u590d\u6742\u3002</p> <p>\u4e3a\u4e86\u5b8c\u6210\u4e00\u6b21\u5199\u8bf7\u6c42\uff0cMaster \u9700\u8981\uff1a</p> <ol> <li>\u901a\u8fc7 AW Channel \u53d1\u9001\u8981\u5199\u5165\u7684\u5730\u5740\u3001\u5199\u5165\u7684\u957f\u5ea6\u7b49\u4fe1\u606f\u7ed9 Slave</li> <li>\u901a\u8fc7 W Channel \u53d1\u9001\u8981\u5199\u5165\u7684\u6570\u636e\uff0c\u652f\u6301 Burst\uff0c\u4e5f\u5c31\u662f\u4f7f\u7528\u591a\u4e2a\u5468\u671f\u5b8c\u6210\u4e00\u4e2a\u5199\u8bf7\u6c42\u7684\u6570\u636e\u4f20\u8f93</li> <li>\u5728 B Channel \u4e0a\u7b49\u5f85 Slave \u56de\u590d\u5199\u5165\u5b8c\u6210\u7684\u54cd\u5e94</li> </ol> <p>\u4e3a\u4e86\u5b8c\u6210\u4e00\u6b21\u8bfb\u8bf7\u6c42\uff0cMaster \u9700\u8981\uff1a</p> <ol> <li>\u901a\u8fc7 AR Channel \u53d1\u9001\u8981\u8bfb\u53d6\u7684\u5730\u5740\u3001\u8bfb\u53d6\u7684\u957f\u5ea6\u7b49\u4fe1\u606f\u7ed9 Slave</li> <li>\u5728 R Channel \u4e0a\u7b49\u5f85 Slave \u56de\u590d\u8bfb\u53d6\u7684\u6570\u636e\uff0c\u652f\u6301 Burst\uff0c\u4e5f\u5c31\u662f\u4f7f\u7528\u591a\u4e2a\u5468\u671f\u5b8c\u6210\u4e00\u4e2a\u8bfb\u54cd\u5e94\u7684\u6570\u636e\u4f20\u8f93</li> </ol> <p>\u7531\u4e8e AXI \u4e0a\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u591a\u4e2a\u8bf7\u6c42\uff0c\u4e3a\u4e86\u8ba9 Master \u53ef\u4ee5\u533a\u5206\u51fa B \u548c R Channel \u4e0a\u7684\u54cd\u5e94\u4e0e\u8bf7\u6c42\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u548c\u54cd\u5e94\u90fd\u9644\u5e26\u4e86\u4e00\u4e2a ID\uff0c\u90a3\u4e48 Master \u5728\u8bf7\u6c42\u4e2d\u9644\u5e26\u4e86\u4ec0\u4e48 ID\uff0cSlave \u5728\u54cd\u5e94\u7684\u65f6\u5019\uff0c\u4e5f\u8981\u9644\u5e26\u76f8\u540c\u7684 ID\u3002\u5bf9\u4e8e\u540c\u4e00\u4e2a ID \u7684\u8bf7\u6c42\uff0c\u5176\u987a\u5e8f\u662f\u53d7\u4fdd\u8bc1\u7684\u3002</p> <p>AXI \u6709\u652f\u6301\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u7684\u6269\u5c55\uff1aACE\uff0c\u5176\u5185\u5bb9\u5728 \u4e00\u81f4\u6027\u534f\u8bae \u4e2d\u4ecb\u7ecd\u3002</p>"},{"location":"hardware/bus_protocol/#tilelink","title":"TileLink","text":"<p>TileLink \u603b\u7ebf\u534f\u8bae\u662f SiFive \u516c\u53f8\u63d0\u51fa\u7684\u603b\u7ebf\u534f\u8bae\uff0c\u5728 Rocket Chip \u76f8\u5173\u7684\u9879\u76ee\u4e2d\u4f7f\u7528\u6bd4\u8f83\u5e7f\u6cdb\u3002\u6839\u636e TileLink Spec 1.8.0\uff0cTileLink \u5206\u4e3a\u4ee5\u4e0b\u4e09\u79cd\uff1a</p> <ul> <li>TL-UL: \u53ea\u652f\u6301\u8bfb\u5199\uff0c\u4e0d\u652f\u6301 burst\uff0c\u7c7b\u6bd4 AXI-Lite</li> <li>TL-UH\uff1a\u652f\u6301\u8bfb\u5199\uff0c\u539f\u5b50\u6307\u4ee4\uff0c\u9884\u53d6\uff0c\u652f\u6301 burst\uff0c\u7c7b\u6bd4 AXI+ATOP\uff08AXI5 \u5f15\u5165\u7684\u539f\u5b50\u64cd\u4f5c\uff09</li> <li>TL-C\uff1a\u5728 TL-UH \u57fa\u7840\u4e0a\u652f\u6301\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u7c7b\u6bd4 AXI+ACE/CHI</li> </ul> <p>\u672c\u6587\u4e3b\u8981\u8ba8\u8bba\u524d\u4e24\u79cd\uff0cTL-C \u7684\u5185\u5bb9\u5728 \u4e00\u81f4\u6027\u534f\u8bae \u4e2d\u4ecb\u7ecd\u3002</p>"},{"location":"hardware/bus_protocol/#_4","title":"\u63a5\u53e3","text":"<p>TileLink Uncached(TL-UL \u548c TL-UH) \u5305\u62ec\u4e86\u4e24\u4e2a channel\uff1a</p> <ul> <li>A channel: M-&gt;S \u53d1\u9001\u8bf7\u6c42\uff0c\u7c7b\u6bd4 AXI \u7684 AR/AW/W</li> <li>D channel: S-&gt;M \u53d1\u9001\u54cd\u5e94\uff0c\u7c7b\u6bd4 AXI \u7684 R/W</li> </ul> <p>\u56e0\u6b64 TileLink \u6bcf\u4e2a\u5468\u671f\u53ea\u80fd\u53d1\u9001\u8bfb\u6216\u8005\u5199\u7684\u8bf7\u6c42\uff0c\u800c AXI \u53ef\u4ee5\u540c\u65f6\u5728 AR \u548c AW channel \u4e0a\u53d1\u9001\u8bf7\u6c42\u3002</p> <p>\u4e00\u4e9b\u8bf7\u6c42\u7684\u4f8b\u5b50\uff1a</p> <ul> <li>\u8bfb\uff1aM-&gt;S \u5728 A channel \u4e0a\u53d1\u9001 Get\uff0cS-&gt;M \u5728 D channel \u4e0a\u53d1\u9001 AccessAckData</li> <li>\u5199\uff1aM-&gt;S \u5728 A channel \u4e0a\u53d1\u9001 PutFullData/PutPartialData\uff0cS-&gt;M \u5728 D channel \u662f\u53d1\u9001 AccessAck</li> <li>\u539f\u5b50\u64cd\u4f5c\uff1aM-&gt;S \u5728 A channel \u4e0a\u53d1\u9001 ArithmeticData/LogicalData\uff0cS-&gt;M \u5728 D channel \u4e0a\u53d1\u9001 AccessAckData</li> <li>\u9884\u53d6\u64cd\u4f5c\uff1aM-&gt;S \u5728 A channel \u4e0a\u53d1\u9001 Intent\uff0cS-&gt;M \u5728 D channel \u4e0a\u53d1\u9001 AccessAck</li> </ul>"},{"location":"hardware/bus_protocol/#axi_1","title":"\u548c AXI \u7684\u5bf9\u6bd4","text":"<p>\u548c AXI \u5bf9\u6bd4\uff0cTileLink \u628a\u8bfb\u548c\u5199\u8fdb\u884c\u4e86\u5408\u5e76\uff0c\u6240\u6709\u7684\u8bfb\u5199\u8bf7\u6c42\u90fd\u901a\u8fc7 A channel \u53d1\u9001\uff0c\u6240\u6709\u7684\u54cd\u5e94\u90fd\u901a\u8fc7 D channel \u56de\u590d\u3002\u8fd9\u6837\u505a\u7b80\u5316\u4e86\u786c\u4ef6\u7684\u5b9e\u73b0\uff0c\u4f46\u5982\u679c CPU \u5e0c\u671b\u540c\u65f6\u8fdb\u884c\u5927\u91cf\u7684\u8bfb\u5199\uff0c\u53ef\u80fd AXI \u53ef\u4ee5\u5b9e\u73b0\u66f4\u9ad8\u7684\u6027\u80fd\u3002</p> <p>\u4e0b\u9762\u5206\u6790 TileLink \u548c AXI \u534f\u8bae\u7684\u6865\u63a5\u6a21\u5757\u7684\u5b9e\u73b0\u65b9\u6cd5\u3002</p> <p>\u9996\u5148\u9488\u5bf9 AXI4ToTL \u6a21\u5757\u7684\u4f8b\u5b50\uff0c\u6765\u5206\u6790\u4e00\u4e0b\u5982\u4f55\u628a\u4e00\u4e2a AXI4 Master \u8f6c\u6362\u4e3a TileLink\u3002</p> <p>\u9488\u5bf9 AXI4 \u548c TileLink \u7684\u533a\u522b\u8fdb\u884c\u8bbe\u8ba1\uff1a\u4e00\u4e2a\u662f\u8bfb\u5199 channel \u5408\u5e76\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u9700\u8981\u4e00\u4e2a Arbiter\uff1b\u5176\u6b21 AXI4 \u4e2d AW \u548c W \u662f\u5206\u5f00\u7684\uff0c\u8fd9\u91cc\u4e5f\u9700\u8981\u8fdb\u884c\u5408\u5e76\u3002\u8fd9\u4e2a\u6a21\u5757\u5e76\u4e0d\u8003\u8651 Burst \u7684\u60c5\u51b5\uff0c\u800c\u662f\u7531 AXI4Fragmenter \u6765\u8fdb\u884c\u62c6\u5206\uff0c\u5373\u6dfb\u52a0\u82e5\u5e72\u4e2a AW beat\uff0c\u548c W \u8fdb\u884c\u914d\u5bf9\u3002</p> <p>\u5177\u4f53\u5230\u4ee3\u7801\u5b9e\u73b0\u4e0a\uff0c\u9996\u5148\u628a AR channel \u5bf9\u5e94\u5230 \u5230 A channel \u4e0a\uff1a</p> <pre><code>val r_out = Wire(out.a)\nr_out.valid := in.ar.valid\nr_out.bits :&lt;= edgeOut.Get(r_id, r_addr, r_size)._2\n</code></pre> <p>\u7136\u540e AW+W channel \u4e5f\u8fde\u63a5 \u5230 A channel\uff0c\u7531\u4e8e\u4e0d\u7528\u8003\u8651 burst \u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u5728 aw \u548c w \u540c\u65f6 valid \u7684\u65f6\u5019\u624d\u8ba4\u4e3a\u6709\u8bf7\u6c42\u3002</p> <pre><code>val w_out = Wire(out.a)\nin.aw.ready := w_out.ready &amp;&amp; in.w.valid &amp;&amp; in.w.bits.last\nin.w.ready  := w_out.ready &amp;&amp; in.aw.valid\nw_out.valid := in.aw.valid &amp;&amp; in.w.valid\nw_out.bits :&lt;= edgeOut.Put(w_id, w_addr, w_size, in.w.bits.data, in.w.bits.strb)._2\n</code></pre> <p>\u4e3a\u4e86\u533a\u5206\u8bf7\u6c42\u7684\u7c7b\u578b\uff0c\u8bfb\u5199\u7684 id \u589e\u52a0\u4e86\u82e5\u5e72\u4f4d\uff0c\u6700\u4f4e\u4f4d 0 \u8868\u793a\u8bfb\uff0c1 \u8868\u793a\u5199\uff0c\u5269\u4e0b\u51e0\u4f4d\u662f\u8bf7\u6c42\u7f16\u53f7\uff0c\u8fd9\u6837\u53d1\u51fa\u53bb\u7684\u662f\u4e0d\u540c id \u7684\u591a\u4e2a\u8bf7\u6c42\u3002</p> <p>\u7136\u540e\uff0c\u628a\u8bfb\u548c\u5199\u7684 A channel \u8fde\u63a5\u5230 Arbiter \u4e0a\uff1a</p> <pre><code>TLArbiter(TLArbiter.roundRobin)(out.a, (UInt(0), r_out), (in.aw.bits.len, w_out))\n</code></pre> <p>\u5176\u4f59\u7684\u90e8\u5206\u5219\u662f\u5bf9 D channel \u8fdb\u884c\u5224\u65ad\uff0c\u6709\u6570\u636e\u7684\u8f6c\u7ed9 R channel\uff0c\u6ca1\u6709\u6570\u636e\u7684\u8f6c\u7ed9 B channel\uff1a</p> <pre><code>out.d.ready := Mux(d_hasData, ok_r.ready, ok_b.ready)\nok_r.valid := out.d.valid &amp;&amp; d_hasData\nok_b.valid := out.d.valid &amp;&amp; !d_hasData\n</code></pre> <p>\u6700\u540e\u5904\u7406\u4e86\u4e00\u4e0b TileLink \u548c AXI4 \u5bf9\u5199\u8bf7\u6c42\u8fd4\u56de\u786e\u8ba4\u7684\u533a\u522b\uff1aTileLink \u4e2d\uff0c\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a burst beat \u5c31\u8fd4\u56de\u786e\u8ba4\uff0c\u800c AXI4 \u9700\u8981\u5728\u6700\u540e\u4e00\u4e2a burst beat \u4e4b\u540e\u8fd4\u56de\u786e\u8ba4\u3002</p> <p>\u518d\u6765\u770b\u4e00\u4e0b\u53cd\u8fc7\u6765\u7684\u8f6c\u6362\uff0c\u5373\u4ece TileLink Master \u5230 AXI\u3002\u7531\u4e8e TileLink \u540c\u65f6\u53ea\u80fd\u8fdb\u884c\u8bfb\u6216\u8005\u5199\uff0c\u6240\u4ee5\u5b83\u9996\u5148\u505a\u4e86\u4e00\u4e2a\u865a\u6784\u7684 arw channel\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5408\u5e76\u4e86 ar \u548c aw channel \u7684 AXI4\uff0c\u8fd9\u4e2a\u8bbe\u8ba1\u5728 SpinalHDL \u7684\u4ee3\u7801\u4e2d\u4e5f\u80fd\u770b\u5230\u3002\u7136\u540e\u518d\u6839\u636e\u662f\u5426\u662f\u5199\u5165\uff0c\u5206\u522b\u8fde\u63a5\u5230 ar \u548c aw channel\uff1a</p> <pre><code>val queue_arw = Queue.irrevocable(out_arw, entries=depth, flow=combinational)\nout.ar.bits := queue_arw.bits\nout.aw.bits := queue_arw.bits\nout.ar.valid := queue_arw.valid &amp;&amp; !queue_arw.bits.wen\nout.aw.valid := queue_arw.valid &amp;&amp;  queue_arw.bits.wen\nqueue_arw.ready := Mux(queue_arw.bits.wen, out.aw.ready, out.ar.ready)\n</code></pre> <p>\u8fd9\u91cc\u5904\u7406\u4e86 aw \u548c w \u7684 valid \u4fe1\u53f7\uff1a</p> <pre><code>in.a.ready := !stall &amp;&amp; Mux(a_isPut, (doneAW || out_arw.ready) &amp;&amp; out_w.ready, out_arw.ready)\nout_arw.valid := !stall &amp;&amp; in.a.valid &amp;&amp; Mux(a_isPut, !doneAW &amp;&amp; out_w.ready, Bool(true))\nout_w.valid := !stall &amp;&amp; in.a.valid &amp;&amp; a_isPut &amp;&amp; (doneAW || out_arw.ready)\n</code></pre> <p>\u8fd9\u6837\u505a\u7684\u539f\u56e0\u662f\uff0c\u5728 TileLink \u4e2d\uff0c\u6bcf\u4e2a burst \u90fd\u662f\u4e00\u4e2a a channel \u4e0a\u7684\u8bf7\u6c42\uff0c\u800c AXI4 \u4e2d\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a burst \u6709 aw \u8bf7\u6c42\uff0c\u6240\u6709 burst \u90fd\u6709 w \u8bf7\u6c42\uff0c\u56e0\u6b64\u8fd9\u91cc\u7528 doneAW \u4fe1\u53f7\u6765\u8fdb\u884c\u533a\u5206\u3002</p> <p>\u63a5\u7740\uff0c\u8981\u628a b \u548c r channel \u4e0a\u7684\u7ed3\u679c\u8fde\u63a5\u5230 d channel\uff0c\u6839\u636e\u4e0a\u9762\u7684\u7ecf\u9a8c\uff0c\u8fd9\u91cc \u53c8\u662f\u4e00\u4e2a arbitration\uff1a</p> <pre><code>val r_wins = (out.r.valid &amp;&amp; b_delay =/= UInt(7)) || r_holds_d\nout.r.ready := in.d.ready &amp;&amp; r_wins\nout.b.ready := in.d.ready &amp;&amp; !r_wins\nin.d.valid := Mux(r_wins, out.r.valid, out.b.valid)\n</code></pre> <p>\u6700\u540e\u8fd8\u5904\u7406\u4e86\u4e00\u4e0b\u8bf7\u6c42\u548c\u7ed3\u679c\u987a\u5e8f\u7684\u95ee\u9898\u3002</p>"},{"location":"hardware/cache_coherence_protocol/","title":"\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae","text":"<p>\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u7684\u573a\u666f\u662f\uff0c\u591a\u6838 CPU \u4e2d\uff0c\u6bcf\u4e2a\u6838\u5fc3\u90fd\u6709\u81ea\u5df1\u7684\u7f13\u5b58\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u8fd9\u4e9b\u7f13\u5b58\u7684\u6570\u636e\u4e00\u81f4\uff0c\u8bbe\u8ba1\u4e86\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#_2","title":"\u7406\u8bba\u5206\u6790","text":"<p>\u9996\u5148\u4ece\u7406\u8bba\u7684\u89d2\u5ea6\uff0c\u5206\u6790\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#write-invalidate-write-update","title":"Write-invalidate \u548c Write-update","text":"<p>\u6700\u57fa\u7840\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u601d\u60f3\u6709\u4e24\u79cd\uff1a</p> <ol> <li>Write-invalidate\uff1a\u5199\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u5c06\u5176\u4ed6 Cache \u4e2d\u8fd9\u6761 Cache Line \u8bbe\u4e3a Invalid</li> <li>Write-update\uff1a\u5199\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u628a\u65b0\u7684\u7ed3\u679c\u5199\u5165\u5230\u6709\u8fd9\u6761 Cache Line \u7684\u5176\u4ed6 Cache</li> </ol>"},{"location":"hardware/cache_coherence_protocol/#write-once","title":"Write-once \u534f\u8bae","text":"<p>Write-once \u534f\u8bae\u5b9a\u4e49\u4e86\u56db\u4e2a\u72b6\u6001\uff1a</p> <ol> <li>Invalid\uff1a\u8868\u793a\u8fd9\u4e2a\u5757\u4e0d\u5408\u6cd5</li> <li>Valid\uff1a\u8868\u793a\u8fd9\u4e2a\u5757\u5408\u6cd5\uff0c\u5e76\u53ef\u80fd\u662f\u5171\u4eab\u7684\uff0c\u540c\u65f6\u6570\u636e\u6ca1\u6709\u4fee\u6539</li> <li>Reserved\uff1a\u8868\u793a\u8fd9\u4e2a\u5757\u5408\u6cd5\uff0c\u4e0d\u662f\u5171\u4eab\u7684\uff0c\u540c\u65f6\u6570\u636e\u6ca1\u6709\u66f4\u6539</li> <li>Dirty\uff1a\u8868\u793a\u8fd9\u4e2a\u5757\u5408\u6cd5\uff0c\u4e0d\u662f\u5171\u4eab\u7684\uff0c\u6570\u636e\u505a\u4e86\u4fee\u6539\uff0c\u548c\u5185\u5b58\u4e0d\u540c\u3002</li> </ol> <p>\u53ef\u89c1\uff0c\u5f53\u4e00\u4e2a\u7f13\u5b58\u72b6\u6001\u5728 R \u6216\u8005 D\uff0c\u5176\u4ed6\u7f13\u5b58\u53ea\u80fd\u662f I\uff1b\u800c\u7f13\u5b58\u72b6\u6001\u662f V \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\u7f13\u5b58\u5728 V \u72b6\u6001\u3002</p> <p>Write-once \u534f\u8bae\u7684\u7279\u70b9\u662f\uff0c\u7b2c\u4e00\u6b21\u5199\u7684\u65f6\u5019\uff0c\u4f1a\u5199\u5165\u5230\u5185\u5b58\uff08\u7c7b\u4f3c Write-through\uff09\uff0c\u8fde\u7eed\u5199\u5165\u5219\u53ea\u5199\u5230\u7f13\u5b58\u4e2d\uff0c\u7c7b\u4f3c Write-back\u3002</p> <p>\u5f53 Read hit \u7684\u65f6\u5019\uff0c\u72b6\u6001\u4e0d\u53d8\u3002</p> <pre><code>Read hit: The information is supplied by the current cache. No state\nchange.\n</code></pre> <p>\u5f53 Read miss \u7684\u65f6\u5019\uff0c\u4f1a\u67e5\u770b\u6240\u6709\u7f13\u5b58\uff0c\u5982\u679c\u6709\u5176\u4ed6\u7f13\u5b58\u5904\u4e8e Valid/Reserved/Dirty \u72b6\u6001\uff0c\u5c31\u4ece\u5176\u4ed6\u7f13\u5b58\u5904\u8bfb\u53d6\u6570\u636e\uff0c\u7136\u540e\u8bbe\u4e3a Valid\uff0c\u5176\u4ed6\u7f13\u5b58\u4e5f\u8bbe\u4e3a Valid\u3002\u5982\u679c\u5176\u4ed6\u7f13\u5b58\u5904\u4e8e Dirty \u72b6\u6001\uff0c\u8fd8\u8981\u628a\u6570\u636e\u5199\u5165\u5185\u5b58\u3002</p> <pre><code>Read miss: The data is read from main memory. The read is snooped by\nother caches; if any of them have the line in the Dirty state, the read\nis interrupted long enough to write the data back to memory before it is\nallowed to continue. Any copies in the Dirty or Reserved states are set\nto the Valid state.\n</code></pre> <p>\u5f53 Write hit \u7684\u65f6\u5019\uff0c\u5982\u679c\u662f Valid \u72b6\u6001\uff0c\u9996\u5148\u5199\u5165\u5185\u5b58\uff0c\u628a\u5176\u4ed6 Cache \u90fd\u8bbe\u4e3a Invalid\uff0c\u8fdb\u5165 Reserved \u72b6\u6001\uff0c\u8fd9\u610f\u5473\u7740\u7b2c\u4e00\u6b21\u5199\u662f Write-through\u3002\u5982\u679c\u662f Reserved/Dirty \u72b6\u6001\uff0c\u5219\u4e0d\u4fee\u6539\u5185\u5b58\uff0c\u8fdb\u5165 Dirty \u72b6\u6001\uff0c\u8fd9\u8868\u793a\u540e\u7eed\u7684\u5199\u5165\u90fd\u662f Write-back\u3002</p> <pre><code>Write hit: If the information in the cache is in Dirty or Reserved\nstate, the cache line is updated in place and its state is set to Dirty\nwithout updating memory. If the information is in Valid state, a\nwrite-through operation is executed updating the block and the memory\nand the block state is changed to Reserved. Other caches snoop the write\nand set their copies to Invalid.\n</code></pre> <p>\u5f53 Write miss \u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u884c\u4e3a Wikipedia \u4e0a\u548c\u4e0a\u8bfe\u8bb2\u7684\u4e0d\u4e00\u6837\u3002\u6309\u7167 Wikipedia \u7684\u8bf4\u6cd5\uff0c\u9996\u5148\u6309\u7167 Read miss \u5904\u7406\uff0c\u518d\u6309\u7167 Write hit \u5904\u7406\uff0c\u7c7b\u4f3c\u4e8e Write Allocate \u7684\u601d\u8def\u3002\u5982\u679c\u662f\u8fd9\u6837\u7684\u8bdd\uff0c\u90a3\u4e48\u9996\u5148\u4ece\u5176\u4ed6\u7f13\u5b58\u6216\u8005\u5185\u5b58\u8bfb\u53d6\u6570\u636e\uff0c\u7136\u540e\u628a\u5176\u4ed6\u7f13\u5b58\u90fd\u8bbe\u4e3a Invalid\uff0c\u628a\u66f4\u65b0\u540e\u7684\u6570\u636e\u5199\u5165\u5185\u5b58\uff0c\u8fdb\u5165 Reserved \u72b6\u6001\u3002\u76f8\u5f53\u4e8e Write miss \u7684\u65f6\u5019\uff0c\u4e5f\u662f\u6309\u7167 Write-through \u5b9e\u73b0\u3002</p> <pre><code>Write miss: A partial cache line write is handled as a read miss (if\nnecessary to fetch the unwritten portion of the cache line) followed by\na write hit. This leaves all other caches in the Invalid state, and the\ncurrent cache in the Reserved state.\n</code></pre> <p>\u6559\u6750\u4e0a\u5219\u662f Write miss \u7684\u65f6\u5019\u6309\u7167 Write-back \u5904\u7406\u3002\u5982\u679c\u5176\u4ed6\u7f13\u5b58\u90fd\u662f Invalid \u65f6\uff0c\u4ece\u5185\u5b58\u91cc\u8bfb\u53d6\u6570\u636e\uff0c\u7136\u540e\u5199\u5165\u5230\u7f13\u5b58\u4e2d\uff0c\u8fdb\u5165 Dirty \u72b6\u6001\u3002\u5982\u679c\u5176\u4ed6\u7f13\u5b58\u662f Valid/Reserved/Dirty \u72b6\u6001\uff0c\u5c31\u4ece\u5176\u4ed6\u7f13\u5b58\u91cc\u8bfb\u53d6\u6570\u636e\uff0c\u8ba9\u5176\u4ed6\u7f13\u5b58\u90fd\u8fdb\u5165 Invalid \u72b6\u6001\uff0c\u7136\u540e\u66f4\u65b0\u81ea\u5df1\u7684\u6570\u636e\uff0c\u8fdb\u5165 Dirty \u72b6\u6001\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#msi","title":"MSI \u534f\u8bae","text":"<p>MSI \u534f\u8bae\u6bd4\u8f83\u7b80\u5355\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e09\u4e2a\u72b6\u6001\uff1a</p> <ol> <li>Modified\uff1a\u8868\u793a\u6570\u636e\u5df2\u7ecf\u4fee\u6539\uff0c\u548c\u5185\u5b58\u91cc\u4e0d\u4e00\u81f4</li> <li>Shared\uff1a\u6570\u636e\u548c\u5185\u5b58\u4e00\u81f4\uff0c\u53ef\u4ee5\u6709\u4e00\u5230\u591a\u4e2a\u7f13\u5b58\u540c\u65f6\u5904\u5728 Shared \u72b6\u6001</li> <li>Invalid\uff1a\u4e0d\u5728\u7f13\u5b58\u4e2d</li> </ol> <p>\u5f53 Read hit \u7684\u65f6\u5019\uff0c\u72b6\u6001\u4e0d\u53d8\u3002</p> <p>\u5f53 Read miss \u7684\u65f6\u5019\uff0c\u68c0\u67e5\u5176\u4ed6\u7f13\u5b58\u7684\u72b6\u6001\uff0c\u5982\u679c\u90fd\u662f Invalid\uff0c\u5c31\u4ece\u5185\u5b58\u91cc\u8bfb\u53d6\uff0c\u7136\u540e\u8fdb\u5165 Shared \u72b6\u6001\u3002\u5982\u679c\u6709 Shared\uff0c\u5c31\u4ece\u5176\u4ed6\u7f13\u5b58\u5904\u8bfb\u53d6\u3002\u5982\u679c\u6709 Dirty\uff0c\u90a3\u5c31\u8981\u628a\u5176\u4ed6\u7f13\u5b58\u7684\u6570\u636e\u5199\u5165\u5185\u5b58\u548c\u672c\u5730\u7f13\u5b58\uff0c\u7136\u540e\u8fdb\u5165 Shared \u72b6\u6001\u3002</p> <p>\u5f53 Write hit \u7684\u65f6\u5019\uff0c\u5982\u679c\u73b0\u5728\u662f Shared \u72b6\u6001\uff0c\u5219\u8981\u8ba9\u5176\u4ed6\u7684 Shared \u7f13\u5b58\u8fdb\u5165 Invalid \u72b6\u6001\uff0c\u7136\u540e\u66f4\u65b0\u6570\u636e\uff0c\u8fdb\u5165 Modified \u72b6\u6001\u3002\u5982\u679c\u662f Modified \u72b6\u6001\uff0c\u90a3\u5c31\u4fee\u6539\u6570\u636e\uff0c\u72b6\u6001\u4fdd\u6301\u4e0d\u53d8\u3002</p> <p>\u5f53 Write miss \u7684\u65f6\u5019\uff0c\u5982\u679c\u6709\u5176\u4ed6\u7f13\u5b58\u5904\u4e8e Modified/Shared \u72b6\u6001\uff0c\u90a3\u5c31\u4ece\u5176\u4ed6\u7f13\u5b58\u5904\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u8ba9\u5176\u4ed6\u7f13\u5b58\u8fdb\u5165 Invalid \u72b6\u6001\uff0c\u7136\u540e\u4fee\u6539\u672c\u5730\u6570\u636e\uff0c\u8fdb\u5165 Modified \u72b6\u6001\u3002\u5982\u679c\u6240\u6709\u7f13\u5b58\u90fd\u662f Invalid \u72b6\u6001\uff0c\u90a3\u5c31\u4ece\u5185\u5b58\u8bfb\u5165\uff0c\u7136\u540e\u4fee\u6539\u7f13\u5b58\u6570\u636e\uff0c\u8fdb\u5165 Modified \u72b6\u6001\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#mesi","title":"MESI \u534f\u8bae","text":"<p>MESI \u534f\u8bae\u5b9a\u4e49\u4e86\u56db\u79cd\u72b6\u6001\uff1a</p> <ol> <li>Modified\uff1a\u6570\u636e\u4e0e\u5185\u5b58\u4e0d\u4e00\u81f4\uff0c\u5e76\u4e14\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u6570\u636e</li> <li>Exclusive\uff1a\u6570\u636e\u4e0e\u5185\u5b58\u4e00\u81f4\uff0c\u5e76\u4e14\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u6570\u636e</li> <li>Shared\uff1a\u6570\u636e\u4e0e\u5185\u5b58\u4e00\u81f4\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\u7f13\u5b58\u540c\u65f6\u6709\u6570\u636e</li> <li>Invalid\uff1a\u4e0d\u5728\u7f13\u5b58\u4e2d</li> </ol> <p>\u5f53 Read hit \u7684\u65f6\u5019\uff0c\u72b6\u6001\u4e0d\u53d8\u3002</p> <p>\u5f53 Read miss \u7684\u65f6\u5019\uff0c\u9996\u5148\u4f1a\u68c0\u67e5\u5176\u4ed6\u7f13\u5b58\u7684\u72b6\u6001\uff0c\u5982\u679c\u6709\u6570\u636e\uff0c\u5c31\u4ece\u5176\u4ed6\u7f13\u5b58\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u4e14\u90fd\u8fdb\u5165 Shared \u72b6\u6001\uff0c\u5982\u679c\u5176\u4ed6\u7f13\u5b58\u5904\u4e8e Modified \u72b6\u6001\uff0c\u8fd8\u9700\u8981\u628a\u6570\u636e\u5199\u5165\u5185\u5b58\uff1b\u5982\u679c\u5176\u4ed6\u7f13\u5b58\u90fd\u6ca1\u6709\u6570\u636e\uff0c\u5c31\u4ece\u5185\u5b58\u91cc\u8bfb\u53d6\uff0c\u7136\u540e\u8fdb\u5165 Exclusive \u72b6\u6001\u3002</p> <p>\u5f53 Write hit \u7684\u65f6\u5019\uff0c\u8fdb\u5165 Modified \u72b6\u6001\uff0c\u540c\u65f6\u8ba9\u5176\u4ed6\u7f13\u5b58\u8fdb\u5165 Invalid \u72b6\u6001\u3002</p> <p>\u5f53 Write miss \u7684\u65f6\u5019\uff0c\u68c0\u67e5\u5176\u4ed6\u7f13\u5b58\u7684\u72b6\u6001\uff0c\u5982\u679c\u6709\u6570\u636e\uff0c\u5c31\u4ece\u5176\u4ed6\u7f13\u5b58\u8bfb\u53d6\uff0c\u5426\u5219\u4ece\u5185\u5b58\u8bfb\u53d6\u3002\u7136\u540e\uff0c\u5176\u4ed6\u7f13\u5b58\u90fd\u8fdb\u5165 Invalid \u72b6\u6001\uff0c\u672c\u5730\u7f13\u5b58\u66f4\u65b0\u6570\u636e\uff0c\u8fdb\u5165 Modified \u72b6\u6001\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0cShared \u72b6\u6001\u4e0d\u4e00\u5b9a\u8868\u793a\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u6570\u636e\uff1a\u6bd4\u5982\u672c\u6765\u6709\u4e24\u4e2a\u7f13\u5b58\u90fd\u662f Shared \u72b6\u6001\uff0c\u7136\u540e\u5176\u4e2d\u4e00\u4e2a\u56e0\u4e3a\u7f13\u5b58\u66ff\u6362\u53d8\u6210\u4e86 Invalid\uff0c\u90a3\u4e48\u53e6\u4e00\u4e2a\u662f\u4e0d\u4f1a\u53d7\u5230\u901a\u77e5\u53d8\u6210 Exclusive \u7684\u3002Exclusive \u7684\u8bbe\u7f6e\u662f\u4e3a\u4e86\u51cf\u5c11\u4e00\u4e9b\u603b\u7ebf\u8bf7\u6c42\uff0c\u6bd4\u5982\u5f53\u6570\u636e\u53ea\u6709\u4e00\u4e2a\u6838\u5fc3\u8bbf\u95ee\u7684\u65f6\u5019\uff0c\u53ea\u6709\u7b2c\u4e00\u6b21 Read miss \u4f1a\u53d1\u9001\u603b\u7ebf\u8bf7\u6c42\uff0c\u4e4b\u540e\u4e00\u76f4\u5728 Exclusive/Modified \u72b6\u6001\u4e2d\uff0c\u4e0d\u9700\u8981\u53d1\u9001\u603b\u7ebf\u8bf7\u6c42\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#moesi","title":"MOESI \u534f\u8bae","text":"<p>MOESI \u5b9a\u4e49\u4e86\u4e94\u4e2a\u72b6\u6001\uff1a</p> <ol> <li>Modified\uff1a\u6570\u636e\u7ecf\u8fc7\u4fee\u6539\uff0c\u5e76\u4e14\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e</li> <li>Owned\uff1a\u540c\u65f6\u6709\u591a\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e\uff0c\u4f46\u662f\u53ea\u6709\u8fd9\u4e2a\u7f13\u5b58\u53ef\u4ee5\u4fee\u6539\u6570\u636e</li> <li>Exclusive\uff1a\u6570\u636e\u6ca1\u6709\u4fee\u6539\uff0c\u5e76\u4e14\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e</li> <li>Shared\uff1a\u540c\u65f6\u6709\u591a\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e\uff0c\u4f46\u662f\u4e0d\u80fd\u4fee\u6539\u6570\u636e</li> <li>Invalid\uff1a\u4e0d\u5728\u7f13\u5b58\u4e2d</li> </ol> <p>\u72b6\u6001\u4e2d\uff0cM \u548c E \u662f\u72ec\u5360\u7684\uff0c\u6240\u6709\u7f13\u5b58\u91cc\u53ea\u80fd\u6709\u4e00\u4e2a\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u540c\u65f6\u6709\u591a\u4e2a S\uff0c\u6216\u8005\u591a\u4e2a S \u52a0\u4e00\u4e2a O\uff0c\u4f46\u662f\u4e0d\u80fd\u540c\u65f6\u6709\u591a\u4e2a O\u3002</p> <p>\u5b83\u7684\u72b6\u6001\u8f6c\u79fb\u4e0e MESI \u7c7b\u4f3c\uff0c\u533a\u522b\u5728\u4e8e\uff1a\u5f53\u6838\u5fc3\u5199\u5165 Owned \u72b6\u6001\u7684\u7f13\u5b58\u65f6\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a1\uff09\u901a\u77e5\u5176\u4ed6 Shared \u7684\u7f13\u5b58\u66f4\u65b0\u6570\u636e\uff1b2\uff09\u628a\u5176\u4ed6 Shared \u7f13\u5b58\u8bbe\u4e3a Invalid\uff0c\u7136\u540e\u672c\u5730\u7f13\u5b58\u8fdb\u5165 Modified \u72b6\u6001\u3002\u5728 Read miss \u7684\u65f6\u5019\uff0c\u5219\u53ef\u4ee5\u4ece Owned \u7f13\u5b58\u8bfb\u53d6\u6570\u636e\uff0c\u8fdb\u5165 Shared \u72b6\u6001\uff0c\u800c\u4e0d\u7528\u5199\u5165\u5185\u5b58\u3002\u5b83\u76f8\u6bd4 MESI \u7684\u597d\u5904\u662f\uff0c\u51cf\u5c11\u4e86\u5199\u56de\u5185\u5b58\u7684\u6b21\u6570\u3002</p> <p>AMD64 \u6587\u6863\u91cc\u91c7\u7528\u7684\u5c31\u662f MOESI \u534f\u8bae\u3002AMBA ACE \u534f\u8bae\u5176\u5b9e\u4e5f\u662f MOESI \u534f\u8bae\uff0c\u53ea\u4e0d\u8fc7\u6362\u4e86\u4e00\u4e9b\u540d\u79f0\uff0c\u8868\u793a\u53ef\u4ee5\u517c\u5bb9 MEI/MESI/MOESI \u4e2d\u7684\u4e00\u4e2a\u534f\u8bae\u3002ACE \u5bf9\u5e94\u5173\u7cfb\u5982\u4e0b\uff1a</p> <ol> <li>UniqueDirty: Modified</li> <li>SharedDirty: Owned</li> <li>UniqueClean: Exclusive</li> <li>SharedClean: Shared</li> <li>Invalid: Invalid</li> </ol> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cSharedClean \u5e76\u4e0d\u4ee3\u8868\u5b83\u7684\u6570\u636e\u548c\u5185\u5b58\u4e00\u81f4\uff0c\u6bd4\u5982\u8bf4\u548c SharedDirty \u7f13\u5b58\u4e00\u81f4\uff0c\u5b83\u53ea\u662f\u8bf4\u7f13\u5b58\u66ff\u6362\u7684\u65f6\u5019\uff0c\u4e0d\u9700\u8981\u5199\u56de\u5185\u5b58\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#mesif","title":"MESIF \u534f\u8bae","text":"<p>MESIF \u5b9a\u4e49\u4e86\u4e94\u4e2a\u72b6\u6001\uff1a</p> <ol> <li>Modified\uff1a\u6570\u636e\u7ecf\u8fc7\u4fee\u6539\uff0c\u5e76\u4e14\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e</li> <li>Exclusive\uff1a\u6570\u636e\u6ca1\u6709\u4fee\u6539\uff0c\u5e76\u4e14\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e</li> <li>Shared\uff1a\u540c\u65f6\u6709\u591a\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e\uff0c\u4f46\u662f\u4e0d\u80fd\u4fee\u6539\u6570\u636e</li> <li>Invalid\uff1a\u4e0d\u5728\u7f13\u5b58\u4e2d</li> <li>Forward\uff1a\u540c\u65f6\u6709\u591a\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u6570\u636e\uff0c\u4f46\u662f\u4e0d\u80fd\u4fee\u6539\u6570\u636e\uff0c\u4e14\u8fd9\u4e2a\u7f13\u5b58\u8d1f\u8d23\u54cd\u5e94\u8bf7\u6c42</li> </ol> <p>MESIF \u76f8\u6bd4 MESI \u7684\u533a\u522b\u662f\uff0c\u6dfb\u52a0\u4e86 Forward \u72b6\u6001\uff1aForward \u5176\u5b9e\u662f\u7279\u6b8a\u7684 Shared\uff0c\u4e3b\u8981\u662f\u8003\u8651\u5230\u6709\u591a\u4e2a\u7f13\u5b58\u5904\u4e8e Shared \u72b6\u6001\u7684\u65f6\u5019\uff0c\u5982\u679c\u6765\u4e86\u4e00\u4e2a\u8bfb\u8bf7\u6c42\uff0c\u90a3\u4e48\u54ea\u4e2a Shared \u7f13\u5b58\u8d1f\u8d23\u54cd\u5e94\u662f\u4e0d\u786e\u5b9a\u7684\u3002MESIF \u534f\u8bae\u4e2d\uff0cForward \u5c31\u662f\u8d1f\u8d23\u54cd\u5e94\u7684\u90a3\u4e00\u4e2a Shared\uff0c\u6240\u4ee5 Forward \u6700\u591a\u53ea\u6709\u4e00\u4e2a\uff0c\u5176\u4ed6 Shared \u90fd\u4e0d\u4f1a\u54cd\u5e94\u3002\u8fd9\u6837\u7684\u597d\u5904\u662f\u7b80\u5316\u4e86\u5728\u7247\u4e0a\u7f51\u7edc\u7684\u4f20\u8f93\u3002</p> <p>\u5982\u679c\u591a\u4e2a Cache \u5c5e\u4e8e Shared \u72b6\u6001\uff0c\u6ca1\u6709 Forward\uff0c\u90a3\u4e48\u65b0\u7684 Cache \u8bf7\u6c42\u5c31\u4f1a\u53d1\u9001\u5230\u5185\u5b58\u91cc\uff0c\u7531\u4e8e Shared \u7684\u6570\u636e\u6ca1\u6709\u7ecf\u8fc7\u4fee\u6539\uff0c\u6240\u4ee5\u5185\u5b58\u4e2d\u7684\u6570\u636e\u548c Shared \u662f\u4e00\u81f4\u7684\u3002\u540c\u65f6\uff0c\u8fd9\u4e2a\u65b0\u7684 Cache \u4f1a\u8fdb\u5165 Forward \u72b6\u6001\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#dragon","title":"Dragon \u534f\u8bae","text":"<p>Dragon \u534f\u8bae\u662f\u4e00\u4e2a\u57fa\u4e8e\u66f4\u65b0\u7684\u534f\u8bae\uff0c\u610f\u5473\u7740\u5199\u5165\u7f13\u5b58\u7684\u65f6\u5019\uff0c\u4f1a\u628a\u66f4\u65b0\u7684\u6570\u636e\u540c\u6b65\u5230\u62e5\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u5176\u4ed6\u6838\u5fc3\u3002\u5b83\u5b9a\u4e49\u4e86\u56db\u4e2a\u72b6\u6001\uff1a</p> <ol> <li>Exclusive clean(E)\uff1a\u72ec\u5360\uff0c\u5e76\u4e14\u6570\u636e\u548c\u5185\u5b58\u4e00\u81f4</li> <li>Shared clean(Sc)\uff1a\u6570\u636e\u540c\u65f6\u5b58\u5728\u591a\u4e2a\u7f13\u5b58\u4e2d\uff0c\u5e76\u4e14\u81ea\u5df1\u4e0d\u662f\u6700\u540e\u4e00\u4e2a\u5199\u5165\u8be5\u7f13\u5b58\u6570\u636e\u7684</li> <li>Shared modified(Sm)\uff1a\u6570\u636e\u540c\u65f6\u5b58\u5728\u591a\u4e2a\u7f13\u5b58\u4e2d\uff0c\u5e76\u4e14\u81ea\u5df1\u8bbe\u6700\u540e\u4e00\u4e2a\u5199\u5165\u8be5\u7f13\u5b58\u6570\u636e\u7684\uff0c\u7c7b\u4f3c\u4e8e\u524d\u9762 MOESI \u534f\u8bae\u7684 Owner \u72b6\u6001</li> <li>Modify(M)\uff1a\u72ec\u5360\uff0c\u5e76\u4e14\u6570\u636e\u548c\u5185\u5b58\u4e0d\u4e00\u81f4</li> </ol> <p>\u53ef\u4ee5\u770b\u5230\uff0cE \u548c M \u90fd\u662f\u72ec\u5360\u7684\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u591a\u4e2a\u7f13\u5b58\u6709\u540c\u4e00\u4e2a\u7f13\u5b58\u884c\uff0c\u90a3\u5c31\u662f\u82e5\u5e72\u4e2a Sc \u548c\u4e00\u4e2a Sm\u3002</p> <p>\u5f53 Read miss \u7684\u65f6\u5019\uff0c\u5728\u603b\u7ebf\u4e0a\u68c0\u67e5\u662f\u5426\u6709\u7f13\u5b58\u5df2\u7ecf\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u6570\u636e\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u4ece\u5185\u5b58\u8bfb\u53d6\u5e76\u8f6c\u5230 Exclusive clean \u72b6\u6001\uff1b\u5982\u679c\u5df2\u7ecf\u5728\u5176\u4ed6\u7f13\u5b58\u4e2d\uff0c\u5219\u4ece\u5176\u4ed6\u7f13\u5b58\u8bfb\u53d6\uff0c\u5c06\u5176\u4ed6\u7f13\u5b58\u8f6c\u79fb\u5230 Shared clean/Shared modified \u72b6\u6001\uff0c\u7136\u540e\u8be5\u7f13\u5b58\u8f6c\u79fb\u5230 Shared clean \u72b6\u6001\u3002</p> <p>\u5f53 Write miss \u7684\u65f6\u5019\uff0c\u540c\u6837\u68c0\u67e5\u5176\u4ed6\u7f13\u5b58\u7684\u72b6\u6001\uff0c\u5982\u679c\u662f\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u7684\uff0c\u5c31\u4ece\u5185\u5b58\u8bfb\u53d6\uff0c\u66f4\u65b0\u6570\u636e\uff0c\u7136\u540e\u8f6c\u5230 Modify \u72b6\u6001\uff1b\u5982\u679c\u4e0d\u662f\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u7684\uff0c\u5c31\u8fdb\u5165 Shared modified \u72b6\u6001\uff0c\u5e76\u4e14\u8ba9\u539f\u6765 Shared modified \u7684\u7f13\u5b58\u8fdb\u5165 Shared clean \u72b6\u6001\u3002</p> <p>\u5f53 Write hit \u7684\u65f6\u5019\uff0c\u5982\u679c\u72b6\u6001\u662f Shared modified\uff0c\u8fd9\u65f6\u5019\u9700\u8981\u901a\u77e5\u5176\u4ed6\u7f13\u5b58\u66f4\u65b0\u6570\u636e\uff1b\u5982\u679c\u72b6\u6001\u662f Shared clean\uff0c\u5219\u8981\u901a\u77e5\u5176\u4ed6\u7f13\u5b58\u66f4\u65b0\u6570\u636e\u7684\u540c\u65f6\uff0c\u8ba9\u539f\u6765 Shared modified \u7684\u7f13\u5b58\u8fdb\u5165 Shared clean \u72b6\u6001\uff1b\u5982\u679c\u72b6\u6001\u662f Exclusive clean\uff0c\u5219\u8fdb\u5165 Modify \u72b6\u6001\u3002</p> <p>\u5728\u8fd9\u91cc\uff0cShared modified \u7684\u7f13\u5b58\u8d1f\u8d23\u5728\u6362\u51fa\u7684\u65f6\u5019\uff0c\u5199\u5165\u6570\u636e\u5230\u5185\u5b58\u4e2d\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#_3","title":"\u57fa\u4e8e\u76ee\u5f55\u7684\u7f13\u5b58\u4e00\u81f4\u6027","text":"<p>\u4e0a\u9762\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u4e2d\uff0c\u7ecf\u5e38\u6709\u8fd9\u4e48\u4e00\u4e2a\u64cd\u4f5c\uff1a\u5411\u6240\u6709\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u7f13\u5b58\u53d1\u9001/\u63a5\u53d7\u6d88\u606f\u3002\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u76f4\u63a5\u5e7f\u64ad\uff0c\u7136\u540e\u63a5\u53d7\u7aef\u81ea\u5df1\u5224\u65ad\u662f\u5426\u5904\u7406\u3002\u4f46\u662f\u8fd9\u4e2a\u65b9\u6cd5\u5728\u6838\u5fc3\u5f88\u591a\u7684\u65f6\u5019\u4f1a\u5bfc\u81f4\u5e7f\u64ad\u6d41\u91cf\u592a\u5927\uff0c\u56e0\u6b64\u9700\u8981\u5148\u4fdd\u5b58\u4e0b\u6765\u54ea\u4e9b\u7f13\u5b58\u4f1a\u6709\u8fd9\u4e2a\u7f13\u5b58\u7684\u4fe1\u606f\uff0c\u7136\u540e\u5bf9\u8fd9\u4e9b\u7f13\u5b58\u70b9\u5bf9\u70b9\u5730\u53d1\u9001\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u8282\u7701\u4e00\u4e9b\u7f51\u7edc\u6d41\u91cf\u3002</p> <p>\u600e\u4e48\u8bb0\u5f55\u8fd9\u4e2a\u4fe1\u606f\u5462\uff1f\u4e00\u4e2a\u7b80\u5355\u7684\u529e\u6cd5\uff08Full bit vector format\uff09\u662f\uff0c\u6709\u4e00\u4e2a\u5168\u5c40\u7684\u8868\uff0c\u5bf9\u6bcf\u4e2a\u7f13\u5b58\u884c\uff0c\u90fd\u8bb0\u5f55\u4e00\u4e2a\u5927\u5c0f\u4e3a N\uff08N \u4e3a\u6838\u5fc3\u6570\uff09\u7684\u4f4d\u5411\u91cf\uff0c1 \u8868\u793a\u5bf9\u5e94\u7684\u6838\u5fc3\u4e2d\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\u3002\u4f46\u8fd9\u4e2a\u65b9\u6cd5\u4fdd\u5b58\u6570\u636e\u91cf\u592a\u5927\uff1a\u7f13\u5b58\u884c\u6570\u6b63\u6bd4\u4e8e N\uff0c\u8fd8\u8981\u518d\u4e58\u4ee5\u4e00\u6b21 N\uff0c\u603b\u5bb9\u91cf\u662f O(N^2) \u7684\u3002</p> <p>\u4e00\u4e2a\u7a0d\u5fae\u597d\u4e00\u4e9b\u7684\u65b9\u6cd5\uff08Coarse bit vector format\uff09\u662f\uff0c\u6211\u628a\u6838\u5fc3\u5206\u7ec4\uff0c\u6bd4\u5982\u6309\u7167 NUMA \u8282\u70b9\u8fdb\u884c\u5212\u5206\uff0c\u6b64\u65f6\u6bcf\u4e2a\u7f13\u5b58\u884c\u90fd\u4fdd\u5b58\u4e00\u4e2a\u5927\u5c0f\u4e3a M\uff08M \u4e3a NUMA \u6570\u91cf\uff09\u7684\u4f4d\u5411\u91cf\uff0c\u53ea\u8981\u8fd9\u4e2a NUMA \u8282\u70b9\u91cc\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\uff0c\u5bf9\u5e94\u4f4d\u5c31\u53d6 1\u3002\u8fd9\u6837\u76f8\u5f53\u4e8e\u662f\u4ee5\u727a\u7272\u4e00\u90e8\u5206\u6d41\u91cf\u4e3a\u4ee3\u4ef7\uff08NUMA \u8282\u70b9\u5185\u90e8\u5e7f\u64ad\uff09\uff0c\u6765\u8282\u7701\u4e00\u4e9b\u76ee\u5f55\u7684\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u4f46\u5b9e\u9645\u4e0a\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u7f13\u5b58\u884c\u901a\u5e38\u53ea\u4f1a\u5728\u5f88\u5c11\u7684\u6838\u5fc3\u4e2d\u4fdd\u5b58\uff0c\u6240\u4ee5\u8fd9\u91cc\u6709\u5f88\u5927\u7684\u4f18\u5316\u7a7a\u95f4\u3002\u6bd4\u5982\u8bf4\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u7f13\u5b58\u884c\u540c\u65f6\u51fa\u73b0\u7684\u7f13\u5b58\u6570\u91cf\u4e0a\u9650\uff08Limited pointer format\uff09\uff0c\u7136\u540e\u4fdd\u5b58\u6838\u5fc3\u7684\u4e0b\u6807\u800c\u4e0d\u662f\u4f4d\u5411\u91cf\uff0c\u8fd9\u6837\u7684\u5b58\u50a8\u7a7a\u95f4\u5c31\u662f O(N\\log_2N)\u3002\u4f46\u662f\u5462\uff0c\u8fd9\u6837\u9650\u5236\u4e86\u7f13\u5b58\u884c\u540c\u65f6\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u5982\u679c\u8d85\u8fc7\u4e86\u4e0a\u9650\uff0c\u9700\u8981\u66ff\u6362\u6389\u5df2\u6709\u7684\u7f13\u5b58\uff0c\u53ef\u80fd\u5728\u4e00\u4e9b\u573a\u666f\u4e0b\u6027\u80fd\u4f1a\u964d\u4f4e\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u65b9\u5f0f\uff0c\u5c31\u662f\u94fe\u8868 (Chained directory format)\u3002\u76ee\u5f55\u4e2d\u4fdd\u5b58\u6700\u540e\u4e00\u6b21\u8bbf\u95ee\u7684\u6838\u5fc3\u7f16\u53f7\uff0c\u7136\u540e\u6bcf\u4e2a\u6838\u5fc3\u7684\u7f13\u5b58\u91cc\uff0c\u4fdd\u5b58\u4e86\u4e0b\u4e00\u4e2a\u4fdd\u5b58\u4e86\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u6838\u5fc3\u7f16\u53f7\uff0c\u6216\u8005\u8868\u793a\u94fe\u8868\u7ec8\u6b62\u3002\u8fd9\u6837\u5b58\u50a8\u7a7a\u95f4\u4e5f\u662f O(N\\log_2N)\uff0c\u4e0d\u8fc7\u53d1\u9001\u6d88\u606f\u7684\u5ef6\u8fdf\u66f4\u957f\uff0c\u56e0\u4e3a\u8981\u4e32\u884c\u904d\u5386\u4e00\u904d\uff0c\u800c\u4e0d\u80fd\u540c\u65f6\u53d1\u9001\u3002\u7c7b\u4f3c\u5730\uff0c\u53ef\u4ee5\u7528\u4e8c\u53c9\u6811\uff08Number-balanced binary tree format\uff09\u6765\u7ec4\u7ec7\uff1a\u6bcf\u4e2a\u7f13\u5b58\u4fdd\u5b58\u4e24\u4e2a\u6307\u9488\uff0c\u6307\u5411\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\uff0c\u7136\u540e\u5206\u522b\u904d\u5386\uff0c\u76ee\u7684\u8fd8\u662f\u52a0\u5feb\u904d\u5386\u7684\u901f\u5ea6\uff0c\u53ef\u4ee5\u540c\u65f6\u53d1\u9001\u6d88\u606f\u7ed9\u591a\u4e2a\u6838\u5fc3\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#_4","title":"\u534f\u8bae\u5206\u6790","text":"<p>\u4e0b\u6587\u7ed3\u5408\u5b9e\u9645\u7684\u534f\u8bae\uff0c\u5206\u6790\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u662f\u5982\u4f55\u5728\u786c\u4ef6\u4e2d\u5b9e\u73b0\u7684\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#tilelink","title":"TileLink \u534f\u8bae","text":"<p>TileLink \u4e3a\u4e86\u5b9e\u73b0\u7f13\u5b58\u4e00\u81f4\u6027\uff0c\u5728\u5df2\u6709\u7684 A \u548c D channel \u4ee5\u5916\uff0c\u5b83\u5f15\u5165\u4e86\u4e09\u4e2a channel\uff1aB\u3001C \u548c E\uff0c\u652f\u6301\u4e09\u79cd\u64cd\u4f5c\uff1a</p> <ul> <li>Acquire\uff1aM-&gt;S \u5728 A channel \u4e0a\u53d1\u9001 Acquire\uff0cS-&gt;M \u5728 D channel \u4e0a\u53d1\u9001 Grant\uff0c\u7136\u540e M-&gt;S \u5728 E channel \u4e0a\u53d1\u9001 GrantAck\uff1b\u529f\u80fd\u662f\u83b7\u53d6\u4e00\u4e2a copy\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u548c Get \u662f\u7c7b\u4f3c\u7684\uff0c\u90fd\u662f\u5728 A channel \u4e0a\u53d1\u9001\u8bf7\u6c42\uff0c\u5728 D channel \u4e0a\u63a5\u53d7\u54cd\u5e94\uff0c\u53ea\u4e0d\u8fc7\u989d\u5916\u9700\u8981\u5728 E channel \u4e0a\u53d1\u9001 GrantAck\u3002</li> <li>Release\uff1aM-&gt;S \u5728 C channel \u4e0a\u53d1\u9001 Release\uff0cS-&gt;M \u5728 D channel \u4e0a\u53d1\u9001 ReleaseAck\uff1b\u529f\u80fd\u662f\u5220\u9664\u81ea\u5df1\u7684 copy\uff0c\u4e00\u822c\u662f\u7f13\u5b58\u884c\u8981\u88ab\u6362\u51fa\u7684\u65f6\u5019\uff0c\u53d1\u9001 ReleaseData \u6765\u5199\u56de Dirty \u6570\u636e</li> <li>Probe\uff1aS-&gt;M \u5728 B channel \u4e0a\u53d1\u9001 Probe\uff0cM-&gt;S \u5728 C channel \u4e0a\u53d1\u9001 ProbeAck\uff1b\u529f\u80fd\u662f\u8981\u6c42 M \u5220\u9664\u81ea\u5df1\u7684 copy\uff0c\u901a\u5e38\u662f\u6709\u67d0\u4e00\u4e2a\u7f13\u5b58\u53d1\u9001\u4e86 Acquire\uff0c\u5bfc\u81f4\u5176\u4ed6\u7f13\u5b58\u9700\u8981\u964d\u4f4e\u6743\u9650</li> </ul> <p>\u53ef\u4ee5\u770b\u5230\uff0cA C E \u4e09\u4e2a channel \u662f M-&gt;S\uff0cB D \u4e24\u4e2a channel \u662f S-&gt;M\u3002</p> <p>\u5047\u5982\u4e00\u4e2a\u7f13\u5b58\uff08Master A\uff09\u8981\u5199\u5165\u4e00\u5757\u53ea\u8bfb\u6570\u636e\uff0c\u6216\u8005\u8bfb\u53d6\u4e00\u5757 miss \u7684\u7f13\u5b58\u884c\uff0c\u5982\u679c\u662f\u5e7f\u64ad\u5f0f\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u90a3\u4e48\u9700\u8981\u7ecf\u5386\u5982\u4e0b\u7684\u8fc7\u7a0b\uff1a</p> <ul> <li>Master A -&gt; Slave: Acquire</li> <li>Slave -&gt; Master B: Probe</li> <li>Master B -&gt; Slave: ProbeAck</li> <li>Slave -&gt; Master A: Grant</li> <li>Master A -&gt; Slave: GrantAck</li> </ul> <p>\u9996\u5148 Master A \u53d1\u51fa Acquire \u8bf7\u6c42\uff0c\u7136\u540e Slave \u5411\u5176\u4ed6 Master \u5e7f\u64ad Probe\uff0c\u7b49\u5230\u5176\u4ed6 Master \u8fd4\u56de ProbeAck \u540e\uff0c\u518d\u5411 Master A \u8fd4\u56de Grant\uff0c\u6700\u540e Master A \u53d1\u9001 GrantAck \u7ed9 Slave\u3002\u8fd9\u6837 Master A \u5c31\u83b7\u5f97\u4e86\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u4e00\u4efd\u62f7\u8d1d\uff0c\u5e76\u4e14\u8ba9 Master B \u7684\u7f13\u5b58\u884c\u5931\u6548\u6216\u8005\u72b6\u6001\u53d8\u6210\u53ea\u8bfb\u3002</p> <p>TileLink \u7684\u7f13\u5b58\u884c\u6709\u4e09\u4e2a\u72b6\u6001\uff1aNone\uff0cBranch \u548c Trunk(Tip)\u3002\u57fa\u672c\u5bf9\u5e94 MSI \u6a21\u578b\uff1aNone-&gt;Invalid\uff0cBranch-&gt;Shared \u548c Trunk-&gt;Modified\u3002Rocket Chip \u4ee3\u7801\u4e2d ClientStates \u8fd8\u5b9a\u4e49\u4e86 Dirty \u72b6\u6001\uff0c\u5927\u81f4\u5bf9\u5e94 MESI \u6a21\u578b\uff1aNone-&gt;Invalid\uff0cBranch-&gt;Shared\uff0cTrunk-&gt;Exclusive\uff0cDirty-&gt;Modified\u3002</p> <p>\u6b64\u5916\uff0c\u6807\u51c6\u8fd8\u8bf4\u53ef\u4ee5\u5728 B \u548c C channel \u4e0a\u8fdb\u884c TL-UH \u7684\u64cd\u4f5c\u3002\u6807\u51c6\u8fd9\u4e48\u8bbe\u8ba1\u7684\u610f\u56fe\u662f\u53ef\u4ee5\u8ba9 Slave \u8f6c\u53d1\u64cd\u4f5c\u5230\u62e5\u6709\u7f13\u5b58\u6570\u636e\u7684 Master \u4e0a\u3002\u6bd4\u5982 Master A \u5728 A channel \u4e0a\u53d1\u9001 Put \u8bf7\u6c42\uff0c\u90a3\u4e48 Slave \u5411 Master B \u7684 B channel \u4e0a\u53d1\u9001 Put \u8bf7\u6c42\uff0cMaster B \u5728 C channel \u4e0a\u53d1\u9001 AccessAck \u54cd\u5e94\uff0cSlave \u518d\u628a\u54cd\u5e94\u8f6c\u56de Master A \u7684 D channel\u3002\u8fd9\u5c31\u50cf\u662f\u4e00\u4e2a\u7247\u4e0a\u7684\u7f51\u7edc\uff0cSlave \u8d1f\u8d23\u5728 Master \u4e4b\u95f4\u8def\u7531\u8bf7\u6c42\u3002</p> <p>\u63a5\u4e0b\u6765\u770b Rocket Chip \u81ea\u5e26\u7684\u57fa\u4e8e\u5e7f\u64ad\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u5b9e\u73b0\u3002\u6838\u5fc3\u5b9e\u73b0\u662f TLBroadcast\uff0c\u6838\u5fc3\u7684\u903b\u8f91\u5c31\u662f\uff0c\u5982\u679c\u4e00\u4e2a Master A \u53d1\u9001\u4e86 Acquire\uff0c\u90a3\u4e48 TLBroadcast \u9700\u8981\u53d1\u9001 Probe \u5230\u5176\u4ed6\u7684 Master\uff0c\u5f53\u5176\u4ed6\u7684 Master \u90fd\u54cd\u5e94\u4e86 ProbeAck \u540e\uff0c\u518d\u8fd4\u56de Grant \u5230 Master A\u3002</p> <p>\u9996\u5148\u6765\u770b B channel \u4e0a\u7684 Probe \u903b\u8f91\u3002\u5b83\u8bb0\u5f55\u4e86\u4e00\u4e2a todo bitmask\uff0c\u8868\u793a\u54ea\u4e9b Master \u9700\u8981\u53d1\u9001 Probe\uff0c\u8fd9\u91cc\u91c7\u7528\u4e86 Probe Filter \u6765\u51cf\u5c11\u53d1\u9001 Probe \u7684\u6b21\u6570\uff0c\u56e0\u4e3a\u53ea\u9700\u8981\u5411\u62e5\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684 Master \u53d1\u9001 Probe\uff1a</p> <pre><code>val probe_todo = RegInit(0.U(max(1, caches.size).W))\nval probe_line = Reg(UInt())\nval probe_perms = Reg(UInt(2.W))\nval probe_next = probe_todo &amp; ~(leftOR(probe_todo) &lt;&lt; 1)\nval probe_busy = probe_todo.orR()\nval probe_target = if (caches.size == 0) 0.U else Mux1H(probe_next, cache_targets)\n\n// Probe whatever the FSM wants to do next\nin.b.valid := probe_busy\nif (caches.size != 0) {\n    in.b.bits := edgeIn.Probe(probe_line &lt;&lt; lineShift, probe_target, lineShift.U, probe_perms)._2\n}\nwhen (in.b.fire()) { probe_todo := probe_todo &amp; ~probe_next }\n</code></pre> <p>\u8fd9\u91cc <code>probe_next</code> \u5c31\u662f\u88ab probe \u7684\u90a3\u4e2a Master \u5bf9\u5e94\u7684 bitmask\uff0c<code>probe_target</code> \u5c31\u662f Master \u7684 Id\u3002\u8fd9\u4e2a Probe FSM \u7684\u8f93\u5165\u5c31\u662f Probe Filter\uff0c\u5b83\u4f1a\u7ed9\u51fa\u54ea\u4e9b Cache \u62e5\u6709\u5f53\u524d\u7684\u7f13\u5b58\u884c\u7684\u4fe1\u606f\uff1a</p> <pre><code>val leaveB = !filter.io.response.bits.needT &amp;&amp; !filter.io.response.bits.gaveT\nval others = filter.io.response.bits.cacheOH &amp; ~filter.io.response.bits.allocOH\nval todo = Mux(leaveB, 0.U, others)\nfilter.io.response.ready := !probe_busy\nwhen (filter.io.response.fire()) {\n    probe_todo  := todo\n    probe_line  := filter.io.response.bits.address &gt;&gt; lineShift\n    probe_perms := Mux(filter.io.response.bits.needT, TLPermissions.toN, TLPermissions.toB)\n}\n</code></pre> <p>\u8fd9\u91cc\u53c8\u533a\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\u5982\u679c Acquire \u9700\u8981\u8fdb\u5165 Trunk \u72b6\u6001\uff08\u6bd4\u5982\u662f\u4e2a\u5199\u5165\u64cd\u4f5c\uff09\uff0c\u610f\u5473\u7740\u5176\u4ed6 Master \u9700\u8981\u8fdb\u5165 None \u72b6\u6001\uff0c\u6240\u4ee5\u8fd9\u91cc\u8981\u53d1\u9001 toN\uff1b\u5982\u679c Acquire \u4e0d\u9700\u8981\u8fdb\u5165 Trunk \u72b6\u6001\uff08\u6bd4\u5982\u662f\u4e2a\u8bfb\u53d6\u64cd\u4f5c\uff09\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u5176\u4ed6 Master \u8fdb\u5165 Branch \u72b6\u6001\uff0c\u6240\u4ee5\u8fd9\u91cc\u8981\u53d1\u9001 toB\u3002</p> <p>\u5728 B channel \u53d1\u9001 Probe \u7684\u540c\u65f6\uff0c\u4e5f\u8981\u5904\u7406 C channel \u4e0a\u7684 ProbeAck \u548c ProbeAckData\uff1a</p> <pre><code>// Incoming C can be:\n// ProbeAck     =&gt; decrement tracker, drop \n// ProbeAckData =&gt; decrement tracker, send out A as PutFull(DROP)\n// ReleaseData  =&gt;                    send out A as PutFull(TRANSFORM)\n// Release      =&gt; send out D as ReleaseAck\n</code></pre> <p>\u7531\u4e8e\u8fd9\u91cc\u91c7\u7528\u7684\u662f invalidation based\uff0c\u6240\u4ee5\u5982\u679c\u67d0\u4e2a Master \u4e4b\u524d\u5904\u4e8e Dirty \u72b6\u6001\uff0c\u90a3\u4e48\u5b83\u4f1a\u53d1\u9001 ProbeAckData\uff0c\u6b64\u65f6\u9700\u8981\u628a\u6570\u636e\u5199\u56de\uff0c\u6240\u4ee5\u9700\u8981\u7528 PutFull \u628a\u6570\u636e\u5199\u51fa\u53bb\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#ace","title":"ACE \u534f\u8bae","text":"<p>ACE \u5728 AXI \u534f\u8bae\u7684\u57fa\u7840\u4e0a\uff0c\u5b9e\u73b0\u4e86\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u3002\u9996\u5148\u5217\u51fa ACE \u7684\u7f13\u5b58\u72b6\u6001\u6a21\u578b\uff0c\u5b83\u5b9a\u4e49\u4e86\u8fd9\u4e48\u4e94\u79cd\u72b6\u6001\uff0c\u5176\u5b9e\u5c31\u662f MOESI \u7684\u4e0d\u540c\u8bf4\u6cd5\uff1a</p> <ol> <li>UniqueDirty: Modified</li> <li>SharedDirty: Owned</li> <li>UniqueClean: Exclusive</li> <li>SharedClean: Shared</li> <li>Invalid: Invalid</li> </ol> <p>\u6587\u6863\u4e2d\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <ul> <li>Valid, Invalid: When valid, the cache line is present in the cache. When invalid, the cache line is not present in the cache.</li> <li>Unique, Shared: When unique, the cache line exists only in one cache. When shared, the cache line might exist in more than one cache, but this is not guaranteed.</li> <li>Clean, Dirty: When clean, the cache does not have responsibility for updating main memory. When dirty, the cache line has been modified with respect to main memory, and this cache must ensure that main memory is eventually updated.</li> </ul> <p>\u5927\u81f4\u7406\u89e3\u7684\u8bdd\uff0cUnique \u8868\u793a\u53ea\u6709\u4e00\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\uff0cShared \u8868\u793a\u6709\u53ef\u80fd\u6709\u591a\u4e2a\u7f13\u5b58\u6709\u8fd9\u4e2a\u7f13\u5b58\u884c\uff1bClean \u8868\u793a\u5b83\u4e0d\u8d1f\u8d23\u66f4\u65b0\u5185\u5b58\uff0cDirty \u8868\u793a\u5b83\u8d1f\u8d23\u66f4\u65b0\u5185\u5b58\u3002\u4e0b\u9762\u7684\u5f88\u591a\u64cd\u4f5c\u90fd\u662f\u56f4\u7ed5\u8fd9\u4e9b\u72b6\u6001\u8fdb\u884c\u7684\u3002</p> <p>\u6587\u6863\u4e2d\u4e5f\u8bf4\uff0c\u5b83\u652f\u6301 MOESI \u7684\u4e0d\u540c\u5b50\u96c6\uff1aMESI, ESI, MEI, MOESI\uff0c\u6240\u4ee5\u4e5f\u8bb8\u5728\u4e00\u4e2a\u7b80\u5316\u7684\u7cfb\u7edf\u91cc\uff0c\u4e00\u4e9b\u72b6\u6001\u53ef\u4ee5\u4e0d\u5b58\u5728\uff0c\u5b9e\u73b0\u4f1a\u6709\u6240\u4e0d\u540c\u3002</p> <p>\u6362\u4f4d\u601d\u8003\uff0c\u4f5c\u4e3a\u534f\u8bae\u7684\u8bbe\u8ba1\u8005\uff0c\u5e94\u8be5\u5982\u4f55\u6dfb\u52a0\u4fe1\u53f7\u6765\u5b9e\u73b0\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\uff1f\u4ece\u9700\u6c42\u51fa\u53d1\uff0c\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u9700\u8981\u5b9e\u73b0\uff1a</p> <ol> <li>\u8bfb\u6216\u5199 miss \u7684\u65f6\u5019\uff0c\u9700\u8981\u8bf7\u6c42\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u6570\u636e\uff0c\u5e76\u4e14\u66f4\u65b0\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u8bfb\u53d6\u5230 Shared\uff0c\u5199\u5165\u5230 Modified \u7b49\u3002</li> <li>\u5199\u5165\u4e00\u4e2a valid &amp;&amp; !dirty \u7684\u7f13\u5b58\u884c\u7684\u65f6\u5019\uff0c\u9700\u8981\u5347\u7ea7\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u4ece Shared \u5230 Modified\u3002</li> <li>\u9700\u8981 evict \u4e00\u4e2a valid &amp;&amp; dirty \u7684\u7f13\u5b58\u884c\u7684\u65f6\u5019\uff0c\u9700\u8981\u628a dirty \u6570\u636e\u5199\u56de\uff0c\u5e76\u4e14\u964d\u7ea7\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u6bd4\u5982 Modified -&gt; Shared/Invalid\u3002\u5982\u679c\u9700\u8981 evict \u4e00\u4e2a valid &amp;&amp; !dirty \u7684\u7f13\u5b58\u884c\uff0c\u53ef\u4ee5\u9009\u62e9\u901a\u77e5\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e0d\u901a\u77e5\u4e0b\u4e00\u7ea7\u3002</li> <li>\u6536\u5230 snoop \u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u9700\u8981\u8fd4\u56de\u5f53\u524d\u7684\u7f13\u5b58\u6570\u636e\uff0c\u5e76\u4e14\u66f4\u65b0\u72b6\u6001\u3002</li> <li>\u9700\u8981\u4e00\u4e2a\u65b9\u6cd5\u6765\u901a\u77e5\u4e0b\u4e00\u7ea7 Cache/Interconnect\uff0c\u544a\u8bc9\u5b83\u7b2c\u4e00\u548c\u7b2c\u4e8c\u6b65\u5b8c\u6210\u4e86\u3002</li> </ol> <p>\u9996\u5148\u8003\u8651\u4e0a\u9762\u63d0\u5230\u7684\u7b2c\u4e00\u4ef6\u4e8b\u60c5\uff1a\u8bfb\u6216\u5199 miss \u7684\u65f6\u5019\uff0c\u9700\u8981\u8bf7\u6c42\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u6570\u636e\uff0c\u5e76\u4e14\u66f4\u65b0\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u8bfb\u53d6\u5230 Shared\uff0c\u5199\u5165\u5230 Modified \u7b49\u3002</p> <p>AXI \u5df2\u7ecf\u6709 AR \u548c R channel \u7528\u4e8e\u8bfb\u53d6\u6570\u636e\uff0c\u90a3\u4e48\u9047\u5230\u8bfb\u6216\u8005\u5199 miss \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728 AR channel \u4e0a\u634e\u5e26\u4e00\u4e9b\u4fe1\u606f\uff0c\u8ba9\u4e0b\u4e00\u7ea7\u7684 Interconnect \u77e5\u9053\u81ea\u5df1\u7684\u610f\u56fe\u662f\u8bfb\u8fd8\u662f\u5199\uff0c\u7136\u540e Interconnect \u5c31\u5728 R channel \u4e0a\u8fd4\u56de\u6570\u636e\u3002</p> <p>\u5177\u4f53\u8981\u634e\u5e26\u4ec0\u4e48\u4fe1\u606f\u5462\uff1f\u201c\u4e0d\u59a8\u201d\u7528\u8fd9\u6837\u4e00\u79cd\u547d\u540d\u65b9\u5f0f\uff1a<code>\u64cd\u4f5c + \u76ee\u7684\u72b6\u6001</code>\uff0c\u6bd4\u5982\u8bfb miss \u7684\u65f6\u5019\uff0c\u9700\u8981\u8bfb\u53d6\u6570\u636e\uff0c\u8fdb\u5165 Shared \u72b6\u6001\uff0c\u90a3\u5c31\u53eb ReadShared\uff1b\u5199 miss \u7684\u65f6\u5019\uff0c\u9700\u8981\u8bfb\u53d6\u6570\u636e\uff08\u901a\u5e38\u5199\u5165\u7f13\u5b58\u7684\u53ea\u662f\u4e00\u4e2a\u7f13\u5b58\u884c\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u5148\u8981\u628a\u5b8c\u6574\u7684\u8bfb\u8fdb\u6765\uff09\uff0c\u5c31\u53eb ReadUnique\u3002\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u7f16\u7801\u5230\u4e00\u4e2a\u4fe1\u53f7\u4e2d\uff0c\u4f20\u9012\u7ed9 Interconnect\u3002</p> <p>\u518d\u6765\u8003\u8651\u4e0a\u9762\u63d0\u5230\u7684\u7b2c\u4e8c\u4ef6\u4e8b\u60c5\uff1a\u5199\u5165\u4e00\u4e2a valid &amp;&amp; !dirty \u7684\u7f13\u5b58\u884c\u7684\u65f6\u5019\uff0c\u9700\u8981\u5347\u7ea7\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u4ece Shared \u5230 Modified\u3002</p> <p>\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u9700\u8981\u8ba9 Interconnect \u628a\u5176\u4ed6\u7f13\u5b58\u4e2d\u7684\u8fd9\u4e2a\u7f13\u5b58\u884c\u6570\u636e\u6e05\u7a7a\uff0c\u5e76\u4e14\u628a\u81ea\u5df1\u5347\u7ea7\u5230 Unique\u3002\u6839\u636e\u4e0a\u9762\u7684 <code>\u64cd\u4f5c + \u76ee\u7684\u72b6\u6001</code> \u7684\u547d\u540d\u65b9\u5f0f\uff0c\u53ef\u4ee5\u8bb2\u5176\u547d\u540d\u4e3a CleanUnique\uff0c\u5373\u628a\u5176\u4ed6\u7f13\u5b58\u90fd Clean \u6389\uff0c\u7136\u540e\u81ea\u5df1\u53d8\u6210 Unique\u3002</p> <p>\u63a5\u4e0b\u6765\u8003\u8651\u4e0a\u9762\u63d0\u5230\u7684\u7b2c\u4e09\u4ef6\u4e8b\u60c5\uff1a\u9700\u8981 evict \u4e00\u4e2a valid &amp;&amp; dirty \u7684\u7f13\u5b58\u884c\u7684\u65f6\u5019\uff0c\u9700\u8981\u628a dirty \u6570\u636e\u5199\u56de\uff0c\u5e76\u4e14\u964d\u7ea7\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u6bd4\u5982 Modified -&gt; Shared/Invalid\u3002</p> <p>\u6309\u7167\u524d\u9762\u7684 <code>\u64cd\u4f5c + \u76ee\u7684\u72b6\u6001</code> \u547d\u540d\u6cd5\uff0c\u53ef\u4ee5\u547d\u540d\u4e3a WriteBackInvalid\u3002ACE \u5b9e\u9645\u91c7\u7528\u7684\u547d\u540d\u662f WriteBack\u3002</p> <p>\u7b2c\u56db\u4ef6\u4e8b\u60c5\uff1a\u6536\u5230 snoop \u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u9700\u8981\u8fd4\u56de\u5f53\u524d\u7684\u7f13\u5b58\u6570\u636e\uff0c\u5e76\u4e14\u66f4\u65b0\u72b6\u6001\u3002</p> <p>\u65e2\u7136 snoop \u662f\u4ece Interconnect \u53d1\u7ed9 Master\uff0c\u5728\u5df2\u6709\u7684 AR R AW W B channel \u91cc\u6ca1\u529e\u6cd5\u505a\u8fd9\u4e2a\u4e8b\u60c5\uff0c\u4e0d\u7136\u4f1a\u6253\u7834\u5df2\u6709\u7684\u903b\u8f91\u3002\u90a3\u4e0d\u5f97\u4e0d\u6dfb\u52a0\u4e00\u5bf9 channel\uff1a\u89c4\u5b9a\u4e00\u4e2a AC channel \u7531 Interconnect \u53d1\u9001 snoop \u8bf7\u6c42\uff0c\u4e00\u4e2a C channel \u8ba9 Master \u53d1\u9001\u54cd\u5e94\u3002\u8fd9\u5c31\u76f8\u5f53\u4e8e TileLink \u91cc\u9762\u7684 B channel\uff08Probe \u8bf7\u6c42\uff09\u548c C channel\uff08ProbeAck \u54cd\u5e94\uff09\u3002\u5b9e\u9645 ACE \u548c\u521a\u624d\u8bbe\u8ba1\u7684\u5b9e\u9645\u6709\u4e00\u4e9b\u533a\u522b\uff0c\u628a C channel \u62c6\u6210\u4e86\u4e24\u4e2a\uff1aCR \u7528\u4e8e\u8fd4\u56de\u6240\u6709\u54cd\u5e94\uff0cCD \u7528\u4e8e\u8fd4\u56de\u90a3\u4e9b\u9700\u8981\u6570\u636e\u7684\u54cd\u5e94\u3002\u8fd9\u5c31\u50cf AW \u548c W \u7684\u5173\u7cfb\uff0c\u4e00\u4e2a\u4f20\u5730\u5740\uff0c\u4e00\u4e2a\u4f20\u6570\u636e\uff1b\u7c7b\u4f3c\u5730\uff0cCR \u4f20\u72b6\u6001\uff0cCD \u4f20\u6570\u636e\u3002</p> <p>\u90a3\u4e48 AC channel \u4e0a\u8981\u53d1\u9001\u4ec0\u4e48\u8bf7\u6c42\u5462\uff1f\u56de\u987e\u4e00\u4e0b\u4e0a\u9762\u5df2\u7ecf\u7528\u5230\u7684\u8bf7\u6c42\u7c7b\u578b\uff1a\u9700\u8981 snoop \u7684\u6709 ReadShared\uff0cReadUnique \u548c CleanUnique\uff0c\u4e0d\u9700\u8981 snoop \u7684\u6709 WriteBack\u3002\u90a3\u4e48\u76f4\u63a5\u901a\u8fc7 AC channel \u628a ReadShared\uff0cReadUnique \u548c CleanUnique \u8fd9\u4e09\u79cd\u8bf7\u6c42\u539f\u6837\u53d1\u9001\u7ed9\u9700\u8981 snoop \u7684 Cache \u5373\u53ef\u3002Cache \u5728 AC channel \u6536\u5230\u8fd9\u4e9b\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u518d\u505a\u76f8\u5e94\u7684\u52a8\u4f5c\u3002</p> <p>\u7b2c\u4e94\u4ef6\u4e8b\u60c5\uff1a\u9700\u8981\u4e00\u4e2a\u65b9\u6cd5\u6765\u901a\u77e5\u4e0b\u4e00\u7ea7 Cache/Interconnect\uff0c\u544a\u8bc9\u5b83\u7b2c\u4e00\u548c\u7b2c\u4e8c\u6b65\u5b8c\u6210\u4e86\u3002TileLink \u6dfb\u52a0\u4e86\u4e00\u4e2a\u989d\u5916\u7684 E channel \u6765\u505a\u8fd9\u4e2a\u4e8b\u60c5\uff0cACE \u66f4\u52a0\u7c97\u66b4\uff1a\u76f4\u63a5\u7528\u4e00\u5bf9 RACK \u548c WACK \u4fe1\u53f7\u6765\u5206\u522b\u8868\u793a\u6700\u540e\u4e00\u6b21\u8bfb\u548c\u5199\u5df2\u7ecf\u5b8c\u6210\u3002\u5173\u4e8e WACK \u548c RACK \u7684\u8ba8\u8bba\uff0c\u8be6\u89c1 What's the purpose for WACK and RACK for ACE and what's the relationship with WVALID and RVALID? \u3002</p> <p>\u8fd9\u65f6\u5019\u5df2\u7ecf\u57fa\u672c\u628a ACE \u534f\u8bae\u7684\u4fe1\u53f7\u548c\u5927\u4f53\u7684\u5de5\u4f5c\u6d41\u7a0b\u63a8\u5bfc\u51fa\u6765\u4e86\u3002\u4ece\u4fe1\u53f7\u4e0a\u6765\u770b\uff0cACE \u534f\u8bae\u5728 AXI \u7684\u57fa\u7840\u4e0a\uff0c\u6dfb\u52a0\u4e86\u4e09\u4e2a channel\uff1a</p> <ol> <li>AC: Coherent address channel, Input to master: ACADDR, ACSNOOP, ACPROT</li> <li>CR: Coherent response channel, Output from master: CRRESP</li> <li>CD: Coherent data channel, Output from master: CDDATA, CDLAST</li> </ol> <p>\u6b64\u5916\uff0c\u5df2\u6709\u7684 Channel \u4e5f\u6dfb\u52a0\u4e86\u4fe1\u53f7\uff1a</p> <ol> <li>ARSNOOP[3:0]/ARBAR[1:0]/ARDOMAIN[1:0]</li> <li>AWSNOOP[3:0]/AWBAR[1:0]/AWDOMAIN[1:0]/AWUNIQUE</li> <li>RRESP[3:2]</li> <li>RACK/WACK</li> </ol> <p>ACE \u534f\u8bae\u8fd8\u8bbe\u8ba1\u4e86\u4e00\u4e2a ACE-Lite \u7248\u672c\uff1aACE-Lite \u53ea\u5728\u5df2\u6709 Channel \u4e0a\u6dfb\u52a0\u4e86\u65b0\u4fe1\u53f7\uff0c\u6ca1\u6709\u6dfb\u52a0\u65b0\u7684 Channel\u3002\u56e0\u6b64\u5b83\u5185\u90e8\u4e0d\u80fd\u6709 Cache\uff0c\u4f46\u662f\u53ef\u4ee5\u8bbf\u95ee\u4e00\u81f4\u7684\u7f13\u5b58\u5185\u5bb9\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#chi","title":"CHI \u534f\u8bae","text":""},{"location":"hardware/cache_coherence_protocol/#_5","title":"\u4ecb\u7ecd","text":"<p>CHI \u534f\u8bae\u662f AMBA 5 \u6807\u51c6\u4e2d\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u524d\u8eab\u662f ACE \u534f\u8bae\u3002\u6700\u65b0\u7684 CHI \u6807\u51c6\u53ef\u4ee5\u4ece AMBA 5 CHI Architecture Specification \u5904\u4e0b\u8f7d\u3002</p> <p>\u76f8\u6bd4 AXI\uff0cCHI \u66f4\u52a0\u590d\u6742\uff0c\u8fdb\u884c\u4e86\u5206\u5c42\uff1a\u534f\u8bae\u5c42\uff0c\u7269\u7406\u5c42\u548c\u94fe\u8def\u5c42\u3002\u56e0\u6b64\uff0cCHI \u9002\u7528\u4e8e\u7247\u4e0a\u7f51\u7edc\uff0c\u652f\u6301\u6839\u636e Node ID \u8fdb\u884c\u8def\u7531\uff0c\u800c\u4e0d\u50cf AXI \u90a3\u6837\u53ea\u6309\u7167\u7269\u7406\u5730\u5740\u8fdb\u884c\u8def\u7531\u3002CHI \u7684\u5730\u4f4d\u5c31\u76f8\u5f53\u4e8e Intel \u7684\u73af\u5f62\u603b\u7ebf\u3002CHI \u4e5f\u53ef\u4ee5\u6865\u63a5\u5230 CCIX \u4e0a\uff0c\u7528 CCIX \u8fde\u63a5 SMP \u7684\u7684\u591a\u4e2a Socket\uff0c\u6216\u8005\u8fde\u63a5\u652f\u6301 CCIX \u7684\u663e\u5361\u7b49\u7b49\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#_6","title":"\u7f13\u5b58\u884c\u72b6\u6001","text":"<p>\u9996\u5148\u56de\u987e ACE \u7684\u7f13\u5b58\u884c\u72b6\u6001\uff0c\u5171\u6709\u4e94\u79cd\uff0c\u4e0e MOESI \u76f8\u5bf9\u5e94\uff1a</p> <ol> <li>UniqueDirty: Modified</li> <li>SharedDirty: Owned</li> <li>UniqueClean: Exclusive</li> <li>SharedClean: Shared</li> <li>Invalid: Invalid</li> </ol> <p>\u5728\u6b64\u57fa\u7840\u4e0a\uff0cCHI \u8003\u8651\u7f13\u5b58\u884c\u53ea\u6709\u90e8\u5206\u5b57\u8282\u6709\u6548\u7684\u60c5\u51b5\uff0c\u5373 Full\uff0cPartial \u6216\u8005 Empty\u3002\u56e0\u6b64 CHI \u7684\u7f13\u5b58\u884c\u72b6\u6001\u5171\u6709\u4e03\u79cd\uff1a</p> <ol> <li>UniqueDirty: Modified</li> <li>UniqueDirtyPartial: \u65b0\u589e\uff0c\u53ef\u80fd\u6709\u90e8\u5206\u5b57\u8282\u5408\u6cd5\uff0c\u5728\u5199\u56de\u7684\u65f6\u5019\uff0c\u9700\u8981\u548c\u4e0b\u4e00\u7ea7\u7f13\u5b58\u6216\u8005\u5185\u5b58\u4e2d\u7684\u5408\u6cd5\u7f13\u5b58\u884c\u5185\u5bb9\u8fdb\u884c\u5408\u5e76</li> <li>SharedDirty: Owned</li> <li>UniqueClean: Exclusive</li> <li>UniqueCleanEmpty: \u65b0\u589e\uff0c\u6240\u6709\u5b57\u8282\u90fd\u4e0d\u5408\u6cd5\uff0c\u4f46\u662f\u672c\u7f13\u5b58\u5360\u6709\u8be5\u7f13\u5b58\u884c\uff0c\u5982\u679c\u8981\u4fee\u6539\u7684\u8bdd\uff0c\u4e0d\u9700\u8981\u901a\u77e5\u5176\u4ed6\u7f13\u5b58</li> <li>SharedClean: Shared</li> <li>Invalid: Invalid</li> </ol> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6bd4\u8f83\u7279\u522b\u7684\u5c31\u662f UniqueDirtyPartial \u548c UniqueCleanEmpty\u3002CHI \u6807\u51c6\u5728 4.1.1 \u7ae0\u8282\u7ed9\u51fa\u4e86\u4f7f\u7528\u573a\u666f\uff1a\u5982\u679c\u4e00\u4e2a CPU \u5373\u5c06\u8981\u5199\u5165\u4e00\u7247\u5185\u5b58\uff0c\u90a3\u4e48\u53ef\u4ee5\u5148\u8f6c\u6362\u5230 UniqueCleanEmpty \u72b6\u6001\u4e2d\uff0c\u628a\u5176\u4ed6\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u90fd\u6e05\u7a7a\uff0c\u8fd9\u6837\u540e\u7eed\u5199\u5165\u7684\u65f6\u5019\uff0c\u4e0d\u9700\u8981\u8be2\u95ee\u5176\u4ed6\u7f13\u5b58\uff0c\u6027\u80fd\u6bd4\u8f83\u597d\u3002\u4f46\u6b64\u65f6\u56e0\u4e3a\u6570\u636e\u8fd8\u6ca1\u5199\u8fdb\u53bb\uff0c\u6240\u4ee5\u5c31\u662f Empty\uff0c\u53ea\u66f4\u65b0\u72b6\u6001\uff0c\u4e0d\u5360\u7528\u7f13\u5b58\u7684\u7a7a\u95f4\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c CPU \u53ea\u5199\u4e86\u7f13\u5b58\u884c\u7684\u4e00\u90e8\u5206\u5b57\u8282\uff0c\u5176\u4ed6\u90e8\u5206\u6ca1\u6709\u78b0\uff0c\u90a3\u4e48\u5f15\u5165 UniqueDirtyPartial \u4ee5\u540e\uff0c\u53ef\u4ee5\u628a\u5408\u5e76\u65b0\u65e7\u7f13\u5b58\u884c\u6570\u636e\u8fd9\u4e00\u6b65\uff0c\u4e0b\u653e\u5230\u6bd4\u8f83\u9760\u8fd1\u5185\u5b58\u7684\u5c42\u7ea7\u4e0a\uff0c\u51cf\u5c11\u4e86\u6570\u636e\u642c\u8fd0\u7684\u6b21\u6570\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#chi_1","title":"CHI \u7f51\u7edc\u8282\u70b9","text":"<p>CHI \u7684\u8282\u70b9\u7ec4\u7ec7\u6210\u4e00\u4e2a\u7f51\u7edc\uff0c\u53ef\u80fd\u662f\u7247\u4e0a\u7f51\u7edc\uff0c\u4e5f\u53ef\u80fd\u662f\u7247\u95f4\u7684\u8fde\u63a5\u3002CHI \u7684\u8282\u70b9\u5206\u6210\u4e09\u79cd\u7c7b\u578b\uff1a</p> <ol> <li>Request Node\uff1a\u53d1\u8d77 CHI \u8bf7\u6c42\u7684\u8282\u70b9\uff0c\u5bf9\u5e94 CPU \u7684\u7f13\u5b58\uff0c\u6216\u8005\u662f\u7f51\u5361\u7b49\u5916\u8bbe</li> <li>Home Node\uff1a\u7ba1\u7406 Request Node \u6765\u7684\u8bf7\u6c42\uff0c\u5bf9\u5e94\u6700\u540e\u4e00\u7ea7\u7f13\u5b58</li> <li>Subordinate Node\uff1a\u5904\u7406 Home Node \u6765\u7684\u8bf7\u6c42\uff0c\u5bf9\u5e94\u5185\u5b58\u6216\u8005\u663e\u5b58\u7b49\u6709\u5185\u5b58\u7684\u5916\u8bbe</li> </ol> <p>\u5728\u8fd9\u79cd\u8bbe\u8ba1\u4e0b\uff0cNode \u4e4b\u95f4\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u56e0\u6b64\u65b9\u4fbf\u505a\u4e00\u4e9b\u65b0\u7684\u4f18\u5316\u3002\u4f8b\u5982\u4f20\u7edf\u7684\u7f13\u5b58\u5c42\u6b21\u91cc\uff0c\u8bf7\u6c42\u662f\u4e00\u7ea7\u4e00\u7ea7\u4e0b\u53bb\uff0c\u54cd\u5e94\u518d\u4e00\u7ea7\u4e00\u7ea7\u4e0a\u6765\u3002\u4f46\u662f CHI \u53ef\u80fd\u662f Request Node \u53d1\u7ed9 Home Node \u7684\u8bf7\u6c42\uff0c\u54cd\u5e94\u76f4\u63a5\u7531 Subordinate Node \u53d1\u9001\u56de Request Node \u4e86\u3002</p>"},{"location":"hardware/cache_coherence_protocol/#_7","title":"\u8bfb\u8bf7\u6c42","text":"<p>CHI \u63d0\u4f9b\u4e86\u590d\u6742\u6027\u7684\u540c\u65f6\uff0c\u4e5f\u5e26\u6765\u4e86\u5f88\u591a\u7684\u7075\u6d3b\u6027\uff0c\u4e5f\u610f\u5473\u7740\u6f5c\u5728\u7684\u6027\u80fd\u4f18\u5316\u7684\u53ef\u80fd\u3002\u4f8b\u5982\u5728 CHI \u4e2d\u5b9e\u73b0\u4e00\u4e2a\u8bfb\u64cd\u4f5c\uff0c\u53ef\u80fd\u6709\u5f88\u591a\u79cd\u8fc7\u7a0b\uff08CHI \u6807\u51c6\u7b2c 2.3.1 \u7ae0\u8282\uff09\uff1a</p> <p>\u7b2c\u4e00\u79cd\u662f Home Node \u76f4\u63a5\u63d0\u4f9b\u4e86\u6570\u636e\uff08Combined response from home\uff09\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    Requester-&gt;&gt;Home: Read*\n    Home-&gt;&gt;Requester: CompData\n    Requester-&gt;&gt;Home: CompAck\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u662f Home Node \u628a\u54cd\u5e94\u62c6\u6210\u4e24\u4efd\uff0c\u4e00\u4efd\u8868\u793a\u8bfb\u53d6\u7ed3\u679c\uff0c\u4e00\u4efd\u643a\u5e26\u8bfb\u53d6\u7684\u6570\u636e\uff08Separate data and response from Home\uff09\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    Requester-&gt;&gt;Home: Read*\n    Home-&gt;&gt;Requester: RespSepData\n    Home-&gt;&gt;Requester: DataSepResp\n    Requester-&gt;&gt;Home: CompAck\n</code></pre> <p>\u7b2c\u4e09\u79cd\u662f Home Node \u6ca1\u6709\u6570\u636e\uff0c\u8f6c\u800c\u8be2\u95ee Subordinate\uff0cSubordinate \u628a\u7ed3\u679c\u76f4\u63a5\u53d1\u56de\u7ed9\u4e86 Requester\uff08Combined response from Subordinate\uff09\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    participant Subordinate\n    Requester-&gt;&gt;Home: Read*\n    Home-&gt;&gt;Subordinate: ReadNoSnp\n    Subordinate-&gt;&gt;Requester: CompData\n    Requester-&gt;&gt;Home: CompAck\n</code></pre> <p>\u7b2c\u56db\u79cd\u662f Home Node \u6ca1\u6709\u6570\u636e\uff0c\u8f6c\u800c\u8be2\u95ee Subordinate\uff0c\u4f46\u8fd9\u6b21\u63d0\u524d\u544a\u8bc9 Requester \u8bfb\u53d6\u7684\u7ed3\u679c\uff0c\u6700\u540e Subordinate \u628a\u7ed3\u679c\u53d1\u56de\u7ed9\u4e86 Requester\uff08Response from Home, Data from Subordinate\uff09\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    participant Subordinate\n    Requester-&gt;&gt;Home: Read*\n    Home-&gt;&gt;Requester: RespSepData\n    Home-&gt;&gt;Subordinate: ReadNoSnpSep\n    Subordinate-&gt;&gt;Home: ReadReceipt\n    Subordinate-&gt;&gt;Requester: DataSepResp\n    Requester-&gt;&gt;Home: CompAck\n</code></pre> <p>\u7b2c\u4e94\u79cd\u662f\u6570\u636e\u5728\u5176\u4ed6\u7684 Requester Node \u4e2d\uff0c\u6b64\u65f6 Home \u8d1f\u8d23 Snoop\uff08Forwarding snoop\uff09\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    participant Snoopee\n    Requester-&gt;&gt;Home: Read*\n    Home-&gt;&gt;Snoopee: Snp*Fwd\n    Snoopee-&gt;&gt;Requester: CompData\n    Snoopee-&gt;&gt;Home: SnpRespFwded\n    Requester-&gt;&gt;Home: CompAck\n</code></pre> <p>\u7b2c\u516d\u79cd\u662f MakeReadUnique\uff0c\u6b64\u65f6\u53ea\u66f4\u65b0\u6743\u9650\uff0c\u4e0d\u6d89\u53ca\u6570\u636e\u7684\u4f20\u8f93\uff08MakeReadUnique only\uff09\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    Requester-&gt;&gt;Home: MakeReadUnique\n    Home-&gt;&gt;Requester: Comp\n    Requester-&gt;&gt;Home: CompAck\n</code></pre>"},{"location":"hardware/cache_coherence_protocol/#_8","title":"\u5199\u8bf7\u6c42","text":"<p>CHI \u6807\u51c6\u7b2c 2.3.2 \u63cf\u8ff0\u4e86\u5199\u8bf7\u6c42\u7684\u6d41\u7a0b\u3002\u548c\u8bfb\u8bf7\u6c42\u4e00\u6837\uff0c\u5199\u8bf7\u6c42\u4e5f\u6709\u5f88\u591a\u7c7b\u578b\uff0c\u4e0b\u9762\u8fdb\u884c\u4ecb\u7ecd\u3002\u4e0e\u8bfb\u8bf7\u6c42\u4e0d\u540c\u7684\u70b9\u5728\u4e8e\uff0c\u5199\u5165\u7684\u65f6\u5019\uff0c\u5e76\u4e0d\u662f\u76f4\u63a5\u628a\u5199\u5165\u7684\u5730\u5740\u548c\u6570\u636e\u7b49\u4e00\u6b21\u6027\u53d1\u9001\u8fc7\u53bb\uff0c\u800c\u662f\u5148\u53d1\u4e00\u4e2a\u5199\u6d88\u606f\uff0c\u5bf9\u65b9\u56de\u590d\u53ef\u4ee5\u53d1\u9001\u6570\u636e\u4e86\uff08DBIDResp\uff09\uff0c\u518d\u628a\u5b9e\u9645\u7684\u6570\u636e\u4f20\u8f93\u8fc7\u53bb\uff08NCBWrData\uff09\u3002\u5f53\u7136\u4e86\uff0c\u4e5f\u53ef\u4ee5\u4e2d\u9014\u53cd\u6094\uff08WriteDataCancel\uff09\u3002</p> <p>\u7b2c\u4e00\u79cd\u662f Direct Write-data Transfer\uff0c\u610f\u601d\u662f\u6570\u636e\u8981\u4ece Requester \u76f4\u63a5\u4f20\u5230 Subordinate \u4e0a\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    participant Subordinate\n    Requester-&gt;&gt;Home: Write*\n    Home-&gt;&gt;Subordinate: Write*\n    Subordinate-&gt;&gt;Requester: DBIDResp\n    Requester-&gt;&gt;Subordinate: NCBWrData/WriteDataCancel\n    Subordinate-&gt;&gt;Home: Comp\n    Home-&gt;&gt;Requester: Comp\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u6bd4\u8f83\u5e38\u89c4\uff0c\u5c31\u662f\u628a\u6570\u636e\u5199\u7ed9 Home Node\uff0c\u5176\u4e2d Comp \u8868\u793a\u8bfb\u53d6\u7ed3\u679c\uff0cDBIDResp \u8868\u793a\u53ef\u4ee5\u53d1\u5199\u5165\u7684\u5185\u5bb9\u4e86\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    Requester-&gt;&gt;Home: Write*\n    Home-&gt;&gt;Requester: DBIDResp/DBIDRespOrd\n    Home-&gt;&gt;Requester: Comp\n    Requester-&gt;&gt;Home: NCBWrData/WriteDataCancel\n</code></pre> <p>\u7b2c\u4e09\u79cd\u662f\u628a\u7b2c\u4e8c\u79cd\u7684 DBIDResp \u548c Comp \u5408\u5e76\u6210\u4e00\u4e2a\u54cd\u5e94\uff1a</p> <pre><code>sequenceDiagram\n    participant Requester\n    participant Home\n    Requester-&gt;&gt;Home: Write*\n    Home-&gt;&gt;Requester: CompDBIDResp\n    Requester-&gt;&gt;Home: NCBWrData/WriteDataCancel\n</code></pre>"},{"location":"hardware/cache_coherence_protocol/#_9","title":"\u53c2\u8003\u6587\u6863","text":"<ul> <li>Cache coherence</li> <li>MSI protocol</li> <li>Write-once (cache coherence)</li> <li>MESI protocol</li> <li>MOESI protocol</li> <li>Dragon protocol</li> <li>A Strategy to Verify an AXI/ACE Compliant Interconnect (2 of 4)</li> <li>Directory-based cache coherence</li> <li>TileLink spec</li> <li>rocket-chip</li> <li>IHI0022E-AMBA AXI and ACE</li> </ul>"},{"location":"hardware/cmos/","title":"CMOS","text":""},{"location":"hardware/cmos/#mosfet","title":"MOSFET","text":"<p>MOSFET \u6709\u4e24\u79cd\uff1aNMOS \u548c PMOS\uff0c\u7535\u8def\u7b26\u53f7\u5982\u4e0b\uff1a</p>    ![MOSFET](cmos_mosfet.png){ width=\"400\" }   PMOS \u548c NMOS \u7684\u7535\u8def\u7b26\u53f7\uff08\u56fe\u6e90 Wikipedia\uff09 <p>PMOS \u548c NMOS \u90fd\u6709\u4e09\u4e2a\u7535\u6781\uff0c\u5206\u522b\u662f\u6e90\u7ea7\uff08Source\uff09\uff0c\u6805\u7ea7\uff08Gate\uff09\u548c\u6f0f\u7ea7\uff08Drain\uff09\u3002MOSFET \u7684\u7279\u70b9\u662f\uff0c\u5728 D \u5230 S \u7684\u7535\u6d41\u53d7\u5230 G \u4e5f\u5c31\u662f\u6805\u7ea7\u7684\u7535\u538b\u7684\u63a7\u5236\uff1a</p> <ol> <li>\u5f53 V_{GS} &lt; V_{th} \u65f6\uff0cI_D=0\uff0c\u6b64\u65f6 MOSFET \u5904\u4e8e\u65ad\u5f00\u7684\u72b6\u6001</li> <li>\u5f53 V_{GS} &gt; V_{th}, V_{GD} &gt; V_{th} \u65f6\uff0cI_D=\\frac{1}{2}\\mu_nC_{ox}\\frac{W}{L}(2(V_{GS}-V_{th})V_{DS}-V_{DS}^2)\uff0c\u6b64\u65f6 MOSFET \u5904\u4e8e\u7ebf\u6027\u533a</li> <li>\u5f53 V_{GS} &gt; V_{th}, V_{GD} &lt; V_{th} \u65f6\uff0cI_D=\\frac{1}{2}\\mu_nC_{ox}\\frac{W}{L}(V_{GS}-V_{th})^2[1+\\lambda(V_{DS}-V_{DSsat})]\uff0c\u6b64\u65f6 MOSFET \u5904\u4e8e\u9971\u548c\u533a</li> </ol> <p>\u8fd9\u91cc\u7684\u7ebf\u6027\u533a\u548c\u9971\u548c\u533a\u662f\u5728 I_D - V_{DS} \u7279\u6027\u66f2\u7ebf\u4e0a\u8bf4\u7684\uff08\u89c1\u4e0b\u56fe\uff09\uff0c\u610f\u601d\u662f\u5f53 V_{GS} &gt; V_{th} \u7684\u65f6\u5019\uff0c\u968f\u7740 V_{DS} \u7684\u589e\u5927\uff0cI_D \u9996\u5148\u4f1a\u589e\u5927\uff0c\u76f4\u5230 V_{GD} &gt; V_{th} \u7684\u65f6\u5019\uff0cI_D \u9971\u548c\uff0c\u51e0\u4e4e\u4e0d\u518d\u589e\u52a0\u3002\u4e25\u683c\u6765\u8bb2\uff0c\u6240\u8c13\u7684\u7ebf\u6027\u533a\uff0c\u5b9e\u9645\u4e0a\u4e5f\u4e0d\u662f\u76f4\u7ebf\uff0c\u800c\u662f\u629b\u7269\u7ebf\u3002</p>    ![I_D - V_{DS} Curve](cmos_id_vds.png){ width=\"400\" }    I<sub>D</sub> - V<sub>DS</sub> \u7279\u5f81\u66f2\u7ebf\uff08\u56fe\u6e90\u6e05\u534e\u5927\u5b66\u5f20\u96f7\u8001\u5e08\u7535\u5b50\u5b66\u57fa\u7840\u8bfe\u7a0b\u7684\u8bfe\u4ef6\uff09 <p>PMOS \u548c NMOS \u7684\u533a\u522b\u662f\u7535\u6d41\u7684\u65b9\u5411\u4e0d\u540c\u3002PMOS \u7535\u6d41\u4ece S \u6d41\u5411 D\uff0cNMOS \u7535\u6d41\u4ece D \u548c S\u3002\u5982\u679c\u6ce8\u610f\u5230\u4e0a\u9762 MOSFET \u7684\u7b26\u53f7\u7684\u753b\u6cd5\uff0c\u4f1a\u53d1\u73b0\u7535\u6d41\u90fd\u662f\u4ece\u4e0a\u9762\u5f80\u4e0b\u6d41\u3002\u6b64\u5916\u8fd8\u6709\u4e00\u4e2a\u89c4\u5f8b\uff0c\u7bad\u5934\u8fde\u63a5\u7684\u90a3\u4e00\u4fa7\u5c31\u662f S\u3002</p>"},{"location":"hardware/cmos/#cmos_1","title":"\u6570\u5b57\u7535\u8def\u4e2d\u7684 CMOS","text":"<p>CMOS \u5168\u79f0\u662f Complementary metal\u2013oxide\u2013semiconductor\uff0c\u610f\u601d\u5c31\u662f\u62ff PMOS \u548c NMOS \u7684\u7ec4\u5408\u6765\u5b9e\u73b0\u7535\u8def\u3002\u5f53 CMOS \u88ab\u7528\u6765\u5b9e\u73b0\u6570\u5b57\u7535\u8def\u7684\u65f6\u5019\uff0cPMOS \u548c NMOS \u7ecf\u5e38\u6210\u5bf9\u51fa\u73b0\uff0cPMOS \u63a5\u5230 V_{DD}\uff0cNMOS \u63a5\u5230 GND \u4e0a\u3002\u4f8b\u5982\u7528 PMOS \u548c NMOS \u5b9e\u73b0\u4e00\u4e2a\u975e\u95e8\uff08NOT gate\uff09\uff1a</p>    ![CMOS Not Gate](cmos_not_gate.png){ width=\"400\" }    CMOS \u5b9e\u73b0\u975e\u95e8\uff08\u56fe\u6e90 CMOS Logic Gate - Geeks for Geeks\uff09 <p>\u5f53\u8f93\u5165\u4e3a\u9ad8\u7535\u5e73\u7684\u65f6\u5019\uff0cNMOS \u5bfc\u901a\uff0cPMOS \u65ad\u5f00\uff0c\u6b64\u65f6\u8f93\u51fa\u901a\u8fc7 NMOS \u63a5\u5230\u4e86\u5730\u4e0a\uff0c\u6240\u4ee5\u8f93\u51fa\u4f4e\u7535\u5e73\u3002\u5f53\u8f93\u5165\u4e3a\u4f4e\u7535\u5e73\u7684\u65f6\u5019\uff0cPMOS \u5bfc\u901a\uff0cNMOS \u65ad\u5f00\uff0c\u6b64\u65f6\u8f93\u51fa\u901a\u8fc7 PMOS \u63a5\u5230\u4e86\u7535\u6e90\u4e0a\uff0c\u6240\u4ee5\u8f93\u51fa\u9ad8\u7535\u5e73\u3002\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u4e0e\u975e\u95e8\uff08NAND gate\uff09\u548c\u6216\u975e\u95e8\uff08NOR gate\uff09\uff1a</p>    ![CMOD NAND and NOR Gate](cmos_nand_nor_gate.png){ width=\"400\" }    CMOS \u5b9e\u73b0\u4e0e\u975e\u95e8\u548c\u6216\u975e\u95e8\uff08\u56fe\u6e90 CMOS Logic Gate - Geeks for Geeks\uff09 <p>\u4ee5\u53ca\u5728\u5de5\u827a\u5e93\u91cc\u5e38\u89c1\u7684 AOI\uff08And Or Invert\uff09\u548c OAI\uff08Or And Invert\uff09\u95e8\uff1a</p>    ![CMOD AOI and OAI Gate](cmos_aoi_oai_gate.png){ width=\"400\" }    CMOS \u5b9e\u73b0 AOI \u548c OAI \u95e8\uff08\u56fe\u6e90 CMOS Logic Gate - Geeks for Geeks\uff09 <p>CMOS \u5728\u5b9e\u73b0\u6570\u5b57\u7535\u8def\u7684\u65f6\u5019\uff0c\u5e76\u6ca1\u6709\u7528\u5230\u5b83\u7684\u7ebf\u6027\u533a\u548c\u9971\u548c\u533a\u7684\u7279\u6027\uff0c\u53ea\u7528\u5230\u4e86 V_{GS} \u548c V_{th} \u7684\u5927\u5c0f\u4ee5\u53ca\u662f\u5426\u6709\u7535\u6d41\u7684\u5173\u7cfb\uff0c\u53ef\u4ee5\u8ba4\u4e3a PMOS \u548c NMOS \u5c31\u662f\u4e00\u4e2a\u7528\u7535\u538b\u63a7\u5236\u7684\u5f00\u5173\u3002</p>"},{"location":"hardware/display_interface/","title":"\u663e\u793a\u63a5\u53e3","text":""},{"location":"hardware/display_interface/#vga","title":"VGA","text":"<p>VGA \u91c7\u7528 15-pin \u7684\u8fde\u63a5\u5668\uff0c\u5305\u62ec RGB \u4e09\u79cd\u989c\u8272\uff0cHSync \u548c VSync \u4fe1\u53f7\uff0c\u8fd8\u6709\u53ef\u9009\u7684 DDC \u63a5\u53e3\u3002\u6bcf\u79cd\u989c\u8272\u5bf9\u5e94\u4e00\u4e2a pin\uff0c\u91c7\u7528\u6a21\u62df\u4fe1\u53f7\u65b9\u5f0f\u4f20\u8f93\u3002VGA \u6709\u4e0d\u540c\u7684\u5206\u8fa8\u7387\u548c\u5237\u65b0\u7387\u65f6\u5e8f\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u50cf\u7d20\u65f6\u949f\u9891\u7387\uff0c\u4ee5\u53ca HSync \u548c VSync \u7684\u6ce2\u5f62\u3002</p> <p>VGA \u4e0d\u652f\u6301\u4f20\u8f93\u97f3\u9891\u3002</p> <p>\u53c2\u8003\uff1aWikipedia</p>"},{"location":"hardware/display_interface/#dvi","title":"DVI","text":"<p>DVI \u6709\u4e0d\u540c\u7684\u7248\u672c\uff0cDVI-A \u517c\u5bb9 VGA \u63a5\u53e3\uff0c\u53ea\u4f20\u8f93\u6a21\u62df\u4fe1\u53f7\uff1bDVI-D \u5219\u662f\u91c7\u7528 TMDS \u5dee\u5206\u4fe1\u53f7\u4f20\u8f93\u6570\u5b57\u4fe1\u53f7\uff0c\u517c\u5bb9 HDMI\uff1bDVI-I \u5219\u517c\u5bb9 DVI-A \u548c DVI-D\u3002</p> <p>\u56e0\u6b64 DVI \u8f6c VGA \u6216\u8005 DVI \u8f6c HDMI \u7684\u8f6c\u6362\u5668\u5185\u90e8\u4e0d\u9700\u8981\u505a\u6570\u6a21\u8f6c\u6362\uff0c\u4f46\u662f\u8981\u6c42\u53e6\u4e00\u4fa7\u7684\u8bbe\u5907\u652f\u6301\u76f8\u5e94\u7684\u4f20\u8f93\u5f62\u5f0f\uff0c\u4f8b\u5982 DVI \u8f6c VGA \u51fa\u6765\u5f97\u5230\u7684\u8fd8\u662f\u6a21\u62df\u4fe1\u53f7\uff0c\u5982\u679c\u53e6\u4e00\u4fa7\u7684\u8bbe\u5907\u53ea\u652f\u6301\u5728 DVI \u4e0a\u8d70\u6570\u5b57\u4fe1\u53f7\uff0c\u5219\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>DVI \u5728\u4f20\u8f93\u6570\u5b57\u4fe1\u53f7\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u91c7\u7528 3 \u5bf9\uff08Single link\uff09\u6216\u8005 6 \u5bf9\uff08Dual link\uff09TMDS \u5dee\u5206\u4fe1\u53f7\u4f20\u8f93\u89c6\u9891\u4fe1\u53f7\uff0c\u6b64\u5916\u8fd8\u6709\u4e00\u5bf9 TMDS \u5dee\u5206\u65f6\u949f\u3002\u5176\u4e2d Single link \u6a21\u5f0f\u548c HDMI \u662f\u517c\u5bb9\u7684\u3002</p> <p>TMDS \u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u5185\uff0c\u4f20\u8f93 8 bit \u7684\u6570\u636e\uff0c\u8fd9 8 \u4f4d\u7684\u6570\u636e\u7ecf\u8fc7 8b/10b \u7f16\u7801\u5728\u5dee\u5206\u5bf9\u4e0a\u4f20\u8f93\u3002\u56e0\u6b64\u5bf9\u4e8e 165 MHz \u7684 TMDS \u65f6\u949f\uff0c\u4f20\u8f93\u89c6\u9891\u6570\u636e\u7684\u901f\u7387\u662f 165 \\mathrm{MHz} * 3 * 8 = 3.96 \\mathrm{Gbps}\u3002</p> <p>DVI \u4e0d\u652f\u6301\u4f20\u8f93\u97f3\u9891\u3002</p> <p>\u53c2\u8003\uff1aWikipedia</p>"},{"location":"hardware/display_interface/#hdmi","title":"HDMI","text":"<p>HDMI \u5728\u4e09\u5bf9 TMDS \u5dee\u5206\u4fe1\u53f7\u4e0a\u4f20\u8f93\u6570\u636e\uff0c\u6b64\u5916\u8fd8\u6709\u4e00\u5bf9 TMDS \u5dee\u5206\u65f6\u949f\u548c DDC\u3002\u5e38\u89c1\u7684\u8fde\u63a5\u5668\u662f Type A\uff0c\u6709\u65f6\u5019\u4e5f\u80fd\u770b\u5230\u6bd4\u8f83\u5c0f\u7684 Mini HDMI\uff08Type C\uff09\u548c\u66f4\u5c0f\u7684 Micro HDMI\uff08Type D\uff09\u3002</p> <p>HDMI \u9664\u4e86\u4f20\u8f93\u89c6\u9891\uff0c\u8fd8\u652f\u6301\u4f20\u8f93\u97f3\u9891\u3002</p> <p>HDMI \u968f\u7740\u7248\u672c\u66f4\u65b0\uff0c\u9010\u6e10\u63d0\u9ad8\u4e86 TMDS \u65f6\u949f\u9891\u7387\u3002HDMI 1.0 \u7248\u672c\u548c DVI \u4e00\u6837\uff0c\u6700\u9ad8 TMDS \u65f6\u949f\u662f 165 MHz\uff0c\u4e0d\u8ba1\u5165 8b/10b \u7f16\u7801\u635f\u8017\u7684\u8bdd\uff08\u4e0b\u540c\uff09\uff0c\u4f20\u8f93\u901f\u7387\u662f 165 \\mathrm{MHz} * 3 * 10 = 4.95 \\mathrm{Gbps}\uff1bHDMI 1.3 \u7248\u672c\u628a TMDS \u65f6\u949f\u63d0\u9ad8\u5230\u4e86 340 MHz\uff0c\u4f20\u8f93\u901f\u7387\u8fbe\u5230 340 \\mathrm{MHz} * 3 * 10 = 10.2 \\mathrm{Gbps}\u3002HDMI 2.0 \u7248\u672c\u63d0\u9ad8\u5230\u4e86 600MHz\uff0c\u4f20\u8f93\u901f\u7387\u8fbe\u5230 600 \\mathrm{MHz} * 3 * 10 = 18 \\mathrm{Gbps}\u3002</p> <p>HDMI 2.1 \u4e0d\u518d\u4f7f\u7528\u5355\u72ec\u7684 TMDS \u65f6\u949f\u5dee\u5206\u5bf9\uff0c\u628a\u6700\u540e\u4e00\u5bf9\u4e5f\u7528\u6765\u4f20\u8f93\u6570\u636e\uff0c\u628a\u6570\u636e\u7f16\u7801\u4ece 8b/10b \u6539\u6210\u4e86 16b/18b\uff0c\u4f20\u8f93\u901f\u7387\u8fbe\u5230 4 * 12 \\mathrm{Gbps} = 48 \\mathrm{Gbps}\uff0c\u76f8\u6bd4 HDMI 2.0 \u6709\u4e86\u5de8\u5927\u7684\u63d0\u5347\u3002\u6309\u7167 16b/18b \u7b97\uff0c\u6570\u636e\u901f\u7387\u662f 42.7 Gbps\uff0c\u4f46 HDMI 2.1 \u8fd8\u6709\u989d\u5916\u7684 FEC \u5f00\u9500\uff08RS(255,251)\uff09\uff0c\u6298\u7b97\u4e0b\u6765\u662f 48 \\mathrm{Gbps} * 16 / 18 * 251 / 255 = 42.0 \\mathrm{Gbps}\u3002</p> <p>\u4e0b\u9762\u662f\u8fd9\u51e0\u4ee3 HDMI \u7684\u5bf9\u6bd4\uff0c\u5176\u4e2d HDMI 2.1 \u7248\u672c\u6ca1\u8003\u8651 FEC \u5f00\u9500\uff1a</p> 1.0-1.2 1.3-1.4 2.0 2.1 \u4f20\u8f93\u901f\u7387 4.95 Gbps 10.2 Gbps 18 Gbps 48 Gbps \u6570\u636e\u901f\u7387 3.96 Gbps 8.16 Gbps 14.4 Gbps 42.0 Gbps \u7f16\u7801\u65b9\u5f0f 8b/10b 8b/10b 8b/10b 16b/18b \u5206\u8fa8\u7387 1080p 60Hz 1440p 75Hz 4k 60Hz 8k 30Hz <p>\u4f46\u8fd9\u4e2a\u8868\u683c\u4e0d\u662f\u7edd\u5bf9\u7684\uff0c\u4f8b\u5982 HDMI 1.4b \u5728\u91c7\u7528\u4e0d\u5728 HDMI 1.4b \u6807\u51c6\u91cc\u4f46\u662f\u7531\u663e\u5361\u548c\u663e\u793a\u5668\u652f\u6301\u7684 YCbCr 420 \u65f6\uff0c\u4e5f\u53ef\u4ee5\u8f93\u51fa 4k 60Hz \u7684\u5206\u8fa8\u7387\uff1aNVIDIA Kepler Cards Get HDMI 4K@60Hz Support (Kind Of)\u3002</p> <p>HDMI 2.1 \u8fd8\u652f\u6301 DSC \u89c6\u9891\u6d41\u538b\u7f29\uff0c\u53ef\u4ee5\u652f\u6301\u66f4\u9ad8\u7684\u5206\u8fa8\u7387\uff0c\u5982 8k 60Hz \u751a\u81f3 8k 120Hz\u3002</p> <p>\u53c2\u8003\uff1aWikipedia HDMI 2.1 FEC RX IP Core</p>"},{"location":"hardware/display_interface/#displayport","title":"DisplayPort","text":"<p>DisplayPort \u91c7\u7528\u56db\u5bf9\u5dee\u5206\u5bf9\u6765\u4f20\u8f93\u6570\u636e\uff0c\u652f\u6301\u89c6\u9891\u548c\u97f3\u9891\u7b49\u3002</p> <p>DisplayPort 1.0 \u7248\u672c\u652f\u6301 10.8 Gbps \u7684\u4f20\u8f93\u901f\u7387\uff08\u7f16\u7801\u65b9\u5f0f 8b/10b\uff0c\u56e0\u6b64\u6570\u636e 8.64 Gbps\uff09\u3002DisplayPort 1.2 \u7248\u672c\u901f\u7387\u7ffb\u500d\uff0c\u8fbe\u5230\u4e86 21.6 Gbps\uff08\u6570\u636e 17.28 Gbps\uff09\u3002DisplayPort 1.3 \u8fdb\u4e00\u6b65\u63d0\u9ad8\u5230\u4e86 32.4 Gbps\uff08\u6570\u636e 25.92 Gbps\uff09\u3002DisplayPort 2.0 \u8fdb\u4e00\u6b65\u63d0\u9ad8\u5230 80 Gbps\uff08\u7f16\u7801\u65b9\u5f0f 128b/132b\uff09\uff0c\u6570\u636e\u901f\u7387 77.37 Gbps\uff08\u8ba1\u7b97\u516c\u5f0f\u4e0d\u660e\uff09\u3002</p> <p>DisplayPort \u53ef\u4ee5\u5728 USB Type C \u4e0a\u901a\u8fc7 Alternate Mode \u4f20\u8f93\u3002</p> <p>\u5728\u7b14\u8bb0\u672c\u6216\u624b\u673a\u4e2d\uff0c\u5185\u7f6e\u7684\u663e\u793a\u5668\u53ef\u80fd\u4f1a\u91c7\u7528 eDP \u63a5\u53e3\u3002</p> <p>\u53c2\u8003\uff1aWikipedia</p>"},{"location":"hardware/display_interface/#sdi","title":"SDI","text":"<p>SDI \u5168\u79f0 Serial Digital Interface\uff0c\u5728\u540c\u8f74\u7535\u7f06\u4e0a\uff0c\u4e32\u884c\u4f20\u8f93\u89c6\u9891\u6570\u636e\u3002</p> <p>\u53c2\u8003\uff1aWikipedia</p>"},{"location":"hardware/error_detection_correction_code/","title":"\u68c0\u9519\u7ea0\u9519\u7801","text":""},{"location":"hardware/error_detection_correction_code/#_2","title":"\u7406\u8bba","text":"<p>\u5728\u6570\u636e\u4f20\u8f93\u65f6\uff0c\u8003\u8651\u5230\u5404\u79cd\u56e0\u7d20\u7684\u5370\u8c61\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u90e8\u5206\u6570\u636e\u51fa\u9519\uff0c\u6b64\u65f6\u9700\u8981\u4f7f\u7528\u4e00\u4e9b\u7f16\u7801\u65b9\u6cd5\uff0c\u4f7f\u5f97\u63a5\u53d7\u65b9\u53ef\u4ee5\u68c0\u6d4b\u51fa\u9519\u8bef\uff0c\u8ba9\u53d1\u9001\u65b9\u91cd\u65b0\u4f20\u8f93\uff1b\u6216\u8005\u8ba9\u63a5\u53d7\u65b9\u76f4\u63a5\u7ea0\u6b63\u9519\u8bef\u3002\u968f\u7740\u4f20\u8f93\u901f\u5ea6\u4e0d\u65ad\u63d0\u9ad8\uff0c\u8bef\u7801\u7387\u4e0a\u5347\uff0c\u91cd\u65b0\u4f20\u8f93\u7684\u6982\u7387\u63d0\u9ad8\uff0c\u901a\u5e38\u5c31\u4f1a\u5f15\u5165\u7ea0\u9519\u7801\uff0c\u4e00\u822c\u53eb\u505a FEC\uff08Forward Error Correction\uff09\u3002</p> <p>\u6838\u5fc3\u601d\u8def\u662f\u53d1\u9001\u6570\u636e\u7684\u65f6\u5019\uff0c\u6dfb\u52a0\u5197\u4f59\uff0c\u4f7f\u5f97\u539f\u59cb\u6570\u636e\u5728\u7f16\u7801\u4ee5\u540e\uff0c\u53ea\u6709\u4e00\u90e8\u5206\u5408\u6cd5\u503c\uff0c\u5176\u4f59\u7684\u662f\u975e\u6cd5\u7684\uff0c\u4e14\u5408\u6cd5\u503c\u4e4b\u95f4\u4fdd\u8bc1\u6709\u4e00\u4e2a\u6700\u5c0f\u7684\u7f16\u8f91\u8ddd\u79bb\u3002\u7f16\u8f91\u8ddd\u79bb\u4e5f\u53eb Hamming \u8ddd\u79bb\uff0c\u7b49\u4e8e\u5f02\u6216\u540e\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d 1 \u7684\u4e2a\u6570\u3002</p> <p>\u5728\u4f20\u8f93\u51fa\u9519\u65f6\uff0c\u5982\u679c\u51fa\u9519\u7684\u4f4d\u6570\u5728\u7f16\u8f91\u8ddd\u79bb\u4e4b\u5185\uff0c\u5c31\u4e00\u5b9a\u4f1a\u4ece\u5408\u6cd5\u503c\u53d8\u4e3a\u975e\u6cd5\u503c\uff0c\u6b64\u65f6\u5c31\u53ef\u4ee5\u68c0\u6d4b\u51fa\u9519\u8bef\u3002\u66f4\u8fdb\u4e00\u6b65\uff0c\u5982\u679c\u51fa\u9519\u7684\u4f4d\u6570\u6bd4\u8f83\u5c0f\uff0c\u8ddd\u79bb\u975e\u6cd5\u503c\u6700\u8fd1\u7684\u5408\u6cd5\u503c\u552f\u4e00\uff0c\u6b64\u65f6\u5c31\u53ef\u4ee5\u7ea0\u6b63\u9519\u8bef\u3002</p>"},{"location":"hardware/error_detection_correction_code/#parity","title":"\u5947\u5076\u6821\u9a8c Parity","text":"<p>\u5947\u5076\u6821\u9a8c\u5bf9\u6bcf k \u4f4d\u6570\u636e\uff0c\u6dfb\u52a0\u989d\u5916\u7684 1 \u4f4d\uff0c\u8bb0\u5f55\u8fd9 k \u4f4d\u6570\u636e\u4e2d\u6709\u5947\u6570\u4e2a 1 \u8fd8\u662f\u5076\u6570\u4e2a 1\u3002\u5947\u5076\u6821\u9a8c\u7f16\u7801\u540e\uff0c\u5408\u6cd5\u503c\u7684\u7f16\u8f91\u8ddd\u79bb\u4e3a 2\uff0c\u53ea\u80fd\u68c0\u6d4b\u51fa 1 \u4f4d\u7684\u9519\u8bef\uff0c\u65e0\u6cd5\u7ea0\u6b63\u9519\u8bef\u3002</p> <p>\u7f16\u7801\u7684\u6548\u7387\u662f k/(k+1)\u3002</p> <p>UART \u534f\u8bae\u7528\u7684\u662f\u5947\u5076\u6821\u9a8c\u3002</p> <p>\u53c2\u8003\uff1aParity bit</p>"},{"location":"hardware/error_detection_correction_code/#_3","title":"\u91cd\u590d\u7f16\u7801","text":"<p>\u91cd\u590d\u7f16\u7801\u7684\u65b9\u6cd5\u662f\uff0c\u628a\u8f93\u5165\u7684\u6bcf\u4e2a\u4f4d\u91cd\u590d n \u6b21\uff0cn \u4e3a\u5947\u6570\uff1a\u4f8b\u5982 n \u7b49\u4e8e 3\uff0c\u90a3\u4e48 0 \u53d8\u6210 000\uff0c1 \u53d8\u6210 111\uff0c\u4e24\u4e2a\u5408\u6cd5\u503c\u7684\u7f16\u8f91\u8ddd\u79bb\u662f 3\uff0c\u6b64\u65f6\u53ef\u4ee5\u68c0\u6d4b\u51fa 1 \u4f4d\u7684\u9519\u8bef\uff0c\u4e5f\u53ef\u4ee5\u7ea0\u6b63 1 \u4f4d\u7684\u9519\u8bef\u3002\u53ef\u4ee5\u68c0\u6d4b\u51fa 2 \u4f4d\u7684\u9519\u8bef\uff0c\u4f46\u662f\u65e0\u6cd5\u548c 1 \u4f4d\u7684\u9519\u8bef\u533a\u5206\u5f00\u3002\u89e3\u7801\u7684\u65f6\u5019\uff0c\u6309 n \u4f4d\u5206\u7ec4\uff0c\u6bcf\u4e2a\u5206\u7ec4\u5185\u7684 0 \u548c 1 \u7684\u6570\u91cf\u54ea\u4e2a\u591a\uff0c\u5c31\u8ba4\u4e3a\u539f\u59cb\u503c\u662f\u54ea\u4e2a\u3002</p> <p>\u7f16\u7801\u7684\u6548\u7387\u662f 1/n\u3002</p> <p>\u53c2\u8003\uff1aRepetition code</p>"},{"location":"hardware/error_detection_correction_code/#hamming","title":"Hamming \u7801","text":"<p>Hamming \u7801\u7684\u7279\u70b9\u662f\uff0c\u53ef\u4ee5\u68c0\u6d4b\u5e76\u7ea0\u6b63 1 \u4f4d\u7684\u9519\u8bef\u3002\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e00\u70b9\uff0c\u7f16\u8f91\u8ddd\u79bb\u9700\u8981\u4fdd\u8bc1\u81f3\u5c11\u662f 3\u3002\u5982\u679c\u4e0d\u7ea0\u6b63\u9519\u8bef\u7684\u8bdd\uff0c\u53ef\u4ee5\u68c0\u6d4b\u51fa 1 \u4f4d\u6216\u8005 2 \u4f4d\u7684\u9519\u8bef\uff0c\u4f46\u662f\u65e0\u6cd5\u533a\u5206\u662f\u54ea\u79cd\u60c5\u51b5\u3002</p> <p>\u6b64\u5916\u5982\u679c\u7ed9 Hamming \u7801\u52a0\u4e0a\u989d\u5916\u7684\u5947\u5076\u6821\u9a8c\u4f4d\uff0c\u90a3\u4e48\u7f16\u8f91\u8ddd\u79bb\u81f3\u5c11\u662f 4\uff0c\u5c31\u53ef\u4ee5\u68c0\u6d4b\u51fa 2 \u4f4d\u7684\u9519\u8bef\uff0c\u4f46\u662f\u4e0d\u80fd\u7ea0\u6b63 2 \u4f4d\u7684\u9519\u8bef\u3002\u8fd9\u79cd\u6269\u5c55 Hamming \u7801\u5b9e\u73b0\u4e86 SECDED\uff08Single Error Correction\uff0cDouble Error Detection\uff09\u3002</p> <p>\u5047\u8bbe\u4f20\u8f93\u7684\u6570\u636e\u662f k \u4f4d\uff0c\u6dfb\u52a0\u5197\u4f59\u7684 r \u4f4d\u6821\u9a8c\u7801\uff0c\u5f53\u51fa\u73b0 1 \u4f4d\u9519\u8bef\u7684\u65f6\u5019\uff0c\u4e3a\u4e86\u7ea0\u6b63\u9519\u8bef\uff0c\u9700\u8981\u77e5\u9053\u9519\u8bef\u7684\u4f4d\u7f6e\u3002\u9519\u8bef\u7684\u4f4d\u7f6e\u53ef\u80fd\u51fa\u73b0\u5728 k+r \u4f4d\u7684\u4efb\u610f\u4e00\u4e2a\u5730\u65b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9519\u8bef\u7684\u4f4d\u7f6e\u5e94\u8be5\u53ef\u4ee5\u901a\u8fc7\u5197\u4f59\u7684 r \u4f4d\u6821\u9a8c\u7801\u63a8\u65ad\u51fa\u6765\uff0c\u56e0\u6b64\uff1a</p>  2^r \\ge k+r  <p>\u6b64\u5916\u8fd8\u6709\u4e00\u4e2a\u5408\u6cd5\u60c5\u51b5\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u51fa\u9519\u4f4d\u7f6e\uff0c\u56e0\u6b64\uff1a</p>  2^r \\ge k+r+1  <p>\u4f8b\u5982\u5f53 r=3 \u65f6\uff0ck \\le 4\uff0c\u6b64\u65f6\u5982\u679c\u53d6 k=4\uff0c\u90a3\u5c31\u662f\u6bcf 4 \u4f4d\u6570\u636e\uff0c\u6dfb\u52a0 3 \u4f4d\u7684\u6821\u9a8c\u7801\uff0c\u4e00\u5171\u662f 7 \u4f4d\u3002\u6b64\u65f6\u5c31\u79f0\u8fd9\u4e2a\u7f16\u7801\u4e3a Hamming(7,4)\u3002</p> <p>\u91cd\u590d\u7f16\u7801\u5728 n=3 \u65f6\u7b49\u4ef7\u4e8e Hamming(3,1)\u3002</p> <p>\u7f16\u7801\u7684\u6548\u7387\u662f k/(k+r)\u3002</p> <p>ECC DRAM \u5bf9 64 \u4f4d\u6570\u636e\u6dfb\u52a0 8 \u4f4d\u7684\u5197\u4f59\uff0c\u53ef\u4ee5\u91c7\u7528\u6269\u5c55 Hamming \u7801\u6765\u5b9e\u73b0 SECDED\u3002</p> <p>\u53c2\u8003\uff1aHamming code</p>"},{"location":"hardware/error_detection_correction_code/#reed-soloman","title":"Reed-Soloman","text":"<p>Reed-Solomon \u6709\u4e09\u4e2a\u53c2\u6570\uff1a\u5b57\u6bcd\u8868\u5927\u5c0f q\uff0c\u7f16\u7801\u540e\u7684\u5757\u5927\u5c0f n \u548c\u6570\u636e\u957f\u5ea6 k\uff0c\u8981\u6c42 k &lt; n \\le q \u4e14 q \u662f\u7d20\u6570\u3002</p> <p>Reed-Solomon \u7b97\u6cd5\u7684\u8fc7\u7a0b\u662f\uff0c\u5bf9\u4e8e k \u4e2a\u6570\u636e\uff0c\u6bcf\u4e2a\u6570\u636e\u8303\u56f4\u90fd\u5728 [0, q-1] \u5185\uff0c\u4ee5\u8fd9 k \u4e2a\u6570\u4e3a\u7cfb\u6570\u5f97\u5230\u4e00\u4e2a\u591a\u9879\u5f0f p\u3002\u53d6 n \u4e2a\u70b9 a_1, \\ldots a_n\uff0c\u5206\u522b\u5e26\u5165\u591a\u9879\u5f0f\uff0c\u628a\u7ed3\u679c\u5bf9 q \u53d6\u4f59\uff0c\u5c31\u5f97\u5230\u4e86 Reed Solomon \u7f16\u7801\uff1a</p>  p_x(a) = \\sum_{i=1}^k x_ia^{i-1} \\bmod q   C(x) = (p_x(a_1), \\ldots, p_x(a_n))  <p>\u7531\u4e8e\u4efb\u610f\u4e24\u4e2a\u4e0d\u540c\u7684 k \u6b21\u591a\u9879\u5f0f\uff0c\u6700\u591a\u53ea\u4f1a\u6709 k-1 \u4e2a\u4ea4\u70b9\uff0c\u6240\u4ee5 Reed Solomon \u7f16\u7801\u4e2d\uff0c\u5176\u4f59\u7684 n-(k-1)=n-k+1 \u4e2a\u503c\u90fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u7f16\u8f91\u8ddd\u79bb\u5c31\u662f n-k+1\u3002</p> <p>\u56e0\u6b64 Reed Solomon \u53ef\u4ee5\u7ea0\u6b63 (n-k)/2 \u4e2a\u7cfb\u6570\u7684\u9519\u8bef\u3002\u8fd9\u4f7f\u5f97 Reed Solomon \u7f16\u7801\u53ef\u4ee5\u6839\u636e\u9700\u8981\uff0c\u8bbe\u7f6e\u4e0d\u540c\u7684\u7f16\u8f91\u8ddd\u79bb\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u68c0\u9519\u548c\u7ea0\u9519\u80fd\u529b\u3002\u66f4\u8fdb\u4e00\u6b65\uff0c\u5982\u679c\u9519\u8bef\u4f1a\u8fde\u7eed\u51fa\u73b0\uff08erasure\uff09\uff0c\u7531\u4e8e\u4f20\u8f93\u7684\u662f\u591a\u4e2a\u503c\uff0c\u5bf9\u540c\u4e00\u4e2a\u503c\u4ea7\u751f\u7684\u591a\u4e2a\u4f4d\u7684\u9519\u8bef\u548c\u4e00\u4e2a\u4f4d\u7684\u9519\u8bef\u662f\u4e00\u6837\u7684\uff0c\u56e0\u6b64\u8fde\u7eed\u9519\u8bef\u7684\u7ea0\u9519\u80fd\u529b\u66f4\u5f3a\u3002</p> <p>\u9664\u4e86\u4e0a\u9762\u8fd9\u79cd\u628a\u6570\u636e\u7f16\u7801\u4e3a\u591a\u9879\u5f0f\u7cfb\u6570\u7684\u65b9\u6cd5\uff0c\u8fd8\u53ef\u4ee5\u7528\u5176\u4ed6\u65b9\u5f0f\u3002\u4f8b\u5982\u628a\u6570\u636e\u8bbe\u5b9a\u4e3a\u591a\u9879\u5f0f\u5728 k \u4e2a\u70b9\u4e0a\u7684\u53d6\u503c\uff0c\u5176\u4f59\u7684\u70b9\u7684\u503c\u901a\u8fc7\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u8ba1\u7b97\u5f97\u51fa\u3002\u8fd9\u6837\u7684\u597d\u5904\u662f\u7f16\u7801\u4ee5\u540e\uff0c\u6570\u636e\u4f1a\u539f\u6837\u4fdd\u7559\u4e0b\u6765\u3002</p> <p>\u6b64\u5916\u8fd8\u53ef\u4ee5\u9884\u5148\u8bbe\u5b9a\u4e00\u4e2a\u591a\u9879\u5f0f g(x)\uff0c\u7f16\u7801\u7684\u65f6\u5019\uff0c\u8ba1\u7b97 s(x)=p(x)g(x)\uff0c\u7136\u540e\u4f20\u8f93 s(x) \u7684 n \u4e2a\u7cfb\u6570\uff0c\u8fd9\u79cd\u65b9\u6cd5\u53eb\u505a BCH\uff08Bose\u2013Chaudhuri\u2013Hocquenghem\uff09\u3002</p> <p>\u5b9e\u8df5\u4e2d\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u8ba1\u7b97\u673a\u4f20\u8f93\u65f6\u6bcf\u4e2a\u5b57\u8282\u6709 256 \u79cd\u53d6\u503c\uff0c\u6b64\u65f6\u5982\u679c\u7528\u7d20\u6570 q \u6765\u9650\u5236\u5b57\u6bcd\u8868\u5927\u5c0f\uff0c\u90a3\u5c31\u8981\u6c42 q \u662f\u6bd4 256 \u5927\u7684\u7d20\u6570\uff0c\u4f1a\u6709\u6240\u6d6a\u8d39\u3002\u56e0\u6b64\uff0c\u5e38\u7528\u5927\u5c0f\u4e3a 256 \u7684 Galois Field \u6765\u66ff\u4ee3\u7d20\u6570\u57df\uff0c\u4e0a\u9762\u591a\u9879\u5f0f\u4e2d\u7684\u8fd0\u7b97\u90fd\u66ff\u6362\u4e3a Galois Field \u4e2d\u5bf9\u5e94\u7684\u8fd0\u7b97\uff0c\u6b64\u65f6\u4e00\u4e2a\u7b26\u53f7\u5c31\u662f\u4e00\u4e2a\u5b57\u8282\u3002\u4f8b\u5982 RS(255,223) \u7801\uff088 \u4f4d\u7b26\u53f7\uff09\u5c31\u662f\u6bcf 223 \u4e2a\u5b57\u8282\u5206\u4e3a\u4e00\u7ec4\uff0c\u7f16\u7801\u4e3a 255 \u4e2a\u5b57\u8282\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u7ea0\u6b63 16 \u4e2a\u5b57\u8282\u7684\u9519\u8bef\u3002</p> <p>\u5982\u679c\u5e0c\u671b\u7f29\u51cf n\uff0c\u53ef\u4ee5\u586b\u5145\u4e00\u90e8\u5206\u5b57\u8282\uff0c\u4f8b\u5982 RS(200,168) \u7801\uff0c\u7ed9\u6570\u636e\u586b\u5145 55 \u4e2a\u96f6\u5b57\u8282\u540e\uff0c\u518d\u6309\u7167 RS(255,223) \u8fdb\u884c\u7f16\u7801\uff0c\u5f97\u5230 32 \u4e2a\u6821\u9a8c\u5b57\u8282\uff0c\u4f20\u8f93\u7684\u65f6\u5019\uff0c\u53ea\u4f20\u8f93 168+32 \u4e2a\u5b57\u8282\uff0c\u6b64\u65f6\u8981\u6c42\u5728 Reed Solomon \u7f16\u7801\u7684\u65f6\u5019\uff0c\u91c7\u7528\u4fdd\u7559\u539f\u59cb\u6570\u636e\u7684\u65b9\u6cd5\u3002</p> <p>\u53c2\u8003\uff1aReed-Solomon error correction</p>"},{"location":"hardware/error_detection_correction_code/#crc","title":"CRC","text":"<p>CRC \u662f\u628a\u6570\u636e\u5f53\u6210\u4e00\u4e2a GF(2) \u591a\u9879\u5f0f\u7684\u7cfb\u6570\uff0c\u9664\u4ee5\u5df2\u77e5\u7684\u591a\u9879\u5f0f\uff0c\u5f97\u5230\u7684\u4f59\u6570\u5c31\u662f CRC \u7684\u7ed3\u679c\u3002CRC \u4e3b\u8981\u662f\u4e3a\u4e86\u68c0\u6d4b\u9519\u8bef\uff0c\u4f46\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\uff0c\u4e5f\u53ef\u4ee5\u7ea0\u6b63\u9519\u8bef\uff0c\u4f46 CRC \u4e3b\u8981\u8fd8\u662f\u7528\u6765\u68c0\u6d4b\u9519\u8bef\u3002\u6b64\u5916\uff0cCRC \u4e0d\u8981\u6c42\u6570\u636e\u957f\u5ea6\u56fa\u5b9a\u3002</p>"},{"location":"hardware/error_detection_correction_code/#_4","title":"\u5c0f\u7ed3","text":"<p>\u4e0b\u9762\u7ed9\u51fa\u4e0d\u540c\u68c0\u9519\u7ea0\u9519\u7801\u7684\u5bf9\u6bd4\uff1a</p> \u7f16\u8f91\u8ddd\u79bb \u6570\u636e\u4f4d\u6570 \u5197\u4f59\u4f4d\u6570 \u603b\u4f4d\u6570 \u5947\u5076\u6821\u9a8c 2 n 1 n+1 \u91cd\u590d\u7f16\u7801 n 1 n-1 n Hamming \u7801 3 2^r-r-1 r 2^r-1 \u6269\u5c55 Hamming \u7801 4 2^r-r-1 r+1 2^r Reed Solomon n-k+1 k\\log_2(q) (n-k)\\log_2(q) n\\log_2(q)"},{"location":"hardware/error_detection_correction_code/#_5","title":"\u53c2\u8003\u6587\u6863","text":"<ul> <li>Error correction code</li> </ul>"},{"location":"hardware/high_speed_serial/","title":"\u9ad8\u901f\u4e32\u884c\u901a\u4fe1","text":""},{"location":"hardware/high_speed_serial/#_2","title":"\u4ecb\u7ecd","text":"<p>\u5386\u53f2\u4e0a\uff0c\u82af\u7247\u95f4\u7684\u4f20\u8f93\u63a5\u53e3\u7ecf\u5386\u4e86\u4e32\u884c\u5230\u5e76\u884c\u518d\u5230\u4e32\u884c\u7684\u8fc7\u7a0b\u3002\u4ece\u4e32\u884c\u5230\u5e76\u884c\uff0c\u662f\u56e0\u4e3a\u5e76\u884c\u63a5\u53e3\u540c\u65f6\u4f20\u8f93\u591a\u8def\u6570\u636e\uff0c\u53ef\u4ee5\u5f97\u5230\u66f4\u9ad8\u7684\u5e26\u5bbd\u3002\u4ece\u5e76\u884c\u518d\u56de\u5230\u4e32\u884c\uff0c\u662f\u56e0\u4e3a\u968f\u7740\u5e76\u884c\u4fe1\u53f7\u6570\u589e\u5927\uff0cPCB \u8d70\u7ebf\u6108\u53d1\u56f0\u96be\uff0c\u4e32\u6270\u95ee\u9898\u6108\u53d1\u4e25\u91cd\uff0c\u96be\u4ee5\u7ee7\u7eed\u6269\u5c55\u5e76\u884c\u63a5\u53e3\u7684\u5bbd\u5ea6\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u968f\u7740\u6280\u672f\u7684\u53d1\u5c55\uff0c\u4e32\u884c\u901a\u4fe1\u53d1\u5c55\u51fa\u4e86\u65b0\u7684\u6280\u672f\uff0c\u5b9e\u73b0\u4e86\u66f4\u9ad8\u7684\u901f\u5ea6\uff0c\u56e0\u6b64\u53c8\u4ece\u5e76\u884c\u56de\u5230\u4e86\u4e32\u884c\u3002</p> <p>\u5176\u4e2d\u53d1\u6325\u91cd\u8981\u4f5c\u7528\u7684\u662f SerDes\uff0c\u5b83\u5b9e\u73b0\u4e86\u4e32\u5e76\u8f6c\u6362\uff1a\u5728\u53d1\u9001\u7aef\uff0c\u628a\u82af\u7247\u5185\u90e8\u7684\u5e76\u884c\u6570\u636e\u8f6c\u6362\u4e3a\u4e32\u884c\u6570\u636e\u8f93\u51fa\uff1b\u5728\u63a5\u6536\u7aef\uff0c\u628a\u4e32\u884c\u6570\u636e\u8f93\u5165\u8f6c\u6362\u4e3a\u82af\u7247\u5185\u90e8\u7684\u5e76\u884c\u6570\u636e\u3002</p> <p>\u53c2\u8003\u8d44\u6599\uff1aFrom Parallel to Serial and Back Again: Understanding SerDes</p>"},{"location":"hardware/high_speed_serial/#_3","title":"\u4e32\u884c\u901a\u4fe1","text":"<p>\u4e3a\u4e86\u5b9e\u73b0\u9ad8\u901f\u7684\u4e32\u884c\u901a\u4fe1\uff0c\u9700\u8981\u5f88\u591a\u6280\u672f\u6765\u4fdd\u8bc1\u9ad8\u9891\u7387\u4e0b\u6570\u636e\u7684\u6b63\u5e38\u4f20\u8f93\uff1a</p> <ol> <li>\u5dee\u5206\u4fe1\u53f7\u4f20\u8f93</li> <li>\u5185\u5d4c\u65f6\u949f\u4ee5\u53ca\u65f6\u949f\u6062\u590d</li> <li>\u6570\u636e\u7f16\u7801</li> <li>\u9884\u52a0\u91cd\u548c\u5747\u8861\uff1a</li> </ol> <p>\u5e38\u89c1\u7684 SerDes \u901f\u7387\u6709\uff1a3.125 Gb/s\uff0c6 Gb/s\uff0c10 Gb/s\uff0c28 GB/s\uff0c56 GB/s \u548c 112 Gb/s\u3002\u8fd9\u662f\u7ecf\u8fc7\u6570\u636e\u7f16\u7801\u540e\u7684\u901f\u7387\uff0c\u56e0\u6b64\u5b9e\u9645\u4f20\u8f93\u7684\u6570\u636e\u901f\u7387\u8fd8\u8981\u51cf\u53bb\u4e00\u90e8\u5206\u3002</p> <p>\u5f88\u591a\u9ad8\u901f\u534f\u8bae\u91c7\u7528\u4e86\u4e32\u884c\u901a\u4fe1\uff1a</p> <ul> <li>PCIe</li> <li>USB 3</li> <li>Ethernet</li> <li>SGMII</li> <li>Infiniband</li> <li>SATA/SAS</li> </ul> <p>\u5e38\u89c1\u7684\u6570\u636e\u7f16\u7801\u65b9\u5f0f\u6709 4b/5b\uff0c8b/10b\uff0c64/66b \u548c 128/130b\u30024b/5b \u7684\u610f\u601d\u5c31\u662f\u6bcf 4 bit \u7684\u6570\u636e\u4f1a\u88ab\u7f16\u7801\u6210 5 bit\uff0c\u5176\u4ed6\u4e5f\u662f\u7c7b\u4f3c\u3002\u7f16\u7801\u540e\uff0c\u4fdd\u8bc1 1 \u548c 0 \u7684\u4e2a\u6570\u57fa\u672c\u76f8\u540c\uff0c\u5e76\u4e14\u4fdd\u8bc1\u4e86\u6709\u8db3\u591f\u7684\u8fb9\u6cbf\u7528\u4e8e\u65f6\u949f\u6062\u590d\uff0c\u6b64\u65f6\u5c31\u4e0d\u9700\u8981\u989d\u5916\u4f20\u8f93\u65f6\u949f\u4fe1\u53f7\u4e86\uff0c\u63a5\u6536\u4fa7\u4ece\u6570\u636e\u4e2d\u6062\u590d\u65f6\u949f\u5e76\u4e14\u91c7\u6837\u3002</p> <p>\u9884\u5148\u52a0\u91cd\u548c\u5747\u8861\u89e3\u51b3\u7684\u662f\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u9ad8\u9891\u4fe1\u53f7\u7684\u8870\u51cf\uff1a\u65e2\u7136\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u5bf9\u9ad8\u9891\u4fe1\u53f7\u8870\u51cf\u7684\u6bd4\u8f83\u5389\u5bb3\uff0c\u90a3\u5c31\u5728\u53d1\u9001\u7684\u65f6\u5019\u9884\u5148\u589e\u52a0\u9ad8\u9891\u4fe1\u53f7\u5206\u91cf\uff1b\u5747\u8861\u5219\u662f\u5728\u63a5\u6536\u7aef\u8fdb\u884c\u6ee4\u6ce2\uff0c\u628a\u60f3\u8981\u7684\u9891\u7387\u8fc7\u6ee4\u51fa\u6765\u3002</p> <p>\u5f53\u63a5\u53e3\u9700\u8981\u66f4\u9ad8\u5e26\u5bbd\u7684\u65f6\u5019\uff0c\u901a\u5e38\u5c31\u662f\u7ec4\u5408\u591a\u4e2a SerDes\uff0c\u4f8b\u5982 PCIe x1 \u5c31\u662f Serdes \u4e00\u6536\u4e00\u53d1\uff1bPCIe x16 \u5c31\u662f SerDes \u5341\u516d\u6536\u5341\u516d\u53d1\u3002</p> <p>\u4e0b\u9762\u5217\u4e3e\u4e00\u4e9b\u9ad8\u901f\u4e32\u884c\u901a\u4fe1\u534f\u8bae\u91c7\u7528\u7684\u6280\u672f\uff1a</p> <ol> <li>PCIe 1.0-2.0: NRZ, 8b/10b</li> <li>PCIe 3.0-5.0: NRZ, 128b/130b</li> <li>PCIe 6.0: PAM-4, FEC, 242B/256B FLIT</li> <li>HDMI 1.0-2.0:8b/10b</li> <li>HDMI 2.1:16b/18b, FEC</li> <li>DisplayPort 1.0-1.4:8b/10b</li> <li>DisplayPort 2.0-2.1:128b/132b, FEC</li> <li>SGMII\uff1a8b/10b</li> <li>SATA\uff1a8b/10b</li> <li>SAS 1-3:8b/10b</li> <li>SAS 4:128b/150b, FEC</li> </ol>"},{"location":"hardware/i2c/","title":"I2C","text":""},{"location":"hardware/i2c/#_1","title":"\u63a5\u53e3","text":"<p>I2C \u534f\u8bae\u6d89\u53ca\u5230\u4e24\u4e2a\u4fe1\u53f7\uff1a</p> <ul> <li>SCL: \u65f6\u949f\u4fe1\u53f7\uff0cMaster -&gt; Slave</li> <li>SDA\uff1a\u6570\u636e\u4fe1\u53f7\uff0cMaster &lt;-&gt; Slave</li> </ul> <p>\u7531\u4e8e\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u4fe1\u53f7\uff0c\u6240\u4ee5 SDA \u7531 Master \u548c Slave \u8f6e\u6d41\u8f93\u51fa\u3002\u4e00\u6b21\u8bf7\u6c42\u7684\u5f00\u59cb\u6761\u4ef6\u662f\uff0cSDA \u4ece 1 \u53d8\u6210 0\uff0c\u4e4b\u540e SCL \u4ece 1 \u53d8\u6210 0\u3002\u5f00\u59cb\u8bf7\u6c42\u4ee5\u540e\uff0c\u6bcf\u6b21 SCL \u4e0a\u5347\u6cbf\u91c7\u6837\u4e00\u4f4d\u7684\u6570\u636e\u3002\u8bf7\u6c42\u7ed3\u675f\u65f6\uff0cSCL \u4ece 0 \u53d8\u6210 1\uff0c\u7136\u540e SDA \u4ece 0 \u53d8\u6210 1\u3002\u4e00\u6b21\u8bf7\u6c42\u7684\u6ce2\u5f62\u5982\u4e0b\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"scl\", wave: \"1.0101010|.101...\"},\n      { name: \"sda\", wave: \"10....1..|0....1.\", phase: -0.1},\n      { name: \"i2c\", wave: \"34.5.....|6.7....\", data: [\"idle\", \"start\", \"data\", \"ack\", \"stop\"]},\n    ]\n}\n</code></pre> <ol> <li>idle \u9636\u6bb5\uff0cscl \u548c sda \u90fd\u662f 1</li> <li>start \u9636\u6bb5\uff0c\u9996\u5148\u662f sda \u53d8\u6210 0\uff0c\u4e4b\u540e\u662f scl \u53d8\u6210 0</li> <li>data/ack \u9636\u6bb5\uff0c\u5728 scl \u4e0a\u5347\u6cbf\u91c7\u6837\u6570\u636e\uff0c\u5728 scl \u4e0b\u964d\u6cbf\uff08\u51c6\u786e\u6765\u8bf4\uff0c\u8d1f\u534a\u5468\u671f\uff09\u4fee\u6539\u6570\u636e</li> <li>stop \u9636\u6bb5\uff0c\u9996\u5148\u662f scl \u53d8\u6210 1\uff0c\u4e4b\u540e\u662f sda \u53d8\u6210 1</li> </ol> <p>\u4f20\u8f93\u6570\u636e\u7684\u65f6\u5019\uff0c\u9700\u8981\u4fdd\u8bc1 sda \u5728 scl \u6b63\u534a\u5468\u671f\u7684\u65f6\u5019\u4fdd\u6301\u4e0d\u53d8\u3002\u5982\u679c\u53d8\u4e86\uff0c\u90a3\u5c31\u662f start \u6216\u8005 stop\u3002\u56e0\u6b64\uff0c\u5728 data/ack \u9636\u6bb5\uff0c\u5efa\u8bae\u4fdd\u8bc1 sda \u7684\u53d8\u5316\u76f8\u6bd4 scl \u4e0b\u964d\u6cbf\u6709\u4e00\u4e2a\u5ef6\u8fdf\uff08Hold Time\uff0c\u4e00\u822c\u7684\u8981\u6c42\u662f Min 0us\uff09\u3002\u5b9e\u73b0\u65b9\u6cd5\u53ef\u80fd\u662f\u5728\u5206\u9891\u7684\u65f6\u5019\uff0c\u5148\u62c9\u4f4e scl\uff0c\u4e0b\u4e00\u4e2a\u5468\u671f\u518d\u4fee\u6539 sda\u3002</p> <p>\u8fd9\u91cc\u7684 data/ack \u6307\u7684\u5219\u662f\u4f20\u8f93\u7684\u5177\u4f53\u5185\u5bb9\uff1a\u4f8b\u5982 master \u8981\u4f20\u8f93 7 \u4f4d\u7684\u5730\u5740\u548c 1 \u4f4d\u7684\u8bfb\u4f7f\u80fd\uff0c\u54cd\u5e94\u5730\u5740\u7684 slave \u8981\u8fd4\u56de ack\uff1b\u4e4b\u540e\uff0c\u65e0\u8bba\u662f master \u8fd8\u662f slave \u53d1\u9001\u6570\u636e\uff0c\u63a5\u6536\u7684\u4e00\u65b9\u90fd\u8981\u8fd4\u56de ack\u3002ack \u662f\u4f4e\u6709\u6548\uff0c\u610f\u5473\u7740 0 \u8868\u793a\u6210\u529f\uff08ack\uff09\uff0c1 \u8868\u793a\u5931\u8d25\uff08nack\uff09\u3002</p> <p>\u7531\u4e8e sda \u5e26\u6709\u4e0a\u62c9\u7535\u963b\uff0c\u6240\u4ee5\u5982\u679c\u6ca1\u6709 slave \u54cd\u5e94\uff0cack \u9636\u6bb5\u7684 sda \u5c31\u4f1a\u53d8\u6210 1\uff0c\u610f\u5473\u7740\u5931\u8d25\uff08nack\uff09\u3002</p>"},{"location":"hardware/i2c/#i2c_1","title":"I2C \u63a7\u5236\u5668\u5b9e\u73b0","text":"<p>\u7ed3\u5408\u4e0a\u9762\u7684 I2C \u6ce2\u5f62\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u72b6\u6001\u673a\uff1a</p> <ol> <li>INIT \u72b6\u6001\uff1a\u521d\u59cb\u60c5\u51b5\u4e0b\uff0cSCL \u548c SDA \u90fd\u4e3a 1\uff0c\u8981\u53d1\u9001\u6570\u636e\u7684\u65f6\u5019\uff0c\u8f6c\u79fb\u5230 START1 \u72b6\u6001</li> <li>START1 \u72b6\u6001\uff1a\u8bbe\u7f6e SDA=0\uff0c\u5f53\u8fbe\u5230\u5206\u9891\u6761\u4ef6\u65f6\uff0c\u8f6c\u79fb\u5230 START2 \u72b6\u6001</li> <li>START2 \u72b6\u6001\uff1a\u8bbe\u7f6e SCL=0\uff0c\u5f53\u8fbe\u5230\u5206\u9891\u6761\u4ef6\u65f6\uff0cSTART \u53d1\u9001\u5b8c\u6210\uff0c\u8f6c\u79fb\u5230 SEND \u72b6\u6001</li> <li>SEND \u72b6\u6001\uff1a\u5f53\u8fbe\u5230\u5206\u9891\u6761\u4ef6\u65f6\uff0cSCL \u53d6\u53cd\uff0c\u5982\u679c SCL \u8981\u4ece 1 \u53d8\u6210 0\uff0c\u5ef6\u8fdf\u4e00\u4e2a\u5468\u671f\uff0c\u518d\u8f93\u51fa 1 \u4f4d\u7684\u6570\u636e\u5230 SDA \u4e0a\uff0c\u4fdd\u8bc1 SDA \u7684\u53d8\u5316\u5728 SCL \u7684\u8d1f\u534a\u5468\u671f\uff1b\u540c\u65f6\u7edf\u8ba1\u4f20\u8f93\u4f4d\u6570\uff0c\u6bcf\u4f20\u8f93 8 \u4f4d\uff0c\u5c31\u8981\u7b49\u5f85\u4e00\u4e2a\u5468\u671f\u8ba9 Slave \u54cd\u5e94 ACK\uff0c\u6b64\u65f6\u8981\u8bbe\u7f6e inout \u8f93\u51fa\u4e3a\u9ad8\u963b\u6001\uff1b\u5982\u679c\u8981\u8f6c\u6362\u4f20\u8f93\u65b9\u5411\uff0c\u5373 Master \u8981\u8bfb\u53d6\u6570\u636e\uff0c\u90a3\u4e48\u8f6c\u79fb\u5230 RECV \u72b6\u6001\uff1b\u5982\u679c\u4f20\u8f93\u7ed3\u675f\uff0c\u8f6c\u79fb\u5230 STOP1 \u72b6\u6001</li> <li>RECV \u72b6\u6001\uff1a\u5f53\u8fbe\u5230\u5206\u9891\u6761\u4ef6\u65f6\uff0cSCL \u53d6\u53cd\uff0c\u5982\u679c SCL \u4ece 0 \u53d8\u6210 1\uff0c\u5bf9 SDA \u8fdb\u884c\u91c7\u6837\u5e76\u4e14\u4fdd\u5b58\u4e0b\u6765\uff1b\u540c\u65f6\u7edf\u8ba1\u4f20\u8f93\u4f4d\u6570\uff0c\u6bcf\u4f20\u8f93 8 \u4f4d\uff0c\u5c31\u8981\u5728 SDA \u8f93\u51fa\u4e00\u6b21 ACK\uff1b\u5982\u679c\u4f20\u8f93\u7ed3\u675f\uff0c\u8f6c\u79fb\u5230 STOP1 \u72b6\u6001</li> <li>STOP1 \u72b6\u6001\uff1a\u8bbe\u7f6e SCL=1\uff0c\u5f53\u8fbe\u5230\u5206\u9891\u6761\u4ef6\u65f6\uff0c\u8f6c\u79fb\u5230 STOP2 \u72b6\u6001</li> <li>STOP2 \u72b6\u6001\uff1a\u8bbe\u7f6e SDA=1\uff0c\u5f53\u8fbe\u5230\u5206\u9891\u6761\u4ef6\u65f6\uff0c\u8f6c\u79fb\u5230 INIT \u72b6\u6001</li> </ol> <p>\u5206\u9891\u662f\u56e0\u4e3a\u4e00\u822c I2C \u7684\u9891\u7387\u6bd4\u8f83\u4f4e\uff0c\u662f kHz \u7684\u91cf\u7ea7\u3002\u9700\u8981\u6309\u7167\u63a7\u5236\u903b\u8f91\u7684\u4e3b\u9891\uff0c\u7ed3\u5408\u5916\u8bbe\u80fd\u63a5\u53d7\u7684 I2C \u9891\u7387\u8303\u56f4\uff0c\u8ba1\u7b97\u51fa\u5206\u9891\u7684\u500d\u6570\u3002</p>"},{"location":"hardware/i2c/#_2","title":"\u4e0a\u5c42\u534f\u8bae","text":"<p>\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u4e0a\u5c42\u534f\u8bae\uff0c\u4f8b\u5982 WM8731\uff0c\u652f\u6301\u901a\u8fc7 I2C \u5199\u5165\u5185\u90e8\u5bc4\u5b58\u5668\uff0c\u4e00\u6b21\u5199\u64cd\u4f5c\u5206\u4e3a\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>start</li> <li>master \u53d1\u9001 7 \u4f4d\u7684\u8bbe\u5907\u5730\u5740\u548c 0\uff08\u8868\u793a\u5199\uff09\uff0cslave \u53d1\u9001 ack</li> <li>master \u53d1\u9001 7 \u4f4d\u7684\u5bc4\u5b58\u5668\u5730\u5740 \u548c 1 \u4f4d\u7684\u5bc4\u5b58\u5668\u6570\u636e\uff0cslave \u53d1\u9001 ack</li> <li>master \u53d1\u9001 8 \u4f4d\u7684\u5bc4\u5b58\u5668\u6570\u636e\uff0cslave \u53d1\u9001 ack</li> <li>stop</li> </ol> <p>\u8fd9\u91cc\u7684\u7b2c\u4e8c\u6b65\u53d1\u9001\u7684 7 \u4f4d\u5730\u5740 + \u8bfb/\u5199\u4f4d\u662f\u6807\u51c6\u7684\uff0cI2C Slave \u90fd\u4f1a\u6839\u636e 7 \u4f4d\u5730\u5740\u6765\u51b3\u5b9a\u662f\u5426\u7531\u81ea\u5df1\u6765\u54cd\u5e94\u3002\u6b64\u540e\u7684\u6570\u636e\u7684\u5b9a\u4e49\uff0c\u5219\u662f\u5404\u4e2a\u82af\u7247\u6309\u7167\u5404\u81ea\u7684\u534f\u8bae\u6765\u8fdb\u884c\u3002</p> <p>\u4e3a\u4e86\u8ba9\u591a\u4e2a\u540c\u578b\u53f7 I2C \u82af\u7247\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\uff0c\u901a\u5e38\u82af\u7247\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5f15\u811a\u6765\u914d\u7f6e\u5b83\u7684\u5730\u5740\uff0c\u90a3\u4e48\u5728\u8bbe\u8ba1\u7684\u65f6\u5019\uff0c\u7ed9\u4e0d\u540c\u7684\u82af\u7247\u8bbe\u7f6e\u4e0d\u540c\u7684\u5730\u5740\uff0c\u5c31\u89e3\u51b3\u4e86\u5730\u5740\u51b2\u7a81\u7684\u95ee\u9898\u3002</p>"},{"location":"hardware/i2c/#i2c-eeprom","title":"I2C EEPROM","text":"<p>\u4ee5 AT24C32/AT24C64 \u4e3a\u4f8b\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e2a I2C \u63a5\u53e3\u7684 EEPROM\uff0c\u652f\u6301\u5982\u4e0b\u64cd\u4f5c\uff1a</p> <p>\u5199\u5165\u6570\u636e\uff1astart\uff0c7 \u4f4d\u8bbe\u5907\u5730\u5740\uff0cW\uff0cACK\uff1b\u5199\u5165\u5730\u5740\u7684\u9ad8 8 \u4f4d\uff0cack\uff1b\u5199\u5165\u5730\u5740\u7684\u4f4e 8 \u4f4d\uff0cack\uff1b\u6570\u636e\u7684\u6bcf\u4e2a\u5b57\u8282\uff0cack\uff1b\u6700\u7ec8 stop\u3002</p> <p>\u8bfb\u53d6\u6570\u636e\uff1astart\uff0c7 \u4f4d\u8bbe\u5907\u5730\u5740\uff0cW\uff0cack\uff1b\u8bfb\u53d6\u5730\u5740\u7684\u9ad8 8 \u4f4d\uff0cack\uff1b\u8bfb\u53d6\u5730\u5740\u7684\u4f4e 8 \u4f4d\uff0cack\uff1bstart\uff0c7 \u4f4d\u8bbe\u5907\u5730\u5740\uff0cR\uff0cack\uff1b\u6570\u636e\u7684\u6bcf\u4e2a\u5b57\u8282\uff0cack\uff1b\u6700\u7ec8\u4e0d\u60f3\u8bfb\u7684\u65f6\u5019 nack\uff0cstop\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u91cc\u8bbe\u8ba1\u6210\u5199\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u53ea\u6709 Master \u5230 Slave \u7684\u6570\u636e\u4f20\u8f93\uff0c\u53cd\u8fc7\u6765\u8bfb\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u53ea\u6709 Slave \u5230 Master \u7684\u6570\u636e\u4f20\u8f93\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u4f20\u8f93\u8bfb\u53d6\u7684\u5730\u5740\uff0c\u8981\u9996\u5148\u201c\u5199\u5165\u201d\u8bfb\u53d6\u7684\u5730\u5740\uff0c\u518d\u8fdb\u884c\u4e00\u6b21\u8bfb\u64cd\u4f5c\uff0c\u628a\u6570\u636e\u8bfb\u51fa\u6765\u3002</p>"},{"location":"hardware/i2c/#i2c-audio-codec","title":"I2C Audio Codec","text":"<p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u7684 WM8731 \u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a Audio Codec\uff0c\u53ef\u4ee5\u901a\u8fc7 I2C \u5bf9\u5176\u5bc4\u5b58\u5668\u8fdb\u884c\u5199\u5165\u3002WM8731 \u7684\u5bc4\u5b58\u5668\u5730\u5740\u6709 9 \u4f4d\uff0c\u6bcf\u4e2a\u5bc4\u5b58\u5668\u6709 8 \u4f4d\u7684\u6570\u636e\uff0c\u56e0\u6b64\u5199\u5165\u6d41\u7a0b\u662f\uff1astart\uff0c7 \u4f4d\u8bbe\u5907\u5730\u5740\uff0cW\uff0cack\uff1b7 \u4f4d\u5bc4\u5b58\u5668\u5730\u5740\uff0c1 \u4f4d\u5bc4\u5b58\u5668\u6570\u636e\uff0cack\uff1b8 \u4f4d\u5bc4\u5b58\u5668\u6570\u636e\uff0cack\uff1bstop\u3002</p>"},{"location":"hardware/i2c/#i2c-sensor","title":"I2C Sensor","text":"<p>\u4e3e\u4e00\u4e2a\u4f20\u611f\u5668\u7684\u4f8b\u5b50\uff1aPAJ7620U2: Integrated Gesture Recognition Sensor \uff0c\u5b83\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5bc4\u5b58\u5668\u8bfb\u5199\u7684\u63a5\u53e3\uff0c\u652f\u6301\u5982\u4e0b\u64cd\u4f5c\uff1a</p> <p>\u5355\u6b21\u5199\u5165\uff1astart\uff0c7 \u4f4d\u8bbe\u5907\u5730\u5740\uff0cW\uff0cack\uff1b8 \u4f4d\u5730\u5740\uff0cack\uff1b8 \u4f4d\u6570\u636e\uff0cack\uff1bstop\u3002</p> <p>\u5355\u6b21\u8bfb\u53d6\uff1astart\uff0c7 \u4f4d\u8bbe\u5907\u5730\u5740\uff0cW\uff0cack\uff1b8 \u4f4d\u5730\u5740\uff0cack\uff1bstop\uff1bstart\uff0c7 \u4f4d\u8bbe\u5907\u5730\u5740\uff0cR\uff0cack\uff1b8 \u4f4d\u6570\u636e\uff0cnack\uff1bstop\u3002\u8fd9\u91cc\u7684\u8bfb\u53d6\u4e5f\u62c6\u6210\u4e86\u4e24\u6b65\uff1a\u7b2c\u4e00\u6b65\u201c\u5199\u5165\u201d\u8bfb\u53d6\u7684\u5730\u5740\uff0c\u7b2c\u4e8c\u6b65\u8bfb\u53d6\u51fa\u6570\u636e\u3002\u6700\u540e\u7684 nack \u8868\u793a master \u4e0d\u9700\u8981\u8bfb\u53d6\u66f4\u591a\u7684\u6570\u636e\u3002</p> <p>\u5982\u679c\u8981\u6279\u91cf\u8bfb\u53d6\u7684\u8bdd\uff0c\u53ea\u8981\u5728\u5355\u6b21\u8bfb\u53d6\u7684\u57fa\u7840\u4e0a\uff0c\u8bfb\u53d6\u6570\u636e\u7684\u65f6\u5019\u53d1 ack\uff0c\u7b49\u5230\u4e0d\u9700\u8981\u7ee7\u7eed\u8bfb\u7684\u65f6\u5019\u518d\u53d1 nack\uff0c\u5c31\u53ef\u4ee5\u8fde\u7eed\u8bfb\u53d6\u591a\u4e2a\u5bc4\u5b58\u5668\u7684\u6570\u636e\u3002</p> <p>\u8fd9\u4e9b\u547d\u4ee4\u683c\u5f0f\u548c\u4e0a\u9762\u7684 I2C EEPROM \u57fa\u672c\u662f\u4e00\u6837\u7684\u3002</p> <p>\u989c\u8272\u4f20\u611f\u5668 TCS3472 \u7684\u547d\u4ee4\u683c\u5f0f\u4e5f\u662f\u7c7b\u4f3c\u7684\u3002</p>"},{"location":"hardware/logic_levels.en/","title":"Logic level standards","text":"<p>The logic level standard defines how to convert the digital signal 0 or 1 into high and low levels, and how to convert the high and low levels back to 0 or 1 between different chips.</p> <p>The first part is for output, to convert 0 or 1 into high and low levels, so it is necessary to define the range:</p> <ul> <li>Output 0: The maximum voltage is V_{OL}, Output Low Voltage</li> <li>Output 1: The minimum voltage is V_{OH}, Output High Voltage</li> </ul> <p>Conversely, when converting the level to 0 or 1, the range must also be defined:</p> <ul> <li>If the voltage is higher than V_{IH}, it is considered 1</li> <li>If the voltage is below V_{IL}, it is considered 0</li> </ul> <p>Usually, the above four items satisfy V_{OL} &lt; V_{IL} &lt; V_{IH} &lt; V_{OH}, that is to say, the range of input will be larger and more tolerant than that of output, providing certain fault tolerance.</p>"},{"location":"hardware/logic_levels.en/#ttl-logic-level","title":"TTL logic level","text":"<p>5V TTL logic level is common. Take the data from https://learn.sparkfun.com/tutorials/logic-levels/ttl-logic-levels as an example, its level range is:</p> <ul> <li>Output 0: V_{OL}=0.4, [0, 0.4]\\mathrm{V}</li> <li>Output 1: V_{OH}=2.7, [2.7, 5]\\mathrm{V}</li> <li>Input 0: V_{IL}=0.8, [0, 0.8]\\mathrm{V}</li> <li>Input 1: V_{IH}=2.0, [2, 5]\\mathrm{V}</li> </ul> <p>V_{OH}=2.4 in the data on Wikipedia.</p> <p>The FT232H chip supports TTL, the parameters are as follows:</p> <ul> <li>V_{OL}=0.4, V_{OH}=2.4</li> <li>V_{IL}=0.8, V_{OL}=2.0</li> </ul>"},{"location":"hardware/logic_levels.en/#cmos-logic-level","title":"CMOS logic level","text":"<p>CMOS logic level is more common nowadays. Take Artix-7 FPGAs as an example, it supports multiple CMOS level standards:</p> <ul> <li>LVCMOS12: V_{OL}=0.4, V_{OH}=V_{CCO}-0.4, V_{IL}=0.35V_{CCO}, V_{IH}=0.65V_{CCO}</li> <li>LVCMOS15: V_{OL}=0.25V_{CCO}, V_{OH}=0.75V_{CCO}, V_{IL}=0.35V_{CCO}, V_{IH}=0.65V_{CCO}</li> <li>LVCMOS18: V_{OL}=0.45, V_{OH}=V_{CCO}-0.45, V_{IL}=0.35V_{CCO}, V_{IH}=0.65V_{CCO}</li> <li>LVCMOS25: V_{OL}=0.4, V_{OH}=V_{CCO}-0.4, V_{IL}=0.7, V_{IH}=1.7</li> <li>LVCMOS33: V_{OL}=0.4, V_{OH}=V_{CCO}-0.4, V_{IL}=0.8, V_{IH}=2.0</li> </ul> <p>Among them, V_{CCO} is the external input voltage, which matches the two digits behind LVCMOS, and LVCMOS33 corresponds to 3.3 V. Each Bank has the same V_{CCO} voltage, which is why IOSTANDARD is written in the constraint file, and often consecutive signals use the same logic level standard.</p> <p>In some cases, TTL level standards and CMOS level standards are compatible as long as their voltage range meets the requirements and can accept higher input voltages. For details, see Can I Use 3.3V TTL to Trigger a 3.3V CMOS Device and Logic Guide - Texas Instruments:</p>    ![](logic_levels_compatible.png){ width=400 }   Compatibility between different TTL and CMOS levels (Source Logic Guide - Texas Instruments)"},{"location":"hardware/logic_levels.en/#rs232","title":"RS232","text":"<p>RS232 is special, its logic level can be positive or negative:</p> <ul> <li>Output 0: [-15, -5] \\mathrm{V}</li> <li>Output 1: [5, 15] \\mathrm{V}</li> <li>Input 0: [-15, -3] \\mathrm{V}</li> <li>Input 1: [3, 15] \\mathrm{V}</li> </ul> <p>Therefore, if you want to connect RS232 peripherals to FPGA, you usually need to perform level conversion (for example MAX3232 3-V to 5.5-V Multichannel RS-232 Line Driver and Receiver With \u00b115-kV ESD Protection), otherwise it will not work properly.</p>"},{"location":"hardware/logic_levels.en/#rs485","title":"RS485","text":"<p>RS485 is transmitted through differential signals, that is, a pair of data signals is used to represent 0 or 1 of the digital signal by the difference between the two. It requires that the number 1 corresponds to the differential voltage V_{a} - V_{b} \\le -200 \\mathrm{mV}, and the number 0 corresponds to the differential voltage V_{a} - V_{b} \\ge +200 \\mathrm {mV}. The waveform is as follows:</p> <pre><code>{\n  signal:\n    [\n      { name: \"rs485_a\", wave: \"01010.1.\"},\n      { name: \"rs485_b\", wave: \"10101.0.\"},\n      { name: \"data\", wave: \"10101.0.\"},\n    ]\n}\n</code></pre>"},{"location":"hardware/logic_levels.en/#sstl","title":"SSTL","text":"<p>SSTL (Stub Series Terminated Logic) is the logic level standard used by SDRAM, and there are different versions:</p> <ul> <li>SSTL_15</li> <li>SSTL_18: V_{DDQ} = 1.8 \\mathrm{V}, V_{REF} = 0.9 \\mathrm{V}</li> <li>SSTL_2: V_{DDQ} = 2.5 \\mathrm{V}, V_{REF} = 1.25 \\mathrm{V}</li> <li>SSTL_3: V_{DDQ} = 3.3 \\mathrm{V}, V_{REF} = 1.5 \\mathrm{V}</li> </ul> <p>SSTL also has a differential version for transmitting differential signals such as CK and DQS.</p>"},{"location":"hardware/logic_levels.en/#lvds","title":"LVDS","text":"<p>LVDS (Low Voltage Differential Signaling) is also a common differential logic level standard. Since it uses differential transmission, there is a common-mode voltage and a differential-mode voltage. For example, the common-mode voltage of LVDS_25 is 1.2 \\mathrm{V}, and the differential-mode voltage is 0.45 \\mathrm{V}, which means that the voltages on the two data signals will be around 1.2-0.45/2 = 0.975 \\mathrm{V} and 1.2+0.45/2 = 1.425 \\mathrm{V}.</p> <p>TMDS is similar to LVDS, but the voltage is different. TMDS is often used for DVI and HDMI signal transmission.</p>"},{"location":"hardware/logic_levels.en/#acknowledgement","title":"Acknowledgement","text":"<p>The English version is kindly translated with the help of Google Translator.</p>"},{"location":"hardware/logic_levels.zh/","title":"\u903b\u8f91\u7535\u5e73\u6807\u51c6","text":"<p>\u903b\u8f91\u7535\u5e73\u6807\u51c6\u5b9a\u4e49\u4e86\u4e0d\u540c\u82af\u7247\u4e4b\u95f4\uff0c\u5982\u4f55\u628a\u6570\u5b57\u4fe1\u53f7 0 \u6216\u8005 1 \u8f6c\u5316\u4e3a\u9ad8\u4f4e\u7535\u5e73\uff0c\u4ee5\u53ca\u5982\u4f55\u628a\u9ad8\u4f4e\u7535\u5e73\u8f6c\u6362\u56de 0 \u6216\u8005 1\u3002</p> <p>\u9996\u5148\u662f\u8f93\u51fa\uff0c\u8981\u628a 0 \u6216\u8005 1 \u8f6c\u5316\u4e3a\u9ad8\u4f4e\u7535\u5e73\uff0c\u4e8e\u662f\u5c31\u8981\u5b9a\u4e49\u8303\u56f4\uff1a</p> <ul> <li>\u8f93\u51fa 0\uff1a\u7535\u538b\u6700\u9ad8\u662f V_{OL}\uff0cOutput Low Voltage</li> <li>\u8f93\u51fa 1\uff1a\u7535\u538b\u6700\u4f4e\u662f V_{OH}\uff0cOutput High Voltage</li> </ul> <p>\u53cd\u8fc7\u6765\uff0c\u8981\u628a\u7535\u5e73\u8f6c\u6362\u5230 0 \u6216\u8005 1 \u7684\u65f6\u5019\uff0c\u4e5f\u8981\u5b9a\u4e49\u8303\u56f4\uff1a</p> <ul> <li>\u5982\u679c\u7535\u538b\u9ad8\u4e8e V_{IH}\uff0c\u5c31\u8ba4\u4e3a\u662f 1</li> <li>\u5982\u679c\u7535\u538b\u4f4e\u4e8e V_{IL}\uff0c\u5c31\u8ba4\u4e3a\u662f 0</li> </ul> <p>\u901a\u5e38\uff0c\u4e0a\u9762\u56db\u9879\u6ee1\u8db3 V_{OL} &lt; V_{IL} &lt; V_{IH} &lt; V_{OH}\uff0c\u4e5f\u5c31\u662f\u8bf4\u8f93\u5165\u4f1a\u6bd4\u8f93\u51fa\u7684\u8303\u56f4\u66f4\u5927\uff0c\u66f4\u52a0\u5bbd\u5bb9\uff0c\u63d0\u4f9b\u4e00\u5b9a\u7684\u5bb9\u9519\u3002</p>"},{"location":"hardware/logic_levels.zh/#ttl","title":"TTL \u7535\u5e73","text":"<p>\u5e38\u89c1\u7684 5V TTL \u7535\u5e73\uff0c\u4ee5 https://learn.sparkfun.com/tutorials/logic-levels/ttl-logic-levels \u7684\u6570\u636e\u4e3a\u4f8b\u5b50\uff0c\u5b83\u7684\u7535\u5e73\u8303\u56f4\u662f\uff1a</p> <ul> <li>\u8f93\u51fa 0: V_{OL}=0.4, [0, 0.4]\\mathrm{V}</li> <li>\u8f93\u51fa 1: V_{OH}=2.7, [2.7, 5]\\mathrm{V}</li> <li>\u8f93\u5165 0: V_{IL}=0.8, [0, 0.8]\\mathrm{V}</li> <li>\u8f93\u5165 1: V_{IH}=2.0, [2, 5]\\mathrm{V}</li> </ul> <p>Wikipedia \u4e0a\u7684\u6570\u636e\u4e2d V_{OH}=2.4\u3002</p> <p>FT232H \u82af\u7247\u652f\u6301 TTL\uff0c\u53c2\u6570\u5982\u4e0b\uff1a</p> <ul> <li>V_{OL}=0.4, V_{OH}=2.4</li> <li>V_{IL}=0.8, V_{OL}=2.0</li> </ul>"},{"location":"hardware/logic_levels.zh/#cmos","title":"CMOS \u7535\u5e73","text":"<p>\u73b0\u5728\u6bd4\u8f83\u5e38\u89c1\u7684\u662f CMOS \u7535\u5e73\u3002\u4ee5 Artix-7 FPGAs \u4e3a\u4f8b\uff0c\u5b83\u652f\u6301\u591a\u79cd CMOS \u7535\u5e73\u6807\u51c6\uff1a</p> <ul> <li>LVCMOS12: V_{OL}=0.4, V_{OH}=V_{CCO}-0.4, V_{IL}=0.35V_{CCO}, V_{IH}=0.65V_{CCO}</li> <li>LVCMOS15: V_{OL}=0.25V_{CCO}, V_{OH}=0.75V_{CCO}, V_{IL}=0.35V_{CCO}, V_{IH}=0.65V_{CCO}</li> <li>LVCMOS18: V_{OL}=0.45, V_{OH}=V_{CCO}-0.45, V_{IL}=0.35V_{CCO}, V_{IH}=0.65V_{CCO}</li> <li>LVCMOS25: V_{OL}=0.4, V_{OH}=V_{CCO}-0.4, V_{IL}=0.7, V_{IH}=1.7</li> <li>LVCMOS33: V_{OL}=0.4, V_{OH}=V_{CCO}-0.4, V_{IL}=0.8, V_{IH}=2.0</li> </ul> <p>\u5176\u4e2d V_{CCO} \u662f\u5916\u90e8\u8f93\u5165\u7684\u7535\u538b\uff0c\u4e0e LVCMOS \u540e\u9762\u7684\u4e24\u4f4d\u6570\u5b57\u5339\u914d\uff0cLVCMOS33 \u5c31\u5bf9\u5e94 3.3 V\u3002\u6bcf\u4e2a Bank \u90fd\u6709\u76f8\u540c\u7684 V_{CCO} \u7535\u538b\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u5728\u7ea6\u675f\u6587\u4ef6\u91cc\u8981\u5199 IOSTANDARD\uff0c\u5e76\u4e14\u7ecf\u5e38\u8fde\u7eed\u7684\u4fe1\u53f7\u90fd\u4f7f\u7528\u540c\u6837\u7684\u7535\u5e73\u6807\u51c6\u3002</p> <p>\u4e00\u4e9b\u60c5\u51b5\u4e0b\uff0cTTL \u7535\u5e73\u6807\u51c6\u548c CMOS \u7535\u5e73\u6807\u51c6\u662f\u53ef\u4ee5\u517c\u5bb9\u7684\uff0c\u53ea\u8981\u5b83\u4eec\u7684\u7535\u538b\u8303\u56f4\u6ee1\u8db3\u8981\u6c42\uff0c\u5e76\u4e14\u53ef\u4ee5\u63a5\u53d7\u8f83\u9ad8\u7684\u8f93\u5165\u7535\u538b\u3002\u8be6\u89c1 Can I Use 3.3V TTL to Trigger a 3.3V CMOS Device \u548c Logic Guide - Texas Instruments\uff1a</p>    ![](logic_levels_compatible.png){ width=400 }   \u4e0d\u540c TTL \u548c CMOS \u7535\u5e73\u7684\u517c\u5bb9\u6027\uff08\u56fe\u6e90 Logic Guide - Texas Instruments\uff09"},{"location":"hardware/logic_levels.zh/#rs232","title":"RS232","text":"<p>RS232 \u6bd4\u8f83\u7279\u522b\uff0c\u5b83\u7684\u7535\u5e73\u6709\u6b63\u6709\u8d1f\uff1a</p> <ul> <li>\u8f93\u51fa 0: [-15, -5] \\mathrm{V}</li> <li>\u8f93\u51fa 1: [5, 15] \\mathrm{V}</li> <li>\u8f93\u5165 0: [-15, -3] \\mathrm{V}</li> <li>\u8f93\u5165 1: [3, 15] \\mathrm{V}</li> </ul> <p>\u56e0\u6b64\u5982\u679c\u60f3\u8981\u63a5 RS232 \u5916\u8bbe\u5230 FPGA \u4e0a\uff0c\u901a\u5e38\u9700\u8981\u8fdb\u884c\u7535\u5e73\u8f6c\u6362\uff08\u4f8b\u5982 MAX3232 3-V to 5.5-V Multichannel RS-232 Line Driver and Receiver With \u00b115-kV ESD Protection\uff09\uff0c\u5426\u5219\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002</p>"},{"location":"hardware/logic_levels.zh/#rs485","title":"RS485","text":"<p>RS485 \u901a\u8fc7\u5dee\u5206\u4fe1\u53f7\u6765\u4f20\u8f93\uff0c\u4e5f\u5c31\u662f\u7528\u4e00\u5bf9\u6570\u636e\u4fe1\u53f7\uff0c\u4ee5\u4e8c\u8005\u7684\u5dee\u503c\u6765\u8868\u793a\u6570\u5b57\u4fe1\u53f7\u7684 0 \u6216\u8005 1\u3002\u5b83\u8981\u6c42\uff0c\u6570\u5b57 1 \u5bf9\u5e94\u5dee\u5206\u7535\u538b V_{a} - V_{b} \\le -200 \\mathrm{mV}\uff0c\u6570\u5b57 0 \u5bf9\u5e94\u5dee\u5206\u7535\u538b V_{a} - V_{b} \\ge +200 \\mathrm{mV}\uff0c\u6ce2\u5f62\u5982\u4e0b\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"rs485_a\", wave: \"01010.1.\"},\n      { name: \"rs485_b\", wave: \"10101.0.\"},\n      { name: \"data\", wave: \"10101.0.\"},\n    ]\n}\n</code></pre>"},{"location":"hardware/logic_levels.zh/#sstl","title":"SSTL","text":"<p>SSTL(Stub Series Terminated Logic) \u662f SDRAM \u6240\u91c7\u7528\u7684\u7535\u5e73\u6807\u51c6\uff0c\u6709\u4e0d\u540c\u7684\u7248\u672c\uff1a</p> <ul> <li>SSTL_15</li> <li>SSTL_18: V_{DDQ} = 1.8 \\mathrm{V}, V_{REF} = 0.9 \\mathrm{V}</li> <li>SSTL_2: V_{DDQ} = 2.5 \\mathrm{V}, V_{REF} = 1.25 \\mathrm{V}</li> <li>SSTL_3: $V_{DDQ} = 3.3 \\mathrm{V}, V_{REF} = 1.5 \\mathrm{V}</li> </ul> <p>SSTL \u8fd8\u6709\u5dee\u5206\u7248\u672c\uff0c\u7528\u4e8e\u4f20\u8f93 CK\u3001DQS \u7b49\u5dee\u5206\u4fe1\u53f7\u3002</p>"},{"location":"hardware/logic_levels.zh/#lvds","title":"LVDS","text":"<p>LVDS(Low Voltage Differential Signaling) \u4e5f\u662f\u4e00\u4e2a\u5e38\u89c1\u7684\u5dee\u5206\u4fe1\u53f7\u7535\u5e73\u6807\u51c6\u3002\u7531\u4e8e\u662f\u5dee\u5206\u4f20\u8f93\uff0c\u5c31\u6709\u5171\u6a21\u7535\u538b\u548c\u5dee\u6a21\u7535\u538b\u3002\u4f8b\u5982 LVDS_25 \u7684\u5171\u6a21\u7535\u538b\u662f 1.2 \\mathrm{V}\uff0c\u5dee\u6a21\u7535\u538b\u662f 0.45 \\mathrm{V}\uff0c\u610f\u5473\u7740\u4e24\u4e2a\u6570\u636e\u4fe1\u53f7\u4e0a\u7684\u7535\u538b\u4f1a\u5206\u522b\u5728 1.2-0.45/2 = 0.975 \\mathrm{V} \u548c 1.2+0.45/2 = 1.425 \\mathrm{V} \u4e0a\u4e0b\u3002</p> <p>TMDS \u548c LVDS \u7c7b\u4f3c\uff0c\u4f46\u662f\u7535\u538b\u4e0d\u4e00\u6837\u3002TMDS \u7ecf\u5e38\u7528\u4e8e DVI \u548c HDMI \u7684\u4fe1\u53f7\u4f20\u8f93\u3002</p>"},{"location":"hardware/on_chip_networks/","title":"\u7247\u4e0a\u7f51\u7edc","text":""},{"location":"hardware/on_chip_networks/#_2","title":"\u80cc\u666f","text":"<p>\u968f\u7740\u82af\u7247\u5185\u7684\u6838\u5fc3\u6570\u91cf\u589e\u591a\uff0c\u5728\u5b9e\u73b0\u4e92\u8054\u7684\u65f6\u5019\uff0c\u4f20\u7edf\u7684 Crossbar \u9047\u5230\u4e86\u6269\u5c55\u6027\u7684\u74f6\u9888\uff0c\u56e0\u6b64\u9700\u8981\u7528\u7247\u4e0a\u7f51\u7edc\u6765\u66ff\u4ee3 Crossbar\u3002</p> <p>\u4e0b\u9762\u4e3b\u8981\u6309\u7167 On-Chip Networks, Second Edition \u4ee5\u53ca\u300a\u8ba1\u7b97\u673a\u7cfb\u7edf\u7ed3\u6784\u300b\u8bfe\u7a0b\u548c\u300a\u9ad8\u7b49\u8ba1\u7b97\u673a\u7cfb\u7edf\u7ed3\u6784\u300b\u8bfe\u4ef6\u7684\u987a\u5e8f\u8fdb\u884c\u8bb2\u89e3\u3002</p>"},{"location":"hardware/on_chip_networks/#_3","title":"\u62d3\u6251","text":"<p>\u62d3\u6251\u8bb2\u7684\u5c31\u662f\u7ed3\u70b9\u95f4\u7684\u8fde\u63a5\u65b9\u5f0f\u3002\u6bd4\u8f83\u5e38\u89c1\u7684\u62d3\u6251\u6709\uff1a</p> <ol> <li>Ring\uff1a\u6bcf\u4e2a\u7ed3\u70b9\u8fde\u63a5\u5230\u73af\u4e0a\u76f8\u90bb\u7684\u4e24\u4e2a\u7ed3\u70b9</li> <li>Mesh\uff1a\u4ee5 2D Mesh \u4e3a\u4f8b\uff0c\u628a\u7ed3\u70b9\u653e\u5728\u4e00\u4e2a\u7f51\u683c\u91cc\uff0c\u6bcf\u4e2a\u7ed3\u70b9\u6700\u591a\u8fde\u63a5\u56db\u4e2a\u76f8\u90bb\u7ed3\u70b9\uff1a\u5728\u5185\u90e8\u7684\u8fde\u63a5\u56db\u4e2a\u76f8\u90bb\u7ed3\u70b9\uff0c\u5728\u8fb9\u4e0a\u7684\u53ea\u8fde\u63a5\u4e09\u4e2a\u76f8\u90bb\u7ed3\u70b9\uff0c\u5728\u89d2\u4e0a\u7684\u53ea\u8fde\u63a5\u4e24\u4e2a\u7ed3\u70b9</li> <li>Torus\uff1a\u5728 Mesh \u7684\u57fa\u7840\u4e0a\uff0c\u8ba9\u8fb9\u548c\u89d2\u4e0a\u7684\u7ed3\u70b9\u4e5f\u8fde\u63a5\u56db\u4e2a\u7ed3\u70b9\uff1a\u8fb9\u4e0a\u7684\u7ed3\u70b9\u8fde\u5230\u5bf9\u4fa7\u6700\u8fdc\u7684\u7ed3\u70b9\uff0c\u89d2\u4e0a\u7684\u7ed3\u70b9\u8fde\u5230\u53e6\u5916\u4e24\u4e2a\u89d2</li> </ol>    ![Ring, Mesh and Torus](on_chip_networks_example.png){ width=\"600\" }   Ring\uff0cMesh \u548c Torus\uff08\u56fe\u6e90 On Chip Networks, Second Edition\uff09 <p>\u5176\u4e2d Mesh \u548c Torus \u8fd8\u53ef\u4ee5\u6269\u5c55\u5230\u9ad8\u9636\u60c5\u51b5\uff0c\u4f8b\u5982 3D \u7684\u7acb\u65b9\u4f53\u3002</p> <p>\u8fd8\u6709\u4e00\u4e9b\u6bd4\u8f83\u590d\u6742\u7684\u7f51\u7edc\u62d3\u6251\uff0c\u4f8b\u5982 Fat Tree\uff0c\u5728\u6811\u5f62\u62d3\u6251\u7684\u57fa\u7840\u4e0a\uff0c\u7531\u4e8e\u6811\u4e0a\u4e24\u53f6\u5b50\u7ed3\u70b9\u95f4\u8def\u5f84\u4f1a\u6bd4\u8f83\u591a\u5730\u7ecf\u8fc7\u5c42\u6570\u6bd4\u8f83\u5c0f\u7684\u7ed3\u70b9\uff0c\u4f8b\u5982\u6839\u7ed3\u70b9\uff0c\u628a\u9760\u8fd1\u6839\u7ed3\u70b9\u7684\u8fb9\u53d8\u7c97\uff08\u589e\u52a0\u5e26\u5bbd\uff09\uff1a</p>    ![Fat Tree](on_chip_networks_fat_tree.svg){ width=\"400\" }   Fat Tree\uff08\u56fe\u6e90 Wikipedia\uff09 <p>\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u8bc4\u4f30\u4e00\u4e2a\u62d3\u6251\u7684\u5c5e\u6027\uff1a</p> <ol> <li>\u7ed3\u70b9\u7684\u5ea6\uff1a\u8fde\u63a5\u7684\u7ed3\u70b9\u6570</li> <li>\u76f4\u5f84\uff1a\u7ed3\u70b9\u95f4\u8ddd\u79bb\u7684\u6700\u5927\u503c</li> <li>\u7b49\u5206\u5bbd\u5ea6\uff1a\u7f51\u7edc\u88ab\u5207\u6210\u4e24\u534a\uff08\u6216\u8005\u51e0\u4e4e\u4e24\u534a\uff09\u7684\u65f6\u5019\uff0c\u5207\u5272\u7684\u6700\u5c0f\u8fb9\u6570</li> </ol> <p>\u5728\u8fd9\u4e09\u79cd\u62d3\u6251\u4e2d\uff0c\u7ed3\u70b9\u65e2\u662f\u6d41\u91cf\u7684\u8d77\u70b9\u548c\u7ec8\u70b9\uff0c\u53c8\u8d1f\u8d23\u4e86\u6d41\u91cf\u7684\u8f6c\u53d1\u3002</p> <p>\u53e6\u4e00\u7c7b\u62d3\u6251\u4e2d\uff0c\u6709\u90e8\u5206\u7ed3\u70b9\u53ea\u8d1f\u8d23\u8f6c\u53d1\u6d41\u91cf\uff0c\u4e0d\u4f5c\u4e3a\u6d41\u91cf\u7684\u8d77\u70b9\u548c\u7ec8\u70b9\uff0c\u4f8b\u5982 Butterfly \u7f51\u7edc\uff0cClos \u7f51\u7edc\uff0cFat Tree\u3002</p> <p>\u4f46\u7531\u4e8e\u7247\u4e0a\u7f51\u7edc\u662f\u8981\u5b9e\u73b0\u5728\u82af\u7247\u4e0a\u7684\uff0c\u800c\u82af\u7247\u662f 2D \u7684\uff0c\u6240\u4ee5\u7247\u4e0a\u7f51\u7edc\u4e00\u822c\u4f1a\u7528\u53ef\u4ee5\u653e\u5728\u5e73\u9762\u4e0a\u7684\u62d3\u6251\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u5c31\u662f Mesh \u548c Ring\u3002</p>"},{"location":"hardware/on_chip_networks/#_4","title":"\u8def\u7531","text":"<p>\u786e\u5b9a\u597d\u7f51\u7edc\u62d3\u6251\u540e\uff0c\u5728\u5b9e\u9645\u4f20\u8f93\u4e4b\u524d\uff0c\u7531\u4e8e\u4e24\u4e2a\u7ed3\u70b9\u95f4\u8def\u5f84\u4e0d\u552f\u4e00\uff0c\u6240\u4ee5\u9700\u8981\u8003\u8651\u5982\u4f55\u628a\u8bf7\u6c42\u4ece\u8d77\u70b9\u8def\u7531\u5230\u7ec8\u70b9\u3002\u8fd9\u91cc\u4e3b\u8981\u8003\u8651\u7684\u662f Mesh \u62d3\u6251\u7684\u8def\u7531\u7b97\u6cd5\u3002</p> <p>\u9996\u5148\u5bb9\u6613\u60f3\u5230\u7684\u662f\u9009\u62e9\u6700\u77ed\u8def\u5f84\uff0c\u4f46\u5728 Mesh \u62d3\u6251\u4e2d\uff0c\u6700\u77ed\u8def\u5f84\u4e5f\u662f\u4e0d\u552f\u4e00\u7684\uff0c\u56e0\u6b64\u8fd8\u662f\u9700\u8981\u66f4\u52a0\u5177\u4f53\u7684\u7b97\u6cd5\u6765\u505a\u51fa\u9009\u62e9\u3002</p> <p>\u8def\u7531\u5728\u9009\u53d6\u7684\u65f6\u5019\u8fd8\u9700\u8981\u8003\u8651\u6b7b\u9501\u7684\u95ee\u9898\uff1a\u7531\u4e8e\u901a\u5e38\u7247\u4e0a\u7f51\u7edc\u662f\u4e0d\u5141\u8bb8\u4e22\u5305\u7684\uff0c\u56e0\u6b64\u5982\u679c\u53d1\u9001\u6570\u636e\u65f6\uff0c\u63a5\u6536\u65b9\u7684\u7f13\u51b2\u533a\u5df2\u7ecf\u6ee1\u4e86\uff0c\u5c31\u4e0d\u80fd\u7ee7\u7eed\u53d1\u9001\u4e86\u3002\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u4e00\u4e2a\u4f9d\u8d56\u5173\u7cfb\uff1aA \u8981\u53d1\u7ed9 B\uff0c\u4f46\u540c\u65f6 B \u4e5f\u8981\u53d1\u7ed9 C\uff0c\u73b0\u5728 B \u548c C \u7684\u7f13\u51b2\u533a\u6ee1\u4e86\uff0c\u90a3\u4e48\u53ea\u6709\u7b49 C \u7684\u7f13\u51b2\u533a\u91ca\u653e\u7a7a\u95f4\uff0cB \u624d\u80fd\u53d1\u7ed9 C\uff0c\u7136\u540e B \u7684\u7f13\u51b2\u533a\u624d\u5f97\u4ee5\u91ca\u653e\uff0cA \u624d\u80fd\u53d1\u7ed9 B\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cA \u5230 B \u7684\u4f20\u8f93\u53ea\u6709\u7b49 B \u5230 C \u7684\u4f20\u8f93\u5b8c\u6210\u624d\u53ef\u4ee5\u7ee7\u7eed\u3002</p> <p>\u90a3\u4e48\uff0c\u5047\u5982\u6b64\u65f6 A \u5230 B \u8981\u7b49\u5f85 B \u5230 C \u4f20\u8f93\u5b8c\u6210\uff0cB \u5230 C \u8981\u7b49\u5f85 C \u5230 D \u4f20\u8f93\u5b8c\u6210\uff0cC \u5230 D \u8981\u7b49\u5f85 D \u5230 A \u4f20\u8f93\u5b8c\u6210\uff0cD \u5230 A \u8981\u7b49\u5f85 A \u5230 B \u4f20\u8f93\u5b8c\u6210\uff0c\u6b64\u65f6\u5c31\u51fa\u73b0\u4e86\u6b7b\u9501\uff1a\u4e92\u76f8\u4f9d\u8d56\uff0c\u51fa\u73b0\u4e86\u73af\uff0c\u5e76\u4e14\u6ca1\u6709\u529e\u6cd5\u4ece\u73af\u4e2d\u9000\u51fa\uff0c\u90a3\u5c31\u6b7b\u9501\u4e86\u3002</p>    ![Deadlock in NoC](on_chip_networks_deadlock.png){ width=\"300\" }   \u8def\u7531\u534f\u8bae\u6b7b\u9501\u7684\u60c5\u51b5\uff08\u56fe\u6e90 On Chip Networks, Second Edition\uff09 <p>\u4e00\u4e2a\u7ecf\u5178\u7684\u8def\u7531\u7b97\u6cd5\u662f\u7ef4\u5e8f\u8def\u7531\uff08Dimension Ordering Routing\uff0c\u7b80\u79f0 DOR\uff09\uff0c\u610f\u601d\u5c31\u662f\u6309\u7167\u7ef4\u5ea6\u7684\u987a\u5e8f\u53bb\u8def\u7531\uff0c\u53ea\u6709\u524d\u4e00\u4e2a\u7ef4\u5ea6\u8d70\u5230\u548c\u7ec8\u70b9\u76f8\u540c\uff0c\u624d\u4f1a\u5728\u4e0b\u4e00\u4e2a\u7ef4\u5ea6\u7ee7\u7eed\u8d70\u3002\u4f8b\u5982\u5728\u4e8c\u7ef4\u573a\u666f\u4e0b\uff0cX-Y \u8def\u7531\u5c31\u662f\u5148\u8d70 X \u8f74\uff0c\u8d70\u5b8c X \u8f74\u4ee5\u540e\u518d\u8d70 Y \u8f74\u3002\u53cd\u8fc7\u6765 Y-X \u8def\u7531\u5219\u662f\u5148\u8d70 Y \u8f74\uff0c\u518d\u8d70 X \u8f74\u3002</p> <p>\u7ef4\u5e8f\u8def\u7531\u5341\u5206\u7b80\u5355\uff0c\u5bb9\u6613\u5b9e\u73b0\uff0c\u5e76\u4e14\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\u3002\u7ef4\u5e8f\u8def\u7531\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\u7684\u539f\u56e0\u662f\uff0c\u5b83\u7684\u4f9d\u8d56\u4e0d\u4f1a\u51fa\u73b0\u73af\uff1a\u4ee5 X-Y \u8def\u7531\u4e3a\u4f8b\uff0c\u6240\u6709 X \u65b9\u5411\u4e0a\u7684\u4f20\u8f93\u53ef\u80fd\u4f9d\u8d56 Y \u65b9\u5411\u4e0a\u7684\u4f20\u8f93\uff0c\u4f46 Y \u65b9\u5411\u4e0a\u7684\u4f20\u8f93\u4e0d\u4f1a\u4f9d\u8d56 X \u65b9\u5411\u4e0a\u7684\u4f20\u8f93\u3002\u8fd8\u662f\u4ee5\u4e0a\u56fe\u4e3a\u4f8b\u5b50\uff1aA \u5230 B \u7684\u4f20\u8f93\u4f9d\u8d56 B \u5230 C \u7684\u4f20\u8f93\uff0c\u4f46\u662f B \u5230 C \u7684\u4f20\u8f93\u4e0d\u4f1a\u4f9d\u8d56 C \u5230 D \u7684\u4f20\u8f93\uff0c\u56e0\u4e3a\u8fd9\u4e0d\u7b26\u5408 X-Y \u8def\u7531\u7684\u89c4\u5219\u3002</p> <p>\u4f46\u662f\u7ef4\u5e8f\u8def\u7531\u7684\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\uff1a\u6d6a\u8d39\u4e86\u5f88\u591a\u53ef\u80fd\u7684\u8def\u5f84\uff0c\u4f8b\u5982 A \u548c B \u540c\u65f6\u8981\u5411 C \u4f20\u8f93\uff0c\u5c31\u4f1a\u5728 B \u5230 C \u7684\u8fb9\u4e0a\u62e5\u6324\uff0c\u65e0\u6cd5\u5229\u7528\u5269\u4e0b\u7684\u8def\u5f84\u3002</p> <p>\u63a5\u4e0b\u6765\u4ecb\u7ecd\u8def\u7531\u7b97\u6cd5\u7684\u4e24\u4e2a\u5206\u7c7b\uff1a\u4e00\u7c7b\u662f Oblivious \u8def\u7531\u7b97\u6cd5\uff0c\u53e6\u4e00\u7c7b\u662f Adaptive \u8def\u7531\u7b97\u6cd5\u3002\u987e\u540d\u601d\u4e49\uff0cOblivious \u4e0d\u8003\u8651\u7f51\u7edc\u5f53\u524d\u7684\u62e5\u585e\u72b6\u6001\uff0c\u76f4\u63a5\u6309\u7167\u81ea\u5df1\u7684\u7b97\u6cd5\u6765\u53d1\uff1bAdaptive \u4f1a\u6839\u636e\u7f51\u7edc\u5f53\u524d\u7684\u62e5\u585e\u72b6\u6001\uff0c\u671f\u671b\u627e\u5230\u4e00\u4e2a\u4e0d\u90a3\u4e48\u62e5\u6324\u7684\u8def\u5f84\u3002</p> <p>\u663e\u7136\uff0c\u7ef4\u5e8f\u8def\u7531\u6ca1\u6709\u8003\u8651\u7f51\u7edc\u662f\u5426\u62e5\u585e\uff0c\u5c5e\u4e8e Oblivious \u8def\u7531\u7b97\u6cd5\u3002\u53e6\u4e00\u4e2a\u5178\u578b\u7684 Oblivious \u8def\u7531\u662f Valiant \u968f\u673a\u8def\u7531\u7b97\u6cd5\uff1a\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u4e2d\u95f4\u7ed3\u70b9\uff0c\u5148\u4ece\u8d77\u70b9\u8def\u7531\u5230\u4e2d\u95f4\u7ed3\u70b9\uff0c\u518d\u4ece\u4e2d\u95f4\u7ed3\u70b9\u8def\u7531\u5230\u7ec8\u70b9\u3002\u8fd8\u6709\u4e00\u79cd\u5178\u578b\u7684 Oblivious \u8def\u7531\uff0c\u5c31\u662f\u968f\u673a\u9009\u62e9 X-Y \u8def\u7531\u6216 Y-X \u8def\u7531\u7684\u4e00\u79cd\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u51fa\u73b0\u6b7b\u9501\u3002</p> <p>Adaptive \u8def\u7531\u7b97\u6cd5\u7684\u76ee\u7684\u662f\uff0c\u6839\u636e\u7f51\u7edc\u7684\u62e5\u585e\u60c5\u51b5\uff0c\u627e\u5230\u4e00\u4e2a\u66f4\u4f18\u7684\u8def\u7531\uff0c\u7ed5\u8fc7\u62e5\u585e\u7684\u90e8\u5206\uff0c\u5b9e\u73b0\u66f4\u9ad8\u7684\u5e26\u5bbd\u5229\u7528\u7387\u3002\u4f8b\u5982\u5982\u679c\u6700\u77ed\u8def\u5f84\u4e0a\u51fa\u73b0\u4e86\u62e5\u585e\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u7ed5\u8def\uff0c\u5728\u4e00\u6761\u4e0d\u62e5\u585e\u7684\u6700\u77ed\u8def\u5f84\u4e0a\u4f20\u8f93\u3002\u4f46\u662f\u7ed5\u8def\u7684\u65f6\u5019\uff0c\u9700\u8981\u9632\u6b62\u6d3b\u9501\uff1a\u4e00\u76f4\u5728\u7ed5\u8def\uff0c\u4ece\u6765\u6ca1\u5230\u8fbe\u76ee\u7684\u5730\u3002</p> <p>\u8bbe\u8ba1 Adaptive \u8def\u7531\u7684\u65f6\u5019\uff0c\u4e5f\u8981\u8003\u8651\u5982\u4f55\u907f\u514d\u6b7b\u9501\u3002\u7ef4\u5e8f\u8def\u7531\u4fdd\u8bc1\u4e86\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff0c\u4f46\u4e5f\u552f\u4e00\u786e\u5b9a\u4e86\u8def\u7531\uff0c\u65e0\u6cd5\u652f\u6301 Adaptive \u8def\u7531\u3002\u4f46\u5b9e\u9645\u4e0a\uff0c\u4e3a\u4e86\u907f\u514d\u6b7b\u9501\uff0c\u4e0d\u9700\u8981\u50cf\u7ef4\u5e8f\u8def\u7531\u90a3\u4e48\u4e25\u683c\u3002</p> <p>\u56de\u987e\u4e00\u4e0b\u7ef4\u5e8f\u8def\u7531\u4e2d\u7684 X-Y \u8def\u7531\uff1a\u5b83\u8981\u6c42\u5148\u8d70 X \u8f74\uff0c\u518d\u8d70 Y \u8f74\uff0c\u90a3\u4e48\u4ece X \u8f74\u62d0\u5230 Y \u8f74\u7684\u65f6\u5019\uff0c\u6709\u56db\u79cd\u60c5\u51b5\uff0c\u89c1\u4e0b\u56fe (b)\uff1a</p>    ![Turns in 2-D Mesh](on_chip_networks_turn.png){ width=\"500\" }   Mesh \u7684\u8f6c\u5411\uff08(a) \u662f\u6240\u6709\u53ef\u80fd\uff0c(b) \u662f X-Y \u8def\u7531\uff09\uff08\u56fe\u6e90 On Chip Networks, Second Edition\uff09 <p>\u8fd9\u79cd\u62d0\u6cd5\u53ef\u4ee5\u4fdd\u8bc1\u4e0d\u51fa\u73b0\u6b7b\u9501\uff0c\u4f46\u662f\u6709\u66f4\u52a0\u5bbd\u677e\u7684\u8f6c\u5411\u65b9\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u4fdd\u8bc1\u4e0d\u51fa\u73b0\u6b7b\u9501\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u4e09\u79cd\uff1a</p>    ![Turn models in 2-D Mesh](on_chip_networks_adaptive_turn.png){ width=\"500\" }   Mesh \u7684\u4e09\u79cd\u8f6c\u5411\u6a21\u578b\uff08\u56fe\u6e90 On Chip Networks, Second Edition\uff09 <p>\u6bcf\u79cd\u8f6c\u5411\u6a21\u578b\u90fd\u5728\u516b\u79cd\u8f6c\u5411\u4e2d\u53bb\u6389\u4e86\u4e24\u79cd\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u65e0\u6b7b\u9501\u3002West First Turns \u7684\u610f\u601d\u662f\u5148\u5f80\u897f\u8d70\uff0c\u8f6c\u5411\u540e\u4e0d\u518d\u5f80\u897f\u8d70\uff1bNorth Last Turns \u7684\u610f\u601d\u662f\u5f80\u5317\u8d70\u53ea\u80fd\u51fa\u73b0\u5728\u6700\u540e\u9636\u6bb5\uff0c\u5f80\u5317\u8d70\u4ee5\u540e\u5c31\u4e0d\u518d\u8f6c\u5411\uff1bNegative First Turns \u7684\u610f\u601d\u662f\u5148\u5f80\u897f\uff08X \u8f74\u8d1f\u65b9\u5411\uff09\u6216\u8005\u5357\uff08Y \u8f74\u8d1f\u65b9\u5411\uff09\u8d70\uff0c\u4e4b\u540e\u518d\u5f80\u4e1c\uff08X \u8f74\u6b63\u65b9\u5411\uff09\u6216\u8005\u5317\uff08Y \u8f74\u6b63\u65b9\u5411\uff09\u8d70\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd Odd-even \u65b9\u6cd5\uff1a\u5728\u5076\u6570\u5217\u7684\u65f6\u5019\uff0c\u7981\u6b62\u4e1c\u8f6c\u5317\u548c\u5317\u8f6c\u897f\uff1b\u5728\u5947\u6570\u5217\u7684\u65f6\u5019\uff0c\u7981\u6b62\u4e1c\u8f6c\u5357\u548c\u5357\u8f6c\u897f\u3002</p> <p>\u6709\u4e86\u66f4\u591a\u8f6c\u5411\u65b9\u5411\u540e\uff0c\u5c31\u5141\u8bb8\u51fa\u73b0\u591a\u79cd\u53ef\u80fd\u7684\u8def\u5f84\uff0c\u610f\u5473\u7740 Adaptive \u8def\u7531\u7b97\u6cd5\u53ef\u4ee5\u5728\u4fdd\u8bc1\u4e0d\u6b7b\u9501\u7684\u524d\u63d0\u4e0b\uff0c\u627e\u51fa\u4e00\u6761\u6bd4\u8f83\u4f18\u7684\u8def\u5f84\u3002</p> <p>\u5728\u4e0b\u4e00\u8282\u4f1a\u4ecb\u7ecd\u5982\u4f55\u7528\u6d41\u63a7\u6765\u4fdd\u8bc1\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff0c\u6b64\u65f6\u8def\u7531\u5c31\u4e0d\u9700\u8981\u4fdd\u8bc1\u4e0d\u51fa\u73b0\u6b7b\u9501\u4e86\uff0c\u8fd9\u6837\u53ef\u4ee5\u83b7\u5f97\u66f4\u591a\u7684\u7075\u6d3b\u6027\u3002</p>"},{"location":"hardware/on_chip_networks/#_5","title":"\u6d41\u63a7","text":"<p>\u786e\u5b9a\u597d\u8def\u7531\u4ee5\u540e\uff0c\u8fd8\u9700\u8981\u8003\u8651\u6d41\u91cf\u63a7\u5236\u7684\u95ee\u9898\uff1a\u5f53\u94fe\u8def\u51fa\u73b0\u62e5\u585e\uff0c\u5982\u4f55\u4fdd\u8bc1\u9ad8\u6548\u7684\u4f20\u8f93\u3002</p> <p>\u5728\u5b9e\u73b0\u6d41\u63a7\u4e4b\u524d\uff0c\u9700\u8981\u5148\u4e86\u89e3\u5728\u7247\u4e0a\u7f51\u7edc\u4e0a\u4f20\u8f93\u7684\u662f\u4ec0\u4e48\u6570\u636e\uff0c\u53c8\u662f\u600e\u4e48\u4f20\u8f93\u6570\u636e\u7684\u3002</p> <p>\u9996\u5148\uff0c\u7ed3\u70b9\u8981\u53d1\u9001\u7684\u662f\u6d88\u606f\uff08Message\uff09\uff0c\u4f8b\u5982\u8981\u8bfb\u5199\u5185\u5b58\uff0c\u5b9e\u73b0\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u7b49\u7b49\u3002\u5bf9\u4e8e\u4e0a\u5c42\u6765\u8bf4\uff0c\u5b83\u6536\u53d1\u7684\u90fd\u662f\u6d88\u606f\uff0c\u628a\u6d88\u606f\u4ea4\u7ed9\u7247\u4e0a\u7f51\u7edc\u4ee5\u540e\uff0c\u7531\u7247\u4e0a\u7f51\u7edc\u8d1f\u8d23\u4f20\u8f93\u5230\u76ee\u7684\u5730\uff0c\u800c\u4e0d\u9700\u8981\u8003\u8651\u7247\u4e0a\u7f51\u7edc\u662f\u5177\u4f53\u600e\u4e48\u5b9e\u73b0\u7684\u3002\u5982\u679c\u62ff\u7f51\u7edc\u6765\u7c7b\u6bd4\uff0c\u5c31\u50cf\u662f\u5728\u4e00\u4e2a\u53ef\u9760\u7684 UDP \u534f\u8bae\u4e0a\u4f20\u8f93\u6d88\u606f\u3002</p> <p>\u6b63\u5982 IP \u6709\u6700\u5927\u957f\u5ea6\uff0c\u9700\u8981\u8fdb\u884c\u5206\u7247\uff0c\u7247\u4e0a\u7f51\u7edc\u4e5f\u6709\u7c7b\u4f3c\u7684\u673a\u5236\uff0c\u5c31\u662f\u628a\u6d88\u606f\u62c6\u6210\u5f88\u591a\u4e2a Packet\uff0cPacket \u6709\u6700\u5927\u957f\u5ea6\u3002\u4ece Message \u5230 Packet \u9664\u4e86\u5206\u7247\u4ee5\u5916\uff0c\u53ef\u80fd\u8fd8\u6d89\u53ca\u5230\u5730\u5740\u7684\u8f6c\u6362\uff1a\u4f8b\u5982\u6839\u636e\u8bfb\u53d6\u5185\u5b58\u7684\u5730\u5740\uff0c\u627e\u5230\u5730\u5740\u6240\u5bf9\u5e94\u7684\u5185\u5b58\u63a7\u5236\u5668\uff0c\u8ba1\u7b97\u51fa\u5185\u5b58\u63a7\u5236\u5668\u5728\u7247\u4e0a\u7f51\u7edc\u7684\u5750\u6807\uff0c\u7136\u540e\u586b\u5230 Packet \u7684\u5934\u90e8\u4e0a\u3002\u5230 Packet \u8fd9\u4e00\u5c42\u4e4b\u540e\uff0c\u5c31\u662f\u7528\u7247\u4e0a\u7f51\u7edc\u7684\u903b\u8f91\u6765\u5904\u7406\u4e86\uff0c\u4e0a\u5c42\u7684 Message \u4ec5\u4ec5\u662f\u8f7d\u8377\u3002\u5f53 Packet \u5230\u8fbe\u76ee\u7684\u5730\u7684\u65f6\u5019\uff0c\u5219\u8981\u91cd\u65b0\u7ec4\u88c5\u6210 Message \u4ea4\u7ed9\u4e0a\u5c42\u903b\u8f91\u3002</p> <p>\u7b2c\u4e00\u4e2a\u6d41\u63a7\u65b9\u6cd5\u662f\u7535\u8def\u4ea4\u6362\uff08Circuit Switching\uff09\uff1a\u5148\u521d\u59cb\u5316\u4e00\u4e2a\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u7684\u94fe\u8def\uff0c\u521d\u59cb\u5316\u597d\u4ee5\u540e\u624d\u5f00\u59cb\u53d1\u9001\u6570\u636e\uff0c\u6b64\u65f6\u6570\u636e\u4e0d\u9700\u8981\u5206\u7247\uff0c\u76f4\u63a5\u53d1\u9001\u3002\u94fe\u8def\u5efa\u7acb\u4ee5\u540e\uff0c\u94fe\u8def\u4e0a\u7684\u7ed3\u70b9\u53ea\u8d1f\u8d23\u4f20\u8f93\u8fd9\u4e00\u4e2a\u94fe\u8def\u4e0a\u7684\u6d88\u606f\uff0c\u6240\u4ee5\u5982\u679c\u4f20\u8f93\u7684\u6570\u636e\u5360\u4e0d\u6ee1\u94fe\u8def\u7684\u5e26\u5bbd\uff0c\u5c31\u4f1a\u6d6a\u8d39\u3002\u4f46\u662f\u4f20\u8f93\u6570\u636e\u7684\u6548\u7387\u6bd4\u8f83\u9ad8\uff1a\u6ca1\u6709\u5206\u7247\u7684\u5f00\u9500\uff0c\u5982\u679c\u4f20\u8f93\u7684\u6570\u636e\u91cf\u5927\uff0c\u53ef\u4ee5\u5206\u644a\u5efa\u7acb\u9636\u6bb5\u7684\u5f00\u9500\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u6d41\u63a7\u65b9\u6cd5\u662f\u5b58\u50a8\u8f6c\u53d1\uff08Store and Forward\uff09\uff1a\u628a\u6536\u5230\u7684 Packet \u4fdd\u5b58\u4e0b\u6765\uff0c\u7136\u540e\u6839\u636e\u6bcf\u4e2a Packet \u7684\u76ee\u7684\u5730\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u7ed3\u70b9\u7684\u65b9\u5411\uff0c\u7136\u540e\u53d1\u9001\u3002\u8fd9\u5728\u4ee5\u592a\u7f51\u4ea4\u6362\u673a\u91cc\u5f88\u5e38\u89c1\uff0c\u4f46\u662f\u7f3a\u70b9\u662f\u5ef6\u8fdf\u6bd4\u8f83\u5927\u3002\u5728\u7247\u4e0a\u7f51\u7edc\u4e2d\uff0c\u5b58\u50a8\u8f6c\u53d1\u6709\u4e24\u4e2a\u95ee\u9898\uff1a\u4e00\u662f\u7684\u5b58\u50a8\u8f6c\u53d1\u5ef6\u8fdf\u65e0\u6cd5\u5ffd\u7565\uff0c\u4e8c\u662f\u9700\u8981\u6bd4\u8f83\u5927\u7684\u7f13\u51b2\u533a\u6765\u4fdd\u5b58 Packet\u3002</p> <p>\u5728\u5b58\u50a8\u8f6c\u53d1\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u4f18\u5316\uff0c\u5f97\u5230\u865a\u62df\u76f4\u901a\uff08Virtual Cut-through\uff09\u65b9\u6cd5\uff1a\u6536\u5230 Packet \u5934\u90e8\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u5c31\u53ef\u4ee5\u77e5\u9053\u8981\u8f6c\u53d1\u7684\u4e0b\u4e00\u4e2a\u7ed3\u70b9\u4e86\uff0c\u56e0\u6b64\u53ef\u4ee5\u628a Packet \u62c6\u6210\u66f4\u5c0f\u7684\u5355\u4f4d\uff0c\u79f0\u4e3a Flit\uff08Flow control unit/Flow control digit\uff09\u3002\u628a\u4e00\u4e2a Packet \u62c6\u5206\u6210\u591a\u4e2a Flit \u4ee5\u540e\uff0c\u7ed3\u70b9\u63a5\u6536\u5230\u7b2c\u4e8c\u4e2a Flit \u65f6\uff0c\u53ef\u4ee5\u540c\u6b65\u53d1\u9001\u7b2c\u4e00\u4e2a Flit\uff1b\u63a5\u6536\u5230\u7b2c\u4e09\u4e2a Flit \u7684\u65f6\u5019\uff0c\u540c\u6b65\u53d1\u9001\u7b2c\u4e8c\u4e2a Flit\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002\u7ee7\u7eed\u53d1\u9001\u7684\u524d\u63d0\u662f\u4e0b\u4e00\u4e2a\u7ed3\u70b9\u7684\u7f13\u5b58\u53ef\u4ee5\u653e\u5f97\u4e0b\u4e00\u4e2a Packet\u3002\u53ea\u6709\u7b2c\u4e00\u4e2a Flit \u4f1a\u4fdd\u5b58\u8def\u7531\u4fe1\u606f\uff0c\u5176\u4f59\u7684\u53ea\u4fdd\u5b58\u6570\u636e\u3002</p> <p>\u865a\u62df\u76f4\u901a\u7f13\u89e3\u4e86\u5b58\u50a8\u8f6c\u53d1\u7684\u5ef6\u8fdf\u95ee\u9898\uff0c\u63a5\u4e0b\u6765\u89e3\u51b3\u7b2c\u4e8c\u4e2a\u95ee\u9898\uff0c\u5373\u5728\u7f13\u51b2\u533a\u5927\u5c0f\u4e0a\u8fdb\u884c\u4f18\u5316\uff0c\u5f97\u5230\u866b\u5b54\u6d41\u63a7\uff08Wormhole\uff09\u65b9\u6cd5\uff1a\u7f13\u51b2\u533a\u4e0d\u9700\u8981\u4fdd\u5b58\u5b8c\u6574\u7684 Packet\uff0c\u53ea\u9700\u8981\u80fd\u653e\u5f97\u4e0b\u4e00\u4e2a Flit\uff0c\u5c31\u53ef\u4ee5\u50cf\u865a\u62df\u76f4\u901a\u90a3\u6837\u7ee7\u7eed\u4f20\u8f93\u3002</p> <p>\u4f46\u662f\u866b\u5b54\u6d41\u63a7\u51fa\u73b0\u4e86\u65b0\u7684 Head of Line Blocking \u95ee\u9898\uff1a\u5f53\u7f13\u51b2\u533a\u6ee1\u4e86\u7684\u65f6\u5019\uff0c\u4e00\u4e2a Packet \u7684\u591a\u4e2a Flit \u53ef\u80fd\u6563\u843d\u5728\u591a\u4e2a\u7ed3\u70b9\u4e2d\uff0c\u8fd9\u4e9b\u7ed3\u70b9\u90fd\u56e0\u4e3a\u540c\u4e00\u4e2a Packet \u5835\u585e\uff0c\u65e0\u6cd5\u4f20\u8f93\u5176\u4ed6\u6570\u636e\u3002\u6bd4\u8f83\u6781\u7aef\u7684\u60c5\u51b5\u662f\uff0c\u540c\u4e00\u4e2a Packet \u7684\u7b2c\u4e00\u4e2a Flit \u5df2\u7ecf\u5230\u8fbe\u7ec8\u70b9\uff0c\u4f46\u662f\u6700\u540e\u4e00\u4e2a Flit \u8fd8\u5728\u8d77\u70b9\uff0c\u6b64\u65f6\u5982\u679c\u51fa\u73b0\u4e86\u963b\u585e\uff0c\u5c31\u53ef\u80fd\u628a\u6574\u4e2a\u8def\u5f84\u4e0a\u7684\u7ed3\u70b9\u5835\u4f4f\u3002\u865a\u62df\u76f4\u901a\uff08Virtual cut-through\uff09\u7b97\u6cd5\u5728\u51fa\u73b0\u963b\u585e\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u53d1\u9001\u65f6\u5df2\u7ecf\u4fdd\u8bc1\u4e86\u7f13\u51b2\u533a\u53ef\u4ee5\u653e\u4e0b\u6574\u4e2a Packet\uff0c\u56e0\u6b64\u5373\u4f7f\u51fa\u73b0\u4e86\u963b\u585e\uff0c\u90e8\u5206\u7ed3\u70b9\u8fd8\u662f\u53ef\u4ee5\u7ee7\u7eed\u53d1\u9001 Flit\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3 Head of Line Blocking \u7684\u95ee\u9898\uff0c\u5f15\u5165\u4e86\u865a\u62df\u901a\u9053\uff08Virtual Channel\uff09\u65b9\u6cd5\uff1a\u65e2\u7136 Block \u5728 Head of Line \u4e0a\uff0c\u90a3\u5c31\u652f\u6301\u591a\u4e2a Line\uff0c\u4e5f\u5c31\u662f\u591a\u4e2a Virtual Channel\u3002\u867d\u7136\u7269\u7406\u4e0a\u8fd8\u662f\u539f\u6765\u7684\u901a\u9053\uff0c\u4f46\u662f\u903b\u8f91\u4e0a\u5b9e\u73b0\u4e86\u591a\u4e2a Virtual Channel\u3002\u5728 Packet \u8fdb\u5165\u7ed3\u70b9\u7684\u65f6\u5019\uff0cPacket \u4f1a\u88ab\u5206\u5230\u5176\u4e2d\u4e00\u4e2a Virtual Channel \u4e0a\uff0c\u90a3\u4e48\u5982\u679c\u4e00\u4e2a Packet \u5835\u585e\u4e86\uff0c\u53ea\u4f1a\u5835\u4f4f\u5b83\u6240\u5728\u7684 Virtual Channel\uff0c\u5176\u4ed6 Virtual Channel \u8fd8\u53ef\u4ee5\u7ee7\u7eed\u4f20\u8f93\u3002\u591a\u4e2a Virtual Channel \u7ade\u4e89\u540c\u4e00\u4e2a\u7269\u7406\u901a\u9053\uff0c\u91c7\u7528\u8f6e\u8be2\u7684\u65b9\u5f0f\u4ef2\u88c1\u3002</p> <p>Virtual Channel \u52a0\u4e0a Wormhole Routing \u662f\u5e7f\u6cdb\u4f7f\u7528\u7684\u6d41\u63a7\u7b97\u6cd5\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u6d41\u63a7\u7b97\u6cd5\u7684\u603b\u7ed3\uff1a</p> \u94fe\u8def \u7f13\u5b58 \u8bc4\u4ef7 \u7535\u8def\u4ea4\u6362 Message N/A (\u65e0\u7f13\u5b58) \u9700\u8981\u5efa\u7acb\u548c\u786e\u8ba4 \u5b58\u50a8\u8f6c\u53d1 Packet Packet \u6536\u5230\u5b8c\u6574 Packet \u624d\u53ef\u4ee5\u53d1\u9001 \u865a\u62df\u76f4\u901a Packet Packet \u5934 Flit \u53ef\u4ee5\u53d1\u9001 \u866b\u5b54\u6d41\u63a7 Packet Flit Head of Line Blocking \u865a\u62df\u901a\u9053 Flit Flit \u4e0d\u540c\u6570\u636e\u5305\u7684\u6570\u636e\u7247\u4ea4\u9519 <p>\u6765\u6e90\uff1a\u300a\u9ad8\u7b49\u8ba1\u7b97\u673a\u7cfb\u7edf\u7ed3\u6784\u300b\u8bfe\u4ef6</p>"},{"location":"hardware/on_chip_networks/#_6","title":"\u65e0\u6b7b\u9501\u6d41\u63a7","text":"<p>\u6b64\u5916\uff0cVirtual Channel \u8fd8\u53ef\u4ee5\u7528\u6765\u89e3\u51b3\u6b7b\u9501\u7684\u95ee\u9898\uff0c\u6b64\u65f6\u8def\u7531\u7b97\u6cd5\u5c31\u4e0d\u7528\u8003\u8651\u6b7b\u9501\u7684\u95ee\u9898\uff0c\u800c\u662f\u7531 Virtual Channel \u6765\u89e3\u51b3\u3002</p> <p>\u56de\u5fc6\u6b7b\u9501\u7684\u573a\u666f\uff0c\u6b7b\u9501\u662f\u56e0\u4e3a\u51fa\u73b0\u4e86\u5faa\u73af\u4f9d\u8d56\uff0c\u5bfc\u81f4\u6240\u6709\u7ed3\u70b9\u7f13\u51b2\u533a\u90fd\u6ee1\u4e86\uff0c\u6240\u6709\u7ed3\u70b9\u90fd\u65e0\u6cd5\u4f20\u8f93\u6570\u636e\u3002\u4e3a\u4e86\u523b\u753b\u51fa\u4f9d\u8d56\u60c5\u51b5\uff0c\u53ef\u4ee5\u7ed8\u5236\u51fa Channel Dependency Graph\uff1a\u5982\u679c A \u5230 B \u7684\u4f20\u8f93 Channel \u4f9d\u8d56\u4e8e B \u5230 C \u7684\u4f20\u8f93 Channel\uff0c\u5c31\u4ece (A, B) \u753b\u4e00\u6761\u8fb9\u5230 (B, C)\u3002\u6ce8\u610f\uff0c\u539f\u6765\u7247\u4e0a\u7f51\u7edc\u62d3\u6251\u91cc\u7684\u8fb9\uff0c\u5728 Channel Dependency Graph \u91cc\u53d8\u6210\u4e86\u70b9\u3002</p> <p>\u5f15\u5165 Virtual Channel \u4ee5\u540e\uff0c\u7531\u4e8e\u6bcf\u4e2a Virtual Channel \u6709\u81ea\u5df1\u7684\u7f13\u51b2\u533a\uff0c\u56e0\u6b64\u4ece A \u5230 B \u7684\u94fe\u8def\u4e0a\uff0c\u76f8\u5f53\u4e8e\u6709\u4e86\u591a\u4e2a\u4f20\u8f93 Channel\uff0c\u6bcf\u4e2a Virtual Channel \u5c31\u662f\u4e00\u4e2a\u4f20\u8f93 Channel\u3002\u867d\u7136\u7269\u7406\u4e0a\u8fd8\u662f\u53ea\u6709\u4e00\u4e2a Channel\uff0c\u4f46\u662f\u4e00\u4e2a Virtual Channel \u5728\u963b\u585e\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6 Virtual Channel \u7684\u5de5\u4f5c\u3002</p> <p>\u6b64\u65f6\uff0c\u7531\u4e8e\u4e24\u4e2a\u7ed3\u70b9\u95f4\u4e0d\u6b62\u4e00\u4e2a Channel\uff0c\u5373\u4f7f\u4eba\u4e3a\u5730\u7981\u7528\u4e00\u4e2a Channel\uff0c\u4e5f\u53ef\u4ee5\u6b63\u5e38\u4f20\u8f93\uff0c\u5e76\u4e14\u4e5f\u6253\u7834\u4e86\u73af\u3002\u4ee5\u4e0b\u56fe\u4e3a\u4f8b\uff1a\u4e0b\u56fe (a) \u5de6\u4fa7\u4e2d n_1 \u5230 n_4 \u662f\u7ec4\u6210\u73af\u7684\u56db\u4e2a\u7ed3\u70b9\uff0c\u56db\u4e2a Channel \u4e92\u76f8\u4f9d\u8d56\uff0c\u56e0\u6b64 Channel Dependency Graph \u51fa\u73b0\u4e86\u73af\uff08\u4e0b\u56fe (a) \u53f3\u4fa7\uff09\uff1b\u5f15\u5165\u4e86 Virtual Channel \u4ee5\u540e\uff0c\u76f8\u90bb\u7ed3\u70b9\u95f4\u5c31\u6709\u4e86\u4e24\u4e2a Channel\uff0c\u6b64\u65f6\u7981\u7528 c_{00} \u901a\u9053\uff0c\u5e76\u4e14\u7ea6\u5b9a Channel \u7684\u4f18\u5148\u7ea7\uff0c\u90a3\u4e48 Channel Dependency Graph \u5c31\u4e0d\u518d\u6210\u73af\uff08\u4e0b\u56fe (b) \u53f3\u4fa7\uff09\uff0c\u5e76\u4e14\u7531\u4e8e\u6570\u636e\u4e0d\u4f1a\u7ed5\u7740\u73af\u8f6c\u4e24\u5708\uff0c\u4e0d\u5f71\u54cd\u53ef\u8fbe\u6027\u3002</p>    ![Virtual Channel-Based Deadlock-Free Flow Control](on_chip_networks_deadlock_virtual.png){ width=\"500\" }   \u4f7f\u7528 Virtual Channel \u89e3\u51b3\u6b7b\u9501\u95ee\u9898\uff08\u56fe\u6e90 Deadlock-Free Message Routing in Multiprocessor Interconnection Networks\uff09 <p>\u53e6\u4e00\u79cd\u601d\u8def\u662f\u628a Virtual Channel \u5206\u6210\u4e24\u7c7b\uff0c\u7b2c\u4e00\u7c7b\u90fd\u91c7\u7528 X-Y \u8def\u7531\uff0c\u7b2c\u4e8c\u7c7b\u90fd\u91c7\u7528 Y-X \u8def\u7531\uff0c\u8fd9\u6837\u4e5f\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ec4\u5408\u591a\u79cd\u65e0\u6b7b\u9501\u7684\u8def\u7531\u7b97\u6cd5\u3002</p> <p>\u4e00\u4e2a\u91cd\u8981\u7684\u5b9e\u73b0\u65b9\u6cd5\u662f Escape Virtual Channel\u3002\u5177\u4f53\u5730\uff0c\u5728\u591a\u4e2a Virtual Channel \u7684\u573a\u666f\u4e0b\uff0c\u8bbe\u7f6e\u5176\u4e2d\u4e00\u4e2a Virtual Channel\uff0c\u4f8b\u5982 VC0 \u4e3a Escape Virtual Channel\u3002\u53ea\u6709 VC0 \u5fc5\u987b\u91c7\u7528\u65e0\u6b7b\u9501\u7684\u8def\u7531\u7b97\u6cd5\uff0c\u4f8b\u5982 X-Y \u8def\u7531\uff0c\u5176\u4ed6 Virtual Channel \u53ef\u4ee5\u7528\u53ef\u80fd\u6b7b\u9501\u7684\u8def\u7531\u7b97\u6cd5\u3002</p>"},{"location":"hardware/on_chip_networks/#_7","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>On-Chip Networks, Second Edition</li> </ul>"},{"location":"hardware/ooo_cpu/","title":"\u4e71\u5e8f\u6267\u884c CPU","text":""},{"location":"hardware/ooo_cpu/#tomasulo","title":"\u7ecf\u5178 Tomasulo","text":"<p>\u53c2\u8003\u6559\u6750\uff1aBerkeley CS252\u3002</p> <p>\u7ecf\u5178 Tomasulo\uff0c\u4e5f\u662f Wikipedia \u4e0a\u63cf\u8ff0\u7684 Tomasulo \u7b97\u6cd5\uff0c\u5b83\u7684\u6838\u5fc3\u662f\u4fdd\u7559\u7ad9\u3002\u6307\u4ee4\u5728 Decode \u4e4b\u540e\uff0c\u4f1a\u88ab\u5206\u914d\u5230\u4e00\u4e2a\u4fdd\u7559\u7ad9\u4e2d\u3002\u4fdd\u7559\u7ad9\u6709\u4ee5\u4e0b\u7684\u8fd9\u4e9b\u5c5e\u6027\uff1a</p> <ol> <li>Op\uff1a\u9700\u8981\u6267\u884c\u7684\u64cd\u4f5c</li> <li>Qj\uff0cQk\uff1a\u64cd\u4f5c\u6570\u4f9d\u8d56\u7684\u6307\u4ee4\u76ee\u524d\u6240\u5728\u7684\u4fdd\u7559\u7ad9 ID</li> <li>Vj\uff0cQk\uff1a\u64cd\u4f5c\u6570\u7684\u503c</li> <li>Rj\uff0cRk\uff1a\u64cd\u4f5c\u6570\u662f\u5426 ready\uff08\u6216\u8005\u7528\u7279\u6b8a\u7684 Qj\uff0cQk \u503c\u8868\u793a\u662f\u5426 ready\uff09</li> <li>Busy\uff1a\u8fd9\u4e2a\u4fdd\u7559\u7ad9\u88ab\u5360\u7528</li> </ol> <p>\u6b64\u5916\u8fd8\u6709\u4e00\u4e2a mapping\uff08Wikipedia \u4e0a\u53eb\u505a RegisterStat\uff09\uff0c\u8bb0\u5f55\u4e86\u5bc4\u5b58\u5668\u662f\u5426\u4f1a\u88ab\u67d0\u4e2a\u4fdd\u7559\u7ad9\u4e2d\u7684\u6307\u4ee4\u5199\u5165\u3002</p> <p>\u6307\u4ee4\u5206\u914d\u5230\u4fdd\u7559\u7ad9\u7684\u65f6\u5019\uff0c\u4f1a\u67e5\u8be2 RegisterStat\uff0c\u5f97\u77e5\u64cd\u4f5c\u6570\u5bc4\u5b58\u5668\u662f\u5426 ready\uff0c\u5982\u679c\u4e0d ready\uff0c\u8bf4\u660e\u6709\u4e00\u4e2a\u5148\u524d\u7684\u6307\u4ee4\u8981\u5199\u5165\u8fd9\u4e2a\u5bc4\u5b58\u5668\uff0c\u90a3\u5c31\u8bb0\u5f55\u4e0b\u5bf9\u5e94\u7684\u4fdd\u7559\u7ad9 ID\u3002\u5f53\u64cd\u4f5c\u6570\u90fd ready \u4e86\uff0c\u5c31\u53ef\u4ee5\u8fdb\u5165\u8ba1\u7b97\u5355\u5143\u8ba1\u7b97\u3002\u5f53\u4e00\u6761\u6307\u4ee4\u5728\u6267\u884c\u5355\u5143\u4e2d\u5b8c\u6210\u7684\u65f6\u5019\uff0c\u672a\u51fa\u73b0 WAW \u65f6\u4f1a\u628a\u7ed3\u679c\u5199\u5165\u5bc4\u5b58\u5668\u5806\uff0c\u5e76\u4e14\u901a\u8fc7 Common Data Bus \u8fdb\u884c\u5e7f\u64ad\uff0c\u76ee\u524d\u5728\u4fdd\u7559\u7ad9\u4e2d\u7684\u6307\u4ee4\u5982\u679c\u53d1\u73b0\uff0c\u5b83\u6240\u9700\u8981\u7684\u64cd\u4f5c\u6570\u521a\u597d\u8ba1\u7b97\u51fa\u6765\u4e86\uff0c\u5c31\u4f1a\u628a\u53d6\u503c\u4fdd\u5b58\u4e0b\u6765\u3002</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e9b\u7ec6\u8282\uff1a\u56e0\u4e3a\u4fdd\u7559\u7ad9\u4e2d\u7684\u6307\u4ee4\u53ef\u80fd\u8981\u7b49\u5f85\u5176\u4ed6\u6307\u4ee4\u7684\u5b8c\u6210\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u8ba1\u7b97\u5355\u5143\u5229\u7528\u7387\u66f4\u9ad8\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a\u8ba1\u7b97\u7c7b\u578b\uff08\u6bd4\u5982 ALU\uff09\uff0c\u9700\u8981\u6709\u82e5\u5e72\u4e2a\u540c\u7c7b\u7684\u4fdd\u7559\u7ad9\uff08\u6bd4\u5982 Add1\uff0cAdd2\uff0cAdd3\uff09\u3002\u5728 Wikipedia \u7684\u8868\u8ff0\u4e2d\uff0c\u6bcf\u4e2a\u4fdd\u7559\u7ad9\u5bf9\u5e94\u4e86\u4e00\u4e2a\u8ba1\u7b97\u5355\u5143\uff0c\u8fd9\u6837\u6027\u80fd\u6bd4\u8f83\u597d\uff0c\u4f46\u81ea\u7136\u9762\u79ef\u4e5f\u5c31\u66f4\u5927\u3002\u5982\u679c\u8282\u7701\u9762\u79ef\uff0c\u4e5f\u53ef\u4ee5\u51cf\u5c11\u8ba1\u7b97\u5355\u5143\u7684\u6570\u91cf\uff0c\u7136\u540e\u6bcf\u4e2a\u8ba1\u7b97\u5355\u5143\u4ece\u591a\u4e2a\u4fdd\u7559\u7ad9\u4e2d\u83b7\u53d6\u8ba1\u7b97\u7684\u6307\u4ee4\u3002</p> <p>\u53ef\u4ee5\u601d\u8003\u4e00\u4e0b\uff0c\u8fd9\u79cd\u65b9\u6cd5\u7684\u74f6\u9888\u5728\u4ec0\u4e48\u5730\u65b9\u3002\u9996\u5148\uff0c\u6bcf\u6761\u6307\u4ee4\u90fd\u653e\u5728\u4e00\u4e2a\u4fdd\u7559\u7ad9\u4e2d\uff0c\u5f53\u4fdd\u7559\u7ad9\u6ee1\u7684\u65f6\u5019\u5c31\u4e0d\u80fd\u53d1\u5c04\u65b0\u7684\u6307\u4ee4\u3002\u5176\u6b21\uff0c\u5982\u679c\u8ba1\u7b97\u5355\u5143\u7684\u541e\u5410\u8ddf\u4e0d\u4e0a\u4fdd\u7559\u7ad9\u7684\u586b\u5145\u901f\u5ea6\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u963b\u585e\u3002</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u7684\u4e00\u4e2a\u6bd4\u8f83\u9ebb\u70e6\u7684\u70b9\u5728\u4e8e\u96be\u4ee5\u5b9e\u73b0\u7cbe\u786e\u5f02\u5e38\u3002\u7cbe\u786e\u5f02\u5e38\u7684\u5173\u952e\u5728\u4e8e\uff0c\u5f02\u5e38\u4e4b\u524d\u7684\u6307\u4ee4\u90fd\u751f\u6548\uff0c\u5f02\u5e38\u548c\u5f02\u5e38\u4e4b\u540e\u7684\u6307\u4ee4\u4e0d\u751f\u6548\uff0c\u4f46\u8fd9\u79cd\u65b9\u6cd5\u65e0\u6cd5\u8fdb\u884c\u533a\u5206\u3002</p> <p>\u4ece\u5bc4\u5b58\u5668\u91cd\u547d\u540d\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u79cd\u65b9\u6cd5\u5c5e\u4e8e Implicit Register Renaming\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u628a Register \u91cd\u547d\u540d\u4e3a\u4fdd\u7559\u7ad9\u7684 ID\u3002</p> <p>\u518d\u5206\u6790\u4e00\u4e0b\u5bc4\u5b58\u5668\u5806\u9700\u8981\u54ea\u4e9b\u8bfb\u5199\u53e3\u3002\u6709\u4e00\u6761\u89c4\u5f8b\u662f\uff0c\u5bc4\u5b58\u5668\u5806\u7684\u9762\u79ef\u4e0e\u8bfb\u5199\u53e3\u4e2a\u6570\u7684\u5e73\u65b9\u6210\u6b63\u6bd4\u3002\u5bf9\u4e8e\u6bcf\u6761\u53d1\u5c04\u7684\u6307\u4ee4\uff0c\u90fd\u9700\u8981\u4ece\u5bc4\u5b58\u5668\u5806\u8bfb\u64cd\u4f5c\u6570\uff0c\u6240\u4ee5\u8bfb\u53e3\u662f\u64cd\u4f5c\u6570 x \u6307\u4ee4\u53d1\u5c04\u6570\u3002\u5f53\u6267\u884c\u5355\u5143\u5b8c\u6210\u8ba1\u7b97\u7684\u65f6\u5019\uff0c\u9700\u8981\u5199\u5165\u5bc4\u5b58\u5668\u5806\uff0c\u6240\u4ee5\u6bcf\u4e2a\u6267\u884c\u5355\u5143\u90fd\u5bf9\u5e94\u4e00\u4e2a\u5bc4\u5b58\u5668\u5806\u7684\u5199\u53e3\u3002</p> <p>\u786c\u4ef6\u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u4e3a\u4e86\u6027\u80fd\uff0c\u5e0c\u671b\u4fdd\u7559\u7ad9\u53ef\u4ee5\u505a\u7684\u6bd4\u8f83\u591a\uff0c\u8fd9\u6837\u53ef\u4ee5\u5bb9\u7eb3\u66f4\u591a\u7684\u6307\u4ee4\u3002\u4f46\u662f\uff0c\u4fdd\u7559\u7ad9\u91cc\u9762\u81f3\u5c11\u8981\u4fdd\u5b58\u64cd\u4f5c\u6570\u7684\u503c\uff0c\u4f1a\u6bd4\u8f83\u5360\u7528\u9762\u79ef\uff0c\u5e76\u4e14\u65f6\u5ef6\u4e5f\u6bd4\u8f83\u5927\u3002</p>"},{"location":"hardware/ooo_cpu/#rob-reorder-buffer","title":"ROB (ReOrder Buffer)","text":"<p>\u53c2\u8003\u6559\u6750\uff1aStanford CS349G</p> <p>\u4e3a\u4e86\u5b9e\u73b0\u7cbe\u786e\u5f02\u5e38\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165 ROB\u3002\u5728\u4e0a\u9762\u7684 Tomasulo \u7b97\u6cd5\u4e2d\uff0c\u8ba1\u7b97\u5355\u5143\u8ba1\u7b97\u5b8c\u6210\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u628a\u7ed3\u679c\u5199\u5165\u5230\u5bc4\u5b58\u5668\u5806\u4e2d\uff0c\u56e0\u6b64\u7cbe\u786e\u5f02\u5e38\u65f6\u96be\u4ee5\u5f97\u5230\u6b63\u786e\u7684\u5bc4\u5b58\u5668\u5806\u53d6\u503c\u3002\u65e2\u7136\u6211\u4eec\u5e0c\u671b\u5bc4\u5b58\u5668\u5806\u7684\u72b6\u6001\u4e0e\u987a\u5e8f\u6267\u884c\u7684\u7ed3\u679c\u4e00\u81f4\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165 ROB\u3002</p> <p>ROB \u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u5faa\u73af\u961f\u5217\uff0c\u961f\u5217\u5934\u5c3e\u6307\u9488\u4e4b\u95f4\u5c31\u662f\u6b63\u5728\u6267\u884c\u7684\u6307\u4ee4\uff0c\u6bcf\u4e2a ROB \u8868\u9879\u8bb0\u5f55\u4e86\u6307\u4ee4\u7684\u72b6\u6001\u3001\u76ee\u7684\u5bc4\u5b58\u5668\u548c\u76ee\u7684\u5bc4\u5b58\u5668\u5c06\u8981\u5199\u5165\u7684\u503c\u3002ROB \u4f1a\u68c0\u67e5\u961f\u5217\u5934\u7684\u6307\u4ee4\uff0c\u5982\u679c\u5df2\u7ecf\u6267\u884c\u5b8c\u6210\uff0c\u5e76\u4e14\u6ca1\u6709\u5f02\u5e38\uff0c\u5c31\u53ef\u4ee5\u8ba9\u7ed3\u679c\u751f\u6548\uff0c\u5e76\u628a\u6307\u4ee4\u4ece\u961f\u5217\u5934\u4e2d\u5220\u53bb\uff0c\u7ee7\u7eed\u68c0\u67e5\u540e\u9762\u7684\u3002Decode \u51fa\u6765\u7684\u6307\u4ee4\u5219\u4f1a\u63d2\u5165\u5230 ROB \u7684\u5c3e\u90e8\uff0c\u5e76\u4e14\u968f\u7740\u6307\u4ee4\u7684\u6267\u884c\u8fc7\u7a0b\u66f4\u65b0\u72b6\u6001\u3002\u9047\u5230\u5f02\u5e38\u7684\u6307\u4ee4\uff0c\u5c31\u628a\u961f\u5217\u4e2d\u7684\u6307\u4ee4\u3001\u4fdd\u7559\u7ad9\u548c\u6267\u884c\u5355\u5143\u6e05\u7a7a\uff0c\u4ece\u5f02\u5e38\u5904\u7406\u5730\u5740\u5f00\u59cb\u91cd\u65b0\u6267\u884c\u3002</p> <p>\u4e3a\u4e86\u4fdd\u8bc1\u5bc4\u5b58\u5668\u5806\u7684\u6b63\u786e\u6027\uff0c\u8fd0\u7b97\u5355\u5143\u7684\u8fd0\u7b97\u7ed3\u679c\u4f1a\u5199\u5165 ROB \u9879\u4e2d\uff0c\u5f53\u8fd9\u4e00\u9879\u5728 ROB \u961f\u5217\u5934\u90e8\u88ab\u5220\u53bb\u65f6\uff0c\u5c31\u4f1a\u5199\u5165\u5bc4\u5b58\u5668\u5806\u3002\u5728\u7ecf\u5178 Tomasulo \u4e2d\uff0c\u5bc4\u5b58\u5668\u91cd\u547d\u540d\u4e3a\u4fdd\u7559\u7ad9\u7684 ID\uff0c\u4f46\u5728\u8fd9\u79cd\u8bbe\u8ba1\u4e2d\uff0c\u5e94\u8be5\u91cd\u547d\u540d\u4e3a ROB \u7684 ID\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u5bc4\u5b58\u5668\u5230 ROB ID \u7684\u6620\u5c04\uff0c\u5f53\u6307\u4ee4\u8fdb\u5165\u4fdd\u7559\u7ad9\u7684\u65f6\u5019\uff0c\u9700\u8981\u4ece\u5bc4\u5b58\u5668\u5806\u6216\u8005 ROB \u4e2d\u53bb\u8bfb\u53d6\u64cd\u4f5c\u6570\u7684\u503c\u3002\u5728 CDB \u4e0a\u5e7f\u64ad\u7684\u4e5f\u662f ROB \u7684 ID\uff0c\u800c\u4e0d\u662f\u4fdd\u7559\u7ad9\u7684 ID\u3002</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u4e2d\uff0cROB \u7684\u5927\u5c0f\u6210\u4e3a\u4e86\u4e00\u4e2a\u65b0\u7684\u74f6\u9888\uff0c\u56e0\u4e3a\u6bcf\u6761\u5728\u6b63\u5728\u6267\u884c\u7684\u6307\u4ee4\u90fd\u9700\u8981\u5728 ROB \u4e2d\u8bb0\u5f55\u4e00\u4efd\u3002\u4e0d\u8fc7\u597d\u5904\u662f\u5b9e\u73b0\u4e86\u7cbe\u786e\u5f02\u5e38\u3002</p>"},{"location":"hardware/ooo_cpu/#explicit-register-renaming","title":"Explicit Register Renaming","text":"<p>\u4e0a\u9762\u4e24\u79cd\u8bbe\u8ba1\u90fd\u662f\u91c7\u7528\u7684 Implicit Register Renaming \u7684\u65b9\u6cd5\uff0c\u7b2c\u4e00\u79cd\u65b9\u6cd5\u91cd\u547d\u540d\u5230\u4e86\u4fdd\u7559\u7ad9\uff0c\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u91cd\u547d\u540d\u5230\u4e86 ROB\u3002\u8fd8\u6709\u4e00\u79cd\u8bbe\u8ba1\uff0c\u628a\u5bc4\u5b58\u5668\u7f16\u53f7\u6620\u5c04\u5230\u7269\u7406\u7684\u5bc4\u5b58\u5668\u3002\u628a ISA \u4e2d\u7684\u5bc4\u5b58\u5668\u79f0\u4e3a\u67b6\u6784\u5bc4\u5b58\u5668\uff08\u6bd4\u5982 32 \u4e2a\u901a\u7528\u5bc4\u5b58\u5668\uff09\uff0cCPU \u4e2d\u5b9e\u9645\u7684\u5bc4\u5b58\u5668\u79f0\u4e3a\u7269\u7406\u5bc4\u5b58\u5668\uff0c\u7269\u7406\u5bc4\u5b58\u5668\u4e00\u822c\u4f1a\u6bd4\u67b6\u6784\u5bc4\u5b58\u5668\u591a\u5f88\u591a\uff08\u4e00\u4e24\u767e\u4e2a\u751a\u81f3\u66f4\u591a\uff09\u3002</p> <p>Explicit Register Renaming \u548c ReOrder Buffer \u8fd9\u4e24\u4e2a\u8bbe\u8ba1\u65b9\u5411\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u5355\u72ec\u4f7f\u7528\u3002</p> <p>\u6620\u5c04\u7684\u65b9\u6cd5\u548c\u524d\u9762\u7684\u7c7b\u4f3c\uff0c\u4e5f\u662f\u7ef4\u62a4\u4e00\u4e2a mapping\uff0c\u4ece\u67b6\u6784\u5bc4\u5b58\u5668\u5230\u7269\u7406\u5bc4\u5b58\u5668\u3002\u5f53\u4e00\u6761\u6307\u4ee4 Dispatch \u7684\u65f6\u5019\uff0c\u64cd\u4f5c\u6570\u5728 mapping \u4e2d\u627e\u5230\u5b9e\u9645\u7684\u7269\u7406\u5bc4\u5b58\u5668\u7f16\u53f7\u3002\u5982\u679c\u8fd9\u6761\u6307\u4ee4\u8981\u5199\u5165\u65b0\u7684\u67b6\u6784\u5bc4\u5b58\u5668\uff0c\u5219\u4ece\u672a\u5206\u914d\u7684\u7269\u7406\u5bc4\u5b58\u5668\u4e2d\u5206\u914d\u4e00\u4e2a\u65b0\u7684\u7269\u7406\u5bc4\u5b58\u5668\uff0c\u5e76\u4e14\u66f4\u65b0 mapping\uff0c\u5373\u628a\u5199\u5165\u7684\u67b6\u6784\u5bc4\u5b58\u5668\u6620\u5c04\u5230\u65b0\u7684\u7269\u7406\u5bc4\u5b58\u5668\u4e0a\u3002\u7136\u540e\uff0c\u653e\u5230 Issue Queue \u4e2d\u3002</p> <p>Issue Queue \u53ef\u4ee5\u7406\u89e3\u4e3a\u4fdd\u7559\u7ad9\u7684\u7b80\u5316\u7248\uff0c\u5b83\u4e0d\u518d\u4fdd\u5b58\u64cd\u4f5c\u6570\u7684\u53d6\u503c\uff0c\u800c\u4ec5\u4ec5\u7ef4\u62a4\u64cd\u4f5c\u6570\u662f\u5426 ready\u3002\u540e\u9762\u89e3\u91ca\u4e3a\u4ec0\u4e48\u4e0d\u9700\u8981\u4fdd\u5b58\u64cd\u4f5c\u6570\u7684\u53d6\u503c\u3002\u5728 Issue Queue \u4e2d\u7684\u6307\u4ee4\u5728\u6240\u6709\u64cd\u4f5c\u6570\u90fd ready \u7684\u65f6\u5019\uff0c\u5219\u4f1a Issue \u5230\u4e0d\u540c\u7684\u7aef\u53e3\u4e2d\u3002\u6bcf\u4e2a\u7aef\u53e3\u5bf9\u5e94\u7740\u4e00\u4e2a\u6267\u884c\u5355\u5143\uff0c\u6bd4\u5982\u4e24\u4e2a ALU \u7aef\u53e3\u5206\u522b\u5bf9\u5e94\u4e24\u4e2a ALU \u6267\u884c\u5355\u5143\u3002\u6307\u4ee4\u9996\u5148\u901a\u8fc7\u5bc4\u5b58\u5668\u5806\uff0c\u4ee5\u7269\u7406\u5bc4\u5b58\u5668\u4e3a\u7f16\u53f7\u53bb\u8bfb\u53d6\u6570\u636e\uff0c\u7136\u540e\u8fd9\u4e2a\u503c\u76f4\u63a5\u4f20\u7ed9\u6267\u884c\u5355\u5143\uff0c\u4e0d\u4f1a\u5b58\u4e0b\u6765\u3002\u5f53\u6267\u884c\u5355\u5143\u6267\u884c\u5b8c\u6bd5\u7684\u65f6\u5019\uff0c\u7ed3\u679c\u4e5f\u662f\u5199\u5230\u7269\u7406\u5bc4\u5b58\u5668\u5806\u4e2d\uff0cROB \u4e0d\u4fdd\u5b58\u6570\u636e\u3002</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u79cd\u8bbe\u8ba1\u4e2d\uff0c\u503c\u4ec5\u4fdd\u5b58\u5728\u5bc4\u5b58\u5668\u5806\u4e2d\uff0cIssue Queue \u548c ROB \u90fd\u53ea\u4fdd\u5b58\u4e00\u4e9b\u72b6\u6001\u4f4d\uff0c\u56e0\u6b64\u5b83\u4eec\u53ef\u4ee5\u505a\u7684\u5f88\u5927\uff0c\u5178\u578b\u7684 Issue Queue \u6709\u51e0\u5341\u9879\uff0cROB \u5219\u6709\u51e0\u767e\u9879\u3002</p> <p>\u63a5\u4e0b\u6765\u8ba8\u8bba\u4e00\u4e9b\u7ec6\u8282\u3002\u9996\u5148\u662f\uff0c\u7269\u7406\u5bc4\u5b58\u5668\u4f55\u65f6\u91ca\u653e\u3002\u5f53\u4e00\u6761\u6307\u4ee4\u5199\u5165\u4e00\u4e2a\u67b6\u6784\u5bc4\u5b58\u5668\u7684\u65f6\u5019\uff0c\u5728\u4e0b\u4e00\u6b21\u8fd9\u4e2a\u67b6\u6784\u5bc4\u5b58\u5668\u88ab\u5199\u5165\u4e4b\u524d\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u503c\u90fd\u6709\u53ef\u80fd\u88ab\u8bfb\u53d6\uff0c\u56e0\u6b64\u8fd9\u4e2a\u67b6\u6784\u5bc4\u5b58\u5668\u5230\u7269\u7406\u5bc4\u5b58\u5668\u7684\u6620\u5c04\u8981\u4fdd\u7559\u3002\u5982\u679c\u6211\u4eec\u80fd\u4fdd\u8bc1\u8bfb\u53d6\u8fd9\u4e2a\u503c\u7684\u6307\u4ee4\u90fd\u5df2\u7ecf\u5b8c\u6210\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u91ca\u653e\u8fd9\u4e2a\u7269\u7406\u5bc4\u5b58\u5668\u4e86\u3002\u4e00\u4e2a\u65b9\u6cd5\u662f\uff0c\u6211\u5728\u8986\u76d6\u67b6\u6784\u5bc4\u5b58\u5668\u5230\u7269\u7406\u5bc4\u5b58\u5668\u7684\u6620\u5c04\u65f6\uff0c\u6211\u8fd8\u8981\u8bb0\u5f55\u539f\u6765\u7684\u7269\u7406\u5bc4\u5b58\u5668\uff0c\u5f53\u8be5\u6307\u4ee4\u5728 ROB \u4e2d\u63d0\u4ea4\u4e86\uff08\u4ece\u961f\u5934\u51fa\u53bb\u4e86\uff09\uff0c\u8bf4\u660e\u4e4b\u524d\u53ef\u80fd\u4f9d\u8d56\u8fd9\u4e2a\u7269\u7406\u5bc4\u5b58\u5668\u7684\u6240\u6709\u6307\u4ee4\u90fd\u5b8c\u6210\u4e86\uff0c\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u628a\u539f\u6765\u7684\u7269\u7406\u5bc4\u5b58\u5668\u653e\u5230\u672a\u6620\u5c04\u7684\u5217\u8868\u4e2d\u3002</p> <p>\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u5728\u9047\u5230\u5f02\u5e38\u7684\u65f6\u5019\uff0c\u5982\u4f55\u6062\u590d\u5728\u5f02\u5e38\u6307\u4ee4\u5904\u7684\u67b6\u6784\u5bc4\u5b58\u5668\u5230\u7269\u7406\u5bc4\u5b58\u5668\u7684\u6620\u5c04\u5462\uff1f\u4e00\u4e2a\u529e\u6cd5\u662f\uff0c\u5229\u7528\u6211\u5728 ROB \u4e2d\u8bb0\u5f55\u7684\u88ab\u8986\u76d6\u7684\u7269\u7406\u5bc4\u5b58\u5668\u7f16\u53f7\uff0c\u4ece ROB \u961f\u5c3e\u5f80\u524d\u56de\u6eda\uff0c\u5f53\u53d1\u73b0\u4e00\u6761\u6307\u4ee4\u8986\u76d6\u4e86\u4e00\u4e2a\u67b6\u6784\u5bc4\u5b58\u5668\u6620\u5c04\u7684\u65f6\u5019\uff0c\u5c31\u6062\u590d\u4e3a\u8986\u76d6\u4e4b\u524d\u7684\u503c\u3002\u8fd9\u6837\uff0c\u5f53\u56de\u6eda\u5230\u5f02\u5e38\u6307\u4ee4\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5f97\u5230\u6b63\u786e\u7684\u6620\u5c04\u3002MIPS R10K \u7684\u8bba\u6587\u4e2d\u662f\u8fd9\u4e48\u63cf\u8ff0\u7684\uff1a</p> <pre><code>The active list contains the logical-destination register number and its\nold physical-register number for each instruction. An instruction's\ngraduation commits its new mapping, so the old physical register can\nreturn to the free list for reuse. When an exception occurs, however,\nsubsequent instructions never graduate. Instead, the processor restores\nold mappings from the active list. The R1OOOO unmaps four instructions\nper cycle--in reverse order, in case it renamed the same logical\nregister twice. Although this is slower than restoring a branch,\nexceptions are much rarer than mispredicted branches. The processor\nreturns new physical registers to the free lists by restoring their read\npointers.\n</code></pre> <p>\u53e6\u4e00\u79cd\u529e\u6cd5\u662f\u8bb0\u5f55\u4e00\u4e2a Committed Map Table\uff0c\u4e5f\u5c31\u662f\uff0c\u53ea\u6709\u5f53 ROB Head \u7684\u6307\u4ee4\u88ab Commit \u7684\u65f6\u5019\uff0c\u624d\u66f4\u65b0 Committed Map Table\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u662f\u987a\u5e8f\u6267\u884c\u7684\u5bc4\u5b58\u5668\u6620\u5c04\u8868\u3002\u5f53\u53d1\u751f\u5f02\u5e38\u7684\u65f6\u5019\uff0c\u628a Committed Map Table \u8986\u76d6\u5230 Register Map Table \u4e0a\u3002\u8fd9\u6837\u9700\u8981\u7684\u5468\u671f\u6bd4\u8f83\u5c11\uff0c\u4f46\u662f\u65f6\u5e8f\u53ef\u80fd\u6bd4\u8f83\u5dee\u3002\u53c2\u8003 BOOM \u6587\u6863\u3002</p>"},{"location":"hardware/ooo_cpu/#implicit-renamingrob-explicit-renaming","title":"Implicit Renaming(ROB) \u548c Explicit Renaming \u7684\u6bd4\u8f83","text":"<p>\u8fd9\u4e24\u79cd\u65b9\u6cd5\u4e3b\u8981\u533a\u522b\uff1a</p> <ol> <li>Implicit Renaming \u5728\u5206\u53d1\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u4ece\u5bc4\u5b58\u5668\u5806\u8bfb\u53d6\u6570\u636e\uff0c\u4fdd\u5b58\u5230\u4fdd\u7559\u7ad9\u4e2d\uff1b\u800c Explicit Renaming \u662f\u6307\u4ee4\u4ece Issue Queue \u5230\u6267\u884c\u5355\u5143\u65f6\u5019\u4ece\u5bc4\u5b58\u5668\u5806\u8bfb\u53d6\u6570\u636e</li> <li>Implicit Renaming \u7684\u5bc4\u5b58\u5668\u5806\u8bfb\u53d6\u53e3\u8f83\u5c11\uff0c\u53ea\u9700\u8981\u8003\u8651\u53d1\u5c04\u6570\u4e58\u4ee5\u64cd\u4f5c\u6570\u4e2a\u6570\uff0c\u4f46\u6240\u6709\u7c7b\u578b\u7684\u5bc4\u5b58\u5668\u5806\uff08\u6574\u6570\u3001\u6d6e\u70b9\uff09\u90fd\u9700\u8981\u8bfb\u53d6\uff1bExplicit Renaming \u7684\u5bc4\u5b58\u5668\u5806\u8bfb\u53d6\u53e3\u66f4\u591a\uff0c\u5bf9\u4e8e\u6bcf\u4e2a Issue Queue\uff0c\u90fd\u9700\u8981\u64cd\u4f5c\u6570\u4e2a\u6570\u4e2a\u8bfb\u53d6\u53e3\uff0c\u4f46\u597d\u5904\u662f\u53ef\u4ee5\u5c4f\u853d\u6389\u4e0d\u9700\u8981\u8bbf\u95ee\u7684\u8bfb\u53d6\u53e3\uff0c\u6bd4\u5982\u6d6e\u70b9 FMA \u6d41\u6c34\u4e0d\u9700\u8981\u8bfb\u53d6\u6574\u6570\u5bc4\u5b58\u5668\u5806\u3002\u5199\u548c\u8bfb\u662f\u7c7b\u4f3c\u7684\uff1aImplicit Renaming \u4e2d\uff0c\u5bc4\u5b58\u5668\u5806\u7684\u5199\u5165\u662f\u4ece ROB \u4e0a\u63d0\u4ea4\uff1b\u800c Explicit Renaming \u5219\u662f\u6267\u884c\u5355\u5143\u8ba1\u7b97\u5b8c\u540e\u5199\u5165\u5bc4\u5b58\u5668\u5806\u3002</li> </ol>"},{"location":"hardware/ooo_cpu/#_1","title":"\u5e38\u89c1\u4f18\u5316\u624b\u6bb5","text":"<p>\u5728\u7b2c\u4e00\u548c\u7b2c\u4e8c\u79cd\u8bbe\u8ba1\u4e2d\uff0c\u5f53\u4e00\u6761\u6307\u4ee4\u8ba1\u7b97\u5b8c\u6210\u65f6\uff0c\u7ed3\u679c\u4f1a\u76f4\u63a5\u901a\u8fc7 CDB \u8f6c\u53d1\u5230\u5176\u4ed6\u6307\u4ee4\u7684\u8f93\u5165\uff0c\u8fd9\u6837\u53ef\u4ee5\u63d0\u9ad8\u8fd0\u884c\u6548\u7387\u3002\u5728\u7b2c\u4e09\u79cd\u8bbe\u8ba1\u4e2d\uff0c\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0c\u4e5f\u53ef\u4ee5\u505a\u7c7b\u4f3c\u7684\u4e8b\u60c5\uff0c\u4f46\u56e0\u4e3a\u4e2d\u95f4\u591a\u4e86\u4e00\u7ea7\u5bc4\u5b58\u5668\u5806\u8bfb\u53d6\u7684\u6d41\u6c34\u7ebf\u7ea7\uff0c\u5904\u7406\u4f1a\u66f4\u52a0\u590d\u6742\u4e00\u70b9\u3002\u6bd4\u5982\uff0c\u6709\u4e00\u6761 ALU \u6307\u4ee4\uff0c\u53ef\u4ee5\u786e\u5b9a\u5b83\u5728\u4e00\u4e2a\u5468\u671f\u540e\u4e00\u5b9a\u4f1a\u5f97\u5230\u8ba1\u7b97\u7ed3\u679c\uff0c\u90a3\u4e48\u6211\u5c31\u53ef\u4ee5\u63d0\u524d\u628a\u4f9d\u8d56\u8fd9\u6761\u6307\u4ee4\u7684\u5176\u4ed6\u6307\u4ee4 Dispatch \u51fa\u53bb\uff0c\u7136\u540e\u5728 ALU \u4e4b\u95f4\u8fde\u63a5\u4e00\u4e2a bypass \u7f51\u7edc\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u51cf\u5c11\u4e00\u4e9b\u5468\u671f\u3002</p> <p>\u6b64\u5916\uff0c\u4e3a\u4e86\u63d0\u9ad8\u541e\u5410\u7387\uff0c\u4e00\u822c\u8ba1\u7b97\u5355\u5143\u90fd\u88ab\u8bbe\u8ba1\u4e3a\u6bcf\u4e2a\u5468\u671f\u53ef\u4ee5\u63a5\u53d7\u4e00\u6761\u6307\u4ee4\uff0c\u5728\u5185\u90e8\u5b9e\u73b0\u6d41\u6c34\u7ebf\u6267\u884c\uff0c\u6bcf\u4e2a\u5468\u671f\u5b8c\u6210\u4e00\u6761\u6307\u4ee4\u7684\u8ba1\u7b97\u3002\u5f53\u7136\u4e86\uff0c\u5f88\u591a\u65f6\u5019\u7531\u4e8e\u6570\u636e\u4f9d\u8d56\u95ee\u9898\uff0c\u53ef\u80fd\u5e76\u4e0d\u80fd\u8fbe\u5230\u6bcf\u4e2a\u5468\u671f\u6bcf\u4e2a\u8ba1\u7b97\u5355\u5143\u90fd\u6ee1\u8f7d\u7684\u60c5\u51b5\u3002</p> <p>\u6709\u4e9b\u65f6\u5019\uff0c\u4e00\u4e9b\u6307\u4ee4\u4e0d\u65b9\u4fbf\u540e\u7aef\u5b9e\u73b0\uff0c\u5c31\u4f1a\u52a0\u4e00\u5c42\u8f6c\u6362\uff0c\u4ece\u6307\u4ee4\u8f6c\u6362\u4e3a uop\uff0c\u518d\u7531\u540e\u7aef\u6267\u884c\u3002\u8fd9\u5728 x86 \u5904\u7406\u5668\u4e0a\u5f88\u666e\u904d\uff0c\u56e0\u4e3a\u6307\u4ee4\u96c6\u592a\u590d\u6742\u4e86\u3002\u50cf AArch64 \u6307\u4ee4\u96c6\uff0c\u5b83\u5728 Load/Store \u7684\u65f6\u5019\u53ef\u4ee5\u5bf9\u5730\u5740\u8fdb\u884c\u8ba1\u7b97\uff0c\u8fd9\u79cd\u65f6\u5019\u4e5f\u662f\u62c6\u5206\u4e3a\u4e24\u6761 uop \u6765\u6267\u884c\u3002\u4e00\u4e9b\u5b9e\u7528\u7684\u6307\u4ee4\u9700\u8981\u4e09\u4e2a\u64cd\u4f5c\u6570\uff0c\u6bd4\u5982 <code>D = A ? B : C</code>\uff0c\u5728 Alpha 21264 \u4e2d\uff0c\u8fd9\u6761\u6307\u4ee4\u4f1a\u8f6c\u6362\u4e3a\u4e24\u6761 uop\uff0c\u8fd9\u4e24\u6761 uop \u7684\u64cd\u4f5c\u6570\u5c31\u53ea\u6709\u4e24\u4e2a\uff0c\u4fbf\u4e8e\u540e\u7aef\u5b9e\u73b0\uff0c\u5426\u5219\u5728\u5404\u4e2a\u5730\u65b9\u90fd\u5141\u8bb8\u4e09\u4e2a\u64cd\u4f5c\u6570\u4f1a\u5bfc\u81f4\u4e00\u5b9a\u7684\u6d6a\u8d39\u3002</p>"},{"location":"hardware/ooo_cpu/#_2","title":"\u5185\u5b58\u8bbf\u95ee","text":"<p>\u5185\u5b58\u8bbf\u95ee\u662f\u4e00\u4e2a\u6bd4\u8f83\u590d\u6742\u7684\u64cd\u4f5c\uff0c\u5b83\u6d89\u53ca\u5230\u7f13\u5b58\u3001\u9875\u8868\u3001\u5185\u5b58\u5e8f\u7b49\u95ee\u9898\u3002\u5728\u4e71\u5e8f\u6267\u884c\u4e2d\uff0c\u8981\u5c3d\u91cf\u4f18\u5316\u5185\u5b58\u8bbf\u95ee\u5bf9\u5176\u4ed6\u6307\u4ee4\u7684\u5ef6\u8fdf\u7684\u5f71\u54cd\uff0c\u540c\u65f6\u4e5f\u8981\u4fdd\u8bc1\u6b63\u786e\u6027\u3002\u8fd9\u91cc\u53c2\u8003\u7684\u662f BOOM \u7684 LSU \u8bbe\u8ba1\u3002</p> <p>\u9996\u5148\u662f\u6b63\u786e\u6027\u3002\u4e00\u822c\u6765\u8bf4\u53ef\u4ee5\u8ba4\u4e3a\uff0cLoad \u662f\u6ca1\u6709\u526f\u4f5c\u7528\u7684\uff08\u5b9e\u9645\u4e0a\uff0cLoad \u4f1a\u5bfc\u81f4 Cache \u52a0\u8f7d\u6570\u636e\uff0c\u8fd9\u4e5f\u5f15\u53d1\u4e86\u4ee5 Meltdown \u4e3a\u9996\u7684\u4e00\u7cfb\u5217\u6f0f\u6d1e\uff09\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f88\u6fc0\u8fdb\u5730\u9884\u6d4b\u6267\u884c Load\u3002\u4f46\u662f\uff0cStore \u662f\u6709\u526f\u4f5c\u7528\u7684\uff0c\u5199\u51fa\u53bb\u7684\u6570\u636e\u5c31\u6ca1\u6cd5\u8fd8\u539f\u4e86\u3002\u56e0\u6b64\uff0cStore \u6307\u4ee4\u53ea\u6709\u5728 ROB Head \u88ab Commit \u7684\u65f6\u5019\uff0c\u624d\u4f1a\u5199\u5165\u5230 Cache \u4e2d\u3002</p> <p>\u5176\u6b21\u662f\u6027\u80fd\uff0c\u6211\u4eec\u5e0c\u671b Load \u6307\u4ee4\u53ef\u4ee5\u5c3d\u5feb\u5730\u5b8c\u6210\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u5f97\u540e\u7eed\u7684\u8ba1\u7b97\u6307\u4ee4\u53ef\u4ee5\u5c3d\u5feb\u5730\u5f00\u59cb\u8fdb\u884c\u3002\u5f53 Load \u6307\u4ee4\u7684\u5730\u5740\u5df2\u7ecf\u8ba1\u7b97\u597d\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u53bb\u53d6\u6570\u636e\uff0c\u8fd9\u65f6\u5019\uff0c\u9996\u5148\u8981\u53bb Store Queue \u91cc\u9762\u627e\uff0c\u5982\u679c\u6709 Store \u6307\u4ee4\u8981\u5199\u5165\u7684\u5730\u5740\u7b49\u4e8e Load \u7684\u5730\u5740\uff0c\u8bf4\u660e\u540e\u9762\u7684 Load \u4f9d\u8d56\u4e8e\u524d\u9762\u7684 Store\uff0c\u5982\u679c Store \u7684\u6570\u636e\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u628a\u6570\u636e\u8f6c\u53d1\u8fc7\u6765\uff0c\u5c31\u4e0d\u9700\u8981\u4ece Cache \u4e2d\u83b7\u53d6\uff0c\u5982\u679c\u6570\u636e\u8fd8\u6ca1\u51c6\u5907\u597d\uff0c\u5c31\u9700\u8981\u7b49\u5f85\u8fd9\u4e00\u6761 Store \u5b8c\u6210\uff1b\u5982\u679c\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684 Store \u6307\u4ee4\uff0c\u518d\u4ece\u5185\u5b58\u4e2d\u53d6\u3002\u4e0d\u8fc7\uff0c\u6709\u4e00\u79cd\u60c5\u51b5\u5c31\u662f\uff0c\u5f53 Store \u6307\u4ee4\u7684\u5730\u5740\u8fdf\u8fdf\u6ca1\u6709\u8ba1\u7b97\u51fa\u6765\uff0c\u800c\u540e\u9762\u7684 Load \u5df2\u7ecf\u63d0\u524d\u4ece Cache \u4e2d\u83b7\u53d6\u6570\u636e\u4e86\uff0c\u8fd9\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u6240\u4ee5\u5f53 Store \u8ba1\u7b97\u51fa\u5730\u5740\u7684\u65f6\u5019\uff0c\u9700\u8981\u68c0\u67e5\u540e\u9762\u7684 Load \u6307\u4ee4\u662f\u5426\u51fa\u73b0\u5730\u5740\u91cd\u5408\uff0c\u5982\u679c\u51fa\u73b0\u4e86\uff0c\u5c31\u8981\u628a\u8fd9\u6761 Load \u4ee5\u53ca\u4f9d\u8d56\u8fd9\u6761 Load \u6307\u4ee4\u7684\u5176\u4f59\u6307\u4ee4\u91cd\u65b0\u6267\u884c\u3002POWER8 \u5904\u7406\u5668\u5fae\u67b6\u6784\u8bba\u6587\u4e2d\u5bf9\u6b64\u4e5f\u6709\u7c7b\u4f3c\u7684\u8868\u8ff0\uff1a</p> <pre><code>The POWER8 IFU also implements mechanisms to mitigate performance\ndegradation associated with pipeline hazards. A Store-Hit-Load (SHL) is\nan out-of-order pipeline hazard condition, where an older store executes\nafter a younger overlapping load, thus signaling that the load received\nstale data. The POWER8 IFU has logic to detect when this condition\nexists and provide control to avoid the hazard by flushing the load\ninstruction which received stale data (and any following instructions).\nWhen a load is flushed due to detection of a SHL, the fetch address of\nthe load is saved and the load is marked on subsequent fetches allowing\nthe downstream logic to prevent the hazard. When a marked load\ninstruction is observed, the downstream logic introduces an explicit\nregister dependency for the load to ensure that it is issued after the\nstore operation.\n</code></pre>"},{"location":"hardware/ooo_cpu/#load-store-unit","title":"Load Store Unit","text":"<p>LSU \u662f\u5f88\u91cd\u8981\u7684\u4e00\u4e2a\u6267\u884c\u5355\u5143\uff0c\u8d1f\u8d23 Load/Store/Atomic \u7b49\u6307\u4ee4\u7684\u5b9e\u73b0\u3002\u6700\u7b80\u5355\u7684\u5b9e\u73b0\u65b9\u6cd5\u662f\u6309\u987a\u5e8f\u6267\u884c\uff0c\u4f46\u7531\u4e8e pipeline \u4f1a\u88ab\u6e05\u7a7a\uff0cStore/Atomic/Uncached Load \u8fd9\u7c7b\u6709\u526f\u4f5c\u7528\uff08\u5f53\u7136\u4e86\uff0c\u5982\u679c\u8003\u8651 Meltdown \u7c7b\u653b\u51fb\u7684\u8bdd\uff0cCached Load \u4e5f\u6709\u526f\u4f5c\u7528\uff0c\u8fd9\u91cc\u5c31\u5ffd\u7565\u4e86\uff09\uff0c\u9700\u8981\u7b49\u5230 commit \u7684\u65f6\u5019\u518d\u6267\u884c\u3002\u8fd9\u6837 LSU \u5f88\u5bb9\u6613\u6210\u4e3a\u74f6\u9888\uff0c\u7279\u522b\u662f\u5728\u8bbf\u5b58\u6307\u4ee4\u6bd4\u8f83\u591a\u7684\u65f6\u5019\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5f88\u91cd\u8981\u7684\u662f\u8ba9\u8bfb\u5199\u4e5f\u4e71\u5e8f\u8d77\u6765\uff0c\u5177\u4f53\u600e\u4e48\u4e71\u5e8f\uff0c\u53d7\u5230\u5b9e\u73b0\u7684\u5f71\u54cd\u548c Memory Order/Program Order \u7684\u8981\u6c42\u3002\u4ece\u6027\u80fd\u7684\u89d2\u5ea6\u4e0a\u6765\u770b\uff0c\u6211\u4eec\u80af\u5b9a\u5e0c\u671b Load \u53ef\u4ee5\u5c3d\u5feb\u6267\u884c\uff0c\u56e0\u4e3a\u53ef\u80fd\u6709\u5f88\u591a\u6307\u4ee4\u5728\u7b49\u5f85 Load \u7684\u7ed3\u679c\u3002\u90a3\u4e48\uff0c\u9700\u8981\u63d0\u524d\u6267\u884c Load\uff0c\u4f46\u662f\u600e\u4e48\u4fdd\u8bc1\u6b63\u786e\u6027\u5462\uff1f\u5728 Load \u66f4\u65e9\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u8fd8\u6709\u82e5\u5e72\u4e2a Store \u6307\u4ee4\u5c1a\u672a\u6267\u884c\uff0c\u4e00\u4e2a\u601d\u8def\u662f\u7b49\u5f85\u6240\u6709\u7684 Store \u6267\u884c\u5b8c\u6bd5\uff0c\u4f46\u662f\u8fd9\u6837\u6027\u80fd\u4e0d\u597d\uff1b\u53e6\u4e00\u4e2a\u601d\u8def\u662f\u7528\u5730\u5740\u6765\u641c\u7d22 Store \u6307\u4ee4\uff0c\u770b\u770b\u662f\u5426\u51fa\u73b0\u5bf9\u540c\u4e00\u4e2a\u5730\u5740\u7684 Store \u548c Load\uff0c\u5982\u679c\u6709\uff0c\u76f4\u63a5\u8f6c\u53d1\u6570\u636e\uff0c\u5c31\u4e0d\u9700\u8981\u4ece Cache \u83b7\u53d6\u4e86\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u76f8\u5f53\u4e8e\u505a\u4e86\u4e00\u4e2a\u5168\u76f8\u8fde\u7684 Buffer\uff0c\u9762\u79ef\u5927\uff0c\u5ef6\u8fdf\u9ad8\uff0c\u4e0d\u597d\u6269\u5c55\u7b49\u95ee\u9898\u63a5\u8e35\u800c\u81f3\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3 Store Queue \u9700\u8981\u76f8\u8fde\u641c\u7d22\u7684\u95ee\u9898\uff0cA high-bandwidth load-store unit for single-and multi-threaded processors \u7684\u89e3\u51b3\u601d\u8def\u662f\uff0c\u628a Store \u6307\u4ee4\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u7c7b\u662f\u9700\u8981\u8f6c\u53d1\u7684\uff0c\u4e00\u7c7b\u662f\u4e0d\u9700\u8981\u7684\uff0c\u90a3\u4e48\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u5c0f\u7684\u76f8\u8fde\u5b58\u50a8\u5668\uff0c\u53ea\u4fdd\u5b58\u8fd9\u4e9b\u9700\u8981\u8f6c\u53d1\u7684 Store \u6307\u4ee4\uff1b\u540c\u65f6\u8fd8\u6709\u4e00\u4e2a\u6bd4\u8f83\u5927\u7684\uff0c\u4fdd\u5b58\u6240\u6709 Store \u6307\u4ee4\u7684\u961f\u5217\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u76f8\u8fde\u641c\u7d22\uff0c\u6240\u4ee5\u53ef\u4ee5\u505a\u7684\u6bd4\u8f83\u5927\u3002</p> <p>\u4ed4\u7ec6\u60f3\u60f3\uff0c\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff1aLoad \u5728\u6267\u884c\u524d\uff0c\u66f4\u65e9\u7684 Store \u7684\u5730\u5740\u53ef\u80fd\u8fd8\u6ca1\u6709\u5c31\u7eea\uff0c\u8fd9\u65f6\u5019\u53bb\u641c\u7d22 Store Queue \u5f97\u5230\u7684\u7ed3\u679c\u53ef\u80fd\u662f\u9519\u7684\uff0c\u8fd9\u65f6\u5019\u8981\u4e48\u7b49\u5f85\u6240\u6709\u7684 Store \u5730\u5740\u90fd\u5c31\u7eea\uff0c\u8981\u4e48\u5c31\u5148\u6267\u884c\uff0c\u518d\u7528\u4e00\u4e9b\u673a\u5236\u6765\u4fee\u590d\u8fd9\u4e2a\u95ee\u9898\uff0c\u663e\u7136\u540e\u8005 IPC \u8981\u66f4\u597d\u3002</p> <p>\u4fee\u590d Load Store \u6307\u4ee4\u76f8\u5173\u6027\u95ee\u9898\uff0c\u4e00\u4e2a\u65b9\u6cd5\u662f\u5f53\u4e00\u4e2a Store \u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5730\u5740\u51b2\u7a81\u7684 Load \u6307\u4ee4\uff08\u90a3\u4e48 Load Queue \u4e5f\u8981\u505a\u6210\u76f8\u8fde\u641c\u7d22\u7684\uff09\uff0c\u662f\u5426\u8f6c\u53d1\u4e86\u9519\u8bef\u7684 Store \u6570\u636e\uff0c\u8fd9\u4e5f\u662f Boom LSU \u91c7\u7528\u7684\u65b9\u6cd5\u3002\u53e6\u4e00\u4e2a\u529e\u6cd5\u662f Commit \u7684\u65f6\u5019\uff08\u6216\u8005\u6309\u987a\u5e8f\uff09\u91cd\u65b0\u6267\u884c Load \u6307\u4ee4\uff0c\u5982\u679c Load \u7ed3\u679c\u548c\u4e4b\u524d\u4e0d\u540c\uff0c\u8981\u628a\u540e\u9762\u4f9d\u8d56\u7684\u5237\u65b0\u6389\uff0c\u8fd9\u79cd\u65b9\u5f0f\u7684\u7f3a\u70b9\u662f\u6bcf\u6761 Load \u6307\u4ee4\u90fd\u8981\u81f3\u5c11\u8bbf\u95ee\u4e24\u6b21 Cache\u3002Store Vulnerability Window (SVW): Re-Execution Filtering for Enhanced Load Optimization \u5c5e\u4e8e\u91cd\u65b0\u6267\u884c Load \u6307\u4ee4\u7684\u65b9\u6cd5\uff0c\u901a\u8fc7 Bloom filter \u6765\u51cf\u5c11\u4e00\u4e9b\u6ca1\u6709\u5fc5\u8981\u91cd\u590d\u6267\u884c\u7684 Load\u3002\u8fd8\u6709\u4e00\u79cd\u529e\u6cd5\uff0c\u5c31\u662f\u9884\u6d4b Load \u6307\u4ee4\u548c\u54ea\u4e00\u6761 Store \u6307\u4ee4\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u7136\u540e\u76f4\u63a5\u53bb\u8bbf\u95ee\u90a3\u4e00\u9879\uff0c\u5982\u679c\u4e0d\u5339\u914d\uff0c\u5c31\u8ba4\u4e3a\u6ca1\u6709\u4f9d\u8d56\u3002Scalable Store-Load Forwarding via Store Queue Index Prediction \u628a Load \u6307\u4ee4\u5206\u4e3a\u4e09\u7c7b\uff0c\u4e00\u7c7b\u662f\u4e0d\u786e\u5b9a\u4f9d\u8d56\u54ea\u6761 Store \u6307\u4ee4\uff08Difficult Loads\uff09\uff0c\u4e00\u7c7b\u662f\u57fa\u672c\u786e\u5b9a\u4f9d\u8d56\u54ea\u4e00\u6761 Store \u6307\u4ee4\uff0c\u4e00\u7c7b\u662f\u4e0d\u4f9d\u8d56 Store \u6307\u4ee4\u3002\u8fd9\u4e2a\u6709\u70b9\u50cf Cache \u91cc\u9762\u7684 Way Prediction \u673a\u5236\u3002</p> <p>\u5206\u6790\u5b8c\u4e86\u4e0a\u8ff0\u4e00\u4e9b\u4f18\u5316\u65b9\u6cd5\uff0c\u6211\u4eec\u4e5f\u6765\u770b\u4e00\u4e9b CPU \u8bbe\u8ba1\u91c7\u7528\u4e86\u54ea\u79cd\u65b9\u6848\u3002\u9996\u5148\u6765\u5206\u6790\u4e00\u4e0b IBM POWER8 \u7684 LSU\uff0c\u9996\u5148\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u8bbe\u8ba1\u4e86\u6bd4\u8f83\u591a\u9879\u76ee\u7684 virtual STAG/LTAG\uff0c\u7136\u540e\u518d\u8f6c\u6362\u6210\u6bd4\u8f83\u5c11\u9879\u76ee\u7684 physical STAG/LTAG\uff0c\u8fd9\u6837 LSQ \u53ef\u4ee5\u505a\u7684\u6bd4\u8f83\u5c0f\uff0c\u539f\u6587\uff1a</p> <pre><code>A virtual STAG/LTAG scheme is used to minimize dispatch holds due to\nrunning out of physical SRQ/LRQ entries. When a physical entry in the\nLRQ is freed up, a virtual LTAG will be converted to a real LTAG. When a\nphysical entry in the SRQ is freed up, a virtual STAG will be converted\nto a real STAG. Virtual STAG/LTAGs are not issued to the LSU until they\nare subsequently marked as being real in the UniQueue. The ISU can\nassign up to 128 virtual LTAGs and 128 virtual STAGs to each thread.\n</code></pre> <p>\u8fd9\u4e2a\u601d\u8def\u5728 2007 \u5e74\u7684\u8bba\u6587 Late-Binding: Enabling Unordered Load-Store Queues \u91cc\u4e5f\u53ef\u4ee5\u770b\u5230\uff0c\u4e5f\u8bb8 POWER8 \u53c2\u8003\u4e86\u8fd9\u7bc7\u8bba\u6587\u7684\u8bbe\u8ba1\u3002\u53ef\u4ee5\u770b\u5230\uff0cPOWER8 \u6ca1\u6709\u91c7\u7528\u90a3\u4e9b\u514d\u9664 CAM \u7684\u65b9\u6848\uff1a</p> <pre><code>The SRQ is a 40-entry, real address based CAM structure. Similar to the\nSRQ, the LRQ is a 44-entry, real address based, CAM structure. The LRQ\nkeeps track of out-of-order loads, watching for hazards. Hazards\ngenerally exist when a younger load instruction executes out-of-order\nbefore an older load or store instruction to the same address (in part\nor in whole). When such a hazard is detected, the LRQ initiates a flush\nof the younger load instruction and all its subsequent instructions from\nthe thread, without impacting the instructions from other threads. The\nload is then re-fetched from the I-cache and re-executed, ensuring\nproper load/store ordering.\n</code></pre> <p>\u800c\u662f\u5728\u4f20\u7edf\u7684\u4e24\u4e2a CAM \u8bbe\u8ba1\u7684\u57fa\u7840\u4e0a\uff0c\u505a\u4e86\u51cf\u5c11\u7269\u7406 LSQ \u9879\u76ee\u7684\u4f18\u5316\u3002\u6bd4\u8f83\u6709\u610f\u601d\u7684\u662f\uff0cPOWER7 \u548c POWER8 \u7684 L1 Cache \u90fd\u662f 8 \u8def\u7ec4\u76f8\u8fde\uff0c\u5e76\u4e14\u91c7\u7528\u4e86 set-prediction \u7684\u65b9\u5f0f\uff08\u5e94\u8be5\u662f\u901a\u5e38\u8bf4\u7684 way-prediction\uff09\u3002</p> <p>\u6b64\u5916\u8fd8\u6709\u4e00\u4e2a\u5b9e\u73b0\u4e0a\u7684\u5c0f\u7ec6\u8282\uff0c\u5c31\u662f\u5728\u5224\u65ad Load \u548c Store \u6307\u4ee4\u662f\u5426\u6709\u76f8\u5173\u6027\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u5730\u5740\u4f4d\u6570\u6bd4\u8f83\u591a\uff0c\u5b8c\u6574\u6bd4\u8f83\u7684\u5ef6\u8fdf\u6bd4\u8f83\u5927\uff0c\u53ef\u4ee5\u727a\u7272\u7cbe\u5ea6\u7684\u524d\u63d0\u4e0b\uff0c\u9009\u53d6\u5730\u5740\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u6bd4\u8f83\u3002POWER9 \u8bba\u6587 \u63d0\u5230\u4e86\u8fd9\u4e00\u70b9\uff1a</p> <pre><code>POWER8 and prior designs matched the effective address (EA) bits 48:63\nbetween the younger load and the older store queue entry. In POWER9,\nthrough a combination of outright matches for EA bits 32:63 and hashed\nEA matches for bits 0:31, false positive avoidance is greatly improved.\nThis reduces the number of flushes, which are compulsory for false\npositives.\n</code></pre> <p>\u8fd9\u91cc\u53c8\u662f\u4e00\u4e2a\u7cbe\u786e\u5ea6\u548c\u65f6\u5e8f\u4e0a\u7684\u4e00\u4e2a tradeoff\u3002</p> <p>\u5177\u4f53\u5230 Load/Store Queue \u7684\u5927\u5c0f\uff0c\u5176\u5b9e\u90fd\u4e0d\u5927\uff1a</p> <ol> <li>Zen 2 Store Queue 48</li> <li>Intel Skylake Store Buffer 56 Load Buffer 72</li> <li>POWER 8 Store Queue 40 Load Queue 44 (Virtual 128+128)</li> <li>Alpha 21264 Store Queue 32 Load Queue 32</li> </ol>"},{"location":"hardware/ooo_cpu/#vs","title":"\u7cbe\u786e\u5f02\u5e38 vs \u975e\u7cbe\u786e\u5f02\u5e38","text":"<p>\u7cbe\u786e\u5f02\u5e38\u662f\u6307\u53d1\u751f\u5f02\u5e38\u7684\u6307\u4ee4\u4e4b\u524d\u7684\u6307\u4ee4\u90fd\u5b8c\u6210\uff0c\u4e4b\u540e\u7684\u6ca1\u6709\u6267\u884c\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u73b0\u65b9\u5f0f\u662f\u5b8c\u6210\u5f02\u5e38\u6307\u4ee4\u4e4b\u524d\u7684\u6240\u6709\u6307\u4ee4\uff0c\u5e76\u64a4\u9500\u5f02\u5e38\u6307\u4ee4\u4e4b\u540e\u7684\u6307\u4ee4\u7684\u4f5c\u7528\u3002\u975e\u7cbe\u786e\u5f02\u5e38\u5219\u662f\u4e0d\u4fdd\u8bc1\u8fd9\u4e2a\u6027\u8d28\uff0c\u7f51\u4e0a\u8d44\u6599 \u8bf4\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u786c\u4ef6\u5b9e\u73b0\u66f4\u7b80\u5355\uff0c\u4f46\u662f\u8f6f\u4ef6\u4e0a\u5904\u7406\u6bd4\u8f83\u56f0\u96be\u3002</p> <p>\u4e00\u4e2a\u975e\u7cbe\u786e\u5f02\u5e38\u7684\u4f8b\u5b50\u662f Alpha\uff0c\u5728\u7ae0\u8282 4.7.6.1 \u4e2d\u63d0\u5230\uff0c\u4e00\u4e9b\u6d6e\u70b9\u8ba1\u7b97\u5f02\u5e38\u53ef\u80fd\u662f\u975e\u7cbe\u786e\u7684\uff0c\u5e76\u4e14\u8bf4\u4e86\u4e00\u53e5\uff1a<code>In general, it is not feasible to fix up the result value or to continue from the trap.</code>\u3002\u540c\u65f6\u7ed9\u51fa\u4e86\u4e00\u4e9b\u6761\u4ef6\uff0c\u53ea\u6709\u5f53\u6307\u4ee4\u5e8f\u5217\u6ee1\u8db3\u8fd9\u4e9b\u6761\u4ef6\u7684\u65f6\u5019\uff0c\u5f02\u5e38\u624d\u662f\u53ef\u4ee5\u6062\u590d\u7684\u3002\u8fd8\u6709\u4e00\u6bb5\u63cf\u8ff0\uff0c\u6458\u5f55\u5728\u8fd9\u91cc\uff1a</p> <pre><code>Alpha lets the software implementor determine the precision of\narithmetic traps.  With the Alpha architecture, arithmetic traps (such\nas overflow and underflow) are imprecise\u2014they can be delivered an\narbitrary number of instructions after the instruction that triggered\nthe trap. Also, traps from many different instructions can be reported\nat once. That makes implementations that use pipelining and multiple\nissue substantially easier to build.  However, if precise arithmetic\nexceptions are desired, trap barrier instructions can be explicitly\ninserted in the program to force traps to be delivered at specific\npoints.\n</code></pre> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u5728 Reference Manual \u4e2d\u7b2c 5.4.1 \u7ae0\u8282\uff0c\u53ef\u4ee5\u770b\u5230\u5f53\u89e6\u53d1 Arithmetic Trap \u7684\u65f6\u5019\uff0c\u4f1a\u8fdb\u5165 Kernel \u7684 entArith \u51fd\u6570\uff0c\u5e76\u63d0\u4f9b\u53c2\u6570\uff1aa0 \u8868\u793a exception summary\uff0ca1 \u8868\u793a register write mask\u3002exception summary \u53ef\u4ee5\u7528\u6765\u5224\u65ad\u53d1\u751f\u4e86\u4ec0\u4e48\u7c7b\u578b\u7684 exception\uff0c\u6bd4\u5982 integer overflow\uff0cinexact result \u7b49\u7b49\u3002\u4e00\u4e2a\u6bd4\u8f83\u7279\u522b\u7684 exception \u7c7b\u578b\u662f software completion\u3002\u7b2c\u4e8c\u4e2a\u53c2\u6570\u8868\u793a\u7684\u662f\u89e6\u53d1\u5f02\u5e38\u7684\u6307\u4ee4\uff08\u4e00\u4e2a\u6216\u591a\u4e2a\uff09\u4f1a\u5199\u5165\u54ea\u4e9b\u5bc4\u5b58\u5668\uff0864 \u4f4d\uff0c\u4f4e 32 \u4f4d\u5bf9\u5e94\u6574\u6570\u5bc4\u5b58\u5668\uff0c\u9ad8 32 \u4f4d\u5bf9\u5e94\u6d6e\u70b9\u5bc4\u5b58\u5668\uff09\uff0c\u7136\u540e\u4fdd\u5b58\u4e0b\u6765\u7684 PC \u503c\u4e3a\u6700\u540e\u4e00\u6761\u6267\u884c\u7684\u6307\u4ee4\u7684\u4e0b\u4e00\u4e2a\u5730\u5740\uff0c\u4ece\u89e6\u53d1\u5f02\u5e38\u7684\u7b2c\u4e00\u6761\u6307\u4ee4\u5230\u6700\u540e\u4e00\u6761\u6307\u4ee4\u5c31\u662f trap shadow\uff0c\u8fd9\u90e8\u5206\u6307\u4ee4\u53ef\u80fd\u6267\u884c\u4e86\u4e00\u90e8\u5206\uff0c\u6ca1\u6709\u6267\u884c\u4e00\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u6267\u884c\u7ed3\u679c\u662f\u9519\u8bef\u7684\u3002</p> <p>Linux \u5904\u7406\u4ee3\u7801\u5728 <code>arch/alpha/kernel/traps.c</code> \u7684 <code>do_entArith</code> \u51fd\u6570\u4e2d\u3002\u9996\u5148\u5224\u65ad\uff0c\u5982\u679c\u662f software completion\uff0c\u90a3\u5c31\u8981\u8fdb\u884c\u5904\u7406\uff1b\u5426\u5219\u76f4\u63a5 SIGFPE \u8ba9\u7a0b\u5e8f\u81ea\u5df1\u5904\u7406\u6216\u8005\u9000\u51fa\u3002\u5982\u679c\u662f\u7cbe\u786e\u5f02\u5e38\uff0c\u90a3\u5c31\u5bf9 PC-4 \u8fdb\u884c\u6d6e\u70b9\u6a21\u62df\uff1b\u5982\u679c\u662f\u975e\u7cbe\u786e\u5f02\u5e38\uff0c\u5c31\u4ece trap shadow \u7684\u6700\u540e\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u5f80\u524d\u641c\u7d22\uff0c\u5e76\u540c\u65f6\u8bb0\u5f55\u9047\u5230\u7684\u6307\u4ee4\u5199\u5165\u7684\u5bc4\u5b58\u5668\uff0c\u5982\u679c\u53d1\u73b0\u6307\u4ee4\u7684\u5199\u5165\u7684\u5bc4\u5b58\u5668\u5df2\u7ecf\u8986\u76d6\u4e86 register write mask\uff0c\u5c31\u8bf4\u660e\u627e\u5230\u4e86 trap shadow \u7684\u5f00\u5934\uff0c\u5219\u6a21\u62df\u8fd9\u6761\u6307\u4ee4\uff0c\u7136\u540e\u4ece\u4e0b\u4e00\u6761\u5f00\u59cb\u91cd\u65b0\u6267\u884c\u3002\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>long\nalpha_fp_emul_imprecise (struct pt_regs *regs, unsigned long write_mask)\n{\n    unsigned long trigger_pc = regs-&gt;pc - 4;\n    unsigned long insn, opcode, rc, si_code = 0;\n\n    /*\n     * Turn off the bits corresponding to registers that are the\n     * target of instructions that set bits in the exception\n     * summary register.  We have some slack doing this because a\n     * register that is the target of a trapping instruction can\n     * be written at most once in the trap shadow.\n     *\n     * Branches, jumps, TRAPBs, EXCBs and calls to PALcode all\n     * bound the trap shadow, so we need not look any further than\n     * up to the first occurrence of such an instruction.\n     */\n    while (write_mask) {\n        get_user(insn, (__u32 __user *)(trigger_pc));\n        opcode = insn &gt;&gt; 26;\n        rc = insn &amp; 0x1f;\n\n        switch (opcode) {\n              case OPC_PAL:\n              case OPC_JSR:\n              case 0x30 ... 0x3f:   /* branches */\n            goto egress;\n\n              case OPC_MISC:\n            switch (insn &amp; 0xffff) {\n                  case MISC_TRAPB:\n                  case MISC_EXCB:\n                goto egress;\n\n                  default:\n                break;\n            }\n            break;\n\n              case OPC_INTA:\n              case OPC_INTL:\n              case OPC_INTS:\n              case OPC_INTM:\n            write_mask &amp;= ~(1UL &lt;&lt; rc);\n            break;\n\n              case OPC_FLTC:\n              case OPC_FLTV:\n              case OPC_FLTI:\n              case OPC_FLTL:\n            write_mask &amp;= ~(1UL &lt;&lt; (rc + 32));\n            break;\n        }\n        if (!write_mask) {\n            /* Re-execute insns in the trap-shadow.  */\n            regs-&gt;pc = trigger_pc + 4;\n            si_code = alpha_fp_emul(trigger_pc);\n            goto egress;\n        }\n        trigger_pc -= 4;\n    }\n\negress:\n    return si_code;\n}\n</code></pre> <p>ARM \u67b6\u6784\u4e5f\u6709 imprecise asynchronous external abort\uff1a</p> <pre><code>Normally, external aborts are rare. An imprecise asynchronous external\nabort is likely to be fatal to the process that is running. An example\nof an event that might cause an external abort is an uncorrectable\nparity or ECC failure on a Level 2 Memory structure.\n\nBecause imprecise asynchronous external aborts are normally fatal to the\nprocess that caused them, ARM recommends that implementations make\nexternal aborts precise wherever possible.\n</code></pre> <p>\u4e0d\u8fc7\u8fd9\u66f4\u591a\u662f\u56e0\u4e3a\u5185\u5b58\u7684\u65e0\u6cd5\u9884\u77e5\u7684\u9519\u8bef\uff0c\u8fd9\u79cd\u65f6\u5019\u673a\u5668\u76f4\u63a5\u53ef\u4ee5\u62ff\u53bb\u7ef4\u4fee\u4e86\u3002</p> <p>\u6587\u7ae0 \u63d0\u5230\u4e86\u4e24\u4e2a precise/imprecise async/sync\u7684\u4f8b\u5b50\uff1a</p> <ol> <li>\u5916\u90e8\u4e2d\u65ad\u662f\u5f02\u6b65\u7684\uff0c\u540c\u65f6\u4e5f\u662f precise \u7684\u3002</li> <li>\u5bf9\u4e8e\u4e00\u4e2a Write-allocate \u7684\u7f13\u5b58\uff0c\u5982\u679c\u7a0b\u5e8f\u5199\u5165\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u7269\u7406\u5730\u5740\uff0c\u90a3\u4e48\u5199\u5165\u7f13\u5b58\u7684\u65f6\u5019\u4e0d\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u4f46\u5f53\u8fd9\u4e2a cache line \u88ab\u5199\u5165\u5230\u603b\u7ebf\u4e0a\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u89e6\u53d1\u5f02\u5e38\uff0c\u8fd9\u4e2a\u5f02\u5e38\u662f\u5f02\u6b65\u5e76\u4e14\u975e\u7cbe\u786e\u7684\uff0c\u56e0\u4e3a\u4e4b\u524d\u89e6\u53d1\u8fd9\u4e2a\u5f02\u5e38\u7684\u6307\u4ee4\u53ef\u80fd\u5df2\u7ecf\u5b8c\u6210\u5f88\u4e45\u4e86\u3002\u8fd9\u79cd\u65f6\u5019\u8fd9\u4e2a\u8fdb\u7a0b\u4e5f\u5927\u6982\u7387\u6ca1\u6551\u4e86\uff0c\u76f4\u63a5 SIGBUS \u9000\u51fa\u3002</li> </ol>"},{"location":"hardware/ooo_cpu/#_3","title":"\u5904\u7406\u5668\u524d\u7aef","text":"<p>\u518d\u6765\u5206\u6790\u4e00\u4e0b\u4e71\u5e8f\u6267\u884c CPU \u7684\u524d\u7aef\u90e8\u5206\u3002\u4ee5 RISC-V \u4e3a\u4f8b\uff0c\u6307\u4ee4\u957f\u5ea6\u6709 4 \u5b57\u8282\u6216\u8005 2 \u5b57\u8282\u4e24\u79cd\uff0c\u5176\u4e2d 2 \u5b57\u8282\u5c5e\u4e8e\u538b\u7f29\u6307\u4ee4\u96c6\u3002\u5982\u4f55\u6b63\u786e\u5e76\u9ad8\u6548\u5730\u8fdb\u884c\u53d6\u6307\u4ee4\u8bd1\u7801\uff1f</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u5e0c\u671b\u524d\u7aef\u80fd\u591f\u5c3d\u53ef\u80fd\u5feb\u5730\u53d6\u6307\u4ee4\uff0c\u524d\u7aef\u7684\u53d6\u6307\u80fd\u529b\u8981\u548c\u540e\u7aef\u5339\u914d\uff0c\u6bd4\u5982\u5bf9\u4e8e\u4e00\u4e2a\u56db\u53d1\u5c04\u7684 CPU\uff0c\u524d\u7aef\u5bf9\u5e94\u5730\u9700\u8981\u4e00\u4e2a\u5468\u671f\u53d6 <code>4*4=16</code> \u5b57\u8282\u7684\u6307\u4ee4\u3002\u4f46\u662f\uff0c\u8fd9 16 \u5b57\u8282\u53ef\u80fd\u662f 4 \u6761\u975e\u538b\u7f29\u6307\u4ee4\uff0c\u4e5f\u53ef\u80fd\u662f 8 \u6761\u538b\u7f29\u6307\u4ee4\uff0c\u4e5f\u53ef\u80fd\u662f\u6df7\u5408\u7684\u60c5\u51b5\u3002\u6240\u4ee5\uff0c\u8fd9\u91cc\u4f1a\u51fa\u73b0\u4e00\u4e2a\u53ef\u80fd\u51fa\u73b0\u6307\u4ee4\u6761\u6570\u4e0d\u5339\u914d\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u4e2d\u95f4\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a Fetch Buffer\uff0c\u6bd4\u5982 BOOM \u7684\u5b9e\u73b0\u4e2d\uff0cL1 ICache \u6bcf\u5468\u671f\u8bfb\u53d6 16 \u5b57\u8282\uff0c\u7136\u540e\u8fdb\u884c\u9884\u8bd1\u7801\uff0c\u51fa\u6765 8 \u6761\u6307\u4ee4\uff0c\u4fdd\u5b58\u5230 Fetch Buffer \u4e2d\u3002\u8fd9\u91cc\u9700\u8981\u8003\u8651\u4ee5\u4e0b\u51e0\u70b9\uff1a\u9996\u5148\u4ece ICache \u8bfb\u53d6\u7684\u6570\u636e\u662f\u5bf9\u9f50\u7684\uff0c\u4f46\u662f PC \u53ef\u80fd\u4e0d\u662f\uff0c\u6bd4\u5982\u4e2d\u95f4\u7684\u5730\u5740\u3002\u5176\u6b21\uff0c\u53ef\u80fd\u4e00\u4e2a 4 \u5b57\u8282\u7684\u975e\u538b\u7f29\u6307\u4ee4\u8de8\u8d8a\u4e86\u4e24\u6b21 Fetch\uff0c\u6bd4\u5982\u524d 2 \u4e2a\u5b57\u8282\u5728\u524d\u4e00\u4e2a Fetch Bundle\uff0c\u540e 2 \u4e2a\u5b57\u8282\u5728\u540e\u4e00\u4e2a Fetch Bundle\uff1b\u6b64\u5916\uff0c\u6bcf\u4e2a 2 \u5b57\u8282\u7684\u8fb9\u754c\u90fd\u9700\u8981\u5224\u65ad\u4e00\u4e0b\u662f\u538b\u7f29\u6307\u4ee4\u8fd8\u662f\u975e\u538b\u7f29\u6307\u4ee4\u3002\u4e00\u4e2a\u975e\u5e38\u7279\u6b8a\u7684\u60c5\u51b5\u5c31\u662f\uff0c\u4e00\u4e2a 4 \u5b57\u8282\u7684\u6307\u4ee4\u8de8\u8d8a\u4e86\u4e24\u4e2a\u9875\uff0c\u6240\u4ee5\u4e24\u4e2a\u9875\u90fd\u9700\u8981\u67e5\u8be2\u9875\u8868\uff1b\u5982\u679c\u6070\u597d\u5728\u7b2c\u4e8c\u4e2a\u9875\u5904\u53d1\u751f\u4e86\u9875\u7f3a\u5931\uff0c\u6b64\u65f6 epc \u662f\u6307\u4ee4\u7684\u8d77\u59cb\u5730\u5740\uff0c\u4f46 tval \u662f\u7b2c\u4e8c\u4e2a\u9875\u7684\u5730\u5740\uff0c\u8fd9\u6837\u5185\u6838\u624d\u77e5\u9053\u662f\u54ea\u4e2a\u9875\u53d1\u751f\u4e86\u7f3a\u5931\u3002</p> <p>\u5176\u6b21\uff0c\u9700\u8981\u914d\u5408\u5206\u652f\u9884\u6d4b\u3002\u5982\u679c\u9700\u8981\u4fdd\u8bc1\u5206\u652f\u9884\u6d4b\u6b63\u786e\u7684\u60c5\u51b5\u4e0b\uff0c\u80fd\u591f\u5728\u5faa\u73af\u4e2d\u8fbe\u5230\u63a5\u8fd1 100% \u7684\u6027\u80fd\uff0c\u90a3\u4e48\uff0c\u5728 Fetch \u5206\u652f\u7ed3\u5c3e\u7684\u5206\u652f\u6307\u4ee4\u7684\u540c\u65f6\uff0c\u9700\u8981\u4fdd\u8bc1\u4e0b\u4e00\u6b21 Fetch \u5df2\u7ecf\u5f97\u5230\u4e86\u5206\u652f\u9884\u6d4b\u7684\u76ee\u7684\u5730\u5740\u3002\u8fd9\u4e2a\u5c31\u662f BOOM \u91cc\u9762\u7684 L0 BTB (1-cycle redirect)\u3002\u4f46\u662f\uff0c\u4e00\u4e2a\u5468\u671f\u5185\u5b8c\u6210\u7684\u5206\u652f\u9884\u6d4b\uff0c\u5b83\u7684\u9762\u79ef\u80af\u5b9a\u4e0d\u80fd\u5927\uff0c\u5426\u5219\u65f6\u5e8f\u65e0\u6cd5\u6ee1\u8db3\uff0c\u6240\u4ee5 BOOM \u91cc\u9762\u8fd8\u8bbe\u8ba1\u4e86 2-cycle \u548c 3-cycle \u7684\u6bd4\u8f83\u9ad8\u7ea7\u7684\u5206\u652f\u9884\u6d4b\u5668\uff0c\u8fd8\u6709\u9488\u5bf9\u51fd\u6570\u8c03\u7528\u7684 RAS\uff08Return Address Stack\uff09\u3002</p> <p>\u5206\u652f\u9884\u6d4b\u4e5f\u6709\u5f88\u591a\u65b9\u6cd5\u3002\u6bd4\u8f83\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u5b9e\u73b0\u4e00\u4e2a BHT\uff0c\u6bcf\u4e2a\u9879\u662f\u4e00\u4e2a 2 \u4f4d\u7684\u9971\u548c\u8ba1\u6570\u5668\uff0c\u8d85\u8fc7\u4e00\u534a\u7684\u65f6\u5019\u589e\u52a0\uff0c\u5c11\u4e8e\u4e00\u534a\u65f6\u51cf\u5c11\u3002\u4f46\u662f\uff0c\u5982\u679c\u9047\u5230\u4e86\u8df3\u8f6c/\u4e0d\u8df3\u8f6c/\u8df3\u8f6c/\u4e0d\u8df3\u8f6c\u8fd9\u79cd\u6765\u56de\u5207\u6362\u7684\u60c5\u51b5\uff0c\u51c6\u786e\u7387\u5c31\u5f88\u4f4e\u3002\u4e00\u4e2a\u590d\u6742\u4e00\u4e9b\u7684\u8bbe\u8ba1\uff0c\u5c31\u662f\u7528 BHR\uff0c\u8bb0\u5f55\u8fd9\u4e2a\u5206\u652f\u6307\u4ee4\u6700\u8fd1\u51e0\u6b21\u7684\u5386\u53f2\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u53ef\u80fd\u7684\u5386\u53f2\uff0c\u90fd\u5bf9\u5e94\u4e00\u4e2a 2 \u4f4d\u7684\u9971\u548c\u8ba1\u6570\u5668\u3002\u8fd9\u6837\uff0c\u9047\u5230\u521a\u624d\u6240\u8bf4\u7684\u60c5\u51b5\u5c31\u4f1a\u5f88\u597d\u5730\u9884\u6d4b\u3002\u4f46\u5b9e\u8df5\u4e2d\u4f1a\u9047\u5230\u95ee\u9898\uff1a\u5982\u679c\u5728\u5199\u56de\u4e4b\u524d\uff0c\u53c8\u8fdb\u884c\u4e86\u4e00\u6b21\u9884\u6d4b\uff0c\u56e0\u4e3a\u9884\u6d4b\u662f\u5728\u53d6\u6307\u7684\u65f6\u5019\u505a\u7684\uff0c\u4f46\u662f\u66f4\u65b0 BPU \u662f\u5728\u5199\u56de\u7684\u65f6\u5019\u5b8c\u6210\u7684\uff0c\u8fd9\u65f6\u5019\u9884\u6d4b\u5c31\u662f\u57fa\u4e8e\u65e7\u7684\u72b6\u6001\u8fdb\u884c\u9884\u6d4b\uff0c\u8fd9\u65f6\u5019 BHR \u5c31\u4f1a\u51fa\u73b0\u4e0d\u51c6\u786e\u7684\u95ee\u9898\uff1b\u800c\u4e14\u5199\u56de BPU \u7684\u65f6\u5019\uff0c\u4f1a\u6309\u7167\u539f\u6765\u7684\u72b6\u6001\u8fdb\u884c\u66f4\u65b0\uff0c\u8fd9\u4e2a\u72b6\u6001\u53ef\u80fd\u4e5f\u662f\u9519\u8bef\u7684\uff0c\u5bfc\u81f4\u4e22\u5931\u4e00\u6b21\u66f4\u65b0\uff0c\u8bc6\u522b\u7684\u6a21\u5f0f\u4ece\u8df3\u8f6c/\u4e0d\u8df3\u8f6c/\u8df3\u8f6c/\u4e0d\u8df3\u8f6c\u53d8\u6210\u4e86\u8df3\u8f6c/\u8df3\u8f6c/\u8df3\u8f6c/\u4e0d\u8df3\u8f6c\uff0c\u8fd9\u6837\u53c8\u4f1a\u9884\u6d4b\u9519\u8bef\u3002\u4e00\u4e2a\u89e3\u51b3\u529e\u6cd5\u662f\uff0c\u5728\u53d6\u6307\u9636\u6bb5\uff0cBPU \u9884\u6d4b\u5b8c\u5c31\u7acb\u5373\u6309\u7167\u9884\u6d4b\u7684\u7ed3\u679c\u66f4\u65b0 BHR\uff0c\u4e4b\u540e\u5199\u56de\u9636\u6bb5\u4f1a\u6062\u590d\u5230\u5b9e\u9645\u7684 BHR \u53d6\u503c\u3002\u8bba\u6587 The effect of speculatively updating branch history on branch prediction accuracy, revisited \u548c Speculative Updates of Local and Global Branch History: A Quantitative Analysis \u8ba8\u8bba\u4e86\u8fd9\u4e2a\u5b9e\u73b0\u65b9\u5f0f\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u3002</p> <p>\u6bd4\u8f83\u5bb9\u6613\u505a\u9884\u6d4b\u66f4\u65b0\u548c\u6062\u590d\u7684\u662f\u5168\u5c40\u5206\u652f\u5386\u53f2\uff0c\u53ef\u4ee5\u7ef4\u62a4\u4e24\u4e2a GHR\uff08Global History Register\uff09\uff0c\u4e00\u4e2a\u662f\u76ee\u524d\u53d6\u6307\u4ee4\u6700\u65b0\u7684\uff0c\u4e00\u4e2a\u662f\u63d0\u4ea4\u7684\u6700\u65b0\u7684\u3002\u5728\u9884\u6d4b\u7684\u65f6\u5019\uff0c\u7528 GHR \u53bb\u627e\u5bf9\u5e94\u7684 2-bit \u72b6\u6001\uff0c\u7136\u540e\u628a\u9884\u6d4b\u7ed3\u679c\u66f4\u65b0\u5230 GHR \u4e0a\u3002\u5728\u9884\u6d4b\u5931\u8d25\u7684\u65f6\u5019\uff0c\u628a GHR \u6062\u590d\u4e3a\u63d0\u4ea4\u7684\u72b6\u6001\u3002\u5982\u679c\u8981\u652f\u6301\u4e00\u4e2a Fetch Packet \u4e2d\u6709\u591a\u4e2a\u5206\u652f\uff0c\u53ef\u4ee5\u8ba9 GHR \u5bf9\u5e94\u82e5\u5e72\u4e2a 2-bit \u72b6\u6001\uff0c\u5206\u522b\u5bf9\u5e94\u76f8\u5e94\u4f4d\u7f6e\u4e0a\u7684\u5206\u652f\u7684\u72b6\u6001\uff0c\u5f53\u7136\u8fd9\u6837\u9762\u79ef\u4e5f\u4f1a\u589e\u52a0\u5f88\u591a\u3002</p>"},{"location":"hardware/oscillator/","title":"\u632f\u8361\u5668","text":"<p>\u632f\u8361\u5668\uff08Oscillator\uff09\u5728\u7535\u8def\u4e2d\u7528\u4e8e\u751f\u6210\u65f6\u949f\u4fe1\u53f7\u3002\u632f\u8361\u5668\u6839\u636e\u539f\u7406\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u7684\u7c7b\u578b\uff1a</p> <ol> <li>Harmonic Oscillator\uff1a\u632f\u8361\u5668\u7531\u653e\u5927\u5668\u548c\u6ee4\u6ce2\u5668\u7ec4\u6210\uff0c\u8f93\u51fa\u4e00\u4e2a\u6b63\u5f26\u65f6\u949f\u4fe1\u53f7</li> <li>Relaxation Oscillator\uff1a\u8f93\u51fa\u65b9\u6ce2\u6216\u8005\u952f\u9f7f\u6ce2\u6216\u8005\u4e09\u89d2\u6ce2\u65f6\u949f\u4fe1\u53f7</li> </ol>"},{"location":"hardware/oscillator/#_2","title":"\u6676\u4f53\u632f\u8361\u5668","text":"<p>\u6676\u4f53\u632f\u8361\u5668\uff08Crystal oscillator\uff09\u7b80\u79f0\u6676\u632f\uff0c\u5e38\u89c1\u4e8e PCB\uff0c\u7528\u6765\u7ed9\u82af\u7247\u63d0\u4f9b\u5916\u90e8\u7684\u65f6\u949f\u4fe1\u53f7\u3002\u5b9e\u9645\u4e0a\uff0c\u6676\u632f\u662f\u4e2a\u88ab\u52a8\u5143\u4ef6\uff0c\u4e5f\u5c31\u662f\u5b83\u4e0d\u4f1a\u81ea\u52a8\u751f\u6210\u65f6\u949f\u4fe1\u53f7\uff0c\u8fd8\u9700\u8981\u82af\u7247\u5185\u90e8\u7684\u7535\u8def\u8fdb\u884c\u914d\u5408\u3002</p> <p>\u6bd4\u8f83\u5e38\u89c1\u7684\u4f7f\u7528\u6676\u632f\u4ea7\u751f\u65f6\u949f\u4fe1\u53f7\u7684\u7535\u8def\u662f Pierce oscillator\uff1a</p>    ![](oscillator_pierce.png){ width=\"400\" }   Pierce oscillator\uff08\u56fe\u6e90\u7ef4\u57fa\u767e\u79d1\uff09 <p>\u5176\u4e2d U_1 \u662f\u53cd\u76f8\u5668\uff08Inverter\uff09\uff0cX_1 \u662f\u6676\u632f\u3002\u6709\u65f6\u5019\u7535\u8def\u8fd8\u4f1a\u6dfb\u52a0\u4e0a\u56fe\u4e2d\u6ca1\u6709\u753b\u51fa\u7684\u989d\u5916\u7684\u7535\u963b\u6216\u7535\u5bb9\u3002</p> <p>\u5728\u5d4c\u5165\u5f0f\u8bbe\u8ba1\u4e2d\uff0c\u7ecf\u5e38\u53ef\u4ee5\u770b\u5230\u82af\u7247\u6709 XI \u548c XO \u5f15\u811a\uff0c\u8fde\u63a5\u5230 PCB \u4e0a\u7684\u6676\u632f\u4ee5\u53ca\u4e24\u4e2a\u7535\u5bb9\uff0c\u5b9e\u9645\u4e0a\u5c31\u5bf9\u5e94\u4e86\u4e0a\u56fe\u7684 X_1\u3001C_1 \u548c C_2\uff0c\u800c\u4e0a\u56fe\u4e2d\u7684 U_1 \u548c R_1 \u653e\u5728\u82af\u7247\u5185\u90e8\u3002\u56e0\u6b64\u5728\u5f88\u591a\u82af\u7247\u7684\u6587\u6863\u4e2d\uff0c\u90fd\u53ef\u4ee5\u770b\u5230\u7c7b\u4f3c\u4e0b\u9762\u7684\u793a\u610f\u56fe\uff1a</p>    ![](oscillator_ksz9031.png){ width=\"400\" }   \u6676\u632f\u4e0e\u82af\u7247\u7684\u8fde\u63a5\uff08\u56fe\u6e90KSZ9031RNX Datasheet\uff09 <p>\u8fd9\u91cc\u7684\u6676\u632f\uff08X_1\uff09\u662f\u65e0\u6e90\u6676\u632f\uff0c\u5b83\u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u4e2a\u54c1\u8d28\u56e0\u6570\uff08Q factor\uff09\u5f88\u9ad8\u7684\u6ee4\u6ce2\u5668\uff0c\u9700\u8981\u501f\u52a9\u82af\u7247\u5185\u7684\u632f\u8361\u7535\u8def\u624d\u53ef\u4ee5\u4ea7\u751f\u65f6\u949f\u4fe1\u53f7\uff0c\u65e0\u6cd5\u72ec\u7acb\u5de5\u4f5c\uff0c\u6240\u4ee5\u79f0\u4f5c\u65e0\u6e90\u6676\u632f\u3002\u5982\u679c\u628a Pierce oscillator \u7535\u8def\u548c\u6676\u632f\u7ec4\u5408\u5728\u4e00\u4e2a\u82af\u7247\u91cc\uff0c\u5c31\u5f97\u5230\u4e86\u6709\u6e90\u6676\u632f\u3002\u5f88\u591a\u82af\u7247\u65e2\u652f\u6301\u65e0\u6e90\u6676\u632f\uff08\u63a5 XI \u548c XO\uff09\uff0c\u53c8\u652f\u6301\u6709\u6e90\u6676\u632f\uff08\u53ea\u63a5 XI\uff0c\u4e0d\u63a5 XO\uff09\u3002</p> <p>Pierce oscillator \u8f93\u51fa\u7684\u662f\u6b63\u5f26\u6ce2\uff0c\u5982\u679c\u60f3\u8981\u53d8\u6210\u65b9\u6ce2\u4f9b\u6570\u5b57\u7535\u8def\u4f7f\u7528\uff0c\u8fd8\u9700\u8981\u518d\u7ecf\u8fc7\u4e00\u4e2a\u53cd\u76f8\u5668\u3002</p> <p>\u5e38\u89c1\u7684\u6676\u632f\u6750\u6599\u6709\u77f3\u82f1\uff08Quartz\uff09\u548c\u9676\u74f7\uff08Ceramics\uff09\uff0c\u4e00\u822c\u77f3\u82f1\u7cbe\u5ea6\u66f4\u9ad8\u3002</p> <p>XTAL \u662f Crystal \u7684\u7f29\u5199\uff0cXO \u662f Crystal Oscillator \u7684\u7f29\u5199\u3002\u7531\u4e8e XO \u6bd4 XTAL \u591a\u4e86\u4e00\u4e2a\u632f\u8361\u5668\uff0c\u6240\u4ee5\u4e00\u822c XTAL \u6307\u7684\u662f\u65e0\u6e90\u6676\u632f\uff0c\u4e5f\u5c31\u662f\u6676\u4f53\u672c\u8eab\uff0cXO \u6307\u7684\u662f\u6709\u6e90\u6676\u632f\u3002</p>"},{"location":"hardware/oscillator/#voltage-controlled-oscillator","title":"Voltage Controlled Oscillator","text":"<p>Voltage Controlled Oscillator \u662f\u538b\u63a7\u632f\u8361\u5668\uff0c\u7f29\u5199 VCO\uff0c\u610f\u601d\u662f\u53ef\u4ee5\u7531\u7535\u538b\u63a7\u5236\u7684\u632f\u8361\u5668\uff0c\u5728\u9501\u76f8\u73af\u4e2d\u53ef\u4ee5\u770b\u5230 VCO \u7684\u8eab\u5f71\u3002</p> <p>\u4ee5 LC \u632f\u8361\u7535\u8def\u4e3a\u4f8b\uff0c\u5176\u632f\u8361\u9891\u7387\u4e0e\u7535\u611f\u548c\u7535\u5bb9\u5927\u5c0f\u6709\u5173\uff0c\u5982\u679c\u53ef\u4ee5\u63a7\u5236\u7535\u5bb9\u5927\u5c0f\uff0c\u5c31\u53ef\u4ee5\u95f4\u63a5\u5730\u63a7\u5236\u632f\u8361\u5668\u7684\u632f\u8361\u9891\u7387\u3002\u800c P-N \u7ed3\u5de5\u4f5c\u5728\u53cd\u5411\u504f\u7f6e\u72b6\u6001\u7684\u65f6\u5019\uff0c\u5176\u7535\u5bb9\u5927\u5c0f\u4e0e\u4e24\u7aef\u7684\u7535\u538b\u76f8\u5173\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528 P-N \u7ed3\u548c LC \u632f\u8361\u7535\u8def\u6765\u5b9e\u73b0 VCO\u3002</p>"},{"location":"hardware/pcie/","title":"PCIe","text":""},{"location":"hardware/pcie/#_1","title":"\u5206\u5c42","text":"<p>PCIe \u5b9a\u4e49\u4e86\u4e09\u4e2a\u5c42\uff1aTransaction Layer\uff0cData Link Layer\uff0cPhysical Layer\uff0c\u548c TCP/IP \u56db\u5c42\u6a21\u578b\u5f88\u50cf\u3002PCIe \u4e5f\u662f\u57fa\u4e8e Packet \u4f20\u8f93\u7684\u3002</p>    ![](pcie_layer.png){ width=\"600\" }   PCIe \u5206\u5c42\uff08\u56fe\u6e90 PCIe 3.0 \u6807\u51c6\uff09"},{"location":"hardware/pcie/#transaction-layer","title":"Transaction Layer","text":"<p>Transaction Layer \u7684\u6838\u5fc3\u662f Transaction Layer Packet(TLP)\u3002TLP \u683c\u5f0f\uff1a</p>    ![](pcie_tlp.png){ width=\"600\" }   PCIe TLP \u683c\u5f0f\uff08\u56fe\u6e90 PCIe 3.0 \u6807\u51c6\uff09 <p>\u5373\u53ef\u9009\u7684\u82e5\u5e72\u4e2a Prefix\uff0c\u4e00\u4e2a Header\uff0c\u53ef\u9009\u7684 Data Payload\uff0c\u53ef\u9009\u7684 Digest\u3002</p> <p>Prefix \u548c Header \u5f00\u5934\u7684\u4e00\u4e2a\u5b57\u8282\u662f <code>Fmt[2:0]</code> \u548c <code>Type[4:0]</code> \u5b57\u6bb5\u3002Fmt \u51b3\u5b9a\u4e86 header \u7684\u957f\u5ea6\uff0c\u6709\u65e0\u6570\u636e\uff0c\u6216\u8005\u8fd9\u662f\u4e00\u4e2a Prefix\u3002</p> <p>\u5b83\u652f\u6301\u51e0\u7c7b Packet\uff1a</p> <ul> <li>Memory: MMIO<ul> <li>Read Request(MRd)/Completion(CplD)</li> <li>Write Request(MWr): \u6ce8\u610f\u53ea\u6709 Request\uff0c\u6ca1\u6709 Completion</li> <li>AtomicOp Request(FetchAdd/Swap/CAS)/Completion(CplD)</li> <li>Locked Memory Read(MRdLk)/Completion(CplDLk): Legacy</li> </ul> </li> <li>IO: Legacy<ul> <li>Read Request(IORd)/Completion(CplD)</li> <li>Write Request(IOWr)/Completion(Cpl)</li> </ul> </li> <li>Configuration: \u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4<ul> <li>Read Request(CfgRd0/CfgRd1)/Completion(CplD)</li> <li>Write Request(CfgWr0/CfgWr1)/Completion(Cpl)</li> </ul> </li> <li>Message: \u4f20\u8f93 event<ul> <li>Request(Msg/MsgD)</li> </ul> </li> </ul> <p>\u62ec\u53f7\u91cc\u7684\u662f TLP Type\uff0c\u5bf9\u5e94\u4e86\u5b83 Fmt \u548c Type \u5b57\u6bb5\u7684\u53d6\u503c\u3002\u5982\u679c Completion \u5931\u8d25\u4e86\uff0c\u539f\u6765\u5e94\u8be5\u662f CplD/CplDLk \u7684 Completion \u4f1a\u53d8\u6210\u4e0d\u5e26\u6570\u636e\u7684 Cpl/CplLk\u3002</p> <p>\u5728 PCIe 3.0 \u6807\u51c6\u7684\u8868 2-3 \u4e2d\u5217\u51fa\u4e86 TLP Type \u4ee5\u53ca\u5bf9\u5e94\u7684 Fmt \u548c Type \u7f16\u7801\u3002</p> <p>TLP \u8def\u7531\u6709\u4e09\u4e2a\u65b9\u6cd5\uff0c\u51b3\u5b9a\u4e86\u8fd9\u4e2a TLP \u76ee\u7684\u5730\u662f\u54ea\u91cc\uff1a</p> <ul> <li>Address-based: 32 \u4f4d\u6216 64 \u4f4d\u5730\u5740\uff0c\u7528\u4e8e Memory \u548c IO \u8bf7\u6c42</li> <li>ID-based\uff1alspci \u770b\u5230\u7684\u5730\u5740\uff0c\u4e5f\u5c31\u662f Bus Device Function\uff0c\u7528\u4e8e Configuration \u8bf7\u6c42</li> <li>Implicit\uff1a\u7528\u4e8e Message \u8bf7\u6c42\uff0c\u8def\u7531\u65b9\u6cd5\uff1a<ul> <li>Routed to Root Complex</li> <li>Routed by Address: PCIe 3.0 \u6807\u51c6\u4e2d\u6ca1\u6709\u7528\u8fd9\u4e2a\u8def\u7531\u65b9\u6cd5\u7684 Message</li> <li>Routed by ID</li> <li>Broadcast from Root Complex</li> <li>Local - Terminate at Receiver</li> <li>Gathered and router to Root Complex</li> </ul> </li> </ul>"},{"location":"hardware/pcie/#data-link-layer","title":"Data Link Layer","text":"<p>Data Link Layer \u7684\u4e3b\u8981\u529f\u80fd\u662f\u8fdb\u884c TLP \u7684\u53ef\u9760\u4f20\u8f93\u3002\u5b83\u5728\u4f20\u8f93 TLP \u7684\u65f6\u5019\uff0c\u4f1a\u5728\u5f00\u5934\u52a0\u4e0a\u4e00\u4e2a\u4e24\u5b57\u8282\u7684 Sequence Number\uff0c\u6700\u540e\u52a0\u4e0a\u4e00\u4e2a\u56db\u5b57\u8282\u7684 LCRC\uff08Link CRC\uff09\u3002</p>    ![](pcie_tlp_link.png){ width=\"600\" }   PCIe TLP Data Link Layer \u683c\u5f0f\uff08\u56fe\u6e90 PCIe 3.0 \u6807\u51c6\uff09 <p>\u9664\u4e86\u4f20\u8f93 TLP\uff0cData Link Layer \u8fd8\u4f1a\u4f20\u8f93 Data Link Layer Packet(DLLP)\uff0c\u7c7b\u578b\u5305\u62ec\uff1a</p> <ul> <li>Ack DLLP: \u544a\u8bc9\u5bf9\u65b9\u81ea\u5df1\u5df2\u7ecf\u6210\u529f\u6536\u5230\u4e86 TLP</li> <li>Nak DLLP\uff1a\u544a\u8bc9\u5bf9\u65b9\u81ea\u5df1\u63a5\u6536 TLP \u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5</li> <li>InitFC1/InitFC2/UpdateFC DLLPs\uff1a\u6d41\u91cf\u63a7\u5236</li> <li>PM_Enter_L1/PM_Enter_L23/PM_Active_State_Request_L1/PM_Request_Ack\uff1a\u7528\u4e8e\u7535\u6e90\u7ba1\u7406</li> </ul> <p>Data Link Layer \u6536\u5230\u4e0a\u5c42\u8981\u53d1\u9001 TLP \u65f6\u5019\uff0c\u9996\u5148\u62fc\u63a5 Sequence Number \u548c LCRC\uff0c\u7136\u540e\u4f1a\u4fdd\u5b58\u5728 retry buffer \u4e2d\uff0c\u901a\u8fc7 Physical Layer \u53d1\u9001\u3002\u4ece Physical Layer \u6536\u5230\u65b0\u7684 TLP/DLLP \u65f6\uff0c\u4f1a\u68c0\u67e5\u5b83\u7684\u5b8c\u6574\u6027\uff08CRC\uff09\uff0c\u5982\u679c\u6b63\u786e\uff0c\u5c31\u5411\u53d1\u9001\u65b9\u53d1\u9001\u4e00\u4e2a Ack DLLP\uff0c\u5e76\u628a TLP \u63d0\u4ea4\u7ed9 Transaction Layer\uff1b\u5982\u679c\u4e0d\u6b63\u786e\uff0c\u5c31\u5411\u53d1\u9001\u65b9\u53d1\u9001\u4e00\u4e2a Nak DLLP\u3002\u5982\u679c\u6536\u5230\u4e86 Ack DLLP\uff0c\u5c31\u53ef\u4ee5\u628a\u76f8\u5e94\u7684 TLP \u4ece retry buffer \u4e2d\u5220\u6389\uff1b\u5982\u679c\u6536\u5230\u4e86 Nak DLLP\uff0c\u5219\u8981\u91cd\u4f20\u3002\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86 TLP \u7684\u53ef\u9760\u4f20\u8f93\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cTLP \u548c DLLP \u7684\u533a\u522b\uff1aTLP \u5c31\u50cf IP\uff0c\u76ee\u7684\u5730\u5740\u53ef\u80fd\u4f1a\u8de8\u8d8a\u591a\u8df3\uff1b\u800c DLLP \u662f\u70b9\u5bf9\u70b9\u5730\u5de5\u4f5c\uff0c\u6240\u4ee5\u4e00\u4e2a TLP \u5728\u8f6c\u53d1\u7684\u6bcf\u4e00\u8df3\u4e2d\uff0c\u63a5\u53d7\u65b9\u90fd\u4f1a\u53d1\u9001\u4e00\u6b21 Ack DLLP\u3002</p> <p>Data Link Layer \u7684\u6d41\u91cf\u662f Credit-based \u7684\uff1a\u63a5\u53d7\u65b9\u4f1a\u544a\u8bc9\u53d1\u9001\u65b9\u81ea\u5df1\u7684 Buffer \u8fd8\u6709\u591a\u5c11\u7a7a\u95f4\uff08Credit\uff09\uff0c\u7136\u540e\u53d1\u9001\u65b9\u6839\u636e Credit \u6765\u63a7\u5236\u662f\u5426\u7ee7\u7eed\u53d1\u9001 TLP\u3002</p>"},{"location":"hardware/pcie/#_2","title":"\u914d\u7f6e","text":"<p>\u63a5\u89e6 PCIe \u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u7591\u60d1\uff0c\u5c31\u662f\u8fd9\u4e9b Bus Device Function \u90fd\u662f\u600e\u4e48\u5206\u914d\u7684\uff0c\u5206\u914d\u5b8c\u4e4b\u540e\uff0c\u8bbf\u95ee\u8bf7\u6c42\u53c8\u662f\u600e\u4e48\u8def\u7531\u7684\u3002</p>"},{"location":"hardware/pcie/#_3","title":"\u8def\u7531","text":"<p>\u9996\u5148\u56de\u987e\u4e00\u4e0b\uff0c\u4e0a\u9762\u63d0\u5230\u4e86 TLP \u7684 Memory \u548c IO \u662f\u6839\u636e\u5730\u5740\u8def\u7531\uff0cConfiguration \u662f\u6839\u636e Bus Device Function \u8def\u7531\uff0c\u800c PCIe \u5927\u6982\u662f\u4e00\u4e2a\u6811\u5f62\u7684\u7ed3\u6784\uff0c\u53f6\u5b50\u7ed3\u70b9\u5c31\u662f PCIe \u8bbe\u5907\uff0c\u975e\u53f6\u5b50\u7ed3\u70b9\u662f\u6865\u6216\u8005\u4ea4\u6362\u673a\u3002\u56de\u60f3\u4e00\u4e0b\uff0cIP \u7684\u8def\u7531\u662f\u6309\u7167\u6700\u957f\u524d\u7f00\u5339\u914d\uff0c\u5982\u679c\u5728 PCIe \u4e2d\u8fd8\u8fd9\u6837\u505a\u7684\u8bdd\uff0c\u53c8\u592a\u8fc7\u4e8e\u590d\u6742\u4e86\uff0c\u6bd5\u7adf PCIe \u53ef\u4ee5\u4eba\u4e3a\u5730\u8bbe\u5b9a\u6bcf\u4e2a\u8bbe\u5907\u7684\u5730\u5740\uff0c\u8ba9\u5730\u5740\u6ee1\u8db3\u4e00\u5b9a\u7684\u8fde\u7eed\u6027\u548c\u5c40\u90e8\u6027\uff0c\u8fd9\u6837\u8def\u7531\u9009\u62e9\u5c31\u975e\u5e38\u7b80\u5355\u4e86\u3002</p> <p>\u89c2\u5bdf PCIe \u6807\u51c6\u4e2d 7.3.3 Configuration Request Routing Rules\uff0c\u7ed3\u5408 MindShare \u7684\u4e66\uff0c\u770b Root Ports\uff0cSwitches \u548c Bridges \u7684\u8981\u6c42\uff0c\u5c31\u77e5\u9053 Configuration \u8bf7\u6c42\u662f\u5982\u4f55\u8def\u7531\u7684\uff1a</p> <ul> <li>Configuration \u8bf7\u6c42\u53ea\u80fd\u7531 Host Bridge \u53d1\u8d77</li> <li>\u5982\u679c Configuration \u8bf7\u6c42\u662f Type0\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u7684\u8bbe\u5907\u5c31\u662f\u5f53\u524d\u8bbe\u5907</li> <li>\u5982\u679c Configuration \u8bf7\u6c42\u662f Type1\uff0c<ul> <li>\u5982\u679c\u8bf7\u6c42\u7684 Bus Number \u7b49\u4e8e\u67d0\u4e00\u4e2a Downstream Port \u7684 Secondary Bus Number\uff0c\u5219\u628a Configuration \u8bf7\u6c42\u8f6c\u6362\u4e3a Type0\uff0c\u7136\u540e\u53d1\u7ed9\u8be5 Downstream Port</li> <li>\u5982\u679c\u4e0d\u7b49\u4e8e\uff0c\u4f46\u662f Bus Number \u5c5e\u4e8e\u67d0\u4e00\u4e2a Downstream Port \u7684 Secondary Bus Number \u548c Subordinate Bus Number \u4e4b\u95f4\uff0c\u5219\u4e0d\u4fee\u6539 Configuration \u8bf7\u6c42\uff0c\u53d1\u9001\u7ed9\u8be5 Downstream Port\u3002</li> </ul> </li> </ul> <p>\u5982\u679c\u7c7b\u6bd4\u4e00\u4e0b IP\uff0c\u90a3\u4e48\u5206\u7ec4\u5728\u4e2d\u9014\u8def\u7531\u5668\u8f6c\u53d1\u7684\u65f6\u5019\u5c31\u662f Type1\uff0cType0 \u5c31\u662f\u6700\u540e\u4e00\u8df3\u3002\u8def\u7531\u5c31\u662f\u76f4\u63a5\u6309\u7167\u51e0\u4e2a\u4e0d\u91cd\u5408\u7684 Bus Number \u533a\u95f4\u8fdb\u884c\u5224\u65ad\uff0c\u6ca1\u6709\u590d\u6742\u7684\u6700\u957f\u524d\u7f00\u5339\u914d\u3002\u4f46\u662f\u53c8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6309\u7167 Bus \u8def\u7531\uff0c\u90a3\u540c\u4e00\u4e2a Bus \u4e0b\u4e0d\u540c\u7684 Device \u548b\u529e\uff1f\u8fd9\u5c31\u50cf\u662f\u4ee5\u592a\u7f51\uff0c\u6700\u540e\u4e00\u8df3\u7684\u65f6\u5019\uff0c\u5982\u679c\u540c\u4e00\u4e2a\u94fe\u8def\u4e0a\u6709\u591a\u4e2a\u8bbe\u5907\uff0c\u90a3\u4e48\u591a\u4e2a\u8bbe\u5907\u90fd\u80fd\u6536\u5230\uff0c\u6bcf\u4e2a\u8bbe\u5907\u6839\u636e\u81ea\u5df1\u7684 Device \u53f7\u5224\u65ad\u662f\u5426\u662f\u53d1\u7ed9\u81ea\u5df1\u7684\u3002PCI\uff08\u6ce8\u610f\u4e0d\u662f PCIe\uff09\u603b\u7ebf\u4e5f\u7c7b\u4f3c\u3002\u968f\u7740\u901f\u5ea6\u8d8a\u6765\u8d8a\u9ad8\uff0c\u901a\u8fc7\u4ea4\u6362\u673a\uff0c\u4ee5\u592a\u7f51\u5df2\u7ecf\u53d8\u6210\u4e86\u70b9\u5bf9\u70b9\uff0c\u6240\u4ee5\u5f88\u5c11\u89c1\u5230\u4e00\u4e2a\u94fe\u8def\u4e0a\u540c\u65f6\u6709\u591a\u4e2a\u8bbe\u5907\u7684\u60c5\u51b5\u4e86\u3002PCIe \u4e5f\u4e00\u6837\uff0c\u6240\u4ee5\u6839\u636e Bus \u8def\u7531\u5c31\u8db3\u591f\u4e86\u3002\u81f3\u4e8e lspci \u770b\u5230\u7684\u90a3\u4e9b Device \u4e0d\u7b49\u4e8e 0 \u7684\u8bbe\u5907\uff0c\u8981\u4e48\u662f\u517c\u5bb9 PCI \u8bbe\u5907\u7684\uff0c\u8981\u4e48\u662f\u865a\u62df\u7684\uff0c\u5728\u8bbe\u5907\u5185\u90e8\u8fdb\u884c\u8def\u7531\u7684\uff0c\u5e76\u4e0d\u662f\u771f\u7684\u6709\u4e00\u4e2a PCIe link \u8fde\u4e86\u591a\u4e2a\u7269\u7406\u8bbe\u5907\u3002</p> <p>\u6240\u4ee5\u7b80\u5355\u7406\u89e3\u4e00\u4e0b\uff0cPCI \u603b\u7ebf\u786e\u5b9e\u662f\u4e00\u6761\u603b\u7ebf\uff0c\u4e00\u6761\u603b\u7ebf\u4e0a\u5f88\u591a\u8bbe\u5907\u3002\u800c PCIe \u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u7f51\u7edc\uff0c\u53ef\u4ee5\u770b\u4f5c\u662f\u5f88\u591a\u4e2a PCI \u603b\u7ebf\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u53ef\u4ee5\u628a Root Complex \u6216\u8005 Switch \u5185\u90e8\u770b\u6210\u4e00\u4e2a\u865a\u62df\u7684\u6709\u5f88\u591a\u8bbe\u5907\u7684 PCI \u603b\u7ebf\uff0c\u800c PCIe Link \u53ef\u4ee5\u770b\u6210\u662f\u53ea\u6709\u4e00\u4e2a\u8bbe\u5907\u7684 PCI \u603b\u7ebf\u3002\u8fd9\u6837 PCIe \u4ea4\u6362\u673a\u53ef\u4ee5\u770b\u6210\u82e5\u5e72\u4e2a PCI-PCI Bridge\uff1a</p>    ![](pcie_bridge.png){ width=\"600\" }   PCIe \u4ea4\u6362\u673a\u548c Root Complex \u5185\u90e8\u56fe\u89e3\uff08\u56fe\u6e90 PCIe 3.0 \u6807\u51c6\uff09 <p>\u8fd8\u6709 MindShare \u4e66\u4e2d\u7684\u56fe 3-5:</p>    ![](pcie_system.png){ width=\"600\" }   PCIe \u5b8c\u6574\u62d3\u6251\uff08\u56fe\u6e90 MineShare PCIe 3.0 \u4e66\uff09 <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u91cc\u7684\u6bcf\u4e00\u4e2a Bus \u5c31\u662f\u4e00\u4e2a PCI \u603b\u7ebf\uff0c\u65e2\u6709\u5185\u90e8\u7684\u865a\u62df PCI \u603b\u7ebf\uff08Bus 0/2/6\uff09\uff0c\u4e5f\u6709 PCIe Link \u5145\u5f53\u7684 PCI \u603b\u7ebf\uff08Bus \u2153/\u2158/\u215e/9\uff09\u3002\u5728\u865a\u62df\u7684 PCI \u603b\u7ebf\u91cc\uff0c\u6bd4\u5982 PCIe Switch\uff0c\u4e00\u4e2a Device \u5bf9\u5e94\u4e00\u4e2a Downstream Port\uff1b\u800c PCIe Link \u5bf9\u5e94\u7684 PCI \u603b\u7ebf\u4e0a\u5c31\u53ea\u6709\u4e00\u4e2a Device\u3002\u7136\u540e PCIe Switch \u7684\u6bcf\u4e2a Upstream Port \u548c Downstream Port \u91cc\u4f1a\u8bb0\u5f55\u4e09\u4e2a Bus Number\uff1aPrimary(Pri)\uff0cSecondary(Sec) \u548c Subordinate(Sub)\u3002Primary \u6307\u7684\u5c31\u662f\u5b83\u4e0a\u6e38\u76f4\u63a5\u8fde\u63a5\u7684 PCI \u603b\u7ebf\u7f16\u53f7\uff0cSec \u6307\u7684\u662f\u4e0b\u6e38\u76f4\u63a5\u8fde\u63a5\u7684 PCI \u603b\u7ebf\u7f16\u53f7\uff0cSub \u6307\u7684\u662f\u5b83\u4e0b\u6e38\u7684\u6700\u5927 PCI \u603b\u7ebf\u7f16\u53f7\u3002</p> <p>\u8fd9\u6837\uff0c\u6536\u5230 Type1 \u7684\u65f6\u5019\uff0cSwitch \u6309\u7167\u5404\u4e2a Downstream Port \u7684 Sec \u548c Sub \u8fdb\u884c\u5224\u65ad\uff0c\u5982\u679c\u76ee\u6807 Bus Number \u7b49\u4e8e Sec\uff0c\u5c31\u8f6c\u6362\u4e3a Type0 \u53d1\u51fa\u53bb\uff1b\u5982\u679c\u5927\u4e8e Sec\uff0c\u4f46\u662f\u5c0f\u4e8e\u6216\u7b49\u4e8e Sub\uff0c\u5c31\u539f\u6837\u53d1\u51fa\u53bb\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u4ece Host Bridge \u5230\u6bcf\u4e2a\u8bbe\u5907\u90fd\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u5f0f\u4e00\u8def\u8f6c\u53d1\u3002</p> <p>\u65e2\u7136 BDF \u662f\u628a Bus \u5212\u5206\u4e3a\u591a\u4e2a\u533a\u95f4\u6765\u8def\u7531\u7684\uff0c\u90a3\u4e48 Memory \u548c IO \u8bf7\u6c42\u4e5f\u7c7b\u4f3c\u5730\u53ef\u4ee5\u5bf9\u5730\u5740\u8fdb\u884c\u5212\u5206\uff0c\u53d8\u6210\u591a\u4e2a\u533a\u95f4\uff0c\u7136\u540e\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u8fdb\u884c\u8def\u7531\u3002</p> <p>\u8fd9\u4e9b\u7528\u4e8e\u8def\u7531\u7684\u533a\u95f4\u4e0a\u4e0b\u754c\uff0c\u53ef\u4ee5\u5728\u5404\u4e2a\u7aef\u53e3\u7684 Type1 Configuration Space \u4e2d\u627e\u5230\uff1a</p>    ![](pcie_type1.png){ width=\"600\" }   PCIe Type1 Configuration Space\uff08\u56fe\u6e90 PCIe 3.0 \u6807\u51c6\uff09 <ul> <li>\u8def\u7531 Type1 Configuration Request\uff1aPrimary Bus Number, Secondary Bus Number, Subordinate Bus Number<ul> <li><code>Request Bus Number == Secondary Bus Number</code>: Type1 -&gt; Type0</li> <li><code>Secondary Bus Number &lt; Request Bus Number &lt;= Subordinate Bus Number</code>: Type1 -&gt; Type1</li> </ul> </li> <li>\u8def\u7531 IO Request\uff1a<code>I/O Base &lt;= IO Address &lt;= I/O Limit</code></li> <li>\u8def\u7531 Prefetchable Memory Request\uff1a<code>Prefetchable Memory Base &lt;= Memory Address &lt;= Prefetchable Memory Limit</code></li> <li>\u8def\u7531 Non-Prefetchable Memory Request\uff1a<code>Memory Base &lt;= Memory Address &lt;= Memory Limit</code></li> </ul> <p>\u800c\u5177\u4f53\u5230\u6bcf\u4e00\u4e2a\u8bbe\u5907\u4e0a\uff0c\u8bbe\u5907\u4f1a\u63d0\u4f9b\u82e5\u5e72\u4e2a BAR\uff08Base Address Register\uff09\uff0c\u5728\u679a\u4e3e\u8bbe\u5907\u7684\u65f6\u5019\uff0c\u4f1a\u7ed9 BAR \u5206\u914d\u5730\u5740\uff0c\u7136\u540e\u628a\u8bbe\u5907\u7684\u5730\u5740\u8fdb\u884c\u5408\u5e76\uff0c\u8bb0\u5f55\u5230 Switch \u4e0a\u7684 Base \u548c Limit\uff0c\u7136\u540e\u4e00\u76f4\u9012\u5f52\uff0c\u4e00\u8def\u66f4\u65b0\u5230 Root Complex\u3002\u8fd9\u6837\uff0c\u5c31\u5b8c\u6210\u4e86\u5730\u5740\u5206\u914d\uff0c\u4ee5\u53ca\u8bf7\u6c42\u7684\u8def\u7531\u3002</p>"},{"location":"hardware/pcie/#_4","title":"\u5206\u914d","text":"<p>\u65e2\u7136\u77e5\u9053\u4e86 BDF \u662f\u5982\u4f55\u8def\u7531\u7684\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u662f\uff0c\u600e\u4e48\u679a\u4e3e\u8bbe\u5907\u548c\u4ea4\u6362\u673a\uff0c\u5206\u914d Bus Number\u3002\u8fd9\u4e2a\u4e8b\u60c5\u5728\u7cfb\u7edf\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u505a\uff08\u4f8b\u5982 UEFI\uff09\uff0cLinux \u4e2d\u4e5f\u6709\u76f8\u5173\u7684\u4ee3\u7801\u3002\u4e0b\u9762\u5c31\u6765\u5bf9\u7740 edk2 \u7684\u6e90\u4ee3\u7801\u6765\u770b\u770b\u5b83\u662f\u600e\u4e48\u505a\u7684\u3002</p> <p>\u5728 edk2 \u4e2d\uff0c\u5206\u914d Bus Number \u7684\u6838\u5fc3\u4ee3\u7801\u662f <code>PciScanBus</code> \u51fd\u6570\uff1a</p> <pre><code>/**\n  Scan pci bus and assign bus number to the given PCI bus system.\n\n  @param  Bridge           Bridge device instance.\n  @param  StartBusNumber   start point.\n  @param  SubBusNumber     Point to sub bus number.\n  @param  PaddedBusRange   Customized bus number.\n\n  @retval EFI_SUCCESS      Successfully scanned and assigned bus number.\n  @retval other            Some error occurred when scanning pci bus.\n\n  @note   Feature flag PcdPciBusHotplugDeviceSupport determine whether need support hotplug.\n\n**/\nEFI_STATUS\nPciScanBus (\n  IN PCI_IO_DEVICE  *Bridge,\n  IN UINT8          StartBusNumber,\n  OUT UINT8         *SubBusNumber,\n  OUT UINT8         *PaddedBusRange\n  );\n</code></pre> <p>\u8f93\u5165\u4e00\u4e2a\u6865\u8bbe\u5907\u548c\u521d\u59cb\u7684 Bus Number\uff0c\u8f93\u51fa Subordinate Bus Number\uff0c\u4e5f\u5c31\u662f\u5206\u914d\u7684\u6700\u5927\u7684 Bus Number\uff0c\u4ee5\u53ca Padded Bus Range\uff0c\u4f8b\u5982\u5982\u679c\u8981\u8003\u8651\u70ed\u63d2\u62d4\u7684\u8bdd\uff0c\u5c31\u9700\u8981\u9884\u7559\u4e00\u4e9b Bus Number\u3002\u5b83\u5728 <code>PciRootBridgeEnumerator</code> \u51fd\u6570\u4e2d\u88ab\u8c03\u7528\uff0c\u4f20\u5165\u7684\u662f RootBridgeDev\u3002\u4f60\u53ef\u80fd\u4e5f\u731c\u5230\u4e86\uff0c\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u9012\u5f52\u8c03\u7528\uff0c\u4ece Root Bridge \u5f00\u59cb\u5f80\u4e0b\uff0c\u9047\u5230\u65b0\u7684\u6865\u8bbe\u5907\u7684\u65f6\u5019\uff0c\u5c31\u7ee7\u7eed\u9012\u5f52\uff0c\u7136\u540e\u6839\u636e\u4e0b\u4e00\u5c42\u5206\u914d\u7684 Bus Number \u6765\u8ba1\u7b97\u4e0a\u4e00\u5c42\u7684 Subordinate Bus Number\u3002</p> <p><code>PciScanBus</code> \u9996\u5148\u679a\u4e3e\u5f53\u524d\u6865\u8bbe\u5907\u4e0b\u7684\u6240\u6709 Device \u548c Function\uff0c\u56e0\u4e3a\u5f53\u524d\u7684\u6865\u8bbe\u5907\u5df2\u7ecf\u88ab\u5206\u914d\u4e86 Bus Number\uff0c\u6240\u4ee5\u662f\u53ef\u4ee5\u8bbf\u95ee\u5b83\u4e0b\u9762\u7684 Device \u548c Function \u7684\u3002</p> <pre><code>for (Device = 0; Device &lt;= PCI_MAX_DEVICE; Device++) {\n  TempReservedBusNum = 0;\n  for (Func = 0; Func &lt;= PCI_MAX_FUNC; Func++) {\n    //\n    // Check to see whether a pci device is present\n    //\n    Status =\n        PciDevicePresent(PciRootBridgeIo, &amp;Pci, StartBusNumber, Device, Func);\n\n    if (EFI_ERROR(Status) &amp;&amp; (Func == 0)) {\n      //\n      // go to next device if there is no Function 0\n      //\n      break;\n    }\n\n    if (EFI_ERROR(Status)) {\n      continue;\n    }\n\n    //\n    // Get the PCI device information\n    //\n    Status =\n        PciSearchDevice(Bridge, &amp;Pci, StartBusNumber, Device, Func, &amp;PciDevice);\n\n    if (EFI_ERROR(Status)) {\n      continue;\n    }\n\n    PciAddress = EFI_PCI_ADDRESS(StartBusNumber, Device, Func, 0);\n\n    if (IS_PCI_BRIDGE(&amp;Pci) || IS_CARDBUS_BRIDGE(&amp;Pci)) {\n      //\n      // For PPB\n      //\n\n      Status = PciAllocateBusNumber(Bridge, *SubBusNumber, 1, SubBusNumber);\n      if (EFI_ERROR(Status)) {\n        return Status;\n      }\n\n      SecondBus = *SubBusNumber;\n\n      Register = (UINT16)((SecondBus &lt;&lt; 8) | (UINT16)StartBusNumber);\n      Address = EFI_PCI_ADDRESS(StartBusNumber, Device, Func,\n                                PCI_BRIDGE_PRIMARY_BUS_REGISTER_OFFSET);\n\n      Status = PciRootBridgeIo-&gt;Pci.Write(PciRootBridgeIo, EfiPciWidthUint16,\n                                          Address, 1, &amp;Register);\n\n      //\n      // If it is PPB, recursively search down this bridge\n      //\n      if (IS_PCI_BRIDGE(&amp;Pci)) {\n        //\n        // Temporarily initialize SubBusNumber to maximum bus number to ensure\n        // the PCI configuration transaction to go through any PPB\n        //\n        Register = PciGetMaxBusNumber(Bridge);\n        Address = EFI_PCI_ADDRESS(StartBusNumber, Device, Func,\n                                  PCI_BRIDGE_SUBORDINATE_BUS_REGISTER_OFFSET);\n        Status = PciRootBridgeIo-&gt;Pci.Write(PciRootBridgeIo, EfiPciWidthUint8,\n                                            Address, 1, &amp;Register);\n\n        Status = PciScanBus(PciDevice, SecondBus, SubBusNumber, PaddedBusRange);\n        if (EFI_ERROR(Status)) {\n          return Status;\n        }\n      }\n\n      //\n      // Set the current maximum bus number under the PPB\n      //\n      Address = EFI_PCI_ADDRESS(StartBusNumber, Device, Func,\n                                PCI_BRIDGE_SUBORDINATE_BUS_REGISTER_OFFSET);\n\n      Status = PciRootBridgeIo-&gt;Pci.Write(PciRootBridgeIo, EfiPciWidthUint8,\n                                          Address, 1, SubBusNumber);\n    } else {\n      //\n      // It is device. Check PCI IOV for Bus reservation\n      // Go through each function, just reserve the MAX ReservedBusNum for one\n      // device\n      //\n\n      // OMITTED\n    }\n\n    if ((Func == 0) &amp;&amp; !IS_PCI_MULTI_FUNC(&amp;Pci)) {\n      //\n      // Skip sub functions, this is not a multi function device\n      //\n\n      Func = PCI_MAX_FUNC;\n    }\n  }\n}\n</code></pre> <p>\u4ece\u4ee3\u7801\u4e2d\u53bb\u6389\u4e86\u4e00\u4e9b\u70ed\u63d2\u62d4\u76f8\u5173\u7684\u4ee3\u7801\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5b83\u7684\u601d\u8def\u5982\u4e0b\uff1a</p> <ol> <li>\u679a\u4e3e\u5f53\u524d\u8bbe\u5907\u4e0b\u7684 Device \u548c Function</li> <li>\u5982\u679c\u627e\u5230\u4e86\u4e00\u4e2a\u6865\u8bbe\u5907\uff0c\u4e3a\u5b83\u5206\u914d\u4e00\u4e2a\u65b0\u7684 Bus Number<ol> <li>\u8bbe\u7f6e\u8fd9\u4e2a\u65b0\u7684\u6865\u8bbe\u5907\u7684 Primary Bus Number \u4e3a Start Bus Number\uff08\u4e5f\u5c31\u662f\u4e0a\u4e00\u7ea7\u7684 Secondary Bus Number\uff09\uff0cSecondary Bus \u662f\u65b0\u5206\u914d\u7684 Bus Number\uff0cSubordinate Bus Number \u662f\u6700\u5927\u503c</li> <li>\u8fd9\u6837\u8bbe\u7f6e\u5b8c\u6210\u540e\uff0c\u76f8\u5f53\u4e8e\u6240\u6709\u7684\u5728 <code>[Secondary Bus Number, Max Bus Number]</code> \u8303\u56f4\u4e2d\u7684 Bus \u8bf7\u6c42\u90fd\u4f1a\u8def\u7531\u5230\u65b0\u7684\u6865\u8bbe\u5907\u4e0a</li> <li>\u9012\u5f52\u8c03\u7528 PciScanBus\uff0c\u53c2\u6570\u662f\u65b0\u7684\u6865\u8bbe\u5907\uff0cStart Bus Number \u4e3a\u65b0\u7684 Secondary Bus Number</li> <li>\u9012\u5f52\u8c03\u7528\u8fd4\u56de\u4ee5\u540e\uff0c\u65b0\u7684\u6865\u8bbe\u5907\u4e0b\u9762\u6240\u6709\u7684\u8bbe\u5907\u90fd\u5206\u914d\u5230\u4e86\u81ea\u5df1\u7684 Bus Number\uff0c\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u77e5\u9053\u51c6\u786e\u7684 Subordinate Bus Number \u4e86\uff0c\u4e0d\u518d\u662f\u521a\u624d\u4e34\u65f6\u8bbe\u7f6e\u7684 Max Bus Number\uff0c\u56e0\u6b64\u8fd9\u65f6\u5019\u518d\u628a\u51c6\u786e\u7684 Subordinate Bus Number \u5199\u5165\u6865\u8bbe\u5907\u7684 Subordinate Bus Number \u4e2d</li> </ol> </li> <li>\u679a\u4e3e\u5b8c\u6240\u6709\u8bbe\u5907\u4ee5\u540e\uff0c\u8fd4\u56de\u76ee\u524d\u9012\u5f52\u5206\u914d\u5f97\u5230\u7684\u6700\u5927\u7684 Bus Number</li> </ol> <p>\u8fd9\u6837\u6574\u7406\u51fa\u6765\u4e00\u770b\uff0c\u5176\u5b9e\u5f88\u6e05\u695a\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a DFS \u7b97\u6cd5\uff0c\u5728\u641c\u7d22\u8fc7\u7a0b\u4e2d\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u5f53\u524d\u7684\u7ed3\u70b9\u53ef\u8fbe\uff0c\u4fdd\u8bc1\u4ece Root Bridge \u5230\u5f53\u524d\u7684\u7ed3\u70b9\u8def\u5f84\u4e0a\u7684 Bus Number \u8303\u56f4\u90fd\u662f <code>[Secondary Bus Number, Max Bus Number]</code>\uff1b\u5f53\u7ed3\u70b9\u641c\u7d22\u5b8c\u4ee5\u540e\uff0c\u518d\u56de\u6eaf\uff0c\u56de\u6eaf\u7684\u65f6\u5019\u5c31\u77e5\u9053\u4e86\u5b9e\u9645\u5206\u914d\u5230\u591a\u5927\u7684 Bus Number\uff0c\u8fd9\u65f6\u5019\u518d\u586b\u56de Subordinate Bus Number\uff0c\u6700\u540e\u4fdd\u8bc1\u8fd9\u4e2a\u6811\u4e0a\u6bcf\u4e00\u5c42\u7684 <code>[Secondary Bus Number, Subordinate Bus Number]</code> \u533a\u95f4\u4e0d\u91cd\u5408\uff0c\u4e14\u6bcf\u4e2a\u5b50\u7ed3\u70b9\u7684\u533a\u95f4\u90fd\u5305\u542b\u4e8e\u7236\u7ed3\u70b9\u7684\u533a\u95f4\u3002</p> <p>\u6700\u540e\u7684\u7ed3\u679c\uff0c\u7c7b\u4f3c MindShare \u4e66\u4e2d\u7684\u8fd9\u4e2a\u56fe\uff1a</p>    ![](pcie_enum.png){ width=\"600\" }   PCIe \u679a\u4e3e\u7ed3\u679c\uff08\u56fe\u6e90 MineShare PCIe 3.0 \u4e66\uff09 <p>\u4e3a\u4e86\u652f\u6301 PCIe \u70ed\u63d2\u62d4\uff0c\u6216\u8005\u53ef\u80fd\u4f1a\u52a8\u6001\u4ea7\u751f\u65b0\u8bbe\u5907\u7684 SR-IOV\uff0c\u4ee3\u7801\u4e2d\u505a\u4e86\u76f8\u5e94\u7684\u9884\u7559\uff1a</p> <pre><code>if (FeaturePcdGet(PcdPciBusHotplugDeviceSupport)) {\n  //\n  // If Hot Plug is supported,\n  // Get the bridge information\n  //\n  BusPadding = FALSE;\n  if (gPciHotPlugInit != NULL) {\n    if (IsPciHotPlugBus(PciDevice)) {\n      //\n      // If it is initialized, get the padded bus range\n      //\n      Status = gPciHotPlugInit-&gt;GetResourcePadding(\n          gPciHotPlugInit, PciDevice-&gt;DevicePath, PciAddress, &amp;State,\n          (VOID **)&amp;Descriptors, &amp;Attributes);\n\n      if (EFI_ERROR(Status)) {\n        return Status;\n      }\n\n      BusRange = 0;\n      NextDescriptors = Descriptors;\n      Status = PciGetBusRange(&amp;NextDescriptors, NULL, NULL, &amp;BusRange);\n\n      FreePool(Descriptors);\n\n      if (!EFI_ERROR(Status)) {\n        BusPadding = TRUE;\n      } else if (Status != EFI_NOT_FOUND) {\n        //\n        // EFI_NOT_FOUND is not a real error. It indicates no bus number padding\n        // requested.\n        //\n        return Status;\n      }\n    }\n  }\n}\n\nif (FeaturePcdGet(PcdPciBusHotplugDeviceSupport) &amp;&amp; BusPadding) {\n  //\n  // Ensure the device is enabled and initialized\n  //\n  if ((Attributes == EfiPaddingPciRootBridge) &amp;&amp;\n      ((State &amp; EFI_HPC_STATE_ENABLED) != 0) &amp;&amp;\n      ((State &amp; EFI_HPC_STATE_INITIALIZED) != 0)) {\n    *PaddedBusRange = (UINT8)((UINT8)(BusRange) + *PaddedBusRange);\n  } else {\n    //\n    // Reserve the larger one between the actual occupied bus number and padded\n    // bus number\n    //\n    Status = PciAllocateBusNumber(PciDevice, SecondBus, (UINT8)(BusRange),\n                                  &amp;PaddedSubBus);\n    if (EFI_ERROR(Status)) {\n      return Status;\n    }\n\n    *SubBusNumber = MAX(PaddedSubBus, *SubBusNumber);\n  }\n}\n</code></pre> <p>SR-IOV:</p> <pre><code>//\n// It is device. Check PCI IOV for Bus reservation\n// Go through each function, just reserve the MAX ReservedBusNum for one device\n//\nif (PcdGetBool(PcdSrIovSupport) &amp;&amp; (PciDevice-&gt;SrIovCapabilityOffset != 0)) {\n  if (TempReservedBusNum &lt; PciDevice-&gt;ReservedBusNum) {\n    Status = PciAllocateBusNumber(\n        PciDevice, *SubBusNumber,\n        (UINT8)(PciDevice-&gt;ReservedBusNum - TempReservedBusNum), SubBusNumber);\n    if (EFI_ERROR(Status)) {\n      return Status;\n    }\n\n    TempReservedBusNum = PciDevice-&gt;ReservedBusNum;\n\n    if (Func == 0) {\n      DEBUG((DEBUG_INFO, \"PCI-IOV ScanBus - SubBusNumber - 0x%x\\n\",\n             *SubBusNumber));\n    } else {\n      DEBUG((DEBUG_INFO, \"PCI-IOV ScanBus - SubBusNumber - 0x%x (Update)\\n\",\n             *SubBusNumber));\n    }\n  }\n}\n</code></pre> <p>\u5206\u914d\u597d Bus \u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u5bf9\u6240\u6709\u8bbe\u5907\u8fdb\u884c Configuration Request \u4e86\uff0c\u540e\u7eed\u7684 Memory \u548c IO \u5730\u5740\u7684\u5206\u914d\u548c\u8def\u7531\uff0c\u4e5f\u662f\u7c7b\u4f3c\u5730\u9012\u5f52\u5730\u8fdb\u884c\u5206\u914d\uff0c\u7136\u540e\u56de\u6eaf\u7684\u65f6\u5019\u5408\u5e76\u5730\u5740\u533a\u95f4\u5373\u53ef\u3002</p>"},{"location":"hardware/pcie/#_5","title":"\u7269\u7406\u5c42","text":"<p>\u7269\u7406\u5c42\u7f16\u7801\u4e0a\uff0cPCIe 1.0 \u548c 2.0 \u91c7\u7528\u7684\u662f NRZ 8b/10b\uff0cPCIe 3.0 \u5230 5.0 \u7528\u7684\u662f NRZ 128b/130b\uff0c\u6700\u65b0\u7684 PCIe 6.0 \u548c 7.0 \u5219\u6362\u6210\u4e86 PAM4 FLIT\u3002\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6bcf\u4e00\u4ee3 x16 Lane \u60c5\u51b5\u4e0b\u7684\u6700\u5927\u6570\u636e\u5e26\u5bbd\uff1a</p> <ul> <li>PCIe 1.0: <code>2.5 * 8 / 10 * 16 = 32 Gb/s</code></li> <li>PCIe 2.0: <code>5.0 * 8 / 10 * 16 = 64 Gb/s</code></li> <li>PCIe 3.0: <code>8.0 * 128 / 130 * 16 = 126 Gb/s</code></li> <li>PCIe 4.0: <code>16.0 * 128 / 130 * 16 = 252 Gb/s</code></li> <li>PCIe 5.0: <code>32.0 * 128 / 130 * 16 = 504 Gb/s</code></li> <li>PCIe 6.0: <code>64.0 * 16 = 1024 Gb/s</code>\uff0c\u5982\u679c\u8003\u8651 FLIT \u5f15\u5165\u7684\u5f00\u9500\uff0c\u5219\u662f <code>64.0 * 242 / 256 * 16 = 968 Gb/s</code></li> <li>PCIe 7.0: <code>128.0 * 16 = 2048 Gb/s</code>\uff0c\u5982\u679c\u8003\u8651 FLIT \u5f15\u5165\u7684\u5f00\u9500\uff0c\u5219\u662f <code>128.0 * 242 / 256 * 16 = 1936 Gb/s</code></li> </ul>"},{"location":"hardware/pcie/#pcie-60","title":"PCIe 6.0","text":"<p>PCIe 6.0 \u5f15\u5165\u4e86 PAM4 \u6765\u66ff\u4ee3\u539f\u6765\u7684 NRZ\uff0c\u5b9e\u73b0\u4e86\u6ce2\u7279\u7387\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\u901f\u5ea6\u7ffb\u500d\uff0c\u5e76\u4e14\u4e0d\u518d\u4f7f\u7528 128b/130b\uff0c\u4e3a\u4e86\u89e3\u51b3 PAM4 \u5e26\u6765\u7684\u66f4\u9ad8\u7684\u9519\u8bef\u7387\uff0c\u5f15\u5165\u4e86 FEC\uff0cCRC \u8fd8\u6709\u683c\u96f7\u7801\uff0c\u4ee5\u53ca\u65b0\u7684 FLIT\u3002</p> <p>\u7f51\u4e0a\u53ef\u4ee5\u641c\u5230\u5173\u4e8e PCIe \u7684 PPT\uff1ahttps://pcisig.com/sites/default/files/files/PCIe%206.0%20Webinar_Final_.pdf \u548c https://www.openfabrics.org/wp-content/uploads/2022-workshop/2022-workshop-presentations/206_DDasSharma.pdf\uff0c\u4ee5\u53ca\u5173\u4e8e FLIT \u7684\u535a\u5ba2\uff1ahttps://pcisig.com/blog/pcie%C2%AE-60-specification-webinar-qa-deeper-dive-flit-mode-pam4-and-forward-error-correction-fec</p> <p>\u603b\u7ed3 FLIT \u7684\u8981\u70b9\uff1a</p> <ol> <li>\u6bcf\u4e2a FLIT \u56fa\u5b9a\u957f\u5ea6 256 \u5b57\u8282\uff0c\u5176\u4e2d 236 \u5b57\u8282\u4f20\u8f93 TLP\uff0c6 \u5b57\u8282\u4f20\u8f93 DLLP\uff0c8 \u5b57\u8282\u4f20\u8f93 CRC\uff0c6 \u5b57\u8282\u4f20\u8f93 FEC\u3002</li> <li>\u63a5\u53d7\u65b9\u63a5\u53d7\u5230 FLIT \u540e\uff0c\u4f1a\u5c1d\u8bd5\u8fdb\u884c FEC \u89e3\u7801\uff0c\u5e76\u4e14\u5c1d\u8bd5\u4fee\u590d\u9519\u8bef\uff0c\u518d\u8fdb\u884c CRC \u6821\u9a8c\u3002\u5982\u679c\u4e2d\u9014\u51fa\u73b0\u4e86\u9519\u8bef\uff0c\u5219\u4f1a\u53d1\u9001\u4e00\u4e2a NAK \u7ed9\u53d1\u9001\u65b9\u3002</li> <li>\u4e00\u4e2a TLP \u53ef\u80fd\u8de8\u8d8a\u591a\u4e2a FLIT\uff0c\u4e00\u4e2a FLIT \u53ef\u80fd\u5305\u62ec\u591a\u4e2a TLP\uff0c\u6839\u636e TLP \u5927\u5c0f\u800c\u5b9a\u3002TLP \u4e0d\u9700\u8981\u5bf9\u9f50\u5230 FLIT \u7684\u5f00\u5934\u6216\u8005\u7ed3\u5c3e\u3002</li> </ol> <p>\u53ef\u4ee5\u53d1\u73b0\uff0cFLIT \u7684 CRC \u7528\u4e86 8 \u4e2a\u5b57\u8282\uff0c\u4e0d\u518d\u9700\u8981\u539f\u6765 TLP \u548c DLLP \u4e2d\u7684 ECRC \u548c LCRC\u3002\u5728\u4e4b\u524d\u7684 PCIe \u7248\u672c\uff0cTLP \u7684\u53ef\u9009 Digest \u662f 4 \u4e2a\u5b57\u8282\u7684 ECRC\uff0cTLP+DLLP \u7684 LCRC \u662f 4 \u5b57\u8282\u3002\u5177\u4f53\u91c7\u7528\u591a\u5c11\u5b57\u8282\u7684 CRC\uff0c\u548c\u76ee\u6807\u7684\u9519\u8bef\u7387\uff0c\u4ee5\u53ca\u4f20\u8f93\u7684\u5b57\u8282\u6570\u76f8\u5173\u3002</p>"},{"location":"hardware/pcie/#ats","title":"ATS","text":"<p>ATS\uff08Address Translation Service\uff09\u662f\u5728 PCIe \u4e0a\u7ed9\u5916\u8bbe\u63d0\u4f9b\u67e5\u8be2\u9875\u8868\u7684\u65b9\u5f0f\uff0c\u4ece\u800c\u53ef\u4ee5\u4f7f\u7528\u865a\u62df\u5730\u5740\u3002\u6807\u51c6\u53ef\u4ee5\u5728 https://composter.com.ua/documents/ats_r1.1_26Jan09.pdf \u5904\u4e0b\u8f7d\uff0c\u4ee5\u53ca\u5173\u4e8e ATS \u7684 PPT\uff1ahttps://composter.com.ua/documents/Address_Translation_Services.pdf\u3002</p> <p>\u5b83\u7684\u6574\u4f53\u5de5\u4f5c\u65b9\u5f0f\u5982\u56fe\uff1a</p>    ![](pcie_ats.png){ width=\"600\" }   PCIe ATS \u5de5\u4f5c\u65b9\u5f0f\uff08\u56fe\u6e90 PCIe ATS \u6807\u51c6\uff09 <p>\u5c31\u662f\u5728 Root Complex \u548c Memory \u4e4b\u95f4\u8bbe\u7f6e\u4e00\u4e2a Translation Agent\uff0c\u8d1f\u8d23\u67e5\u8868\uff0c\u4e5f\u5c31\u662f Page Table Walker\u3002\u5b83\u4f1a\u63a5\u6536\u6765\u81ea PCIe \u8bbe\u5907\u7684\u5730\u5740\u7ffb\u8bd1\u8bf7\u6c42\uff0c\u7136\u540e\u5b83\u83b7\u53d6\u5230\u9875\u8868\u5730\u5740\u540e\uff0c\u6839\u636e\u865a\u62df\u5730\u5740\u53bb\u67e5\u5185\u5b58\u4e2d\u7684\u9875\u8868\u3002TLB\uff08\u5728\u6807\u51c6\u4e2d\u53eb\u505a Address Translation Cache\uff0cATC\uff09\u662f\u5b9e\u73b0\u5728 PCIe \u8bbe\u5907\u4fa7\u7684\uff0c\u800c\u4e0d\u662f\u7edf\u4e00\u7684 TLB\uff0c\u4e5f\u4e0d\u662f CPU \u6838\u5fc3\u7684 TLB\u3002</p> <p>\u4e3a\u4e86\u652f\u6301 ATS\uff0c\u9700\u8981\u652f\u6301\u5982\u4e0b\u7684\u64cd\u4f5c\uff1a</p> <ol> <li>PCIe Device \u5411 Translation Agent \u53d1\u9001 Translation Request\uff1bTranslation Agent \u5411 PCIe Device \u56de\u590d Translation Completion\uff1b</li> <li>\u5f53\u9875\u8868\u51fa\u73b0\u53d8\u5316\u7684\u65f6\u5019\uff0c\u9700\u8981\u901a\u77e5 PCIe \u8bbe\u5907\u7aef\u7684 TLB\uff0c\u56e0\u6b64\u9700\u8981\u5411 PCIe \u8bbe\u5907\u53d1\u9001 Invalidate Request Message\uff1bPCIe \u8bbe\u5907\u5b8c\u6210 TLB \u5237\u65b0\u540e\uff0c\u56de\u590d\u4e00\u4e2a Invalidate Complete Message\u3002</li> </ol> <p>ATS \u6807\u51c6\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53ef\u9009\u529f\u80fd\uff0c\u5c31\u662f Page Request Interface\uff08PRI\uff09\uff0c\u5176\u5b9e\u5c31\u662f\u7f3a\u9875\u7684\u65f6\u5019\uff0c\u8bbe\u5907\u53ef\u4ee5\u53bb\u53d1\u9001 Page Request\uff0c\u8981\u6c42\u64cd\u4f5c\u7cfb\u7edf\u53bb\u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875\u3002\u8fd9\u5c31\u50cf\u7528\u6237\u7a0b\u5e8f\u91cc mmap \u4e00\u4e2a\u533f\u540d\u7684\u9875\uff0c\u4e00\u5f00\u59cb\u662f\u6ca1\u6709\u5206\u914d\u7684\uff0c\u76f4\u5230\u7b2c\u4e00\u6b21\u8bbf\u95ee\u7684\u65f6\u5019\uff0c\u51fa\u73b0\u7f3a\u9875\u5f02\u5e38\uff0c\u7136\u540e OS \u5206\u914d\u4e00\u4e2a\u7269\u7406\u9875\uff0c\u518d\u66f4\u65b0\u9875\u8868\u3002\u8fd9\u6837\u7684\u597d\u5904\u662f\u7528\u4e8e DMA \u7684\u7269\u7406\u9875\u4e5f\u53ef\u4ee5 Swap \u6216\u8005\u5ef6\u8fdf\u5206\u914d\u3002</p>"},{"location":"hardware/pcie/#bifurcation","title":"Bifurcation","text":"<p>PCIe Bifurcation \u7684\u76ee\u7684\u662f\u8ba9 PCIe \u6709\u66f4\u597d\u7684\u7075\u6d3b\u6027\u3002\u4ece CPU \u51fa\u6765\u7684\u51e0\u8def PCIe\uff0c\u5b83\u7684\u5bbd\u5ea6\u4e00\u822c\u662f\u786e\u5b9a\u7684\uff0c\u6bd4\u5982\u6709\u4e00\u4e2a x16\uff0c\u4f46\u662f\u5b9e\u9645\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u60f3\u8981\u63a5\u591a\u4e2a\u8bbe\u5907\uff0c\u4f8b\u5982\u628a x16 \u5f53\u6210\u4e24\u4e2a x8 \u6765\u7528\uff0c\u8fd9\u5c31\u662f PCIe Bifurcation\u3002\u8fd9\u9700\u8981 PCIe \u4e24\u7aef\u7684\u652f\u6301\uff0cCPU \u7aef\u9700\u8981\u53ef\u914d\u7f6e PCIe Bifurcation\uff0c\u4e0d\u7136\u53ea\u80fd\u4ece\u4e00\u4e2a x16 \u964d\u7ea7\u5230\u4e00\u4e2a x8\uff0c\u5269\u4e0b\u7684 8x \u5c31\u6ca1\u6cd5\u5229\u7528\u4e86\uff1b\u8bbe\u5907\u7aef\u9700\u8981\u62c6\u5206\u5361\uff0c\u628a x16 \u7684\u4fe1\u53f7\u5206\u6210\u4e24\u8def\uff0c\u7136\u540e\u63d0\u4f9b\u4e24\u4e2a PCIe \u63d2\u69fd\u4ee5\u53ca\u4f7f\u7528 Clock Buffer \u6765\u63d0\u4f9b\u4e0b\u6e38\u8bbe\u5907\u7684\u65f6\u949f\uff0c\u6709\u65f6\u5219\u662f\u4e3b\u677f\u8bbe\u8ba1\u65f6\u5c31\u505a\u4e86\u62c6\u5206\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u62c6\u5206\u5361\u3002</p> <p>\u4e0b\u9762\u5206\u522b\u4ece\u684c\u9762\u5e73\u53f0\u548c\u670d\u52a1\u5668\u5e73\u53f0\uff0c\u7814\u7a76 PCIe Bifurcation \u662f\u5982\u4f55\u914d\u7f6e\u7684\u3002</p>"},{"location":"hardware/pcie/#_6","title":"\u684c\u9762\u5e73\u53f0","text":"<p>\u5728\u684c\u9762\u5e73\u53f0\u4e0a\uff0cIntel CPU \u4f1a\u6839\u636e\u542f\u52a8\u65f6 CFG \u5f15\u811a\u7684\u503c\u6765\u51b3\u5b9a PCIe Bifurcation \u8bbe\u7f6e\u3002CFG \u7684\u503c\u4e0e PCIe Bifurcation \u7684\u5bf9\u5e94\u5173\u7cfb\u53ef\u4ee5\u4ece Datasheet \u4e2d\u627e\u5230\u3002</p> <p>\u5b9e\u9645\u627e\u4e00\u4e2a\u4e3b\u677f\u6765\u7814\u7a76\u4e00\u4e0b\u3002\u578b\u53f7\u662f ASRock Fatal1ty Z97X Killer\uff0c\u4ece\u4e3b\u677f\u7684\u63cf\u8ff0\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\uff1a<code>3 x PCI Express 3.0 x16 Slots (PCIE2/PCIE4/PCIE6: single at x16 (PCIE2); dual at x8 (PCIE2) / x8 (PCIE4); triple at x8 (PCIE2) / x4 (PCIE4) / x4 (PCIE6)</code>\uff0c\u8bf4\u660e\u5b83\u662f\u652f\u6301 PCIe Bifurcation \u7684\uff0c\u6d89\u53ca\u5230\u4e09\u4e2a PCIe Slot\uff0c\u652f\u6301\u4e09\u79cd\u6a21\u5f0f\uff1a</p> <ul> <li>PCIE2 Slot x16</li> <li>PCIE2 Slot x8, PCIE4 Slot x8</li> <li>PCIE2 Slot x8, PCIE4 Slot x4, PCIE6 Slot x4</li> </ul> <p>\u5728 \u7f51\u4e0a \u627e\u5230\u8be5\u4e3b\u677f\u7684 \u539f\u7406\u56fe\uff0c\u53ef\u4ee5\u7528 OpenBoardView \u8f6f\u4ef6\u6253\u5f00\u3002\u8fd9\u4e2a\u4e3b\u677f\u4e0a\u7684 CPU \u63d2\u69fd\u662f LGA1150\uff0c\u627e\u5230\u4e00\u4e2a\u517c\u5bb9\u7684 CPU \u7248\u672c i7-4771\uff0c\u4e0b\u8f7d Datasheet\uff0c\u53ef\u4ee5\u770b\u5230\u51b3\u5b9a PCIe Bifurcation \u7684\u5f15\u811a\u662f <code>CFG[6:5]</code>\uff1a</p> <ul> <li><code>CFG[6:5]=00</code>: 1x8, 2x4</li> <li><code>CFG[6:5]=10</code>: 2x8</li> <li><code>CFG[6:5]=11</code>: 1x16</li> </ul> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e09\u79cd\u914d\u7f6e\u548c\u4e3b\u677f\u7f51\u7ad9\u4e0a\u63cf\u8ff0\u7684\u662f\u4e00\u81f4\u7684\u3002\u65e2\u7136\u4e3b\u677f\u652f\u6301 Bifurcation\uff0c\u8bf4\u660e\u4e00\u5b9a\u6709\u529e\u6cd5\u8bbe\u7f6e <code>CFG[6:5]</code> \u4e3a\u4ee5\u4e0a\u4e09\u79cd\u53d6\u503c\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u8981\u627e\u5230\u4e3b\u677f\u4e0a\u600e\u4e48\u8fde\u63a5 <code>CFG[6:5]</code>\u3002\u5728\u539f\u7406\u56fe\u4e2d\uff0c\u53ef\u4ee5\u627e\u5230 LGA1150 \u7684 <code>U39 CPU_CFG5</code> \u548c <code>U40 V_CFG6</code>\uff0c\u7ee7\u7eed\u5f80\u4e0b\u627e\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u4eec\u901a\u8fc7\u7535\u963b\u8fde\u5230\u4e86\u540c\u4e00\u4e2a BAT54C \u82af\u7247\u4e0a\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u770b BAT54C \u7b2c\u4e09\u4e2a\u5f15\u811a N105955695 \u7684\u7535\u5e73\u3002N105955695 \u63a5\u5230\u4e86\u4e00\u4e2a 2N7002BKS \u82af\u7247\u4e0a\uff0c\u6839\u636e\u7535\u8def\u56fe\uff0c\u6700\u540e\u662f\u8981\u770b <code>X4_PRSNT1#</code> \u4fe1\u53f7\u3002</p> <p><code>X4_PRSTN1#</code> \u4fe1\u53f7\u8fde\u63a5\u5230\u4e86 PCIE6 \u4e0a\uff0c\u5982\u679c PCIE6 Slot \u63d2\u5165\u4e86\u8bbe\u5907\uff0c\u90a3\u4e48 <code>X4_PRSTN1#</code> \u4fe1\u53f7\u751f\u6548\uff0c\u6839\u636e\u5206\u6790\u51fa\u6765\u7684\u7535\u8def\uff0c\u5b83\u4f1a\u4f7f\u5f97 <code>CFG[6:0]</code> \u53d8\u4e3a 00\uff0c\u5bf9\u5e94 1x8+2x4 \u7684 Bifurcation \u6a21\u5f0f\u3002\u56de\u60f3\u4e00\u4e0b\uff0c\u5728\u4e3b\u677f\u652f\u6301\u7684\u4e09\u79cd PCIe Bifurcation \u6a21\u5f0f\u4e0b\uff0c\u53ea\u6709\u8fd9\u4e00\u79cd\u6d89\u53ca\u5230\u4e86 PCIE6 Slot\u3002\u6240\u4ee5\u5982\u679c\u7528\u6237\u5728 PCIE6 Slot \u63d2\u5165\u4e86\u8bbe\u5907\uff0c\u90a3\u8bf4\u660e\u7528\u6237\u9700\u8981\u7684\u662f 1x8+2x4 \u7684\u6a21\u5f0f\uff0c\u81ea\u52a8\u914d\u7f6e CPU \u7684 <code>CFG[6:5]</code> \u4fe1\u53f7\u4e3a\u9884\u671f\u503c\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u8bbe\u7f6e <code>CFG[6:5]</code> \u8fd8\u4e0d\u591f\uff0c\u4e0a\u9762\u63d0\u5230\u8fc7\uff0c\u4e3b\u677f\u9700\u8981\u8d1f\u8d23\u628a PCIE2/4/6 \u7684\u4fe1\u53f7\u8fde\u63a5\u5230\u539f\u6765\u7684\u5b8c\u6574\u7684 x16 \u4e0a\uff0c\u5e76\u4e14\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fde\u63a5\u4e0d\u540c\u7684\u7ebf\u3002\u5177\u4f53\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e5f\u53ef\u4ee5\u5728\u539f\u7406\u56fe\u4e2d\u627e\u5230\uff1a\u4fe1\u53f7 <code>X4_PRSTN1#</code> \u8fde\u63a5\u5230\u4e86 CBTL04083BBS\uff0c\u8fd9\u662f\u4e00\u4e2a PCIe Mux/Demux \u82af\u7247\uff0c\u4e5f\u5c31\u662f\u628a\u540c\u6837\u4e00\u7ec4\u5dee\u5206\u7ebf\u8fde\u5230\u4e0d\u540c PCIe Slot \u4e0a\u6240\u9700\u8981\u7684\u82af\u7247\u3002</p> <p>\u4e8e\u662f\u76ee\u524d\u63a8\u65ad\u51fa\u4e86\u4e00\u90e8\u5206\u7684\u5de5\u4f5c\u539f\u7406\uff1a\u7528\u6237\u5728 PCIE6 Slot \u63d2\u5165\u8bbe\u5907\uff0c\u7535\u8def\u8ba1\u7b97\u51fa <code>CFG[6:5]=00</code>\uff0c\u540c\u65f6\u914d\u7f6e\u597d\u4e86 PCIe Mux/Demux \u82af\u7247\uff0c\u628a 1x16 \u5207\u5206\u4e3a 1x8+2x4\u3002</p> <p>\u7ee7\u7eed\u5f80\u4e0b\u770b\uff0c\u4e3b\u677f\u5982\u4f55\u5b9e\u73b0\u5269\u4e0b\u4e24\u79cd\u914d\u7f6e\uff1a<code>CFG[6:5]=10</code> \u5bf9\u5e94 2x8\uff0c<code>CFG[6:5]=11</code> \u5bf9\u5e94 1x16\u3002\u8fd9\u4e24\u79cd\u7f16\u7801\u91cc\uff0cCFG6 \u90fd\u4e3a 1\uff0c\u53ea\u9700\u8981\u8003\u8651\u5982\u4f55\u5904\u7406 CFG5\u3002CFG5 \u9664\u4e86\u8fde\u63a5\u4e0a\u9762\u63d0\u5230\u7684 BAT54C \u4ee5\u5916\uff0c\u8fd8\u901a\u8fc7\u53e6\u4e00\u4e2a 2N7002BKS \u82af\u7247\u8fde\u63a5\u5230\u4e86 <code>NB_X8_PRSENT#</code> \u4fe1\u53f7\u4e0a\u3002\u5982\u679c\u4f60\u60f3\u660e\u767d\u4e86\u524d\u9762\u7684\u8fc7\u7a0b\uff0c\u5e94\u8be5\u53ef\u4ee5\u63a8\u65ad\u51fa\u6765\uff0c\u8fd9\u91cc\u7684 <code>NB_X8_PRSENT#</code> \u8fde\u63a5\u5230\u4e86 PCIE4 Slot \u4e0a\u3002\u5f53 PCIE4 Slot \u63d2\u5165\u4e86\u8bbe\u5907\uff0c\u540c\u65f6 PCIE6 Slot \u6ca1\u6709\u63d2\u5165\u8bbe\u5907\uff0c\u90a3\u4e48\u6839\u636e\u76f8\u5e94\u7684 PRESENT \u4fe1\u53f7\uff0c\u53ef\u4ee5\u5f97\u5230 <code>CFG[6:5]=10</code>\u3002\u5982\u679c PCIE4 Slot \u548c PCIE6 Slot \u90fd\u6ca1\u6709\u63d2\u5165\u8bbe\u5907\uff0c\u90a3\u5c31 <code>CFG[6:5]=11</code>\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff0c\u52a8\u6001\u68c0\u6d4b\u5e76\u8ba1\u7b97\u51fa <code>CFG[6:5]</code> \u7684\u903b\u8f91\uff1a</p> <ol> <li>\u5982\u679c PCIE6 Slot \u63d2\u5165\u4e86\u8bbe\u5907\uff0c\u8bf4\u660e\u8981\u914d\u7f6e\u4e3a 1x8+2x4\uff0c\u8bbe\u7f6e <code>CFG[6:5]=00</code></li> <li>\u5426\u5219\uff0c\u5982\u679c PCIE4 Slot \u63d2\u5165\u4e86\u8bbe\u5907\uff0c\u8bf4\u660e\u8981\u914d\u7f6e\u4e3a 2x8\uff0c\u8bbe\u7f6e <code>CFG[6:5]=10</code></li> <li>\u5426\u5219\uff0c\u8bf4\u660e\u8981\u914d\u7f6e\u4e3a 1x16\uff0c\u8bbe\u7f6e <code>CFG[6:5]=11</code></li> </ol> <p>\u800c\u4e3b\u677f\u8bbe\u8ba1\u8005\u5c31\u662f\u8981\u628a\u8fd9\u4e2a\u903b\u8f91\u8f6c\u5316\u4e3a\u7535\u8def\uff0c\u7528 BAT54C \u548c CBTL04083BBS \u82af\u7247\u6765\u5b9e\u73b0\u903b\u8f91\u8fd0\u7b97\u3002</p> <p>\u987a\u4fbf\u4e00\u63d0\uff0c\u8fd9\u91cc\u7684 PCIE2/4/6 \u7269\u7406\u5c3a\u5bf8\u90fd\u662f x16\uff0c\u53ea\u4e0d\u8fc7\u5b9e\u9645\u5206\u914d\u5230\u7684\u5bbd\u5ea6\u4e0d\u4e00\u5b9a\u4e0e\u7269\u7406\u5c3a\u5bf8\u4e00\u81f4\u3002</p>"},{"location":"hardware/pcie/#_7","title":"\u670d\u52a1\u5668\u5e73\u53f0","text":"<p>\u5728\u670d\u52a1\u5668\u5e73\u53f0\u4e0a\uff0cIntel CPU \u7684 Bifurcation \u53d8\u6210\u8fd0\u884c\u65f6\u53ef\u914d\u7f6e\u7684\uff0c\u4f8b\u5982\u5728 Xeon E5 v4 Datasheet Volume 2 \u4e2d\uff0c\u53ef\u4ee5\u627e\u5230\u5bc4\u5b58\u5668 <code>pcie_iou_bif_ctrl</code> \u5bc4\u5b58\u5668\u7684\u5b9a\u4e49\uff1a</p>    ![](pcie_bifurcation.png){ width=\"600\" }   PCIe Bifurcation \u914d\u7f6e\u65b9\u5f0f\uff08\u56fe\u6e90 Xeon E5 v4 Datasheet Volume 2\uff09 <p>\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5728 PCIe \u914d\u7f6e\u7a7a\u95f4\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>setpci</code> \u547d\u4ee4\u6765\u8bfb\u53d6\u6216\u5199\u5165\uff1a</p> <pre><code>$ setpci -s 00:00.0 190.B\n00\n$ setpci -s 00:01.0 190.B\n01 # x8\n$ setpci -s 00:02.0 190.B\n04 # x16\n$ setpci -s 00:03.0 190.B\n03 # x8x8\n$ setpci -s 80:02.0 190.B\n04 # x16\n</code></pre> <p>\u901a\u8fc7 <code>lspci -bPP</code> \u547d\u4ee4\u4ee5\u53ca <code>lspci -vvv</code>\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u8fd9\u51e0\u4e2a PCIe Root Port \u4e0b\u7684\u8bbe\u5907\u4ee5\u53ca\u901f\u5ea6\uff1a</p> <ul> <li>00:01.0(x8)/02:00.0 RAID \u63a7\u5236\u5668 PCIe 3.0 x8</li> <li>00:02.0(x16)/03:00.0 NVIDIA \u663e\u5361 PCIe 3.0 x16</li> <li>00:03.0(x8x8)/01:00.0 BCM 2x10G+2x1G \u7f51\u5361 PCIe 2.0 x8</li> <li>80:02.0(x16)/82:00.0 NVIDIA \u663e\u5361 PCIe 3.0 x16</li> </ul> <p>\u5176\u4e2d\u524d\u4e09\u4e2a\u8bbe\u5907\u8fde\u63a5\u5230 CPU1\uff0c\u540e\u4e09\u4e2a\u8bbe\u5907\u8fde\u63a5\u5230 CPU2</p> <p>\u5728 BIOS \u8bbe\u7f6e\u4e2d\uff0c\u8fdb\u5165 Integrated Devices -&gt; Slot Bifurcation \u53ef\u4ee5\u770b\u5230\u8bbe\u7f6e\uff0c\u53ef\u9009\u9879\u6709\uff1a</p> <ul> <li>Slot \u00bd/\u2157: Default Bifurcation, x4+x4 Bifurcation</li> <li>Slot 4/6: Default Bifurcation, x4+x4+x4+x4 Bifurcation, x8+x8 Bifurcation</li> </ul> <p>\u9605\u8bfb R730 \u6587\u6863\uff0c\u53ef\u4ee5\u53d1\u73b0\u5b83\u6700\u591a\u53ef\u4ee5\u6709 7 \u4e2a Slot\uff0c\u5176\u4e2d Slot \u00bd/\u2157/7 \u662f PCIe 3.0x8\uff0cSlot 4 \u662f PCIe 3.0 x16\uff0cSlot 6 \u6839\u636e\u4e0d\u540c\u7684 Riser \u53ef\u4ee5\u63d0\u4f9b PCIe 3.0 x8 \u6216 x16\uff0c\u5bf9\u5e94\u5173\u7cfb\u5982\u4e0b\uff1a</p> <ul> <li>PCIe Slot 1: x8, CPU2</li> <li>PCIe Slot 2: x8, CPU2</li> <li>PCIe Slot 3: x8, CPU2</li> <li>PCIe Slot 4: x16, CPU2</li> <li>PCIe Slot 5: x8, CPU1</li> <li>PCIe Slot 6: x8/x16, CPU1</li> <li>PCIe Slot 7: x8, CPU1</li> </ul> <p>\u9605\u8bfb E5 v4 CPU \u6587\u6863\uff0c\u53ef\u4ee5\u53d1\u73b0\u5b83\u6709\u4e09\u4e2a PCIe Port\uff0c\u4e00\u5171\u6709 40 PCIe lanes\uff08x8+x16+x16\uff09\u3002\u7531\u6b64\u53ef\u77e5\uff0c\u5176\u4e2d\u4e00\u4e2a x16 \u8fde\u63a5\u5230 Slot4/6 \u4e0a\uff0c\u53e6\u4e00\u4e2a x16 \u62c6\u5206\u6210 x8+x8\uff0c\u8fde\u63a5\u5230\u5176\u4f59\u7684 Slot\u3002\u6709\u4e9b\u5947\u602a\u7684\u662f CPU1 \u5c11\u4e86\u4e00\u4e2a x8 \u4e0d\u77e5\u53bb\u5411\uff0c\u6000\u7591\u662f\u8fde\u63a5\u5230\u4e86 RAID \u5361\u6216\u8005\u7f51\u5361\u4e0a\u3002\u7531\u4e8e\u7f3a\u5c11\u4e3b\u677f\u7684\u539f\u7406\u56fe\uff0c\u65e0\u6cd5\u7ee7\u7eed\u6df1\u5165\u7814\u7a76\u3002</p> <p>\u9057\u61be\u7684\u662f\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684 <code>iou_start_bifurcation</code> \u5b57\u6bb5\u53ea\u80fd\u5199\u5165\u4e00\u6b21 1 \u6765\u521d\u59cb\u5316 Bifurcation\uff0c\u800c\u8fd9\u4e00\u822c\u662f\u7531 BIOS \u5b8c\u6210\u7684\u3002\u5982\u679c BIOS \u6ca1\u6709\u505a\uff0c\u6216\u8bb8\u53ef\u4ee5\u540e\u9762\u518d\u5199\u5165\u4e00\u6b21\uff1b\u5982\u679c BIOS \u5df2\u7ecf\u5199\u5165\u4e86\uff0c\u4f46\u662f\u6ca1\u6709\u63d0\u4f9b\u53ef\u9009\u9879\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u9006\u5411 BIOS\uff0c\u4f7f\u7528 UEFITool \u67e5\u770b\u662f\u5426\u6709\u9690\u85cf\u7684\u914d\u7f6e\uff0c\u5982\u679c\u6709\uff0c\u5219\u53ef\u4ee5\u5c1d\u8bd5\u7ed5\u8fc7 BIOS \u8bbe\u7f6e\u53bb\u4fee\u6539\u9690\u85cf\u7684\u914d\u7f6e\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u53ef\u4ee5\u8003\u8651\u4fee\u6539 BIOS \u7684\u6307\u4ee4\u3002</p>"},{"location":"hardware/pcie/#_8","title":"\u5c0f\u7ed3","text":"<p>\u7b80\u5355\u603b\u7ed3\u4e00\u4e0b\uff0cPCIe Bifurcation \u7684\u76ee\u7684\u662f\u4fdd\u8bc1\u603b lane \u6570\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u8fde\u63a5\u66f4\u591a\u8bbe\u5907\u7684\u8f83\u4f4e\u6210\u672c\u7684\u65b9\u6cd5\u3002\u5b83\u9700\u8981 CPU \u4e00\u4fa7\u548c\u8bbe\u5907\u4e00\u4fa7\u7684\u652f\u6301\u3002\u684c\u9762\u7ea7\u522b\u7684 CPU \u901a\u8fc7 CFG \u4fe1\u53f7\u6765\u914d\u7f6e\uff0c\u670d\u52a1\u5668\u7aef\u7684 CPU \u901a\u8fc7 PCIe \u914d\u7f6e\u7a7a\u95f4\u6765\u914d\u7f6e\u3002\u8bbe\u5907\u4e00\u4fa7\uff0c\u53ef\u4ee5\u7531\u4e3b\u677f\u8fdb\u884c\u62c6\u5206\uff0c\u6b64\u65f6\u4e3b\u677f\u4e0a\u4f1a\u6709\u591a\u4f59\u7684 PCIe \u63a5\u53e3\uff0c\u6839\u636e\u63d2\u5728\u4e3b\u677f\u4e0a\u7684\u8bbe\u5907\u7684\u60c5\u51b5\uff0c\u4e3b\u677f\u81ea\u9002\u5e94\u51fa\u4e00\u4e2a PCIe Bifurcation \u914d\u7f6e\uff1b\u4e3b\u677f\u4e5f\u53ef\u4ee5\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u76f4\u63a5\u628a CPU \u7684 PCIe \u63a5\u5230 Slot \u4e0a\uff0c\u6b64\u65f6\u9700\u8981\u7528\u6237\u81ea\u5df1\u8d2d\u4e70 PCIe \u62c6\u5206\u5361\u3002\u6dd8\u5b9d\u4e0a\u53ef\u4ee5\u641c\u5230\u4e0d\u5c11 PCIe \u62c6\u5206\u5361\uff0c\u5176\u4e2d\u7528\u4e8e NVMe \u7684\u8f83\u591a\uff0c\u6bd5\u7adf M.2 \u63a5\u53e3\u9762\u79ef\u5c0f\uff0c\u800c\u4e14\u53ea\u9700\u8981 PCIe x4\u3002</p> <p>\u53e6\u4e00\u79cd\u65b9\u6848\u662f PCIe \u4ea4\u6362\u673a\uff08\u5982 PEX 8747\uff09\uff0c\u7f3a\u70b9\u662f\u6210\u672c\u8f83\u9ad8\uff0c\u589e\u52a0\u4e86\u5ef6\u8fdf\uff0c\u597d\u5904\u662f\u7075\u6d3b\u6027\u5f88\u5f3a\uff0c\u4e0d\u9700\u8981 CPU \u989d\u5916\u914d\u7f6e\uff0c\u53ef\u4ee5\u5916\u63a5\u66f4\u591a\u8bbe\u5907\uff0c\u5e76\u4e14\u8bbe\u5907\u7a7a\u95f2\u65f6\u53ef\u4ee5\u8ba9\u51fa\u5e26\u5bbd\u3002\u4f8b\u5982\u4e00\u4e2a x16 \u4f7f\u7528 Bifurcation \u65b9\u6cd5\u53ef\u4ee5\u62c6\u6210\u4e24\u4e2a x8\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 PCIe \u4ea4\u6362\u673a\u8fde\u63a5\u4e24\u4e2a x16\uff0c\u7c7b\u4f3c\u7f51\u7edc\uff0c\u8fd9\u4e24\u4e2a x16 \u5171\u4eab\u5e26\u5bbd\uff0c\u4e0b\u6e38\u7684\u4e24\u4e2a\u8bbe\u5907\u4e4b\u95f4\u4e5f\u53ef\u4ee5\u76f4\u63a5\u901a\u4fe1\uff0c\u8fd9\u4e2a\u5728 HPC \u573a\u666f\u4e0b\u4f1a\u6bd4\u8f83\u5e38\u89c1\uff0c\u4f8b\u5982\u4f7f\u7528 PCIe \u4ea4\u6362\u673a\u8fde\u63a5\u663e\u5361\u548c IB \u7f51\u5361\u3002</p>"},{"location":"hardware/pcie/#cxl","title":"CXL","text":"<p>CXL \u7684\u6807\u51c6\u662f\u516c\u5f00\u4e0b\u8f7d\u7684\uff1ahttps://www.computeexpresslink.org/download-the-specification\uff0c\u4e0b\u6587\u53c2\u8003\u7684\u662f 2022 \u5e74 8 \u6708 1 \u65e5\u7684 CXL 3.0 \u7248\u672c\u3002</p>"},{"location":"hardware/pcie/#cxl_1","title":"CXL \u8bbe\u5907\u7c7b\u578b","text":"<p>CXL \u5bf9 PCIe \u7684\u91cd\u8981\u7684\u6269\u5c55\uff0c\u4e00\u662f\u5728\u4e8e\u8ba9\u8bbe\u5907\u53ef\u4ee5\u548c CPU \u5b9e\u73b0\u7f13\u5b58\u4e00\u81f4\u6027\uff08CXL.cache\uff09\uff0c\u4e8c\u662f\u53ef\u4ee5\u505a\u8fdc\u7a0b\u7684\u5185\u5b58\uff08CXL.mem\uff09\u3002</p> <p>\u5177\u4f53\u4e0b\u6765\uff0cCXL \u6807\u51c6\u4e3b\u8981\u5b9a\u4e49\u4e86\u4e09\u7c7b\u8bbe\u5907\uff1a</p> <ul> <li>CXL Type 1: \u8bbe\u5907\u5e26\u6709\u4e0e CPU \u4e00\u81f4\u7684\u7f13\u5b58\uff0c\u5b9e\u73b0 CXL.io \u548c CXL.cache</li> <li>CXL Type 2: \u8bbe\u5907\u5e26\u6709\u81ea\u5df1\u7684\u5185\u5b58\u548c\u4e0e CPU \u4e00\u81f4\u7684\u7f13\u5b58\uff0c\u5b9e\u73b0 CXL.io\uff0cCXL.cache \u548c CXL.mem</li> <li>CXL Type 3: \u8bbe\u5907\u5e26\u6709\u81ea\u5df1\u7684\u5185\u5b58\uff0c\u5b9e\u73b0 CXL.io \u548c CXL.mem</li> </ul>"},{"location":"hardware/pcie/#cxl_2","title":"CXL \u4f20\u8f93\u5c42","text":""},{"location":"hardware/pcie/#cxlio","title":"CXL.io","text":"<p>CXL.io \u57fa\u672c\u4e0a\u5c31\u662f PCIe \u534f\u8bae\uff1a</p> <pre><code>CXL.io provides a non-coherent load/store interface for I/O devices. Figure\n3-1 shows where the CXL.io transaction layer exists in the Flex Bus layered\nhierarchy. Transaction types, transaction packet formatting, credit-based\nflow control, virtual channel management, and transaction ordering rules\nfollow the PCIe* definition; please refer to the \u201cTransaction Layer\nSpecification\u201d chapter of PCIe Base Specification for details. This chapter\nhighlights notable PCIe operational modes or features that are used for\nCXL.io.\n</code></pre> <p>CXL 3.0 \u901f\u5ea6\u662f 64.0 GT/s\uff0c\u4f7f\u7528 PAM4 \u7f16\u7801\uff0c\u5bf9\u5e94\u7684\u662f PCIe 6.0\u3002</p>"},{"location":"hardware/pcie/#cxlcache","title":"CXL.cache","text":"<p>CXL.cache \u6bcf\u4e2a\u65b9\u5411\u4e0a\u6709\u4e09\u4e2a channel\uff1a\u8bf7\u6c42\uff0c\u54cd\u5e94\u548c\u6570\u636e\u3002\u8003\u8651\u5230 Host \u548c Device \u7684\u4f20\u8f93\u65b9\u5411\uff0c\u5c31\u662f\u516d\u4e2a channel\uff1aD2H Req\uff0cD2H Resp\uff0cD2H Data\uff0cH2D Req\uff0cH2D Resp\uff0cH2D Data\u3002\u5728 Data channel \u4e0a\u4f20\u8f93\u7684\u7f13\u5b58\u884c\u5927\u5c0f\u662f 64 \u5b57\u8282\u3002</p> <p>CXL.cache \u7684\u7f13\u5b58\u884c\u72b6\u6001\u91c7\u7528\u7684\u662f MESI\u3002</p> <p>CXL.cache \u4f20\u8f93\u6709\u4e09\u79cd\u6a21\u5f0f\uff1a68B Flit\uff0c256B Flit \u548c PBR Flit\u3002</p> <p>H2D Request \u7684\u5b57\u6bb5\uff1a</p> <ul> <li>Valid</li> <li>Opcode</li> <li><code>Address[51:6]</code>: \u7269\u7406\u5730\u5740</li> <li>UQID: Unique Queue ID</li> <li>CacheID: Only in 256B Flit</li> <li>SPID/DPID: Only in PBR Flit</li> </ul> <p>D2H Response \u7684\u5b57\u6bb5\uff1a</p> <ul> <li>Valid</li> <li>Opcode</li> <li>UQID: Unique Queue ID</li> <li>DPID: Only in PBR Flit</li> </ul> <p>D2H Data \u7684\u5b57\u6bb5\uff1a</p> <ul> <li>Valid</li> <li>UQID: Unique Queue ID</li> <li>ChunkValid: Only in 68B Flit</li> <li>Bogus</li> <li>Poison: data is corrupted</li> <li>BEP: Only in 256B Flit &amp; PBR Flit</li> <li>DPID: Only in PBR Flit</li> </ul> <p>D2H Request \u7684\u5b57\u6bb5\uff1a</p> <ul> <li>Valid</li> <li>Opcode</li> <li>CQID: Command Queue ID</li> <li>NT: Non Temporal</li> <li>CacheID: Only in 256B Flit</li> <li>Address: 46 \u4f4d\u7269\u7406\u5730\u5740</li> <li>SPID/DPID: Only in PBR Flit</li> </ul> <p>H2D Response \u7684\u5b57\u6bb5\uff1a</p> <ul> <li>Valid</li> <li>Opcode</li> <li>RspData</li> <li>RSP_PRE</li> <li>CQID: Command Queue ID</li> <li>CacheID: Only in 256B Flit</li> <li>DPID: Only in PBR Flit</li> </ul> <p>H2D Data \u7684\u5b57\u6bb5\uff1a</p> <ul> <li>Valid</li> <li>CQID: Command Queue ID</li> <li>ChunkValid: Only in 68B Flit</li> <li>Bogus</li> <li>GO-Err</li> <li>CacheID: Only in 256B Flit</li> <li>DPID: Only in PBR Flit</li> </ul>"},{"location":"hardware/pcie/#_9","title":"\u8bf7\u6c42\u7c7b\u578b","text":"<p>\u9996\u5148\u8003\u8651 Host \u4f1a\u53d1\u9001\u7684\u8bf7\u6c42\u3002</p> <p>\u7b2c\u4e00\u79cd\u662f SnpData\uff0c\u4f8b\u5982\u5728 Host \u5728\u8bfb\u53d6\u7684\u65f6\u5019\u51fa\u73b0\u7f3a\u5931\uff0c\u6b64\u65f6\u9700\u8981\u5411 Device \u53d1\u9001 Snoop\uff0c\u83b7\u53d6\u6700\u65b0\u7684 Dirty \u7684 Data\uff0c\u6216\u8005\u8ba9 Device \u7684\u7f13\u5b58\u884c\u964d\u7ea7\u4e3a Shared \u72b6\u6001\u3002</p> <p>Device \u6536\u5230 SnpData \u540e\uff0c\u5982\u679c\u53d1\u73b0\u7f13\u5b58\u884c\u4e0d\u5728\u7f13\u5b58\u4e2d\uff08\u72b6\u6001\u662f I\uff09\uff0c\u4f1a\u56de\u590d\u4e00\u4e2a RspIHitI\uff1b\u5982\u679c\u7f13\u5b58\u884c\u5728\u7f13\u5b58\u4e2d\u4e14\u6570\u636e\u6ca1\u6709\u4fee\u6539\uff08\u72b6\u6001\u662f S \u6216\u8005 E\uff09\uff0c\u964d\u7ea7\u5230 S\uff0c\u4f1a\u56de\u590d\u4e00\u4e2a RspSHitSE\uff1b\u5982\u679c\u7f13\u5b58\u884c\u662f dirty\uff08\u72b6\u6001\u662f M\uff09\uff0c\u53ef\u4ee5\u9009\u62e9\u964d\u7ea7\u5230 S\uff0c\u7136\u540e\u56de\u590d RspSFwdM \u4ee5\u53ca\u7f13\u5b58\u884c\u7684\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u53d8\u6210 Invalid\uff0c\u56de\u590d RspIFwdM \u4ee5\u53ca\u7f13\u5b58\u884c\u7684\u6570\u636e\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e9b D2H Response \u7684 Opcode \u7684\u540d\u5b57\u683c\u5f0f\u5f88\u6709\u89c4\u5f8b\uff0c<code>Rsp+A+Hit/Fwd+B</code>\uff0cA \u8868\u793a\u65b0\u7684\u7f13\u5b58\u884c\u72b6\u6001\uff0cB \u662f\u539f\u6765\u7684\u7f13\u5b58\u884c\u72b6\u6001\uff0cHit \u4e0d\u9644\u5e26\u6570\u636e\uff0cFwd \u9644\u5e26\u6570\u636e\u3002</p> <p>\u7b2c\u4e8c\u79cd\u662f SnpInv\uff0c\u4f8b\u5982 Host \u8981\u5199\u5165\u7f13\u5b58\uff0c\u5c31\u8981 invalidate \u5176\u4ed6\u7f13\u5b58\u3002Device \u6536\u5230\u4ee5\u540e\uff0c\u53ef\u80fd\u8fd4\u56de RspIHitI\u3001RspIHitSE \u548c RspIFwdM\uff0c\u5206\u522b\u5bf9\u5e94\u4e0d\u540c\u7684\u521d\u59cb\u72b6\u6001\uff0c\u6700\u7ec8\u90fd\u662f Invalid \u6001\u3002</p> <p>\u7b2c\u4e09\u79cd\u662f SnpCur\uff0c\u83b7\u53d6\u5f53\u524d\u7684\u7f13\u5b58\u884c\u72b6\u6001\u3002Device \u53ef\u4ee5\u4fee\u6539\u7f13\u5b58\u884c\u72b6\u6001\uff0c\u4f46\u662f\u4e0d\u5efa\u8bae\u3002\u53ef\u80fd\u7684\u8fd4\u56de\u6709 RspIHitI\uff0cRspVHitV\uff0cRspSHitSE\uff0cRspSFwdM\uff0cRspIFwdM \u548c RspVFwdV\u3002\u8fd9\u91cc\u7684 V \u8868\u793a Valid\uff0c\u5bf9\u5e94 MESI \u4e2d\u7684 MES \u4e09\u79cd\u72b6\u6001\u3002\u6240\u4ee5\u5982\u679c\u7f13\u5b58\u884c\u72b6\u6001\u4e0d\u53d8\u7684\u8bdd\uff0c\u5c31\u662f RspIHitI\uff0cRspVHitV \u548c RspVFwdV \u4e09\u79cd\u54cd\u5e94\u3002</p> <p>\u518d\u8003\u8651 Device \u4f1a\u53d1\u9001\u7684\u8bf7\u6c42\u3002\u9996\u5148\uff0c\u8bf7\u6c42\u53ef\u4ee5\u5206\u4e3a\u56db\u7c7b\uff1a</p> <ol> <li>Read\uff1a\u53d1\u9001 D2H Request\uff0c\u63a5\u6536 H2D Response \u548c H2D Data</li> <li>Read0\uff1a\u53d1\u9001 D2H Request\uff0c\u63a5\u6536 H2D Response</li> <li>Write\uff1a\u53d1\u9001 D2H Request\uff0c\u63a5\u6536 H2D Response\uff0c\u53d1\u9001 D2H Data\uff0c\u53ef\u9009\u63a5\u6536 H2D Response</li> <li> <p>Read0-Write\uff1a\u53d1\u9001 D2H Request\uff0c\u63a5\u6536 H2D Response\uff0c\u53d1\u9001 D2H Data</p> </li> <li> <p>RdCurr(Read)\uff0cDevice \u8bfb\u53d6 Host \u7684\u7f13\u5b58\u884c\uff0c\u4e0d\u9020\u6210\u4efb\u4f55\u7684\u7f13\u5b58\u72b6\u6001\u7684\u4fee\u6539\u3002Device \u7f13\u5b58\u8fd8\u662f\u5904\u4e8e Invalid \u72b6\u6001\u3002</p> </li> <li>RdOwn(Read)\uff0cDevice \u8bfb\u53d6 Host \u7684\u7f13\u5b58\u884c\uff0c\u53ef\u4ee5\u8fdb\u5165 E \u6001\u6216\u8005 M \u6001\u3002Host \u54cd\u5e94 GO-Err/GO-I/GO-E/GO-M\u3002</li> <li>RdShared(Read)\uff0cDevice \u8bfb\u53d6 Host \u7684\u7f13\u5b58\u884c\uff0c\u8fdb\u5165 S \u6001\u3002Host \u54cd\u5e94 GO-Err/GO-I/GO-S\u3002</li> <li>RdAny(Read)\uff0cDevice \u8bfb\u53d6 Host \u7684\u7f13\u5b58\u884c\uff0c\u8fdb\u5165 M \u6001\uff0cE \u6001\u6216 S \u6001\u3002Host \u54cd\u5e94 GO-Err/GO-I/GO-S/GO-E/GO-M\u3002</li> <li>RdOwnNoData(Read0)\uff0cDevice \u4e0d\u8bfb\u53d6\u73b0\u5728\u7f13\u5b58\u884c\u7684\u6570\u636e\uff0c\u8fdb\u5165 E \u6001\u3002\u4e00\u822c\u7528\u4e8e\u6574\u4e2a\u7f13\u5b58\u884c\u7684\u6570\u636e\u90fd\u8981\u66f4\u65b0\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u6216\u8bb8\u5f53\u524d\u7f13\u5b58\u884c\u7684\u6570\u636e\u3002</li> <li>ItoMWr(Read0-Write)\uff0cDevice \u5199\u5165\u65b0\u7684\u5b8c\u6574\u7f13\u5b58\u884c\u5230 Host \u4e2d\uff0c\u5e76\u4e14\u8fdb\u5165 M \u6001\u3002Host \u54cd\u5e94 GO_WritePull/GO_ERR_WritePull\u3002</li> <li>WrCur(Read0-Write)\uff0c\u548c ItoMWr \u57fa\u672c\u4e00\u6837\uff0c\u533a\u522b\u5728\u4e8e\uff0c\u5982\u679c\u7f13\u5b58\u884c\u547d\u4e2d\u4e86\uff0c\u5c31\u5199\u5165\u5230\u7f13\u5b58\u4e2d\uff1b\u5982\u679c\u7f3a\u5931\u4e86\uff0c\u5c31\u5199\u5165\u5230\u5185\u5b58\u4e2d\u3002Host \u54cd\u5e94 GO_WritePull/GO_ERR_WritePull\u3002</li> <li>CLFlush(Read0)\uff0c\u8981\u6c42 Host Invalidate \u4e00\u4e2a\u7f13\u5b58\u884c\u3002Host \u54cd\u5e94 GO-Err/GO-I\u3002</li> <li>CleanEvict(Write)\uff0cDevice \u8981 Evict \u4e00\u4e2a Exclusive \u7684\u7f13\u5b58\u884c\u3002Host \u54cd\u5e94 GO_WritePull/GO_WritePull_Drop\u3002</li> <li>DirtyEvict(Write)\uff0cDevice \u8981 Evict \u4e00\u4e2a Modified \u7684\u7f13\u5b58\u884c\u3002Host \u54cd\u5e94 GO_WritePull/GO_ERR_WritePull\u3002</li> <li>CleanEvictNoData(Write)\uff0cDevice \u8981 Evict \u4e00\u4e2a Exclusive \u7684\u7f13\u5b58\u884c\uff0c\u4f46\u662f\u4e0d\u4f20\u8f93\u6570\u636e\uff0c\u53ea\u7528\u4e8e\u66f4\u65b0 Snoop Filter\u3002Host \u54cd\u5e94 GO-I\u3002</li> <li>WrInv(Write)\uff0cWrite Invalidate Line\uff0c\u5411 Host \u5199\u5165 0-64 \u5b57\u8282\u7684\u6570\u636e\uff0c\u5e76\u4e14 Invalidate \u7f13\u5b58\u3002Host \u54cd\u5e94 WritePull/GO-Err/GO-I\u3002</li> <li>WOWrInv(Write)\uff0cWeakly Ordered \u7248\u672c\u7684 WrInV\uff0c\u5199\u5165 0-63 \u5b57\u8282\u7684\u6570\u636e\u3002Host \u54cd\u5e94 ExtCmp/FastGO_WritePull/GO_ERR_WritePull\u3002</li> <li>WOWrInvF(Write)\uff0cWeakly Ordered \u7248\u672c\u7684 WrInv\uff0c\u5199\u5165 64 \u5b57\u8282\u7684\u6570\u636e\u3002Host \u54cd\u5e94 ExtCmp/FastGO_WritePull/GO_ERR_WritePull\u3002</li> <li>CacheFlushed(Read0)\uff0c\u544a\u8bc9 Host \u81ea\u5df1\u7684\u7f13\u5b58\u90fd\u88ab\u6e05\u7a7a\u4e86\uff0c\u6240\u6709\u7f13\u5b58\u884c\u90fd\u5728 I \u72b6\u6001\u3002Host \u54cd\u5e94 GO-I\u3002</li> </ol>"},{"location":"hardware/pcie/#_10","title":"\u548c\u5176\u4ed6\u534f\u8bae\u7684\u5bf9\u6bd4","text":"<p>\u5728 \u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae \u4e2d\u5206\u6790\u8fc7 TileLink \u7684\u7f13\u5b58\u4e00\u81f4\u6027\u5b9e\u73b0\u65b9\u6cd5\uff0c\u5982\u679c\u67d0\u4e00\u4e2a\u7f13\u5b58\uff08Master A\uff09\u51fa\u73b0\u4e86\u7f3a\u5931\uff0c\u9700\u8981\u7ecf\u8fc7\u5982\u4e0b\u7684\u8fc7\u7a0b\uff1a</p> <ul> <li>Master A -&gt; Slave: Acquire</li> <li>Slave -&gt; Master B: Probe</li> <li>Master B -&gt; Slave: ProbeAck</li> <li>Slave -&gt; Master A: Grant</li> <li>Master A -&gt; Slave: GrantAck</li> </ul> <p>\u5728 TileLink Cached \u91cc\u9762\uff0c\u6240\u6709\u7684 Master \u90fd\u662f\u5e73\u7b49\u7684\u3002\u800c\u5728 CXL \u4e2d\uff0c\u9700\u8981\u7ef4\u62a4\u7f13\u5b58\u4e00\u81f4\u6027\u7684\uff0c\u6709 CPU \u5185\u90e8\u7684\u5404\u4e2a\u7f13\u5b58\u4e4b\u95f4\uff0c\u8fd8\u6709 CPU \u548c\u8bbe\u5907\u4e4b\u95f4\u3002\u800c CXL.cache \u4e3b\u8981\u8d1f\u8d23\u7684\u662f\u4e0e\u8bbe\u5907\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u90e8\u5206\uff0c\u7ef4\u62a4\u7f13\u5b58\u4e00\u81f4\u6027\u7684\u6838\u5fc3\u662f\u5728 CPU \u4e00\u4fa7\uff0cHost \u76f8\u5f53\u4e8e TileLink \u7684 Slave\uff0cDevice \u76f8\u5f53\u4e8e TileLink \u7684 Master A\u3002\u53ef\u4ee5\u8bf4 CXL.cache \u662f\u4e0d\u5bf9\u79f0\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u3002</p> <p>\u4f8b\u5982 CXL \u4e2d\u8bbe\u5907\u8bfb\u53d6\u7f13\u5b58\u7684\u65f6\u5019\uff0c\u51fa\u73b0\u4e86\u7f3a\u5931\uff0c\u90a3\u4e48\u9700\u8981\u7ecf\u8fc7\u5982\u4e0b\u7684\u8fc7\u7a0b\uff1a</p> <ul> <li>Device -&gt; Host: RdShared/RdOwn</li> <li>Host -&gt; CPU Caches: Custom Snoop Messages</li> <li>Host -&gt; Other CXL Device: SnpData</li> <li>Other CXL Device -&gt; Host: RspSHitSE/RspSFwdM</li> <li>Host -&gt; Device: GO-S</li> </ul> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6574\u4f53\u7684\u6d41\u7a0b\u4e5f\u662f\u5dee\u4e0d\u591a\u7684\u3002</p>"},{"location":"hardware/pcie/#cxlmem","title":"CXL.mem","text":"<p>CXL.mem \u7528\u4e8e\u6269\u5c55\u5185\u5b58\uff0c\u6839\u636e\u7c7b\u578b\u7684\u4e0d\u540c\uff0c\u5b83\u53ef\u80fd\u5355\u72ec\u4f7f\u7528\uff0c\u4e5f\u53ef\u80fd\u548c CXL.cache \u914d\u5408\u4f7f\u7528\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u6709\u4e09\u79cd\u4e00\u81f4\u6027\u6a21\u578b\uff1a</p> <ol> <li>HDM-H(Host-only Coherent)\uff1a\u4ec5 Type 3 \u8bbe\u5907\uff0c\u4e5f\u5c31\u662f\u65e0 CXL.cache</li> <li>HDM-D(Device Coherent)\uff1a\u4ec5 Legacy Type 2 \u8bbe\u5907\uff0c\u4e5f\u5c31\u662f\u6709 CXL.cache</li> <li>HDM-DB(Device Coherent using Back-Invalidation)\uff1aType 2 \u6216 Type 3 \u8bbe\u5907</li> </ol> <p>\u5728 CXL.cache \u4e2d\uff0c\u4e24\u7aef\u662f Host \u548c Device\uff1b\u800c CXL.mem\uff0c\u4e24\u7aef\u662f Master \u548c Subordinate\u3002</p> <p>\u4ece Master \u5230 Subordinate \u7684\u6d88\u606f\uff08M2S\uff09\u6709\u4e09\u7c7b\uff1a</p> <ol> <li>Request(Req)</li> <li>Request with Data(RwD)</li> <li>Back-Invalidation Response(BIRsp)</li> </ol> <p>\u4ece Subordinate \u5230 Master \u7684\u6d88\u606f\uff08S2M\uff09\u6709\u4e09\u7c7b\uff1a</p> <ol> <li>Response without data(NDR, No Data Response)</li> <li>Response with Data(DRS, Data Response)</li> <li>Back-Invalidation Snoop(BiSnp)</li> </ol> <p>\u5176\u4e2d\u6bd4\u8f83\u7279\u522b\u7684\u662f Back-Invalidation\uff0c\u8fd9\u4e2a\u7684\u76ee\u7684\u662f\u8ba9 Device \u53ef\u4ee5\u901a\u8fc7 Snoop \u4fee\u6539 Host \u4e2d\u7f13\u5b58\u4e86 Device \u5185\u5b58\u4e2d\u7684\u6570\u636e\u7684\u7f13\u5b58\u884c\u3002</p> <p>\u5bf9\u4e8e Type 3 \u7684\u8bbe\u5907\uff08\u65e0 CXL.cache\uff09\u6765\u8bf4\uff0cDevice \u5c31\u662f\u4e00\u4e2a\u6269\u5c55\u7684\u5185\u5b58\uff0c\u6bd4\u8f83\u7b80\u5355\uff0c\u53ea\u9700\u8981\u652f\u6301\u8bfb\u5199\u5185\u5b58\u5c31\u53ef\u4ee5\u4e86\u3002Host \u53d1\u9001 <code>MemRd*</code>\uff0cDevice \u54cd\u5e94 MemData\uff1bHost \u53d1\u9001 <code>MemWr*</code>\uff0cDevice \u54cd\u5e94 Cmp\u3002</p> <p>\u5bf9\u4e8e Type 2 \u7684\u8bbe\u5907\uff08\u6709 CXL.cache\uff09\u6765\u8bf4\uff0cDevice \u65e2\u6709\u81ea\u5df1\u7684\u7f13\u5b58\uff0c\u53c8\u6709\u81ea\u5df1\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u8fd9\u65f6\u5019\u5c31\u6bd4\u8f83\u590d\u6742\u4e86\u3002\u4f8b\u5982 Host \u5728\u8bfb\u53d6\u6570\u636e\u7684\u65f6\u5019\uff08MemRd\uff0cSnpData/SnpInv/SnpCur\uff09\uff0c\u8fd8\u9700\u8981\u5bf9 Device Cache \u8fdb\u884c Snoop\uff08SnpData/SnpInv/SnpCur\uff09\uff0c\u4fdd\u8bc1\u7f13\u5b58\u7684\u4e00\u81f4\u6027\u3002Host \u60f3\u8981\u5199\u5165\u6570\u636e\u5230 Device Memory \u7684\u65f6\u5019\uff0c\u5982\u679c\u6b64\u65f6 Device Cache \u4e2d\u6709 Dirty \u6570\u636e\uff0c\u9700\u8981\u8fdb\u884c\u5199\u5408\u5e76\uff0c\u518d\u628a\u5408\u5e76\u540e\u7684\u6570\u636e\u5199\u5165\u5230 Device Memory\u3002\u5f53 Device \u60f3\u8981\u4ece\u81ea\u5df1\u7684\u7f13\u5b58\u8bfb\u53d6\u6570\u636e\uff0c\u53c8\u7f3a\u5931\u7684\u65f6\u5019\uff0c\u9996\u5148\u9700\u8981\u5224\u65ad\u6570\u636e\u5728 Host \u7aef\u7684\u7f13\u5b58\u4e2d\uff0c\u8fd8\u662f\u5728 Device Memory \u4e2d\uff0c\u4e0d\u540c\u7684\u504f\u7f6e\uff08Bias\uff09\u6a21\u5f0f\u51b3\u5b9a\u4e86\u6570\u636e\u5e94\u8be5\u653e\u5728 Host \u8fd8\u662f Device \u7684\u7f13\u5b58\u4e0a\u3002Device \u8981\u5199\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u5982\u679c Host \u4e2d\u7f13\u5b58\u4e86\u8be5\u7f13\u5b58\u884c\uff0c\u5219\u9700\u8981 Back-Invalidation\u3002\u4e3a\u4e86\u652f\u6301\u8fd9\u4e9b\u573a\u666f\uff0cCXL.cache \u548c CXL.mem \u4f1a\u6bd4\u8f83\u590d\u6742\u3002</p>"},{"location":"hardware/pcie/#_11","title":"\u63a8\u8350\u9605\u8bfb","text":"<ul> <li>LogicJitterGibbs \u8d44\u6599\u6574\u7406\uff1a\u53ef\u4ee5\u5b66\u4e60 1W \u5c0f\u65f6\u7684 PCIe</li> <li>intel \u90e8\u5206\u684c\u9762\u7ea7 CPU \u7684 pcie \u901a\u9053\u62c6\u5206\u53e6\u7c7b\u4f4e\u6210\u672c\u5b9e\u73b0</li> <li>Intel Alder Lake 12 \u4ee3\u9177\u777f CPU PCIe \u62c6\u5206\u5b9e\u73b0\u65b9\u6cd5</li> <li>CXL\u5b66\u4e60\uff08\u4e00\uff09</li> <li>CXL\u5b66\u4e60\uff08\u4e8c\uff09</li> <li>CXL\u5b66\u4e60\uff08\u4e09\uff09</li> <li>CXL\u5b66\u4e60\uff08\u56db\uff09</li> <li>CXL\u5b66\u4e60\uff08\u4e94\uff09</li> <li>CXL\u5b66\u4e60\uff08\u516d\uff09</li> <li>CXL\u5b66\u4e60\uff08\u4e03\uff09</li> <li>CXL\u5b66\u4e60\uff08\u516b\uff09</li> <li>CXL\u5b66\u4e60\uff08\u4e5d\uff09</li> <li>CXL\u5b66\u4e60\uff08\u5341\uff09</li> <li>CXL\u5b66\u4e60\uff08\u5341\u4e00\uff09</li> <li>CCIX(\u4e00)</li> </ul>"},{"location":"hardware/sdram.en/","title":"SDRAM","text":""},{"location":"hardware/sdram.en/#features","title":"Features","text":"<p>SDRAM features:</p> <ol> <li>low cost, each 1 bit cell requires only one CMOS transistor</li> <li>complex interface, you need to activate a row before accessing data, and then read the data in the row</li> <li>the controller is also complex and requires periodic memory refreshing</li> <li>large capacity, because the row and column multiplexed address lines, a single memory module can achieve GB level capacity</li> </ol>"},{"location":"hardware/sdram.en/#standards","title":"Standards","text":"<p>SDRAM-related standards are developed by JEDEC:</p> <ul> <li>JESD79F: DDR SDRAM</li> <li>JESD79-2F: DDR2 SDRAM</li> <li>JESD79-3F: DDR3 SDRAM</li> <li>JESD79-4D: DDR4 SDRAM</li> <li>JESD79-5B: DDR5 SDRAM</li> </ul> <p>In addition to the DDR series, there is also a low-power LPDDR series:</p> <ul> <li>JESD209B: LPDDR SDRAM</li> <li>JESD209-2F: LPDDR2 SDRAM</li> <li>JESD209-3C: LPDDR3 SDRAM</li> <li>JESD209-4D: LPDDR4 SDRAM</li> <li>JESD209-5B: LPDDR5 SDRAM</li> </ul> <p>High-performance HBM is also based on SDRAM technology:</p> <ul> <li>JESD235D: HBM</li> <li>JESD238A: HBM3</li> </ul> <p>GDDR SGRAM series:</p> <ul> <li>SDRAM3.11.5.8 R16.01: GDDR4 SGRAM</li> <li>JESD212C.01: GDDR5 SGRAM</li> <li>JESD232A.01: GDDR5X SGRAM</li> <li>JESD250D: GDDR6 SGRAM</li> </ul> <p>The following is an introduction to DDR series SDRAM.</p>"},{"location":"hardware/sdram.en/#concepts","title":"Concepts","text":"<p>DDR SDRAM is often given a number to represent its performance, such as 2133 for DDR4-2133, and sometimes you will see the term 2400 MT/s. Both refer to the maximum number of data transfers per second that SDRAM can perform in millions of transfers per second. Since SDRAM uses DDR to transfer two copies of data per clock cycle, the actual clock frequency is divided by two, so 2133 MT/s corresponds to a clock frequency of 1066 MHz.</p> <p>Sometimes you will also see PC4-21333 written to describe memory sticks, where 21333 = 8*2666, which is 2666 MT/s, multiplied by 8 because the data bit width of a DDR memory module is 64 bits, so the theoretical memory bandwidth of a 2666 MT/s memory stick is 2666 \\mathrm{(MT/s)} * 64 \\mathrm{(bits)} / 8 \\mathrm{(bits/byte)} = 21333 \\mathrm{(MB/s)}. But there are times when PC4 is followed by MT/s.</p> <p>Different generations of memory modules have different locations for the notches on the bottom pins, so it is impossible to insert them in the wrong place.</p>"},{"location":"hardware/sdram.en/#structure","title":"Structure","text":"<p>Taking DDR4 SDRAM as an example, the following is the structure of the MT40A1G8 chip:</p>    ![](sdram_ddr4_micron_1g8_diagram.png){ width=\"800\" }   Block diagram of MT40A1G8 (Source Micron Datasheet) <p>Each memory array is 65536 x 128 x 64, called a Bank; four Banks form a Bank Group, and there are 4 Bank Groups, so the total capacity is 65536 * 128 * 64 * 4 * 4 = 8 \\mathrm{Gb}.</p> <p>Specifically, in the 65536 x 128 x 64 specification of each memory array, 65536 represents the number of rows, each row holds 128 * 64 = 8192 bits of data, and is also the bit width of the transfer between <code>Sense amplifier</code> and <code>I/O gating, DM mask logic</code> in Figure 1. Each row has 1024 columns, and each column holds 8 bits of data (corresponding to the 8 in <code>1 Gig x 8</code>). Since the DDR4 prefetch width is 8n, an access takes out 8 columns of data, or 64 bits. So each row has 128 of 64 bits, which is the source of the 128 x 64 in the 65536 x 128 x 64 above.</p>"},{"location":"hardware/sdram.en/#prefetch","title":"Prefetch","text":"<p>SDRAM has the concept of prefetch, which is how many times the bit width of the data is fetched out in one read. For example, the <code>1 Gig x 8</code> SDRAM above has an I/O data bit width of 8 bits (see the <code>DQ</code> signal on the right). This is because the IO frequency of DDR4 SDRAM is very high, e.g. 3200 MT/s corresponds to an I/O clock frequency of 1600 MHz, while the actual memory array frequency is not as high. The actual memory array frequency is that high, but operates at 400 MHz, so to make up for the difference in frequency, the data is read 8 times the bit width at a time. This is reflected in the I/O, which is a single read operation to get 8 copies of data, i.e. burst length of 8, which is transferred in four clock cycles via DDR.</p> <p>Interestingly, DDR4 memory modules are 64 bits wide, so a single read operation yields 64 * 8 / 8 = 64B of data, which is exactly the size of the CPU cache lines.</p> <p>DDR5 increases the prefetch to 16n, which is why you see much larger data rate numbers for DDR5: DDR4 prefetch is 8n, DDR5 prefetch is 16n at the same memory array frequency, so the I/O frequency is doubled and the data rate is doubled. At the same time, in order to maintain the burst size of 64 bytes, the bit width of each channel in DDR5 module is 32 bits, each memory module provides two channels.</p>"},{"location":"hardware/sdram.en/#access-patterns","title":"Access Patterns","text":"<p>SDRAM has a special access pattern in that its memory array can only be accessed in complete rows at a time. In the previous example, a row has 8192 bits of data, but a read or write operation involves only 64 bits of data, so a read operation requires:</p> <ol> <li>the first step is to retrieve the entire row where the data is located</li> <li>in the second step, read the desired data in the row</li> </ol> <p>But each bank can only take out one row at a time, so if the two reads involve different rows, then you need to:</p> <ol> <li>the first step is to take out the whole row where the data of the first read is located</li> <li>in the second step, read the desired data in the row</li> <li>step 3, put the first read row back</li> <li>step 4, take out the whole row where the data of the second read is located</li> <li>step 5, read the desired data in the row</li> </ol> <p>In SDRAM terms, the first and fourth steps are called Activate, the second and fifth steps are called Read, and the third step is called Precharge.</p> <p>SDRAM defines the following timing parameters that describe the timing requirements between these three operations:</p> <ol> <li>CL (CAS Latency): the time between sending a read request and outputting the first data</li> <li>RCD (ACT to internal read or write delay time): the time from Activate to the next read or write request</li> <li>RP (RRE command period): the time between sending a Precharge command and the next command</li> <li>RAS (ACT to PRE command period): the time between Activate and Precharge</li> <li>RC (ACT to ACT or REF command period): the time between Activate and the next Activate or Refresh</li> <li>RTP (Internal READ Command to PRECHARGE command delay): the time between Read and Precharge</li> </ol> <p>So the above process requires the following time requirements:</p> <ol> <li>the first step, Activate, take out the first row</li> <li>the second step, Read, the time between the first and second steps should be separated by RCD, and the time to wait for CL from Read to send address to get data</li> <li>step 3, Precharge, the time between step 1 and step 3 should be separated by RAS, and the time between step 2 and step 3 should be separated by RTP</li> <li>step 4, Activate, take out the second row, the time between step 1 and step 4 should be separated by RC, and the time between step 3 and step 4 should be separated by RP</li> <li>step 5, Read, the time between step 4 and step 5 should be separated by RCD, the time to wait for CL from Read to send address to get data</li> </ol> <p>Based on this process, the following conclusions can be drawn:</p> <ol> <li>accessing data with locality will have better performance, requiring only continuous Read, reducing the number of activates and precharges</li> <li>constantly accessing data from different rows will lead to a back and forth Activate, Read, Precharge cycle</li> <li>accessing the row and accessing the data in the row are divided into two phases, and both phases can use the same address signals, making the total memory capacity large</li> <li>if the access always hits the same row, the transfer rate can be close to the theoretical one, as shown in Figure 2</li> </ol>    ![](sdram_ddr3_consecutive_read.png){ width=\"800\" }   DDR3 Sequential Reads within the Same Row (Source JESD9-3F DDR3) <p>To alleviate the performance loss caused by the second point, the concept of Bank is introduced: each Bank can take out a row, so if you want to access the data in different Banks, while the first Bank is doing Activate/Precharge, the other Banks can do other operations, thus covering the performance loss caused by row misses.</p>"},{"location":"hardware/sdram.en/#bank-group","title":"Bank Group","text":"<p>DDR4 introduces the concept of Bank Group compared to DDR3. Quoting Is the time of page hit in the same bank group tccd_S or tccd_L?, memory array frequency is increased compared to DDR3, so a perfect sequential read cannot be achieved within the same row, i.e. two adjacent read operations need to be separated by 5 cycles, while each read transfers 4 cycles of data with a maximum utilization of 80%, see the following figure:</p>    ![](sdram_ddr4_nonconsecutive_read.png){ width=\"800\" }   DDR4 Nonconsecutive Reads (Source JESD9-4D DDR4) <p>In order to solve this bottleneck, the difference of DDR4 in the core part is that there is an additional <code>Global I/O gating</code>, and each Bank Group has its own <code>I/O gating, DM mask logic</code>, the following draws the storage part of DDR3 and DDR4 respectively, for comparison:</p>    ![](sdram_ddr3_array.png){ width=\"400\",align=\"left\" }   DDR3 SDRAM Storage Part (Source Micron Datasheet)    ![](sdram_ddr4_array.png){ width=\"400\" }   DDR4 SDRAM Storage Part (Source Micron Datasheet) <p>This means that DDR4 can have multiple Bank Groups reading at the same time and pipelining the output. For example, if the first Bank Group reads the data and finishes transferring it in four cycles on the I/O, immediately the second Bank Group read picks up and transfers another four cycles of data, with the following waveform:</p>    ![](sdram_consecutive_read.png){ width=\"800\" }   DDR4 Consecutive Reads from Different Banks (Source JESD9-4D DDR4) <p>In the above figure, the first read request is initiated at time T0, the second request is initiated at time T4, T11-T15 get the data of the first request, followed by T15-T19 get the data of the second request. This solves the problem caused by the increased frequency.</p>"},{"location":"hardware/sdram.en/#storage-hierarchy","title":"Storage Hierarchy","text":"<p>As mentioned above, the hierarchy within DDR SDRAM, from largest to smallest, is as follows</p> <ol> <li>Bank Group: introduced in DDR4</li> <li>Bank: Each Bank has only one Row activated at the same time</li> <li>Row: Activate/Precharge unit</li> <li>Column: each Column holds n cells, n is the bit width of SDRAM</li> <li>Cell: each cell holds 1 bit of data</li> </ol> <p>In fact, there are several layers outside the SDRAM:</p> <ol> <li>Channel: the number of channels of the processor's memory controller</li> <li>Module: there can be multiple memory sticks connected to the same Channel</li> <li>Rank: multiple DDR SDRAM chips are stitched together in width, one to four Ranks can be put down on a Module. these Ranks share the bus, each Rank has its own chip select signal CS_n, which is actually stitching SDRAM chips in depth</li> <li>Chip: A DDR SDRAM chip; such as a 64-bit wide Rank, is made by using 8 x8 chips stitched together across the width</li> </ol> <p>As you can see, adjacent memory levels differ by a power of two, so the mapping from the memory address to these levels is an interception of different intervals in the address, each corresponding to a subscript of the level. This is why the MB and GB units of memory size are 1024-based.</p> <p>If you study SDRAM memory controllers, such as MIG on Xilinx FPGA, one can find that it can be configured with different address mapping methods, e.g:</p> <ul> <li>ROW_COLUMN_BANK</li> <li>ROW_BANK_COLUMN</li> <li>BANK_ROW_COLUMN</li> <li>ROW_COLUMN_LRANK_BANK</li> <li>ROW_LRANK_COLUMN_BANK</li> <li>ROW_COLUMN_BANK_INTLV</li> </ul> <p>As you can imagine, different address mapping methods will have different performance for different access modes. For sequential memory accesses, the ROW_COLUMN_BANK method is more suitable, because sequential accesses are distributed to different banks, so the performance will be better.</p>"},{"location":"hardware/sdram.en/#interface","title":"Interface","text":"<p>The following pins are drawn for DDR3 and DDR4:</p>    ![](sdram_pinout.png){ width=\"600\" }   DDR3 and DDR4 Schematics <p>The differences between DDR3 and DDR4:</p> <ol> <li>address signal: DDR3 has A0-A14, DDR4 has A0-A17, where A14-A16 are multiplexed pins</li> <li>DDR4 introduces Bank Group, so there are extra pins BA0-BA1.</li> <li>RAS_n, CAS_n and WE_n in DDR3 are reused as A14-A16 in DDR4</li> <li>DDR4 adds an additional ACT_n control signal</li> </ol>"},{"location":"hardware/sdram.en/#topology","title":"Topology","text":"<p>In order to obtain a larger bit width, many SDRAM chips can be seen on the memory modules, which are stitched together by width to form a 64-bit data width. At this point, from the PCB alignment point of view, the data lines are directly connected to each SDRAM chip and can be connected relatively easily; however, other signals, such as address and control signals, need to be connected to all SDRAM chips, and it is difficult to ensure equal distances to each SDRAM chip while ensuring signal integrity in the confined space.</p>"},{"location":"hardware/sdram.en/#fly-by-topology","title":"Fly-by topology","text":"<p>Therefore, the address and control signals are actually connected in series (Fly-by-topology), which is the connection on the right in the following figure:</p>    ![](sdram_topology.png){ width=\"600\" }   Two types of signal connections for SDRAM (Source Versal ACAP PCB Design User Guide (UG863)) <p>But the data signals (DQ, DQS and DM) are still connected point-to-point to the SDRAM in parallel (left side of the figure above). This presents a problem: with different SDRAM chips, the data and clock deviations are different, and the data may arrive at about the same time, but the clock has an increasing delay:</p> <pre><code>{\n  signal:\n    [\n      { name: \"clock\", wave: \"1010101010\"},\n      { name: \"data\", wave: \"01.0..101.\"},\n      { name: \"clock_dram0\", wave: \"1010101010\", phase: -0.2},\n      { name: \"data_dram0\", wave: \"01.0..101.\", phase: -0.1},\n      { name: \"clock_dram1\", wave: \"1010101010\", phase: -0.4},\n      { name: \"data_dram1\", wave: \"01.0..101.\", phase: -0.1},\n      { name: \"clock_dram2\", wave: \"1010101010\", phase: -0.6},\n      { name: \"data_dram2\", wave: \"01.0..101.\", phase: -0.1},\n      { name: \"clock_dram3\", wave: \"1010101010\", phase: -0.8},\n      { name: \"data_dram3\", wave: \"01.0..101.\", phase: -0.1},\n    ]\n}\n</code></pre> SDRAM Clock Skewing Problem <p>In order for SDRAMs at different locations to see the same waveform, a variable delay needs to be added to the data signal on the memory controller side, and this delay needs to be calibrated to know what it is.</p>"},{"location":"hardware/sdram.en/#clam-shell-topology","title":"Clam-shell topology","text":"<p>In addition to Fly-by topology, Clam-shell topology may be used in some scenarios to save PCB area. Clam-shell is actually a visual representation of having SDRAM chips on both the front and back sides of the PCB:</p>    ![](sdram_clam_shell.png){ width=\"400\" }   Clam-shell Topology (Source Versal ACAP Programmable Network on Chip and Integrated Memory Controller LogiCORE IP Product Guide (PG313) ) <p>This design makes use of the space on the back of the PCB, but it also brings new problems: intuitively, if both chips are placed on the front of the PCB, it is easier to connect them if the pin order is close to the same, and there will not be many crossings. However, if one is on the front and the other on the back, the pin order is reversed and it is more difficult to connect.</p> <p>The solution is to modify the order of the pins and swap the functions of some pins to make the alignment simpler:</p>    ![](sdram_pin_mirror.png){ width=\"600\" }   SDRAM Pin Mirroring (SourceVersal ACAP PCB Design User Guide (UG863)) <p>The table deliberately selects pins to swap that do not affect special functions, making most functions, even with swapped pins, work properly. For example, if the Row address is swapped by a few bits, it does not affect reading or writing data, although the physical storage place is changed. However, for Mode Register Set operations, the memory controller must swap the order of the bits itself and swap them back when connecting on the PCB to ensure the correct result on the SDRAM side.</p> <p>In addition, Clam-shell Topology has one cs_n chip select signal on the front and one on the back, but this is different from Dual Rank: Dual Rank has the same number of DRAM chips on both front and back, sharing the address, data and control signals, and only one side of the DRAM chips on the bus is in use at the same time, which has the advantage of doubling the memory capacity. The advantage is that the memory capacity is doubled and the two ranks can mask each other's latency; while the two cs_n of Clam Shell Topology are designed to assign either front or back side to Mode Register Set operations, while most of the rest of the operations can work on both front and back sides at the same time because their data signals are not shared.</p>"},{"location":"hardware/sdram.en/#calibration","title":"Calibration","text":"<p>SDRAM calibration, or SDRAM training, mainly consists of the following steps:</p> <ol> <li>Write Leveling</li> <li>Read Leveling</li> </ol>"},{"location":"hardware/sdram.en/#write-leveling","title":"Write Leveling","text":"<p>Write Leveling addresses the problem of inconsistent latency caused by Fly-by-Topology, which causes SDRAM to see the wrong signal. Specifically, the purpose of Write Leveling is to synchronize the DQS signal received by the SDRAM chip with the CK signal:</p> <pre><code>{\n  signal:\n    [\n      { name: \"ck\", wave: \"1010101010\"},\n      { name: \"dqs\", wave: \"0.101010..\"},\n      { name: \"ck_dram0\", wave: \"1010101010\", phase: -0.2},\n      { name: \"dqs_dram0\", wave: \"0.101010..\", phase: -0.2},\n      { name: \"ck_dram1\", wave: \"1010101010\", phase: -0.4},\n      { name: \"dqs_dram1\", wave: \"0.101010..\", phase: -0.4},\n      { name: \"ck_dram2\", wave: \"1010101010\", phase: -0.6},\n      { name: \"dqs_dram2\", wave: \"0.101010..\", phase: -0.6},\n      { name: \"ck_dram3\", wave: \"1010101010\", phase: -0.8},\n      { name: \"dqs_dram3\", wave: \"0.101010..\", phase: -0.8},\n    ]\n}\n</code></pre> DQS and CK synchronization to be achieved by Write Leveling <p>To achieve this, the idea is to continuously adjust the delay of the DQS output, observe the behavior at different delays, and find a delay value that synchronizes the DQS with the CK. In order to do Write Leveling with the memory controller, the SDRAM can enter a Write Leveling Mode, where the SDRAM samples the CK on the rising edge of the DQS and then outputs the result to the DQ. In this case, different DQS delays will result in different results:</p> <pre><code>{\n  signal:\n    [\n      { name: \"ck\", wave: \"1010101010\"},\n      { name: \"dqs\", wave: \"10........\"},\n      { name: \"ck_dram\", wave: \"1010101010\", phase: -0.2},\n      { name: \"dqs_delay0\", wave: \"010.......\", phase: -0.4},\n      { name: \"dq_delay0\", wave: \"0.........\", phase: -0.4},\n      { name: \"dqs_delay1\", wave: \"010.......\", phase: -0.9},\n      { name: \"dq_delay1\", wave: \"0.........\", phase: -0.9},\n      { name: \"dqs_delay2\", wave: \"010.......\", phase: -1.4},\n      { name: \"dq_delay2\", wave: \"01........\", phase: -1.4},\n      { name: \"dqs_delay3\", wave: \"010.......\", phase: -2.0},\n      { name: \"dq_delay3\", wave: \"01........\", phase: -2.0},\n    ]\n}\n</code></pre> Results of DQS sampling of CK with different DQS delays <p>In the above figure, for both delay0 and delay1, DQS samples the negative half-cycle of CK, while for delay2 and delay3, DQS samples the positive half-cycle of CK, so if you want to synchronize DQS with CK, you should set the DQS delay between delay1 and delay2.</p> <p>To summarize the Write Leveling algorithm:</p> <ol> <li>Set the SDRAM to Write Leveling mode, where the SDRAM will use DQS for CK and output the result to DQ</li> <li>The controller enumerates the latency of DQS, reads out the DQ results for each DQS latency, and gets a 0-1 string, for example: <code>00111111111111111111110000</code>, that is, as the latency increases, it samples to 0, then to 1, and finally to 0 again</li> <li>find a DQS delay that causes the DQ to change from 0 to 1, then the DQS will be synchronized with the CK according to this delayed output</li> <li>Set the SDRAM to end Write Leveling mode</li> </ol> <p>This process is performed separately for each DQS signal. The following is an example of litex's SDRAM calibration code to implement a simplified process in C code:</p> int sdram_write_leveling_scan(int *delays, int loops, int show)<pre><code>/* Turn on the Write Leveling mode of SDRAM */\nsdram_write_leveling_on();\n\n/* Loop each SDRAM module */\nfor(i=0;i&lt;SDRAM_PHY_MODULES;i++) {\n  /* Loop each DQS signal */\n  for (dq_line = 0; dq_line &lt; DQ_COUNT; dq_line++) {\n    /* Set initial DQS delay to 0 */\n    sdram_leveling_action(i, dq_line, write_rst_delay);\n\n    /* Loop each DQS delay */\n    for(j=0;j&lt;err_ddrphy_wdly;j++) {\n      int zero_count = 0;\n      int one_count = 0;\n\n      /* Sample in loop */\n      for (k=0; k&lt;loops; k++) {\n        /* Send DQS pulse\uff1a00000001 */\n        /* SDRAM sample CK */\n        ddrphy_wlevel_strobe_write(1);\n\n        cdelay(100);\n        /* Read DQ from memory controller */\n        csr_rd_buf_uint8(sdram_dfii_pix_rddata_addr(0), buf, DFII_PIX_DATA_BYTES);\n\n        /* Count the number of 1's and 0's */\n        if (buf[SDRAM_PHY_MODULES-1-i] != 0)\n          one_count++;\n        else\n          zero_count++;\n      }\n      if (one_count &gt; zero_count)\n        /* Consider that DQS samples the positive half-cycle of CK */\n        taps_scan[j] = 1;\n      else\n        /* Consider that DQS samples the negative half-cycle of CK */\n        taps_scan[j] = 0;\n\n      /* Increases the DQS delay  */\n      sdram_leveling_action(i, dq_line, write_inc_delay);\n    }\n\n    /* Find the longest sequence of consecutive 1's */\n    one_window_active = 0;\n    one_window_start = 0;\n    one_window_count = 0;\n    one_window_best_start = 0;\n    one_window_best_count = -1;\n    for(j=0;j&lt;err_ddrphy_wdly+1;j++) {\n      if (one_window_active) {\n        if ((j == err_ddrphy_wdly) || (taps_scan[j] == 0)) {\n          /* Ended a continuous sequence of 1's */\n          one_window_active = 0;\n          one_window_count = j - one_window_start;\n          /* Record the length and position of the longest consecutive 1's */\n          if (one_window_count &gt; one_window_best_count) {\n            one_window_best_start = one_window_start;\n            one_window_best_count = one_window_count;\n          }\n        }\n      } else {\n        /* Find the beginning of consecutive 1's */\n        if (j != err_ddrphy_wdly &amp;&amp; taps_scan[j]) {\n          one_window_active = 1;\n          one_window_start = j;\n        }\n      }\n    }\n\n    /* The delay to be found is the start of a consecutive sequence of 1's */\n    delays[i] = one_window_best_start;\n  }\n}\n\n/* Turn off the Write Leveling mode of SDRAM */\nsdram_write_leveling_off();\n</code></pre>"},{"location":"hardware/sdram.en/#read-leveling","title":"Read Leveling","text":"<p>In the Write Leveling stage, the synchronization of signals at SDRAM is solved. However, for read operations, data is sent from SDRAM to the controller, and the time of arrival of different data to the controller may be different, so it is also necessary to calibrate the read operation.</p> <p>To determine if the read data is correct, the practice is to first write known data and then read it out. If the read data is exactly the same as the written data, then the read operation can be performed correctly.</p> <p>The implementation is similar to Write Leveling in that it enumerates the delays, performs some operations, and observes the output at each delay:</p> <ol> <li>write data (or use SDRAM's function of generating a fixed pattern output)</li> <li>set the latency to loop from 0</li> <li>at each latency setting, read out the data and compare the read results with the previously written data</li> <li>count which delay conditions, the read data is accurate. accurate is recorded as 1, inaccurate is recorded as 0</li> <li>find the accurate range of 1, and take the midpoint as the final calibration result</li> </ol> <p>Note that here is no longer to find the place of 0-1 change. Write Leveling to find 0-1 change is to synchronize, synchronization is exactly the place of 0-1 change; while the purpose of Read Leveling is to read out the correct data. It is known that there is a continuous delay interval, where it can read out the correct data. Even if the interval is shifted due to changes in temperature and other conditions, it will still work because enough margin is retained by taking the midpoint of the interval. The step of taking the midpoint is also called Read Centering.</p>"},{"location":"hardware/sdram.en/#hbm","title":"HBM","text":"<p>HBM is short for High Bandwidth Memory, and its technology is also based on SDRAM, so it is placed here for comparison with DDR SDRAM.</p> <p>HBM stacks multiple SDRAMs, provides multiple channels and increases the bit width compared to the pDDR SDRAM. For example Micron HBM with ECC, stacks 4/8 layers of DRAM, provides 8 channels, each with a 128-bit data width. At 3200 MT/s, the maximum data transfer rate of an HBM chip is:</p>  3200 \\mathrm{(MT/s)} * 128 \\mathrm{(bits/transfer)} * 8 \\mathrm{(Channels)} = 3276.8 \\mathrm{(Gb/s)} = 409.6 \\mathrm{(GB/s)}  <p>So a single HBM has the transfer rate of 16 traditional DDR SDRAMs, thanks to 8 channels and double the bit width. Each channel has a bit width of 128 bits, so it can be thought of as two 64-bit SDRAMs in parallel, either as one 128-bit SDRAM or, in Pseudo Channel mode, as two SDRAMs that share address and command signals.</p> <p>Of course, the high bandwidth of HBM comes at the cost of a large number of pins. According to the HBM3 JESD238A standard, each channel requires 120 pins, for a total of 16 channels (HBM2 has 8 channels, 128 bits per channel; HBM3 has 16 channels, 64 bits per channel), plus the remaining 52 pins, which adds up to 1972 pins. So the connection to the processor is generally made on the Silicon Interposer, rather than the traditional PCB routing:</p>    ![](sdram_hbm_stack.png){ width=\"800\" }   HBM Packaging (Source A 1.2V 20nm 307GB/s HBM DRAM with At-Speed Wafer-Level I/O Test Scheme and Adaptive Refresh Considering Temperature Distribution) <p>So in the HBM3 standard, the pin is described as a microbump. HBM can be understood figuratively as taking the memory modules that were originally inserted into the motherboard and disassembling them, keeping only the chips, stacking them vertically and turning them into an HBM Die, which is then tightly connected to the CPU. But on the other hand, the density goes up, and the price gets more expensive. The scalability also went down, as you couldn't place as many HBM dies on the motherboard as you could with DDR SDRAM.</p> <p>The following is an analysis of the memory bandwidth of some typical systems with HBM:</p> <p>Xilinx's Virtex Ultrascale Plus HBM FPGA provides a bandwidth of 1800 \\mathrm{(MT/s)} * 128 \\mathrm{(bits/transfer)} * 8 \\mathrm{(Channels)} = 230.4 \\mathrm{(GB/s)}. If two HBMs are used, that's 460.8 GB/s. Exposed to the FPGA logic are 16 256-bit AXI3 ports with an AXI frequency of 450 MHz and a memory frequency of 900 MHz. As you can see, each AXI3 corresponds to a pseudo channel of HBM. Each pseudo channel is 64 bits, but the AXI port is 256 bits. This is because going from 450MHz to 900MHz at the same rate, plus DDR, equates to a quadrupling of the frequency, so the bit width has to be quadrupled from 64 bits to 256 bits accordingly.</p> <p>The 40GB PCIe version of the A100 graphics card uses five 8 GBs of HBM memory running at 1215 MHz, so the memory bandwidth is 1215 \\mathrm{(MHz)} * 2 \\mathrm{(DDR)} * 8 \\mathrm{(channels)} * 128 \\mathrm{(bits/ transfer)} / 8 \\mathrm{(bits/byte)} * 5 \\mathrm{(HBM)} = 1555 \\mathrm{(GB/s)}, which matches the Datasheet. The Memory bus width in the A100 Datasheet is actually calculated by adding up all the channel bit widths: 128 \\mathrm{(bits/transfer)} * 8 \\mathrm{(channels)} * 5 \\mathrm{(stacks)} = 5120 \\mathrm{(bits)}.</p> <p>The 80GB PCIe version of the A100 graphics card upgrades HBM2 to HBM2e, and the memory clock frequency is upgraded to 1512 MHz, so the memory bandwidth is 1512 \\mathrm{(MHz)} * 2 \\mathrm{(DDR)} * 8 \\mathrm{(channels)} * 128 \\mathrm{( bits/transfer)} / 8 \\mathrm{(bits/byte)} * 5 \\mathrm{(HBM)} = 1935 \\mathrm{(GB/s)}, which coincides with Datasheet.</p> <p>The 80GB SXM5 version of the H100 graphics card upgrades HBM to HBM3, and the memory capacity remains the same at 80GB, but the clock frequency is increased to 2619 MHz, at which point the memory bandwidth is 2619 \\mathrm{(MHz)} * 2 \\mathrm{(DDR)} * 8 \\mathrm{(channels)} * 128 \\ mathrm{(bits/transfer)} / 8 \\mathrm{(bits/byte)} * 5 \\mathrm{(HBM)} = 3352 \\mathrm{(GB/s)}.</p>"},{"location":"hardware/sdram.en/#dram-cell","title":"DRAM Cell","text":"<p>Data in DRAM is stored in capacitors. The internal structure of a typical 1T DRAM Cell is as follows:</p>    ![1T DRAM Cell](sdram_dram_cell.png){ width=\"400\" }   1T DRAM Cell Internal Structure (Source Berkeley EECS 151/251A Spring 2019)"},{"location":"hardware/sdram.en/#comparison-of-ddr-variants","title":"Comparison of DDR variants","text":"<p>A comparison of DDR, LPDDR, GDDR and HBM is given below:</p> DDR4 DDR5 LPDDR4 LPDDR5 GDDR5 GDDR6 HBM2 Channels 1 2 2 2 2 2 8 Bits per Channel 64 32 16 16/32 16 16 128 Data rate (MT/s) 3200 5600 4266 6400 9000 24000 2400 Bandwidth (GB/s) 25.6 GB/s 44.8 GB/s 17.1 GB/s 25.6 GB/s 36 GB/s 96 GB/s 307 GB/s <p>Data rates are based on the highest performance available:</p> <ul> <li>DDR4: Micron 3200 MT/s</li> <li>DDR5: Micron 5600 MT/s</li> <li>LPDDR4: Samsung 4266 MT/s</li> <li>LPDDR5: Samsung 6400 MT/s</li> <li>GDDR5: Samsung 9000 MT/s</li> <li>GDDR6: Samsung 24000 MT/s</li> <li>HBM2: Samsung 2400 MT/s</li> <li>HBM2E: Micron 3200 MT/s</li> </ul>"},{"location":"hardware/sdram.en/#related-reading","title":"Related Reading","text":"<ul> <li>DDR4 Bank Groups in Embedded Applications</li> <li>DDR4 Tutorial - Understanding the Basics</li> <li>DDR5/4/3/2: How Memory Density and Speed Increased with each Generation of DDR</li> <li>DDR5 vs DDR4 DRAM \u2013 All the Advantages &amp; Design Challenges</li> <li>Understanding DDR3 Write Leveling and Read Leveling</li> <li>Will HBM replace DDR and become Computer Memory?</li> </ul>"},{"location":"hardware/sdram.en/#acknowledgement","title":"Acknowledgement","text":"<p>The English version is kindly translated with the help of DeepL Translator.</p>"},{"location":"hardware/sdram.zh/","title":"SDRAM","text":""},{"location":"hardware/sdram.zh/#_1","title":"\u7279\u70b9","text":"<p>SDRAM \u7684\u7279\u70b9\uff1a</p> <ol> <li>\u6210\u672c\u8f83\u4f4e\uff0c\u6bcf\u4e2a 1 bit cell \u53ea\u9700\u8981\u4e00\u4e2a CMOS \u6676\u4f53\u7ba1</li> <li>\u63a5\u53e3\u590d\u6742\uff0c\u8bbf\u95ee\u6570\u636e\u524d\u9700\u8981\u9996\u5148\u6fc0\u6d3b\u4e00\u4e2a row\uff0c\u518d\u8bfb\u53d6 row \u5185\u7684\u6570\u636e</li> <li>\u63a7\u5236\u5668\u4e5f\u6bd4\u8f83\u590d\u6742\uff0c\u9700\u8981\u5b9a\u671f\u5237\u65b0\u5185\u5b58</li> <li>\u5bb9\u91cf\u8f83\u5927\uff0c\u7531\u4e8e row \u548c column \u590d\u7528\u4e86\u5730\u5740\u7ebf\uff0c\u5355\u5185\u5b58\u6761\u53ef\u4ee5\u505a\u5230 GB \u7ea7\u522b\u7684\u5bb9\u91cf</li> </ol>"},{"location":"hardware/sdram.zh/#_2","title":"\u6807\u51c6","text":"<p>SDRAM \u76f8\u5173\u6807\u51c6\u7531 JEDEC \u5236\u5b9a\uff1a</p> <ul> <li>JESD79F: DDR SDRAM</li> <li>JESD79-2F: DDR2 SDRAM</li> <li>JESD79-3F: DDR3 SDRAM</li> <li>JESD79-4D: DDR4 SDRAM</li> <li>JESD79-5B: DDR5 SDRAM</li> </ul> <p>\u9664\u4e86 DDR \u7cfb\u5217\uff0c\u8fd8\u6709\u4f4e\u529f\u8017\u7684 LPDDR \u7cfb\u5217\uff1a</p> <ul> <li>JESD209B: LPDDR SDRAM</li> <li>JESD209-2F: LPDDR2 SDRAM</li> <li>JESD209-3C: LPDDR3 SDRAM</li> <li>JESD209-4D: LPDDR4 SDRAM</li> <li>JESD209-5B: LPDDR5 SDRAM</li> </ul> <p>\u9ad8\u6027\u80fd\u5e38\u7528\u7684 HBM \u4e5f\u57fa\u4e8e SDRAM \u6280\u672f\uff1a</p> <ul> <li>JESD235D: HBM</li> <li>JESD238A: HBM3</li> </ul> <p>\u8fd8\u6709 GDDR SGRAM \u7cfb\u5217\uff1a</p> <ul> <li>SDRAM3.11.5.8 R16.01: GDDR4 SGRAM</li> <li>JESD212C.01: GDDR5 SGRAM</li> <li>JESD232A.01: GDDR5X SGRAM</li> <li>JESD250D: GDDR6 SGRAM</li> </ul> <p>\u4e0b\u9762\u4e3b\u8981\u4ecb\u7ecd DDR \u7cfb\u5217\u7684 SDRAM\u3002</p>"},{"location":"hardware/sdram.zh/#_3","title":"\u6982\u5ff5","text":"<p>DDR SDRAM \u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u6570\u5b57\u6765\u4ee3\u8868\u5b83\u7684\u6027\u80fd\uff0c\u4f8b\u5982 DDR4-2133 \u4e2d\u7684 2133\uff0c\u6709\u65f6\u5019\u4f1a\u89c1\u5230 2400 MT/s \u7684\u8bf4\u6cd5\u3002\u8fd9\u4e24\u8005\u8bf4\u7684\u90fd\u662f SDRAM \u6bcf\u79d2\u6700\u591a\u8fdb\u884c\u7684\u6570\u636e\u4f20\u8f93\u6b21\u6570\uff0c\u5355\u4f4d\u662f Million Transfers per Second\u3002\u7531\u4e8e SDRAM \u91c7\u7528 DDR \u8fdb\u884c\u4f20\u8f93\uff0c\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u4f20\u8f93\u4e24\u4efd\u6570\u636e\uff0c\u6240\u4ee5\u5b9e\u9645\u7684\u65f6\u949f\u9891\u7387\u8981\u9664\u4ee5\u4e8c\uff0c\u4f8b\u5982 2133 MT/s \u5bf9\u5e94\u65f6\u949f\u9891\u7387\u5c31\u662f 1066 MHz\u3002</p> <p>\u6709\u65f6\u8fd8\u4f1a\u89c1\u5230 PC4-21333 \u7684\u5199\u6cd5\u7528\u4e8e\u63cf\u8ff0\u5185\u5b58\u6761\uff0c\u8fd9\u91cc\u7684 21333=8*2666\uff0c\u5bf9\u5e94\u4e86 2666 MT/s\uff0c\u4e58\u4ee5 8 \u662f\u56e0\u4e3a DDR \u5185\u5b58\u6761\u7684\u6570\u636e\u4f4d\u5bbd\u662f 64 \u4f4d\uff0c\u90a3\u4e48\u4e00\u4e2a 2666 MT/s \u7684\u5185\u5b58\u6761\u5176\u7406\u8bba\u5185\u5b58\u5e26\u5bbd\u5c31\u662f 2666 \\mathrm{(MT/s)} * 64 \\mathrm{(bits)} / 8 \\mathrm{(bits/byte)} = 21333 \\mathrm{(MB/s)}\u3002\u4f46\u4e5f\u6709\u4e9b\u65f6\u5019 PC4 \u540e\u9762\u8ddf\u7740\u7684\u5c31\u662f MT/s\u3002</p> <p>\u4e0d\u540c\u4ee3\u6b21\u7684\u5185\u5b58\u6761\uff0c\u4e0b\u9762\u5f15\u811a\u7684\u7f3a\u53e3\u4f4d\u7f6e\u4e0d\u540c\uff0c\u6240\u4ee5\u662f\u65e0\u6cd5\u63d2\u9519\u5730\u65b9\u7684\u3002</p>"},{"location":"hardware/sdram.zh/#_4","title":"\u7ed3\u6784","text":"<p>\u4ee5 DDR4 SDRAM \u4e3a\u4f8b\uff0c\u4e0b\u9762\u662f MT40A1G8 \u82af\u7247\u7684\u7ed3\u6784\u56fe\uff1a</p>    ![](sdram_ddr4_micron_1g8_diagram.png){ width=\"800\" }   MT40A1G8 \u7684\u7ed3\u6784\u6846\u56fe\uff08\u56fe\u6e90 Micron Datasheet\uff09 <p>\u4fdd\u5b58\u6570\u636e\u7684\u662f\u4e2d\u95f4\u7684 Memory array\uff0c\u6bcf\u4e2a Memory array \u7684\u89c4\u683c\u662f 65536 x 128 x 64\uff0c\u79f0\u4e3a\u4e00\u4e2a Bank\uff1b\u56db\u4e2a Bank \u7ec4\u6210\u4e00\u4e2a Bank Group\uff0c\u4e00\u5171\u6709 4 \u4e2a Bank Group\uff0c\u6240\u4ee5\u603b\u5bb9\u91cf\u662f 65536 * 128 * 64 * 4 * 4 = 8 \\mathrm{Gb}\u3002</p> <p>\u5177\u4f53\u5730\uff0c\u6bcf\u4e2a Memory array \u7684 65536 x 128 x 64 \u7684\u89c4\u683c\u91cc\uff0c65536 \u8868\u793a row \u7684\u6570\u91cf\uff0c\u6bcf\u4e2a row \u4fdd\u5b58\u4e86 128 * 64 = 8192 \u4f4d\u7684\u6570\u636e\uff0c\u540c\u65f6\u4e5f\u662f\u56fe 1 \u4e2d <code>Sense amplifier</code> \u5230 <code>I/O gating, DM mask logic</code> \u4e4b\u95f4\u4f20\u8f93\u7684\u4f4d\u5bbd\u3002\u6bcf\u4e2a row \u6709 1024 \u4e2a column\uff0c\u6bcf\u4e2a column \u4fdd\u5b58\u4e86 8 \u4f4d\u7684\u6570\u636e\uff08\u5bf9\u5e94 <code>1 Gig x 8</code> \u4e2d\u7684 8\uff09\u3002\u7531\u4e8e DDR4 \u7684 prefetch \u5bbd\u5ea6\u662f 8n\uff0c\u6240\u4ee5\u4e00\u6b21\u8bbf\u95ee\u4f1a\u53d6\u51fa 8 \u4e2a column \u7684\u6570\u636e\uff0c\u4e5f\u5c31\u662f 64 \u4f4d\u3002\u90a3\u4e48\u6bcf\u4e2a row \u5c31\u662f 128 \u4e2a 64 \u4f4d\u6570\u636e\uff0c\u8fd9\u5c31\u662f\u4e0a\u9762\u6240\u8bf4\u7684 65536 x 128 x 64 \u7684 128 x 64 \u7684\u6765\u6e90\u3002</p>"},{"location":"hardware/sdram.zh/#prefetch","title":"Prefetch","text":"<p>SDRAM \u6709 Prefetch \u7684\u6982\u5ff5\uff0c\u542b\u4e49\u5c31\u662f\u4e00\u6b21\u8bfb\u53d6\u4f1a\u53d6\u51fa\u4f4d\u5bbd\u7684\u591a\u5c11\u500d\u7684\u6570\u636e\u51fa\u6765\u3002\u4f8b\u5982\u4e0a\u9762\u7684 <code>1 Gig x 8</code> \u7684 SDRAM\uff0c\u5176 I/O \u6570\u636e\u4f4d\u5bbd\u662f 8 \u4f4d\uff08\u89c1\u53f3\u4fa7\u7684 <code>DQ</code> \u4fe1\u53f7\uff09\u3002\u4f46\u5b9e\u9645\u4e0a\u4ece <code>Global I/O Gating</code> \u51fa\u6765\u7684\u6570\u636e\u662f 64 \u4f4d\uff0c\u5dee\u4e86\u4e00\u4e2a 8 \u7684\u56e0\u5b50\uff0c\u8fd9\u5c31\u662f DDR4 \u7684 8n Prefetch\u3002\u8fd9\u662f\u56e0\u4e3a\uff0cDDR4 SDRAM \u7684 IO \u9891\u7387\u662f\u5f88\u9ad8\u7684\uff0c\u4f8b\u5982 3200 MT/s \u5bf9\u5e94\u7684 I/O \u65f6\u949f\u9891\u7387\u662f 1600 MHz\uff0c\u800c\u5b9e\u9645\u7684 Memory array \u9891\u7387\u505a\u4e0d\u5230\u8fd9\u4e48\u9ad8\uff0c\u800c\u662f\u5de5\u4f5c\u5728 400 MHz\uff0c\u4e3a\u4e86\u5f25\u8865\u9891\u7387\u7684\u5dee\u8ddd\uff0c\u4e00\u6b21\u8bfb\u53d6 8 \u500d\u4f4d\u5bbd\u7684\u6570\u636e\u3002\u4f53\u73b0\u5728 I/O \u4e0a\u5c31\u662f\u4e00\u6b21\u8bfb\u64cd\u4f5c\u5f97\u5230 8 \u4efd\u6570\u636e\uff0c\u4e5f\u5c31\u662f Burst Length \u4e3a 8\uff0c\u901a\u8fc7 DDR \u65b9\u5f0f\u5728\u56db\u4e2a\u65f6\u949f\u5468\u671f\u5185\u4f20\u8f93\u3002</p> <p>\u6709\u8da3\u7684\u662f\uff0cDDR4 \u5185\u5b58\u6761\u4f4d\u5bbd\u662f 64\uff0c\u90a3\u4e48\u4e00\u6b21\u8bfb\u64cd\u4f5c\u5c31\u5f97\u5230 64 * 8 / 8 = 64B \u7684\u6570\u636e\uff0c\u6b63\u597d\u662f\u5f88\u591a CPU \u7f13\u5b58\u884c\u7684\u5927\u5c0f\u3002</p> <p>DDR5 \u628a Prefetch \u63d0\u9ad8\u5230\u4e86 16n\uff0c\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u770b\u5230\u7684 DDR5 \u7684\u6570\u636e\u901f\u7387\u6570\u5b57\u5927\u4e86\u5f88\u591a\uff1a\u540c\u6837\u7684 Memory array \u9891\u7387\u4e0b\uff0cDDR4 \u7684 Prefetch \u662f 8n\uff0cDDR5 \u7684 Prefetch \u662f 16n\uff0c\u4e8e\u662f I/O \u9891\u7387\u7ffb\u500d\uff0c\u6570\u636e\u901f\u7387\u4e5f\u7ffb\u500d\u3002\u540c\u65f6\u4e3a\u4e86\u7ee7\u7eed\u4fdd\u6301\u4e00\u4e2a Burst \u662f 64 \u5b57\u8282\uff0cDDR5 \u5185\u5b58\u6761\u6bcf\u4e2a channel \u4f4d\u5bbd\u662f 32 \u4f4d\uff0c\u6bcf\u4e2a\u5185\u5b58\u6761\u63d0\u4f9b\u4e24\u4e2a channel\u3002</p>"},{"location":"hardware/sdram.zh/#_5","title":"\u8bbf\u95ee\u6a21\u5f0f","text":"<p>SDRAM \u7684\u8bbf\u95ee\u6a21\u5f0f\u6bd4\u8f83\u7279\u522b\uff0c\u5b83\u7684 Memory array \u6bcf\u6b21\u53ea\u80fd\u4ee5\u6574\u4e2a row \u4e3a\u5355\u4f4d\u8fdb\u884c\u5b58\u53d6\u3002\u5728\u524d\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e00\u4e2a row \u6709 8192 \u4f4d\u7684\u6570\u636e\uff0c\u4f46\u662f\u4e00\u6b21\u8bfb\u6216\u5199\u64cd\u4f5c\u53ea\u6d89\u53ca 64 \u4f4d\u7684\u6570\u636e\uff0c\u56e0\u6b64\u4e00\u6b21\u8bfb\u64cd\u4f5c\u9700\u8981\uff1a</p> <ol> <li>\u7b2c\u4e00\u6b65\uff0c\u5148\u628a\u6570\u636e\u6240\u5728\u7684\u6574\u4e2a row \u53d6\u51fa\u6765</li> <li>\u7b2c\u4e8c\u6b65\uff0c\u5728 row \u91cc\u8bfb\u51fa\u60f3\u8981\u7684\u6570\u636e</li> </ol> <p>\u4f46\u662f\u6bcf\u4e2a Bank \u540c\u65f6\u53ea\u80fd\u53d6\u51fa\u6765\u4e00\u4e2a row\uff0c\u6240\u4ee5\u5982\u679c\u4e24\u6b21\u8bfb\u6d89\u53ca\u5230\u4e86\u4e0d\u540c\u7684 row\uff0c\u90a3\u4e48\u9700\u8981\uff1a</p> <ol> <li>\u7b2c\u4e00\u6b65\uff0c\u5148\u628a\u7b2c\u4e00\u6b21\u8bfb\u7684\u6570\u636e\u6240\u5728\u7684\u6574\u4e2a row \u53d6\u51fa\u6765</li> <li>\u7b2c\u4e8c\u6b65\uff0c\u5728 row \u91cc\u8bfb\u51fa\u60f3\u8981\u7684\u6570\u636e</li> <li>\u7b2c\u4e09\u6b65\uff0c\u628a\u7b2c\u4e00\u6b21\u8bfb\u7684 row \u653e\u56de\u53bb</li> <li>\u7b2c\u56db\u6b65\uff0c\u628a\u7b2c\u4e8c\u6b21\u8bfb\u7684\u6570\u636e\u6240\u5728\u7684\u6574\u4e2a row \u53d6\u51fa\u6765</li> <li>\u7b2c\u4e94\u6b65\uff0c\u5728 row \u91cc\u8bfb\u51fa\u60f3\u8981\u7684\u6570\u636e</li> </ol> <p>\u7528 SDRAM \u7684\u672f\u8bed\u6765\u8bb2\uff0c\u7b2c\u4e00\u6b65\u548c\u7b2c\u56db\u6b65\u53eb\u505a Activate\uff0c\u7b2c\u4e8c\u90e8\u548c\u7b2c\u4e94\u6b65\u53eb\u505a Read\uff0c\u7b2c\u4e09\u6b65\u53eb\u505a Precharge\u3002</p> <p>SDRAM \u5b9a\u4e49\u4e86\u4e0b\u5217\u7684\u65f6\u5e8f\u53c2\u6570\uff0c\u63cf\u8ff0\u4e86\u8fd9\u4e09\u4e2a\u64cd\u4f5c\u4e4b\u95f4\u7684\u65f6\u5e8f\u8981\u6c42\uff1a</p> <ol> <li>CL\uff08CAS Latency\uff09\uff1a\u53d1\u9001\u8bfb\u8bf7\u6c42\uff0c\u5230\u8f93\u51fa\u7b2c\u4e00\u4e2a\u6570\u636e\u7684\u65f6\u95f4</li> <li>RCD\uff08ACT to internal read or write delay time\uff09\uff1a\u4ece Activate \u5230\u4e0b\u4e00\u4e2a\u8bfb\u6216\u5199\u8bf7\u6c42\u7684\u65f6\u95f4</li> <li>RP\uff08RRE command period\uff09\uff1a\u53d1\u9001 Precharge \u547d\u4ee4\u5230\u4e0b\u4e00\u4e2a\u547d\u4ee4\u7684\u65f6\u95f4</li> <li>RAS\uff08ACT to PRE command period\uff09\uff1a\u4ece Activate \u5230 Precharge \u4e4b\u95f4\u7684\u65f6\u95f4</li> <li>RC\uff08ACT to ACT or REF command period\uff09\uff1a\u4ece Activate \u5230\u4e0b\u4e00\u4e2a Activate \u6216\u8005 Refresh \u4e4b\u95f4\u7684\u65f6\u95f4</li> <li>RTP\uff08Internal READ Command to PRECHARGE command delay\uff09\uff1a\u4ece Read \u5230 Precharge \u4e4b\u95f4\u7684\u65f6\u95f4</li> </ol> <p>\u4e8e\u662f\u4e0a\u9762\u7684\u6d41\u7a0b\u9700\u8981\u7684\u65f6\u95f4\u8981\u6c42\u5c31\u662f\uff1a</p> <ol> <li>\u7b2c\u4e00\u6b65\uff0cActivate\uff0c\u53d6\u51fa\u7b2c\u4e00\u4e2a row</li> <li>\u7b2c\u4e8c\u6b65\uff0cRead\uff0c\u7b2c\u4e00\u6b65\u548c\u7b2c\u4e8c\u6b65\u4e4b\u95f4\u8981\u9694 RCD \u7684\u65f6\u95f4\uff0c\u4ece Read \u53d1\u9001\u5730\u5740\u5230\u5f97\u5230\u6570\u636e\u8981\u7b49\u5f85 CL \u7684\u65f6\u95f4</li> <li>\u7b2c\u4e09\u6b65\uff0cPrecharge\uff0c\u7b2c\u4e00\u6b65\u548c\u7b2c\u4e09\u6b65\u4e4b\u95f4\u8981\u9694 RAS \u7684\u65f6\u95f4\uff0c\u7b2c\u4e8c\u6b65\u548c\u7b2c\u4e09\u6b65\u4e4b\u95f4\u8981\u9694 RTP \u7684\u65f6\u95f4</li> <li>\u7b2c\u56db\u6b65\uff0cActivate\uff0c\u53d6\u51fa\u7b2c\u4e8c\u4e2a row\uff0c\u7b2c\u4e00\u6b65\u548c\u7b2c\u56db\u6b65\u4e4b\u95f4\u8981\u9694 RC \u7684\u65f6\u95f4\uff0c\u7b2c\u4e09\u6b65\u548c\u7b2c\u56db\u6b65\u4e4b\u95f4\u8981\u9694 RP \u7684\u65f6\u95f4</li> <li>\u7b2c\u4e94\u6b65\uff0cRead\uff0c\u7b2c\u56db\u6b65\u548c\u7b2c\u4e94\u6b65\u4e4b\u95f4\u8981\u9694 RCD \u7684\u65f6\u95f4\uff0c\u4ece Read \u53d1\u9001\u5730\u5740\u5230\u5f97\u5230\u6570\u636e\u8981\u7b49\u5f85 CL \u7684\u65f6\u95f4</li> </ol> <p>\u6839\u636e\u8fd9\u4e2a\u6d41\u7a0b\uff0c\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u7684\u7ed3\u8bba\uff1a</p> <ol> <li>\u8bbf\u95ee\u5e26\u6709\u5c40\u90e8\u6027\u7684\u6570\u636e\u6027\u80fd\u4f1a\u66f4\u597d\uff0c\u53ea\u9700\u8981\u8fde\u7eed\u5730\u8fdb\u884c Read\uff0c\u51cf\u5c11 Activate \u548c Precharge \u6b21\u6570</li> <li>\u4e0d\u65ad\u8bbf\u95ee\u4e0d\u540c\u7684 row \u7684\u6570\u636e\uff0c\u4f1a\u5bfc\u81f4\u9700\u8981\u6765\u56de\u5730 Activate\uff0cRead\uff0cPrecharge \u5faa\u73af</li> <li>\u8bbf\u95ee row \u548c\u8bbf\u95ee row \u4e2d\u7684\u6570\u636e\u5206\u6210\u4e24\u4e2a\u9636\u6bb5\uff0c\u4e24\u4e2a\u9636\u6bb5\u53ef\u4ee5\u4f7f\u7528\u540c\u6837\u7684\u5730\u5740\u4fe1\u53f7\uff0c\u4f7f\u5f97\u5185\u5b58\u603b\u5bb9\u91cf\u5f88\u5927</li> <li>\u800c\u5982\u679c\u8bbf\u95ee\u603b\u662f\u547d\u4e2d\u540c\u4e00\u4e2a row\uff0c\u5c31\u53ef\u4ee5\u83b7\u5f97\u63a5\u8fd1\u7406\u8bba\u7684\u4f20\u8f93\u901f\u7387\uff0c\u5982\u56fe 2</li> </ol>    ![](sdram_ddr3_consecutive_read.png){ width=\"800\" }   DDR3 \u540c\u4e00\u4e2a Row \u5185\u7684\u7684\u8fde\u7eed\u8bfb\uff08\u56fe\u6e90 JESD9-3F DDR3\uff09 <p>\u4e3a\u4e86\u7f13\u89e3\u7b2c\u4e8c\u70b9\u5e26\u6765\u7684\u6027\u80fd\u635f\u5931\uff0c\u5f15\u5165\u4e86 Bank \u7684\u6982\u5ff5\uff1a\u6bcf\u4e2a Bank \u90fd\u53ef\u4ee5\u53d6\u51fa\u6765\u4e00\u4e2a row\uff0c\u90a3\u4e48\u5982\u679c\u8981\u8bbf\u95ee\u4e0d\u540c Bank \u91cc\u7684\u6570\u636e\uff0c\u5728\u7b2c\u4e00\u4e2a Bank \u8fdb\u884c Activate/Precharge \u7684\u65f6\u5019\uff0c\u5176\u4ed6 Bank \u53ef\u4ee5\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c\uff0c\u4ece\u800c\u63a9\u76d6 row \u672a\u547d\u4e2d\u5e26\u6765\u7684\u6027\u80fd\u635f\u5931\u3002</p>"},{"location":"hardware/sdram.zh/#bank-group","title":"Bank Group","text":"<p>DDR4 \u76f8\u6bd4 DDR3 \u5f15\u5165\u4e86 Bank Group \u7684\u6982\u5ff5\u3002\u5f15\u7528 \u540c\u4e00 bank group page hit \u7684\u65f6\u95f4\u662f tccd_S \u8fd8\u662f tccd_L? - Ricky Li \u7684\u56de\u7b54 - \u77e5\u4e4e \u7684\u89c2\u70b9\uff1aDDR4 \u7684 Memory array \u9891\u7387\u76f8\u6bd4 DDR3 \u63d0\u9ad8\uff0c\u56e0\u6b64\u540c\u4e00\u4e2a Row \u5185\u65e0\u6cd5\u5b9e\u73b0\u5b8c\u7f8e\u7684\u8fde\u7eed\u8bfb\u53d6\uff0c\u5373\u4e24\u4e2a\u76f8\u90bb\u7684\u8bfb\u64cd\u4f5c\u9700\u8981\u9694 5 \u4e2a\u5468\u671f\uff0c\u800c\u6bcf\u6b21\u8bfb\u4f20\u8f93 4 \u4e2a\u5468\u671f\u7684\u6570\u636e\uff0c\u5229\u7528\u7387\u6700\u9ad8 80%\uff0c\u89c1\u4e0b\u56fe\uff1a</p>    ![](sdram_ddr4_nonconsecutive_read.png){ width=\"800\" }   DDR4 \u7684\u975e\u8fde\u7eed\u8bfb\uff08\u56fe\u6e90 JESD9-4D DDR4\uff09 <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u74f6\u9888\uff0cDDR4 \u5728\u6838\u5fc3\u90e8\u5206\u7684\u533a\u522b\u5c31\u662f\u591a\u4e86\u4e00\u4e2a <code>Global I/O gating</code>\uff0c\u5e76\u4e14\u6bcf\u4e2a Bank Group \u90fd\u6709\u81ea\u5df1\u7684 <code>I/O gating, DM mask logic</code>\uff0c\u4e0b\u9762\u5206\u522b\u753b\u51fa DDR3 \u548c DDR4 \u7684\u5b58\u50a8\u90e8\u5206\uff0c\u8fdb\u884c\u5bf9\u6bd4\uff1a</p>    ![](sdram_ddr3_array.png){ width=\"400\",align=\"left\" }   DDR3 SDRAM \u5b58\u50a8\u90e8\u5206\uff08\u56fe\u6e90 Micron Datasheet\uff09    ![](sdram_ddr4_array.png){ width=\"400\" }   DDR4 SDRAM \u5b58\u50a8\u90e8\u5206\uff08\u56fe\u6e90 Micron Datasheet\uff09 <p>\u8fd9\u610f\u5473\u7740 DDR4 \u53ef\u4ee5\u591a\u4e2a Bank Group \u540c\u65f6\u8fdb\u884c\u8bfb\u64cd\u4f5c\uff0c\u5e76\u4e14\u6d41\u6c34\u7ebf\u5f0f\u8f93\u51fa\uff0c\u4f8b\u5982\u7b2c\u4e00\u4e2a Bank Group \u8bfb\u53d6\u4e86\u6570\u636e\uff0c\u5728 I/O \u4e0a\u7528\u56db\u4e2a\u5468\u671f\u4f20\u8f93\u5b8c\u6570\u636e\uff0c\u7acb\u9a6c\u7b2c\u4e8c\u4e2a Bank Group \u8bfb\u53d6\u7684\u6570\u636e\u5c31\u63a5\u4e0a\u4e86\uff0c\u53c8\u4f20\u8f93\u4e86\u56db\u4e2a\u5468\u671f\u7684\u6570\u636e\uff0c\u6ce2\u5f62\u5982\u4e0b\u56fe\uff1a</p>    ![](sdram_consecutive_read.png){ width=\"800\" }   DDR4 \u4e0d\u540c Bank Group \u7684\u8fde\u7eed\u8bfb\uff08\u56fe\u6e90 JESD9-4D DDR4\uff09 <p>\u4e0a\u56fe\u4e2d T0 \u65f6\u523b\u53d1\u8d77\u7b2c\u4e00\u4e2a\u8bfb\u8bf7\u6c42\uff0cT4 \u65f6\u523b\u53d1\u8d77\u7b2c\u4e8c\u4e2a\u8bf7\u6c42\uff0cT11-T15 \u5f97\u5230\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u7d27\u63a5\u7740 T15-T19 \u5f97\u5230\u7b2c\u4e8c\u4e2a\u8bf7\u6c42\u7684\u6570\u636e\u3002\u8fd9\u6837\u5c31\u89e3\u51b3\u4e86\u9891\u7387\u63d0\u9ad8\u5e26\u6765\u7684\u95ee\u9898\u3002</p>"},{"location":"hardware/sdram.zh/#_6","title":"\u5b58\u50a8\u5c42\u6b21","text":"<p>\u4e0a\u9762\u5df2\u7ecf\u63d0\u5230\uff0c\u5728 DDR SDRAM \u5185\u90e8\u7684\u5c42\u6b21\u4ece\u5927\u5230\u5c0f\u6709\uff1a</p> <ol> <li>Bank Group\uff1aDDR4 \u5f15\u5165</li> <li>Bank\uff1a\u6bcf\u4e2a Bank \u540c\u65f6\u53ea\u6709\u4e00\u4e2a Row \u88ab\u6fc0\u6d3b</li> <li>Row\uff1aActivate/Precharge \u7684\u5355\u4f4d</li> <li>Column\uff1a\u6bcf\u4e2a Column \u4fdd\u5b58 n \u4e2a Cell\uff0cn \u662f SDRAM \u7684\u4f4d\u5bbd</li> <li>Cell\uff1a\u6bcf\u4e2a Cell \u4fdd\u5b58 1 bit \u7684\u6570\u636e</li> </ol> <p>\u5b9e\u9645\u4e0a\uff0cSDRAM \u5916\u90e8\u8fd8\u6709\u4e00\u4e9b\u5c42\u6b21\uff1a</p> <ol> <li>Channel\uff1a\u5904\u7406\u5668\u7684\u5185\u5b58\u63a7\u5236\u5668\u7684\u901a\u9053\u6570\u91cf</li> <li>Module\uff1a\u5185\u5b58\u6761\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\u5185\u5b58\u6761\u8fde\u63a5\u5230\u540c\u4e00\u4e2a Channel \u4e0a</li> <li>Rank\uff1a\u591a\u4e2a DDR SDRAM \u82af\u7247\u5728\u5bbd\u5ea6\u4e0a\u62fc\u63a5\u8d77\u6765\uff0c\u4e00\u4e2a Module \u4e0a\u53ef\u4ee5\u653e\u4e0b\u4e00\u5230\u56db\u4e2a Rank\uff0c\u8fd9\u4e9b Rank \u5171\u4eab\u603b\u7ebf\uff0c\u6bcf\u4e2a Rank \u90fd\u6709\u81ea\u5df1\u7684\u7247\u9009\u4fe1\u53f7 CS_n\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5728\u6df1\u5ea6\u4e0a\u62fc\u63a5 SDRAM \u82af\u7247</li> <li>Chip\uff1a\u4e5f\u5c31\u662f\u4e00\u4e2a DDR SDRAM \u82af\u7247\uff0c\u4f8b\u5982\u4e00\u4e2a\u6570\u636e\u4f4d\u5bbd\u662f 64 \u4f4d\u7684 Rank\uff0c\u662f\u4f7f\u7528 8 \u4e2a x8 \u7684 Chip \u5728\u5bbd\u5ea6\u4e0a\u62fc\u63a5\u800c\u6210</li> </ol> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u76f8\u90bb\u5b58\u50a8\u5c42\u6b21\u4e4b\u95f4\u90fd\u5dee\u4e00\u4e2a\u4e8c\u7684\u5e42\u6b21\u7684\u500d\u6570\uff0c\u56e0\u6b64\u4ece\u5185\u5b58\u5730\u5740\u5230\u8fd9\u4e9b\u5b58\u50a8\u5c42\u6b21\u7684\u6620\u5c04\uff0c\u5c31\u662f\u622a\u53d6\u5730\u5740\u4e2d\u7684\u4e0d\u540c\u533a\u95f4\uff0c\u6bcf\u4e2a\u533a\u95f4\u5bf9\u5e94\u4e86\u4e00\u4e2a\u5c42\u6b21\u7684\u4e0b\u6807\u3002\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u5185\u5b58\u5927\u5c0f\u7684 MB\u3001GB \u7528\u7684\u662f 1024 \u8fdb\u5236\u3002</p> <p>\u5982\u679c\u7814\u7a76 SDRAM \u5185\u5b58\u63a7\u5236\u5668\uff0c\u6bd4\u5982 Xilinx FPGA \u4e0a\u7684 MIG\uff0c\u53ef\u4ee5\u53d1\u73b0\u5b83\u53ef\u4ee5\u914d\u7f6e\u4e0d\u540c\u7684\u5730\u5740\u6620\u5c04\u65b9\u5f0f\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>ROW_COLUMN_BANK</li> <li>ROW_BANK_COLUMN</li> <li>BANK_ROW_COLUMN</li> <li>ROW_COLUMN_LRANK_BANK</li> <li>ROW_LRANK_COLUMN_BANK</li> <li>ROW_COLUMN_BANK_INTLV</li> </ul> <p>\u5c31\u662f\u5c06\u5730\u5740\u7684\u4e0d\u540c\u90e8\u5206\u6620\u5c04\u5230 DRAM \u7684\u51e0\u4e2a\u5730\u5740\uff1aRow\uff0cColumn\uff0cBank\u3002\u53ef\u4ee5\u60f3\u8c61\uff0c\u4e0d\u540c\u7684\u5730\u5740\u6620\u5c04\u65b9\u5f0f\u9488\u5bf9\u4e0d\u540c\u7684\u8bbf\u5b58\u6a21\u5f0f\u4f1a\u6709\u4e0d\u540c\u7684\u6027\u80fd\u3002\u5bf9\u4e8e\u8fde\u7eed\u7684\u5185\u5b58\u8bbf\u95ee\uff0cROW_COLUMN_BANK \u65b9\u5f0f\u662f\u6bd4\u8f83\u9002\u5408\u7684\uff0c\u56e0\u4e3a\u8fde\u7eed\u7684\u8bbf\u95ee\u4f1a\u5206\u5e03\u5230\u4e0d\u540c\u7684 Bank \u4e0a\uff0c\u8fd9\u6837\u6027\u80fd\u5c31\u4f1a\u66f4\u597d\u3002</p>"},{"location":"hardware/sdram.zh/#_7","title":"\u63a5\u53e3","text":"<p>\u4e0b\u9762\u753b\u51fa\u4e86 DDR3 \u548c DDR4 \u7684\u5f15\u811a\uff1a</p>    ![](sdram_pinout.png){ width=\"600\" }   DDR3 \u548c DDR4 \u539f\u7406\u56fe <p>DDR3 \u548c DDR4 \u7684\u4e0d\u540c\u70b9\uff1a</p> <ol> <li>\u5730\u5740\u4fe1\u53f7\uff1aDDR3 \u662f A0-A14\uff0cDDR4 \u662f A0-A17\uff0c\u5176\u4e2d A14-A16 \u590d\u7528\u4e86\u5f15\u811a</li> <li>DDR4 \u5f15\u5165\u4e86 Bank Group\uff0c\u6240\u4ee5\u591a\u51fa\u4e86 BA0-BA1 \u5f15\u811a</li> <li>DDR3 \u4e2d\u7684 RAS_n\u3001CAS_n \u548c WE_n \u5728 DDR4 \u4e2d\u88ab\u590d\u7528\u4e3a\u4e86 A14-A16</li> <li>DDR4 \u989d\u5916\u6dfb\u52a0\u4e86 ACT_n \u63a7\u5236\u4fe1\u53f7</li> </ol>"},{"location":"hardware/sdram.zh/#_8","title":"\u62d3\u6251","text":"<p>\u4e3a\u4e86\u83b7\u5f97\u66f4\u5927\u7684\u4f4d\u5bbd\uff0c\u5728\u5185\u5b58\u6761\u4e0a\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u4e2a SDRAM \u82af\u7247\uff0c\u901a\u8fc7\u5bbd\u5ea6\u62fc\u63a5\u7684\u65b9\u5f0f\u5f62\u6210\u4e00\u4e2a 64 \u4f4d\u7684\u6570\u636e\u5bbd\u5ea6\u3002\u6b64\u65f6\u4ece PCB \u8d70\u7ebf\u7684\u89d2\u5ea6\u6765\u8bb2\uff0c\u6570\u636e\u7ebf\u76f4\u63a5\u8fde\u63a5\u5230\u5404\u4e2a SDRAM \u82af\u7247\u4e0a\uff0c\u53ef\u4ee5\u76f8\u5bf9\u5bb9\u6613\u5730\u8fde\u63a5\uff1b\u4f46\u662f\u5176\u4ed6\u4fe1\u53f7\uff0c\u6bd4\u5982\u5730\u5740\u4fe1\u53f7\u548c\u63a7\u5236\u4fe1\u53f7\uff0c\u9700\u8981\u8fde\u63a5\u5230\u6240\u6709 SDRAM \u82af\u7247\u4e0a\uff0c\u5728\u5c40\u9650\u7684\u7a7a\u95f4\u91cc\uff0c\u5982\u679c\u8981\u4fdd\u8bc1\u5230\u5404\u4e2a SDRAM \u82af\u7247\u7684\u8ddd\u79bb\u76f8\u7b49\uff0c\u540c\u65f6\u4fdd\u8bc1\u4fe1\u53f7\u5b8c\u6574\u6027\u662f\u5f88\u56f0\u96be\u7684\u3002</p>"},{"location":"hardware/sdram.zh/#fly-by-topology","title":"Fly-by topology","text":"<p>\u56e0\u6b64\uff0c\u5b9e\u9645\u4e0a\u5730\u5740\u548c\u63a7\u5236\u4fe1\u53f7\u662f\u91c7\u7528\u4e86\u4e32\u8054\u7684\u65b9\u5f0f\u8fde\u63a5\uff08Fly-by topology\uff09\uff0c\u4e5f\u5c31\u662f\u4e0b\u56fe\u7684\u53f3\u8fb9\u7684\u8fde\u63a5\u65b9\u5f0f\uff1a</p>    ![](sdram_topology.png){ width=\"600\" }   SDRAM \u7684\u4e24\u79cd\u4fe1\u53f7\u8fde\u63a5\u65b9\u5f0f\uff08\u56fe\u6e90 Versal ACAP PCB Design User Guide (UG863)\uff09 <p>\u4f46\u662f\u6570\u636e\u4fe1\u53f7\uff08DQ\u3001DQS \u548c DM\uff09\u4f9d\u7136\u662f\u5e76\u884c\u70b9\u5bf9\u70b9\u8fde\u63a5\u5230 SDRAM \u4e0a\u7684\uff08\u4e0a\u56fe\u5de6\u4fa7\uff09\u3002\u8fd9\u5c31\u51fa\u73b0\u4e86\u95ee\u9898\uff1a\u4e0d\u540c\u7684 SDRAM \u82af\u7247\uff0c\u6570\u636e\u548c\u65f6\u949f\u7684\u504f\u5dee\u4e0d\u540c\uff0c\u6570\u636e\u53ef\u80fd\u5dee\u4e0d\u591a\u65f6\u95f4\u5230\uff0c\u4f46\u662f\u65f6\u949f\u7684\u5ef6\u8fdf\u8d8a\u6765\u8d8a\u5927\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"clock\", wave: \"1010101010\"},\n      { name: \"data\", wave: \"01.0..101.\"},\n      { name: \"clock_dram0\", wave: \"1010101010\", phase: -0.2},\n      { name: \"data_dram0\", wave: \"01.0..101.\", phase: -0.1},\n      { name: \"clock_dram1\", wave: \"1010101010\", phase: -0.4},\n      { name: \"data_dram1\", wave: \"01.0..101.\", phase: -0.1},\n      { name: \"clock_dram2\", wave: \"1010101010\", phase: -0.6},\n      { name: \"data_dram2\", wave: \"01.0..101.\", phase: -0.1},\n      { name: \"clock_dram3\", wave: \"1010101010\", phase: -0.8},\n      { name: \"data_dram3\", wave: \"01.0..101.\", phase: -0.1},\n    ]\n}\n</code></pre> SDRAM \u7684\u65f6\u949f\u504f\u79fb\u95ee\u9898 <p>\u4e3a\u4e86\u8ba9\u5904\u4e8e\u4e0d\u540c\u4f4d\u7f6e\u7684 SDRAM \u770b\u5230\u540c\u6837\u7684\u6ce2\u5f62\uff0c\u9700\u8981\u5728\u5185\u5b58\u63a7\u5236\u5668\u4e00\u4fa7\u7ed9\u6570\u636e\u4fe1\u53f7\u52a0\u4e0a\u53ef\u53d8\u7684\u5ef6\u8fdf\uff0c\u8fd9\u4e2a\u5ef6\u8fdf\u9700\u8981\u7ecf\u8fc7\u6821\u51c6\uff0c\u624d\u80fd\u77e5\u9053\u662f\u591a\u5c11\u3002</p>"},{"location":"hardware/sdram.zh/#clam-shell-topology","title":"Clam-shell topology","text":"<p>\u9664\u4e86 Fly-by topology\uff0c\u5728\u4e00\u4e9b\u573a\u666f\u4e0b\uff0c\u4e3a\u4e86\u8282\u7701 PCB \u9762\u79ef\uff0c\u8fd8\u53ef\u80fd\u4f1a\u4f7f\u7528 Clam-shell topology\u3002Clam-shell \u662f\u8d1d\u58f3\u7684\u610f\u601d\uff0c\u8d1d\u58f3\u6709\u4e0a\u4e0b\u4e24\u4e2a\u90e8\u5206\u5408\u5728\u4e00\u8d77\uff0c\u6240\u4ee5\u5176\u5b9e Clam-shell topology \u5c31\u662f\u5f62\u8c61\u5730\u8868\u793a\u5728 PCB \u7684\u6b63\u9762\u548c\u80cc\u9762\u90fd\u6709 SDRAM \u82af\u7247\u7684\u60c5\u5f62\uff1a</p>    ![](sdram_clam_shell.png){ width=\"400\" }   Clam-shell Topology\uff08\u56fe\u6e90Versal ACAP Programmable Network on Chip and Integrated Memory Controller LogiCORE IP Product Guide (PG313) \uff09 <p>\u8fd9\u79cd\u8bbe\u8ba1\u5229\u7528\u4e86 PCB \u80cc\u9762\u7684\u7a7a\u95f4\uff0c\u4f46\u662f\u540c\u65f6\u4e5f\u5e26\u6765\u4e86\u65b0\u7684\u95ee\u9898\uff1a\u76f4\u89c2\u5730\u8bb2\uff0c\u5982\u679c\u4e24\u4e2a\u82af\u7247\u90fd\u653e\u5728 PCB \u7684\u6b63\u9762\uff0c\u8981\u8fde\u7ebf\u7684\u8bdd\uff0c\u4fdd\u8bc1\u5f15\u811a\u987a\u5e8f\u63a5\u8fd1\u4e00\u81f4\uff0c\u5c31\u53ef\u4ee5\u6bd4\u8f83\u5bb9\u6613\u5730\u8fde\u63a5\uff0c\u4e0d\u4f1a\u6709\u5f88\u591a\u4ea4\u53c9\u7684\u5730\u65b9\u3002\u4f46\u5982\u679c\u4e00\u4e2a\u5728\u6b63\u9762\uff0c\u53e6\u4e00\u4e2a\u5728\u80cc\u9762\uff0c\u5f15\u811a\u7684\u987a\u5e8f\u5c31\u5012\u8f6c\u8fc7\u6765\u4e86\uff0c\u8fde\u7ebf\u7684\u65f6\u5019\u5c31\u6bd4\u8f83\u56f0\u96be\u3002</p> <p>\u89e3\u51b3\u7684\u529e\u6cd5\u662f\uff0c\u4fee\u6539\u5f15\u811a\u7684\u987a\u5e8f\uff0c\u628a\u4e00\u4e9b\u5f15\u811a\u7684\u529f\u80fd\u8fdb\u884c\u5bf9\u8c03\uff0c\u4f7f\u5f97\u8d70\u7ebf\u66f4\u52a0\u7b80\u5355\uff1a</p>    ![](sdram_pin_mirror.png){ width=\"600\" }   SDRAM \u5f15\u811a\u955c\u50cf\uff08\u56fe\u6e90Versal ACAP PCB Design User Guide (UG863)\uff09 <p>\u8868\u683c\u4e2d\u7279\u610f\u6311\u9009\u4e86\u4e00\u4e9b\u4e0d\u5f71\u54cd\u7279\u6b8a\u529f\u80fd\u7684\u5f15\u811a\u6765\u4ea4\u6362\uff0c\u4f7f\u5f97\u5927\u90e8\u5206\u529f\u80fd\uff0c\u5373\u4f7f\u4ea4\u6362\u4e86\u5f15\u811a\uff0c\u4e5f\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002\u4f8b\u5982 Row \u5730\u5740\u4ea4\u6362\u4e86\u51e0\u4e2a\u4f4d\uff0c\u867d\u7136\u7269\u7406\u4e0a\u4fdd\u5b58\u7684\u5730\u65b9\u53d8\u4e86\uff0c\u4f46\u662f\u4e0d\u5f71\u54cd\u8bfb\u5199\u6570\u636e\u3002\u4f46\u662f\uff0c\u5bf9\u4e8e Mode Register Set \u64cd\u4f5c\uff0c\u5fc5\u987b\u8981\u5185\u5b58\u63a7\u5236\u5668\u81ea\u884c\u4ea4\u6362\u4f4d\u7684\u987a\u5e8f\uff0c\u5728 PCB \u4e0a\u8fde\u63a5\u65f6\u518d\u4ea4\u6362\u56de\u6765\uff0c\u624d\u80fd\u4fdd\u8bc1\u5728 SDRAM \u4e00\u4fa7\u5f97\u5230\u6b63\u786e\u7684\u7ed3\u679c\u3002</p> <p>\u6b64\u5916\uff0cClam-shell Topology \u7684\u6b63\u9762\u548c\u80cc\u9762\u5404\u6709\u4e00\u4e2a cs_n \u7247\u9009\u4fe1\u53f7\uff0c\u4f46\u662f\u8fd9\u548c Dual Rank \u4e0d\u540c\uff1aDual Rank \u662f\u6b63\u9762\u548c\u80cc\u9762\u90fd\u6709\u540c\u6837\u6570\u91cf\u7684 DRAM \u82af\u7247\uff0c\u5171\u4eab\u5730\u5740\u4fe1\u53f7\u3001\u6570\u636e\u4fe1\u53f7\u548c\u63a7\u5236\u4fe1\u53f7\uff0c\u603b\u7ebf\u4e0a\u540c\u4e00\u65f6\u95f4\u53ea\u6709\u4e00\u4fa7\u7684 DRAM \u82af\u7247\u5728\u4f7f\u7528\uff0c\u597d\u5904\u662f\u5185\u5b58\u5bb9\u91cf\u7ffb\u500d\uff0c\u5e76\u4e14\u4e24\u4e2a rank \u53ef\u4ee5\u4e92\u76f8\u63a9\u76d6\u5ef6\u8fdf\uff1b\u800c Clam Shell Topology \u7684\u4e24\u4e2a cs_n \u662f\u4e3a\u4e86\u7ed9 Mode Register Set \u64cd\u4f5c\u6307\u5b9a\u6b63\u9762\u6216\u80cc\u9762\uff0c\u800c\u5176\u4f59\u7684\u5927\u90e8\u5206\u64cd\u4f5c\uff0c\u53ef\u4ee5\u6b63\u9762\u548c\u80cc\u9762\u540c\u65f6\u5de5\u4f5c\uff0c\u56e0\u4e3a\u5b83\u4eec\u7684\u6570\u636e\u4fe1\u53f7\u5e76\u6ca1\u6709\u5171\u4eab\u3002</p>"},{"location":"hardware/sdram.zh/#_9","title":"\u6821\u51c6","text":"<p>SDRAM \u6821\u51c6\uff0c\u6216\u8005\u8bf4 SDRAM \u8bad\u7ec3\uff0c\u4e3b\u8981\u6709\u5982\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a</p> <ol> <li>Write Leveling</li> <li>Read Leveling</li> </ol>"},{"location":"hardware/sdram.zh/#write-leveling","title":"Write Leveling","text":"<p>Write Leveling \u8981\u89e3\u51b3\u7684\u662f Fly-by Topology \u5e26\u6765\u7684\u5ef6\u8fdf\u4e0d\u4e00\u81f4\uff0c\u5bfc\u81f4 SDRAM \u770b\u5230\u9519\u8bef\u7684\u4fe1\u53f7\u7684\u95ee\u9898\u3002\u5177\u4f53\u5730\u8bb2\uff0cWrite Leveling \u7684\u76ee\u7684\u662f\u8ba9 SDRAM \u82af\u7247\u63a5\u53d7\u5230\u7684 DQS \u4fe1\u53f7\u4e0e CK \u4fe1\u53f7\u540c\u6b65\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"ck\", wave: \"1010101010\"},\n      { name: \"dqs\", wave: \"0.101010..\"},\n      { name: \"ck_dram0\", wave: \"1010101010\", phase: -0.2},\n      { name: \"dqs_dram0\", wave: \"0.101010..\", phase: -0.2},\n      { name: \"ck_dram1\", wave: \"1010101010\", phase: -0.4},\n      { name: \"dqs_dram1\", wave: \"0.101010..\", phase: -0.4},\n      { name: \"ck_dram2\", wave: \"1010101010\", phase: -0.6},\n      { name: \"dqs_dram2\", wave: \"0.101010..\", phase: -0.6},\n      { name: \"ck_dram3\", wave: \"1010101010\", phase: -0.8},\n      { name: \"dqs_dram3\", wave: \"0.101010..\", phase: -0.8},\n    ]\n}\n</code></pre> Write Leveling \u6240\u8981\u8fbe\u5230\u7684 DQS \u4e0e CK \u540c\u6b65\u7684\u6548\u679c <p>\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0c\u601d\u8def\u5c31\u662f\u4e0d\u65ad\u8c03\u6574 DQS \u8f93\u51fa\u7684\u5ef6\u8fdf\uff0c\u89c2\u6d4b\u4e0d\u540c\u5ef6\u8fdf\u4e0b\u7684\u884c\u4e3a\uff0c\u627e\u5230\u4e00\u4e2a DQS \u4e0e CK \u540c\u6b65\u7684\u5ef6\u8fdf\u503c\u3002\u4e3a\u4e86\u914d\u5408\u5185\u5b58\u63a7\u5236\u5668\u505a Write Leveling\uff0cSDRAM \u53ef\u4ee5\u8fdb\u5165\u4e00\u4e2a Write Leveling Mode\uff0c\u5728\u8fd9\u4e2a\u72b6\u6001\u4e0b\uff0cSDRAM \u4f1a\u5728 DQS \u7684\u4e0a\u5347\u6cbf\u5bf9 CK \u8fdb\u884c\u91c7\u6837\uff0c\u7136\u540e\u628a\u7ed3\u679c\u8f93\u51fa\u5230 DQ \u4e0a\u3002\u6b64\u65f6\uff0c\u4e0d\u540c\u7684 DQS \u5ef6\u8fdf\u5c31\u4f1a\u5e26\u6765\u4e0d\u540c\u7684\u7ed3\u679c\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"ck\", wave: \"1010101010\"},\n      { name: \"dqs\", wave: \"10........\"},\n      { name: \"ck_dram\", wave: \"1010101010\", phase: -0.2},\n      { name: \"dqs_delay0\", wave: \"010.......\", phase: -0.4},\n      { name: \"dq_delay0\", wave: \"0.........\", phase: -0.4},\n      { name: \"dqs_delay1\", wave: \"010.......\", phase: -0.9},\n      { name: \"dq_delay1\", wave: \"0.........\", phase: -0.9},\n      { name: \"dqs_delay2\", wave: \"010.......\", phase: -1.4},\n      { name: \"dq_delay2\", wave: \"01........\", phase: -1.4},\n      { name: \"dqs_delay3\", wave: \"010.......\", phase: -2.0},\n      { name: \"dq_delay3\", wave: \"01........\", phase: -2.0},\n    ]\n}\n</code></pre> \u4e0d\u540c\u7684 DQS \u5ef6\u8fdf\u4e0b\uff0cDQS \u5bf9 CK \u91c7\u6837\u7684\u7ed3\u679c <p>\u4e0a\u56fe\u4e2d delay0 \u548c delay1 \u4e24\u79cd\u60c5\u51b5\u4e0b\uff0cDQS \u91c7\u6837\u5230\u4e86 CK \u7684\u8d1f\u534a\u5468\u671f\uff0c\u800c delay2 \u548c delay3 \u65f6 DQS \u91c7\u6837\u5230\u4e86 CK \u7684\u6b63\u534a\u5468\u671f\uff0c\u6240\u4ee5\u5982\u679c\u60f3\u8981\u8ba9 DQS \u548c CK \u540c\u6b65\uff0c\u5e94\u8be5\u628a DQS \u5ef6\u8fdf\u8bbe\u7f6e\u5728 delay1 \u548c delay2 \u4e4b\u95f4\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b Write Leveling \u7684\u7b97\u6cd5\uff1a</p> <ol> <li>\u8bbe\u7f6e SDRAM \u8fdb\u5165 Write Leveling \u6a21\u5f0f\uff0c\u6b64\u65f6 SDRAM \u4f1a\u4f7f\u7528 DQS \u5bf9 CK \u91c7\u7528\uff0c\u628a\u7ed3\u679c\u8f93\u51fa\u5230 DQ</li> <li>\u63a7\u5236\u5668\u679a\u4e3e DQS \u7684\u5ef6\u8fdf\uff0c\u8bfb\u53d6\u51fa\u6bcf\u4e2a DQS \u5ef6\u8fdf\u4e0b\u7684 DQ \u7ed3\u679c\uff0c\u5f97\u5230\u4e00\u4e2a 0-1 \u4e32\uff0c\u4f8b\u5982\uff1a<code>001111111111111111110000</code>\uff0c\u5373\u968f\u7740\u5ef6\u8fdf\u589e\u5927\uff0c\u5148\u91c7\u6837\u5230 0\uff0c\u518d\u91c7\u6837\u5230 1\uff0c\u6700\u540e\u53c8\u91c7\u6837\u5230 0</li> <li>\u627e\u5230\u4e00\u4e2a DQS \u5ef6\u8fdf\uff0c\u4f7f\u5f97 DQ \u51fa\u73b0\u4e00\u4e2a\u4ece 0 \u5230 1 \u7684\u53d8\u5316\uff0c\u90a3\u4e48\u6309\u7167\u8fd9\u4e2a\u5ef6\u8fdf\u8f93\u51fa\uff0cDQS \u5c31\u4f1a\u4e0e CK \u540c\u6b65</li> <li>\u8bbe\u7f6e SDRAM \u7ed3\u675f Write Leveling \u6a21\u5f0f</li> </ol> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u8981\u5bf9\u6bcf\u4e2a DQS \u4fe1\u53f7\u5206\u522b\u8fdb\u884c\u3002\u4e0b\u9762\u4ee5 litex \u7684 SDRAM \u6821\u51c6\u4ee3\u7801\u4e3a\u4f8b\uff0c\u7528 C \u4ee3\u7801\u5b9e\u73b0\u7b80\u5316\u7684\u6d41\u7a0b\uff1a</p> int sdram_write_leveling_scan(int *delays, int loops, int show)<pre><code>/* \u6253\u5f00 SDRAM \u7684 Write Leveling \u6a21\u5f0f */\nsdram_write_leveling_on();\n\n/* \u5faa\u73af\u6bcf\u4e2a SDRAM \u5185\u5b58\u6761 */\nfor(i=0;i&lt;SDRAM_PHY_MODULES;i++) {\n  /* \u5faa\u73af\u6bcf\u4e2a DQS \u4fe1\u53f7 */\n  for (dq_line = 0; dq_line &lt; DQ_COUNT; dq_line++) {\n    /* \u8bbe\u7f6e DQS \u521d\u59cb\u5ef6\u8fdf\u4e3a 0 */\n    sdram_leveling_action(i, dq_line, write_rst_delay);\n\n    /* \u5faa\u73af DQS \u5ef6\u8fdf */\n    for(j=0;j&lt;err_ddrphy_wdly;j++) {\n      int zero_count = 0;\n      int one_count = 0;\n\n      /* \u591a\u6b21\u91c7\u6837 */\n      for (k=0; k&lt;loops; k++) {\n        /* \u53d1\u9001 DQS \u5e8f\u5217\uff1a00000001 */\n        /* SDRAM \u5bf9 CK \u8fdb\u884c\u91c7\u6837 */\n        ddrphy_wlevel_strobe_write(1);\n\n        cdelay(100);\n        /* \u4ece\u5185\u5b58\u63a7\u5236\u5668\u4e2d\u8bfb\u51fa DQ \u4e0a\u7684\u6570\u636e */\n        csr_rd_buf_uint8(sdram_dfii_pix_rddata_addr(0), buf, DFII_PIX_DATA_BYTES);\n\n        /* \u7edf\u8ba1 1 \u548c 0 \u7684\u4e2a\u6570 */\n        if (buf[SDRAM_PHY_MODULES-1-i] != 0)\n          one_count++;\n        else\n          zero_count++;\n      }\n      if (one_count &gt; zero_count)\n        /* \u8ba4\u4e3a DQS \u91c7\u6837\u5230\u4e86 CK \u7684\u6b63\u534a\u5468\u671f */\n        taps_scan[j] = 1;\n      else\n        /* \u8ba4\u4e3a DQS \u91c7\u6837\u5230\u4e86 CK \u7684\u8d1f\u534a\u5468\u671f */\n        taps_scan[j] = 0;\n\n      /* \u6bcf\u6b21\u5faa\u73af\u589e\u52a0\u4e00\u6b21 DQS \u5ef6\u8fdf */\n      sdram_leveling_action(i, dq_line, write_inc_delay);\n    }\n\n    /* \u627e\u5230\u4e00\u4e2a\u6700\u957f\u7684\u8fde\u7eed 1 \u7684\u5e8f\u5217 */\n    one_window_active = 0;\n    one_window_start = 0;\n    one_window_count = 0;\n    one_window_best_start = 0;\n    one_window_best_count = -1;\n    for(j=0;j&lt;err_ddrphy_wdly+1;j++) {\n      if (one_window_active) {\n        if ((j == err_ddrphy_wdly) || (taps_scan[j] == 0)) {\n          /* \u7ed3\u675f\u4e86\u4e00\u6bb5\u8fde\u7eed\u7684 1 */\n          one_window_active = 0;\n          one_window_count = j - one_window_start;\n          /* \u8bb0\u5f55\u6700\u957f\u7684\u8fde\u7eed 1 \u7684\u957f\u5ea6\u548c\u4f4d\u7f6e */\n          if (one_window_count &gt; one_window_best_count) {\n            one_window_best_start = one_window_start;\n            one_window_best_count = one_window_count;\n          }\n        }\n      } else {\n        /* \u627e\u5230\u8fde\u7eed\u7684 1 \u7684\u5f00\u5934 */\n        if (j != err_ddrphy_wdly &amp;&amp; taps_scan[j]) {\n          one_window_active = 1;\n          one_window_start = j;\n        }\n      }\n    }\n\n    /* \u8981\u627e\u7684\u5ef6\u8fdf\u5c31\u662f\u8fde\u7eed\u7684 1 \u5e8f\u5217\u7684\u5f00\u59cb\u4f4d\u7f6e */\n    delays[i] = one_window_best_start;\n  }\n}\n\n/* \u5173\u95ed SDRAM \u7684 Write Leveling \u6a21\u5f0f */\nsdram_write_leveling_off();\n</code></pre>"},{"location":"hardware/sdram.zh/#read-leveling","title":"Read Leveling","text":"<p>\u5728 Write Leveling \u9636\u6bb5\uff0c\u89e3\u51b3\u4e86 SDRAM \u5904\u4fe1\u53f7\u7684\u540c\u6b65\u95ee\u9898\u3002\u4f46\u662f\u5bf9\u4e8e\u8bfb\u64cd\u4f5c\uff0c\u6570\u636e\u662f\u4ece SDRAM \u53d1\u9001\u7ed9\u63a7\u5236\u5668\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5230\u8fbe\u63a7\u5236\u5668\u7684\u65f6\u95f4\u53ef\u80fd\u4e5f\u4e0d\u540c\uff0c\u56e0\u6b64\u4e5f\u9700\u8981\u5bf9\u8bfb\u64cd\u4f5c\u8fdb\u884c\u6821\u51c6\u3002</p> <p>\u4e3a\u4e86\u5224\u65ad\u8bfb\u53d6\u7684\u6570\u636e\u662f\u5426\u6b63\u786e\uff0c\u505a\u6cd5\u662f\u9996\u5148\u5199\u5165\u5df2\u77e5\u7684\u6570\u636e\uff0c\u7136\u540e\u518d\u8bfb\u51fa\u6765\uff0c\u5982\u679c\u8bfb\u53d6\u7684\u6570\u636e\u548c\u5199\u5165\u7684\u6570\u636e\u5b8c\u5168\u4e00\u81f4\uff0c\u5c31\u8bf4\u660e\u53ef\u4ee5\u6b63\u786e\u5730\u8fdb\u884c\u8bfb\u64cd\u4f5c\u3002</p> <p>\u5b9e\u73b0\u601d\u8def\u548c Write Leveling \u7c7b\u4f3c\uff0c\u4e5f\u662f\u679a\u4e3e\u5ef6\u8fdf\uff0c\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\uff0c\u89c2\u5bdf\u6bcf\u4e2a\u5ef6\u8fdf\u4e0b\u7684\u8f93\u51fa\uff1a</p> <ol> <li>\u5199\u5165\u6570\u636e\uff08\u6216\u8005\u7528 SDRAM \u7684\u751f\u6210\u56fa\u5b9a Pattern \u8f93\u51fa\u7684\u529f\u80fd\uff09</li> <li>\u8bbe\u7f6e\u5ef6\u8fdf\u4ece 0 \u5f00\u59cb\u5faa\u73af\uff0c\u4e0d\u65ad\u589e\u5927</li> <li>\u5728\u6bcf\u4e2a\u5ef6\u8fdf\u7684\u8bbe\u5b9a\u4e0b\uff0c\u8bfb\u53d6\u51fa\u6570\u636e\uff0c\u628a\u8bfb\u53d6\u7684\u7ed3\u679c\u4e0e\u4e4b\u524d\u5199\u5165\u7684\u6570\u636e\u8fdb\u884c\u6bd4\u8f83</li> <li>\u7edf\u8ba1\u51fa\u54ea\u4e9b\u5ef6\u8fdf\u6761\u4ef6\u4e0b\uff0c\u8bfb\u53d6\u6570\u636e\u662f\u51c6\u786e\u7684\uff0c\u51c6\u786e\u7684\u8bb0\u4e3a 1\uff0c\u4e0d\u51c6\u786e\u7684\u8bb0\u4e3a 0</li> <li>\u627e\u5230\u8868\u793a\u51c6\u786e\u7684 1 \u7684\u8303\u56f4\uff0c\u53d6\u4e2d\u70b9\u4f5c\u4e3a\u6700\u7ec8\u7684\u6821\u51c6\u7ed3\u679c</li> </ol> <p>\u6ce8\u610f\u8fd9\u91cc\u4e0d\u518d\u662f\u627e\u5230 0-1 \u7684\u53d8\u5316\u7684\u5730\u65b9\uff0cWrite Leveling \u627e 0-1 \u53d8\u5316\u662f\u4e3a\u4e86\u540c\u6b65\uff0c\u540c\u6b65\u7684\u5730\u65b9\u6b63\u662f 0-1 \u53d8\u5316\u7684\u5730\u65b9\uff1b\u800c Read Leveling \u7684\u76ee\u7684\u662f\u8981\u8bfb\u53d6\u51fa\u6b63\u786e\u7684\u6570\u636e\uff0c\u5df2\u77e5\u6709\u4e00\u6bb5\u8fde\u7eed\u7684\u5ef6\u8fdf\u533a\u95f4\uff0c\u533a\u95f4\u5185\u90fd\u53ef\u4ee5\u8bfb\u51fa\u6b63\u786e\u7684\u6570\u636e\uff0c\u90a3\u4e48\u53d6\u5176\u4e2d\u70b9\uff0c\u5373\u4f7f\u56e0\u4e3a\u6e29\u5ea6\u7b49\u6761\u4ef6\u53d8\u5316\uff0c\u533a\u95f4\u51fa\u73b0\u79fb\u52a8\uff0c\u56e0\u4e3a\u4fdd\u7559\u4e86\u8db3\u591f\u7684\u4f59\u91cf\uff0c\u6240\u4ee5\u4f9d\u7136\u53ef\u4ee5\u5de5\u4f5c\u3002\u53d6\u4e2d\u70b9\u8fd9\u4e00\u6b65\u4e5f\u79f0\u4e3a Read Centering\u3002</p>"},{"location":"hardware/sdram.zh/#hbm","title":"HBM","text":"<p>HBM \u5168\u79f0\u662f High Bandwidth Memory\uff0c\u4e5f\u5c31\u662f\u9ad8\u5e26\u5bbd\u5185\u5b58\uff0c\u5176\u6280\u672f\u4e5f\u662f\u57fa\u4e8e SDRAM\uff0c\u56e0\u6b64\u653e\u5728\u8fd9\u91cc\u548c DDR SDRAM \u8fdb\u884c\u5bf9\u6bd4\u3002</p> <p>HBM \u76f8\u6bd4\u524d\u9762\u7684 DDR SDRAM\uff0c\u5b83\u5806\u53e0\u4e86\u591a\u4e2a SDRAM\uff0c\u63d0\u4f9b\u591a\u4e2a channel \u5e76\u4e14\u63d0\u9ad8\u4e86\u4f4d\u5bbd\u3002\u4f8b\u5982 Micron HBM with ECC\uff0c\u5806\u53e0\u4e86 4/8 \u5c42 DRAM\uff0c\u63d0\u4f9b\u4e86 8 \u4e2a channel\uff0c\u6bcf\u4e2a channel \u7684\u6570\u636e\u5bbd\u5ea6\u662f 128 \u4f4d\uff0c\u4ee5 3200 MT/s \u8ba1\u7b97\uff0c\u4e00\u4e2a HBM \u82af\u7247\u7684\u6570\u636e\u4f20\u8f93\u901f\u7387\u6700\u5927\u662f\uff1a</p>  3200 \\mathrm{(MT/s)} * 128 \\mathrm{(bits/transfer)} * 8 \\mathrm{(Channels)} = 3276.8 \\mathrm{(Gb/s)} = 409.6 \\mathrm{(GB/s)}  <p>\u6240\u4ee5\u4e00\u7247 HBM \u7684\u4f20\u8f93\u901f\u7387\u5c31\u76f8\u5f53\u4e8e 16 \u4e2a\u4f20\u7edf\u7684 DDR SDRAM\uff0c\u9760\u7684\u662f 8 \u4e2a Channel \u4ee5\u53ca\u53cc\u500d\u7684\u4f4d\u5bbd\u3002\u6bcf\u4e2a Channel \u7684\u4f4d\u5bbd\u662f 128 \u4f4d\uff0c\u5b9e\u9645\u4e0a\u53ef\u4ee5\u8ba4\u4e3a\u662f\u628a\u4e24\u7247 64-bit SDRAM \u5e76\u8d77\u6765\u4e86\uff0c\u53ef\u4ee5\u5f53\u6210\u4e00\u4e2a 128 \u4f4d\u7684\u7528\uff0c\u4e5f\u53ef\u4ee5\u5728 Pseudo Channel \u6a21\u5f0f\u4e0b\uff0c\u5f53\u6210\u5171\u4eab\u5730\u5740\u548c\u547d\u4ee4\u4fe1\u53f7\u7684\u4e24\u4e2a SDRAM \u7528\u3002</p> <p>\u5f53\u7136\u4e86\uff0cHBM \u7684\u9ad8\u5e26\u5bbd\u7684\u4ee3\u4ef7\u5c31\u662f\u5f15\u811a\u6570\u91cf\u5f88\u591a\u3002\u6839\u636e HBM3 JESD238A \u6807\u51c6\uff0c\u6bcf\u4e2a Channel \u8981 120 \u4e2a pin\uff0c\u4e00\u5171 16 \u4e2a channel\uff08HBM2 \u662f 8 channel\uff0c\u6bcf\u4e2a channel 128 \u4f4d\uff1bHBM3 \u662f 16 channel\uff0c\u6bcf\u4e2a channel 64 \u4f4d\uff09\uff0c\u52a0\u4e0a\u5176\u4f59\u7684 52 \u4e2a pin\uff0c\u8fd9\u4e9b\u52a0\u8d77\u6765\u5c31 1972 \u4e2a pin \u4e86\u3002\u6240\u4ee5\u4e00\u822c\u5728 Silicon Interposer \u4e0a\u4e0e\u5904\u7406\u5668\u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u4f20\u7edf\u7684\u5728 PCB \u4e0a\u8d70\u7ebf\uff1a</p>    ![](sdram_hbm_stack.png){ width=\"800\" }   HBM \u7684\u5c01\u88c5\u5f62\u5f0f\uff08\u56fe\u6e90 A 1.2V 20nm 307GB/s HBM DRAM with At-Speed Wafer-Level I/O Test Scheme and Adaptive Refresh Considering Temperature Distribution\uff09 <p>\u6240\u4ee5\u5728 HBM3 \u6807\u51c6\u91cc\uff0c\u7528 Microbump \u6765\u63cf\u8ff0 HBM \u7684 pin\u3002\u53ef\u4ee5\u5f62\u8c61\u5730\u7406\u89e3\u4e3a\uff0c\u628a\u539f\u6765\u63d2\u5728\u4e3b\u677f\u4e0a\u7684\u5185\u5b58\u6761\u62c6\u5f00\uff0c\u53ea\u4fdd\u7559\u82af\u7247\uff0c\u628a\u82af\u7247\u7ad6\u76f4\u5806\u53e0\u8d77\u6765\uff0c\u53d8\u6210\u4e00\u4e2a HBM Die\uff0c\u7136\u540e\u7d27\u5bc6\u5730\u8fde\u63a5\u5230 CPU \u4e2d\u3002\u4f46\u662f\u53e6\u4e00\u65b9\u9762\uff0c\u5bc6\u5ea6\u4e0a\u53bb\u4e86\uff0c\u4ef7\u683c\u4e5f\u66f4\u8d35\u4e86\u3002\u540c\u65f6\u6269\u5c55\u6027\u4e5f\u4e0b\u964d\u4e86\uff0c\u4e0d\u80fd\u50cf DDR SDRAM \u90a3\u6837\u5728\u4e3b\u677f\u4e0a\u63d2\u5f88\u591a\u6761\u3002</p> <p>\u4e0b\u9762\u6765\u5206\u6790\u4e00\u4e9b\u5178\u578b\u7684\u5e26\u6709 HBM \u7684\u7cfb\u7edf\u7684\u5185\u5b58\u5e26\u5bbd\uff1a</p> <p>Xilinx \u7684 Virtex Ultrascale Plus HBM FPGA \u63d0\u4f9b\u4e86 1800 \\mathrm{(MT/s)} * 128 \\mathrm{(bits/transfer)} * 8 \\mathrm{(Channels)} = 230.4 \\mathrm{(GB/s)} \u7684\u5e26\u5bbd\uff0c\u5982\u679c\u7528\u4e86\u4e24\u7247 HBM \u5c31\u662f 460.8 GB/s\u3002\u66b4\u9732\u7ed9 FPGA \u903b\u8f91\u7684\u662f 16 \u4e2a 256 \u4f4d\u7684 AXI3 \u7aef\u53e3\uff0cAXI \u9891\u7387 450 MHz\uff0c\u5185\u5b58\u9891\u7387 900 MHz\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u6bcf\u4e2a AXI3 \u5c31\u5bf9\u5e94\u4e86\u4e00\u4e2a HBM \u7684 pseudo channel\u3002\u6bcf\u4e2a pseudo channel \u662f 64 \u4f4d\uff0c\u4f46\u662f AXI \u7aef\u53e3\u662f 256 \u4f4d\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u901f\u7387\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u4ece 450MHz \u5230 900MHz\uff0c\u518d\u52a0\u4e0a DDR\uff0c\u7b49\u4ef7\u4e8e\u9891\u7387\u7ffb\u4e86\u56db\u500d\uff0c\u6240\u4ee5\u4f4d\u5bbd\u4e5f\u8981\u76f8\u5e94\u5730\u4ece 64 \u4f4d\u7ffb\u56db\u500d\u5230 256 \u4f4d\u3002</p> <p>A100 \u663e\u5361 40GB PCIe \u7248\u672c\u91c7\u7528\u4e86 5 \u4e2a 8 GB \u7684 HBM \u5185\u5b58\uff0c\u8fd0\u884c\u5728 1215 MHz \u7684\u9891\u7387\u4e0b\uff0c\u90a3\u4e48\u5185\u5b58\u5e26\u5bbd\u5c31\u662f 1215 \\mathrm{(MHz)} * 2 \\mathrm{(DDR)} * 8 \\mathrm{(channels)} * 128 \\mathrm{(bits/transfer)} / 8 \\mathrm{(bits/byte)} * 5 \\mathrm{(HBM)} = 1555 \\mathrm{(GB/s)}\uff0c\u4e0e Datasheet \u543b\u5408\u3002A100 Datasheet \u4e2d\u7684 Memory bus width \u7684\u8ba1\u7b97\u65b9\u5f0f\u5176\u5b9e\u5c31\u662f\u628a\u6240\u6709\u7684 Channel \u4f4d\u5bbd\u52a0\u8d77\u6765\uff1a128 \\mathrm{(bits/transfer)} * 8 \\mathrm{(channels)} * 5 \\mathrm{(stacks)} = 5120 \\mathrm{(bits)}\u3002</p> <p>A100 \u663e\u5361 80GB PCIe \u7248\u672c\u628a HBM2 \u5347\u7ea7\u5230\u4e86 HBM2e\uff0c\u540c\u65f6\u5185\u5b58\u65f6\u949f\u9891\u7387\u4e5f\u5347\u7ea7\u5230\u4e86 1512 MHz\uff0c\u6b64\u65f6\u5185\u5b58\u5e26\u5bbd\u5c31\u662f 1512 \\mathrm{(MHz)} * 2 \\mathrm{(DDR)} * 8 \\mathrm{(channels)} * 128 \\mathrm{(bits/transfer)} / 8 \\mathrm{(bits/byte)} * 5 \\mathrm{(HBM)} = 1935 \\mathrm{(GB/s)}\uff0c\u4e0e Datasheet \u543b\u5408\u3002</p> <p>H100 \u663e\u5361 80GB SXM5 \u7248\u672c\u628a HBM \u5347\u7ea7\u5230\u4e86 HBM3\uff0c\u5185\u5b58\u5bb9\u91cf\u4f9d\u7136\u662f 80GB\uff0c\u4f46\u662f\u65f6\u949f\u9891\u7387\u63d0\u9ad8\u5230\u4e86 2619 MHz\uff0c\u6b64\u65f6\uff0c\u5185\u5b58\u5e26\u5bbd\u662f 2619 \\mathrm{(MHz)} * 2 \\mathrm{(DDR)} * 8 \\mathrm{(channels)} * 128 \\mathrm{(bits/transfer)} / 8 \\mathrm{(bits/byte)} * 5 \\mathrm{(HBM)} = 3352 \\mathrm{(GB/s)}\u3002</p>"},{"location":"hardware/sdram.zh/#dram-cell","title":"DRAM Cell","text":"<p>DRAM \u7684\u6570\u636e\u5b58\u50a8\u5728\u7535\u5bb9\u4e2d\u3002\u5178\u578b\u7684 1T DRAM Cell \u5185\u90e8\u6784\u9020\u5982\u4e0b\uff1a</p>    ![1T DRAM Cell](sdram_dram_cell.png){ width=\"400\" }   1T DRAM Cell \u5185\u90e8\u6784\u9020\uff08\u56fe\u6e90 Berkeley EECS 151/251A Spring 2019\uff09"},{"location":"hardware/sdram.zh/#ddr","title":"\u51e0\u79cd DDR \u7684\u5bf9\u6bd4","text":"<p>\u4e0b\u9762\u7ed9\u51fa DDR\uff0cLPDDR\uff0cGDDR \u548c HBM \u7684\u5bf9\u6bd4\uff1a</p> DDR4 DDR5 LPDDR4 LPDDR5 GDDR5 GDDR6 HBM2 Channel \u6570\u91cf 1 2 2 2 2 2 8 \u6bcf Channel \u4f4d\u5bbd 64 32 16 16/32 16 16 128 \u6570\u636e\u901f\u7387\uff08MT/s\uff09 3200 5600 4266 6400 9000 24000 2400 \u603b\u5e26\u5bbd\uff08GB/s\uff09 25.6 GB/s 44.8 GB/s 17.1 GB/s 25.6 GB/s 36 GB/s 96 GB/s 307 GB/s <p>\u6570\u636e\u901f\u7387\u6309\u7167\u80fd\u67e5\u5230\u7684\u578b\u53f7\u7684\u6700\u9ad8\u6027\u80fd\uff1a</p> <ul> <li>DDR4: Micron 3200 MT/s</li> <li>DDR5: Micron 5600 MT/s</li> <li>LPDDR4: Samsung 4266 MT/s</li> <li>LPDDR5: Samsung 6400 MT/s</li> <li>GDDR5: Samsung 9000 MT/s</li> <li>GDDR6: Samsung 24000 MT/s</li> <li>HBM2: Samsung 2400 MT/s</li> <li>HBM2E: Micron 3200 MT/s</li> </ul>"},{"location":"hardware/sdram.zh/#_10","title":"\u76f8\u5173\u9605\u8bfb","text":"<ul> <li>DDR4 Bank Groups in Embedded Applications</li> <li>DDR4 Tutorial - Understanding the Basics</li> <li>DDR5/4/3/2: How Memory Density and Speed Increased with each Generation of DDR</li> <li>DDR5 vs DDR4 DRAM \u2013 All the Advantages &amp; Design Challenges</li> <li>Understanding DDR3 Write Leveling and Read Leveling</li> <li>Will HBM replace DDR and become Computer Memory?</li> </ul>"},{"location":"hardware/spi/","title":"SPI","text":""},{"location":"hardware/spi/#_1","title":"\u63a5\u53e3","text":"<p>SPI \u534f\u8bae\u6d89\u53ca\u5230\u56db\u4e2a\u4fe1\u53f7\uff1a</p> <ul> <li>SCLK: \u65f6\u949f\u4fe1\u53f7\uff0cMaster -&gt; Slave</li> <li>MOSI\uff1a\u6570\u636e\u4fe1\u53f7\uff0cMaster -&gt; Slave</li> <li>MISO\uff1a\u6570\u636e\u4fe1\u53f7\uff0cSlave -&gt; Master</li> <li>CS\uff1a\u82af\u7247\u4f7f\u80fd\uff0c\u4e00\u822c\u662f\u4f4e\u6709\u6548</li> </ul> <p>\u8981\u901a\u8fc7 SPI \u534f\u8bae\u53d1\u9001\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u901a\u5e38\u9700\u8981\u5148\u62c9\u4f4e CS\uff0c\u7136\u540e\u542f\u52a8 SCLK \u65f6\u949f\uff0c\u540c\u65f6\u6536\u53d1\u6570\u636e\u3002\u6ce8\u610f SPI \u662f\u5168\u53cc\u5de5\u7684\uff0c\u4e5f\u5c31\u662f\u53d1\u9001\u7684\u540c\u65f6\u4e5f\u5728\u63a5\u6536\uff0c\u53ea\u4e0d\u8fc7\u901a\u5e38\u6765\u8bf4\uff0c\u5916\u8bbe\u7b49\u5230\u4e3b\u673a\u53d1\u9001\u4e86\u547d\u4ee4\u672c\u8eab\uff0c\u624d\u77e5\u9053\u8981\u56de\u590d\u4ec0\u4e48\uff0c\u6240\u4ee5\u5f88\u591a\u65f6\u5019\u547d\u4ee4\u8bbe\u8ba1\u6210\u4e86\u4e8b\u5b9e\u4e0a\u7684\u534a\u53cc\u5de5\uff1a\u524d\u534a\u90e8\u5206\u4e3b\u673a\u5728\u53d1\u547d\u4ee4\uff0c\u5916\u8bbe\u53d1\u9001\u65e0\u7528\u7684\u6570\u636e\uff1b\u540e\u534a\u90e8\u5206\u5916\u8bbe\u5728\u53d1\u9001\u54cd\u5e94\uff0c\u4e3b\u673a\u53d1\u9001\u65e0\u7528\u7684\u6570\u636e\u3002</p>"},{"location":"hardware/spi/#_2","title":"\u6ce2\u5f62","text":"<p>SPI \u6709\u4e0d\u540c\u7684\u7c7b\u578b\uff0c\u4e0b\u9762\u8bb2\u4e00\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u914d\u7f6e\uff08\u5373 CPOL=0\uff0cCPHA=0\uff09\uff0c\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0cMaster \u548c Slave \u90fd\u662f\u5728\u65f6\u949f\u7684\u4e0b\u964d\u6cbf\u4fee\u6539\u8f93\u51fa\u7684\u6570\u636e\uff0c\u7136\u540e\u5728\u65f6\u949f\uff08<code>sclk</code>\uff09\u7684\u4e0a\u5347\u6cbf\u5bf9\u63a5\u6536\u5230\u7684\u6570\u636e\u8fdb\u884c\u91c7\u6837\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"clk\", wave: \"p........\"},\n      { name: \"sclk\", wave: \"0.101010.\"},\n      { name: \"mosi\", wave: \"03.4.5.x.\"},\n      { name: \"miso\", wave: \"06.7.8.x.\"},\n      { name: \"cs_n\", wave: \"10......1\"},\n    ]\n}\n</code></pre> <p>\u6ce2\u5f62\u56fe\u4e2d\uff0c\u65f6\u949f\uff08<code>sclk</code>\uff09\u4e0a\u5347\u6cbf\u65f6\uff0c\u6570\u636e\u5904\u4e8e\u7a33\u5b9a\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u6b64\u65f6 Master \u5bf9 MISO \u91c7\u6837\uff0cSlave \u5bf9 MOSI \u91c7\u6837\uff0c\u53ef\u4ee5\u5f97\u5230\u7a33\u5b9a\u7684\u6570\u636e\uff1b\u65f6\u949f\u4e0b\u964d\u6cbf\u65f6\uff0cMaster \u548c Slave \u4fee\u6539\u8f93\u51fa\u7684\u6570\u636e\u3002</p> <p>\u5b9e\u9645\u5728 RTL \u4e2d\u5b9e\u73b0\u7684\u65f6\u5019\uff0cMaster \u53ef\u4ee5\u4e0d\u5199 negedge \u903b\u8f91\uff0c\u800c\u662f\u5199\u4e00\u4e2a\u5206\u9891\u5668\uff0c\u5728\u5206\u9891\u51fa\u6765\u7684\u8d1f\u534a\u5468\u671f\u91cc\uff0c\u5b9e\u73b0\u6570\u636e\u7684\u4fee\u6539\uff0c\u5982\u4e0a\u56fe\u4e2d\u7684 <code>clk</code> \u5206\u9891\u5230 <code>sclk</code>\u3002\u4e00\u822c\u4f7f\u7528\u4e00\u4e2a\u72b6\u6001\u673a\u6765\u5b9e\u73b0 SPI Master\uff0c\u8bb0\u5f55\u5f53\u524d\u4f20\u8f93\u5230\u54ea\u4e00\u4e2a bit\uff0c\u4ee5\u53ca\u8bb0\u5f55\u5f53\u524d\u662f <code>sclk</code> \u7684\u6b63\u534a\u5468\u671f\u8fd8\u662f\u8d1f\u534a\u5468\u671f\u3002</p> <p>SPI \u672c\u8eab\u5f88\u7b80\u5355\uff0c\u6240\u4ee5\u6838\u5fc3\u4e0d\u5728 SPI\uff0c\u800c\u662f\u5728 SPI \u4e4b\u4e0a\u5b9a\u4e49\u7684\u5404\u79cd\u534f\u8bae\u3002</p>"},{"location":"hardware/spi/#spi-flash","title":"SPI Flash","text":"<p>SPI Flash \u662f\u4e00\u79cd\u5f88\u5e38\u89c1\u7684 SPI \u5916\u8bbe\uff0c\u53ef\u4ee5\u7528\u6765\u8bbf\u95ee NAND/NOR Flash\u3002</p> <p>\u4e3a\u4e86\u63d0\u5347\u6027\u80fd\uff0c\u5f88\u591a SPI Flash \u8fd8\u4f1a\u63d0\u4f9b Dual SPI \u548c Quad SPI \u6a21\u5f0f\u3002\u6807\u51c6\u7684 SPI \u4e2d\uff0cMaster \u5230 Slave \u548c Slave \u5230 Master \u5206\u522b\u662f\u4e00\u6839\u4fe1\u53f7\u7ebf\uff0c\u5982\u679c\u8981\u7ee7\u7eed\u63d0\u9ad8\u6027\u80fd\uff0c\u90a3\u5c31\u8981\u5f15\u5165\u66f4\u591a\u7684\u4fe1\u53f7\u7ebf\u6765\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c\u6240\u4ee5 Dual SPI \u5c31\u662f\u8ba9\u539f\u6765\u7684 MISO \u548c MOSI \u90fd\u53ef\u4ee5\u540c\u65f6\u53d1\u9001\u6570\u636e\uff1bQuad SPI \u5219\u662f\u53c8\u989d\u5916\u6dfb\u52a0\u4e86\u4e24\u4e2a\u4fe1\u53f7\u7ebf\u6765\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002</p> <p>\u5e38\u89c1\u7684 SPI Flash \u5382\u5bb6\uff1a</p> <ul> <li>Spansion -&gt; Cypress -&gt; Infineon</li> <li>Numonyx -&gt; Micron</li> <li>Winbond</li> <li>GigaDevice</li> <li>Macronix</li> </ul>"},{"location":"hardware/spi/#spi-nand-flash","title":"SPI NAND Flash","text":"<p>\u4e0b\u9762\u4ee5 Alliance Memory SPI NAND Flash Datasheet \u4e3a\u4f8b\u5b50\uff0c\u770b\u770b\u901a\u5e38 SPI Flash \u90fd\u652f\u6301\u54ea\u4e9b\u547d\u4ee4\uff0c\u90fd\u662f\u5982\u4f55\u4f20\u8f93\u6570\u636e\u7684\u3002</p> <p>\u8fd9\u6b3e SPI NAND Flash \u7684\u5185\u90e8\u5b58\u50a8\u5206\u4e3a\u4e09\u5c42\uff1a</p> <ol> <li>Block\uff1a\u6570\u91cf\u4e0d\u5b9a</li> <li>Page\uff1a\u6bcf\u4e2a Block \u5305\u62ec 64 \u4e2a Page</li> <li>Byte\uff1a\u6bcf\u4e2a Page \u5305\u62ec\u4e00\u5b9a\u6570\u91cf\u7684 Byte\uff0c\u5e38\u89c1\u7684\u6709 2112(2048+64)\u30012176(2048+128)\u30014352(4096+256)</li> </ol> <p>NAND Flash \u7684\u8bfb\u53d6\u7c92\u5ea6\u662f Page\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48 NAND Flash \u66f4\u50cf\u5757\u8bbe\u5907\u3002\u4e00\u6b21\u8bfb\u53d6\u8fc7\u7a0b\u5206\u4e3a\u4e09\u4e2a\u6b65\u9aa4\uff1a</p> <ol> <li>\u53d1\u9001 13H(Page Read to Cache) \u547d\u4ee4\uff0c\u628a\u4e00\u4e2a Page \u7684\u6570\u636e\u8bfb\u53d6\u5230 NAND Flash \u5185\u90e8\u7684 Cache \u4e2d</li> <li>\u4e0d\u65ad\u53d1\u9001 0FH(Get Feature) \u547d\u4ee4\uff0c\u76f4\u5230 NAND Flash \u8868\u793a Page Read to Cache \u547d\u4ee4\u5b8c\u6210</li> <li>\u53d1\u9001 Read from Cache \u547d\u4ee4\uff0c\u8003\u8651\u5230\u4f20\u8f93\u7684\u65b9\u5f0f\u4e0d\u540c\uff0c\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a<ol> <li>Read from Cache x1 IO(03H/0BH): Master \u7ed9\u51fa 1 \u5b57\u8282\u547d\u4ee4\uff0c2 \u5b57\u8282\u5730\u5740\u548c 1 \u5b57\u8282 dummy \u6570\u636e\uff0c\u5171 8(COMMAND)+16(ADDR)+8(DUMMY) \u4e2a\u5468\u671f\uff0c\u4e4b\u540e Slave \u4ece MISO \u7ed9\u51fa\u6570\u636e</li> <li>Read from Cache x2 IO(3BH): Slave \u540c\u65f6\u901a\u8fc7 MISO \u548c MOSI \u7ed9\u51fa\u6570\u636e</li> <li>Read from Cache x4 IO(6BH): Slave \u540c\u65f6\u901a\u8fc7 MISO\u3001MOSI\u3001WP# \u548c HOLD# \u7ed9\u51fa\u6570\u636e</li> <li>Read from Cache Dual IO(BBH): \u5728 3BH \u7684\u57fa\u7840\u4e0a\uff0cMaster \u4e5f\u540c\u65f6\u901a\u8fc7 MISO \u548c MOSI \u7ed9\u51fa\u5730\u5740\u548c dummy \u5b57\u8282\uff0c\u6240\u4ee5 Master \u53ea\u5360\u7528 8(COMMAND)+8(ADDR)+4(DUMMY) \u4e2a\u5468\u671f\u7684\u65f6\u95f4\u53d1\u9001</li> <li>Read from Cache Quad IO(EBH): \u5728 6BH \u7684\u57fa\u7840\u4e0a\uff0cMaster \u4e5f\u540c\u65f6\u901a\u8fc7\u56db\u4e2a\u6570\u636e\u4fe1\u53f7\u7ed9\u51fa\u5730\u5740\u548c dummy \u5b57\u8282\uff0c\u6240\u4ee5 Master \u53ea\u5360\u7528 8(COMMAND)+4(ADDR)+2(DUMMY) \u4e2a\u5468\u671f\u7684\u65f6\u95f4\u53d1\u9001</li> </ol> </li> </ol> <p>\u5199\u5165\u7684\u65f6\u5019\uff0c\u7531\u4e8e NAND Flash \u7684\u7279\u6027\uff0c\u9996\u5148\u9700\u8981\u64e6\u9664\uff0c\u628a\u4e00\u4e2a Block \u7684\u5185\u5bb9\u5168\u90e8\u64e6\u9664\uff0c\u9700\u8981\u6ce8\u610f\u6bcf\u4e2a Block \u5305\u62ec\u591a\u4e2a Page\uff0c\u6240\u4ee5\u64e6\u9664\u7684\u7c92\u5ea6\u662f\u5f88\u7c97\u7684\u3002\u64e6\u9664\u8fc7\u7684 Page \u624d\u53ef\u4ee5\u8fdb\u884c\u5199\u5165\uff0c\u5177\u4f53\u6b65\u9aa4\u662f\uff1a</p> <ol> <li>\u53d1\u9001 06H(Write Enable) \u5141\u8bb8\u5199\u5165</li> <li>\u53d1\u9001 02H(Program Load) \u6216 32H(Program Load x4) \u628a\u8981\u5199\u5165\u7684\u6570\u636e\u4f20\u8f93\u7ed9 NAND Flash \u4e2d\u7684 Cache\uff1b02H \u548c 32H \u7684\u533a\u522b\u5c31\u662f\u540e\u8005\u540c\u65f6\u5728\u56db\u4e2a\u4fe1\u53f7\u7ebf\u4e0a\u4f20\u8f93\u6570\u636e</li> <li>\u53d1\u9001 10H(Program Execute) \u8fdb\u884c\u5b9e\u9645\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u4ece Cache \u5230 Flash \u5b58\u50a8</li> <li>\u4e0d\u65ad\u53d1\u9001 0FH(Get Feature) \u547d\u4ee4\uff0c\u76f4\u5230 Program Execute \u64cd\u4f5c\u5b8c\u6210</li> </ol>"},{"location":"hardware/spi/#spi-nor-flash","title":"SPI NOR Flash","text":"<p>NOR Flash \u548c NAND Flash \u7684\u533a\u522b\u5728\u4e8e\uff0cNOR Flash \u53ef\u4ee5\u968f\u673a\u8bbf\u95ee\uff0c\u53ef\u4ee5\u63d0\u4f9b XIP \u652f\u6301\u3002\u4e0b\u9762\u4ee5 128Mb, 3V, Multiple I/O Serial Flash Memory \u4e3a\u4f8b\u5b50\u770b\u770b\u5b83\u662f\u5982\u4f55\u8bfb\u5199\u7684\u3002</p> <p>SPI NOR Flash \u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u4e00\u6761\u547d\u4ee4\u5c31\u53ef\u4ee5\u4e86\uff1aREAD/FAST READ\u3002\u5176\u4e2d READ \u547d\u4ee4\u6bd4\u8f83\u7b80\u5355\uff1a\u53d1\u9001 Command\uff0c\u53d1\u9001\u5730\u5740\uff0c\u7136\u540e Slave \u7d27\u63a5\u7740\u5c31\u4f1a\u53d1\u9001\u6570\u636e\uff1bFAST READ \u53ef\u4ee5\u8fbe\u5230\u66f4\u9ad8\u7684\u9891\u7387\uff0c\u4f46\u662f\u4e3a\u4e86\u8ba9 NOR Flash \u6709\u65f6\u95f4\u8bfb\u53d6\u6570\u636e\uff0c\u5728 Master \u53d1\u9001 Command \u548c\u5730\u5740\u540e\uff0c\u8fd8\u9700\u8981\u53d1\u9001 Dummy cycles\uff0c\u7136\u540e Slave \u624d\u4f1a\u53d1\u9001\u6570\u636e\u3002\u548c\u524d\u9762\u4e00\u6837\uff0cFAST READ \u4e5f\u652f\u6301\u4e0d\u540c\u7684 IO \u7c7b\u578b\uff0c\u4f8b\u5982 Dual Output\uff0cDual Input/Output\uff0cQuad Output\uff0cQuad Input/Output\u3002\u4e00\u4e9b\u6bd4\u8f83\u9ad8\u7aef\u7684 SPI NOR Flash \u8fd8\u652f\u6301 DTR\uff08Double Transfer Rate\uff09\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f DDR\uff0c\u5728\u65f6\u949f\u4e0a\u5347\u6cbf\u548c\u4e0b\u964d\u6cbf\u90fd\u91c7\u6837\u6570\u636e\u3002</p> <p>\u5199\u5165\u7684\u65f6\u5019\uff0c\u548c NAND Flash \u4e00\u6837\uff0c\u4e5f\u9700\u8981\u5148\u64e6\u9664\uff0c\u518d\u5199\u5165\u3002SPI Flash \u7684\u5b58\u50a8\u5c42\u7ea7\u662f\uff1a</p> <ol> <li>Sector</li> <li>Subsector</li> <li>Page</li> <li>Byte</li> </ol> <p>\u64e6\u9664\u7684\u7c92\u5ea6\u662f Sector \u6216\u8005 Subsector\uff0c\u5199\u5165\u7684\u7c92\u5ea6\u662f Page\u3002\u5199\u5165\u7684\u65f6\u5019\uff0c\u4e5f\u9700\u8981\u9996\u5148\u53d1\u9001 WRITE ENABLE \u547d\u4ee4\uff0c\u518d\u53d1\u9001 PAGE PROGRAM \u547d\u4ee4\u3002NOR Flash \u5728 Program \u4e0a\u4e5f\u6bd4\u8f83\u7b80\u5316\uff0c\u76f4\u63a5 Program \u5373\u53ef\uff0c\u4e0d\u9700\u8981\u5148\u5199\u5165\u5230 Cache\uff0c\u518d\u8fdb\u884c Program\u3002</p> <p>NOR Flash \u8fd8\u63d0\u4f9b\u4e86 XIP Mode \u6765\u52a0\u5feb\u968f\u673a\u8bbf\u95ee\uff1a\u542f\u7528 XIP \u6a21\u5f0f\u540e\uff0c\u7ed9\u51fa\u4e00\u4e2a\u5730\u5740\uff0c\u7b49\u5f85 Dummy cycles \u540e\uff0c\u5c31\u53ef\u4ee5\u8bfb\u51fa\u6570\u636e\uff0c\u4e0d\u9700\u8981\u50cf\u524d\u9762\u90a3\u6837\u53d1\u9001 COMMAND\uff0c\u51cf\u5c11\u4e86\u5ef6\u8fdf\u3002\u5f53\u7136\u4e86\uff0c\u5373\u4f7f\u4e0d\u6253\u5f00 NOR Flash \u7684 XIP Mode\uff0c\u4e5f\u53ef\u4ee5\u5728 SPI \u63a7\u5236\u5668\u91cc\u5b9e\u73b0 XIP\uff0c\u53ea\u4e0d\u8fc7\u6bcf\u6b21\u8bfb\u53d6\u90fd\u8981\u53d1\u4e00\u6b21 READ \u547d\u4ee4\u3002</p>"},{"location":"hardware/spi/#spi-eeprom","title":"SPI EEPROM","text":"<p>SPI EEPROM \u548c SPI NOR Flash \u6bd4\u8f83\u7c7b\u4f3c\uff0c\u4f46\u662f EEPROM \u66f4\u5c0f\uff0c\u4e5f\u66f4\u52a0\u7b80\u5355\uff0c\u4f8b\u5982\u5199\u5165\u7684\u65f6\u5019\uff0c\u4e0d\u9700\u8981\u64e6\u9664\u3002\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u5728 SPI \u4e32\u884c EEPROM \u7cfb\u5217\u6570\u636e\u624b\u518c \u4e2d\u67e5\u770b\u547d\u4ee4\u5217\u8868\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002</p>"},{"location":"hardware/spi/#sd","title":"SD \u5361","text":"<p>SD \u5361\u9664\u4e86 SD Bus \u4ee5\u5916\uff0c\u8fd8\u652f\u6301 SPI \u6a21\u5f0f\uff08\u6700\u65b0\u7684 SDUC \u4e0d\u652f\u6301 SPI \u6a21\u5f0f\uff09\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u7528 SPI \u6765\u8bfb\u5199 SD \u5361\u3002</p> <p>SD \u5361\u6bd4\u8f83\u7279\u522b\u7684\u4e00\u70b9\u662f\uff0c\u5b83\u9700\u8981\u6bd4\u8f83\u590d\u6742\u7684\u521d\u59cb\u5316\u6d41\u7a0b\uff1a</p> <ol> <li>\u9996\u5148\u8981\u53d1\u9001 CMD0 \u547d\u4ee4\uff0c\u540c\u65f6 CS \u62c9\u4f4e\uff0c\u4f7f\u5f97 SD \u5361\u8fdb\u5165 SPI \u6a21\u5f0f</li> <li>\u5bf9\u4e8e SDHC SD \u5361\uff0c\u9700\u8981\u53d1\u9001 CMD8 \u6765\u534f\u5546\u5de5\u4f5c\u7535\u538b\u8303\u56f4</li> <li>\u91cd\u590d\u53d1\u9001 ACMD41 \u547d\u4ee4\uff08CMD55 + CMD41 = ACMD41\uff09\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u76f4\u5230 SD \u5361\u56de\u590d\u521d\u59cb\u5316\u5b8c\u6210</li> <li>\u53d1\u9001 CMD58 \u547d\u4ee4\u4ee5\u8bfb\u53d6 OCR \u5bc4\u5b58\u5668\u7684\u503c</li> </ol> <p>\u6bd4\u8f83\u6709\u610f\u601d\u7684\u662f\u547d\u4ee4\u7684\u4f20\u8f93\u65b9\u5f0f\u3002\u6bcf\u4e2a\u547d\u4ee4\u6709\u4e00\u4e2a 6 \u4f4d\u7684\u547d\u4ee4\u7f16\u53f7\uff0c\u4f8b\u5982 CMD0 \u7684\u7f16\u53f7\u5c31\u662f 0\uff0cCMD55 \u7684\u7f16\u53f7\u5c31\u662f 55\uff1b\u8fd8\u5e26\u6709\u56db\u5b57\u8282\u7684\u53c2\u6570\u3002\u6bcf\u4e2a\u547d\u4ee4\u4f1a\u7ec4\u88c5\u6210\u4e00\u4e2a 48 \u4f4d\u7684\u5206\u7ec4\uff1a</p> <ol> <li>bit[47]=0: Start Bit</li> <li>bit[46]=1: Transmission Bit</li> <li>bit[45:40]: Command Index</li> <li>bit[39:8]: Argument</li> <li>bit[7:1]: CRC7</li> <li>bit[0]=1: End Bit</li> </ol> <p>\u53ef\u89c1\u989d\u5916\u591a\u4e86\u4e00\u4e2a CRC7 \u7684\u6821\u9a8c\u548c\u3002</p> <p>SD \u5361\u89c4\u5b9a\uff0cSPI \u6a21\u5f0f\u4e0b\uff0c\u6240\u6709\u7684\u6570\u636e\u4f20\u8f93\u90fd\u662f\u5bf9\u9f50\u5230 8 \u4f4d\uff0c\u4e5f\u5c31\u662f\u4ece CS \u62c9\u4f4e\u5f00\u59cb\u7b97\uff0c\u6bcf 8 \u4e2a\u65f6\u949f\u4e0a\u5347\u6cbf\u662f\u4e00\u4e2a\u5b57\u8282\uff0c\u65e0\u8bba\u547d\u4ee4\u8fd8\u662f\u54cd\u5e94\uff0c\u90fd\u5728 8 \u4f4d\u7684\u8fb9\u754c\u4e0a\u4f20\u8f93\u3002</p> <p>\u60f3\u8981\u8bfb\u53d6\u6570\u636e\u7684\u8bdd\uff0c\u5c31\u8981\u53d1\u9001 READ_SINGLE_BLOCK \u547d\u4ee4\uff0c\u53c2\u6570\u5c31\u662f\u8981\u8bfb\u53d6\u7684 Block \u5730\u5740\uff0cBlock \u5730\u5740\u7684\u5355\u4f4d\u5728 SDSC \u4e0a\u662f\u5b57\u8282\uff0c\u5728 SDHC \u548c SDXC \u4e0a\u662f 512 \u5b57\u8282\u3002SD \u5361\u56de\u5148\u56de\u590d\u4e00\u4e2a\u5b57\u8282\u7684\u54cd\u5e94\uff0c\u7136\u540e\u5f00\u59cb\u53d1\u6570\u636e\uff0c\u6570\u636e\u4ece Start Block Token \u5f00\u59cb\uff0c\u7136\u540e\u662f\u4e00\u4e2a Block \u7684\u6570\u636e\uff08\u901a\u5e38\u662f 512 \u5b57\u8282\uff09\uff0c\u6700\u540e\u518d\u4e24\u4e2a\u5b57\u8282\u7684 CRC16\u3002</p> <p>\u5199\u6570\u636e\u5219\u662f\u53d1\u9001 WRITE_BLOCK \u547d\u4ee4\uff0cSD \u5361\u56de\u590d\u4e00\u4e2a\u5b57\u8282\u7684\u54cd\u5e94\uff0c\u7136\u540e\u63a7\u5236\u5668\u5f00\u59cb\u4f20\u8f93\u6570\u636e\uff0c\u6570\u636e\u4ece Start Block Token \u5f00\u59cb\uff0c\u63a5\u7740\u662f\u8981\u5199\u5165\u7684\u6570\u636e\uff0c\u6700\u540e\u662f\u4e24\u4e2a\u5b57\u8282\u7684 CRC16\uff0c\u7136\u540e SD \u5361\u56de\u590d\u4e00\u4e2a\u5b57\u8282\u7684\u54cd\u5e94\uff0c\u6807\u5fd7\u7740\u5199\u5165\u6210\u529f\u3002</p>"},{"location":"hardware/spi/#spi_1","title":"SPI \u4ee5\u592a\u7f51\u63a7\u5236\u5668","text":"<p>\u6709\u4e00\u4e9b\u4ee5\u592a\u7f51\u4ea7\u54c1\u63d0\u4f9b\u4e86 SPI \u63a5\u53e3\uff0c\u4f8b\u5982 KSZ8851SNL/SNLI\uff0c\u96c6\u6210\u4e86 MAC \u548c PHY\uff0c\u76f4\u63a5\u8fde\u63a5 MDI/MDI-X \u63a5\u53e3\uff0c\u867d\u7136\u6700\u9ad8\u53ea\u652f\u6301\u767e\u5146\u7f51\uff0c\u4f46\u662f\u63a5\u53e3\u4e0a\u786e\u5b9e\u975e\u5e38\u7b80\u5355\u3002</p> <p>SPI \u4e0a\u53d1\u9001\u7684\u547d\u4ee4\u5c31\u4e24\u7c7b\uff1a\u4e00\u7c7b\u662f\u8bfb\u5199\u5bc4\u5b58\u5668\uff0c\u4e00\u7c7b\u662f\u8bfb\u5199 RX/TX FIFO\u3002</p>"},{"location":"hardware/spi/#_3","title":"\u952e\u76d8\u548c\u89e6\u6478\u677f","text":"<p>\u4e00\u4e9b\u578b\u53f7\u7684\u82f9\u679c\u7535\u8111\u7684\u952e\u76d8\u548c\u89e6\u6478\u677f\u662f\u901a\u8fc7 SPI \u63a5\u53e3\u8bbf\u95ee\u7684\uff0c\u5728 Linux \u4e2d\u6709\u76f8\u5e94\u7684 applespi \u9a71\u52a8\u3002</p>"},{"location":"hardware/spi/#spi-vs-i2c","title":"SPI vs I2C","text":"<p>SPI \u548c I2C \u7684\u533a\u522b\u5728\u4e8e\uff0c\u524d\u8005\u4fe1\u53f7\u66f4\u591a\uff0c\u5168\u53cc\u5de5\u4f20\u8f93\uff1b\u540e\u8005\u4fe1\u53f7\u66f4\u5c11\uff0c\u534a\u53cc\u5de5\u4f20\u8f93\u3002SPI \u901a\u8fc7 CS \u4fe1\u53f7\u9009\u62e9 Slave \u82af\u7247\uff0cI2C \u901a\u8fc7\u5730\u5740\u8fdb\u884c\u533a\u5206\u3002\u6b64\u5916 I2C \u8fd8\u9700\u8981 Pull up resistor\uff0c\u8fd9\u6837\u5982\u679c\u6ca1\u6709\u8bbe\u5907\u54cd\u5e94\uff0c\u5c31\u4f1a NACK\u3002</p> <p>\u4e00\u4e9b\u82af\u7247\u63d0\u4f9b\u4e86 SPI \u6216 I2C \u7684\u9009\u9879\uff1a\u5171\u7528\u4e24\u4e2a\u4fe1\u53f7\uff0c\u5141\u8bb8\u7528\u6237\u9009\u62e9\u7528 I2C \u8fd8\u662f SPI\u3002\u4f8b\u5982 WM8731\uff0c\u65e2\u652f\u6301 I2C\uff08\u8bb0\u4e3a 2-wire mode\uff09\uff0c\u53c8\u652f\u6301 SPI\uff08\u8bb0\u4e3a 3-wire mode\uff09\u3002\u4e00\u822c\u8fd9\u79cd\u65f6\u5019\uff0cSPI \u548c I2C \u5c31\u662f\u7528\u6765\u914d\u7f6e\u4e00\u4e9b\u5bc4\u5b58\u5668\u7684\uff0c\u53e6\u5916\u53ef\u80fd\u8fd8\u6709\u4e00\u4e9b\u63a5\u53e3\uff0c\u4f8b\u5982 WM8731 \u8d1f\u8d23\u58f0\u97f3\u6570\u636e\u4f20\u8f93\u7684\u5b9e\u9645\u4e0a\u662f I2S\u3002</p>"},{"location":"hardware/spi/#axi-quad-spi","title":"AXI Quad SPI","text":"<p>AXI Quad SPI \u662f\u4e00\u4e2a SPI \u534f\u8bae\u7684\u63a7\u5236\u5668\uff0c\u5b83\u652f\u6301 XIP\uff08eXecute In Place\uff09\u6a21\u5f0f\uff0c\u5373\u53ef\u4ee5\u66b4\u9732\u4e00\u4e2a\u53ea\u8bfb AXI Slave \u63a5\u53e3\uff0c\u5f53\u63a5\u6536\u5230\u8bfb\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5c31\u53d1\u9001 SPI NOR Flash \u547d\u4ee4\u53bb\u5bf9\u5e94\u7684\u5730\u5740\u8fdb\u884c\u8bfb\u53d6\uff0c\u7136\u540e\u8fd4\u56de\u7ed3\u679c\u3002\u7531\u4e8e\u4e0d\u540c\u5382\u5bb6\u7684 SPI NOR Flash \u652f\u6301\u6709\u6240\u4e0d\u540c\uff0c\u6240\u4ee5 IP \u4e0a\u7684\u8bbe\u7f6e\u53ef\u4ee5\u770b\u5230\u5382\u5bb6\u7684\u9009\u62e9\u3002</p> <p>\u7279\u522b\u5730\uff0c\u4e00\u4e2a\u5e38\u89c1\u7684\u9700\u6c42\u662f\u5e0c\u671b\u8bbf\u95ee Cfg\uff08Configuration\uff09Flash\uff0c\u4ea6\u5373\u7528\u6765\u4fdd\u5b58 Bitstream \u7684 Flash\u3002\u5f53 FPGA \u4e0a\u7535\u7684\u65f6\u5019\uff0c\u5982\u679c\u542f\u52a8\u6a21\u5f0f\u8bbe\u7f6e\u4e3a SPI Flash\uff0cFPGA \u5c31\u4f1a\u5411 Cfg Flash \u8bfb\u53d6 Bitstream\uff0cCfg Flash \u9700\u8981\u8fde\u63a5\u5230 FPGA \u7684\u6307\u5b9a\u5f15\u811a\u4e0a\uff0c\u5f53 FPGA \u521d\u59cb\u5316\u7684\u65f6\u5019\u7531\u5185\u90e8\u903b\u8f91\u9a71\u52a8\uff0c\u521d\u59cb\u5316\u5b8c\u6210\u540e\u53c8\u8981\u8f6c\u4ea4\u7ed9\u7528\u6237\u903b\u8f91\u3002\u8f6c\u4ea4\u7684\u65b9\u5f0f\u5c31\u662f\u901a\u8fc7 STARTUP \u7cfb\u5217\u7684 primitive\u3002</p> <p>\u901a\u5e38\uff0c\u5982\u679c\u8981\u8fde\u63a5\u5916\u90e8\u7684 SPI Flash\uff0c\u9700\u8981\u8fde\u63a5\u51e0\u6761\u4fe1\u53f7\u7ebf\u5230\u9876\u5c42\uff0c\u7136\u540e\u901a\u8fc7 xdc \u628a\u4fe1\u53f7\u7ed1\u5b9a\u5230\u5f15\u811a\u4e0a\uff0c\u7136\u540e\u5f15\u811a\u8fde\u63a5\u4e86\u4e00\u4e2a\u5916\u90e8\u7684 SPI Flash\u3002\u4f46\u7531\u4e8e Cfg Flash \u6bd4\u8f83\u7279\u6b8a\uff0c\u6240\u4ee5\u4fe1\u53f7\u4ece AXI Quad SPI \u76f4\u63a5\u8fde\u5230 STARTUP \u7cfb\u5217\u7684 primitive \u4e0a\u3002\u5982\u679c\u662f\u91c7\u7528 STARTUPE2 \u539f\u8bed\u7684 7 \u7cfb\u5217\u7684 FPGA\uff0c\u90a3\u4e48\u53ea\u6709\u65f6\u949f\u4f1a\u901a\u8fc7 STARTUPE2 pritimive \u8fde\u63a5\u5230 SPI Flash \u4e0a\uff0c\u5176\u4ed6\u6570\u636e\u4fe1\u53f7\u8fd8\u662f\u6b63\u5e38\u901a\u8fc7\u9876\u5c42\u7ed1\u5b9a\uff1b\u5982\u679c\u662f\u91c7\u7528 STARTUPE3 \u539f\u8bed\u7684 UltraScale \u7cfb\u5217\u7684 FPGA\uff0c\u90a3\u4e48\u65f6\u949f\u548c\u6570\u636e\u90fd\u901a\u8fc7 STARTUPE3 primitive \u8fde\u63a5\u5230 SPI Flash\u3002</p>"},{"location":"hardware/spi/#virtex-ultrascale","title":"Virtex UltraScale+ \u65f6\u5e8f","text":"<p>\u628a\u4fe1\u53f7\u8fde\u597d\u4e86\u53ea\u662f\u7b2c\u4e00\u6b65\uff0c\u56e0\u4e3a\u5916\u8bbe\u5bf9\u65f6\u5e8f\u8981\u6c42\u6bd4\u8f83\u590d\u6742\uff0c\u5982\u679c\u7528\u4e00\u4e2a\u6bd4\u8f83\u9ad8\u76f4\u63a5\u8dd1\uff0c\u5f88\u5927\u53ef\u80fd\u5c31\u8bfb\u53d6\u5230\u9519\u8bef\u7684\u6570\u636e\u4e86\u3002AXI Quad SPI \u5df2\u7ecf\u5728\u751f\u6210\u7684\u6587\u4ef6\u91cc\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6837\u4f8b\u7684 xdc\uff0c\u5728\u6587\u6863\u91cc\u4e5f\u6709\u4f53\u73b0\u3002\u5bf9\u4e8e Virtex Ultrascale+ \u7cfb\u5217\u7684 FPGA\uff0c\u5b83\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>#### All the delay numbers have to be provided by the user\n\n#### Following are the SPI device parameters\n#### Max Tco\nset tco_max 7\n#### Min Tco\nset tco_min 1\n#### Setup time requirement\nset tsu 2\n#### Hold time requirement\nset th 3\n#####################################################################################################\n# STARTUPE3 primitive included inside IP for US+                                                             #\n#####################################################################################################\nset tdata_trace_delay_max 0.25\nset tdata_trace_delay_min 0.25\nset tclk_trace_delay_max 0.2\nset tclk_trace_delay_min 0.2\n\ncreate_generated_clock -name clk_sck -source [get_pins -hierarchical *axi_quad_spi_0/ext_spi_clk] [get_pins -hierarchical */CCLK] -edges {3 5 7}\nset_input_delay -clock clk_sck -max [expr $tco_max + $tdata_trace_delay_max + $tclk_trace_delay_max] [get_pins -hierarchical *STARTUP*/DATA_IN[*]] -clock_fall;\nset_input_delay -clock clk_sck -min [expr $tco_min + $tdata_trace_delay_min + $tclk_trace_delay_min] [get_pins -hierarchical *STARTUP*/DATA_IN[*]] -clock_fall;\nset_multicycle_path 2 -setup -from clk_sck -to [get_clocks -of_objects [get_pins -hierarchical */ext_spi_clk]]\nset_multicycle_path 1 -hold -end -from clk_sck -to [get_clocks -of_objects [get_pins -hierarchical */ext_spi_clk]]\nset_output_delay -clock clk_sck -max [expr $tsu + $tdata_trace_delay_max - $tclk_trace_delay_min] [get_pins -hierarchical *STARTUP*/DATA_OUT[*]];\nset_output_delay -clock clk_sck -min [expr $tdata_trace_delay_min - $th - $tclk_trace_delay_max] [get_pins -hierarchical *STARTUP*/DATA_OUT[*]];\nset_multicycle_path 2 -setup -start -from [get_clocks -of_objects [get_pins -hierarchical */ext_spi_clk]] -to clk_sck\nset_multicycle_path 1 -hold -from [get_clocks -of_objects [get_pins -hierarchical */ext_spi_clk]] -to clk_sck\n</code></pre> <p>\u5206\u6bb5\u6765\u770b\u8fd9\u4e2a xdc \u90fd\u505a\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>create_generated_clock -name clk_sck -source [get_pins -hierarchical *axi_quad_spi_0/ext_spi_clk] [get_pins -hierarchical */CCLK] -edges {3 5 7}\n</code></pre> <p>\u9996\u5148\uff0c\u5b83\u521b\u5efa\u4e86\u4e00\u4e2a\u65f6\u949f <code>clk_sck</code>\u3002CCLK \u662f STARTUP \u8f93\u51fa\u7684\u5b9e\u9645\u65f6\u949f\uff0c\u4f1a\u8fde\u63a5\u5230 Cfg Flash \u7684\u65f6\u949f\u4fe1\u53f7\u4e0a\u3002\u800c AXI Quad SPI \u7684 ext_spi_clk \u4f1a\u8f93\u51fa\u5230 CCLK \u4e0a\uff0c\u56e0\u6b64\u8fd9\u91cc\u662f\u4e00\u4e2a\u751f\u6210\u7684\u65f6\u949f\uff0c\u5e76\u4e14\u6307\u5b9a\u4e0a\u4e0b\u8fb9\u6cbf\u7684\u4f4d\u7f6e\u3002<code>edges</code> \u53c2\u6570\u6709\u4e09\u4e2a\uff0c\u5206\u522b\u8868\u793a\u4e0a\u5347\u3001\u4e0b\u964d\u548c\u4e0a\u5347\u6cbf\u5206\u522b\u7684\u4f4d\u7f6e\u30021 \u8868\u793a\u6e90\u65f6\u949f\u7684\u7b2c\u4e00\u4e2a\u4e0a\u5347\u6cbf\uff0c2 \u8868\u793a\u6e90\u65f6\u949f\u7684\u7b2c\u4e00\u4e2a\u4e0b\u964d\u6cbf\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6240\u4ee5 {3, 5, 7} \u7684\u610f\u601d\u5c31\u662f\u9891\u7387\u51cf\u534a\uff0c\u76f8\u4f4d\u5dee\u534a\u4e2a\u5468\u671f\u3002</p> <p>\u63a5\u7740\u6700\u4e3b\u8981\u7684\u5c31\u662f\uff0c\u600e\u4e48\u8bbe\u7f6e\u5ef6\u8fdf\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u4ee3\u7801\u4e2d\u9996\u5148\u5b9a\u4e49\u4e86\u4e00\u4e9b\u53c2\u6570\uff1a</p> <pre><code>#### Max Tco\nset tco_max 7\n#### Min Tco\nset tco_min 1\n#### Setup time requirement\nset tsu 2\n#### Hold time requirement\nset th 3\n\n#### Trace delay\nset tdata_trace_delay_max 0.25\nset tdata_trace_delay_min 0.25\nset tclk_trace_delay_max 0.2\nset tclk_trace_delay_min 0.2\n</code></pre> <p>\u9996\u5148\u662f t_{co}\uff0c\u8868\u793a\u7684\u662f SPI Flash \u7684\u65f6\u949f\u5230\u8f93\u51fa\u7684\u5ef6\u8fdf\u3002\u4ee5 SPI Flash \u578b\u53f7 Micron MT25QU02GCBB8E12-0SIT \u4e3a\u4f8b\u5b50\uff0c\u53ef\u4ee5\u4ece\u5b83\u7684 Datasheet \u770b\u5230\uff0c\u65f6\u949f\u5230\u8f93\u51fa\u7684\u5ef6\u8fdf\u5e94\u8be5\u662f Max 7ns\uff1a</p> <pre><code>Clock LOW to output valid under 30pF Max 7ns\nClock LOW to output valid under 10pF Max 6ns\n</code></pre> <p>\u56e0\u6b64 <code>tco_max</code> \u8bbe\u4e3a 7\uff0c<code>tco_min</code> \u9ed8\u8ba4\u5373\u53ef\uff0c\u56e0\u4e3a Datasheet \u4e2d\u6ca1\u6709\u505a\u8981\u6c42\u3002</p> <p>\u7136\u540e t_{su} \u548c t_h \u5219\u662f\u8f93\u5165\u7684 setup \u548c hold time\u3002\u7c7b\u4f3c\u7684\uff0c\u53ef\u4ee5\u67e5\u5230 SPI Flash \u7684\u53c2\u6570\uff1a</p> <pre><code>Data in setup time Min 2.5ns\nData in hold time Min 2ns\n</code></pre> <p>\u6240\u4ee5 <code>tsu</code> \u8bbe\u4e3a 2.5\uff0c<code>th</code> \u8bbe\u4e3a 2\u3002</p> <p>\u63a5\u4e0b\u6765\u5219\u662f tdata \u548c tclk \u7684 trace delay\u3002\u8fd9\u6307\u7684\u662f\u4ece FPGA \u5f15\u811a\u5230 SPI Flash \u5f15\u811a\u7684\u4fe1\u53f7\u4f20\u8f93\u5ef6\u8fdf\u3002\u8fd9\u4e2a\u5ef6\u8fdf\u53ef\u4ee5\u4ece\u677f\u5b50\u7684\u5e03\u7ebf\u4e0a\u6d4b\u91cf\u957f\u5ea6\u6765\u4f30\u8ba1\u51fa\u6765\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u4f30\u7b97\u65b9\u6cd5\uff1a\u5149\u901f 3*10^8 \\mathrm{m/s}\uff0c\u5047\u8bbe\u7535\u4fe1\u53f7\u4f20\u64ad\u901f\u5ea6\u662f\u5149\u901f\u7684\u4e00\u534a\uff0c\u53ef\u4ee5\u5f97\u5230\u5ef6\u8fdf\u548c\u957f\u5ea6\u7684\u6bd4\u503c\uff1a 0.06 \\mathrm{ns/cm} = 0.15 \\mathrm{ns/inch}\u3002</p> <p>\u4e0b\u9762\u8ba8\u8bba\u8fd9\u4e9b\u53d8\u91cf\u5982\u4f55\u53c2\u4e0e\u5230 input/output delay \u7684\u8ba1\u7b97\u4e2d\u3002</p> <p>\u9996\u5148\u8003\u8651 input delay\u3002\u5b83\u6307\u7684\u662f\uff0c\u4ece SPI Flash \u5230 FPGA \u7684\u6570\u636e\uff0c\u76f8\u5bf9\u4e8e\u65f6\u949f\u7684\u5ef6\u8fdf\u3002\u8fd9\u4e2a\u5ef6\u8fdf\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff1a</p> <ol> <li>\u4ece FPGA \u8f93\u51fa\u7684\u65f6\u949f CCLK \u5230 SPI Flash \u7684\u65f6\u949f\u6709\u5ef6\u8fdf t_{clk}\uff0c\u4e0b\u56fe <code>a -&gt; b</code></li> <li>\u4ece SPI Flash \u7684\u65f6\u949f\u5230\u6570\u636e\u8f93\u51fa\u6709\u5ef6\u8fdf t_{co}\uff0c\u4e0b\u56fe <code>b -&gt; c</code></li> <li>\u4ece SPI Flash \u7684\u6570\u636e\u5230 FPGA \u7684\u6570\u636e\u8f93\u5165\u6709\u5ef6\u8fdf t_{data}\uff0c\u4e0b\u56fe <code>c -&gt; d</code></li> </ol> <pre><code>{\n  signal:\n    [\n      { name: \"clk_fpga\", wave: \"p..\", node: \".a\" },\n      { name: \"clk_flash\", wave: \"p...\", node: \"..b\", phase: 2.7 },\n      { name: \"data_flash\", wave: \"3456\", node: \"..c\", phase: 2.5 },\n      { name: \"data_fpga\", wave: \"3456\", node: \"..d\", phase: 2.3 },\n    ],\n  config: { hscale: 3 },\n}\n</code></pre> <p>\u56e0\u6b64\u603b\u5ef6\u8fdf\u5c31\u662f t_{clk}+t_{co}+t_{data}\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5bf9\u5e94\u7684\u8bbe\u7f6e\uff1a</p> <pre><code>set_input_delay -clock clk_sck -max [expr $tco_max + $tdata_trace_delay_max + $tclk_trace_delay_max] [get_pins -hierarchical *STARTUP*/DATA_IN[*]] -clock_fall;\nset_input_delay -clock clk_sck -min [expr $tco_min + $tdata_trace_delay_min + $tclk_trace_delay_min] [get_pins -hierarchical *STARTUP*/DATA_IN[*]] -clock_fall;\n</code></pre> <p>\u63a5\u4e0b\u6765\u8981\u8003\u8651 output delay\u3002\u867d\u7136 output delay \u4e5f\u6709 min \u548c max\uff0c\u4f46\u5176\u542b\u4e49\u6709\u6240\u533a\u522b\uff0c\u9700\u8981\u5206\u522b\u8003\u8651\u3002</p> <p>\u9996\u5148\u662f max\uff0c\u5b83\u5bf9\u5e94\u7684\u662f setup time\u3002\u5982\u679c\u5b9a\u4e49\u65f6\u95f4 0 \u4e3a\u65f6\u949f\u7684\u4e0a\u5347\u6cbf\uff0c\u6cbf\u66f4\u65e9\u7684\u65f6\u95f4\u4e3a\u6b63\u7684\u65f6\u95f4\u8f74\uff0c\u6cbf\u66f4\u665a\u7684\u65f6\u95f4\u4e3a\u8d1f\u7684\u65f6\u95f4\u8f74\u3002\u671f\u671b\u76ee\u6807\u662f\uff0c\u6570\u636e\u5230\u8fbe\u5bc4\u5b58\u5668\u8f93\u5165\u7684\u65f6\u95f4\u5927\u4e8e setup time\uff0c\u6b64\u65f6\u53ef\u4ee5\u6ee1\u8db3 setup \u6761\u4ef6\u3002\u4e3a\u4e86\u8ba1\u7b97 max output delay\uff0c\u9700\u8981\u8003\u8651\u7684\u662f\u4ece FPGA \u6570\u636e\u8f93\u51fa\u5230 SPI Flash \u4e0a\u65f6\u949f\u7684\u5ef6\u8fdf\u3002</p> <p>\u5047\u8bbe FPGA CCLK \u65f6\u949f\u4e0a\u5347\u6cbf\u5728 0 \u65f6\u523b\uff08\u4e0b\u56fe\u7684 <code>a</code>\uff09\uff0c\u90a3\u4e48 SPI Flash \u65f6\u949f\u4e0a\u5347\u6cbf\u5728 -t_{clk} \u65f6\u523b\uff08\u4e0b\u56fe\u7684 <code>b</code>\uff09\u3002\u5047\u8bbe FPGA \u6570\u636e\u8f93\u51fa\u65f6\u523b\u4e3a t_0\uff08\u901a\u5e38\u4e3a\u6b63\uff0c\u4e0b\u56fe\u7684 <code>c</code>\uff09\uff0c\u90a3\u4e48 FPGA \u6570\u636e\u8f93\u51fa\u5230\u8fbe SPI Flash \u5728 t_0-t_{data} \u65f6\u523b\uff08\u4e0b\u56fe\u7684 <code>d</code>\uff09\uff0c\u4e3a\u4e86\u4fdd\u8bc1 t_0-t_{data} \u5728 -t_{clk} \u65f6\u523b\u4e4b\u524d\uff08\u4e0b\u56fe\u7684 <code>d -&gt; b</code>\uff09\u81f3\u5c11 t_{su} \u65f6\u95f4\u5230\u8fbe\uff0c\u53ef\u4ee5\u5f97\u5230\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"clk_fpga\", wave: \"p..\", node: \".a\" },\n      { name: \"clk_flash\", wave: \"p...\", node: \"..b\", phase: 2.7 },\n      { name: \"data_fpga\", wave: \"3456\", node: \"..c\", phase: 3.6 },\n      { name: \"data_flash\", wave: \"3456\", node: \"..d\", phase: 3.4 }\n    ],\n  config: { hscale: 3 },\n}\n</code></pre>  t_0 - t_{data} &gt; -t_{clk} + t_{su}  <p>\u5316\u7b80\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230 t_0 &gt; t_{data} + t_{su} - t_{clk}\uff0c\u5982\u679c\u8003\u8651\u6781\u7aef\u60c5\u51b5\uff0c\u53f3\u4fa7 t_{data} \u53d6\u6700\u5927\u503c\uff0ct_{clk} \u53d6\u6700\u5c0f\u503c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7ea6\u675f\uff1a</p> <pre><code>set_output_delay -clock clk_sck -max [expr $tsu + $tdata_trace_delay_max - $tclk_trace_delay_min] [get_pins -hierarchical *STARTUP*/DATA_OUT[*]];\n</code></pre> <p>\u63a5\u4e0b\u6765\u8003\u8651 output delay \u7684 min\uff0c\u8fd9\u5bf9\u5e94\u7684\u662f hold time\u3002\u6b64\u65f6\u7684\u76ee\u6807\u662f\u6570\u636e\u5230\u8fbe SPI Flash \u5bc4\u5b58\u5668\u7684\u65f6\u5019\uff0c\u8ddd\u79bb\u4e0a\u5347\u6cbf\u65f6\u95f4\u8d85\u8fc7\u4e86 t_h\u3002\u6309\u7167\u540c\u6837\u7684\u5047\u8bbe\uff0c\u5982\u679c FPGA CCLK \u65f6\u949f\u4e0a\u5347\u6cbf\u5728 0 \u65f6\u523b\uff08\u4e0b\u56fe\u7684 <code>a</code>\uff09\uff0c\u90a3\u4e48 SPI Flash \u65f6\u949f\u4e0a\u5347\u6cbf\u5728 -t_{clk} \u65f6\u523b\uff08\u4e0b\u56fe\u7684 <code>b</code>\uff09\u3002\u5047\u8bbe FPGA \u6570\u636e\u8f93\u51fa\u65f6\u523b\u4e3a t_0\uff08\u4e0b\u56fe\u7684 <code>c</code>\uff09\uff0c\u90a3\u4e48 FPGA \u6570\u636e\u8f93\u51fa\u5230\u8fbe SPI Flash \u5728 t_0-t_{data} \u65f6\u523b\uff08\u4e0b\u56fe\u7684 <code>d</code>\uff09\uff0c\u4e3a\u4e86\u6ee1\u8db3 hold \u6761\u4ef6\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a</p> <pre><code>{\n  signal:\n    [\n      { name: \"clk_fpga\", wave: \"p..\", node: \".a\" },\n      { name: \"data_fpga\", wave: \"3456\", node: \"..c\", phase: 2.6 },\n      { name: \"clk_flash\", wave: \"p...\", node: \"..b\", phase: 2.3 },\n      { name: \"data_flash\", wave: \"3456\", node: \"..d\", phase: 2.2 },\n    ],\n  config: { hscale: 3 },\n}\n</code></pre>  t_0 - t_{data} &lt; -t_{clk} - t_h  <p>\u5316\u7b80\u4ee5\u540e\uff0c\u53ef\u4ee5\u5f97\u5230 t_0 &lt; t_{data} - t_{clk} - t_h\uff0c\u6309\u7167\u6781\u9650\u6765\u53d6\uff0ct_{data} \u53d6\u6700\u5c0f\u503c\uff0ct_{clk} \u53d6\u6700\u5927\u503c\uff0c\u5c31\u5f97\u5230\u4e86\u6700\u7ec8\u7684\u65f6\u5e8f\u7ea6\u675f\uff1a</p> <pre><code>set_output_delay -clock clk_sck -min [expr $tdata_trace_delay_min - $th - $tclk_trace_delay_max] [get_pins -hierarchical *STARTUP*/DATA_OUT[*]];\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0 FPGA \u548c SPI Flash \u4e4b\u95f4\u7684\u6b63\u5e38\u901a\u8baf\u4e86\u3002\u8fd9\u91cc\u6bd4\u8f83\u7ed5\u7684\u5c31\u662f\u65f6\u95f4\u8f74\u7684\u5b9a\u4e49\uff0c\u548c\u5e73\u5e38\u601d\u8003\u7684\u65b9\u5411\u662f\u53cd\u8fc7\u6765\u7684\u3002\u800c\u4e14\uff0c\u8fd9\u91cc\u7684 min \u548c max \u5e76\u4e0d\u662f\u6307 [\\min, \\max]\uff0c\u800c\u662f (-\\inf, \\min] \\cup [\\max, \\inf)\u3002\u4ee3\u5165\u4e0a\u9762\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u5f97\u5230 \\max=2.05, \\min=-2.95, t_0 \\in (\\inf, -2.95] \\cup [2.05, \\inf)\u3002\u5982\u679c\u53d8\u5316\u7684\u65f6\u523b\u8ddd\u79bb\u65f6\u949f\u4e0a\u5347\u6cbf\u592a\u63a5\u8fd1\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5728 SPI Flash \u4fa7\u51fa\u73b0\u4e0d\u6ee1\u8db3 setup \u6216\u8005 hold \u7ea6\u675f\u7684\u60c5\u51b5\u3002</p> <p>\u4e5f\u53ef\u4ee5\u6362\u4e2a\u89d2\u5ea6\u6765\u7406\u89e3 min \u548c max\uff1a\u5bf9\u4e8e\u540c\u4e00\u4e2a\u5468\u671f\u7684\u65f6\u949f\u548c\u6570\u636e\u6765\u8bf4\uff0c\u6570\u636e\u76f8\u5bf9\u65f6\u949f\u6709\u4e00\u4e2a\u5ef6\u8fdf\uff0c\u8fd9\u4e2a\u5ef6\u8fdf\u4e0d\u80fd\u592a\u5c0f\uff0c\u81f3\u5c11\u8981\u6ee1\u8db3 hold\uff0c\u6240\u4ee5\u8fd9\u662f\u4e00\u4e2a\u6700\u5c0f\u7684\u5ef6\u8fdf\uff1b\u540c\u65f6\u8fd9\u4e2a\u5ef6\u8fdf\u4e0d\u80fd\u592a\u5927\uff0c\u6700\u591a\u9700\u8981\u6ee1\u8db3\u4e0b\u4e00\u4e2a\u65f6\u949f\u4e0a\u5347\u6cbf\u7684 setup\uff0c\u6240\u4ee5\u8fd9\u662f\u4e00\u4e2a\u6700\u5927\u7684\u5ef6\u8fdf\u3002\u5982\u679c\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u6765\u770b\uff0c\u90a3\u5c31\u662f\u5ef6\u8fdf\u5728\u4e00\u4e2a [\\min, \\max] \u7684\u8303\u56f4\u5185\u3002\u4f46\u662f\uff0c\u8fd9\u6837\u5728\u8ba1\u7b97\u7684\u65f6\u5019\u5c31\u9700\u8981\u628a\u65f6\u949f\u5468\u671f\u7eb3\u5165\u5230 \\max \u7684\u8ba1\u7b97\u4e2d\uff0c\u6bd4\u5982 \\max=t_c-t_{su}\u3002\u5982\u679c\u628a\u5750\u6807\u8f74\u4fee\u6539\u4e00\u4e0b\uff0c\u539f\u70b9\u53d8\u6210\u539f\u6765\u7684\u4e0b\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u7684\u4e0a\u5347\u6cbf\uff0cx \u7684\u6b63\u65b9\u5411\u53d8\u6210\u53cd\u5411\uff0c\u6b64\u65f6\u516c\u5f0f\u91cc\u4e0d\u4f1a\u51fa\u73b0\u65f6\u949f\u5468\u671f\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e0a\u9762\u7684\u5f62\u5f0f\u4e86\u3002</p>"},{"location":"hardware/spi/#artix-7","title":"Artix 7 \u65f6\u5e8f","text":"<p>\u5bf9\u4e8e\u66f4\u5e38\u89c1\u7684 7 Series FPGA\uff0c\u6bd4\u5982 Artix 7\uff0c\u5b83\u91c7\u7528\u7684\u662f STARTUPE2 \u539f\u8bed\uff0c\u53ea\u6709\u65f6\u949f\u662f\u901a\u8fc7 STARTUPE2 \u539f\u8bed\u7684 USRCCLKO \u4fe1\u53f7\u4f20\u9012\u5230 CCLK \u5f15\u811a\u4e0a\u7684\uff0c\u5176\u4ed6\u6570\u636e\u4fe1\u53f7\u90fd\u662f\u9700\u8981\u5728\u9876\u5c42\u4fe1\u53f7\u7ed1\u5b9a\u5bf9\u5e94\u7684\u5f15\u811a\u3002\u5728 AXI Quad SPI \u6587\u6863\u4e2d\uff0c\u63cf\u8ff0\u4e86 STARTUPE2 \u6240\u9700\u8981\u7684\u65f6\u5e8f\u7ea6\u675f\uff1a</p> <pre><code># You must provide all the delay numbers\n# CCLK delay is 0.5, 6.7 ns min/max for K7-2; refer Data sheet\n# Consider the max delay for worst case analysis\nset cclk_delay 6.7\n# Following are the SPI device parameters\n# Max Tco\nset tco_max 7\n# Min Tco\nset tco_min 1\n# Setup time requirement\nset tsu 2\n# Hold time requirement\nset th 3\n# Following are the board/trace delay numbers\n# Assumption is that all Data lines are matched\nset tdata_trace_delay_max 0.25\nset tdata_trace_delay_min 0.25\nset tclk_trace_delay_max 0.2\nset tclk_trace_delay_min 0.2\n### End of user provided delay numbers\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e00\u90e8\u5206\u548c\u4e0a\u9762 UltraScale+ \u90e8\u5206\u5dee\u4e0d\u591a\uff0c\u53ea\u662f\u591a\u4e00\u4e2a <code>cclk_delay</code> \u53d8\u91cf\uff0c\u8fd9\u662f\u56e0\u4e3a Artix 7 \u4e2d\uff0c\u65f6\u949f\u53ea\u80fd\u521b\u5efa\u5230 USRCCLKO \u5f15\u811a\u4e0a\u3002\u4f46\u662f\u5b9e\u9645 SPI Flash \u63a5\u6536\u5230\u7684\u65f6\u949f\uff0c\u9996\u5148\u4ece USRCCLKO \u5230 CCLK \u5f15\u811a\uff0c\u7136\u540e\u518d\u901a\u8fc7 PCB \u4e0a\u7684\u7ebf\u4f20\u64ad\u5230 SPI Flash\uff0c\u6240\u4ee5\u9700\u8981\u624b\u52a8\u6dfb\u52a0\u4e00\u4e2a\u504f\u79fb\uff0c\u8fd9\u4e2a\u504f\u79fb\u5c31\u662f USRCCLKO \u5230 CCLK \u7684\u5ef6\u8fdf\uff0c\u53ef\u4ee5\u5728 Artix 7 Data Sheet \u91cc\u9762\u770b\u5230\uff1a\u5bf9\u4e8e 1.0V\uff0c-2 \u901f\u5ea6\u7684 FPGA\uff0c\u8fd9\u4e2a\u5ef6\u8fdf\u6700\u5c0f\u503c\u4e3a 0.50ns\uff0c\u6700\u5927\u503c\u4e3a 6.70ns\uff0c\u8fd9\u91cc\u91c7\u7528\u4e86\u6700\u5927\u503c\u3002</p> <p>\u5269\u4e0b\u7684\u7ea6\u675f\uff0c\u9664\u4e86\u65f6\u949f\u90e8\u5206\u4ee5\u5916\uff0c\u548c\u4e0a\u9762\u5206\u6790\u7684 UltraScale+ \u65f6\u5e8f\u7ea6\u675f\u8ba1\u7b97\u65b9\u6cd5\u662f\u76f8\u540c\u7684\u3002\u4e0d\u540c\u70b9\u5728\u4e8e\uff0c\u8fd9\u91cc\u7ea6\u675f\u4e86\u4ece AXI Quad SPI \u5230 STARTUPE2 \u7684\u8def\u7531\u65f6\u5ef6\uff0c\u4ece 0.1ns \u5230 1.5ns\uff0c\u7136\u540e\u53c8\u4ece USRCCLKO \u521b\u5efa\u4e86\u4e00\u4e2a\u5206\u9891 + \u5ef6\u8fdf <code>cclk_delay</code> \u7eb3\u79d2\u7684\u65f6\u949f\uff0c\u4f5c\u4e3a SPI Flash \u4e0a SCK \u5f15\u811a\u7684\u65f6\u949f\u3002</p> <pre><code># this is to ensure min routing delay from SCK generation to STARTUP input\n# User should change this value based on the results\n# having more delay on this net reduces the Fmax\nset_max_delay 1.5 -from [get_pins -hier *SCK_O_reg_reg/C] -to [get_pins -hier\n*USRCCLKO] -datapath_only\nset_min_delay 0.1 -from [get_pins -hier *SCK_O_reg_reg/C] -to [get_pins -hier\n*USRCCLKO]\n# Following command creates a divide by 2 clock\n# It also takes into account the delay added by STARTUP block to route the CCLK\ncreate_generated_clock -name clk_sck -source [get_pins -hierarchical\n*axi_quad_spi_1/ext_spi_clk] [get_pins -hierarchical *USRCCLKO] -edges {3 5 7}\n-edge_shift [list $cclk_delay $cclk_delay $cclk_delay]\n# Data is captured into FPGA on the second rising edge of ext_spi_clk after the SCK\nfalling edge\n\n# Data is driven by the FPGA on every alternate rising_edge of ext_spi_clk\nset_input_delay -clock clk_sck -max [expr $tco_max + $tdata_trace_delay_max +\n$tclk_trace_delay_max] [get_ports IO*_IO] -clock_fall;\nset_input_delay -clock clk_sck -min [expr $tco_min + $tdata_trace_delay_min +\n$tclk_trace_delay_min] [get_ports IO*_IO] -clock_fall;\nset_multicycle_path 2 -setup -from clk_sck -to [get_clocks -of_objects [get_pins\n-hierarchical */ext_spi_clk]]\nset_multicycle_path 1 -hold -end -from clk_sck -to [get_clocks -of_objects [get_pins\n-hierarchical */ext_spi_clk]]\n# Data is captured into SPI on the following rising edge of SCK\n# Data is driven by the IP on alternate rising_edge of the ext_spi_clk\nset_output_delay -clock clk_sck -max [expr $tsu + $tdata_trace_delay_max -\n$tclk_trace_delay_min] [get_ports IO*_IO];\nset_output_delay -clock clk_sck -min [expr $tdata_trace_delay_min - $th -\n$tclk_trace_delay_max] [get_ports IO*_IO];\nset_multicycle_path 2 -setup -start -from [get_clocks -of_objects [get_pins\n-hierarchical */ext_spi_clk]] -to clk_sck\nset_multicycle_path 1 -hold -from [get_clocks -of_objects [get_pins -hierarchical */\next_spi_clk]] -to clk_sck\n</code></pre> <p>\u4e00\u4e2a Artix 7 \u4e0a\u914d\u7f6e STARTUP SPI Flash \u7684\u4f8b\u5b50 io_timings.xdc \u53ef\u4f9b\u53c2\u8003\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/","title":"01 \u80cc\u666f","text":""},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#chapter-1-background","title":"Chapter 1      Background //\u80cc\u666f","text":""},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#_1","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u4e3a\u4e86\u5efa\u7acb\u7406\u89e3PCI Express\uff08PCIe\uff09\u4f53\u7cfb\u7ed3\u6784\u7684\u57fa\u7840\uff0c\u672c\u7ae0\u5148\u56de\u987e\u4e86\u5148\u4e8ePCIe\u603b\u7ebf\u51fa\u73b0\u7684PCI\uff08Peripheral Component Interface\u5916\u8bbe\u7ec4\u4ef6\u63a5\u53e3\uff09\u603b\u7ebf\u6a21\u578b\uff0c\u5e76\u4ecb\u7ecd\u4e86PCI\u548cPCI-X (PCI\u2010eXtended) \u7684\u57fa\u672c\u7279\u5f81\u4ee5\u53ca\u5404\u81ea\u7279\u70b9\uff0c\u63a5\u7740\u8ba8\u8bba\u4e86\u4ece\u65e9\u671f\u7684\u5e76\u884c\u603b\u7ebf\u6a21\u578b\u8fc1\u79fb\u5230PCIe\u4f7f\u7528\u7684\u4e32\u884c\u9ad8\u901f\u603b\u7ebf\u6a21\u578b\u7684\u51fa\u53d1\u70b9\u548c\u52a8\u673a\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#_2","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u5bf9PCIe\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u4e86\u4ecb\u7ecd\uff0c\u5e76\u6253\u7b97\u4f5c\u4e00\u4e2a\u201c\u64cd\u4f5c\u6267\u884c\u7ea7\uff08executive level\uff09\u201d\u7684\u6982\u8ff0\uff0c\u5b83\u8986\u76d6\u4e86\u9ad8\u5c42\u4f53\u7cfb\u7ed3\u6784\u7684\u6240\u6709\u57fa\u7840\u5185\u5bb9\u3002\u5b83\u4ecb\u7ecd\u4e86\u534f\u8bae\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u5206\u5c42\u7684PCIe\u7aef\u53e3\u8bbe\u8ba1\u65b9\u6cd5\uff0c\u5e76\u63cf\u8ff0\u4e86\u6bcf\u4e2a\u5c42\u7ea7\u7684\u804c\u8d23\u4f5c\u7528\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#11","title":"1.1 \u5f15\u8a00","text":"<p>\u60f3\u8981\u7406\u89e3PCIe\u7684\u7b2c\u4e00\u6b65\uff0c\u662f\u8981\u5bf9PCIe\u6240\u57fa\u4e8e\u7684\u5148\u524d\u7684\u6280\u672f\u5efa\u7acb\u575a\u5b9e\u7684\u57fa\u7840\uff0c\u800c\u672c\u7ae0\u5219\u5c06\u5bf9\u5b83\u4eec\u7684\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u6982\u8ff0\u3002\u5df2\u7ecf\u5bf9PCI\u6bd4\u8f83\u719f\u6089\u7684\u8bfb\u8005\u53ef\u4ee5\u8df3\u8fc7\u672c\u7ae0\u53bb\u770b\u4e0b\u4e00\u7ae0\u3002\u5982\u672c\u7ae0\u6807\u9898\u201c\u80cc\u666f\u201d\uff0c\u672c\u7ae0\u4ec5\u610f\u5728\u7ed9\u51fa\u4e00\u4e2a\u7b80\u660e\u7684\u6982\u8ff0\u3002\u5bf9\u4e8e\u5173\u4e8ePCI\u548cPCI-X\u7684\u66f4\u6df1\u66f4\u7ec6\u8282\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003MindShare\u7684\u4e66\u7c4d\u300aPCI System Architecture\u300b\u4ee5\u53ca\u300aPCI-X System Architecture\u300b\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u4e3a\u4ec0\u4e48\u672c\u7ae0\u7684\u80cc\u666f\u4ecb\u7ecd\u5bf9\u7406\u89e3PCIe\u6709\u662f\u5e2e\u52a9\u7684\uff0c\u73b0\u5728\u5728PCIe\u4e0a\u4f7f\u7528\u7684\u8f6f\u4ef6\uff08\u9a71\u52a8\uff09\u4e0e\u5f53\u521d\u5728PCI\u4e0a\u4f7f\u7528\u7684\u8f6f\u4ef6\u5927\u81f4\u76f8\u540c\u3002\u4fdd\u6301\u8fd9\u79cd\u5411\u540e\u7684\u517c\u5bb9\u6027\uff0c\u4f7f\u5f97\u65e7\u7684\u8bbe\u8ba1\u8fc1\u79fb\u5230\u65b0\u7684\u8bbe\u8ba1\uff08PCI\u5230PCIe\uff09\u65f6\u53ef\u4ee5\u8ba9\u8f6f\u4ef6\u7684\u4fee\u6539\u5c3d\u53ef\u80fd\u5c11\u3001\u82b1\u8d39\u5c3d\u53ef\u80fd\u4f4e\u7684\u6210\u672c\uff0c\u8fd9\u5373\u662f\u5728\u9f13\u52b1\u5c31\u8bbe\u8ba1\u5411\u65b0\u8bbe\u8ba1\u8fc1\u79fb\u3002\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u662f\uff0c\u65e7\u7684\u652f\u6301PCI\u7684\u8f6f\u4ef6\u5728PCIe\u7cfb\u7edf\u4e2d\u7684\u5de5\u4f5c\u65b9\u5f0f\u65e0\u9700\u53d1\u751f\u6539\u53d8\uff0c\u800c\u65b0\u7684\u8f6f\u4ef6\uff08PCIe\u7684\u9a71\u52a8\u8f6f\u4ef6\uff09\u4e5f\u5c06\u6309\u7167PCI\u4e00\u6837\u7684\u6a21\u578b\u8fdb\u884c\u64cd\u4f5c\uff08\u4f8b\u5982\u5bf9\u914d\u7f6e\u7a7a\u95f4\u7684\u64cd\u4f5c\uff09\u3002\u57fa\u4e8e\u8fd9\u6837\u7684\u539f\u56e0\u4ee5\u53ca\u5176\u4ed6\u7684\u4e00\u4e9b\u539f\u56e0\uff0c\u7406\u89e3PCI\u4ee5\u53ca\u5b83\u7684\u64cd\u4f5c\u6a21\u578b\u5c06\u6709\u52a9\u4e8e\u4fc3\u8fdb\u5bf9PCIe\u7684\u7406\u89e3\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#12-pcipci-x","title":"1.2 PCI\u4e0ePCI-X","text":"<p>PCI\uff08Peripheral Component Interface\u5916\u8bbe\u7ec4\u4ef6\u63a5\u53e3\uff09\u603b\u7ebf\uff0c\u5176\u88ab\u5f00\u53d1\u51fa\u6765\u7684\u65f6\u95f4\u4e3a1990\u5e74\u4ee3\u521d\uff0c\u5f53\u65f6\u4eba\u4eec\u671f\u671b\u7528\u5b83\u6765\u89e3\u51b3PCs\uff08personal computer\u4e2a\u4eba\u7535\u8111\uff09\u7684\u5916\u8bbe\u603b\u7ebf\u7684\u4e00\u4e9b\u7f3a\u70b9\u3002\u800c\u90a3\u4e2a\u5e74\u4ee3\u7684\u8fd9\u4e2a\u9886\u57df\u7684\u6280\u672f\u6807\u51c6\u662fIBM\u7684AT\u603b\u7ebf\uff08Advanced Technology\uff09\uff0c\u5b83\u4e5f\u88ab\u5176\u4ed6\u4f9b\u5e94\u5546\u79f0\u4e3aISA\u603b\u7ebf\uff08Industry Standard Architecture\uff09\u3002ISA\u603b\u7ebf\u662f\u4e3a286 16\u4f4d\u8ba1\u7b97\u673a\u800c\u8bbe\u8ba1\u7684\uff0c\u5b83\u5728286\u4e0a\u4e5f\u53d1\u6325\u4e86\u8db3\u591f\u7684\u6027\u80fd\uff0c\u4f46\u968f\u7740\u65b0\u578b\u768432\u4f4d\u8ba1\u7b97\u673a\u53ca\u5176\u5916\u8bbe\u4eec\u51fa\u73b0\uff0c\u65b0\u7684\u9700\u6c42\u4e5f\u51fa\u73b0\u4e86\uff1a\u66f4\u9ad8\u7684\u5e26\u5bbd\u3001\u66f4\u591a\u66f4\u597d\u7684\u529f\u80fd\uff08\u4f8b\u5982\u5373\u63d2\u5373\u7528\uff09\u3002\u9664\u6b64\u4e4b\u5916\uff0cISA\u603b\u7ebf\u4f7f\u7528\u7684\u8fde\u63a5\u5668\u662f\u5177\u6709\u8f83\u591a\u9488\u811a\u6570\u7684\u5927\u578b\u8fde\u63a5\u5668\u3002PC\u4f9b\u5e94\u5546\u4eec\u8ba4\u8bc6\u5230\u4e86\u9700\u8981\u505a\u51fa\u4e00\u5b9a\u7684\u6539\u53d8\u4e86\uff0c\u51e0\u79cd\u7528\u4e8e\u66ff\u4ee3ISA\u603b\u7ebf\u7684\u8bbe\u8ba1\u4e5f\u88ab\u63d0\u51fa\uff0c\u4f8b\u5982IBM\u7684MCA\uff08Micro-Channel Architecture\uff09\uff0cEISA\u603b\u7ebf\uff08Extended ISA\uff0c\u8fd9\u662f\u7531IBM\u7684\u7ade\u4e89\u5bf9\u624b\u63d0\u51fa\u7684\uff09\uff0c\u4ee5\u53caVESA\u603b\u7ebf\uff08Video Electronics Standards Association\uff0c\u5b83\u7531\u58f0\u5361\u4f9b\u5e94\u5546\u4eec\u4e3a\u9002\u914d\u58f0\u5361\u800c\u63d0\u51fa\uff09\u3002\u7136\u800c\uff0c\u6240\u6709\u7684\u8fd9\u4e9b\u8bbe\u8ba1\u90fd\u5177\u6709\u4e00\u4e9b\u4f7f\u5f97\u5b83\u4eec\u65e0\u6cd5\u88ab\u666e\u53ca\u7684\u7f3a\u70b9\u3002\u6700\u7ec8\uff0c\u4e00\u4e2a\u7531PC\u5e02\u573a\u7684\u4e3b\u8981\u516c\u53f8\u4eec\u5171\u540c\u8054\u5408\u5efa\u7acb\u7684\u7ec4\u7ec7PCISIG\uff08PCI Special Interest Group\uff09\u5f00\u53d1\u51fa\u4e86PCI\u603b\u7ebf\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u4e00\u79cd\u5f00\u653e\u603b\u7ebf\u3002\u5728\u5f53\u65f6\uff0cPCI\u8fd9\u79cd\u65b0\u578b\u603b\u7ebf\u4f53\u7cfb\u7ed3\u6784\u5728\u6027\u80fd\u4e0a\u5927\u5927\u7684\u4f18\u4e8eISA\uff0c\u800c\u4e14\u5b83\u5728\u6bcf\u4e2a\u8bbe\u5907\u5185\u90e8\u65b0\u5b9a\u4e49\u4e86\u4e00\u7ec4\u5bc4\u5b58\u5668\uff0c\u79f0\u4e4b\u4e3a\u914d\u7f6e\u7a7a\u95f4\uff08configuration space\uff09\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u67e5\u770b\u4e00\u4e2aPCI\u8bbe\u5907\u5185\u90e8\u6240\u9700\u7684\u5b58\u50a8\u548cIO\u8d44\u6e90\uff0c\u540c\u65f6\u8ba9\u8f6f\u4ef6\u4e3a\u4e00\u4e2a\u7cfb\u7edf\u4e0b\u7684\u5404\u4e2a\u8bbe\u5907\u5206\u914d\u4e92\u4e0d\u51b2\u7a81\u7684\u5730\u5740\u3002\u8fd9\u4e9b\u7279\u6027\uff1a\u5f00\u653e\u5f0f\u8bbe\u8ba1\u3001\u9ad8\u901f\u3001\u8f6f\u4ef6\u53ef\u89c1\u6027\u4e0e\u53ef\u63a7\u6027\uff08software visibility and control\uff09\uff0c\u5e2e\u52a9PCI\u514b\u670d\u4e86\u9650\u5236ISA\u4e0e\u5176\u4ed6\u603b\u7ebf\u7684\u53d1\u5c55\u969c\u788d\uff0c\u8ba9PCI\u8fc5\u901f\u5730\u6210\u4e3a\u4e86PC\u4e2d\u7684\u6807\u51c6\u5916\u8bbe\u603b\u7ebf\u3002</p> <p>\u51e0\u5e74\u4e4b\u540e\uff0cPCI-X\uff08PCI eXtended\uff09\u88ab\u5f00\u53d1\u51fa\u6765\uff0c\u4f5c\u4e3aPCI\u4f53\u7cfb\u7ed3\u6784\u7684\u4e00\u79cd\u903b\u8f91\u6269\u5c55\uff08logical extension\uff09\uff0c\u5e76\u5c06\u603b\u7ebf\u6027\u80fd\u63d0\u5347\u4e86\u4e0d\u5c11\u3002\u6211\u4eec\u5c06\u7a0d\u540e\u518d\u8ba8\u8bbaPCI-X\u76f8\u8f83\u4e8ePCI\u7684\u6539\u53d8\uff0c\u4f46\u662f\u9700\u63d0\u524d\u4e00\u63d0\u7684\u662fPCI-X\u7684\u4e00\u4e2a\u4e3b\u8981\u8bbe\u8ba1\u76ee\u6807\u5c31\u662f\u4fdd\u6301\u4e0ePCI\u8bbe\u5907\u7684\u53ef\u517c\u5bb9\u6027\uff0c\u800c\u4e14\u662f\u8f6f\u4ef6\u548c\u786c\u4ef6\u7684\u517c\u5bb9\u6027\u90fd\u8981\u4fdd\u8bc1\uff0c\u8fd9\u5c06\u4f7f\u5f97\u4ecePCI\u8fc1\u79fb\u81f3PCI-X\u5c3d\u53ef\u80fd\u7684\u7b80\u5355\u3002\u4e0d\u4e45\u540e\uff0cPCI-X 2.0\u7248\u672c\u5c06\u901f\u7387\u63d0\u5347\u5230\u4e86\u66f4\u9ad8\uff0c\u539f\u59cb\u6570\u636e\u901f\u7387\u8fbe\u5230\u4e864GB/s\u3002\u56e0\u4e3aPCI-X\u4fdd\u6301\u4e86\u5bf9PCI\u786c\u4ef6\u4e0a\u7684\u5411\u540e\u517c\u5bb9\u6027\uff0c\u6240\u4ee5\u5b83\u4f9d\u7136\u662f\u4e00\u4e2a\u5e76\u884c\u603b\u7ebf\uff0c\u5e76\u7ee7\u627f\u4e86\u4e0e\u8be5\u603b\u7ebf\u6a21\u578b\u76f8\u5173\u7684\u4e00\u4e9b\u95ee\u9898\u3002\u6709\u610f\u601d\u7684\u4e8b\u60c5\u6765\u4e86\uff0c\u5e76\u884c\u603b\u7ebf\u7684\u6709\u6548\u5e26\u5bbd\u6700\u7ec8\u4f1a\u8fbe\u5230\u4e00\u4e2a\u5b9e\u9645\u7684\u4e0a\u9650\uff08paractical ceiling\uff09\uff0c\u7136\u540e\u5c31\u65e0\u6cd5\u7b80\u5355\u7684\u7ee7\u7eed\u63d0\u5347\u3002\u800cPCISIG\u4e00\u76f4\u5728\u63a2\u7d22\u5982\u4f55\u5c06PCI-X\u7684\u901f\u7387\u8fdb\u4e00\u6b65\u63d0\u5347\uff0c\u4f46\u6700\u7ec8\u8fd9\u9879\u52aa\u529b\u8fd8\u662f\u88ab\u653e\u5f03\u4e86\u3002\u8fd9\u79cd\u901f\u7387\u4e0a\u9650\uff0c\u8fde\u540c\u591a\u9488\u811a\u7684\u8fde\u63a5\u65b9\u5f0f\uff0c\u867d\u7136\u662f\u5e76\u884c\u603b\u7ebf\u7684\u7f3a\u70b9\u4f46\u662f\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e86\u52a8\u529b\uff0c\u63a8\u52a8\u4e86\u5e76\u884c\u603b\u7ebf\u6a21\u578b\u5411\u65b0\u578b\u7684\u4e32\u884c\u603b\u7ebf\u6a21\u578b\u8f6c\u578b\u3002</p> <p>\u8fd9\u4e9b\u65e9\u671f\u603b\u7ebf\u7684\u5b9a\u4e49\u88ab\u7f57\u5217\u5728\u8868 1\u20111\uff0c\u5b83\u5c55\u793a\u4e86\u968f\u65f6\u95f4\u53d1\u5c55\u800c\u53d8\u5f97\u66f4\u9ad8\u7684\u5e26\u5bbd\u4e0e\u9891\u7387\u3002\u8868\u4e2d\u6709\u4e00\u70b9\u5f88\u6709\u8da3\u7684\u5730\u65b9\uff0c\u90a3\u5c31\u662f\u65f6\u949f\u9891\u7387\u548c\u603b\u7ebf\u4e0a\u63d2\u677f\u5361\u7684\u63d2\u69fd\u6570\u91cf\u4e4b\u95f4\u7684\u76f8\u5173\u6027\u3002\u8fd9\u662f\u7531PCI\u7684\u4f4e\u529f\u8017\u4fe1\u53f7\u6a21\u578b\u5e26\u6765\u7684\uff0c\u8fd9\u610f\u5473\u7740\u66f4\u9ad8\u7684\u603b\u7ebf\u9891\u7387\u9700\u8981\u66f4\u77ed\u7684\u677f\u4e0a\u8d70\u7ebf\u4ee5\u53ca\u66f4\u5c11\u7684\u603b\u7ebf\u8d1f\u8f7d\uff08\u8be6\u60c5\u53ef\u89c1\u201cReflected-Wave Signaling\u201d\uff09\u3002\u53e6\u5916\u6709\u8da3\u7684\u4e00\u70b9\u662f\uff0c\u968f\u7740\u603b\u7ebf\u9891\u7387\u7684\u589e\u52a0\uff0c\u5171\u4eab\u603b\u7ebf\u4e0a\u5141\u8bb8\u7684\u8bbe\u5907\u6570\u91cf\u5728\u51cf\u5c11\u3002\u5f53PCI-X 2.0\u88ab\u5f15\u5165\u4f7f\u7528\u65f6\uff0c\u60f3\u8981\u8fbe\u5230\u5b83\u7684\u9ad8\u901f\u7387\u9700\u8981\u8981\u6c42\u603b\u7ebf\u53d8\u4e3a\u4e00\u4e2a\u70b9\u5230\u70b9\u7684\u4e92\u8fde\uff08point-to-point interconnect\uff09\u3002</p> <p></p> <p>\u8868 1\u20111 \u603b\u7ebf\u9891\u7387\u3001\u5e26\u5bbd\u3001\u63d2\u69fd\u6570\u91cf\u7684\u5bf9\u6bd4</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#13-pcipci-basics","title":"1.3 PCI\u57fa\u7840(PCI Basics)","text":""},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#131-pci","title":"1.3.1     \u57fa\u4e8ePCI\u7684\u7cfb\u7edf\u7684\u4e00\u4e9b\u57fa\u7840\u77e5\u8bc6","text":"<p>\u56fe 1\u20111\u5c55\u793a\u4e86\u4e00\u4e2a\u57fa\u4e8ePCI\u603b\u7ebf\u7684\u8001\u7cfb\u7edf\u7ed3\u6784\u3002\u8be5\u7cfb\u7edf\u5305\u62ec\u4e00\u4e2a\u5317\u6865\uff08North Bridge\u79f0\u4e3a\u201c\u5317\u201d\u662f\u56e0\u4e3a\u5982\u679c\u5c06\u56fe\u770b\u505a\u4e00\u5f20\u5730\u56fe\uff0c\u5b83\u4f4d\u4e8e\u4e2d\u592ePCI\u603b\u7ebf\u7684\u5317\u65b9\u5411\uff09\uff0c\u5317\u6865\u662f\u5904\u7406\u5668\u4e0ePCI\u603b\u7ebf\u4e4b\u95f4\u7684\u63a5\u53e3\u3002\u4e0e\u5317\u6865\u76f8\u8fde\u7684\u662f\u5904\u7406\u5668\u603b\u7ebf\uff08processor bus\uff09\u3001\u7cfb\u7edf\u5b58\u50a8\u603b\u7ebf\uff08system memory bus\uff09\u3001AGP\u56fe\u50cf\u603b\u7ebf\uff08AGP graphics bus\uff09\uff0c\u4ee5\u53caPCI\u603b\u7ebf\u3002\u51e0\u4e2a\u8bbe\u5907\u5c06\u4f1a\u5171\u4eabPCI\u603b\u7ebf\uff0c\u5b83\u4eec\u8981\u4e48\u76f4\u63a5\u4e0e\u603b\u7ebf\u76f8\u8fde\uff0c\u8981\u4e48\u4f5c\u4e3a\u63d2\u5165\u677f\u5361\u63d2\u5165\u5230\u8fde\u63a5\u5668\u4e0a\u3002\u5728\u4e2d\u592ePCI\u603b\u7ebf\u7684\u201c\u5357\u65b9\u201d\u6709\u4e00\u4e2a\u5357\u6865\uff08South Bridge\uff09\uff0c\u5b83\u7528\u4e8e\u5c06PCI\u4e0e\u7cfb\u7edf\u5916\u8bbe\u76f8\u8fde\u63a5\uff0c\u8fd9\u91cc\u7684\u7cfb\u7edf\u5916\u8bbe\u53ef\u4ee5\u662f\u4e3a\u4e86\u4f7f\u7528\u65e7\u7684\u9057\u7559\u8bbe\u5907\u800c\u5e94\u7528\u53d1\u5c55\u4e86\u591a\u5e74\u7684ISA\u603b\u7ebf\u3002\u5357\u6865\u901a\u5e38\u4e5f\u662fPCI\u7684\u4e2d\u5fc3\u8d44\u6e90\u533a\uff08central resource\uff09\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7cfb\u7edf\u4fe1\u53f7\u8bf8\u5982\u590d\u4f4d\u3001\u53c2\u8003\u65f6\u949f\u548c\u9519\u8bef\u62a5\u544a\u64cd\u4f5c\u3002</p> <p></p> <p>\u56fe 1\u20111\u57fa\u4e8e\u65e7PCI\u603b\u7ebf\u7684\u5e73\u53f0</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#132-pciinitiatortarget","title":"1.3.2     PCI\u603b\u7ebf\u53d1\u8d77\u65b9(Initiator)\u4e0e\u76ee\u6807\u65b9(Target)","text":"<p>\u5728PCI\u5c42\u6b21\u7ed3\u6784\u4e2d\uff0c\u603b\u7ebf\u4e0a\u7684\u6bcf\u4e2a\u8bbe\u5907\uff08device\uff09\u53ef\u4ee5\u5305\u542b\u591a\u8fbe8\u4e2a\u529f\u80fd\uff08function\uff09\uff0c\u8fd9\u4e9b\u529f\u80fd\u90fd\u5171\u4eab\u8be5\u8bbe\u5907\u7684\u603b\u7ebf\u63a5\u53e3\uff0c\u529f\u80fd\u7f16\u53f7\u4e3a0\u52307\uff08\u4e00\u4e2a\u4ec5\u5177\u6709\u5355\u529f\u80fd\u7684\u8bbe\u5907\u901a\u5e38\u5c06\u88ab\u5206\u914d\u529f\u80fd\u53f70\uff09\u3002\u6bcf\u4e2a\u529f\u80fd\u90fd\u80fd\u4f5c\u4e3a\u603b\u7ebf\u4e0a\u4e8b\u52a1\uff08transaction\uff09\u7684\u76ee\u6807\u65b9\uff0c\u800c\u4e14\u5b83\u4eec\u4e2d\u7684\u5927\u591a\u6570\u8fd8\u53ef\u4ee5\u4f5c\u4e3a\u4e8b\u52a1\u7684\u53d1\u8d77\u65b9\u3002\u8fd9\u6837\u7684\u53d1\u8d77\u65b9\uff08\u79f0\u4e3a\u603b\u7ebf\u4e3b\u8bbe\u5907\uff09\u6709\u4e00\u5bf9\u9488\u811a\uff08REQ#\u4e0eGNT#\uff0c\u7b26\u53f7#\u8868\u793a\u4ed6\u4eec\u4e3a\u4f4e\u6709\u6548\u4fe1\u53f7\uff09\uff0c\u8fd9\u4e00\u5bf9\u4fe1\u53f7\u7528\u6765\u5904\u7406\u5171\u4eabPCI\u603b\u7ebf\u65f6\u7684\u4ef2\u88c1\u3002\u5982\u56fe 1\u20112\u6240\u793a\uff0c\u8bf7\u6c42\u4fe1\u53f7\uff08REQ#\uff09\u6709\u6548\u65f6\u8868\u793a\u4e3b\u8bbe\u5907\u9700\u8981\u4f7f\u7528\u603b\u7ebf\uff0c\u5e76\u5c06\u6b64\u4fe1\u606f\u544a\u77e5\u603b\u7ebf\u4ef2\u88c1\u5668\u6765\u4e0e\u6b64\u65f6\u6240\u6709\u7684\u5176\u4ed6\u8bf7\u6c42\u4e00\u8d77\u8fdb\u884c\u8bc4\u4f30\u4ef2\u88c1\uff0c\u6700\u7ec8\u5c06\u5f97\u51fa\u4e0b\u4e00\u65f6\u523b\u7531\u54ea\u4e00\u4e2a\u8bbe\u5907\u6765\u5360\u7528PCI\u603b\u7ebf\u3002\u4ef2\u88c1\u5668\u901a\u5e38\u4f4d\u4e8e\u6865\uff08bridge\uff09\u4e2d\uff0c\u6865\u662f\u4e00\u79cd\u5728\u5c42\u6b21\u7ed3\u6784\u4e2d\u4f4d\u4e8e\u603b\u7ebf\u4e4b\u4e0a\u7684\u7ed3\u6784\uff0c\u5b83\u53ef\u4ee5\u63a5\u6536\u603b\u7ebf\u4e0a\u6240\u6709\u4e8b\u52a1\u53d1\u8d77\u65b9\uff08\u603b\u7ebf\u4e3b\u8bbe\u5907\uff09\u6240\u53d1\u51fa\u7684\u4ef2\u88c1\u8bf7\u6c42\u3002\u4ef2\u88c1\u5668\u5c06\u51b3\u5b9a\u8c01\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\uff0c\u5e76\u5c06\u8fd9\u4e2a\u8bbe\u5907\u7684Grant\uff08GNT#\uff09\u7f6e\u4e3a\u6709\u6548\uff08asserts the Grant pin for that device\uff09\u3002\u6839\u636e\u534f\u8bae\uff0c\u53ea\u8981\u603b\u7ebf\u4e0a\u7684\u4e0a\u4e00\u4e2a\u4e8b\u52a1\u7ed3\u675f\u4e14\u603b\u7ebf\u8fdb\u5165\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u5bf9\u4e8e\u4efb\u610f\u8bbe\u5907\uff0c\u53ea\u8981\u5728\u6b64\u65f6\u770b\u5230\u81ea\u5df1\u7684GNT#\u4fe1\u53f7\u88ab\u7f6e\u4e3a\u6709\u6548\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u7684\u4e3b\u8bbe\u5907\uff0c\u5b83\u5c31\u53ef\u4ee5\u5f00\u59cb\u53d1\u8d77\u5b83\u7684\u4e8b\u52a1\u3002</p> <p></p> <p>\u56fe 1\u20112 PCI\u603b\u7ebf\u4ef2\u88c1</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#133-pci","title":"1.3.3     \u5178\u578b\u7684PCI\u603b\u7ebf\u5468\u671f","text":"<p>\u56fe 1\u20113\u5c55\u793a\u4e86\u4e00\u6b21\u5178\u578b\u7684PCI\u603b\u7ebf\u5468\u671f\u3002PCI\u603b\u7ebf\u662f\u540c\u6b65\u603b\u7ebf\uff0c\u8fd9\u610f\u5473\u7740\u603b\u7ebf\u4e0a\u7684\u6d3b\u52a8\u90fd\u53d1\u751f\u5728\u65f6\u949f\u8fb9\u6cbf\uff0c\u56e0\u6b64\u5c06\u65f6\u949f\u4fe1\u53f7\u653e\u5728\u56fe\u6807\u7684\u9876\u90e8\uff0c\u5e76\u5c06\u5b83\u7684\u4e0a\u5347\u6cbf\u90fd\u7528\u865a\u7ebf\u6807\u6ce8\u51fa\u6765\uff0c\u8fd9\u662f\u56e0\u4e3a\u4fe1\u53f7\u6b63\u662f\u5728\u8fd9\u4e9b\u865a\u7ebf\u6240\u8868\u793a\u7684\u65f6\u523b\u88ab\u53d1\u51fa\uff08driven out\uff09\u6216\u88ab\u91c7\u6837\uff08sampled\uff09\u3002\u4e0b\u9762\u5bf9\u603b\u7ebf\u4e0a\u53d1\u751f\u4e86\u4ec0\u4e48\u8fdb\u884c\u4e00\u4e2a\u7b80\u660e\u7684\u63cf\u8ff0\u3002</p> <p>\\1.    \u5728\u65f6\u949f\u6cbf1\uff0cFRAME#\u4fe1\u53f7\uff08\u6b64\u4fe1\u53f7\u6709\u6548\u65f6\u8868\u793a\u6b63\u5728\u8fdb\u884c\u603b\u7ebf\u8bbf\u95ee\uff09\u548cIRDY#\u4fe1\u53f7\uff08Initiator ReaDY for data\uff0c\u53d1\u8d77\u65b9\u51c6\u5907\u597d\u6570\u636e\uff09\u8fd9\u4e24\u4e2a\u4fe1\u53f7\u90fd\u5904\u4e8e\u65e0\u6548\u72b6\u6001\uff0c\u8fd9\u8868\u793a\u603b\u7ebf\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\u3002\u4e0e\u6b64\u540c\u65f6\uff0cGNT#\u6709\u6548\uff0c\u8fd9\u610f\u5473\u7740\u603b\u7ebf\u4ef2\u88c1\u5668\u5df2\u7ecf\u9009\u62e9\u4e86\u8be5\u8bbe\u5907\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u4e8b\u52a1\u53d1\u8d77\u65b9\uff08Initiator\uff09\u3002</p> <p>\\2.    \u5728\u65f6\u949f\u6cbf2\uff0c\u53d1\u8d77\u65b9\u5c06\u4f1a\u628aFRAME#\u4fe1\u53f7\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u8868\u793a\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\u5df2\u7ecf\u88ab\u5b83\u53d1\u8d77\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u5b83\u5c06\u628a\u8fd9\u4e2a\u4e8b\u52a1\u7684\u5730\u5740\u4e0e\u547d\u4ee4\u9a71\u52a8\u5230\u603b\u7ebf\u4e0a\u3002\u603b\u7ebf\u4e0a\u5176\u4ed6\u6240\u6709\u7684\u8bbe\u5907\u90fd\u5c06\u4f1a\u628a\u8fd9\u4e9b\u4fe1\u606f\u9501\u5b58\u8d77\u6765\uff0c\u5e76\u5c06\u5730\u5740\u8bd1\u7801\uff0c\u67e5\u770b\u81ea\u5df1\u7684\u5730\u5740\u662f\u5426\u4e0e\u4e4b\u76f8\u5339\u914d\u3002</p> <p>\\3.    \u5728\u65f6\u949f\u6cbf3\uff0c\u53d1\u8d77\u65b9\u5c06IRDY#\u4fe1\u53f7\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u8868\u793a\u5b83\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002\u56fe\u4e2dAD\u603b\u7ebf\u4e0a\u7684\u73af\u5f62\u7bad\u5934\u7b26\u53f7\u8868\u793a\u8fd9\u4e2a\u4e09\u6001\u603b\u7ebf\uff08\u53ef\u4ee5\u7406\u89e3\u4e3ainout\u578b\uff09\u6b63\u5904\u4e8e\u201c\u8f6c\u5411\u5468\u671f\u201d\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2a\u4fe1\u53f7\u7684\u62e5\u6709\u8005\uff08\u4e09\u6001\u603b\u7ebf\u4e0a\u7684\u4fe1\u53f7\u6b64\u65f6\u662f\u8c01\u9a71\u52a8\u7684\uff09\u53d1\u751f\u4e86\u53d8\u5316\uff08\u8fd9\u91cc\u51fa\u73b0\u201c\u8f6c\u5411\u5468\u671fturn-around cycles\u201d\u662f\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u8bfb\u4e8b\u52a1\uff1b\u53d1\u8d77\u8005\u53d1\u51fa\u5730\u5740\u4fe1\u606f\u548c\u63a5\u6536\u6570\u636e\u7684\u4fe1\u53f7\u5f15\u811a\u662f\u76f8\u540c\u7684\uff09\u3002\u6253\u5f00\u76ee\u6807\u65b9\uff08Target\uff09\u7684\u7f13\u51b2buffer\u7684\u65f6\u949f\u6cbf\u4e0e\u5173\u95ed\u53d1\u8d77\u65b9\u7f13\u51b2buffer\u7684\u65f6\u949f\u6cbf\u4e0d\u80fd\u76f8\u540c\uff0c\u56e0\u4e3a\u6211\u4eec\u60f3\u5c3d\u91cf\u907f\u514d\u4e24\u4e2a buffer \u90fd\u5728\u9a71\u52a8\u540c\u4e00\u4e2a\u4fe1\u53f7\u7684\u53ef\u80fd\u6027\uff08\u5373\u90fd\u5f80AD\u603b\u7ebf\u4e0a\u9a71\u52a8\u6570\u636e\uff09\uff0c\u54ea\u6015\u53ea\u662f\u5f88\u77ed\u7684\u65f6\u95f4\u4e5f\u4e0d\u884c\u3002\u603b\u7ebf\u7684\u4e89\u7528\u5c06\u4f1a\u635f\u574f\u8bbe\u5907\uff0c\u56e0\u6b64\uff0c\u9700\u8981\u5728\u524d\u4e00\u4e2abuffer\u5173\u95ed\u540e\u7684\u4e0b\u4e00\u4e2a\u65f6\u949f\u518d\u6253\u5f00\u4e00\u4e2a\u65b0\u7684 buffer \u3002\u5728\u6539\u53d8\u603b\u7ebf\u7684\u9a71\u52a8\u65b9\u5411\u4e4b\u524d\uff0c\u6bcf\u4e2a\u5171\u4eab\u4fe1\u53f7\u90fd\u9700\u8981\u8fd9\u6837\u8fdb\u884c\u5904\u7406\u3002</p> <p>\\4.    \u5728\u65f6\u949f\u6cbf4\uff0c\u603b\u7ebf\u4e0a\u7684\u4e00\u4e2a\u8bbe\u5907\u8bc6\u522b\u5230\u4e86\u8bf7\u6c42\u7684\u5730\u5740\u4e0e\u81ea\u5df1\u76f8\u5339\u914d\uff0c\u4e8e\u662f\u4fbf\u901a\u8fc7\u5c06DEVSEL#\u4fe1\u53f7\uff08device select\uff09\u7f6e\u4e3a\u6709\u6548\u7684\u65b9\u5f0f\u5bf9\u4e8b\u52a1\u53d1\u51fa\u54cd\u5e94\uff0c\u58f0\u660e\u53c2\u4e0e\u5230\u4e8b\u52a1\u4e2d\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u5b83\u5c06\u628a TRDY# \u4fe1\u53f7\uff08Target ReaDY\uff09\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u8868\u793a\u5b83\uff08Target\uff09\u6b63\u5728\u53d1\u9001\u8bfb\u6570\u636e\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u5e76\u5c06\u6570\u636e\u9a71\u52a8\u5230AD\u603b\u7ebf\u4e0a\uff08\u653e\u5230\u603b\u7ebf\u4e0a\u7684\u65f6\u95f4\u53ef\u4ee5\u540e\u5ef6\uff0c\u603b\u7ebf\u5141\u8bb8\u76ee\u6807\u65b9\u5728FRAME#\u6709\u6548\u4e0eTRDY#\u6709\u6548\u95f4\u95f4\u9694\u6700\u591a16\u4e2a\u65f6\u949f\u5468\u671f\uff09\u3002\u7531\u4e8e\u6b64\u65f6 IRDY# \u4e0e TRDY# \u90fd\u5904\u4e8e\u6709\u6548\u72b6\u6001\u4e86\uff0c\u6570\u636e\u5c06\u5728\u6b64\u4e0a\u5347\u6cbf\u5f00\u59cb\u4f20\u8f93\uff0c\u81f3\u6b64\u5b8c\u6210\u4e86\u7b2c\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff08first data phase\uff09\u3002Initiator \u77e5\u9053\u6700\u7ec8\u4e00\u5171\u8981\u4f20\u8f93\u591a\u5c11\u5b57\u8282\u7684\u6570\u636e\uff0c\u4f46\u662f Target \u5e76\u4e0d\u77e5\u9053\u3002\u5728\u4e8b\u52a1\u7684\u547d\u4ee4\u4fe1\u606f\u4e2d\u5e76\u4e0d\u5305\u542b\u5b57\u8282\u6570\u4fe1\u606f\uff0c\u56e0\u6b64\u6bcf\u5f53\u5b8c\u6210\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff0cTarget \u90fd\u5fc5\u987b\u67e5\u770b FRAME# \u4fe1\u53f7\u7684\u72b6\u6001\uff0c\u4ee5\u6b64\u6765\u5f97\u77e5 Initiator \u662f\u5426\u5bf9\u4f20\u8f93\u7684\u6570\u636e\u91cf\u6ee1\u610f\uff08\u5373\u662f\u5426\u8fbe\u5230 Initiator \u9700\u8981\u7684\u6570\u636e\u91cf\uff09\u3002\u5982\u679cFRAME#\u4f9d\u7136\u6709\u6548\uff0c\u90a3\u4e48\u8bf4\u660e\u8fd9\u5e76\u4e0d\u662f\u6700\u540e\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff0cTarget \u4ecd\u7136\u9700\u8981\u7ee7\u7eed\u5411 Initiator \u4f20\u8f93\u6570\u636e\uff0c\u4e8b\u52a1\u5c06\u6309\u7167\u76f8\u540c\u7684\u65b9\u5f0f\u7ee7\u7eed\u5904\u7406\u63a5\u4e0b\u6765\u4f20\u8f93\u7684\u5b57\u8282\u3002</p> <p>\\5.    \u5728\u65f6\u949f\u6cbf5\uff0cTarget \u8fd8\u6ca1\u6709\u51c6\u5907\u597d\u7ee7\u7eed\u53d1\u9001\u4e0b\u4e00\u7ec4\u6570\u636e\uff0c\u56e0\u6b64\u5b83\u5c06 TRDY# \u7f6e\u4e3a\u65e0\u6548\u3002\u6211\u4eec\u5c06\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a\u63d2\u5165\u4e86\u4e00\u4e2a\u201c\u7b49\u5f85\u72b6\u6001\u201d\uff0c\u8fd9\u4f7f\u5f97\u4e8b\u52a1\u88ab\u5ef6\u8fdf\u4e86\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u3002Initiator\u548cTarget\u90fd\u53ef\u4ee5\u8fdb\u884c\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u5b83\u4eec\u6700\u591a\u53ef\u4ee5\u5c06\u4e0b\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u540e\u5ef68\u4e2a\u8fde\u7eed\u7684\u65f6\u949f\u5468\u671f\u3002</p> <p>\\6.    \u5728\u65f6\u949f\u6cbf6\uff0c\u7b2c\u4e8c\u7ec4\u6570\u636e\u88ab\u4f20\u8f93\uff0c\u5e76\u4e14\u7531\u4e8e\u4f20\u8f93\u540eFRAME# \u4fe1\u53f7\u4f9d\u7136\u6709\u6548\uff0cTarget\u5c31\u77e5\u9053\u4f9d\u7136\u9700\u8981\u7ee7\u7eed\u5411Initiator\u4f20\u9012\u6570\u636e\u3002</p> <p>\\7.    \u5728\u65f6\u949f\u6cbf7\uff0cInitiator\u5f3a\u5236\u603b\u7ebf\u8fdb\u5165\u4e86\u4e00\u4e2a\u7b49\u5f85\u72b6\u6001\u3002\u5728\u7b49\u5f85\u72b6\u6001\u4e2d\uff0c\u8bbe\u5907\u53ef\u4ee5\u4f7f\u5f53\u524d\u4e8b\u52a1\u6682\u505c\uff0c\u5e76\u5feb\u901f\u5730\u5c06\u8981\u53d1\u9001\u7684\u6570\u636e\u586b\u5145\u8fdbbuffer\u6216\u662f\u5c06\u63a5\u6536\u5230\u7684\u7f13\u5b58\u5728buffer\u5185\u7684\u6570\u636e\u642c\u51fa\uff0c\u80fd\u8fdb\u884c\u8fd9\u6837\u7684\u64cd\u4f5c\u662f\u56e0\u4e3aInitiator\u548cTarget\u5141\u8bb8\u4e8b\u52a1\u5728\u6682\u505c\u540e\u76f4\u63a5\u6062\u590d\uff0c\u800c\u4e0d\u9700\u8981\u8fdb\u884c\u4e2d\u6b62\u548c\u91cd\u542f\u4e8b\u52a1\u7684\u64cd\u4f5c\u3002\u4f46\u662f\u4ece\u53e6\u4e00\u65b9\u9762\u6765\u8bf4\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u5c06\u4f1a\u5341\u5206\u4f4e\u6548\uff0c\u56e0\u4e3a\u5b83\u4e0d\u4ec5\u4f7f\u5f53\u524d\u4e8b\u52a1\u505c\u987f\uff0c\u540c\u65f6\u4e5f\u7981\u6b62\u5176\u4ed6\u8bbe\u5907\u8bbf\u95ee\u548c\u4f7f\u7528\u603b\u7ebf\uff0c\u5c3d\u7ba1\u6b64\u65f6\u603b\u7ebf\u4e0a\u6ca1\u6709\u6570\u636e\u5728\u4f20\u8f93\u3002</p> <p>\\8.    \u5728\u65f6\u949f\u6cbf8\uff0c\u7b2c\u4e09\u7ec4\u6570\u636e\u88ab\u4f20\u8f93\uff0c\u5e76\u4e14\u6b64\u65f6FRAME#\u4fe1\u53f7\u88ab\u7f6e\u4e3a\u65e0\u6548\uff0c\u56e0\u6b64Target\u5f97\u77e5\u8fd9\u5c31\u662f\u6700\u540e\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u3002\u56e0\u6b64\uff0c\u5728\u8fd9\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u540e\uff0c\u6240\u6709\u7684\u63a7\u5236\u4fe1\u53f7\u7ebf\u90fd\u5173\u95ed\uff0c\u603b\u7ebf\u518d\u6b21\u8fdb\u5165\u4e86\u7a7a\u95f2\u72b6\u6001\u3002</p> <p>\u5728PCI\u603b\u7ebf\u4e0a\uff0c\u8bb8\u591a\u4fe1\u53f7\u90fd\u5177\u6709\u591a\u79cd\u542b\u4e49\uff0c\u8fd9\u662f\u4e3a\u4e86\u51cf\u5c11\u5f15\u811a\u6570\u91cf\uff0c\u4ee5\u6b64\u6765\u4fdd\u6301PCI\u8bbe\u8ba1\u4e2d\u7684\u4f4e\u6210\u672c\u8fd9\u4e00\u8bbe\u8ba1\u76ee\u6807\u3002\u6570\u636e\u548c\u5730\u5740\u4fe1\u53f7\u4e00\u8d77\u590d\u752832bit\u603b\u7ebf\uff0cC/BE#\uff08Command/Byte Enable\uff09\u4fe1\u53f7\u4e5f\u5171\u4eab\u4ed6\u4eec\u76844\u4e2a\u4fe1\u53f7\u5f15\u811a\u3002\u5c3d\u7ba1\u51cf\u5c11\u5f15\u811a\u6570\u91cf\u662f\u4e00\u79cd\u53ef\u884c\u7684\u65b9\u6cd5\uff0c\u5e76\u4e14\u5b83\u4e5f\u662fPCI\u4f7f\u7528\u201c\u8f6c\u5411\u5468\u671f\u201d\u8fd9\u79cd\u4f1a\u589e\u52a0\u5ef6\u65f6\u7684\u65b9\u6cd5\u7684\u539f\u56e0\u3002\u4f46\u662f\u8fd9\u79cd\u590d\u7528\u5f15\u811a\u7684\u505a\u6cd5\u963b\u6b62\u4e86\u5bf9\u4e8b\u52a1\u7684\u6d41\u6c34\u7ebf\u64cd\u4f5c\uff08\u5728\u53d1\u9001\u4e0a\u4e00\u4e2a\u5468\u671f\u7684\u6570\u636e\u7684\u540c\u65f6\u53d1\u9001\u4e0b\u4e00\u4e2a\u5468\u671f\u7684\u5730\u5740\uff09\u3002\u63e1\u624b\u4fe1\u53f7\u8bf8\u5982FRAME#\u3001DEVSEL#\u3001TRDY#\u3001IRDY#\u4ee5\u53caSTOP#\u88ab\u7528\u6765\u63a7\u5236\u5728\u4e8b\u52a1\uff08transaction\uff09\u8fdb\u884c\u671f\u95f4\uff0c\u5404\u4e8b\u4ef6\uff08event\uff09\u4f55\u65f6\u8fdb\u884c\u3002</p> <p></p> <p>\u56fe 1\u20113\u7b80\u5355\u7684PCI\u603b\u7ebf\u4f20\u8f93</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#134-reflected-wave-signaling","title":"1.3.4     \u53cd\u5c04\u6ce2\u4fe1\u53f7\u4f20\u8f93(Reflected-Wave Signaling)","text":"<p>PCI\u4f53\u7cfb\u7ed3\u6784\u652f\u6301\u6bcf\u8def\u603b\u7ebf\u4e0a\u6700\u591a\u6302\u8f7d32\u4e2a\u8bbe\u5907\uff0c\u4f46\u662f\u7531\u4e8e\u5b9e\u9645\u7684\u7535\u6c14\u4e0a\u9650\u8981\u5c0f\u5f97\u591a\uff0c\u572833MHz\u7684\u57fa\u9891\u4e0b\u5927\u7ea6\u53ef\u4ee5\u652f\u630110\u523012\u4e2a\u7535\u6c14\u8d1f\u8f7d\u3002\u51fa\u73b0\u8fd9\u79cd\u73b0\u8c61\u662f\u7531\u4e8e\u603b\u7ebf\u4f7f\u7528\u4e86\u4e00\u79cd\u6280\u672f\u79f0\u4e3a\u201c\u53cd\u5c04\u6ce2\u4fe1\u53f7\u4f20\u8f93\u201d\uff0c\u8be5\u6280\u672f\u53ef\u4ee5\u964d\u4f4e\u603b\u7ebf\u4e0a\u7684\u529f\u7387\u635f\u8017\uff08\u5982\u56fe 1\u20114\uff09\u3002\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0c\u8bbe\u5907\u901a\u8fc7\u5b9e\u73b0\u5f31\u4f20\u8f93\u7f13\u51b2buffer\uff08weak transmit buffer\uff09\u6765\u8fbe\u5230\u8282\u7701\u6210\u672c\u4e0e\u529f\u8017\u7684\u76ee\u7684\uff0c\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u4ec5\u9700\u4e00\u534a\u7684\u9a71\u52a8\u7535\u538b\u5373\u53ef\u5b8c\u6210\u4fe1\u53f7\u7535\u5e73\u7684\u7ffb\u8f6c\u3002\u4fe1\u53f7\u7684\u5165\u5c04\u6ce2\u6cbf\u7740\u4f20\u8f93\u7ebf\u4f20\u8f93\u4e0b\u53bb\uff0c\u76f4\u5230\u5230\u8fbe\u4f20\u8f93\u7ebf\u7684\u672b\u7aef\u3002\u6309\u7167\u8bbe\u8ba1\uff0c\u4f20\u8f93\u7ebf\u7684\u672b\u7aef\u6ca1\u6709\u7ec8\u7ed3\u7535\u963b\uff08termination\uff09\u5438\u6536\u56de\u6ce2\uff0c\u6240\u4ee5\u4fe1\u53f7\u4f20\u8f93\u5e76\u6ca1\u6709\u5c31\u6b64\u4e2d\u6b62\uff0c\u6ce2\u9635\u9762\uff08wavefront\uff09\u5728\u906d\u9047\u4f20\u8f93\u7ebf\u672b\u7aef\u7684\u65e0\u7a77\u5927\u963b\u6297\u540e\u4f1a\u88ab\u53cd\u5c04\u56de\u6765\u3002\u8fd9\u79cd\u53cd\u5c04\u81ea\u7136\u662f\u5177\u6709\u53e0\u52a0\u6027\u7684\uff0c\u5f53\u4fe1\u53f7\u8fd4\u56de\u53d1\u5c04\u65b9\u65f6\uff0c\u5b83\u4f1a\u4e0e\u5165\u5c04\u4fe1\u53f7\u53e0\u52a0\u4f7f\u4fe1\u53f7\u589e\u52a0\u5230\u5168\u7535\u538b\u7535\u5e73\u3002\u5f53\u8fd9\u6837\u7684\u53cd\u5c04\u4fe1\u53f7\u5230\u8fbe\u521d\u59cb\u7684buffer\u65f6\uff0cbuffer\u9a71\u52a8\u5668\u7684\u4f4e\u8f93\u51fa\u963b\u6297\u4f1a\u4e2d\u6b62\u8fd9\u4e2a\u4fe1\u53f7\u7684\u4f20\u8f93\u4ee5\u53ca\u505c\u6b62\u5176\u7ee7\u7eed\u53cd\u5c04\u3002\u56e0\u6b64\uff0c\u4ecebuffer\u53d1\u51fa\u4e00\u4e2a\u4fe1\u53f7\u4e00\u76f4\u5230\u63a5\u6536\u65b9\u68c0\u6d4b\u5230\u6709\u6548\u7684\u4fe1\u53f7\u6240\u82b1\u8d39\u7684\u65f6\u95f4\uff0c\u5c31\u7b49\u4e8e\u4fe1\u53f7\u6cbf\u7ebf\u8def\u4f20\u8f93\u7684\u65f6\u95f4\u52a0\u4e0a\u53cd\u5c04\u56de\u6765\u7684\u5ef6\u8fdf\u65f6\u95f4\u548c\u5efa\u7acb\u65f6\u95f4\u3002\u6240\u6709\u8fd9\u4e9b\u90fd\u5fc5\u987b\u5c0f\u4e8e\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u3002</p> <p></p> <p>\u56fe 1\u20114 PCI\u7684\u53cd\u5c04\u6ce2\u4fe1\u53f7\u4f20\u8f93</p> <p>\u5f53\u8d70\u7ebf\u957f\u5ea6\u548c\u603b\u7ebf\u4e0a\u7684\u7535\u6c14\u8d1f\u8f7d\u6570\u91cf\u589e\u52a0\u65f6\uff0c\u4fe1\u53f7\u5f80\u8fd4\u6240\u9700\u8981\u7684\u65f6\u95f4\u4e5f\u589e\u52a0\u3002\u4e00\u4e2a33MHz\u7684PCI\u603b\u7ebf\u53ea\u80fd\u6ee1\u8db3\u6700\u591a10-12\u4e2a\u7535\u6c14\u8d1f\u8f7d\u7684\u4fe1\u53f7\u65f6\u5e8f\u8981\u6c42\u3002\u4e00\u4e2a\u7535\u6c14\u8d1f\u8f7d\u6307\u7684\u662f\u7cfb\u7edf\u677f\u4e0a\u5b89\u88c5\u7684\u4e00\u4e2a\u8bbe\u5907\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u4e00\u4e2a\u63d2\u4e86\u677f\u5361\u7684\u8fde\u63a5\u5668\u63d2\u69fd\u88ab\u7b97\u4f5c\u4e24\u4e2a\u7535\u6c14\u8d1f\u8f7d\u3002\u56e0\u6b64\uff0c\u5982\u8868 1\u20111\u6240\u793a\u7684\u90a3\u6837\uff0c\u4e00\u4e2a33MHz\u7684PCI\u603b\u7ebf\u6700\u591a\u53ea\u80fd\u652f\u6301\u81f3\u591a4\u4e2a\u6216\u80055\u4e2a\u63d2\u5165\u677f\u5361\u578b\u8bbe\u5907\uff0c\u5426\u5219\u5c06\u65e0\u6cd5\u4fdd\u8bc1\u53ef\u9760\u6027\u3002</p> <p>\u4e3a\u4e86\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u63a5\u5165\u66f4\u591a\u7684\u8d1f\u8f7d\uff0c\u9700\u8981\u4f7f\u7528PCI-to-PCI bridge\uff0c\u5982\u56fe 1\u20115\u6240\u793a\u3002\u5f53\u51fa\u73b0\u4e86\u8d8a\u6765\u8d8a\u591a\u66f4\u4e3a\u5148\u8fdb\u7684\u4e3b\u82af\u7247\u7ec4\u540e\uff0c\u5916\u8bbe\u7684\u53d1\u5c55\u4e5f\u5341\u5206\u8fc5\u901f\uff0c\u4ee5\u81f3\u4e8e\u7ade\u4e89\u8bbf\u95ee\u5171\u4eabPCI\u603b\u7ebf\u53d8\u6210\u4e86\u9650\u5236\u5916\u8bbe\u6027\u80fd\u7684\u539f\u56e0\u3002PCI\u603b\u7ebf\u7684\u901f\u7387\u6ca1\u6709\u8ddf\u4e0a\u5916\u8bbe\u901f\u7387\u589e\u957f\u7684\u811a\u6b65\uff0c\u867d\u7136\u5b83\u4f9d\u65e7\u662f\u4e3b\u6d41\u7684\u5916\u8bbe\u603b\u7ebf\uff0c\u4f46\u662f\u5df2\u7ecf\u6210\u4e3a\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u74f6\u9888\u3002\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u51b3\u529e\u6cd5\u4e3a\uff0c\u628aPCI\u79fb\u5230\u7cfb\u7edf\u5916\u8bbe\u4e0e\u5b58\u50a8\u5668\u4e4b\u95f4\u7684\u4e3b\u8def\u5f84\u4e4b\u5916\uff0c\u5c06\u82af\u7247\u7ec4\u4e92\u8fde\u7528\u4e00\u4e9b\u4e13\u6709\u7684\u89e3\u51b3\u65b9\u6848\u6765\u66ff\u4ee3\uff08\u4f8b\u5982Intel\u7684Hub Link Interface\uff09\u3002</p> <p>PCI Bridge\u662f\u62d3\u6251\u7ed3\u6784\u7684\u5ef6\u4f38\u3002\u6bcf\u4e2aBridge\u90fd\u80fd\u4ea7\u751f\u65b0\u7684PCI\u603b\u7ebf\uff0c\u800c\u4e14\u8fd9\u79cd\u7531PCI Bridge\u4ea7\u751f\u7684PCI\u603b\u7ebf\u4e0e\u4e0a\u5c42PCI\u603b\u7ebf\u5728\u7535\u6c14\u4e0a\u662f\u76f8\u9694\u7edd\u7684\uff0c\u56e0\u6b64\u5b83\u4e5f\u53ef\u4ee5\u72ec\u7acb\u7684\u63d0\u4f9b\u989d\u5916\u768410-12\u4e2a\u7535\u6c14\u8d1f\u8f7d\u3002PCI\u603b\u7ebf\u4e0a\u7684\u4e00\u4e9b\u8bbe\u5907\u4e5f\u53ef\u4ee5\u4f5c\u4e3aBridge\uff0c\u53ef\u4ee5\u4ee4\u8f83\u591a\u7684\u8bbe\u5907\u63a5\u5165\u7cfb\u7edf\u4e2d\u3002PCI\u4f53\u7cfb\u7ed3\u6784\u5141\u8bb8\u5728\u5355\u7cfb\u7edf\u4e2d\u5b58\u5728256\u8def\u603b\u7ebf\uff0c\u6bcf\u8def\u603b\u7ebf\u4e0b\u6700\u591a\u53ef\u4ee5\u6302\u8f7d32\u4e2a\u8bbe\u5907\u3002</p> <p></p> <p>\u56fe 1\u20115 \u5305\u542bPCI-to-PCI bridge\u768433MHz PCI\u7cfb\u7edf</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#14-pcipci-bus-architecture-perspective","title":"1.4 PCI\u603b\u7ebf\u4f53\u7cfb\u7ed3\u6784\u900f\u89c6\u63a2\u7a76(PCI Bus Architecture Perspective)","text":""},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#141-pci","title":"1.4.1     PCI\u4e8b\u52a1\u6a21\u578b","text":"<p>PCI\u540c\u5148\u524d\u7684\u603b\u7ebf\u6a21\u578b\u4e00\u6837\uff0c\u5728\u6570\u636e\u4f20\u8f93\u4e0a\u4f7f\u7528\u4e09\u79cd\u6a21\u578b\uff1aProgrammed I/O\uff08PIO\uff09\u3001Peer-to-peer\u3001\u4ee5\u53caDMA\u3002\u8fd9\u4e9b\u6a21\u578b\u7684\u56fe\u89e3\u5982\u56fe 1\u20116\u6240\u793a\uff0c\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u5c06\u5bf9\u5b83\u4eec\u8fdb\u884c\u63cf\u8ff0\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1411-programmed-iopio","title":"1.4.1.1   Programmed I/O(PIO)","text":"<p>PIO\u5728\u65e9\u671fPC\u4e2d\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u56e0\u4e3a\u8bbe\u8ba1\u8005\u4e0d\u613f\u610f\u589e\u52a0\u8bbe\u5907\u4e2d\u7531\u4e8e\u4e8b\u52a1\u7ba1\u7406\u903b\u8f91\u800c\u5e26\u6765\u7684\u6210\u672c\u5f00\u9500\uff0c\u4ee5\u53ca\u989d\u5916\u589e\u52a0\u7684\u590d\u6742\u5ea6\u3002\u5728\u5f53\u65f6\uff0c\u5904\u7406\u5668\u6bd4\u4efb\u4f55\u5176\u4ed6\u8bbe\u5907\u5de5\u4f5c\u7684\u90fd\u8981\u5feb\uff0c\u6240\u4ee5\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0c\u5904\u7406\u5668\u5305\u63fd\u4e86\u6240\u6709\u7684\u5de5\u4f5c\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5f53\u4e00\u4e2aPCI\u8bbe\u5907\u5411CPU\u53d1\u51fa\u4e2d\u65ad\uff0c\u5e76\u8868\u793a\u5b83\u9700\u8981\u5411memory\u4e2d\u653e\u5165\u6570\u636e\uff0c\u5219\u7531CPU\u6700\u7ec8\u5c06\u6570\u636e\u4ecePCI\u8bbe\u5907\u4e2d\u8bfb\u51fa\u5e76\u653e\u5165\u4e00\u4e2a\u5185\u90e8\u5bc4\u5b58\u5668\u4e2d\uff0c\u7136\u540e\u518d\u5c06\u8fd9\u4e2a\u5185\u90e8\u5bc4\u5b58\u5668\u7684\u503c\u590d\u5236\u8fdbmemory\u4e2d\u3002\u53cd\u4e4b\uff0c\u5982\u679c\u6570\u636e\u8981\u4ecememory\u79fb\u52a8\u5230PCI\u8bbe\u5907\u4e2d\uff0c\u90a3\u4e48\u8f6f\u4ef6\u4f1a\u6307\u793aCPU\u5c06memory\u4e2d\u7684\u6570\u636e\u8bfb\u51fa\u81f3\u5185\u90e8\u5bc4\u5b58\u5668\u4e2d\uff0c\u7136\u540e\u518d\u5c06\u5185\u90e8\u5bc4\u5b58\u5668\u7684\u503c\u5199\u5165\u5230PCI\u8bbe\u5907\u4e2d\u53bb\u3002</p> <p>\u8fd9\u6837\u7684\u64cd\u4f5c\u6d41\u7a0b\u867d\u7136\u53ef\u884c\uff0c\u4f46\u662f\u6548\u7387\u5374\u6bd4\u8f83\u4f4e\uff0c\u5176\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\u3002\u7b2c\u4e00\u4e2a\u539f\u56e0\uff0c\u6bcf\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u90fd\u9700\u8981CPU\u5f00\u9500\u4e24\u4e2a\u603b\u7ebf\u5468\u671f\u3002\u7b2c\u4e8c\u4e2a\u539f\u56e0\uff0c\u5728\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\u4e2dCPU\u90fd\u8981\u5fd9\u4e8e\u6570\u636e\u4f20\u8f93\u800c\u4e0d\u80fd\u505a\u5176\u4ed6\u66f4\u6709\u610f\u4e49\u7684\u4efb\u52a1\u3002\u5728\u65e9\u671f\uff0c\u8fd9\u662f\u4e00\u79cd\u6700\u5feb\u901f\u7684\u4f20\u8f93\u65b9\u5f0f\uff0c\u800c\u4e14\u5355\u4efb\u52a1\u5904\u7406\u5668\u4e5f\u6ca1\u6709\u5176\u4ed6\u7684\u4efb\u52a1\u8981\u505a\u3002\u7136\u800c\u8fd9\u79cd\u4f4e\u6548\u7684\u65b9\u5f0f\u663e\u7136\u4e0d\u9002\u7528\u4e8e\u66f4\u4e3a\u5148\u8fdb\u7684\u7cfb\u7edf\u4e2d\uff0c\u56e0\u6b64\u8fd9\u79cd\u65b9\u5f0f\u5df2\u4e0d\u518d\u662f\u6570\u636e\u4f20\u8f93\u7684\u5e38\u7528\u65b9\u5f0f\uff0c\u53d6\u800c\u4ee3\u4e4b\u9996\u9009\u65b9\u6cd5\u7684\u662f\u4e0b\u4e00\u8282\u5c06\u8bb2\u8ff0\u7684DMA\u65b9\u6cd5\u3002\u7136\u800c\u4e3a\u4e86\u4f7f\u8f6f\u4ef6\u4e0e\u8bbe\u5907\u4ea4\u4e92\uff0cProgrammed IO\u4ecd\u7136\u662f\u4e00\u79cd\u5fc5\u8981\u7684\u4e8b\u52a1\u6a21\u578b\u3002</p> <p></p> <p>\u56fe 1\u20116 PCI\u4e8b\u52a1\u6a21\u578b</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1412-direct-memory-accessdma","title":"1.4.1.2   Direct Memory Access(DMA)","text":"<p>\u5728\u4f20\u8f93\u6570\u636e\u7684\u65b9\u6cd5\u4e0a\uff0c\u4e00\u79cd\u66f4\u4e3a\u9ad8\u6548\u7684\u65b9\u5f0f\u53eb\u505a DMA\uff08Direct Memory Access\uff0c\u76f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff09\u3002\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\u6709\u53e6\u4e00\u79cd\u8bbe\u5907\u79f0\u4e3aDMA Engine\uff0c\u7531\u5b83\u6765\u4ee3\u8868\u5904\u7406\u5668\u6765\u8d1f\u8d23\u638c\u63e1\u4ece memory \u5411\u5916\u8bbe\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u7684\u5404\u79cd\u7ec6\u8282\u64cd\u4f5c\uff0c\u8fd9\u5c31\u5c06\u8fd9\u4e2a\u7e41\u7410\u7684\u4efb\u52a1\u4eceCPU\u4e2d\u5378\u8f7d\u4e86\u4e0b\u6765\u3002\u4e00\u65e6CPU\u5c06\u8d77\u59cb\u5730\u5740\uff08starting address\uff09\u548c\u6570\u636e\u5b57\u8282\u603b\u91cf\uff08byte count\uff09\u5199\u5165DMA Engine\uff0cDMA Engine\u5c06\u4f1a\u81ea\u52a8\u5904\u7406\u603b\u7ebf\u534f\u8bae\u4e0e\u5730\u5740\u5e8f\u5217\u3002\u8fd9\u4e0d\u6d89\u53ca PCI \u5916\u8bbe\u7684\u4efb\u4f55\u66f4\u6539\uff0c\u5e76\u5141\u8bb8\u5176\u81ea\u8eab\u4fdd\u6301\u4f4e\u6210\u672c\u8bbe\u8ba1\u3002\u540e\u6765\uff0c\u7ecf\u8fc7\u96c6\u6210\u6027\u6539\u8fdb\uff0c\u5916\u8bbe\u81ea\u8eab\u53ef\u4ee5\u96c6\u6210\u5165\u8fd9\u79cdDMA\u529f\u80fd\uff0c\u8fd9\u6837\u5b83\u4eec\u5c31\u4e0d\u518d\u9700\u8981\u4e00\u4e2a\u5916\u90e8\u7684DMA Engine\u3002\u8fd9\u4e9b\u8bbe\u5907\u6709\u80fd\u529b\u5904\u7406\u81ea\u5df1\u53d1\u8d77\u7684\u603b\u7ebf\u4f20\u8f93\uff0c\u6211\u4eec\u5c06\u5b83\u4eec\u79f0\u4e3a\u603b\u7ebf\u4e3b\u8bbe\u5907\uff08Bus Master device\uff09\u3002</p> <p>\u56fe 1\u20113 \u5c31\u662f\u4e00\u4e2aPCI\u603b\u7ebf\u4e0a\u7684\u603b\u7ebf\u4e3b\u8bbe\u5907\u6b63\u5728\u8fdb\u884c\u4e8b\u52a1\u7684\u8fc7\u7a0b\u3002\u5317\u6865\u53ef\u4ee5\u5bf9\u5730\u5740\u8fdb\u884c\u8bd1\u7801\uff0c\u4ee5\u6b64\u6765\u8bc6\u522b\u81ea\u5df1\u662f\u5426\u662f\u8fd9\u4e2a\u4e8b\u52a1\u7684Target\uff0c\u6bd4\u5982\u5317\u6865\u8bd1\u7801\u540e\u53d1\u73b0\u5730\u5740\u4e0e\u81ea\u5df1\u76f8\u5339\u914d\u5219\u8ba4\u4e3a\u81ea\u5df1\u662f\u8fd9\u4e2a\u4e8b\u52a1\u7684Target\u3002\u5728\u603b\u7ebf\u5468\u671f\u4e2d\u7684\u6570\u636e\u4f20\u8f93\u9636\u6bb5\uff0c\u6570\u636e\u5728\u603b\u7ebf\u4e3b\u8bbe\u5907\u4e0e\u5317\u6865\u4e4b\u95f4\u4f20\u8f93\uff0c\u5317\u6865\u5373\u662f\u6570\u636e\u4f20\u8f93\u7684Target\u3002\u5317\u6865\u7ee7\u800c\u6839\u636e\u8bf7\u6c42\u7684\u4e8b\u52a1\u5185\u5bb9\uff0c\u53d1\u8d77 DRAM \u8bfb\u5199\u64cd\u4f5c\uff0c\u4e0e\u7cfb\u7edf\u5185\u5b58\u8fdb\u884c\u6570\u636e\u901a\u4fe1\u3002\u5728\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u540e\uff0cPCI\u5916\u8bbe\u53ef\u4ee5\u4ea7\u751f\u4e00\u4e2a\u4e2d\u65ad\u6765\u901a\u77e5\u7cfb\u7edf\u3002DMA\u63d0\u5347\u4e86\u6570\u636e\u4f20\u8f93\u6548\u7387\uff0c\u56e0\u4e3a\u8fd9\u79cd\u65b9\u5f0f\u5728\u642c\u79fb\u6570\u636e\u65f6\u4e0d\u9700\u8981CPU\u7684\u53c2\u4e0e\uff0c\u90a3\u4e48\u5bf9\u4e8eCPU\u6765\u8bf4\uff0c\u53ea\u9700\u8981\u4e00\u4e2a\u603b\u7ebf\u5468\u671f\u7684\u5f00\u9500\uff0c\u5c06\u8d77\u59cb\u5730\u5740\u548c\u603b\u6570\u636e\u91cf\u5199\u5165DMA Engine\uff0c\u5373\u53ef\u5b8c\u6210\u9ad8\u6548\u7684\u6570\u636e\u5757\u642c\u79fb\uff08move a block of data\uff09\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1413-peer-to-peer","title":"1.4.1.3   Peer-to-Peer(\u70b9\u5bf9\u70b9)","text":"<p>\u5982\u679c\u4e00\u4e2a\u8bbe\u5907\u80fd\u591f\u4f5c\u4e3a\u603b\u7ebf\u4e3b\u8bbe\u5907\uff0c\u90a3\u4e48\u5b83\u5c31\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6709\u8da3\u7684\u4f5c\u7528\u3002\u4e00\u4e2aPCI\u603b\u7ebfMaster\u53ef\u4ee5\u53d1\u8d77\u9488\u5bf9\u5176\u4ed6PCI\u8bbe\u5907\u7684\u6570\u636e\u4f20\u8f93\uff0c\u800c\u5bf9\u4e8ePCI\u603b\u7ebf\u81ea\u8eab\u6765\u8bf4\u8fd9\u6574\u4e2a\u4e8b\u52a1\u90fd\u662f\u5728\u672c\u5730\u8fdb\u884c\u7684\uff0c\u5e76\u672a\u5f15\u5165\u4efb\u4f55\u5176\u4ed6\u7cfb\u7edf\u8d44\u6e90\u3002\u56e0\u4e3a\u8fd9\u4e2a\u4e8b\u52a1\u662f\u5728\u603b\u7ebf\u4e0a\u7684\u4e24\u4e2a\u8bbe\u5907\u4e4b\u95f4\u8fdb\u884c\u7684\uff0c\u4e14\u8fd9\u4e24\u4e2a\u8bbe\u5907\u88ab\u8ba4\u4e3a\u662f\u603b\u7ebf\u4e2d\u4e24\u4e2a\u5bf9\u7b49\u7684\u8282\u70b9\uff0c\u56e0\u6b64\u8fd9\u4e2a\u4e8b\u52a1\u88ab\u79f0\u4f5c\u4e00\u4e2a\u201c\u70b9\u5bf9\u70b9\u201d\u7684\u4e8b\u52a1\u3002\u663e\u7136\uff0c\u8fd9\u79cd\u4e8b\u52a1\u975e\u5e38\u9ad8\u6548\uff0c\u56e0\u4e3a\u7cfb\u7edf\u4e2d\u5176\u4f59\u7684\u90e8\u5206\u4ecd\u7136\u53ef\u4ee5\u81ea\u7531\u7684\u5b8c\u6210\u5176\u4ed6\u7684\u4efb\u52a1\u3002\u7136\u800c\uff0c\u5728\u5b9e\u9645\u573a\u666f\u4e2d\u70b9\u5bf9\u70b9\u4e8b\u52a1\u5f88\u5c11\u88ab\u4f7f\u7528\uff0c\u8fd9\u662f\u56e0\u4e3aInitiator\u548cTarget\u901a\u5e38\u4e0d\u4f1a\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u683c\u5f0f\uff0c\u9664\u975e\u4e8c\u8005\u90fd\u662f\u7531\u4e00\u4e2a\u4f9b\u5e94\u5546\u5236\u9020\u7684\u3002\u56e0\u6b64\uff0c\u6570\u636e\u4e00\u822c\u5fc5\u987b\u8981\u9996\u5148\u53d1\u9001\u5230memory\uff0c\u5728\u90a3\u91cc\u7531CPU\u5728\u6570\u636e\u4f20\u8f93\u5230Target\u4e4b\u524d\uff0c\u5bf9\u5176\u8fdb\u884c\u683c\u5f0f\u8f6c\u6362\uff0c\u800c\u8fd9\u5c31\u963b\u788d\u5e76\u7834\u574f\u4e86\u70b9\u5bf9\u70b9\u4f20\u8f93\u7684\u8bbe\u8ba1\u76ee\u6807\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#142-pci","title":"1.4.2     PCI\u603b\u7ebf\u4ef2\u88c1","text":"<p>\u7531\u56fe 1\u20112 \u53ef\u77e5\uff0c\u5f53\u4eca\u7684PCI\u8bbe\u5907\u57fa\u672c\u90fd\u80fd\u4f5c\u4e3a\u603b\u7ebf\u4e3b\u8bbe\u5907\uff08Bus Master device\uff09\uff0c\u6240\u4ee5\u5b83\u4eec\u90fd\u53ef\u4ee5\u8fdb\u884cDMA\u4e0epeer-to-peer\u7684\u6570\u636e\u4f20\u8f93\u3002\u5728\u50cfPCI\u8fd9\u79cd\u5171\u4eab\u603b\u7ebf\u7684\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u5404\u8bbe\u5907\u9700\u8981\u8f6e\u6d41\u5360\u7528\u603b\u7ebf\uff0c\u56e0\u6b64\u5f53\u4e00\u4e2a\u8bbe\u5907\u60f3\u8981\u53d1\u8d77\u4e8b\u52a1\u65f6\u5fc5\u987b\u9996\u5148\u5411\u603b\u7ebf\u4ef2\u88c1\u5668\u8bf7\u6c42\u603b\u7ebf\u6240\u6709\u6743\uff08ownership\uff09\u3002\u4ef2\u88c1\u5668\u5c06\u67e5\u770b\u5f53\u524d\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u5e76\u4f7f\u7528\u4e00\u4e9b\u7279\u5b9a\u7684\u4ef2\u88c1\u5b9e\u73b0\u7b97\u6cd5\u6765\u51b3\u5b9a\u54ea\u4e2aMaster\u53ef\u4ee5\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u3002PCI\u534f\u8bae\u89c4\u8303\u5e76\u6ca1\u6709\u63cf\u8ff0\u8fd9\u4e2a\u4ef2\u88c1\u7b97\u6cd5\uff0c\u4f46\u662f\u6709\u58f0\u660e\u8fd9\u4e2a\u4ef2\u88c1\u5fc5\u987b\u662f\u201c\u516c\u5e73\u201d\u7684\uff0c\u4e0d\u5f97\u5728\u8bbf\u95ee\u4e2d\u5dee\u522b\u5bf9\u5f85\u4efb\u4f55\u4e00\u4e2a\u8bbe\u5907\u3002</p> <p>\u4ef2\u88c1\u5668\u53ef\u4ee5\u5728\u4e0a\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u7684Master\u8fd8\u6b63\u5728\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u65f6\u5c31\u51b3\u5b9a\u51fa\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u7684\u8bbe\u5907\uff0c\u8fd9\u6837\u603b\u7ebf\u4e0a\u5c31\u4e0d\u9700\u8981\u5f15\u5165\u989d\u5916\u7684\u65f6\u5ef6\u6765\u5bf9\u4e0b\u4e00\u4e2a\u603b\u7ebf\u6240\u6709\u8005\u8fdb\u884c\u6392\u5e8f\u3002\u56e0\u6b64\uff0c\u603b\u7ebf\u4ef2\u88c1\u5668\u7684\u4ef2\u88c1\u4f5c\u7528\u53d1\u6325\u5728\u201c\u5e55\u540e\u201d\uff0c\u88ab\u79f0\u4e3a\u201c\u9690\u85cf\u201d\u7684\u603b\u7ebf\u4ef2\u88c1\uff0c\u8fd9\u662f\u4e00\u79cd\u5bf9\u65e9\u671f\u603b\u7ebf\u534f\u8bae\u7684\u6539\u8fdb\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#143-pcipci-inefficiencies","title":"1.4.3     PCI\u4f4e\u6548\u7684\u5730\u65b9(PCI Inefficiencies)","text":""},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1431-pcipci-retry-protocol","title":"1.4.3.1   PCI\u91cd\u8bd5\u534f\u8bae(PCI Retry Protocol)","text":"<p>\u5f53\u4e00\u4e2aPCI Master\u53d1\u8d77\u4e00\u4e2a\u4e8b\u52a1\uff0c\u7528\u4e8e\u8bbf\u95ee\u4e00\u4e2aTarget\u8bbe\u5907\uff0c\u800c\u6b64\u65f6Target\u8bbe\u5907\u5e76\u672a\u5904\u4e8eReady\u72b6\u6001\uff0c\u90a3\u4e48Target\u5c31\u4f1a\u7ed9\u51fa\u4e00\u4e2a\u4e8b\u52a1\u91cd\u8bd5\u7684\u4fe1\u53f7\uff0c\u8fd9\u79cd\u573a\u666f\u7684\u793a\u610f\u56fe\u5982\u56fe 1\u20117\u3002</p> <p></p> <p>\u56fe 1\u20117 PCI\u4e8b\u52a1\u91cd\u8bd5\u673a\u5236</p> <p>\u8003\u8651\u63a5\u4e0b\u6765\u7ed9\u51fa\u7684\u4f8b\u5b50\uff1a\u5317\u6865\u53d1\u8d77\u4e00\u4e2a\u8bfbmemory\u4e8b\u52a1\uff0c\u5e0c\u671b\u4ece\u4ee5\u592a\u7f51\u8bbe\u5907\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u8fd9\u4e2a\u4ee5\u592a\u7f51\u8bbe\u5907Target\u54cd\u5e94\u8fd9\u4e2a\u4e8b\u52a1\uff0c\u8bf7\u6c42\u5e76\u53c2\u4e0e\u5230\u603b\u7ebf\u5468\u671f\u4e2d\u6765\u3002\u7136\u800c\uff0c\u8fd9\u4e2a\u4ee5\u592a\u7f51\u8bbe\u5907Target\u6b64\u523b\u5e76\u6ca1\u6709\u7acb\u5373\u5c06\u6570\u636e\u8fd4\u56de\u7ed9\u5317\u6865Master\u3002\u8fd9\u4e2a\u4ee5\u592a\u7f51\u8bbe\u5907\u6b64\u65f6\u6709\u4e24\u4e2a\u529e\u6cd5\u6765\u63a8\u8fdf\u8fd9\u6b21\u6570\u636e\u4f20\u8f93\u3002\u7b2c\u4e00\u4e2a\u529e\u6cd5\u5c31\u662f\u5728\u6570\u636e\u4f20\u8f93\u4e2d\u63d2\u5165\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002\u5982\u679c\u8fc7\u7a0b\u4e2d\u4ec5\u9700\u63d2\u5165\u5c11\u91cf\u7684\u7b49\u5f85\u6001\uff0c\u90a3\u4e48\u6570\u636e\u7684\u4f20\u8f93\u8fd8\u80fd\u7b97\u662f\u6bd4\u8f83\u6709\u6548\u7387\u3002\u4f46\u662f\u5982\u679cTarget\u8bbe\u5907\u9700\u8981\u5ef6\u8fdf\u66f4\u591a\u7684\u65f6\u95f4\uff08\u4ece\u4e8b\u52a1\u88ab\u53d1\u8d77\u540e\u5ef6\u8fdf16\u4e2a\u65f6\u949f\u5468\u671f\u4ee5\u4e0a\uff09\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7528\u7b2c\u4e8c\u79cd\u529e\u6cd5\u4e86\uff0c\u7b2c\u4e8c\u79cd\u529e\u6cd5\u5c31\u662fTarget\u53d1\u51fa\u4e00\u4e2aSTOP#\u4fe1\u53f7\u6765\u8868\u793a\u4e8b\u52a1\u91cd\u8bd5\uff08retry\uff09\u3002Retry\u64cd\u4f5c\u662f\u901a\u77e5Master\u5728\u6570\u636e\u6ca1\u6709\u4f20\u8f93\u524d\u5c31\u63d0\u524d\u7ed3\u675f\u603b\u7ebf\u5468\u671f\u3002\u8fd9\u6837\u505a\u53ef\u4ee5\u9632\u6b62\u603b\u7ebf\u957f\u65f6\u95f4\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u800c\u964d\u4f4e\u4e86\u603b\u7ebf\u6548\u7387\u3002\u5f53Master\u63a5\u6536\u5230Target\u53d1\u6765\u7684Retry\u8bf7\u6c42\uff0cMaster\u81f3\u5c11\u7b49\u5f852\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u7136\u540e\u5fc5\u987b\u91cd\u65b0\u5411\u603b\u7ebf\u53d1\u8d77\u4ef2\u88c1\u8bf7\u6c42\uff0c\u5f53\u518d\u6b21\u83b7\u5f97\u603b\u7ebf\u7684\u4f7f\u7528\u6743\u4e4b\u540e\u91cd\u65b0\u53d1\u8d77\u76f8\u540c\u7684\u603b\u7ebf\u5468\u671f\u3002\u5728\u5f53\u524d\u603b\u7ebfMaster\u6b63\u5728\u5904\u7406Retry\u7684\u8fd9\u6bb5\u65f6\u95f4\u4e2d\uff0c\u4ef2\u88c1\u5668\u53ef\u4ee5\u5c06\u603b\u7ebf\u4f7f\u7528\u6743\u6388\u4e88\u5176\u4ed6\u7684Master\uff0c\u4ee5\u4fbf\u4e8ePCI\u603b\u7ebf\u80fd\u88ab\u66f4\u6709\u6548\u7387\u7684\u5229\u7528\u8d77\u6765\u3002\u5f53\u6b64\u524d\u6267\u884cRetry\u7684Master\u518d\u6b21\u5360\u7528\u603b\u7ebf\u5e76\u91cd\u65b0\u542f\u52a8\u4e0e\u6b64\u524d\u76f8\u540c\u7684\u603b\u7ebf\u5468\u671f\u65f6\uff0cTarget\u53ef\u80fd\u4e5f\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\uff0c\u5e76\u53c2\u4e0e\u5230\u603b\u7ebf\u5468\u671f\u4e2d\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002\u82e5Target\u4ecd\u7136\u672a\u51c6\u5907\u597d\uff0c\u90a3\u4e48\u5b83\u5c06\u4f1a\u518d\u6b21\u53d1\u8d77Retry\uff0c\u6309\u7167\u8fd9\u6837\u7684\u6d41\u7a0b\u5faa\u73af\u4e0b\u53bb\u76f4\u5230Master\u6210\u529f\u5b8c\u6210\u4e86\u6570\u636e\u4f20\u8f93\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1432-pcipci-disconnect-protocol","title":"1.4.3.2   PCI\u65ad\u5f00\u8fde\u63a5\u534f\u8bae(PCI Disconnect Protocol)","text":"<p>\u5f53\u4e00\u4e2aPCI Master\u53d1\u8d77\u4e00\u4e2a\u4e8b\u52a1\u6765\u8bbf\u95ee\u4e00\u4e2aTarget\uff0c\u5e76\u4e14\u5982\u679c\u8fd9\u4e2aTarget\u53ef\u4ee5\u4f20\u8f93\u81f3\u5c11\u4e00\u4e2a\u53cc\u5b57\uff08doubleword\uff0c\u540e\u9762\u4f7f\u7528dw\u7b80\u5199\uff09\u7684\u6570\u636e\uff0c\u4f46\u662f\u5b83\u65e0\u6cd5\u5b8c\u6210\u6574\u4e2a\u5b8c\u6574\u7684\u5168\u6570\u636e\u91cf\u7684\u4f20\u8f93\uff0c\u90a3\u4e48\u5b83\u5c06\u4f1a\u5728\u5b83\u65e0\u6cd5\u7ee7\u7eed\u8fdb\u884c\u4f20\u8f93\u65f6\u65ad\u5f00\u4e0e\u4e8b\u52a1\u64cd\u4f5c\u7684\u8fde\u63a5\u3002\u8fd9\u79cd\u573a\u666f\u7684\u793a\u610f\u56fe\u5982\u56fe 1\u20118\u6240\u793a\u3002</p> <p>\u8003\u8651\u63a5\u4e0b\u6765\u7ed9\u51fa\u7684\u4f8b\u5b50\uff1a\u5317\u6865\u53d1\u8d77\u4e00\u4e2a\u7a81\u53d1\u8bfbmemory\u4e8b\u52a1\uff08burst memory read\uff09\uff0c\u5e0c\u671b\u4ece\u4ee5\u592a\u7f51\u8bbe\u5907\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u4ee5\u592a\u7f51Target\u8bbe\u5907\u54cd\u5e94\u4e86\u8bf7\u6c42\u5e76\u53c2\u4e0e\u5230\u8fd9\u4e2a\u603b\u7ebf\u5468\u671f\u4e2d\u6765\uff0c\u4f20\u8f93\u4e86\u90e8\u5206\u6570\u636e\uff0c\u4f46\u662f\u968f\u540e\u4e0d\u4e45\u628a\u5df2\u6709\u7684\u6240\u6709\u6570\u636e\u90fd\u53d1\u9001\u5149\u4e86\uff0c\u5374\u4f9d\u7136\u6ca1\u6709\u8fbe\u5230Master\u9700\u8981\u7684\u6570\u636e\u603b\u91cf\u3002\u4ee5\u592a\u7f51\u8bbe\u5907Target\u6b64\u65f6\u6709\u4e24\u4e2a\u9009\u62e9\u6765\u5ef6\u8fdf\u6570\u636e\u7684\u4f20\u8f93\u3002\u7b2c\u4e00\u4e2a\u9009\u62e9\u662f\u5728\u6570\u636e\u4f20\u8f93\u9636\u6bb5\u63d2\u5165\u7b49\u5f85\u6001\uff0c\u7136\u540e\u81ea\u8eab\u4e5f\u540c\u65f6\u5728\u7b49\u5f85\u6536\u5230\u65b0\u589e\u7684\u6570\u636e\u3002\u5982\u679c\u8fc7\u7a0b\u4e2d\u4ec5\u9700\u63d2\u5165\u5c11\u91cf\u7684\u7b49\u5f85\u6001\uff0c\u90a3\u4e48\u6570\u636e\u7684\u4f20\u8f93\u8fd8\u80fd\u7b97\u662f\u6bd4\u8f83\u6709\u6548\u7387\u3002\u4f46\u662f\u5982\u679cTarget\u8bbe\u5907\u9700\u8981\u5ef6\u8fdf\u66f4\u591a\u7684\u65f6\u95f4\uff08PCI\u534f\u8bae\u89c4\u8303\u4e2d\u5141\u8bb8\u5728\u6570\u636e\u4f20\u8f93\u4e2d\u9014\u6700\u591a\u67098\u4e2a\u65f6\u949f\u5468\u671f\u7684\u7b49\u5f85\u6001\uff0c\u8fd9\u91cc\u533a\u522b\u4e8e\u4e0a\u4e00\u8282Retry\u4e2d\u768416\u4e2a\u5468\u671f\uff0c\u90a3\u662f\u56e0\u4e3a\u90a3\u65f6\u4f20\u8f93\u8fd8\u6ca1\u5f00\u59cb\uff0c\u800c\u8fd98\u4e2a\u5468\u671f\u9488\u5bf9\u7684\u662f\u4f20\u8f93\u5df2\u7ecf\u5f00\u59cb\u4e86\u4e00\u6bb5\u65f6\u95f4\u7684\u4f20\u8f93\u4e2d\u9014\u7b49\u5f85\uff09\uff0cTarget\u5fc5\u987b\u53d1\u51fa\u65ad\u5f00\u8fde\u63a5\u7684\u4fe1\u53f7\u3002\u8981\u65ad\u5f00\u8fde\u63a5\uff0cTarget\u9700\u8981\u5728\u603b\u7ebf\u5468\u671f\u8fd0\u884c\u4e2d\u5c06STOP#\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u6837\u5c31\u80fd\u544a\u77e5Master\u63d0\u524d\u7ed3\u675f\u603b\u7ebf\u5468\u671f\u3002Disconnect\u4e0eRetry\u7684\u4e00\u4e2a\u533a\u522b\u5c31\u5728\u4e8e\uff0cDisconnect\u6709\u6570\u636e\u5df2\u7ecf\u88ab\u4f20\u8f93\uff0c\u800cRetry\u5219\u662f\u6570\u636e\u4f20\u8f93\u6839\u672c\u5c31\u6ca1\u5f00\u59cb\u3002Disconnect\u8fd9\u79cd\u64cd\u4f5c\u4e5f\u8ba9\u603b\u7ebf\u907f\u514d\u957f\u65f6\u95f4\u5904\u4e8e\u7b49\u5f85\u6001\u3002Master\u81f3\u5c11\u7b49\u5f852\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u7136\u540e\u624d\u80fd\u518d\u6b21\u5411\u603b\u7ebf\u53d1\u8d77\u4ef2\u88c1\u8bf7\u6c42\uff0c\u5f53\u518d\u6b21\u83b7\u5f97\u603b\u7ebf\u7684\u4f7f\u7528\u6743\u4e4b\u540e\u5c31\u53ef\u4ee5\u518d\u6b21\u8bbf\u95ee\u521a\u624d\u65ad\u5f00\u8fde\u63a5\u7684\u8bbe\u5907\u5730\u5740\uff0c\u7ee7\u7eed\u5b8c\u6210\u6b64\u524d\u65ad\u5f00\u672a\u5b8c\u6210\u7684\u603b\u7ebf\u5468\u671f\u3002\u5728\u5f53\u524d\u603b\u7ebfMaster\u6b63\u5728\u7ecf\u5386Disconnect\u7684\u8fd9\u6bb5\u65f6\u95f4\u4e2d\uff0c\u4ef2\u88c1\u5668\u53ef\u4ee5\u5c06\u603b\u7ebf\u4f7f\u7528\u6743\u6388\u4e88\u5176\u4ed6\u7684Master\uff0c\u4ee5\u4fbf\u4e8ePCI\u603b\u7ebf\u80fd\u88ab\u66f4\u6709\u6548\u7387\u7684\u5229\u7528\u8d77\u6765\u3002\u5f53\u6b64\u524d\u7ecf\u5386Disconnect\u7684Master\u518d\u6b21\u5360\u7528\u603b\u7ebf\u5e76\u51c6\u5907\u7ee7\u7eed\u6b64\u524d\u672a\u5b8c\u6210\u7684\u603b\u7ebf\u5468\u671f\u65f6\uff0cTarget\u53ef\u80fd\u4e5f\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u9700\u8981\u7ee7\u7eed\u4f20\u8f93\u7684\u6570\u636e\uff0c\u5e76\u53c2\u4e0e\u5230\u603b\u7ebf\u5468\u671f\u4e2d\u7ee7\u7eed\u5b8c\u6210\u6570\u636e\u4f20\u8f93\u3002\u5426\u5219\uff0c\u82e5Target\u4ecd\u7136\u672a\u51c6\u5907\u597d\uff0c\u90a3\u4e48\u5b83\u5c06\u4f1a\u518d\u6b21\u53d1\u8d77Retry\u6216\u8005Disconnect\uff0c\u7136\u540e\u6309\u7167\u8fd9\u6837\u7684\u6d41\u7a0b\u5faa\u73af\u4e0b\u53bb\u76f4\u5230Master\u6210\u529f\u5b8c\u6210\u4e86\u6240\u6709\u6570\u636e\u7684\u4f20\u8f93\u3002</p> <p></p> <p>\u56fe 1\u20118 PCI\u4e8b\u52a1\u65ad\u5f00\u8fde\u63a5\u673a\u5236</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#144-pcipci-interrupt-handling","title":"1.4.4     PCI\u4e2d\u65ad\u5904\u7406(PCI Interrupt Handling)","text":"<p>PCI\u8bbe\u5907\u4f7f\u75284\u4e2a\u8fb9\u5e26\u4fe1\u53f7\uff08sideband\uff09\u4f5c\u4e3a\u4e2d\u65ad\u4fe1\u53f7\uff0c\u5206\u522b\u4e3aINTA#\u3001INTB#\u3001INTC#\u3001INTD#\uff0c\u5e76\u4ece\u4e2d\u9009\u53d6\u4e00\u4e2a\u6765\u5411\u7cfb\u7edf\u53d1\u9001\u4e2d\u65ad\u8bf7\u6c42\uff0c\u5373\u4f7f\u75284\u4e2a\u4e2d\u65ad\u4fe1\u53f7\u4e2d\u76841\u4e2a\u6765\u53d1\u9001\u4e2d\u65ad\u8bf7\u6c42\u3002\u5f53\u5176\u4e2d\u4e00\u4e2a\u4e2d\u65ad\u5f15\u811a\u88ab\u7f6e\u4e3a\u6709\u6548\u65f6\uff0c\u5355CPU\u7cfb\u7edf\u7684\u4e2d\u65ad\u63a7\u5236\u5668\u5c06\u4f1a\u5bf9\u4e2d\u65ad\u4f5c\u51fa\u54cd\u5e94\uff0c\u76f8\u5e94\u7684\u65b9\u5f0f\u4e3a\u5c06INTR\uff08interrupt request\uff09\u4fe1\u53f7\u7f6e\u4e3a\u6709\u6548\uff0c\u5c06\u4e2d\u65ad\u8bf7\u6c42\u53d1\u9001\u7ed9CPU\u3002\u540e\u6765\u51fa\u73b0\u7684\u591aCPU\u7cfb\u7edf\u4e0d\u518d\u9002\u7528\u8fd9\u79cd\u5355\u4fe1\u53f7\u7ebf\u8f93\u5165\u4f5c\u4e3a\u4e2d\u65ad\u7684\u65b9\u5f0f\uff0c\u56e0\u6b64\u8fdb\u884c\u4e86\u6539\u8fdb\uff0c\u5c06\u4e2d\u65ad\u6539\u4e3a\u4e86APIC\uff08Advanced Programmable Interrupt Controller\uff09\u6a21\u578b\uff0c\u5728\u8fd9\u79cd\u6a21\u578b\u4e2d\u4e2d\u65ad\u63a7\u5236\u5668\u5c06\u4f1a\u5411\u591aCPU\u53d1\u9001\u62a5\u6587\uff08message\uff09\u800c\u4e0d\u662f\u5411\u5176\u4e2d\u4e00\u4e2aCPU\u53d1\u9001INTR\u4fe1\u53f7\u3002\u4e0d\u8fc7\u65e0\u8bba\u4e2d\u65ad\u4f20\u8f93\u6a21\u578b\u662f\u4ec0\u4e48\uff0c\u63a5\u6536\u5230\u4e2d\u65ad\u7684CPU\u90fd\u5fc5\u987b\u786e\u8ba4\u4e2d\u65ad\u6765\u6e90\uff0c\u7136\u540e\u4e3a\u4e2d\u65ad\u63d0\u4f9b\u670d\u52a1\u3002\u4f20\u7edf\u7684\u6a21\u578b\u9700\u8981\u597d\u51e0\u4e2a\u603b\u7ebf\u5468\u671f\u6765\u5b8c\u6210\u786e\u8ba4\u4e2d\u65ad\u548c\u670d\u52a1\u4e2d\u65ad\u7684\u64cd\u4f5c\uff0c\u6548\u7387\u4e0d\u662f\u5f88\u9ad8\u3002APIC\u6a21\u578b\u4f1a\u6bd4\u4f20\u7edf\u6a21\u578b\u597d\u4e00\u4e9b\u4f46\u662f\u4e5f\u4f9d\u7136\u5b58\u5728\u6539\u8fdb\u7684\u7a7a\u95f4\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#145-pcipci-error-handling","title":"1.4.5     PCI\u9519\u8bef\u5904\u7406(PCI Error Handling)","text":"<p>\u53ef\u9009\u5730\uff0cPCI\u8bbe\u5907\u53ef\u4ee5\u5728\u4e8b\u52a1\u8fdb\u884c\u671f\u95f4\uff0c\u68c0\u6d4b\u5e76\u62a5\u544a\u63a5\u6536\u5730\u5740\u6216\u8005\u6570\u636e\u4fe1\u53f7\u4e2d\u7684\u5947\u5076\u6821\u9a8c\u9519\u8bef\u3002\u5728\u4e8b\u52a1\u8fdb\u884c\u671f\u95f4\uff0cPCI\u5bf9\u603b\u7ebf\u4e0a\u5927\u90e8\u5206\u4fe1\u53f7\u8fdb\u884c\u5947\u5076\u6821\u9a8c\uff0c\u5e76\u901a\u8fc7PAR\u4fe1\u53f7\u8868\u793a\u8ba1\u7b97\u7684\u5076\u6821\u9a8c\u4f4d\u7ed3\u679c\u3002\u5982\u679c\u4f20\u8f93\u7684\u6570\u636e\u6216\u8005\u5730\u5740\u4fe1\u606f\u4e2d\u4e3a\u903b\u8f91\u7535\u5e731\u7684\u6bd4\u7279\u6570\u91cf\u662f\u5947\u6570\uff0c\u90a3\u4e48\u5c31\u5c06PAR\u4fe1\u53f7\u7f6e\u4e3a1\uff0c\u4ee5\u6b64\u6765\u4f7f\u5f97\u201c\u7535\u5e731\u201d\u7684\u6bd4\u7279\u6570\u91cf\u4e3a\u5076\u6570\u4e2a\u3002Target\u8bbe\u5907\u5728\u63a5\u6536\u5230\u6570\u636e\u6216\u5730\u5740\u65f6\u5c06\u4f1a\u8fdb\u884c\u6821\u9a8c\u68c0\u67e5\u9519\u8bef\u3002\u5947\u5076\u6821\u9a8c\uff08\u5728\u8fd9\u91cc\u4e3a\u5076\u6821\u9a8c\uff09\u7684\u65b9\u6cd5\u4ec5\u5728\u6709\u5947\u6570\u4e2a\u4fe1\u53f7\u51fa\u9519\u65f6\u624d\u80fd\u68c0\u6d4b\u5230\u3002\u5982\u679c\u8bbe\u5907\u68c0\u6d4b\u5230\u6570\u636e\u7684\u5947\u5076\u6821\u9a8c\u9519\u8bef\uff0c\u5b83\u5c06\u628aPERR#\uff08parity error\uff09\u7f6e\u4e3a\u6709\u6548\u3002\u8fd9\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u53ef\u4ee5\u6062\u590d\u7684\u9519\u8bef\uff0c\u56e0\u4e3a\u4f8b\u5982\u5bf9\u4e8ememory\u8bfb\u53d6\u6765\u8bf4\uff0c\u53ea\u9700\u8981\u518d\u6b21\u53d1\u8d77\u76f8\u540c\u7684\u4e8b\u52a1\u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\u7136\u800c\uff0cPCI\u81ea\u8eab\u5e76\u4e0d\u5305\u542b\u4efb\u4f55\u7684\u81ea\u52a8\u7684\u6216\u662f\u57fa\u4e8e\u786c\u4ef6\u7684\u9519\u8bef\u6062\u590d\u673a\u5236\uff0c\u56e0\u6b64\u8f6f\u4ef6\u5c06\u5b8c\u5168\u8d1f\u8d23\u53bb\u8fdb\u884c\u9519\u8bef\u5904\u7406\u3002</p> <p></p> <p>\u56fe 1\u20119 PCI\u9519\u8bef\u5904\u7406</p> <p>\u7136\u800c\uff0c\u4e0a\u9762\u6240\u8bf4\u7684\u662f\u6570\u636e\u51fa\u9519\u7684\u60c5\u51b5\uff0c\u82e5\u5730\u5740\u6821\u9a8c\u51fa\u9519\u5219\u60c5\u51b5\u4e0d\u540c\u3002\u5728\u56fe 1\u20119\u7684\u4f8b\u5b50\u4e2d\uff0c\u5730\u5740\u4fe1\u606f\u635f\u574f\uff0c\u8fd9\u5bfc\u81f4\u4e00\u4e2aTarget\u5339\u914d\u4e0a\u4e86\u8fd9\u4e2a\u9519\u8bef\u7684\u5730\u5740\u3002\u6211\u4eec\u65e0\u6cd5\u5f97\u77e5\u635f\u574f\u7684\u5730\u5740\u4fe1\u606f\u53d8\u6210\u4e86\u4ec0\u4e48\uff0c\u4e5f\u65e0\u6cd5\u5f97\u77e5\u603b\u7ebf\u4e0a\u54ea\u4e2a\u8bbe\u5907\u5339\u914d\u4e0a\u4e86\u8fd9\u4e2a\u9519\u8bef\u7684\u5730\u5740\uff0c\u6240\u4ee5\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\u5c31\u4e0d\u5b58\u5728\u80fd\u591f\u7b80\u5355\u8fdb\u884c\u9519\u8bef\u6062\u590d\u7684\u65b9\u6cd5\u3002\u56e0\u6b64\uff0c\u8fd9\u79cd\u7c7b\u578b\u7684\u9519\u8bef\u5c06\u4f1a\u5bfc\u81f4SERR#\uff08system error\uff09\u88ab\u7f6e\u4e3a\u6709\u6548\uff0c\u4e4b\u540e\u7cfb\u7edf\u901a\u5e38\u4f1a\u8c03\u7528\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u3002\u5728\u8001\u5f0f\u673a\u5668\u4e2d\uff0c\u4e3a\u4e86\u9884\u9632\u5f15\u8d77\u66f4\u8fdb\u4e00\u6b65\u7684\u9519\u8bef\uff0c\u5c06\u4f1a\u5f3a\u884c\u8ba9\u7cfb\u7edf\u505c\u6b62\u5de5\u4f5c\uff0c\u4ece\u800c\u5bfc\u81f4\u51fa\u73b0\u201c\u84dd\u5c4f\u6b7b\u673a\u201d\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#146-pcipci-address-map","title":"1.4.6     PCI\u5730\u5740\u7a7a\u95f4\u6620\u5c04(PCI Address Map)","text":"<p>PCI\u4f53\u7cfb\u7ed3\u6784\u652f\u63013\u79cd\u5730\u5740\u7a7a\u95f4\uff0c\u5982\u56fe 1\u201110\u6240\u793a\uff0c\u5305\u542b\uff1aMemory\uff08\u5185\u5b58\uff09\u3001I/O\u3001Configuration Address Space\uff08\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\uff09\u3002x86\u5904\u7406\u5668\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95eeMemory\u548cI/O\u7a7a\u95f4\u3002\u4e00\u4e2aPCI\u8bbe\u5907\u6620\u5c04\u5230\u5904\u7406\u5668\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u53ef\u4ee5\u652f\u630132\u621664\u4f4d\u5bfb\u5740\u3002\u5728I/O\u5730\u5740\u7a7a\u95f4\uff0cPCI\u8bbe\u5907\u53ef\u4ee5\u652f\u630132\u4f4d\u5bfb\u5740\uff0c\u4f46\u662f\u56e0\u4e3ax86 CPU\u4ec5\u4f7f\u752816\u4f4d\u7684I/O\u5730\u5740\u7a7a\u95f4\uff0c\u6240\u4ee5\u8bb8\u591a\u5e73\u53f0\u90fd\u4f1a\u5c06I/O\u7a7a\u95f4\u9650\u5236\u572864KB\uff08\u5bf9\u5e9416bit\uff09\u3002</p> <p></p> <p>\u56fe 1\u201110\u5730\u5740\u7a7a\u95f4\u6620\u5c04</p> <p>PCI\u8fd8\u5f15\u8fdb\u4e86\u7b2c\u4e09\u79cd\u5730\u5740\u7a7a\u95f4\uff0c\u79f0\u4e3a\u914d\u7f6e\u7a7a\u95f4\uff0cCPU\u53ea\u80fd\u5bf9\u5b83\u8fdb\u884c\u95f4\u63a5\u8bbf\u95ee\u800c\u975e\u76f4\u63a5\u8bbf\u95ee\u3002PCI\u8bbe\u5907\u4e2d\u7684\u6bcf\u4e2aFunction\uff08\u529f\u80fd\uff09\u90fd\u5305\u542b\u4e13\u4e3a\u914d\u7f6e\u7a7a\u95f4\u6240\u51c6\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668\uff0c\u8fd9\u4e9b\u5bc4\u5b58\u5668\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u662f\u53ef\u89c1\u7684\uff0c\u5e76\u4e14\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u6807\u51c6\u5316\u7684\u65b9\u5f0f\u6765\u63a7\u5236\u5b83\u4eec\u7684\u5730\u5740\u4e0e\u8d44\u6e90\uff0c\u8fd9\u4e3aPC\u63d0\u4f9b\u4e86\u4e00\u4e2a\u771f\u6b63\u7684\u5373\u63d2\u5373\u7528\uff08plug and play\uff09\u7684\u73af\u5883\u3002\u6bcf\u4e2aPCI Function\u6700\u591a\u53ef\u4ee5\u6709256 Bytes\u7684\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u3002\u8003\u8651\u5230PCI\u6700\u591a\u53ef\u652f\u6301\u5355\u4e2a\u8bbe\u5907\u542b\u67098\u4e2aFunction\u3001\u6bcf\u8def\u603b\u7ebf\u542b\u670932\u4e2a\u8bbe\u5907\u3001\u5355\u4e2a\u7cfb\u7edf\u5305\u542b256\u8def\u603b\u7ebf\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7cfb\u7edf\u7684\u914d\u7f6e\u7a7a\u95f4\u603b\u91cf\u4e3a\uff1a</p> <p>256B/Function *8Function/device * 32devices/bus *256buses/system =16MB\uff0c</p> <p>\u5373\u4e00\u4e2a\u7cfb\u7edf\u7684\u914d\u7f6e\u7a7a\u95f4\u603b\u5927\u5c0f\u4e3a16MB\u3002</p> <p>\u56e0\u4e3ax86 CPU\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\uff0c\u6240\u4ee5\u5b83\u5fc5\u987b\u901a\u8fc7IO\u5bc4\u5b58\u5668\u8fdb\u884c\u7d22\u5f15\uff08\u7136\u800c\u5728PCI Express\u4e2d\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u65b9\u6cd5\u6765\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\uff0c\u8fd9\u79cd\u65b0\u65b9\u6cd5\u662f\u901a\u8fc7\u5c06\u914d\u7f6e\u7a7a\u95f4\u6620\u5c04\u5165\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u6765\u5b8c\u6210\u7684\uff09\u3002\u5728\u4f20\u7edf\u6a21\u578b\u4e2d\uff0c\u5982\u56fe 1\u201110\u6240\u793a\uff0c\u4f7f\u7528\u4e86\u4e00\u79cd\u88ab\u79f0\u4e3a\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09\u7684IO\u7aef\u53e3\uff0c\u5b83\u4f4d\u4e8e\u5730\u5740CF8h-CFBh\uff1b\u8fd8\u4f7f\u7528\u4e86\u4e00\u79cd\u88ab\u79f0\u4e3a\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08Configuration Data Port\uff09\u7684IO\u7aef\u53e3\uff0c\u5b83\u4f4d\u4e8e\u5730\u5740CFCh-CFFh\u3002\u5173\u4e8e\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u4ee5\u53ca\u901a\u8fc7\u5185\u5b58\u6620\u5c04\u65b9\u6cd5\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u7684\u7ec6\u8282\u5c06\u4f1a\u5728\u4e0b\u4e00\u8282\u8fdb\u884c\u89e3\u91ca\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#147-pcipci-configuration-cycle-generation","title":"1.4.7     PCI\u914d\u7f6e\u5468\u671f\u7684\u751f\u6210(PCI Configuration Cycle Generation)","text":"<p>\u7531\u4e8eIO\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u662f\u6709\u9650\u7684\uff0c\u4f20\u7edf\u6a21\u578b\u7684\u8bbe\u8ba1\u4e0a\u5bf9\u5730\u5740\u5341\u5206\u4fdd\u5b88\u3002\u5728IO\u7a7a\u95f4\u4e2d\u5e38\u89c1\u7684\u505a\u6cd5\u662f\u4ee4\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u6307\u5411\u4e00\u4e2a\u5185\u90e8\u4f4d\u7f6e\uff0c\u7136\u540e\u7528\u53e6\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u8fdb\u884c\u6570\u636e\u7684\u8bfb\u53d6\u6216\u5199\u5165\u3002PCI\u7684\u914d\u7f6e\u8fc7\u7a0b\u5305\u542b\u5982\u4e0b\u4e24\u6b65\u3002</p> <p>l \u7b2c\u4e00\u6b65\uff1aCPU\u4ea7\u751f\u4e00\u4e2aIO\u5199\uff0c\u5199\u5165\u7684\u4f4d\u7f6e\u4e3a\u5317\u6865\u4e2dIO\u5730\u5740\u4e3aCF8h\u7684\u5730\u5740\u7aef\u53e3\uff08Address Port\uff09\uff0c\u8fd9\u6837\u5c31\u7ed9\u51fa\u4e86\u9700\u8981\u88ab\u914d\u7f6e\u7684\u5bc4\u5b58\u5668\u7684\u5730\u5740\uff0c\u5373\u201c\u7528\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u6307\u5411\u4e00\u4e2a\u5185\u90e8\u4f4d\u7f6e\u201d\u3002\u5982\u56fe 1\u201111\u6240\u793a\uff0c\u8fd9\u4e2a\u5730\u5740\u4e3b\u8981\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff0c\u901a\u8fc7\u8fd9\u4e09\u90e8\u5206\u5c31\u53ef\u4ee5\u5b9a\u4f4d\u4e00\u4e2aPCI Function\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u7684\u4f4d\u7f6e\uff0c\u5b83\u4eec\u4e3a\uff1a\u5728256\u6761\u603b\u7ebf\u4e2d\u6211\u4eec\u60f3\u8bbf\u95ee\u54ea\u4e00\u6761\u603b\u7ebf\u3001\u5728\u8be5\u603b\u7ebf\u4e0a\u768432\u4e2a\u8bbe\u5907\u4e2d\u8bbf\u95ee\u54ea\u4e00\u4e2a\u3001\u5728\u8be5\u8bbe\u5907\u76848\u4e2aFunction\u4e2d\u8bbf\u95ee\u54ea\u4e00\u4e2a\u3002\u9664\u4e86\u8fd9\u4e9b\u4ee5\u5916\uff0c\u552f\u4e00\u8fd8\u9700\u8981\u63d0\u4f9b\u7684\u4fe1\u606f\u662f\u8981\u786e\u8ba4\u8bbf\u95ee\u8fd9\u4e2aFunction\u768464dw\uff08256Bytes\uff09\u4e2d\u7684\u54ea\u4e2adw\u3002</p> <p>l \u7b2c\u4e8c\u6b65\uff1aCPU\u4ea7\u751f\u4e00\u4e2aIO\u8bfb\u6216\u8005IO\u5199\uff0c\u64cd\u4f5c\u7684\u4f4d\u7f6e\u4e3a\u5317\u6865\u4e2d\u7684\u5730\u5740\u4e3aCFCh\u7684\u6570\u636e\u7aef\u53e3\uff08Data Port\uff09\uff0c\u5373\u201c\u7528\u53e6\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u8fdb\u884c\u6570\u636e\u7684\u8bfb\u53d6\u6216\u5199\u5165\u201d\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u5317\u6865\u5411PCI\u603b\u7ebf\u53d1\u8d77\u4e00\u4e2a\u914d\u7f6e\u8bfb\u4e8b\u52a1\uff08configuration read\uff09\u6216\u914d\u7f6e\u5199\u4e8b\u52a1\uff08configuration write\uff09\uff0c\u4e8b\u52a1\u8981\u64cd\u4f5c\u7684\u5730\u5740\u5373\u4e3a\u6b65\u9aa4\u4e00\u4e2d\u5730\u5740\u7aef\u53e3\u4e2d\u6240\u6307\u5b9a\u7684\u5730\u5740\u3002</p> <p></p> <p>\u56fe 1\u201111\u914d\u7f6e\u5730\u5740\u5bc4\u5b58\u5668</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#148-pci-functionpci-function-cfg-reg-space","title":"1.4.8     PCI Function\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4(PCI Function Cfg Reg Space)","text":"<p>\u6bcf\u4e2aPCI Function\u53ef\u4ee5\u5305\u542b\u6700\u591a256Bytes\u7684\u914d\u7f6e\u7a7a\u95f4\u3002\u8fd9\u4e2a\u914d\u7f6e\u7a7a\u95f4\u8d77\u59cb\u768464Bytes\u5305\u542b\u4e00\u4e2a\u88ab\u79f0\u4e3aHeader\uff08\u914d\u7f6e\u7a7a\u95f4\u5934\uff09\u7684\u7ed3\u6784\uff0c\u5269\u4f59\u7684192Bytes\u7528\u6765\u652f\u6301\u4e00\u4e9b\u5176\u4ed6\u53ef\u9009\u529f\u80fd\u3002\u7cfb\u7edf\u914d\u7f6e\u9996\u5148\u7531Boot ROM\u56fa\u4ef6\u6765\u6267\u884c\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u88ab\u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u5b83\u5c06\u91cd\u65b0\u5bf9\u7cfb\u7edf\u8fdb\u884c\u914d\u7f6e\uff0c\u91cd\u65b0\u8fdb\u884c\u8d44\u6e90\u5206\u914d\u3002\u8fd9\u4e5f\u5c31\u662f\u8bf4\u7cfb\u7edf\u914d\u7f6e\u7684\u8fc7\u7a0b\u53ef\u80fd\u4f1a\u88ab\u6267\u884c\u4e24\u6b21\u3002</p> <p>\u6839\u636eHeader\u7684\u7c7b\u578b\uff0cPCI Function\u88ab\u5206\u4e3a\u4e24\u4e2a\u57fa\u672c\u7684\u7c7b\u522b\u3002\u7b2c\u4e00\u79cdHeader\u79f0\u4e3aType 1 Header\uff08\u7c7b\u578b1\uff09\uff0c\u5b83\u7684\u7ed3\u6784\u5982\u56fe 1\u201112\uff0c\u5b83\u7528\u4e8e\u6807\u8bc6\u8fd9\u4e2aFunction\u662f\u4e00\u4e2aBridge\uff0cBridge\u5c06\u4f1a\u5728\u62d3\u6251\u7ed3\u6784\u4e0a\u521b\u5efa\u53e6\u4e00\u6761\u603b\u7ebf\u3002\u800cType 0 Header\uff08\u7c7b\u578b0\uff09\u5c31\u662f\u7528\u6765\u6307\u793a\u8fd9\u4e2aFunction**\u4e0d\u662f**\u4e00\u4e2aBridge\uff08\u5982\u56fe 1\u201113\uff09\u3002\u5173\u4e8eHeader\u7c7b\u578b\u7684\u4fe1\u606f\u5305\u542b\u5728dword3\u7684\u5b57\u82822\u7684\u540c\u540d\u5b57\u6bb5\u4e2d\uff08Class Code\u5b57\u6bb5\uff09\uff0c\u5f53\u8f6f\u4ef6\u5728\u7cfb\u7edf\u4e2d\u53d1\u73b0\u67d0\u4e2aFunction\u65f6\uff0c\u7b2c\u4e00\u4ef6\u4e8b\u5c31\u662f\u8981\u68c0\u67e5\u5176Header\u7684\u8fd9\u4e2a\u5b57\u6bb5\uff08\u8f6f\u4ef6\u53d1\u73b0\u7cfb\u7edf\u4e2dFunction\u7684\u8fc7\u7a0b\u79f0\u4e3a\u679a\u4e3eenumeration\uff09\u3002</p> <p>\u5173\u4e8e\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4\u4ee5\u53ca\u679a\u4e3e\u8fc7\u7a0b\u7684\u66f4\u4e3a\u8be6\u7ec6\u7684\u8bb2\u89e3\u5c06\u4f1a\u7a0d\u540e\u518d\u8fdb\u884c\u3002\u5728\u8fd9\u91cc\u6211\u4eec\u53ea\u662f\u5e0c\u671b\u4f60\u5148\u719f\u6089\u4e00\u4e0b\u5404\u4e2a\u90e8\u5206\u662f\u5982\u4f55\u76f8\u4e92\u914d\u5408\u5de5\u4f5c\u7684\u3002</p> <p></p> <p>\u56fe 1\u201112 PCI\u914d\u7f6eHeader Type 1\uff08Bridge\uff09</p> <p></p> <p>\u56fe 1\u201113 PCI\u914d\u7f6eHeader Type 0\uff08\u975eBridge\uff09</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#149-pcihigher-bandwidth-pci","title":"1.4.9     \u66f4\u9ad8\u5e26\u5bbd\u7684PCI(Higher-bandwidth PCI)","text":"<p>\u4e3a\u4e86\u652f\u6301\u66f4\u9ad8\u7684\u5e26\u5bbd\uff0cPCI\u534f\u8bae\u89c4\u8303\u66f4\u65b0\u6210\u4e86\u652f\u6301\u4f4d\u5bbd\u66f4\u5bbd\uff0864bit\uff09\uff0c\u65f6\u949f\u901f\u7387\u66f4\u5feb\uff0866MHz\uff09\u7684\u7248\u672c\uff0c\u4f7f\u5176\u53ef\u4ee5\u8fbe\u5230533MB/s\u7684\u901f\u7387\u3002\u56fe 1\u201114\u5c55\u793a\u4e86\u4e00\u4e2a\u4f7f\u752866MHz 64bit PCI\u603b\u7ebf\u7684\u7cfb\u7edf\u3002</p> <p></p> <p>\u56fe 1\u201114 \u57fa\u4e8e66MHz PCI\u603b\u7ebf\u7684\u5e73\u53f0</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1491-66mhz-pci","title":"1.4.9.1   66MHz PCI\u603b\u7ebf\u7684\u9650\u5236","text":"<p>66MHz\u603b\u7ebf\u7684\u541e\u5410\u91cf\u76f8\u8f83\u4e8e33MHz\u5df2\u7ecf\u7ffb\u500d\uff0c\u4f46\u662f\u5176\u5b58\u5728\u4e00\u5b9a\u7684\u95ee\u9898\uff0c\u56fe 1\u201114\u663e\u793a\u4e86\u5b83\u7684\u4e00\u4e2a\u4e3b\u8981\u7f3a\u70b9\uff1a66MHz\u603b\u7ebf\u4e0e33MHz\u603b\u7ebf\u4f7f\u7528\u76f8\u540c\u7684\u53cd\u5c04\u6ce2\u5f00\u5173\u6a21\u578b\uff0c\u4f7f\u5f97\u7559\u7ed9\u5728\u4f20\u8f93\u7ebf\u4e0a\u4fe1\u53f7\u4f20\u8f93\u7684\u65f6\u95f4\u51cf\u534a\uff0c\u8fd9\u5c06\u4f1a\u5927\u5927\u7684\u964d\u4f4e\u603b\u7ebf\u7684\u8d1f\u8f7d\u80fd\u529b\u3002\u6700\u7ec8\u9020\u6210\u7684\u7ed3\u679c\u662f\uff0c\u4e00\u6761\u603b\u7ebf\u4e0a\u53ea\u80fd\u6709\u4e00\u4e2a\u63d2\u5165\u677f\u5361\u3002\u589e\u52a0\u66f4\u591a\u7684\u8bbe\u5907\u610f\u5473\u7740\u9700\u8981\u589e\u52a0\u66f4\u591a\u7684PCI Bridge\u6765\u4ea7\u751f\u66f4\u591a\u7684\u603b\u7ebf\uff0c\u8fd9\u5c06\u4f1a\u589e\u52a0\u6210\u672c\u4ee5\u53ca\u5bf9PCB\u677f\u6750\u7684\u8981\u6c42\u3002\u540c\u65f6\uff0c64bit PCI\u603b\u7ebf\u76f8\u8f83\u4e8e32bit\u589e\u52a0\u4e86\u5f15\u811a\u6570\uff0c\u8fd9\u4e5f\u4f1a\u589e\u52a0\u7cfb\u7edf\u6210\u672c\u4e14\u964d\u4f4e\u53ef\u9760\u6027\u3002\u5c06\u4e0a\u8ff0\u7ed3\u5408\u8d77\u6765\uff0c\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u770b\u51fa\u6765\u4e3a\u4ec0\u4e48\u8fd9\u4e9b\u56e0\u7d20\u9650\u5236\u4e8664bit\u6216\u800566MHz\u7248\u672c\u7684PCI\u603b\u7ebf\u7684\u5e7f\u6cdb\u4f7f\u7528\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1492-pci66mhz","title":"1.4.9.2   \u5e76\u884cPCI\u603b\u7ebf\u6a21\u578b\u572866MHz\u4ee5\u4e0a\u65f6\u51fa\u73b0\u7684\u4fe1\u53f7\u65f6\u5e8f\u95ee\u9898","text":"<p>\u9274\u4e8ePCI\u603b\u7ebf\u4e0a\u7684\u5b9e\u9645\u8d1f\u8f7d\u4ee5\u53ca\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\uff08signal flight times\uff09\uff0cPCI\u603b\u7ebf\u7684\u65f6\u949f\u9891\u7387\u65e0\u6cd5\u572866MHz\u4e0a\u7ee7\u7eed\u589e\u52a0\u4e86\u3002\u5bf9\u4e8e66MHz\u65f6\u949f\u6765\u8bf4\uff0c\u5176\u65f6\u949f\u5468\u671f\u4e3a15ns\u3002\u5206\u914d\u7ed9\u63a5\u6536\u5668\u7684\u5efa\u7acb\u65f6\u95f4(Setup time)\u4e3a3ns\u3002\u56e0\u4e3aPCI\u4f7f\u7528\u201c\u975e\u5bc4\u5b58\u8f93\u5165\uff08non-registered input\uff09\u201d\u4fe1\u53f7\u6a21\u578b\uff0c\u60f3\u8981\u5c06\u51763ns\u7684\u5efa\u7acb\u65f6\u95f4\u7ee7\u7eed\u51cf\u5c0f\u662f\u4e0d\u73b0\u5b9e\u7684\u3002\u5269\u4f59\u768412ns\u7684\u65f6\u5e8f\u9884\u7b97\uff08timing budget\uff09\u5206\u914d\u7ed9\u4e86\u53d1\u9001\u5668\u7684\u8f93\u51fa\u5ef6\u8fdf\u4ee5\u53ca\u4fe1\u53f7\u4f20\u8f93\u65f6\u95f4\u3002\u5982\u679c\u572866MHz\u7684\u57fa\u7840\u4e0a\u8fdb\u4e00\u6b65\u63d0\u9ad8\u9891\u7387\uff0c\u90a3\u4e48\u603b\u7ebf\u4e0a\u4f20\u8f93\u7684\u4fe1\u53f7\u5c06\u4f1a\u56e0\u4e3a\u65e0\u6cd5\u53ca\u65f6\u5230\u8fbe\u63a5\u6536\u7aef\uff0c\u65e0\u6cd5\u5728\u63a5\u6536\u7aef\u88ab\u6b63\u786e\u91c7\u6837\uff0c\u4ece\u800c\u5bfc\u81f4\u4f20\u8f93\u5931\u8d25\u3002</p> <p>\u5728\u4e0b\u4e00\u8282\u5c06\u4f1a\u4ecb\u7ecdPCI-X\u603b\u7ebf\uff0c\u5b83\u5c06\u6240\u6709\u7684\u8f93\u5165\u4fe1\u53f7\u90fd\u5148\u7528\u89e6\u53d1\u5668\u6765\u5bc4\u5b58\u4e00\u4e0b\uff0c\u7136\u540e\u518d\u53bb\u4f7f\u7528\u3002\u8fd9\u6837\u505a\u53ef\u4ee5\u5c06\u4fe1\u53f7\u7684\u5efa\u7acb\u65f6\u95f4\u964d\u4f4e\u52301ns\u4ee5\u4e0b\u3002\u5728\u5efa\u7acb\u65f6\u95f4\u4e0a\u7684\u4f18\u5316\u4f7f\u5f97PCI-X\u603b\u7ebf\u53ef\u4ee5\u8dd1\u5230\u4e00\u4e2a\u66f4\u9ad8\u7684\u9891\u7387\uff0c\u4f8b\u5982100MHz\u751a\u81f3133MHz\u3002\u4e0b\u4e00\u8282\u4e2d\u6211\u4eec\u5c06\u4f1a\u5bf9PCI-X\u603b\u7ebf\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u7b80\u660e\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#15-pci-x","title":"1.5 PCI-X\u7b80\u4ecb","text":"<p>PCI-X\u5bf9PCI\u7684\u8f6f\u4ef6\u548c\u786c\u4ef6\u90fd\u80fd\u505a\u5230\u5411\u540e\u517c\u5bb9\uff0c\u540c\u65f6PCI-X\u8fd8\u80fd\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd\u548c\u66f4\u9ad8\u7684\u6548\u7387\u3002\u5b83\u548cPCI\u6240\u4f7f\u7528\u7684\u8fde\u63a5\u5668\u4e5f\u662f\u76f8\u540c\u7684\uff0c\u56e0\u6b64PCI-X\u4e0ePCI\u7684\u8bbe\u5907\u53ef\u4ee5\u63d2\u5165\u76f8\u4e92\u7684\u63d2\u69fd\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5b83\u4eec\u4e8c\u8005\u8fd8\u4f7f\u7528\u76f8\u540c\u7684\u914d\u7f6e\u6a21\u578b\uff0c\u56e0\u6b64\u5728PCI\u7cfb\u7edf\u4e2d\u80fd\u4f7f\u7528\u7684\u8bbe\u5907\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ee5\u53ca\u5e94\u7528\uff0c\u5728PCI-X\u7cfb\u7edf\u4e2d\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u3002</p> <p>\u4e3a\u4e86\u5728\u4e0d\u6539\u53d8PCI\u4fe1\u53f7\u4f20\u8f93\u6a21\u578b\u7684\u57fa\u7840\u4e0a\u8fbe\u5230\u66f4\u9ad8\u7684\u901f\u7387\uff0cPCI-X\u4f7f\u7528\u4e86\u51e0\u4e2a\u6280\u5de7\u6765\u6539\u5584\u603b\u7ebf\u65f6\u5e8f\u3002\u9996\u5148\uff0c\u4ed6\u4eec\u5b9e\u73b0\u4e86PLL\uff08\u9501\u76f8\u73af\uff09\u65f6\u949f\u53d1\u751f\u5668\uff0c\u5229\u7528\u5b83\u5728\u5185\u90e8\u63d0\u4f9b\u76f8\u79fb\u65f6\u949f\u3002\u8fd9\u4f7f\u5f97\u8f93\u51fa\u4fe1\u53f7\u5728\u76f8\u4f4d\u4e0a\u524d\u79fb\uff0c\u800c\u8f93\u5165\u518d\u5728\u76f8\u4f4d\u4e0a\u5ef6\u540e\u4e00\u70b9\u8fdb\u884c\u91c7\u6837\uff0c\u4ece\u800c\u6539\u5584\u603b\u7ebf\u4e0a\u7684\u65f6\u5e8f\u3002\u540c\u65f6\uff0cPCI-X\u7684\u8f93\u5165\u4fe1\u53f7\u90fd\u5728Target\u8bbe\u5907\u7684\u8f93\u5165\u5f15\u811a\u88ab\u5bc4\u5b58\uff08\u9501\u5b58\uff09\uff0c\u8fd9\u6837\u5c31\u4f7f\u5f97\u5efa\u7acb\u65f6\u95f4\u66f4\u5c0f\u3002\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u8282\u7701\u51fa\u6765\u7684\u65f6\u95f4\u53ef\u4ee5\u6709\u6548\u589e\u52a0\u4fe1\u53f7\u5728\u603b\u7ebf\u4e0a\u4f20\u8f93\u7684\u53ef\u7528\u65f6\u95f4\uff0c\u5e76\u4f7f\u5f97\u603b\u7ebf\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63d0\u9ad8\u65f6\u949f\u9891\u7387\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#151-pci-xpci-x-system-example","title":"1.5.1     PCI-X\u7cfb\u7edf\u793a\u4f8b(PCI-X System Example)","text":"<p>\u5982\u56fe 1\u201115\u6240\u793a\uff0c\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8eIntel 7500\u670d\u52a1\u5668\u82af\u7247\u7ec4\u7684\u7cfb\u7edf\u5e73\u53f0\u3002</p> <p></p> <p>\u56fe 1\u201115\u57fa\u4e8e66MHz/33MHz PCI-X\u603b\u7ebf\u7684\u5e73\u53f0</p> <p>MCH\uff08Memory Controller Hub\uff09\u82af\u7247\u63d0\u4f9b\u4e863\u4e2a\u989d\u5916\u7684\u9ad8\u6027\u80fd\u7684Hub-Link 2.0\u7aef\u53e3\uff0c\u5b83\u4eec\u5404\u4e0e\u4e00\u4e2aPCI-X 2 Bridge\uff08P64H2\uff09\u76f8\u8fde\u63a5\u3002\u6bcf\u4e2aBridge\u652f\u6301\u4e24\u6761PCI-X\u603b\u7ebf\uff0c\u603b\u7ebf\u6700\u9ad8\u65f6\u949f\u9891\u7387\u53ef\u4ee5\u8fbe\u5230133MHz\u3002Hub Link 2.0\u53ef\u4ee5\u652f\u6491PCI-X\u66f4\u9ad8\u5e26\u5bbd\u7684\u6570\u636e\u6d41\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728PCI-X\u4e0a\u6211\u4eec\u4f9d\u7136\u5b58\u5728\u4e0e\u5f53\u521d\u6539\u8fdb66MHz PCI\u65f6\u9047\u5230\u7684\u4e00\u6837\u7684\u8d1f\u8f7d\u65b9\u9762\u7684\u95ee\u9898\uff0c\u8fd9\u4f7f\u5f97\u5982\u679c\u6211\u4eec\u8981\u652f\u6301\u66f4\u591a\u7684\u8bbe\u5907\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528Bridge\u6765\u751f\u6210\u66f4\u591a\u7684\u603b\u7ebf\uff0c\u5e76\u4e14\u8fd9\u5c06\u4f1a\u662f\u4e00\u4e2a\u76f8\u5bf9\u6210\u672c\u6602\u8d35\u7684\u89e3\u51b3\u65b9\u6848\u3002\u4e0d\u8fc7\uff0c\u73b0\u5728\u7684\u5e26\u5bbd\u786e\u5b9e\u63d0\u9ad8\u4e86\u4e0d\u5c11\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#152-pci-xpci-x-transactions","title":"1.5.2     PCI-X\u4e8b\u52a1(PCI-X Transactions)","text":"<p>\u5982\u56fe 1\u201116\u6240\u793a\uff0c\u8fd9\u662f\u4e00\u4e2aPCI-X\u603b\u7ebf\u4e0aMemory\u7a81\u53d1\u8bfb\u53d6\uff08burst memory read\uff09\u4e8b\u52a1\u3002</p> <p></p> <p>\u56fe 1\u201116 PCI-X Memory\u7a81\u53d1\u8bfb\u53d6\u7684\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\u793a\u4f8b</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cPCI-X\u5e76\u4e0d\u5141\u8bb8\u5728\u7b2c\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff08first data phase\uff09\u540e\u63d2\u5165\u7b49\u5f85\u6001\u3002\u4e4b\u6240\u4ee5\u8fd9\u6837\u505a\u662f\u56e0\u4e3aPCI-X\u4e2d\u4f1a\u5728\u4e8b\u52a1\u7684\u5c5e\u6027\u9636\u6bb5\uff08Attribute Phase\uff09\uff0c\u5c06\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\u603b\u91cf\u544a\u8bc9Target\u8bbe\u5907\u3002\u56e0\u6b64\u4e0ePCI\u4e0d\u540c\uff0cTarget\u662f\u77e5\u9053\u81ea\u5df1\u9700\u8981\u4f20\u8f93\u591a\u5c11\u6570\u636e\u7684\u3002\u6b64\u5916\uff0c\u591a\u6570PCI-X\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\u662f\u8fde\u7eed\u7684\uff0c\u56e0\u4e3a\u4f7f\u7528\u7684\u662f\u7a81\u53d1\u6a21\u5f0f\uff0c\u5e76\u4e14\u6570\u636e\u901a\u5e38\u4ee5128Bytes\u4f5c\u4e3a\u4e00\u4e2a\u6570\u636e\u5757\uff08block\uff09\u6765\u8fdb\u884c\u4f20\u8f93\u3002\u8fd9\u4e9b\u7279\u6027\u4f7f\u5f97\u603b\u7ebf\u5229\u7528\u7387\u63d0\u9ad8\uff0c\u540c\u65f6\u4e5f\u63d0\u9ad8\u4e86\u8bbe\u5907buffer\u7ba1\u7406\u7684\u6548\u7387\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#153-pci-xpci-x-features","title":"1.5.3     PCI-X\u7279\u6027(PCI-X Features)","text":""},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1531-split-transaction-model","title":"1.5.3.1   \u62c6\u5206\u4e8b\u52a1\u6a21\u578b\uff08Split-Transaction Model\uff09","text":"<p>\u5728\u4f20\u7edf\u7684PCI\u8bfb\u4e8b\u52a1\u4e2d\uff0c\u603b\u7ebfMaster\u5411\u603b\u7ebf\u4e0a\u67d0\u4e2a\u8bbe\u5907\u53d1\u8d77\u8bfb\u53d6\u3002\u5982\u524d\u9762\u7684\u5185\u5bb9\u6240\u8ff0\uff0c\u82e5Target\u8bbe\u5907\u672a\u51c6\u5907\u597d\uff0c\u65e0\u6cd5\u5b8c\u6210\u4e8b\u52a1\uff0c\u90a3\u4e48\u5b83\u65e2\u53ef\u4ee5\u9009\u62e9\u5728\u83b7\u53d6\u6570\u636e\u7684\u540c\u65f6\u8ba9\u603b\u7ebf\u4fdd\u6301\u7b49\u5f85\u6001\uff0c\u4e5f\u53ef\u4ee5\u53d1\u8d77Retry\u6765\u63a8\u8fdf\u4e8b\u52a1\u3002</p> <p>PCI-X\u5219\u4e0d\u540c\uff0c\u5b83\u4f7f\u7528\u62c6\u5206\u4e8b\u52a1\u7684\u65b9\u6cd5\u6765\u5904\u7406\u8fd9\u4e9b\u60c5\u51b5\uff0c\u5982\u56fe 1\u201117\u6240\u793a\u3002</p> <p></p> <p>\u56fe 1\u201117 PCI-X \u62c6\u5206\u4e8b\u52a1\u5904\u7406\u534f\u8bae</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u63cf\u8ff0\u8ffd\u8e2a\u6bcf\u4e2a\u8bbe\u5907\u6b63\u5728\u505a\u4ec0\u4e48\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u4f8b\u5b50\u4e2d\u53d1\u8d77\u8bfb\u53d6\u64cd\u4f5c\u7684\u4e00\u65b9\u79f0\u4e3aRequester\uff08\u8bf7\u6c42\u65b9\uff09\uff0c\u5c06\u5b8c\u6210\u8bfb\u53d6\u8bf7\u6c42\u63d0\u4f9b\u6570\u636e\u7684\u4e00\u65b9\u79f0\u4e3aCompleter\uff08\u5b8c\u6210\u65b9\uff09\u3002\u5982\u679cCompleter\u65e0\u6cd5\u9a6c\u4e0a\u5bf9\u8bf7\u6c42\u505a\u51fa\u76f8\u5e94\u7684\u670d\u52a1\uff0c\u5b83\u5c06\u628a\u8fd9\u4e2a\u4e8b\u52a1\u7684\u76f8\u5173\u4fe1\u606f\u5b58\u50a8\u8d77\u6765\uff08\u5730\u5740\u3001\u4e8b\u52a1\u7c7b\u578b\u3001\u603b\u6570\u636e\u91cf\u3001Requester ID\uff09\uff0c\u5e76\u53d1\u51fa\u62c6\u5206\u54cd\u5e94\u4fe1\u53f7\u3002\u8fd9\u5c31\u544a\u8bc9Requester\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u4e8b\u52a1\u5148\u653e\u7f6e\u5728\u961f\u5217\u4e2d\uff0c\u5e76\u7ed3\u675f\u5f53\u524d\u7684\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\uff0c\u91ca\u653e\u603b\u7ebf\u4f7f\u4e4b\u56de\u5230\u7a7a\u95f2\u72b6\u6001\u3002\u8fd9\u6837\uff0c\u5728Completer\u7b49\u5f85\u6240\u8bf7\u6c42\u7684\u6570\u636e\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff0c\u603b\u7ebf\u4e0a\u53ef\u4ee5\u6267\u884c\u5176\u4ed6\u7684\u4e8b\u52a1\u3002Requester\u5728\u8fd9\u6bb5\u65f6\u95f4\u91cc\u4e5f\u53ef\u4ee5\u81ea\u7531\u7684\u505a\u5176\u4ed6\u4e8b\u60c5\uff0c\u6bd4\u5982\u53d1\u8d77\u53e6\u4e00\u4e2a\u8bf7\u6c42\uff0c\u751a\u81f3\u662f\u5411\u6b64\u524d\u7684\u90a3\u4e2aCompleter\u53d1\u8d77\u8bf7\u6c42\u90fd\u53ef\u4ee5\u3002\u4e00\u65e6Completer\u6536\u96c6\u5230\u4e86\u6240\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u5b83\u5c06\u4f1a\u7533\u8bf7\u603b\u7ebf\u5360\u7528\u4ef2\u88c1\uff0c\u5f53\u83b7\u53d6\u5230\u603b\u7ebf\u7684\u4f7f\u7528\u6743\u540e\uff0c\u5b83\u5c06\u53d1\u8d77\u4e00\u4e2a\u62c6\u5206\u5b8c\u6210\uff08Split Completion\uff09\u6765\u8fd4\u56de\u6b64\u524dRequester\u6240\u8bf7\u6c42\u7684\u6570\u636e\u3002Requester\u5c06\u4f1a\u54cd\u5e94\u5e76\u53c2\u4e0e\u62c6\u5206\u5b8c\u6210\u8fd9\u4e2a\u4e8b\u52a1\u7684\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u63a5\u6536\u6765\u81eaCompleter\u7684\u6570\u636e\u3002\u5bf9\u4e8e\u7cfb\u7edf\u6765\u8bf4\uff0c\u62c6\u5206\u5b8c\u6210\u4e8b\u52a1\u5176\u5b9e\u4e0e\u5199\u4e8b\u52a1\u975e\u5e38\u76f8\u4f3c\u3002\u8fd9\u79cd\u62c6\u5206\u4e8b\u52a1\u6a21\u578b\uff08Split Transaction Model\uff09\u7684\u53ef\u884c\u6027\u5728\u4e8e\uff0c\u5728\u8bf7\u6c42\u53d1\u8d77\u65f6\u5c31\u901a\u8fc7\u5c5e\u6027\u9636\u6bb5\uff08Attribute Phase\uff09\u6307\u51fa\u4e86\u603b\u5171\u9700\u8981\u4f20\u8f93\u591a\u5c11\u6570\u636e\uff0c\u5e76\u4e14\u4e5f\u544a\u8bc9\u4e86Completer\u662f\u8c01\u53d1\u8d77\u4e86\u8fd9\u4e2a\u8bf7\u6c42\uff08\u901a\u8fc7\u63d0\u4f9bRequester\u81ea\u5df1\u7684Bus:Device:Function\u53f7\u7801\uff09\uff0c\u8fd9\u4f7f\u5f97Completer\u5728\u53d1\u8d77\u62c6\u5206\u5b8c\u6210\u4e8b\u52a1\u65f6\u80fd\u591f\u627e\u5230\u6b63\u786e\u7684\u76ee\u6807\u3002</p> <p>\u5bf9\u4e8e\u4e0a\u8ff0\u7684\u6574\u4e2a\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\u6765\u8bf4\uff0c\u9700\u8981\u901a\u8fc7\u4e24\u4e2a\u603b\u7ebf\u4e8b\u52a1\u6765\u5b8c\u6210\uff0c\u4f46\u662f\u8bfb\u8bf7\u6c42\u548c\u62c6\u5206\u5b8c\u6210\u8fd9\u4e24\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u7684\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff0c\u603b\u7ebf\u662f\u53ef\u4ee5\u6267\u884c\u5176\u4ed6\u4efb\u52a1\u7684\u3002Requester\u4e0d\u9700\u8981\u91cd\u590d\u7684\u8f6e\u8be2\u8bbe\u5907\u6765\u68c0\u67e5\u6570\u636e\u662f\u5426\u5df2\u7ecf\u51c6\u5907\u597d\u3002Completer\u53ea\u9700\u8981\u7b80\u5355\u7684\u7533\u8bf7\u603b\u7ebf\u5360\u7528\u4ef2\u88c1\uff0c\u7136\u540e\u5728\u80fd\u4f7f\u7528\u603b\u7ebf\u65f6\u5c06\u88ab\u8bf7\u6c42\u7684\u6570\u636e\u8fd4\u56de\u7ed9Requester\u5373\u53ef\u3002\u5c31\u603b\u7ebf\u5229\u7528\u7387\u800c\u8a00\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u6d41\u7a0b\u4f7f\u5f97\u4e8b\u52a1\u6a21\u578b\u66f4\u52a0\u9ad8\u6548\u3002</p> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5bf9PCI-X\u6240\u505a\u7684\u8fd9\u4e9b\u534f\u8bae\u589e\u5f3a\u6539\u8fdb\u4f7f\u5f97PCI-X\u7684\u4f20\u8f93\u6548\u7387\u63d0\u9ad8\u81f3\u7ea685%\uff0c\u800c\u4f7f\u7528\u6807\u51c6PCI\u534f\u8bae\u5219\u4e3a50%-60%\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1532-msimessage-signaled-interrupts","title":"1.5.3.2   MSI\u6d88\u606f\u5f0f\u4e2d\u65ad\uff08Message Signaled Interrupts\uff09","text":"<p>PCI-X\u8bbe\u5907\u9700\u8981\u652f\u6301MSI\u4e2d\u65ad\uff08Message Signaled Interrupts\uff09\uff0c\u5728\u4f20\u7edf\u4e2d\u65ad\u4f53\u7cfb\u7ed3\u6784\u4e2d\u7ecf\u5e38\u89c1\u5230\u591a\u4e2a\u8bbe\u5907\u9700\u8981\u5171\u4eab\u4e2d\u65ad\uff0c\u5f00\u53d1\u8fd9\u79cd\u529f\u80fd\u662f\u4e3a\u4e86\u51cf\u5c11\u6216\u8005\u6d88\u9664\u8fd9\u79cd\u9700\u8981\u3002\u60f3\u8981\u4ea7\u751f\u4e00\u4e2aMSI\u4e2d\u65ad\u8bf7\u6c42\uff0c\u8bbe\u5907\u9700\u8981\u53d1\u8d77\u4e00\u4e2amemory\u5199\u4e8b\u52a1\uff0c\u5176\u64cd\u4f5c\u5730\u5740\u4e3a\u4e00\u6bb5\u9884\u5148\u5b9a\u4e49\u597d\u7684\u5730\u5740\u533a\u57df\uff0c\u5728\u8fd9\u4e2a\u5730\u5740\u533a\u57df\u5185\u7684\u4e00\u4e2a\u5199\u5165\u64cd\u4f5c\u5c31\u4f1a\u88ab\u89c6\u4e3a\u662f\u4e00\u4e2a\u4e2d\u65ad\uff0c\u8fd9\u4e2a\u4fe1\u606f\u5c06\u4f1a\u88ab\u4f20\u9001\u7ed9\u4e00\u4e2a\u6216\u591a\u4e2aCPU\uff0c\u5199\u5165\u7684\u6570\u636e\u5219\u662f\u53d1\u8d77\u4e2d\u65ad\u7684\u8bbe\u5907\u7684\u4e2d\u65ad\u5411\u91cf\uff0c\u8fd9\u4e2a\u4e2d\u65ad\u5411\u91cf\u5728\u7cfb\u7edf\u4e2d\u662f\u552f\u4e00\u7684\uff0c\u4ec5\u6307\u5411\u8fd9\u4e00\u4e2a\u8bbe\u5907\u3002\u5bf9\u4e8eCPU\u6765\u8bf4\uff0c\u62e5\u6709\u4e86\u4e2d\u65ad\u53f7\u4e4b\u540e\u5c31\u53ef\u4ee5\u8fc5\u901f\u7684\u8df3\u8f6c\u5230\u5bf9\u5e94\u8bbe\u5907\u7684\u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u8fd8\u9700\u8981\u82b1\u8d39\u989d\u5916\u7684\u5f00\u9500\u6765\u67e5\u627e\u662f\u90a3\u4e2a\u8bbe\u5907\u53d1\u8d77\u7684\u4e2d\u65ad\u3002\u6b64\u5916\uff0c\u8fd9\u6837\u7684\u4e2d\u65ad\u65b9\u5f0f\u5c31\u4e0d\u9700\u8981\u989d\u5916\u7684\u4e2d\u65ad\u5f15\u811a\u4e86\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1533-transaction-attributes","title":"1.5.3.3   \u4e8b\u52a1\u5c5e\u6027\uff08Transaction Attributes\uff09","text":"<p>\u6700\u540e\uff0c\u6211\u4eec\u6765\u4ecb\u7ecd\u4e00\u4e0bPCI-X\u5728\u6bcf\u4e2a\u4e8b\u52a1\u5f00\u59cb\u65f6\u65b0\u52a0\u5165\u7684\u4e00\u4e2a\u9636\u6bb5\uff0c\u79f0\u4e4b\u4e3a\u5c5e\u6027\u9636\u6bb5\uff08\u5982\u56fe 1\u201116\u6240\u793a\uff09\u3002\u5728\u6bb5\u65f6\u95f4\u4e2d\uff0cRequester\u4f1a\u5c06\u6240\u53d1\u8d77\u4e8b\u52a1\u7684\u4e00\u4e9b\u4fe1\u606f\u4f20\u9012\u7ed9Completer\uff0c\u4fe1\u606f\u5305\u62ec\u8bf7\u6c42\u7684\u603b\u6570\u636e\u91cf\u5927\u5c0f\u3001Requester\u662f\u8c01\uff08Bus:Device:Function \u53f7\u7801\uff09\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u6709\u6548\u7684\u8ba9\u603b\u7ebf\u4e0a\u7684\u4e8b\u52a1\u6267\u884c\u63d0\u5347\u6548\u7387\u3002\u9664\u4e86\u8fd9\u4e9b\u4ee5\u5916\uff0c\u8fd8\u65b0\u5f15\u5165\u4e862bit\u7684\u4fe1\u53f7\u6765\u63cf\u8ff0\u6240\u53d1\u8d77\u7684\u4e8b\u52a1\uff1a\u201cNo Snoop\uff08\u65e0\u7aa5\u63a2\uff09\u201d\u4f4d\u4e0e\u201cRelaxed Ordering\uff08\u5bbd\u677e\u6392\u5e8f\uff09\u201d\u4f4d\u3002</p> <p>l No Snoop\uff08NS\uff09\uff1a\u4e00\u822c\u6765\u8bf4\uff0c\u5f53\u4e00\u4e2a\u4e8b\u52a1\u8981\u628a\u6570\u636e\u79fb\u5165\u6216\u8005\u79fb\u51faMemory\u65f6\uff0cCPU\u5185\u90e8\u7684Cache\u9700\u8981\u68c0\u67e5\u88ab\u64cd\u4f5c\u7684Memory\u533a\u57df\u4e2d\u662f\u5426\u5b58\u5728\u5df2\u7ecf\u88ab\u62f7\u8d1d\u5230Cache\u4e2d\u7684\u90e8\u5206\u3002\u82e5\u5b58\u5728\uff0c\u90a3\u4e48Cache\u9700\u8981\u5728\u4e8b\u52a1\u8bbf\u95eeMemory\u4e4b\u524d\u5c31\u628a\u6570\u636e\u5199\u56deMemory\uff0c\u6216\u662f\u628aCache\u5185\u7684\u6570\u636e\u6309\u5931\u6548\u5904\u7406\u3002\u5f53\u7136\uff0c\u8fd9\u4e2a\u7aa5\u63a2Memory\u5185\u5bb9\u6709\u65e0\u51fa\u73b0\u5728cache\u4e2d\u7684\u8fc7\u7a0b\u5c06\u4f1a\u6d88\u8017\u4e00\u5b9a\u7684\u65f6\u95f4\uff0c\u5e76\u4e14\u4f1a\u589e\u52a0\u8fd9\u4e2a\u8bf7\u6c42\u7684\u5ef6\u8fdf\u3002\u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff0c\u8f6f\u4ef6\u662f\u77e5\u9053\u67d0\u4e2a\u8bf7\u6c42\u7684Memory\u4f4d\u7f6e\u6c38\u8fdc\u4e0d\u4f1a\u51fa\u73b0\u5728Cache\u4e2d\uff08\u8fd9\u53ef\u80fd\u662f\u56e0\u4e3a\u8fd9\u4e2a\u4f4d\u7f6e\u88ab\u7cfb\u7edf\u5b9a\u4e49\u4e3a\u4e0d\u53ef\u7f13\u5b58\u7684\uff09\uff0c\u56e0\u6b64\u5bf9\u4e8e\u8fd9\u4e9b\u4f4d\u7f6e\u662f\u4e0d\u9700\u8981\u8fdb\u884c\u7aa5\u63a2\u7684\uff0c\u5e94\u8be5\u8df3\u8fc7\u8fd9\u4e00\u6b65\u9aa4\u3002No Snoop\u4f4d\u6b63\u662f\u57fa\u4e8e\u8fd9\u79cd\u539f\u56e0\u800c\u88ab\u5f15\u5165\u8fdb\u6765\u3002</p> <p>l Relaxed Ordering\uff08RO\uff09\uff1a\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53\u4e8b\u52a1\u901a\u8fc7Bridge\u7684buffer\u65f6\uff0c\u4e8b\u52a1\u95f4\u9700\u8981\u4fdd\u6301\u5f53\u521d\u88ab\u653e\u7f6e\u5230\u603b\u7ebf\u4e0a\u65f6\u7684\u987a\u5e8f\u3002\u8fd9\u88ab\u79f0\u4e3a\u5f3a\u6392\u5e8f\u6a21\u578b\uff08Strongly ordered model\uff09\uff0cPCI\u4e0ePCI-X\u4e00\u822c\u90fd\u4f1a\u9075\u5faa\u8fd9\u79cd\u89c4\u5219\uff0c\u9664\u4e86\u4e00\u4e9b\u4e2a\u522b\u60c5\u51b5\u3002\u8fd9\u662f\u56e0\u4e3a\u5f3a\u6392\u5e8f\u6a21\u578b\u53ef\u4ee5\u89e3\u51b3\u6709\u76f8\u4e92\u8054\u7cfb\u7684\u4e8b\u52a1\u4e4b\u95f4\u7684\u4f9d\u8d56\u95ee\u9898\uff0c\u4f8b\u5982\u5bf9\u540c\u4e00\u4e2a\u4f4d\u7f6e\u5148\u8fdb\u884c\u5199\u5165\u518d\u8fdb\u884c\u8bfb\u53d6\uff0c\u6309\u7167\u5f3a\u6392\u5e8f\u6a21\u578b\u5c31\u53ef\u4ee5\u4f7f\u5f97\u8bfb\u53d6\u64cd\u4f5c\u8bfb\u53d6\u5230\u5199\u5165\u540e\u7684\u6b63\u786e\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5199\u5165\u524d\u7684\u65e7\u6570\u636e\u3002\u7136\u800c\u5b9e\u9645\u4e0a\u5e76\u4e0d\u662f\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\u3002\u5982\u679c\u6709\u4e9b\u4e8b\u52a1\u4e0d\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\uff0c\u90a3\u4e48\u4f9d\u7136\u5f3a\u5236\u5b83\u4eec\u4fdd\u6301\u539f\u6765\u7684\u987a\u5e8f\u5c06\u4f1a\u9020\u6210\u6027\u80fd\u635f\u5931\uff0c\u8fd9\u5c31\u662f\u65b0\u6dfb\u52a0\u8fd9\u4e00\u5c5e\u6027\u6bd4\u7279\u4f4d\u60f3\u89e3\u51b3\u7684\u95ee\u9898\u3002\u5982\u679cRequester\u77e5\u9053\u67d0\u4e2a\u7279\u5b9a\u7684\u4e8b\u52a1\u662f\u4e0e\u6b64\u524d\u5176\u4ed6\u4e8b\u52a1\u4e0d\u76f8\u5173\u8054\u7684\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u4e8b\u52a1\u7684\u8fd9\u4e00\u4f4d\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u6837\u5c31\u80fd\u544a\u8bc9Bridge\u53ef\u4ee5\u5728\u961f\u5217\u4e2d\u5411\u524d\u8c03\u5ea6\u8be5\u4e8b\u52a1\uff0c\u63d0\u524d\u6267\u884c\uff0c\u4ee5\u6b64\u5e26\u6765\u66f4\u597d\u7684\u6027\u80fd\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#154-pci-xhigher-bandwidth-pci-x","title":"1.5.4     \u66f4\u9ad8\u5e26\u5bbd\u7684PCI-X(Higher Bandwidth PCI-X)","text":""},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1541-pcipci-x-10","title":"1.5.4.1   PCI\u4e0ePCI-X 1.0\u5e76\u884c\u603b\u7ebf\u6a21\u578b\u4e2d\u7531\u4e8e\u516c\u5171\u65f6\u949f\u65b9\u6cd5\u6240\u5e26\u6765\u7684\u95ee\u9898","text":"<p>\u5f53\u5c1d\u8bd5\u5c06PCI\u8fd9\u6837\u7684\u603b\u7ebf\u5347\u7ea7\u5230\u66f4\u9ad8\u7684\u901f\u7387\u65f6\uff0c\u4e00\u4e2a\u95ee\u9898\u53d8\u5f97\u8d8a\u6765\u8d8a\u660e\u663e\uff0c\u90a3\u5c31\u662f\u5e76\u884c\u603b\u7ebf\u8bbe\u8ba1\u5b58\u5728\u4e00\u4e9b\u56fa\u6709\u7684\u5148\u5929\u5c40\u9650\u3002\u56fe 1\u201118\u53ef\u4ee5\u6709\u52a9\u4e8e\u7406\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002\u8fd9\u4e9b\u8bbe\u8ba1\u901a\u5e38\u4f7f\u7528\u516c\u5171\u65f6\u949f\uff08common clock\uff09\u6216\u8005\u662f\u5206\u5e03\u5f0f\u65f6\u949f\uff08distributed clock\uff09\uff0c\u5176\u4e2d\uff0c\u53d1\u9001\u65b9\u5728\u516c\u5171\u65f6\u949f\u7684\u67d0\u4e00\u4e2a\u65f6\u949f\u6cbf\u5c06\u6570\u636e\u8f93\u51fa\uff0c\u7136\u540e\u63a5\u6536\u65b9\u5728\u516c\u5171\u65f6\u949f\u7684\u4e0b\u4e00\u4e2a\u65f6\u949f\u6cbf\u5c06\u6570\u636e\u9501\u5b58\uff0c\u4e5f\u5c31\u662f\u8bf4\u7528\u4e8e\u4f20\u8f93\u7684\u65f6\u95f4\u9884\u7b97\u957f\u5ea6\u5c31\u662f\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u3002</p> <p></p> <p>\u56fe 1\u201118\u5e76\u884c\u8bbe\u8ba1\u7684\u56fa\u6709\u95ee\u9898</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u7b2c\u4e00\u4e2a\u95ee\u9898\u662f\u4fe1\u53f7\u6b6a\u659c\uff08signal skew\uff09\u3002\u5f53\u6570\u636e\u7684\u591a\u4e2abit\u5728\u540c\u4e00\u65f6\u523b\u88ab\u53d1\u51fa\uff0c\u4ed6\u4eec\u6240\u7ecf\u5386\u7684\u5ef6\u65f6\u4f1a\u5b58\u5728\u8f7b\u5fae\u7684\u5dee\u522b\uff0c\u8fd9\u4f7f\u5f97\u4ed6\u4eec\u5230\u8fbe\u63a5\u6536\u65b9\u7684\u65f6\u523b\u4e5f\u4f1a\u5b58\u5728\u8f7b\u5fae\u7684\u5dee\u522b\u3002\u5982\u679c\u67d0\u4e9b\u539f\u56e0\u9020\u6210\u8fd9\u79cd\u5dee\u522b\u8fc7\u5927\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u56fe\u4e2d\u6240\u793a\u7684\u4fe1\u53f7\u91c7\u6837\u9519\u8bef\u7684\u95ee\u9898\u3002\u7b2c\u4e8c\u4e2a\u95ee\u9898\u662f\u591a\u4e2a\u8bbe\u5907\u95f4\u7684\u65f6\u949f\u6b6a\u659c\u95ee\u9898\u3002\u516c\u5171\u65f6\u949f\u5230\u8fbe\u5404\u4e2a\u8bbe\u5907\u7684\u65f6\u95f4\u70b9\u5e76\u4e0d\u662f\u5341\u5206\u7cbe\u786e\u4e00\u81f4\u7684\uff0c\u8fd9\u4e5f\u4f1a\u5927\u5927\u7684\u538b\u7f29\u4e86\u7528\u4e8e\u4f20\u8f93\u4fe1\u53f7\u7684\u65f6\u95f4\u9884\u7b97\u957f\u5ea6\u3002\u6700\u540e\uff0c\u7b2c\u4e09\u4e2a\u95ee\u9898\u4e0e\u4e00\u4e2a\u4fe1\u53f7\u4ece\u53d1\u9001\u65b9\u4f20\u8f93\u5230\u63a5\u6536\u65b9\u6240\u9700\u8981\u7684\u65f6\u95f4\u6709\u5173\uff0c\u6211\u4eec\u79f0\u8fd9\u4e2a\u65f6\u95f4\u4e3a\u6e21\u8d8a\u65f6\u95f4\uff08flight time\uff09\u3002\u65f6\u949f\u5468\u671f\u6216\u662f\u4f20\u8f93\u65f6\u95f4\u9884\u7b97\u5fc5\u987b\u8981\u5927\u4e8e\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u3002\u4e3a\u4e86\u786e\u4fdd\u6ee1\u8db3\u8fd9\u6837\u7684\u6761\u4ef6\uff0cPCB\u786c\u4ef6\u677f\u7ea7\u8bbe\u8ba1\u9700\u8981\u8ba9\u4fe1\u53f7\u8d70\u7ebf\u5c3d\u53ef\u80fd\u77ed\uff0c\u4ee5\u6b64\u6765\u8ba9\u4fe1\u53f7\u4f20\u8f93\u65f6\u5ef6\u5c0f\u4e8e\u65f6\u949f\u5468\u671f\u3002\u5728\u8bb8\u591a\u7535\u8def\u677f\u8bbe\u8ba1\u4e2d\uff0c\u8fd9\u79cd\u77ed\u4fe1\u53f7\u8d70\u7ebf\u7684\u8bbe\u8ba1\u5e76\u4e0d\u73b0\u5b9e\u3002</p> <p>\u5c3d\u7ba1\u5b58\u5728\u8fd9\u4e9b\u81ea\u8eab\u5c40\u9650\uff0c\u4f46\u662f\u4e3a\u4e86\u66f4\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\uff0c\u8fd8\u662f\u6709\u51e0\u9879\u6280\u672f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002\u9996\u5148\uff0c\u53ef\u4ee5\u5bf9\u73b0\u6709\u7684\u534f\u8bae\u8fdb\u884c\u7b80\u5316\u800c\u63d0\u9ad8\u6548\u7387\u3002\u7b2c\u4e8c\uff0c\u53ef\u4ee5\u5c06\u603b\u7ebf\u6a21\u578b\u66f4\u6539\u4e3a\u6e90\u540c\u6b65\u65f6\u949f\u6a21\u578b\uff08source synchronous clocking model\uff09\uff0c\u5728\u8fd9\u79cd\u65f6\u949f\u6a21\u578b\u4e2d\uff0c\u603b\u7ebf\u4fe1\u53f7\u548c\u65f6\u949f\uff08strobe\u9009\u901a\u8109\u51b2\uff09\u88ab\u9a71\u52a8\u540e\u5c06\u7ecf\u5386\u76f8\u540c\u7684\u4f20\u8f93\u5ef6\u8fdf\u5230\u8fbe\u63a5\u6536\u7aef\uff08\u8fd9\u91cc\u53ef\u4ee5\u5bf9\u6bd4\u4e00\u4e0bcommon clock\u4e0e\u5176\u7684\u533a\u522b\uff09\u3002\u8fd9\u79cd\u65b9\u6cd5\u88abPCI-X 2.0\u6240\u91c7\u7528\u3002</p>"},{"location":"pcie/01%20%E8%83%8C%E6%99%AF/#1542-pci-x-20pci-x-20-source-synchronous-model","title":"1.5.4.2   PCI-X 2.0\u6e90\u540c\u6b65\u6a21\u578b\uff08PCI-X 2.0 Source-Synchronous Model\uff09","text":"<p>PCI-X2.0\u66f4\u8fdb\u4e00\u6b65\u7684\u63d0\u9ad8\u4e86PCI-X\u7684\u5e26\u5bbd\u3002\u5982\u6b64\u524d\u5347\u7ea7\u65f6\u4e00\u6837\uff0cPCI-X 2.0\u4f9d\u7136\u4fdd\u6301\u4e86\u5bf9PCI\u7684\u8f6f\u4ef6\u4e0e\u786c\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\u3002\u4e3a\u4e86\u8fbe\u5230\u66f4\u9ad8\u7684\u901f\u7387\uff0c\u603b\u7ebf\u4f7f\u7528\u4e86\u6e90\u540c\u6b65\u4f20\u8f93\u6a21\u578b\uff0c\u6765\u652f\u6301DDR\uff08\u53cc\u500d\u6570\u636e\u901f\u7387\uff09\u6216\u662fQDR\uff08\u56db\u500d\u6570\u636e\u901f\u7387\uff09\u3002</p> <p>\u201c\u6e90\u540c\u6b65\u201d\u8fd9\u4e2a\u672f\u8bed\u7684\u610f\u601d\u662f\uff0c\u8bbe\u5907\u5728\u4f20\u8f93\u6570\u636e\u7684\u540c\u65f6\uff0c\u8fd8\u63d0\u4f9b\u4e86\u989d\u5916\u4e00\u4e2a\u4e0e\u6570\u636e\u4fe1\u53f7\u57fa\u672c\u4f20\u8f93\u8def\u5f84\u76f8\u540c\u7684\u4fe1\u53f7\u3002\u5982\u56fe 1\u201119\u6240\u793a\uff0c\u5728PCI-X 2.0\u4e2d\uff0c\u90a3\u4e2a\u201c\u989d\u5916\u201d\u7684\u4fe1\u53f7\u88ab\u79f0\u4e3a\u201cstrobe\uff08\u8109\u51b2\u9009\u901a\uff09\u201d\uff0c\u63a5\u6536\u65b9\u4f7f\u7528\u5b83\u6765\u9501\u5b58\u53d1\u6765\u7684\u6570\u636e\u3002\u53d1\u9001\u65b9\u53ef\u4ee5\u5206\u914ddata\u4e0estrobe\u4fe1\u53f7\u4e4b\u95f4\u7684\u65f6\u5e8f\u5173\u7cfb\uff0c\u53ea\u8981data\u4e0estrobe\u4fe1\u53f7\u7684\u4f20\u8f93\u8def\u5f84\u957f\u5ea6\u76f8\u8fd1\u4e14\u5176\u4ed6\u4f1a\u5f71\u54cd\u4f20\u8f93\u5ef6\u8fdf\u7684\u6761\u4ef6\u4e5f\u76f8\u8fd1\uff0c\u90a3\u4e48\u5f53\u4fe1\u53f7\u5230\u8fbe\u63a5\u6536\u65b9\u65f6\uff0c\u8fd9\u79cd\u4fe1\u53f7\u95f4\u7684\u65f6\u5e8f\u5173\u7cfb\u4e5f\u5c06\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u3002\u8fd9\u79cd\u7279\u70b9\u53ef\u4ee5\u7528\u4e8e\u652f\u6301\u66f4\u9ad8\u901f\u7387\u7684\u4f20\u8f93\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u6e90\u540c\u6b65\u65f6\u949f\u6a21\u578b\u4e2d\uff0c\u63a5\u6536\u65b9\u91c7\u6837\u6240\u4f7f\u7528\u7684strobe\uff08\u7c7b\u4f3c\u4e8e\u539f\u6765\u7684\u65f6\u949f\uff09\u4e5f\u662f\u6570\u636e\u7684\u6765\u6e90\u65b9\u53d1\u9001\u7684\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u516c\u5171\u65f6\u949f\u5230\u8fbe\u5404\u8bbe\u5907\u7684\u5ef6\u65f6\u4e0d\u540c\u800c\u9020\u6210\u7684\u65f6\u949f\u6b6a\u659c\u95ee\u9898\uff0c\u56e0\u4e3a\u5982\u4e0a\u6240\u8ff0\u6b64\u65f6\u7684data\u4e0estrobe\u4e4b\u95f4\u7684\u65f6\u5e8f\u5173\u7cfb\u662f\u57fa\u672c\u76f8\u5bf9\u4e0d\u53d8\u7684\uff0c\u8fd9\u6837\u5c31\u5c06\u65f6\u949f\u6b6a\u659c\u7684\u8fd9\u6bb5\u65f6\u95f4\u5355\u72ec\u5254\u9664\u4e86\u51fa\u53bb\uff0c\u4e0d\u518d\u5360\u7528\u539f\u6765\u7684\u4f20\u8f93\u65f6\u95f4\u9884\u7b97\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u56e0\u4e3a\u5b58\u5728\u4e86strobe\u4fe1\u53f7\u6765\u968f\u8def\u6307\u793a\u63a5\u6536\u65b9\u4f55\u65f6\u9501\u5b58\u91c7\u6837\u6570\u636e\uff0c\u6240\u4ee5\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u4e0d\u518d\u662f\u4e2a\u95ee\u9898\uff0c\u5373\u4f7f\u8d70\u7ebf\u8f83\u957f\u4e5f\u4f9d\u7136\u80fd\u7531\u4f34\u968fdata\u7684strobe\u4fe1\u53f7\u6765\u8ba9\u63a5\u6536\u65b9\u6b63\u786e\u7684\u91c7\u6837\u6570\u636e\uff0c\u800c\u4e0d\u5fc5\u7ea0\u7ed3\u5728\u4e0b\u4e00\u4e2a\u201c\u65f6\u949f\u4e0a\u5347\u6cbf\u201d\u5fc5\u987b\u8981\u8fdb\u884c\u91c7\u6837\uff0c\u73b0\u5728strobe\u4f55\u65f6\u6307\u793a\u5219\u5728\u4f55\u65f6\u91c7\u6837\u3002</p> <p></p> <p>\u56fe 1\u201119\u6e90\u540c\u6b65\u65f6\u949f\u6a21\u578b</p> <p>\u9700\u8981\u518d\u6b21\u5f3a\u8c03\u7684\u662f\uff0c\u8fd9\u79cd\u975e\u5e38\u9ad8\u901f\u7684\u4fe1\u53f7\u65f6\u5e8f\u4f7f\u5f97\u5171\u4eab\u603b\u7ebf\u6a21\u578b\u65e0\u6cd5\u88ab\u4f7f\u7528\uff0c\u5b83\u53ea\u80fd\u88ab\u8bbe\u8ba1\u4e3a\u70b9\u5bf9\u70b9\u7684\u4f20\u8f93\u5f62\u5f0f\u3002\u56e0\u6b64\uff0c\u60f3\u8981\u589e\u52a0\u66f4\u591a\u7684\u8bbe\u5907\u5c31\u9700\u8981\u66f4\u591a\u7684Bridge\u6765\u4ea7\u751f\u66f4\u591a\u7684\u603b\u7ebf\u3002\u4e3a\u4e86\u8fbe\u5230\u8fd9\u6837\u7684\u4f7f\u7528\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u79cd\u8bbe\u5907\uff0c\u5b83\u62e5\u67093\u4e2aPCI-X 2.0\u63a5\u53e3\uff0c\u5176\u5185\u90e8\u8fd8\u6709\u4e00\u4e2aBridge\u7ed3\u6784\u4ee5\u6b64\u6765\u8ba9\u4ed6\u4eec\u4e09\u8005\u8fdb\u884c\u76f8\u4e92\u901a\u4fe1\u3002\u4e0d\u8fc7\uff0c\u8fd9\u6837\u7684\u8bbe\u5907\u5c06\u4f1a\u5177\u6709\u5f88\u9ad8\u7684\u5f15\u811a\u6570\u91cf\uff0c\u800c\u4e14\u6210\u672c\u4e5f\u4f1a\u66f4\u9ad8\uff0c\u8fd9\u4f7f\u5f97PCI-X 2.0\u88ab\u56f0\u5728\u4e86\u9ad8\u7aef\u5e02\u573a\u800c\u65e0\u6cd5\u5927\u9762\u79ef\u666e\u53ca\u3002</p> <p>\u7531\u4e8e\u534f\u8bae\u5236\u5b9a\u8005\u8ba4\u8bc6\u5230\u4e86PCI-X 2.0\u7684\u6602\u8d35\u89e3\u51b3\u65b9\u6848\u4ec5\u80fd\u5438\u5f15\u66f4\u591a\u7684\u9ad8\u7aef\u5f00\u53d1\u8005\u800c\u4e0d\u662f\u4e00\u822c\u5f00\u53d1\u8005\uff0c\u56e0\u6b64PCI-X 2.0\u63d0\u4f9b\u4e86\u66f4\u7b26\u5408\u9ad8\u7aef\u8bbe\u8ba1\u7684\u6280\u672f\u6807\u51c6\uff0c\u4f8b\u5982\u652f\u6301ECC\u7684\u751f\u6210\u4e0e\u6821\u9a8c\u3002PCI-X\u7684ECC\u6bd4PCI\u4e2d\u4f7f\u7528\u7684\u5947\u5076\u6821\u9a8c\u8981\u66f4\u4e3a\u590d\u6742\uff0c\u9c81\u68d2\u6027\uff08robust\uff09\u4e5f\u8981\u9ad8\u5f97\u591a\uff0c\u5b83\u53ef\u4ee5\u52a8\u6001\u7684\u81ea\u52a8\u7ea0\u6b63\u5355bit\u9519\u8bef\uff0c\u4ee5\u53ca\u5bf9\u591abit\u9519\u8bef\u8fdb\u884c\u53ef\u9760\u7684\u68c0\u6d4b\u3002\u8fd9\u79cd\u6539\u8fdb\u540e\u7684\u9519\u8bef\u5904\u7406\u65b9\u6cd5\u589e\u52a0\u4e86\u6210\u672c\uff0c\u4f46\u662f\u5bf9\u4e8e\u9ad8\u7aef\u5e73\u53f0\u6765\u8bf4\uff0c\u5b83\u6240\u80fd\u589e\u52a0\u7684\u53ef\u9760\u6027\u624d\u662f\u66f4\u4e3a\u770b\u4e2d\u7684\uff0c\u56e0\u6b64\u5373\u4f7f\u589e\u52a0\u4e86\u6210\u672c\u8fd9\u4e5f\u662f\u4e00\u4e2a\u5408\u7406\u7684\u9009\u62e9\u3002</p> <p>\u5c3d\u7ba1PCI-X 2.0\u5c06\u5e26\u5bbd\u3001\u6548\u7387\u4ee5\u53ca\u53ef\u9760\u6027\u90fd\u63d0\u5347\u4e86\uff0c\u4f46\u662f\u5e76\u884c\u603b\u7ebf\u7684\u7ec8\u7a76\u8fd8\u662f\u8d70\u5230\u4e86\u5b83\u7684\u7ec8\u70b9\uff0c\u9700\u8981\u4e00\u79cd\u65b0\u7684\u6a21\u578b\u6765\u6ee1\u8db3\u4eba\u4eec\u5bf9\u4e8e\u66f4\u9ad8\u5e26\u5bbd\u4e14\u66f4\u4f4e\u6210\u672c\u7684\u4e0d\u65ad\u7684\u9700\u6c42\u3002\u6700\u7ec8\u88ab\u9009\u4e2d\u7684\u65b0\u578b\u603b\u7ebf\u6a21\u578b\u4f7f\u7528\u7684\u662f\u4e32\u884c\u63a5\u53e3\uff0c\u4ece\u7269\u7406\u5c42\u9762\u6765\u770b\u5b83\u4e0ePCI\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u603b\u7ebf\uff0c\u4f46\u662f\u5b83\u5728\u8f6f\u4ef6\u5c42\u9762\u4fdd\u7559\u4e86\u5bf9PCI\u7684\u5411\u540e\u517c\u5bb9\u6027\u3002</p> <p>\u8fd9\u4e2a\u65b0\u6a21\u578b\uff0c\u5c31\u662f\u6211\u4eec\u6240\u77e5\u9053\u7684PCI Express\uff08PCIe\uff09\u3002</p> <p>\u539f\u6587\uff1a  Mindshare</p> <p>\u8bd1\u8005\uff1a  Michael ZZY</p> <p>\u6821\u5bf9\uff1a  LJGibbs</p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/","title":"02 PCIe \u4f53\u7cfb\u7ed3\u6784\u6982\u8ff0","text":""},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#chapter-2-pcie-architecture-overview-pcie","title":"Chapter 2      PCIe Architecture Overview //PCIe\u4f53\u7cfb\u7ed3\u6784\u6982\u8ff0","text":""},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#_1","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u524d\u4e00\u7ae0\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86 PCI \u6280\u672f\u53d1\u5c55\u7684\u5386\u53f2\uff0c\u4ee5\u6b64\u6765\u5efa\u7acb\u66f4\u597d\u5730\u7406\u89e3 PCIe \u7684\u57fa\u7840\u3002\u4e3b\u8981\u56de\u987e\u4e86 PCI \u4e0e PCI-X 1.0/2.0 \u7684\u57fa\u7840\u5185\u5bb9\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u7ed9\u63a5\u4e0b\u6765\u5bf9 PCIe \u7684\u6982\u8ff0\u5185\u5bb9\u63d0\u4f9b\u4e00\u4e9b\u524d\u56e0\u540e\u679c\uff0c\u4ee5\u65b9\u4fbf\u7406\u89e3 PCIe\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u5bf9 PCI Express \u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u4e86\u5168\u9762\u7684\u4ecb\u7ecd\uff0c\u65e8\u5728\u5c06\u672c\u7ae0\u4f5c\u4e3a\u4e00\u4e2a\u201c\u6267\u884c\u5c42\u201d\u6982\u8ff0\uff0c\u6db5\u76d6\u8be5\u4f53\u7cfb\u7ed3\u6784\u5728\u9ad8\u5c42\u7684\u6240\u6709\u57fa\u7840\u77e5\u8bc6\u3002\u5b83\u4ecb\u7ecd\u4e86 PCIe \u534f\u8bae\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u5206\u5c42\u7684\u65b9\u6cd5\uff0c\u5e76\u63cf\u8ff0\u4e86\u6bcf\u4e2a\u5c42\u7ea7\u7684\u804c\u8d23\u4f5c\u7528\u3002\u4ecb\u7ecd\u4e86\u5404\u79cd\u6570\u636e\u5305\u7c7b\u578b\u7684\u540c\u65f6\u4e5f\u4e00\u8d77\u4ecb\u7ecd\u4e86\u7528\u4e8e\u6570\u636e\u5305\u901a\u4fe1\u548c\u589e\u5f3a\u6570\u636e\u5305\u4f20\u8f93\u53ef\u9760\u6027\u7684\u534f\u8bae\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u4ecb\u7ecd\u4e86 PCI Express \u73af\u5883\u4e2d\u7684\u914d\u7f6e\u90e8\u5206\u3002\u5b83\u5305\u62ec\u7528\u4e8e\u5b9e\u73b0\u529f\u80fd\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u7a7a\u95f4\uff0c\u4e00\u4e2a\u529f\u80fd\u5982\u4f55\u5728\u603b\u7ebf\u4e0a\u88ab\u53d1\u73b0\uff0c\u914d\u7f6e\u4e8b\u52a1\u662f\u5982\u4f55\u88ab\u751f\u6210\u548c\u8def\u7531\u5230\u6b63\u786e\u7684\u4f4d\u7f6e\uff0cPCI \u517c\u5bb9\u7a7a\u95f4\u4e0e PCIe \u6269\u5c55\u7a7a\u95f4\u4e4b\u95f4\u7684\u5dee\u5f02\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u662f\u5982\u4f55\u533a\u5206\u7aef\u70b9\u548c\u6865\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#21-pci-express-introduction-to-pci-express","title":"2.1 PCI Express \u7b80\u4ecb (Introduction to PCI express)","text":"<p>PCI Express \u7684\u51fa\u73b0\u4ee3\u8868\u4e86\u5176\u524d\u8eab\u5e76\u884c\u603b\u7ebf\u7684\u91cd\u5927\u8f6c\u53d8\u3002\u4f5c\u4e3a\u4e00\u79cd\u4e32\u884c\u603b\u7ebf\uff0c\u5b83\u4e0e\u65e9\u671f\u7684\u4e32\u884c\u8bbe\u8ba1\uff08\u4f8b\u5982 InfiniBand \u6216\u8005 Fibre Channel\uff09\u6709\u8bb8\u591a\u7684\u5171\u540c\u70b9\uff0c\u4f46\u662f\u5b83\u5b8c\u5168\u4fdd\u6301\u4e86\u5728\u8f6f\u4ef6\u5c42\u9762\u5bf9 PCI \u7684\u540e\u5411\u517c\u5bb9\u3002</p> <p>\u6b63\u5982\u8bb8\u591a\u9ad8\u901f\u4e32\u884c\u4f20\u8f93\u65b9\u6cd5\u4e00\u6837\uff0cPCIe \u4f7f\u7528\u53cc\u5411\u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5728\u540c\u4e00\u65f6\u95f4\u8fdb\u884c\u4fe1\u606f\u7684\u6536\u53d1\u64cd\u4f5c\u3002\u8fd9\u79cd\u6a21\u578b\u88ab\u79f0\u4e3a\u53cc\u5355\u5de5\u8fde\u63a5\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u63a5\u53e3\u90fd\u6709\u4e00\u4e2a\u5355\u5de5\u53d1\u9001\u8def\u5f84\u548c\u4e00\u4e2a\u5355\u5de5\u63a5\u6536\u8def\u5f84\uff0c\u56fe2\u20111 \u5c55\u793a\u4e86\u8fd9\u79cd\u6a21\u578b\u3002\u56e0\u4e3a\u6570\u636e\u6d41\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u53cc\u5411\u4f20\u8f93\uff0c\u56e0\u6b64\u5728\u6280\u672f\u5c42\u9762\u4e0a\u6765\u8bf4\u4e24\u4e2a\u8bbe\u5907\u95f4\u7684\u901a\u4fe1\u5176\u5b9e\u662f\u5168\u53cc\u5de5\u7684\uff0c\u4f46\u662f PCIe \u534f\u8bae\u89c4\u8303\u4f9d\u7136\u4f7f\u7528\u53cc\u5355\u5de5\u8fd9\u4e2a\u672f\u8bed\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u79cd\u79f0\u547c\u5bf9\u5b9e\u9645\u901a\u4fe1\u4fe1\u9053\u4e5f\u8fdb\u884c\u4e86\u4e00\u70b9\u63cf\u8ff0\u3002</p> <p></p> <p>\u56fe2\u20111 \u53cc\u5355\u5de5\u94fe\u8def</p> <p>\u7528\u4e8e\u63cf\u8ff0\u8bbe\u5907\u4e4b\u95f4\u4fe1\u53f7\u4f20\u8f93\u8def\u5f84\u7684\u672f\u8bed\u4e3a\u201c\u94fe\u8def\uff08Link\uff09\u201d\uff0c\u5b83\u7531\u4e00\u4e2a\u6216\u4ee5\u4e0a\u7684\u63a5\u6536\u53d1\u9001\u5bf9\u7ec4\u6210\u3002\u8fd9\u6837\u7684\u4e00\u5bf9\u63a5\u6536\u548c\u53d1\u9001\u88ab\u79f0\u4e3a\u4e00\u4e2a\u201c\u901a\u9053\uff08Lane\uff09\u201d\uff0c\u534f\u8bae\u89c4\u8303\u5141\u8bb8\u4e00\u6761\u94fe\u8def\u5185\u6709 1\u30012\u30014\u30018\u300112\u300116 \u6216 32 \u4e2a\u901a\u9053\u3002\u94fe\u8def\u5185\u901a\u9053\u7684\u6570\u91cf\u79f0\u4e3a\u94fe\u8def\u5bbd\u5ea6\uff0c\u901a\u5e38\u7528 x1\u3001x2\u3001x4\u3001x8\u3001x16 \u4ee5\u53ca x32 \u6765\u8fdb\u884c\u8868\u793a\u3002\u7528\u4e8e\u6743\u8861\u5728\u5b9e\u9645\u8bbe\u8ba1\u4e2d\u4f7f\u7528\u591a\u5c11\u901a\u9053\u7684\u601d\u8def\u5176\u5b9e\u5f88\u7b80\u5355\uff1a\u4f7f\u7528\u66f4\u591a\u7684\u901a\u9053\u53ef\u4ee5\u589e\u52a0\u5e26\u5bbd\uff0c\u4f46\u662f\u4e5f\u4f1a\u589e\u52a0\u6210\u672c\u3001\u589e\u52a0\u7a7a\u95f4\u5360\u7528\u4ee5\u53ca\u589e\u52a0\u529f\u8017\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u9605\u8bfb\u201c\u94fe\u8def\u4e0e\u901a\u9053\u201d\u8fd9\u4e00\u8282\u3002</p> <p></p> <p>\u56fe2\u20112 \u4e00\u4e2a\u901a\u9053</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#211-software-backward-compatibility","title":"2.1.1     \u8f6f\u4ef6\u7684\u540e\u5411\u517c\u5bb9\u6027 (Software Backward Compatibility)","text":"<p>PCIe \u8bbe\u8ba1\u76ee\u6807\u4e2d\u6781\u4e3a\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\u8981\u4fdd\u6301\u5bf9 PCI \u8f6f\u4ef6\u7684\u540e\u5411\u517c\u5bb9\u6027\u3002\u5982\u679c\u4e00\u4e2a\u8bbe\u8ba1\u4f7f\u7528\u7684\u662f\u73b0\u6709\u7684\u7cfb\u7edf\uff0c\u800c\u4e14\u8fd9\u4e2a\u8bbe\u8ba1\u5df2\u7ecf\u80fd\u591f\u5728\u8fd9\u4e2a\u73b0\u6709\u7cfb\u7edf\u4e2d\u6b63\u5e38\u5de5\u4f5c\uff0c\u90a3\u4e48\u60f3\u8981\u4fc3\u4f7f\u5b83\u8f6c\u5411\u4f7f\u7528\u53e6\u4e00\u79cd\u7cfb\u7edf\u5219\u9700\u8981\u6ee1\u8db3\u4e24\u4ef6\u4e8b\uff1a\u7b2c\u4e00\uff0c\u65b0\u6280\u672f\u9700\u8981\u4e00\u4e9b\u6539\u53d8\u4f46\u662f\u6709\u8db3\u591f\u5438\u5f15\u4eba\u7684\u6027\u80fd\u63d0\u5347\uff0c\u7b2c\u4e8c\uff0c\u5c3d\u53ef\u80fd\u51cf\u5c0f\u6280\u672f\u8fc1\u79fb\u7684\u6210\u672c\u3001\u98ce\u9669\u4ee5\u53ca\u5de5\u4f5c\u91cf\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u70b9\u6765\u8bf4\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u901a\u5e38\u7684\u505a\u6cd5\u662f\u8ba9\u90a3\u4e9b\u4e3a\u65e7\u6a21\u578b\u6240\u7f16\u5199\u7684\u8f6f\u4ef6\u5728\u65b0\u6a21\u578b\u4e2d\u4f9d\u7136\u53ef\u7528\u3002\u4e3a\u4e86\u5728 PCIe \u4e2d\u505a\u5230\u8fd9\u4e00\u70b9\uff0cPCI \u4e2d\u7528\u5230\u7684\u6240\u6709\u7684\u5730\u5740\u7a7a\u95f4\u8981\u4e48\u4e0d\u505a\u66f4\u6539\u76f4\u63a5\u7167\u642c\uff0c\u8981\u4e48\u4ec5\u4ec5\u8fdb\u884c\u4e86\u4e86\u7b80\u5355\u7684\u6269\u5c55\u3002\u5185\u5b58\u3001IO \u548c\u914d\u7f6e\u7a7a\u95f4\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u4f9d\u7136\u662f\u53ef\u89c1\u7684\uff0c\u800c\u4e14\u8fde\u5199\u5165\u65b9\u5f0f\u90fd\u548c\u4ee5\u524d\u4e00\u6837\u3002\u56e0\u6b64\u5c31\u7b97\u662f\u6570\u5e74\u524d\u4e3a PCI \u800c\u5199\u7684\u8f6f\u4ef6\uff08BIOS \u4ee3\u7801\u3001\u8bbe\u5907\u9a71\u52a8\u7b49\u7b49\uff09\u5c06\u4f9d\u7136\u53ef\u4ee5\u5728\u73b0\u5728\u7684 PCIe \u8bbe\u5907\u4e0a\u4f7f\u7528\u3002\u914d\u7f6e\u7a7a\u95f4\u5df2\u7ecf\u88ab\u5927\u5927\u7684\u6269\u5c55\uff0c\u6dfb\u52a0\u4e86\u8bb8\u591a\u65b0\u7684\u5bc4\u5b58\u5668\u6765\u652f\u6301\u65b0\u7684\u529f\u80fd\uff0c\u4f46\u662f\u8001\u7684\u5bc4\u5b58\u5668\u4f9d\u7136\u5b58\u5728\u4e14\u53ef\u4ee5\u6309\u7167\u5e38\u89c4\u65b9\u5f0f\u6765\u8bbf\u95ee\u4ed6\u4eec\uff08\u8fd9\u90e8\u5206\u7684\u8be6\u7ec6\u5185\u5bb9\u89c1\u201c\u8f6f\u4ef6\u517c\u5bb9\u6027\u7279\u6027\u201d\uff09\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#212-serial-transport","title":"2.1.2     \u4e32\u884c\u4f20\u8f93 (Serial Transport)","text":""},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2121-the-need-for-speed","title":"2.1.2.1   \u5bf9\u4f20\u8f93\u901f\u7387\u7684\u9700\u6c42 (The need for Speed)","text":"<p>\u5f88\u660e\u663e\uff0c\u4e32\u884c\u4f20\u8f93\u6a21\u578b\u5fc5\u987b\u8981\u6bd4\u5e76\u884c\u7684\u8bbe\u8ba1\u8dd1\u7684\u5feb\u5f88\u591a\u624d\u80fd\u8fbe\u5230\u76f8\u540c\u7684\u5e26\u5bbd\uff0c\u8fd9\u662f\u56e0\u4e3a\u4e32\u884c\u4f20\u8f93\u4e00\u6b21\u53ea\u53d1\u9001 1 \u6bd4\u7279\u6570\u636e\u3002\u7136\u800c\uff0c\u4e8b\u5b9e\u8bc1\u660e\u8fd9\u5e76\u4e0d\u56f0\u96be\uff0c\u8fc7\u53bb\u7684 PCIe \u5728 2.5GT/s\u548c 5.0GT/s \u90fd\u80fd\u7a33\u5b9a\u7684\u5de5\u4f5c\u3002\u4e4b\u6240\u4ee5 PCIe \u53ef\u4ee5\u8fbe\u5230\u8fd9\u6837\u751a\u81f3\u66f4\u9ad8\u7684 8GT/s \u7684\u901f\u7387\uff0c\u662f\u56e0\u4e3a\u4e32\u884c\u4f20\u8f93\u6a21\u578b\u514b\u670d\u4e86\u5e76\u884c\u6a21\u578b\u7684\u4e0d\u8db3\u3002</p> <p>\u514b\u670d\u95ee\u9898. \u901a\u8fc7\u4e0a\u4e00\u7ae0\u5bf9 PCI \u5386\u53f2\u7684\u56de\u987e\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u5e76\u884c\u603b\u7ebf\u7684\u6027\u80fd\u88ab\u4e00\u4e9b\u95ee\u9898\u6240\u9650\u5236\uff0c\u56fe2\u20113 \u5c55\u793a\u4e86\u5176\u4e2d\u7684\u4e09\u4e2a\u95ee\u9898\u3002\u9996\u5148\uff0c\u56de\u60f3\u4e00\u4e0b\uff0c\u5e76\u884c\u603b\u7ebf\u4f7f\u7528\u516c\u5171\u65f6\u949f\uff1b\u4fe1\u53f7\u5728\u4e00\u4e2a\u65f6\u949f\u6cbf\u88ab\u8f93\u51fa\uff0c\u7136\u540e\u5728\u4e0b\u4e00\u4e2a\u65f6\u949f\u6cbf\u88ab\u63a5\u6536\u65b9\u63a5\u6536\u3002\u8fd9\u4e2a\u6a21\u578b\u7684\u7b2c\u4e00\u4e2a\u95ee\u9898\u6765\u81ea\u4e8e\u4fe1\u53f7\u4ece\u53d1\u9001\u7aef\u4f20\u8f93\u5230\u63a5\u6536\u7aef\u6240\u82b1\u8d39\u7684\u65f6\u95f4\uff0c\u79f0\u4e3a\u6e21\u8d8a\u65f6\u95f4\u3002\u6e21\u8d8a\u65f6\u95f4\u5fc5\u987b\u5c0f\u4e8e\u4e00\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u5426\u5219\u5c06\u4f1a\u51fa\u95ee\u9898\uff0c\u8fd9\u4f7f\u5f97\u96be\u4ee5\u901a\u8fc7\u7ee7\u7eed\u51cf\u5c0f\u65f6\u949f\u5468\u671f\u6765\u63d0\u5347\u901f\u5ea6\u3002\u56e0\u4e3a\u82e5\u9700\u8981\u7ee7\u7eed\u51cf\u5c0f\u65f6\u949f\u5468\u671f\uff0c\u4e3a\u4e86\u8ba9\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u4f9d\u7136\u5c0f\u4e8e\u65f6\u949f\u5468\u671f\uff0c\u9700\u8981\u66f4\u77ed\u7684\u5e03\u7ebf\u5e76\u51cf\u5c11\u8d1f\u8f7d\u7684\u8bbe\u5907\u6570\u91cf\uff0c\u4f46\u662f\u6700\u7ec8\u8fd9\u6837\u7684\u505a\u6cd5\u90fd\u4f1a\u5230\u8fbe\u6781\u9650\u5e76\u4e14\u8d8a\u6765\u8d8a\u4e0d\u73b0\u5b9e\u3002\u7b2c\u4e8c\u4e2a\u9020\u6210\u5e76\u884c\u6a21\u578b\u6027\u80fd\u53d7\u9650\u7684\u56e0\u7d20\u662f\u4f7f\u7528\u516c\u5171\u65f6\u949f\u65f6\uff0c\u65f6\u949f\u5230\u8fbe\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u7684\u65f6\u523b\u4e0d\u4e00\u81f4\uff0c\u8fd9\u79f0\u4e3a\u65f6\u949f\u504f\u659c\u3002\u7535\u8def\u677f\u8bbe\u8ba1\u4eba\u5458\u5c3d\u529b\u53bb\u51cf\u5c0f\u65f6\u949f\u504f\u659c\u7684\u503c\uff0c\u56e0\u4e3a\u65f6\u949f\u504f\u659c\u5c06\u4f1a\u964d\u4f4e\u4fe1\u53f7\u4f20\u8f93\u65f6\u5e8f\u9884\u7b97\uff0c\u4f46\u662f\u8fd9\u79cd\u504f\u659c\u6c38\u8fdc\u65e0\u6cd5\u5f7b\u5e95\u6d88\u9664\u3002\u7b2c\u4e09\u4e2a\u56e0\u7d20\u662f\u4fe1\u53f7\u504f\u659c\uff0c\u5b83\u6307\u7684\u662f\u591a\u6bd4\u7279\u4f4d\u5bbd\u6570\u636e\u7684\u5404\u4e2a\u4f4d\u5230\u8fbe\u63a5\u6536\u7aef\u7684\u65f6\u523b\u5b58\u5728\u5dee\u5f02\u3002\u663e\u7136\uff0c\u8fd9\u6837\u7684\u591a\u4f4d\u5bbd\u6570\u636e\u5728\u6240\u6709\u7684\u6bd4\u7279\u90fd\u5230\u8fbe\u4e14\u7a33\u5b9a\u4e4b\u524d\u90fd\u4e0d\u80fd\u88ab\u63a5\u6536\u65b9\u91c7\u6837\uff0c\u8fd9\u4f7f\u5f97\u6211\u4eec\u5fc5\u987b\u53bb\u7b49\u5f85\u6700\u6162\u7684\u90a3\u4e00\u6bd4\u7279\u3002</p> <p></p> <p>\u56fe2\u20113 \u5e76\u884c\u603b\u7ebf\u7684\u5c40\u9650</p> <p>PCIe \u8fd9\u6837\u7684\u4e32\u884c\u4f20\u8f93\u65b9\u6cd5\u662f\u5982\u4f55\u5904\u7406\u8fd9\u4e9b\u95ee\u9898\u7684\u5462\uff1f\u9996\u5148\uff0c\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u5c06\u4e0d\u518d\u662f\u4e00\u4e2a\u95ee\u9898\uff0c\u56e0\u4e3a\u7528\u4e8e\u6307\u793a\u63a5\u6536\u7aef\u9501\u5b58\u6570\u636e\u7684\u65f6\u949f\u73b0\u5728\u5df2\u7ecf\u88ab\u5185\u7f6e\u5165\u6570\u636e\u6d41\u4e2d\uff0c\u4e0d\u5728\u9700\u8981\u989d\u5916\u4f20\u8f93\u7ebf\u6765\u4f20\u8f93\u53c2\u8003\u65f6\u949f\u3002\u56e0\u6b64\uff0c\u65e0\u8bba\u518d\u5c0f\u7684\u65f6\u949f\u5468\u671f\uff0c\u6216\u662f\u518d\u957f\u7684\u4fe1\u53f7\u4f20\u8f93\u65f6\u95f4\u90fd\u4e0d\u4f1a\u4ea7\u751f\u4ee5\u524d\u7684\u95ee\u9898\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3a\u5185\u7f6e\u5728\u6570\u636e\u6d41\u4e2d\u7684\u65f6\u949f\u5fc5\u7136\u80fd\u4e0e\u6570\u636e\u4e00\u8d77\u5230\u8fbe\u63a5\u6536\u65b9\u3002\u540c\u6837\u5730\uff0c\u65f6\u949f\u504f\u659c\u7684\u95ee\u9898\u5c06\u4e0d\u518d\u5b58\u5728\uff0c\u8fd9\u8fd8\u662f\u56e0\u4e3a\u65f6\u949f\u88ab\u5185\u7f6e\u5165\u6570\u636e\u6d41\u4e2d\uff0c\u63a5\u6536\u65b9\u901a\u8fc7\u6062\u590d\u51fa\u6570\u636e\u6d41\u4e2d\u7684\u65f6\u949f\u6765\u8fdb\u884c\u6570\u636e\u91c7\u6837\uff0c\u81ea\u7136\u4e0d\u5b58\u5728\u65f6\u949f\u504f\u659c\u7684\u95ee\u9898\u3002\u6700\u540e\uff0c\u4fe1\u53f7\u504f\u659c\u7684\u95ee\u9898\u5728\u4e00\u4e2a\u901a\u9053\u5185\u88ab\u6d88\u9664\u4e86\uff0c\u56e0\u4e3a\u4e00\u4e2a\u901a\u9053\u4e00\u6b21\u53ea\u4f20\u8f93 1 \u6bd4\u7279\u6570\u636e\u3002\u5728\u591a\u901a\u9053\u8bbe\u8ba1\u4e2d\uff0c\u867d\u7136\u4fe1\u53f7\u504f\u659c\u7684\u95ee\u9898\u518d\u6b21\u51fa\u73b0\u4e86\uff0c\u4f46\u662f\u63a5\u6536\u7aef\u5c06\u81ea\u52a8\u5bf9\u5176\u8fdb\u884c\u7ea0\u6b63\uff0c\u5b83\u53ef\u4ee5\u5f88\u5927\u7a0b\u5ea6\u4e0a\u8865\u507f\u504f\u659c\u3002\u867d\u7136\u4e32\u884c\u8bbe\u8ba1\u514b\u670d\u4e86\u5e76\u884c\u6a21\u578b\u7684\u8bb8\u591a\u95ee\u9898\uff0c\u4f46\u662f\u4e32\u884c\u8bbe\u8ba1\u81ea\u8eab\u4e5f\u6709\u4e00\u7cfb\u5217\u7684\u590d\u6742\u95ee\u9898\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u7a0d\u540e\u5c06\u770b\u5230\uff0c\u5bf9\u8fd9\u4e9b\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u6613\u4e8e\u63a7\u5236\u7684\uff0c\u5e76\u53ef\u4ee5\u8ba9\u6211\u4eec\u505a\u5230\u9ad8\u901f\u7684\u3001\u53ef\u9760\u7684\u901a\u4fe1\u3002</p> <p>\u5e26\u5bbd. PCIe \u652f\u6301\u7684\u9ad8\u901f\uff0c\u591a\u901a\u9053\u7684\u94fe\u8def\u5e26\u6765\u4e86\u50b2\u4eba\u7684\u5e26\u5bbd\u6570\u503c\uff0c\u5982\u8868 2\u20111 \u6240\u793a\u3002\u8fd9\u4e9b\u6570\u5b57\u7684\u8ba1\u7b97\u90fd\u6765\u6e90\u4e8e\u6bd4\u7279\u7387\u4e0e\u603b\u7ebf\u7279\u6027\u3002\u5176\u4e2d\u4e00\u79cd\u7279\u6027\u4e0e\u5176\u4ed6\u8bb8\u591a\u4e32\u884c\u4f20\u8f93\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u90a3\u5c31\u662f PCIe \u7684\u524d\u4e24\u4ee3\u7248\u672c\u4e2d\u4f7f\u7528\u4e86\u88ab\u79f0\u4e3a 8b/10b \u7684\u7f16\u7801\u8fc7\u7a0b\uff0c\u8fd9\u79cd\u7f16\u7801\u8fc7\u7a0b\u4f1a\u6839\u636e 8 \u6bd4\u7279\u7684\u8f93\u5165\u800c\u751f\u6210 10 \u6bd4\u7279 \u7684\u8f93\u51fa\u3002\u5c3d\u7ba1\u8fd9\u6837\u505a\u4f1a\u5f15\u8d77\u4e00\u4e9b\u5f00\u9500\uff0c\u4f46\u662f\u6211\u4eec\u5c06\u4f1a\u5728\u540e\u9762\u8bb2\u5230\u6709\u51e0\u4e2a\u5f88\u597d\u7684\u7406\u7531\u652f\u6301\u6211\u4eec\u8fd9\u6837\u505a\u3002\u5bf9\u4e8e\u73b0\u5728\u6765\u8bf4\uff0c\u53ea\u9700\u8981\u77e5\u9053\u5bf9\u4e8e 8b/10b \u7f16\u7801\u6765\u8bf4\uff0c\u8981\u53d1\u9001 1 \u5b57\u8282\u7684\u6570\u636e\u5b9e\u9645\u9700\u8981\u4f20\u9001 10 \u6bd4\u7279\u3002</p> <p>\u7b2c\u4e00\u4ee3 PCIe\uff08\u79f0\u4e3a Gen1 \u6216\u8005 PCIe \u534f\u8bae\u89c4\u8303\u7248\u672c 1.x\uff09\u4e2d\uff0c\u6bd4\u7279\u7387\u4e3a 2.5GT/s\uff0c\u5c06\u5b83\u9664\u4ee5 10 \u5373\u53ef\u5f97\u77e5\u4e00\u4e2a\u901a\u9053\u7684\u901f\u7387\u5c06\u53ef\u4ee5\u8fbe\u5230 0.25GB/s\u3002\u56e0\u4e3a\u94fe\u8def\u53ef\u4ee5\u5728\u540c\u4e00\u65f6\u523b\u8fdb\u884c\u53d1\u9001\u548c\u63a5\u6536\uff0c\u56e0\u6b64\u805a\u5408\u5e26\u5bbd\u53ef\u4ee5\u8fbe\u5230\u8fd9\u4e2a\u6570\u503c\u7684\u4e24\u500d\uff0c\u5373\u6bcf\u4e2a\u901a\u9053\u8fbe\u5230 0.5GB/s\u3002\u7b2c\u4e8c\u4ee3 PCIe\uff08\u79f0\u4e3a Gen2 \u6216\u8005 PCIe 2.x\uff09\u4e2d\u5c06\u603b\u7ebf\u9891\u7387\u7ffb\u500d\uff0c\u8fd9\u4e5f\u4f7f\u5f97\u5b83\u7684\u5e26\u5bbd\u76f8\u8f83\u4e8e Gen1 \u7ffb\u500d\u3002</p> <p>\u7b2c\u4e09\u4ee3 PCIe\uff08\u79f0\u4e3a Gen3 \u6216\u8005 PCIe 3.0\uff09\u518d\u6b21\u8ba9\u5e26\u5bbd\u7ffb\u500d\uff0c\u4f46\u662f\u8fd9\u6b21\u534f\u8bae\u7684\u5236\u5b9a\u8005\u4eec\u5e76\u6ca1\u6709\u9009\u62e9\u5c06\u9891\u7387\u7ffb\u500d\u3002\u76f8\u53cd\uff0c\u51fa\u4e8e\u4e00\u4e9b\u539f\u56e0\uff08\u6211\u4eec\u7a0d\u540e\u5c06\u4f1a\u8fdb\u884c\u8ba8\u8bba\uff09\uff0c\u4ed6\u4eec\u4ec5\u5c06\u9891\u7387\u63d0\u5347\u5230 8GT/s\uff08Gen2\u4e2d\u662f 5GT/s\uff0c\u672a\u7ffb\u500d\uff09\uff0c\u5e76\u4e0d\u518d\u91c7\u7528 8b/10b \u7684\u7f16\u7801\u65b9\u5f0f\uff0c\u800c\u662f\u91c7\u7528\u4e86\u53e6\u4e00\u79cd\u7f16\u7801\u673a\u5236\uff0c\u5373 128b/130b \u7f16\u7801\uff08\u5173\u4e8e\u8fd9\u4e2a\u5185\u5bb9\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u9605\u8bfb\u201c\u7269\u7406\u5c42-\u903b\u8f91\uff08Gen 3\uff09\u201d\u7ae0\u8282\uff09\u3002\u8868 2\u20111 \u5217\u51fa\u4e86\u5f53\u524d\u51e0\u4ee3 PCIe \u7684\u5404\u79cd\u901a\u9053\u6570\u91cf\u60c5\u51b5\u4e0b\u7684\u5e26\u5bbd\uff0c\u5c55\u793a\u51fa\u4e86\u94fe\u8def\u5bf9\u5e94\u60c5\u51b5\u4e0b\u7684\u5cf0\u503c\u541e\u5410\u91cf\u3002</p> <p></p> <p>\u8868 2\u20111 PCIe Gen1,Gen2,Gen3 \u7684\u5404\u79cd\u94fe\u8def\u5bbd\u5ea6\u4e0b\u7684\u5e26\u5bbd\u6c47\u603b</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2122-pcie-pcie-bandwidth-calculation","title":"2.1.2.2   PCIe \u5e26\u5bbd\u8ba1\u7b97\u65b9\u6cd5 (PCIe Bandwidth Calculation)","text":"<p>\u8981\u8ba1\u7b97\u4e0a\u8ff0\u8868\u683c\u4e2d\u7684 PCIe \u5e26\u5bbd\u5927\u5c0f\uff0c\u53ef\u4ee5\u53c2\u7167\u5982\u4e0b\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002</p> <ul> <li> <p>Gen1 PCIe \u5e26\u5bbd =\uff082.5Gb/s x 2 directions\uff09/ 10bits per symbol = 0.5GB/s</p> </li> <li> <p>Gen2 PCIe \u5e26\u5bbd =\uff085.0Gb/s x 2 directions\uff09/ 10bits per symbol = 1.0GB/s</p> </li> </ul> <p>\u9700\u8981\u6ce8\u610f\uff0c\u4e0a\u8ff0\u8ba1\u7b97\u4e2d\uff0c\u6211\u4eec\u662f\u9664\u4ee5 10bits \u800c\u4e0d\u662f 8bits\uff0c\u8fd9\u662f\u56e0\u4e3a Gen1 \u548c Gen2 \u7684\u534f\u8bae\u4e2d\u8981\u6c42\u5c06\u5b57\u8282\u8fdb\u884c 8b/10b \u7f16\u7801\u540e\u8fdb\u884c\u6570\u636e\u5305\u7684\u4f20\u8f93\uff0c\u56e0\u6b64\u539f\u6570\u636e\u4e2d\u7684 1 \u5b57\u8282\u5728\u5b9e\u9645\u4f20\u8f93\u65f6\u5176\u5b9e\u662f\u9700\u8981\u4f20\u8f93 10 \u6bd4\u7279\u3002</p> <ul> <li>Gen3 PCIe \u5e26\u5bbd =\uff088.0Gb/s x 2 directions\uff09/ 8bits per byte = 2.0GB/s</li> </ul> <p>\u6ce8\u610f\u5230\u5728 Gen3 \u901f\u7387\u7684\u8ba1\u7b97\u4e2d\uff0c\u6211\u4eec\u9664\u4ee5\u7684\u662f 8bits \u800c\u4e0d\u518d\u662f 10bits \u4e86\uff0c\u8fd9\u662f\u56e0\u4e3a Gen3 \u4e2d\u4e0d\u518d\u4f7f\u7528 8b/10b \u7f16\u7801\u65b9\u5f0f\uff0c\u800c\u662f 128b/130b \u7f16\u7801\u65b9\u5f0f\u3002\u8fd9\u79cd\u7f16\u7801\u65b9\u5f0f\u6bcf 128\u4f4d \u5f15\u5165 2 \u6bd4\u7279\u5f00\u9500\uff0c\u8fd9\u4e2a\u5f00\u9500\u975e\u5e38\u5c0f\u4ee5\u81f3\u4e8e\u6211\u4eec\u6682\u4e14\u53ef\u4ee5\u5c06\u5b83\u5728\u6211\u4eec\u7684\u8ba1\u7b97\u4e2d\u5ffd\u7565\u3002</p> <p>\u4e0a\u8ff0\u4e09\u79cd\u65b9\u6cd5\u8ba1\u7b97\u51fa\u6765\u7684\u5e26\u5bbd\u53ea\u9700\u8981\u518d\u4e58\u4ee5\u94fe\u8def\u5bbd\u5ea6\u5373\u53ef\u5f97\u5230\u6574\u4e2a\u591a\u901a\u9053\u94fe\u8def\u7684\u94fe\u8def\u5e26\u5bbd\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2123-pcie-differential-signals","title":"2.1.2.3   PCIe \u7684\u5dee\u5206\u4fe1\u53f7 (Differential  Signals)","text":"<p>\u6bcf\u4e2a\u901a\u9053\u90fd\u4f7f\u7528\u5dee\u5206\u4fe1\u53f7\u8fdb\u884c\u4f20\u8f93\uff0c\u5dee\u5206\u4fe1\u53f7\u662f\u6307\u6bcf\u6b21\u4f20\u8f93\u4e00\u4e2a\u4fe1\u53f7\u65f6\u540c\u65f6\u53d1\u9001\u5b83\u7684\u6b63\u4fe1\u53f7\u548c\u8d1f\u4fe1\u53f7\uff08D+ \u548c D-\uff0c\u8fd9\u4e24\u79cd\u4fe1\u53f7\u632f\u5e45\u76f8\u540c\u76f8\u4f4d\u76f8\u53cd\uff09\uff0c\u5982\u56fe2\u20114 \u6240\u793a\u3002\u5f53\u7136\uff0c\u8fd9\u6837\u4f1a\u5c06\u5f15\u811a\u589e\u52a0\u4e00\u500d\uff0c\u4f46\u662f\u76f8\u5bf9\u4e8e\u5355\u7aef\u4fe1\u53f7\u800c\u8a00\uff0c\u5dee\u5206\u4fe1\u53f7\u5728\u9ad8\u901f\u4f20\u8f93\u4e0a\u7684\u4e24\u4e2a\u660e\u663e\u7684\u4f18\u70b9\u8db3\u4ee5\u62b5\u6d88\u5176\u5f15\u811a\u6570\u65b9\u9762\u7684\u4e0d\u8db3\uff1a\u5b83\u63d0\u9ad8\u4e86\u566a\u58f0\u5bb9\u9650\uff0c\u5e76\u964d\u4f4e\u4e86\u4fe1\u53f7\u7535\u538b\u3002</p> <p>\u5dee\u5206\u4fe1\u53f7\u7684\u63a5\u6536\u7aef\u5c06\u4f1a\u63a5\u6536\u8fd9\u4e00\u5bf9\u76f8\u4f4d\u76f8\u53cd\u7684\u4fe1\u53f7\uff0c\u7528\u6b63\u4fe1\u53f7\u7684\u7535\u538b\u51cf\u53bb\u5176\u53cd\u76f8\u4fe1\u53f7\u7684\u7535\u538b\uff0c\u5f97\u5230\u5b83\u4eec\u7684\u5dee\u503c\uff0c\u4ee5\u6b64\u6765\u5224\u5b9a\u8fd9\u4e2a\u6bd4\u7279\u7684\u903b\u8f91\u7535\u5e73\u503c\u3002\u5dee\u5206\u4f20\u8f93\u8bbe\u8ba1\u5185\u7f6e\u4e86\u6297\u566a\u58f0\u5e72\u6270\u7684\u8bbe\u8ba1\uff0c\u56e0\u4e3a\u5b83\u8981\u6c42\u6210\u5bf9\u7684\u5dee\u5206\u4fe1\u53f7\u5fc5\u987b\u4f4d\u4e8e\u6bcf\u4e2a\u8bbe\u5907\u7684\u76f8\u90bb\u7684\u5f15\u811a\u4e0a\uff0c\u5b83\u4eec\u7684\u8d70\u7ebf\u4e5f\u5fc5\u987b\u5f7c\u6b64\u975e\u5e38\u9760\u8fd1\uff0c\u4ee5\u4fdd\u6301\u5408\u9002\u7684\u4f20\u8f93\u7ebf\u963b\u6297\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u56e0\u7d20\u5728\u5f71\u54cd\u5dee\u5206\u5bf9\u4e2d\u7684\u4e00\u4e2a\u4fe1\u53f7\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u540c\u7b49\u7a0b\u5ea6\u4e14\u540c\u6837\u65b9\u5411\u5730\u5f71\u54cd\u5230\u53e6\u4e00\u4e2a\u4fe1\u53f7\u3002\u4f46\u662f\u63a5\u6536\u7aef\u6240\u5728\u610f\u7684\u662f\u5b83\u4eec\u7684\u5dee\u503c\uff0c\u800c\u8fd9\u4e9b\u566a\u58f0\u5e72\u6270\u5e76\u4e0d\u4f1a\u6539\u53d8\u8fd9\u4e2a\u5dee\u503c\uff0c\u6240\u4ee5\u5e26\u6765\u7684\u7ed3\u679c\u5c31\u662f\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u566a\u58f0\u5bf9\u4fe1\u53f7\u7684\u5f71\u54cd\u5e76\u4e0d\u4f1a\u5f15\u8d77\u63a5\u6536\u7aef\u5bf9\u6bd4\u7279\u503c\u7684\u9519\u8bef\u5224\u522b\u3002</p> <p></p> <p>\u56fe2\u20114 \u5dee\u5206\u4fe1\u53f7\u793a\u610f\u56fe</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2124-no-common-clock","title":"2.1.2.4   \u4e0d\u518d\u4f7f\u7528\u516c\u5171\u65f6\u949f (No Common Clock)","text":"<p>\u5728\u5148\u524d\u7684\u5185\u5bb9\u4e2d\u6709\u63d0\u5230\uff0cPCIe \u94fe\u8def\u4e0d\u518d\u50cf PCI \u4e00\u6837\u4f7f\u7528\u516c\u5171\u65f6\u949f\uff0c\u5b83\u4f7f\u7528\u4e86\u4e00\u4e2a\u6e90\u540c\u6b65\u6a21\u578b\uff0c\u8fd9\u610f\u5473\u7740\u9700\u8981\u7531\u53d1\u9001\u7aef\u7ed9\u63a5\u6536\u7aef\u63d0\u4f9b\u4e00\u4e2a\u65f6\u949f\u6765\u7528\u4e8e\u5bf9\u8f93\u5165\u6570\u636e\u8fdb\u884c\u9501\u5b58\u91c7\u6837\u3002\u5bf9\u4e8e PCIe \u94fe\u8def\u6765\u8bf4\uff0c\u5e76\u4e0d\u5305\u62ec\u8f93\u51fa\u65f6\u949f\u4fe1\u53f7\u3002\u76f8\u53cd\u5730\uff0c\u53d1\u9001\u7aef\u4f1a\u5c06\u65f6\u949f\u901a\u8fc7 8b/10b \u7f16\u7801\u6765\u5d4c\u5165\u6570\u636e\u6d41\u4e2d\uff0c\u7136\u540e\u63a5\u6536\u7aef\u5c06\u4f1a\u4ece\u6570\u636e\u6d41\u4e2d\u6062\u590d\u51fa\u8fd9\u4e2a\u65f6\u949f\uff0c\u5e76\u7528\u4e8e\u5bf9\u8f93\u5165\u6570\u636e\u8fdb\u884c\u9501\u5b58\u3002\u8fd9\u4e00\u8fc7\u7a0b\u542c\u8d77\u6765\u53ef\u80fd\u975e\u5e38\u795e\u79d8\uff0c\u4f46\u662f\u5176\u5b9e\u5f88\u7b80\u5355\u3002\u5728\u63a5\u6536\u7aef\u4e2d\uff0cPLL \u7535\u8def\uff08Phase-Locked Loop \u9501\u76f8\u73af\uff0c\u5982\u56fe2\u20115\uff09\u5c06\u8f93\u5165\u7684\u6bd4\u7279\u6d41\u4f5c\u4e3a\u53c2\u8003\u65f6\u949f\uff0c\u5e76\u5c06\u5176\u65f6\u5e8f\u6216\u8005\u76f8\u4f4d\u4e0e\u4e00\u4e2a\u8f93\u51fa\u65f6\u949f\u76f8\u6bd4\u8f83\uff0c\u8fd9\u4e2a\u8f93\u51fa\u65f6\u949f\u662f PLL \u6309\u7167\u6307\u5b9a\u9891\u7387\u4ea7\u751f\u7684\u65f6\u949f\u3002\u4e5f\u5c31\u662f\u8bf4 PLL \u81ea\u8eab\u4f1a\u4ea7\u751f\u4e00\u4e2a\u6307\u5b9a\u9891\u7387\u7684\u8f93\u51fa\u65f6\u949f\uff0c\u7136\u540e\u7528\u6bd4\u7279\u6d41\u4f5c\u4e3a\u7684\u53c2\u8003\u65f6\u949f\u4e0e\u81ea\u8eab\u4ea7\u751f\u7684\u8f93\u51fa\u65f6\u949f\u76f8\u6bd4\u8f83\u3002\u57fa\u4e8e\u6bd4\u8f83\u7684\u7ed3\u679c\uff0cPLL \u5c06\u4f1a\u5347\u9ad8\u6216\u8005\u964d\u4f4e\u8f93\u51fa\u65f6\u949f\u7684\u9891\u7387\uff0c\u76f4\u5230\u6240\u6bd4\u8f83\u7684\u53cc\u65b9\u8fbe\u5230\u5339\u914d\u3002\u6b64\u65f6\u5219\u53ef\u4ee5\u79f0 PLL \u5df2\u9501\u5b9a\uff0c\u4e14\u8f93\u51fa\u65f6\u949f\uff08\u6062\u590d\u65f6\u949f\uff09\u7684\u9891\u7387\u5df2\u7ecf\u7cbe\u786e\u5730\u4e0e\u53d1\u9001\u6570\u636e\u7684\u65f6\u949f\u76f8\u5339\u914d\u3002PLL \u5c06\u4f1a\u4e0d\u65ad\u5730\u8c03\u6574\u6062\u590d\u65f6\u949f\uff0c\u5feb\u901f\u8865\u507f\u4fee\u6b63\u7531\u6e29\u5ea6\u3001\u7535\u538b\u56e0\u7d20\u5bf9\u53d1\u9001\u7aef\u65f6\u949f\u9891\u7387\u9020\u6210\u7684\u5f71\u54cd\u3002</p> <p>\u5173\u4e8e\u65f6\u949f\u6062\u590d\uff0c\u6709\u4e00\u4ef6\u9700\u8981\u6ce8\u610f\u7684\u4e8b\u60c5\uff0cPLL \u9700\u8981\u8f93\u5165\u7aef\u7684\u4fe1\u53f7\u8df3\u53d8\u6765\u5b8c\u6210\u76f8\u4f4d\u6bd4\u8f83\u3002\u5982\u679c\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u6570\u636e\u90fd\u6ca1\u6709\u4efb\u4f55\u8df3\u53d8\uff0c\u90a3\u4e48 PLL \u7684\u6062\u590d\u65f6\u949f\u53ef\u80fd\u4f1a\u504f\u79bb\u6b63\u786e\u7684\u65f6\u949f\u9891\u7387\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u95ee\u9898\uff0c8b/10b \u7f16\u7801\u4e2d\u7684\u8bbe\u8ba1\u76ee\u6807\u4e4b\u4e00\u5c31\u662f\u8981\u786e\u4fdd\u6bd4\u7279\u6d41\u4e2d\u8fde\u7eed\u7684 1 \u6216\u8005 0 \u7684\u6570\u91cf\u4e0d\u80fd\u8d85\u8fc7 5 \u4e2a\uff08\u60f3\u83b7\u5f97\u66f4\u591a\u5173\u4e8e\u8fd9\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003\u201c8b/10b \u7f16\u7801\u201d\u4e00\u8282\uff09</p> <p></p> <p>\u56fe2\u20115 \u7b80\u5355\u7684\u9501\u76f8\u73af\u56fe\u793a</p> <p>\u4e00\u65e6\u65f6\u949f\u88ab\u6062\u590d\u51fa\u6765\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u9501\u5b58\u8f93\u5165\u6570\u636e\u6d41\u7684\u6bd4\u7279\uff0c\u5e76\u5c06\u9501\u5b58\u5230\u7684\u7ed3\u679c\u7ed9\u5230\u89e3\u4e32\u5668\u3002\u6709\u65f6\u5019\u5b66\u751f\u4eec\u53ef\u80fd\u60f3\u77e5\u9053\u8fd9\u4e2a\u6062\u590d\u65f6\u949f\u80fd\u5426\u4f5c\u4e3a\u63a5\u6536\u7aef\u7684\u6240\u6709\u903b\u8f91\u6240\u4f7f\u7528\u7684\u5de5\u4f5c\u65f6\u949f\uff0c\u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u662f\u201c\u4e0d\u884c\u201d\u3002\u4e00\u4e2a\u539f\u56e0\u662f\uff0c\u63a5\u6536\u7aef\u4e0d\u80fd\u6307\u671b\u7528\u4e8e\u6062\u590d\u51fa\u65f6\u949f\u7684\u6bd4\u7279\u6d41\u53c2\u8003\u65f6\u949f\u4e00\u76f4\u5b58\u5728\u4e14\u6d3b\u8dc3\uff0c\u56e0\u4e3a\u5f53\u94fe\u8def\u7684\u4f4e\u529f\u8017\u72b6\u6001\u5c31\u5305\u62ec\u4e86\u505c\u6b62\u6570\u636e\u4f20\u8f93\uff0c\u6b64\u65f6\u5fc5\u7136\u4e5f\u5c31\u65e0\u6cd5\u7ee7\u7eed\u6062\u590d\u65f6\u949f\u3002\u56e0\u6b64\uff0c\u63a5\u6536\u7aef\u5fc5\u987b\u8981\u6709\u81ea\u5df1\u672c\u5730\u751f\u6210\u7684\u5185\u90e8\u65f6\u949f\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2125-packet-based-protocol","title":"2.1.2.5   \u57fa\u4e8e\u6570\u636e\u5305\u7684\u534f\u8bae\u4f53\u7cfb (Packet-based Protocol)","text":"<p>\u5c06\u5e76\u884c\u4f20\u8f93\u8f6c\u53d8\u4e3a\u4e32\u884c\u4f20\u8f93\u53ef\u4ee5\u6781\u5927\u7684\u51cf\u5c11\u6570\u636e\u4f20\u8f93\u9700\u8981\u7684\u5f15\u811a\u6570\u91cf\u3002\u5982\u5176\u4ed6\u5927\u591a\u6570\u4e32\u884c\u4f20\u8f93\u534f\u8bae\u4e00\u6837\uff0cPCIe \u901a\u8fc7\u6d88\u9664\u4e86\u7edd\u5927\u90e8\u5206\u539f\u6765\u5e76\u884c\u603b\u7ebf\u4e2d\u5e38\u7528\u7684\u8fb9\u5e26\u63a7\u5236\u4fe1\u53f7\u6765\u51cf\u5c11\u4e86\u5f15\u811a\u6570\u91cf\u3002\u7136\u800c\uff0c\u5982\u679c\u6ca1\u6709\u63a7\u5236\u4fe1\u53f7\u6765\u6307\u793a\u88ab\u63a5\u6536\u7684\u4fe1\u606f\u7684\u7c7b\u578b\uff0c\u63a5\u6536\u7aef\u5982\u4f55\u77e5\u9053\u8f93\u5165\u7684\u6bd4\u7279\u662f\u4ec0\u4e48\u4fe1\u606f\u5462\uff1f\u56e0\u6b64\uff0c\u5728 PCIe \u4e2d\uff0c\u6240\u6709\u7684\u4e8b\u52a1\u5728\u53d1\u9001\u65f6\u90fd\u4f7f\u7528\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\u7ed3\u6784\uff0c\u79f0\u4e3a\u6570\u636e\u5305\uff08packets\uff09\u3002\u63a5\u6536\u7aef\u9700\u8981\u627e\u5230\u6570\u636e\u5305\u7684\u8fb9\u754c\uff0c\u5e76\u4e14\u77e5\u9053\u8fd9\u4e2a\u6570\u636e\u5305\u7684\u88ab\u5b9a\u4e49\u7684\u7ed3\u6784\u662f\u4ec0\u4e48\u6837\u5b50\u7684\uff08\u5373\u6570\u636e\u5305\u7684\u6a21\u677f\uff09\uff0c\u7136\u540e\u89e3\u6790\u6570\u636e\u5305\u7ed3\u6784\u6765\u83b7\u77e5\u5b83\u9700\u8981\u6267\u884c\u4ec0\u4e48\u64cd\u4f5c\u3002</p> <p>\u5173\u4e8e\u6570\u636e\u5305\u534f\u8bae\u4f53\u7cfb\u7684\u8be6\u7ec6\u4fe1\u606f\u5c06\u5728\u201cTLP \u5143\u7d20\u201d\u8fd9\u4e00\u7ae0\u8fdb\u884c\u5168\u9762\u8bb2\u89e3\uff0c\u4f46\u5728\u672c\u7ae0\u4e5f\u53ef\u4ee5\u627e\u5230\u5bf9\u5404\u79cd\u5305\u683c\u5f0f\u7684\u4ecb\u7ecd\u4ee5\u53ca\u4ed6\u4eec\u5404\u81ea\u7528\u9014\u7684\u6982\u8ff0\uff0c\u8bf7\u89c1\u201c\u6570\u636e\u94fe\u8def\u5c42\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#213-links-and-lanes","title":"2.1.3     \u94fe\u8def\u548c\u901a\u9053 (Links and Lanes)","text":"<p>\u5982\u5148\u524d\u7684\u5185\u5bb9\u6240\u63d0\u5230\uff0c\u4e24\u4e2a PCIe \u8bbe\u5907\u4e4b\u95f4\u7684\u7269\u7406\u8fde\u63a5\u88ab\u79f0\u4e3a\u4e00\u6761\u94fe\u8def\uff0c\u8fd9\u4e2a\u94fe\u8def\u7531\u8bb8\u591a\u901a\u9053\u6240\u6784\u6210\u3002\u5982\u56fe2\u20112\uff0c\u6bcf\u4e2a\u901a\u9053\u90fd\u542b\u6709\u4e00\u5bf9\u53d1\u9001\u5dee\u5206\u4fe1\u53f7\u5bf9\u548c\u4e00\u5bf9\u63a5\u6536\u5dee\u5206\u4fe1\u53f7\u5bf9\u3002\u8fd9\u6837\u7684\u4e00\u4e2a\u901a\u9053\u5df2\u7ecf\u8db3\u591f\u7528\u4e8e\u8bbe\u5907\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u4e0d\u9700\u8981\u5176\u4ed6\u989d\u5916\u7684\u4fe1\u53f7\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2131-scalable-performance","title":"2.1.3.1   \u53ef\u6269\u5c55\u7684\u6027\u80fd (Scalable Performance)","text":"<p>\u5c3d\u7ba1\u4e00\u4e2a\u901a\u9053\u5c31\u53ef\u4ee5\u6ee1\u8db3\u4e24\u4e2a\u8bbe\u5907\u4e4b\u95f4\u901a\u4fe1\u7684\u9700\u6c42\uff0c\u4f46\u662f\u4f7f\u7528\u66f4\u591a\u901a\u9053\u53ef\u4ee5\u63d0\u5347\u94fe\u8def\u7684\u4f20\u8f93\u6027\u80fd\uff0c\u8fd9\u4e2a\u6027\u80fd\u53d6\u51b3\u4e8e\u94fe\u8def\u7684\u4f20\u8f93\u901f\u7387\u4ee5\u53ca\u94fe\u8def\u5bbd\u5ea6\u3002\u4f8b\u5982\uff0c\u4f7f\u7528\u591a\u901a\u9053\u94fe\u8def\u53ef\u4ee5\u589e\u52a0\u6bcf\u4e2a\u65f6\u949f\u4f20\u8f93\u7684\u6bd4\u7279\u6570\u91cf\uff0c\u56e0\u6b64\u8fd9\u6837\u5c31\u53ef\u4ee5\u63d0\u5347\u5e26\u5bbd\u3002\u5982\u8868 2\u20111 \u6240\u63d0\u5230\uff0cPCIe \u534f\u8bae\u89c4\u8303\u652f\u6301\u4e00\u6761\u94fe\u8def\u4e2d\u542b\u6709\u7684\u901a\u9053\u6570\u76ee\u4e3a 2 \u7684\u5e42\uff0c\u6700\u591a 32 \u901a\u9053\u3002\u9664\u4e86 2 \u7684\u5e42\u4ee5\u5916\uff0cx12 \u94fe\u8def\u4e5f\u662f\u652f\u6301\u7684\uff0c\u8fd9\u53ef\u80fd\u662f\u4e3a\u4e86\u652f\u6301 InfiniBand \u7684 x12 \u94fe\u8def\uff0c\u5b83\u662f\u4e00\u79cd\u8f83\u65e9\u7684\u4e32\u884c\u8bbe\u8ba1\u3002PCIe \u8fd9\u79cd\u5141\u8bb8\u591a\u79cd\u94fe\u8def\u5bbd\u5ea6\u7684\u7279\u6027\uff0c\u4f7f\u5f97\u5e73\u53f0\u8bbe\u8ba1\u8005\u53ef\u4ee5\u5728\u6210\u672c\u548c\u6027\u80fd\u4e4b\u95f4\u505a\u51fa\u9002\u5f53\u7684\u6743\u8861\uff0c\u6839\u636e\u94fe\u8def\u4e2d\u901a\u9053\u7684\u6570\u91cf\u8f7b\u677e\u5730\u8fdb\u884c\u589e\u51cf\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2132-flexible-topology-options","title":"2.1.3.2   \u7075\u6d3b\u7684\u62d3\u6251\u7ed3\u6784\u9009\u62e9 (Flexible Topology Options)","text":"<p>\u4e00\u6761 PCIe \u94fe\u8def\u5fc5\u987b\u662f\u4e00\u4e2a\u70b9\u5bf9\u70b9\u7684\u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u50cf PCI \u4e00\u6837\u7684\u5171\u4eab\u603b\u7ebf\uff0c\u8fd9\u662f\u56e0\u4e3a PCIe \u4f7f\u7528\u7684\u94fe\u8def\u901f\u7387\u975e\u5e38\u9ad8\u3002\u7531\u4e8e\u4e00\u6761\u94fe\u8def\u53ea\u80fd\u8fde\u63a5\u4e24\u4e2a\u63a5\u53e3\uff0c\u56e0\u6b64\u9700\u8981\u4e00\u79cd\u6269\u5c55\u8fde\u63a5\u7684\u65b9\u6cd5\u6765\u6784\u5efa\u4e00\u4e2a\u4e0d\u7410\u788e\u7684\u7cfb\u7edf\uff0c\u8fd9\u91cc\u4e0d\u7410\u788e\u7684\u610f\u601d\u662f\u6307\u4e0d\u8fc7\u4e8e\u7ec6\u788e\u548c\u5197\u6742\uff0c\u4f8b\u5982\u82e5\u76f4\u63a5\u5bf9\u6240\u6709\u8bbe\u5907\u90fd\u91c7\u7528\u76f4\u63a5\u7684\u4e24\u4e24\u76f8\u8fde\uff0c\u90a3\u4e48\u4f1a\u4f7f\u5f97\u6574\u4e2a\u7cfb\u7edf\u5341\u5206\u5197\u6742\u7410\u788e\u3002\u8fd9\u79cd\u9700\u6c42\u5728 PCIe \u4e2d\u901a\u8fc7\u4ea4\u6362\u673a\u548c\u6865\u63a5\u6765\u5b9e\u73b0\uff0c\u8fd9\u4e24\u8005\u53ef\u4ee5\u7075\u6d3b\u7684\u6784\u5efa\u7cfb\u7edf\u62d3\u6251\u2014\u2014\u7cfb\u7edf\u4e2d\u5143\u7d20\u4e4b\u95f4\u7684\u8fde\u63a5\u96c6\u3002\u5bf9\u7cfb\u7edf\u4e2d\u4e00\u4e2a\u5143\u7d20\u7684\u5b9a\u4e49\u4ee5\u53ca\u4e00\u4e9b\u62d3\u6251\u7ed3\u6784\u7684\u4f8b\u5b50\u5c06\u5728\u4e0b\u9762\u7684\u5c0f\u8282\u4e2d\u7ed9\u51fa\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#214-pcie-some-definitions","title":"2.1.4     \u5173\u4e8e PCIe \u62d3\u6251\u7684\u4e00\u4e9b\u5b9a\u4e49 (Some Definitions)","text":"<p>\u5982\u56fe2\u20116 \u5c55\u793a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684 PCIe \u62d3\u6251\u793a\u4f8b\uff0c\u5b83\u5c06\u6709\u52a9\u4e8e\u6211\u4eec\u5bf9\u672c\u8282\u7684\u4e00\u4e9b\u5b9a\u4e49\u5185\u5bb9\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p></p> <p>\u56fe2\u20116 PCIe \u62d3\u6251\u793a\u4f8b</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2141-topology-characteristics","title":"2.1.4.1   \u62d3\u6251\u7279\u5f81 (Topology Characteristics)","text":"<p>\u5728\u56fe\u7684\u6700\u4e0a\u65b9\u662f\u4e00\u4e2a CPU \u3002\u8fd9\u91cc\u9700\u8981\u6307\u51fa\uff0cCPU \u88ab\u8ba4\u4e3a\u662f PCIe \u5c42\u6b21\u7ed3\u6784\u7684\u9876\u7aef\u3002\u5c31\u50cf PCI \u4e00\u6837\uff0cPCIe \u53ea\u5141\u8bb8\u7b80\u5355\u7684\u6811\u7ed3\u6784\uff0c\u8fd9\u610f\u5473\u7740\u4e0d\u5141\u8bb8\u51fa\u73b0\u5faa\u73af\u6216\u8005\u5176\u4ed6\u590d\u6742\u7684\u62d3\u6251\u7ed3\u6784\u3002\u8fd9\u6837\u505a\u7684\u539f\u56e0\u662f\u4e3a\u4e86\u4fdd\u6301\u4e0e PCI \u8f6f\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\uff0c\u56e0\u4e3a PCI \u8f6f\u4ef6\u4f7f\u7528\u7b80\u5355\u7684\u914d\u7f6e\u65b9\u6cd5\u6765\u8bb0\u5f55\u62d3\u6251\u7ed3\u6784\uff0c\u5b83\u5e76\u4e0d\u652f\u6301\u590d\u6742\u7684\u73af\u5883\u3002</p> <p>\u4e3a\u4e86\u4fdd\u6301\u8fd9\u79cd\u5411\u540e\u517c\u5bb9\u6027\uff0c\u8f6f\u4ef6\u5fc5\u987b\u80fd\u591f\u4ee5\u4e0e\u4ece\u524d\u4e00\u6837\u65b9\u5f0f\u4ea7\u751f\u914d\u7f6e\u5468\u671f\uff0c\u5e76\u4e14\u603b\u7ebf\u62d3\u6251\u7ed3\u6784\u4e5f\u5fc5\u987b\u4e0e\u4ee5\u524d\u4e00\u6837\u3002\u56e0\u6b64\uff0c\u8f6f\u4ef6\u5e0c\u671b\u627e\u5230\u7684\u6240\u6709\u914d\u7f6e\u5bc4\u5b58\u5668\u4f9d\u7136\u5b58\u5728\uff0c\u800c\u4e14\u5b83\u4eec\u7684\u884c\u4e3a\u65b9\u5f0f\u7b49\u4e5f\u4f9d\u7136\u4e0e\u4ece\u524d\u76f8\u540c\u3002\u6211\u4eec\u5c06\u7a0d\u665a\u4e9b\u5728\u56de\u8fc7\u5934\u6765\u8ba8\u8bba\u8fd9\u4e00\u5757\u7684\u5185\u5bb9\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u5148\u5b9a\u4e49\u4e00\u4e9b\u672f\u8bed\u6982\u5ff5\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2142-root-complex","title":"2.1.4.2   \u6839\u7ec4\u4ef6 (Root Complex)","text":"<p>CPU \u4e0e PCIe \u603b\u7ebf\u4e4b\u95f4\u7684\u63a5\u53e3\u53ef\u80fd\u5305\u542b\u4e00\u7cfb\u5217\u7684\u7ec4\u4ef6\uff08\u5904\u7406\u5668\u63a5\u53e3\uff0cDRAM \u63a5\u53e3\u7b49\u7b49\uff09\uff0c\u751a\u81f3\u662f\u5305\u542b\u591a\u4e2a\u82af\u7247\u3002\u5c06\u8fd9\u4e9b\u7ec4\u4ef6\u5408\u8d77\u6765\uff0c\u79f0\u8fd9\u4e00\u7ec4\u7ec4\u4ef6\u4e3a\u6839\u7ec4\u4ef6\uff08Root Complex, RC, Root\uff09\u3002RC \u5b58\u5728\u4e8e PCI \u6811\u72b6\u62d3\u6251\u7684\u201c\u6839\u90e8\u201d\uff0c\u5e76\u4ee3\u8868 CPU \u4e0e\u7cfb\u7edf\u7684\u5176\u4f59\u90e8\u5206\u901a\u4fe1\u3002\u4f46\u662f\uff0cPCIe \u534f\u8bae\u89c4\u8303\u5e76\u6ca1\u6709\u5f88\u4ed4\u7ec6\u7684\u5bf9 RC \u8fdb\u884c\u5b9a\u4e49\uff0c\u800c\u662f\u7ed9\u51fa\u4e86\u4e00\u4e2a RC \u5fc5\u9700\u529f\u80fd\u4e0e\u53ef\u9009\u529f\u80fd\u7684\u5217\u8868\u3002\u4ece\u5e7f\u4e49\u4e0a\u8bf4\uff0c\u6839\u7ec4\u4ef6\u53ef\u4ee5\u88ab\u7406\u89e3\u4e3a\u7cfb\u7edf CPU \u4e0e PCIe \u62d3\u6251\u4e4b\u95f4\u7684\u63a5\u53e3\uff0c\u8fd9\u4e2a PCIe \u7aef\u53e3\uff0c\u5373 RC\uff0c\u5728\u914d\u7f6e\u7a7a\u95f4\u4e2d\u88ab\u6807\u8bb0\u4e3a\u201c\u6839\u7aef\u53e3\u201d\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2143-switches-and-bridges","title":"2.1.4.3   \u4ea4\u6362\u673a\u4e0e\u6865 (Switches and Bridges)","text":"<p>\u4ea4\u6362\u673a\u63d0\u4f9b\u4e86\u6247\u51fa\u4ee5\u53ca\u805a\u5408\u80fd\u529b\uff0c\u4f7f\u5f97\u5355\u4e2a PCIe \u7aef\u53e3\u4e0a\u53ef\u4ee5\u8fde\u63a5\u66f4\u591a\u7684\u8bbe\u5907\u3002\u5b83\u626e\u6f14\u6570\u636e\u5305\u8def\u7531\u5668\u7684\u89d2\u8272\uff0c\u53ef\u4ee5\u6839\u636e\u6240\u7ed9\u6570\u636e\u5305\u7684\u5730\u5740\u6216\u8005\u5176\u4ed6\u8def\u7531\u4fe1\u606f\u6765\u8bc6\u522b\u8fd9\u4e2a\u6570\u636e\u5305\u8981\u8d70\u54ea\u6761\u8def\u5f84\u3002</p> <p>\u6865\u63d0\u4f9b\u4e86\u4e00\u4e2a\u901a\u5f80\u5176\u4ed6\u603b\u7ebf\u7684\u63a5\u53e3\uff0c\u4f8b\u5982 PCI \u6216\u8005 PCI-X\uff0c\u751a\u81f3\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u7684 PCIe \u603b\u7ebf\u3002\u56fe2\u20116 \u4e2d\u5c55\u793a\u7684\u6865\u6709\u65f6\u88ab\u79f0\u4e3a\u201c\u524d\u5411\u6865\u201d\uff0c\u5b83\u4f7f\u5f97\u4e00\u4e2a\u65e7\u7684 PCI \u6216\u8005 PCI-X \u677f\u5361\u53ef\u4ee5\u63d2\u5165\u4e00\u4e2a\u65b0\u7cfb\u7edf\u4e2d\uff08PCIe \u7cfb\u7edf\uff09\u3002\u4e0e\u524d\u5411\u6865\u76f8\u53cd\u7c7b\u578b\u7684\u6865\u79f0\u4e3a\u201c\u53cd\u5411\u6865\u201d\uff0c\u5b83\u4f7f\u5f97\u65b0\u7684PCIe \u677f\u5361\u53ef\u4ee5\u63d2\u5165\u5230\u65e7\u7684 PCI \u7cfb\u7edf\u4e2d\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2144-native-pcie-endpoints-and-legacy-pcie-endpoints","title":"2.1.4.4   \u539f\u751f\u4e0e\u4f20\u7edf\u7aef\u70b9 (Native PCIe Endpoints and Legacy PCIe Endpoints)","text":"<p>\u7aef\u70b9\u662f PCIe \u62d3\u6251\u4e2d\u7684\u65e2\u4e0d\u662f\u4ea4\u6362\u673a\u4e5f\u4e0d\u662f\u6865\u7684\u8bbe\u5907\uff0c\u5b83\u4eec\u53ef\u4ee5\u4f5c\u4e3a\u603b\u7ebf\u4e0a\u4e8b\u52a1\u7684\u53d1\u8d77\u8005\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e8b\u52a1\u7684\u5b8c\u6210\u8005\u3002\u7aef\u70b9\u5b58\u5728\u4e8e\u6811\u72b6\u62d3\u6251\u7684\u5206\u652f\u7684\u5e95\u90e8\uff0c\u4ec5\u5b9e\u73b0\u4e00\u4e2a\u4e0a\u884c\u7aef\u53e3\uff08Upstream Port\uff0c\u4e0e RC \u7684\u8fde\u63a5\u65b9\u5411\uff09\uff0c\u8fd9\u91cc\u7684\u4e0a\u884c\u6307\u7684\u662f\u62d3\u6251\u7ed3\u6784\u7684\u5411\u4e0a\uff0c\u8868\u793a\u7aef\u70b9\u5df2\u7ecf\u662f\u6811\u7684\u5206\u652f\u7684\u7aef\u70b9\uff0c\u4e0d\u518d\u4ea7\u751f\u4e0b\u7ea7\u5206\u652f\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u4e00\u4e2a\u4ea4\u6362\u673a\u53ef\u4ee5\u6709\u51e0\u4e2a\u4e0b\u884c\u7aef\u53e3\uff08Downstream Port\uff09\u3002</p> <p>\u7528\u4e8e\u8001\u5f0f\u603b\u7ebf\uff08\u4f8b\u5982 PCI-X\uff09\u7684\u8bbe\u5907\uff0c\u5982\u4eca\u62e5\u6709\u4e86\u53ef\u4f9b\u5b83\u4eec\u4f7f\u7528\u7684 PCIe \u63a5\u53e3\uff0c\u8fd9\u79cd PCIe \u63a5\u53e3\u5c06\u5728\u914d\u7f6e\u5bc4\u5b58\u5668\u4e2d\u5c06\u81ea\u8eab\u6807\u8bc6\u4e3a\u201c\u4f20\u7edf PCIe \u7aef\u70b9\u201d\u3002\u5b83\u4eec\u4f7f\u7528\u4e86\u5728 PCIe \u8bbe\u8ba1\u4e2d\u88ab\u7981\u6b62\u7684\u4e1c\u897f\uff0c\u4f8b\u5982 IO \u7a7a\u95f4\u3001\u652f\u6301 IO \u4e8b\u52a1\u4ee5\u53ca\u652f\u6301\u9501\u5b9a\u8bf7\u6c42\u3002\u4e0e\u4e4b\u76f8\u53cd\uff0c\u201c\u539f\u751f PCIe \u7aef\u70b9\u201d\u662f\u4ece\u4e00\u5f00\u59cb\u5c31\u88ab\u8bbe\u8ba1\u7528\u6765\u5728 PCIe \u7cfb\u7edf\u4e2d\u4f7f\u7528\u7684\uff0c\u8fd9\u533a\u522b\u4e8e\u5728\u65e7\u7684 PCI \u8bbe\u5907\u4e0a\u6dfb\u52a0 PCIe \u63a5\u53e3\u3002\u539f\u751f PCIe \u7aef\u70b9\u8bbe\u5907\u662f\u5185\u5b58\u6620\u5c04\u8bbe\u5907\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2145-software-compatibility-characteristics","title":"2.1.4.5   \u8f6f\u4ef6\u517c\u5bb9\u7279\u6027 (Software Compatibility Characteristics)","text":"<p>\u4e00\u79cd\u4fdd\u6301\u8f6f\u4ef6\u517c\u5bb9\u6027\u7684\u65b9\u6cd5\u662f\u4fdd\u6301\u7aef\u70b9\u548c\u6865\u7684\u914d\u7f6e\u9996\u90e8\uff08Header\uff09\u4e0e PCI \u4e00\u81f4\uff0c\u5982\u56fe2\u20117 \u6240\u793a\u3002</p> <p></p> <p>\u56fe2\u20117 \u914d\u7f6e\u9996\u90e8</p> <p>\u6709\u4e00\u70b9\u4e0d\u540c\uff0c\u73b0\u5728 PCIe \u4e2d\u7684\u6865\u7ecf\u5e38\u4f1a\u88ab\u6574\u5408\u8fdb\u4ea4\u6362\u673a\u548c\u6839\u7ec4\u4ef6\uff0c\u4f46\u662f\u9057\u7559\u7684 PCI \u8f6f\u4ef6\u65e0\u9700\u5173\u6ce8\u8fd9\u79cd\u533a\u522b\uff0c\u5b83\u53ea\u628a\u8fd9\u4e9b\u5185\u542b\u6865\u7684\u8bbe\u5907\u7b80\u5355\u7684\u5f53\u505a\u6865\u3002\u5728\u8fd9\u91cc\u6211\u4eec\u5148\u5bf9\u4e00\u4e9b\u6982\u5ff5\u8fdb\u884c\u719f\u6089\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u4f1a\u5728\u8fd9\u91cc\u8ba8\u8bba\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u7ec6\u8282\u3002\u914d\u7f6e\u662f\u4e00\u4e2a\u76f8\u5f53\u5927\u7684\u4e3b\u9898\uff0c\u5173\u4e8e\u5b83\u7684\u5177\u4f53\u4ecb\u7ecd\u5c06\u5728\u201c\u914d\u7f6e\u7efc\u8ff0\u201d\u8fd9\u4e00\u8282\u8fdb\u884c\u3002</p> <p>\u4e3a\u4e86\u4e3e\u4f8b\u8bf4\u660e PCIe \u7cfb\u7edf\u5728\u8f6f\u4ef6\u4e2d\u7684\u5c55\u73b0\u5f62\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u53c2\u8003\u56fe2\u20118 \u4e2d\u6240\u5c55\u793a\u7684\u62d3\u6251\u7ed3\u6784\u7684\u4f8b\u5b50\u3002\u50cf\u4e4b\u524d\u6240\u8bf4\u7684\u4e00\u6837\uff0cRC \u4f4d\u4e8e\u6574\u4e2a\u5c42\u6b21\u7ed3\u6784\u7684\u9876\u7aef\u3002RC \u81ea\u8eab\u7684\u5185\u90e8\u53ef\u4ee5\u975e\u5e38\u590d\u6742\uff0c\u4f46\u662f\u5b83\u901a\u5e38\u4f1a\u5b9e\u73b0\u4e00\u4e2a\u5185\u90e8\u603b\u7ebf\u7ed3\u6784\u4ee5\u53ca\u4e00\u4e9b\u6865\u63a5\u7ed3\u6784\uff0c\u4ee5\u4fbf\u5c06\u62d3\u6251\u6247\u51fa\u5230\u51e0\u4e2a\u7aef\u53e3\u3002RC \u7684\u5185\u90e8\u603b\u7ebf\u5c06\u88ab\u914d\u7f6e\u8f6f\u4ef6\u89c6\u4f5c PCI \u603b\u7ebf 0\uff0c\u4e14 RC \u4e0a\u8fd9\u51e0\u4e2a PCIe \u7aef\u53e3\u5c06\u88ab\u89c6\u4f5c\u662f PCI-to-PCI \u6865\u3002\u8fd9\u79cd\u5185\u90e8\u7ed3\u6784\u5176\u5b9e\u5e76\u4e0d\u662f\u4e00\u4e2a\u5b9e\u9645\u7684 PCI \u603b\u7ebf\uff0c\u4f46\u662f\u5b83\u5728\u8f6f\u4ef6\u4e2d\u770b\u8d77\u6765\u5c31\u662f\u8fd9\u79cd\u7ed3\u6784\u3002\u56e0\u4e3a\u8fd9\u4e2a\u603b\u7ebf\u662f\u5728 RC \u5185\u90e8\u7684\uff0c\u6240\u4ee5\u5b83\u5b9e\u9645\u7684\u903b\u8f91\u8bbe\u8ba1\u5e76\u4e0d\u9700\u8981\u9075\u5faa\u4efb\u4f55\u7684\u6807\u51c6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7531\u4f9b\u5e94\u5546\u6765\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u3002</p> <p></p> <p>\u56fe2\u20118 \u62d3\u6251\u7ed3\u6784\u793a\u4f8b</p> <p>\u7c7b\u4f3c\u7684\uff0cPCIe \u4ea4\u6362\u673a\u7684\u5185\u90e8\u7ed3\u6784\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\uff0c\u5c31\u662f\u7b80\u5355\u5730\u51e0\u4e2a\u6865\u5171\u4eab\u4e00\u6761\u516c\u5171\u603b\u7ebf\uff0c\u5982\u56fe2\u20119 \u6240\u793a\u3002\u8fd9\u6837\u505a\u7684\u4e3b\u8981\u4f18\u70b9\u5c31\u662f\u4f7f\u5f97\u4e8b\u52a1\u7684\u8def\u7531\u65b9\u6cd5\u80fd\u591f\u4e0e PCI \u4e00\u81f4\u3002</p> <p>\u679a\u4e3e\uff08Enumeration\uff09\u662f\u914d\u7f6e\u8f6f\u4ef6\u7528\u6765\u53d1\u73b0\u7cfb\u7edf\u62d3\u6251\u7ed3\u6784\uff0c\u5e76\u5206\u914d\u603b\u7ebf\u53f7\u548c\u7cfb\u7edf\u8d44\u6e90\u7684\u8fc7\u7a0b\uff0c\u5b83\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e5f\u4e0e PCI \u4e2d\u76f8\u540c\u3002\u5728\u7a0d\u540e\u7684\u5185\u5bb9\u4e2d\u6211\u4eec\u5c06\u901a\u8fc7\u4e00\u4e9b\u4f8b\u5b50\u6765\u8bb2\u8ff0\u679a\u4e3e\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\u4e00\u65e6\u679a\u4e3e\u5b8c\u6210\uff0c\u7cfb\u7edf\u4e2d\u7684\u603b\u7ebf\u53f7\u5c31\u5c06\u6309\u7167\u56fe2\u20119 \u6240\u793a\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u914d\u3002</p> <p></p> <p>\u56fe2\u20119 \u7cfb\u7edf\u679a\u4e3e\u7ed3\u679c\u7684\u793a\u4f8b</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2146-system-examples","title":"2.1.4.6   \u7cfb\u7edf\u793a\u4f8b (System Examples)","text":"<p>\u5982\u56fe2\u201110 \u4e2d\u4e3e\u4f8b\u8bf4\u660e\u4e86\u4e00\u4e2a\u57fa\u4e8e PCIe \u7684\u7cfb\u7edf\uff0c\u5b83\u88ab\u8bbe\u8ba1\u7528\u4e8e\u4e00\u4e9b\u4f4e\u6210\u672c\u5e94\u7528\u6bd4\u5982\u6d88\u8d39\u7ea7\u53f0\u5f0f\u8ba1\u7b97\u673a\u3002\u6709\u4e00\u4e9b PCIe \u7aef\u53e3\u5b9e\u73b0\u65f6\u9644\u5e26\u4e86\u4e00\u4e9b\u677f\u5361\u63d2\u69fd\uff0c\u4f46\u662f\u57fa\u672c\u7684\u6846\u67b6\u4e0e\u8001\u5f0f\u7684 PCI \u7cfb\u7edf\u5e76\u6ca1\u6709\u592a\u5927\u533a\u522b\u3002</p> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5982\u56fe2\u201111 \u6240\u793a\u7684\u9ad8\u7aef\u7684\u670d\u52a1\u5668\u7cfb\u7edf\u5c55\u793a\u4e86\u4e00\u4e9b\u5185\u7f6e\u5728\u7cfb\u7edf\u7684\u7528\u4e8e\u8fde\u63a5\u5176\u4ed6\u7f51\u7edc\u7684\u63a5\u53e3\u3002\u5728\u65e9\u671f PCIe \u4e2d\uff0c\u6709\u4eba\u66fe\u8003\u8651\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7edc\u6765\u8fd0\u884c\uff0c\u7528\u6765\u53d6\u4ee3\u90a3\u4e9b\u65e7\u7684\u6a21\u578b\u3002\u6bd5\u7adf\uff0c\u5982\u679c PCIe \u5728\u5927\u4f53\u4e0a\u662f\u5176\u4ed6\u7f51\u7edc\u534f\u8bae\u7684\u7b80\u5316\u7248\u672c\uff0c\u6216\u8bb8\u5b83\u4e5f\u80fd\u6ee1\u8db3\u6240\u6709\u9700\u6c42\u3002\u7531\u4e8e\u5404\u79cd\u5404\u6837\u7684\u539f\u56e0\uff0c\u8fd9\u4e00\u6982\u5ff5\u4ece\u6765\u6ca1\u6709\u771f\u6b63\u5f97\u5230\u5927\u529b\u53d1\u5c55\uff0c\u57fa\u4e8e PCIe \u7684\u7cfb\u7edf\u901a\u5e38\u4ecd\u7136\u9700\u8981\u4f7f\u7528\u5176\u4ed6\u7684\u534f\u8bae\u6765\u8fde\u63a5\u5230\u5916\u90e8\u7f51\u7edc\u3002</p> <p>\u8fd9\u4e5f\u7ed9\u4e86\u6211\u4eec\u4e00\u4e2a\u673a\u4f1a\u6765\u91cd\u65b0\u5ba1\u89c6\u4e00\u4e2a\u95ee\u9898\uff0cRC \u662f\u7531\u4ec0\u4e48\u7ec4\u6210\u7684\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u88ab\u6807\u8bc6\u4e3a\u201c\u82f1\u7279\u5c14\u5904\u7406\u5668\u201d\u7684\u65b9\u5757\u5305\u542b\u4e86\u8bb8\u591a\u7ec4\u4ef6\uff0c\u5927\u591a\u6570\u73b0\u4ee3\u7684 CPU \u67b6\u6784\u90fd\u662f\u5982\u6b64\u3002\u8fd9\u4e2a\u5904\u7406\u5668\u5305\u542b\u4e86\u4e00\u4e2a\u7528\u4e8e\u8bbf\u95ee\u56fe\u5f62\u8bbe\u5907\uff08\u4f8b\u5982\u663e\u5361\uff09\u7684 x16 PCIe \u7aef\u53e3\uff0c\u4ee5\u53ca\u4e24\u6761 DRAM \u901a\u9053\uff0c\u8fd9\u4e24\u6761 DRAM \u901a\u9053\u610f\u5473\u7740\u5185\u5b58\u63a7\u5236\u5668\u4ee5\u53ca\u4e00\u4e9b\u8def\u7531\u903b\u8f91\u5df2\u7ecf\u88ab\u96c6\u6210\u5230 CPU \u5c01\u88c5\u4e2d\u3002\u603b\u7684\u6765\u8bf4\uff0c\u8fd9\u4e9b\u8d44\u6e90\u901a\u5e38\u88ab\u79f0\u4e3a\u201c\u975e\u6838\u5fc3\u201d\u8d44\u6e90\uff0c\u8fd9\u6837\u7684\u79f0\u547c\u7528\u4e8e\u5c06\u4ed6\u4eec\u4e0e CPU \u5c01\u88c5\u4e2d\u7684\u51e0\u4e2a CPU \u6838\u5fc3\u533a\u5206\u5f00\u6765\u3002\u6b64\u524d\uff0c\u6211\u4eec\u63cf\u8ff0\u8fc7 RC \u662f CPU \u4e0e PCIe \u62d3\u6251\u76f8\u8fde\u63a5\u7684\u63a5\u53e3\uff0c\u8fd9\u610f\u5473\u7740\u5728 CPU \u5c01\u88c5\u4e2d\u5fc5\u987b\u542b\u6709 RC \u7684\u4e00\u90e8\u5206\u3002\u6b63\u5982\u56fe2\u201111 \u4e2d\u865a\u7ebf\u6240\u6846\u51fa\u7684\uff0cRC \u7531\u591a\u4e2a\u7ec4\u4ef6\u7684\u4e00\u90e8\u5206\u5171\u540c\u7ec4\u6210\u3002\u8fd9\u79cd RC \u7684\u7ec4\u6210\u65b9\u5f0f\u53ef\u80fd\u5c06\u4f1a\u662f\u672a\u6765\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u7cfb\u7edf\u7684\u8bbe\u8ba1\u65b9\u5f0f\u3002</p> <p></p> <p>\u56fe2\u201110 \u4f4e\u6210\u672c\u7684 PCIe \u7cfb\u7edf</p> <p></p> <p>\u56fe2\u201111 \u670d\u52a1\u5668 PCIe \u7cfb\u7edf</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#22-introduction-to-device-layers","title":"2.2 \u8bbe\u5907\u5c42\u6b21\u4ecb\u7ecd (Introduction to Device Layers)","text":"<p>\u5982\u56fe2\u201112 \u6240\u793a\uff0cPCIe \u5b9a\u4e49\u4e86\u4e00\u79cd\u5206\u5c42\u7684\u4f53\u7cfb\u7ed3\u6784\u3002\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u4e9b\u5c42\u5728\u903b\u8f91\u4e0a\u662f\u76f8\u4e92\u72ec\u7acb\u7684\u90e8\u5206\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5404\u81ea\u90fd\u6709\u4e00\u4e2a\u7528\u4e8e\u53d1\u51fa\u4fe1\u606f\u6d41\u7684\u53d1\u9001\u7aef\u548c\u4e00\u4e2a\u63a5\u6536\u4fe1\u606f\u6d41\u7684\u63a5\u6536\u7aef\u3002\u8fd9\u79cd\u5206\u5c42\u7684\u8bbe\u8ba1\u65b9\u6cd5\u5bf9\u786c\u4ef6\u8bbe\u8ba1\u8005\u6765\u8bf4\u6709\u4e0d\u5c11\u7684\u4f18\u70b9\uff0c\u56e0\u4e3a\u5982\u679c\u5728\u8bbe\u8ba1\u4e2d\u5bf9\u903b\u8f91\u8fdb\u884c\u4e86\u4ed4\u7ec6\u7684\u5212\u5206\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728\u4ee5\u540e\u5347\u7ea7\u5230\u65b0\u7684\u534f\u8bae\u89c4\u8303\u7248\u672c\u65f6\u4ec5\u6539\u53d8\u539f\u8bbe\u8ba1\u4e2d\u7684\u67d0\u4e00\u5c42\u5373\u53ef\uff0c\u800c\u4e0d\u4f1a\u5f71\u54cd\u6216\u8005\u53d8\u52a8\u5176\u5b83\u5c42\u3002\u867d\u7136\u5982\u6b64\uff0c\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e9b\u5c42\u53ea\u662f\u5b9a\u4e49\u4e86\u63a5\u53e3\u7684\u5de5\u4f5c\u804c\u8d23\uff0c\u800c\u5b9e\u9645\u8bbe\u8ba1\u5e76\u4e0d\u8981\u6c42\u4e3a\u4e86\u7b26\u5408\u89c4\u8303\u800c\u5c06\u8bbe\u8ba1\u4e25\u683c\u6309\u7167\u5c42\u7ea7\u6765\u5206\u6210\u51e0\u4e2a\u90e8\u5206\u3002\u672c\u8282\u7684\u76ee\u7684\u5728\u4e8e\u63cf\u8ff0\u5404\u4e2a\u5c42\u7684\u529f\u80fd\u804c\u8d23\uff0c\u4ee5\u53ca\u63cf\u8ff0\u5b8c\u6210\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u65f6\u7684\u4e8b\u4ef6\u6d41\u7a0b\u3002</p> <p></p> <p>\u56fe2\u201112 PCI Express \u8bbe\u5907\u5c42\u6b21\u793a\u610f\u56fe</p> <p>\u56fe2\u201112 \u6240\u5c55\u793a\u7684 PCIe \u8bbe\u5907\u5185\u90e8\u5c42\u6b21\u5305\u62ec\uff1a</p> <ul> <li> <p>\u8bbe\u5907\u6838\u5fc3\u5c42\u4ee5\u53ca\u5b83\u4e0e\u4e8b\u52a1\u5c42\u7684\u63a5\u53e3\u3002\u8bbe\u5907\u6838\u5fc3\u5c42\u5b9e\u73b0\u8bbe\u5907\u7684\u4e3b\u8981\u529f\u80fd\u3002\u5982\u679c\u8bbe\u5907\u662f\u4e00\u4e2a\u7aef\u70b9\uff0c\u90a3\u4e48\u5b83\u6700\u591a\u53ef\u4ee5\u5305\u542b 8 \u4e2a\u529f\u80fd\uff08function\uff09\uff0c\u6bcf\u4e2a\u529f\u80fd\u5b9e\u73b0\u81ea\u5df1\u7684\u914d\u7f6e\u7a7a\u95f4\u3002\u5982\u679c\u8bbe\u5907\u662f\u4e00\u4e2a\u4ea4\u6362\u673a\uff0c\u90a3\u4e48\u5b83\u7684\u6838\u5fc3\u7531\u6570\u636e\u5305\u8def\u7531\u903b\u8f91\u548c\u4e3a\u4e86\u5b9e\u73b0\u8def\u7531\u7684\u5185\u90e8\u603b\u7ebf\u6784\u6210\u3002\u5982\u679c\u8bbe\u5907\u662f\u4e00\u4e2a RC\uff0c\u90a3\u4e48\u5176\u6838\u5fc3\u4f1a\u5b9e\u73b0\u4e00\u4e2a\u865a\u62df\u7684 PCI \u603b\u7ebf 0\uff0c\u5728\u8fd9\u4e2a\u865a\u62df\u7684 PCI \u603b\u7ebf 0\u4e2d\u5b58\u5728\u7740\u6240\u6709\u7684\u82af\u7247\u7ec4\u5d4c\u5165\u5f0f\u7aef\u70b9\u4ee5\u53ca\u865a\u62df\u6865\u3002</p> </li> <li> <p>\u4e8b\u52a1\u5c42\u3002\u4e8b\u52a1\u5c42\u8d1f\u8d23\u5728\u53d1\u9001\u7aef\u4ea7\u751f TLP\uff08Transaction Layer Packet\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\uff0c\u5728\u63a5\u6536\u7aef\u5bf9 TLP \u8fdb\u884c\u8bd1\u7801\u3002\u8fd9\u4e00\u5c42\u4e5f\u8d1f\u8d23 QoS\uff08Quality of Service\uff0c\u670d\u52a1\u8d28\u91cf\uff09\u3001\u6d41\u91cf\u63a7\u5236\u4ee5\u53ca\u4e8b\u52a1\u6392\u5e8f\u3002\u6240\u6709\u7684\u8fd9\u56db\u4e2a\u4e8b\u52a1\u5c42\u7684\u529f\u80fd\u5c06\u5728\u672c\u4e66\u7684\u7b2c\u4e8c\u90e8\u5206\u8fdb\u884c\u8bb2\u89e3\u3002</p> </li> <li> <p>\u6570\u636e\u94fe\u8def\u5c42\u3002\u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8d23\u5728\u53d1\u9001\u7aef\u4ea7\u751f DLLP\uff08Data Link Layer Packet\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\uff0c\u5728\u63a5\u6536\u7aef\u5bf9 DLLP \u8fdb\u884c\u8bd1\u7801\u3002\u8fd9\u4e00\u5c42\u4e5f\u8d1f\u8d23\u94fe\u8def\u9519\u8bef\u68c0\u6d4b\u4ee5\u53ca\u4fee\u6b63\uff0c\u8fd9\u4e2a\u6570\u636e\u94fe\u8def\u5c42\u529f\u80fd\u88ab\u79f0\u4e3a Ack/Nak \u534f\u8bae\u3002\u8fd9\u4e24\u4e2a\u6570\u636e\u94fe\u8def\u5c42\u529f\u80fd\u4f1a\u5728\u672c\u4e66\u7684\u7b2c\u4e09\u90e8\u5206\u8fdb\u884c\u8bb2\u89e3\u3002</p> </li> <li> <p>\u7269\u7406\u5c42\u3002\u7269\u7406\u5c42\u8d1f\u8d23\u5728\u53d1\u9001\u7aef\u4ea7\u751f\u5b57\u7b26\u5e8f\u5217\u5305\uff0c\u5728\u63a5\u6536\u7aef\u5bf9\u5b57\u7b26\u5e8f\u5217\u5305\u8fdb\u884c\u8bd1\u7801\u3002\u8fd9\u4e00\u5c42\u5c06\u5904\u7406\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b\u7684\u5305\uff08TLP\u3001DLLP\u3001\u5b57\u7b26\u5e8f\u5217\u5305\uff09\u5728\u7269\u7406\u94fe\u8def\u4e0a\u7684\u53d1\u9001\u4e0e\u63a5\u6536\u3002\u6570\u636e\u5305\u5728\u53d1\u9001\u7aef\u8981\u7ecf\u8fc7\u5b57\u8282\u6761\u5e26\u5316\u903b\u8f91\u3001\u6270\u7801\u5668\u30018b/10b \u7f16\u7801\u5668\uff08\u5bf9\u4e8e Gen1/Gen2\uff09\u6216\u662f 128b/130b \u7f16\u7801\u5668\uff08\u5bf9\u4e8e Gen3\uff09\u4ee5\u53ca\u6570\u636e\u5305\u5e76\u4e32\u8f6c\u6362\u6a21\u5757\u7684\u5904\u7406\u3002\u6700\u7ec8\u6570\u636e\u5305\u4ee5\u8bad\u7ec3\u540e\u7684\u94fe\u8def\u901f\u7387\u5728\u6240\u6709\u901a\u9053\u4e0a\u6309\u7167\u65f6\u949f\u4ee5\u5dee\u5206\u5f62\u5f0f\u8f93\u51fa\u3002\u5728\u7269\u7406\u5c42\u7684\u63a5\u6536\u7aef\uff0c\u6570\u636e\u5305\u5904\u7406\u5305\u62ec\u4e32\u884c\u5730\u63a5\u6536\u5dee\u5206\u5f62\u5f0f\u7684\u6bd4\u7279\u4fe1\u53f7\uff0c\u5c06\u5176\u8f6c\u6362\u4e3a\u6570\u5b57\u4fe1\u53f7\u5f62\u5f0f\uff0c\u7136\u540e\u5c06\u8f93\u5165\u6bd4\u7279\u6d41\u505a\u4e32\u5e76\u8f6c\u6362\u3002\u8fd9\u4e2a\u64cd\u4f5c\u57fa\u4e8e\u6765\u6e90\u4e8e CDR\uff08Clock and Data Recovery\uff0c\u65f6\u949f\u6570\u636e\u6062\u590d\uff09\u7535\u8def\u6240\u63d0\u4f9b\u7684\u6062\u590d\u65f6\u949f\u3002\u63a5\u6536\u4e0b\u6765\u7684\u6570\u636e\u5305\u8981\u7ecf\u8fc7\u5f39\u6027\u7f13\u5b58\u30018b/10b \u89e3\u7801\u5668\uff08\u5bf9\u4e8e Gen1/Gen2\uff09\u6216\u8005 128b/130b \u89e3\u7801\u5668\uff08\u5bf9\u4e8e Gen3\uff09\u3001\u89e3\u6270\u5668\u4ee5\u53ca\u5b57\u8282\u4ea4\u6362\u6062\u590d\u903b\u8f91\u3002\u6700\u7ec8\uff0c\u7269\u7406\u5c42\u7684 LTSSM\uff08Link Training and Status State Machine\uff0c\u94fe\u8def\u8bad\u7ec3\u72b6\u6001\u673a\uff09\u8d1f\u8d23\u8fdb\u884c\u94fe\u8def\u521d\u59cb\u5316\u4ee5\u53ca\u8bad\u7ec3\u3002\u6240\u6709\u8fd9\u4e9b\u7269\u7406\u5c42\u529f\u80fd\u5c06\u5728\u672c\u4e66\u7684\u7b2c\u56db\u90e8\u5206\u8fdb\u884c\u8bb2\u89e3\u3002</p> </li> </ul> <p>\u6bcf\u4e2a PCIe \u63a5\u53e3\u90fd\u652f\u6301\u8fd9\u4e9b\u5c42\u7684\u529f\u80fd\uff0c\u5305\u62ec\u4ea4\u6362\u673a\u7aef\u53e3\uff0c\u5982\u56fe2\u201113 \u6240\u793a\u3002\u5728\u65e9\u671f\u5927\u5bb6\u7ecf\u5e38\u4f1a\u4ea7\u751f\u4e00\u4e2a\u7591\u95ee\uff0c\u90a3\u5c31\u662f\u4e00\u4e2a\u4ea4\u6362\u673a\u7aef\u53e3\u662f\u5426\u8fd8\u9700\u8981\u5b9e\u73b0\u6240\u6709\u7684\u5c42\u6b21\u5462\uff0c\u6bd5\u7adf\u5b83\u901a\u5e38\u53ea\u7528\u4e8e\u8f6c\u53d1\u6570\u636e\u5305\u3002\u7b54\u6848\u662f\u9700\u8981\uff0c\u56e0\u4e3a\u5bf9\u5305\u7684\u5185\u5bb9\u8fdb\u884c\u89e3\u6790\u6765\u786e\u5b9a\u5b83\u4eec\u7684\u8def\u7531\u662f\u9700\u8981\u67e5\u770b\u6570\u636e\u5305\u7684\u5185\u90e8\u7ec6\u8282\u7684\uff0c\u800c\u8fd9\u4ef6\u4e8b\u60c5\u662f\u5728\u4e8b\u52a1\u5c42\u4e2d\u5b8c\u6210\u7684\u3002</p> <p></p> <p>\u56fe2\u201113 \u4ea4\u6362\u673a\u7aef\u53e3\u7684\u5c42\u6b21\u7ed3\u6784</p> <p>\u539f\u5219\u4e0a\uff0c\u672c\u8bbe\u5907\u4e0a\u7684\u6bcf\u4e2a\u5c42\u90fd\u4e0e\u94fe\u8def\u5bf9\u7aef\u8bbe\u5907\u7684\u5404\u81ea\u5bf9\u5e94\u5c42\u8fdb\u884c\u901a\u4fe1\uff0c\u4f8b\u5982\u672c\u8bbe\u5907\u7684\u4e8b\u52a1\u5c42\u4e0e\u5bf9\u7aef\u7684\u4e8b\u52a1\u5c42\u901a\u4fe1\u3001\u672c\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e0e\u5bf9\u7aef\u7684\u6570\u636e\u94fe\u8def\u5c42\u901a\u4fe1\u3002\u4e0a\u9762\u7684\u4e24\u5c42\u901a\u8fc7\u5728\u6570\u636e\u5305\u5185\u6dfb\u52a0\u4e00\u4e32\u7279\u5b9a\u7684\u6bd4\u7279\u4fe1\u606f\uff0c\u4ea7\u751f\u4e00\u4e2a\u63a5\u6536\u7aef\u7684\u5bf9\u5e94\u5c42\u53ef\u4ee5\u8bc6\u522b\u7684\u5b57\u6bb5\u6837\u5f0f\u6765\u5b9e\u73b0\u5bf9\u5e94\u5c42\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u6570\u636e\u5305\u901a\u8fc7\u5176\u4ed6\u5c42\u7684\u8f6c\u53d1\uff0c\u4ece\u800c\u505a\u5230\u5230\u8fbe\u6216\u8005\u79bb\u5f00\u94fe\u8def\u3002\u7269\u7406\u5c42\u4e5f\u76f4\u63a5\u4e0e\u53e6\u4e00\u4e2a\u8bbe\u5907\u4e2d\u7684\u7269\u7406\u5c42\u901a\u4fe1\uff0c\u4f46\u662f\u65b9\u5f0f\u4e0e\u6b64\u4e0d\u540c\u3002</p> <p>\u5728\u6211\u4eec\u8bb2\u7684\u66f4\u6df1\u5165\u4e4b\u524d\uff0c\u5148\u5927\u81f4\u4e86\u89e3\u4e00\u4e0b\u8fd9\u4e9b\u5c42\u662f\u5982\u4f55\u4ea4\u4e92\u7684\u3002\u4ece\u5e7f\u4e49\u4e0a\u8bf4\uff0c\u8bbe\u5907\u6240\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u6216\u8005\u5b8c\u6210\u5305\u662f\u5728\u4e8b\u52a1\u5c42\u8fdb\u884c\u7ec4\u5305\u7684\uff0c\u7ec4\u5305\u6240\u7528\u5230\u7684\u4fe1\u606f\u662f\u7531\u8bbe\u5907\u6838\u5fc3\u5c42\u6240\u63d0\u4f9b\u7684\uff0c\u6709\u65f6\u6211\u4eec\u5c06\u8bbe\u5907\u6838\u5fc3\u5c42\u79f0\u4e3a\u8f6f\u4ef6\u5c42\uff08\u5c3d\u7ba1\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u4f7f\u7528\u8fd9\u4e00\u672f\u8bed\uff09\u3002\u5b83\u63d0\u4f9b\u7684\u7ec4\u5305\u4fe1\u606f\u901a\u5e38\u5305\u62ec\u671f\u671b\u7684\u547d\u4ee4\u7c7b\u578b\u3001\u76ee\u6807\u8bbe\u5907\u7684\u5730\u5740\u3001\u8bf7\u6c42\u7684\u5c5e\u6027\u7279\u5f81\u7b49\u7b49\u3002\u521a\u7ec4\u597d\u7684\u6570\u636e\u5305\u4f1a\u88ab\u5b58\u5165\u4e00\u4e2a\u88ab\u79f0\u4e3a\u865a\u62df\u901a\u9053\u7f13\u5b58\uff0c\u76f4\u5230\u8fd9\u4e2a\u5305\u53ef\u4ee5\u88ab\u53d1\u5f80\u4e0b\u4e00\u4e2a\u5c42\u7ea7\u3002\u5f53\u8fd9\u4e2a\u5305\u88ab\u5411\u4e0b\u53d1\u7ed9\u6570\u636e\u94fe\u8def\u5c42\u540e\uff0c\u6570\u636e\u94fe\u8def\u5c42\u4f1a\u5728\u6570\u636e\u5305\u4e2d\u52a0\u5165\u989d\u5916\u7684\u4fe1\u606f\u4ee5\u4f9b\u5bf9\u7aef\u7684\u63a5\u6536\u65b9\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\uff0c\u800c\u4e14\u8fd9\u4e2a\u6570\u636e\u5305\u4f1a\u5728\u672c\u5730\u50a8\u5b58\u4e0b\u6765\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u5bf9\u7aef\u68c0\u6d4b\u5230\u4f20\u8f93\u51fa\u9519\u65f6\u91cd\u65b0\u53d1\u9001\u8fd9\u4e2a\u6570\u636e\u5305\u3002\u5f53\u6570\u636e\u5305\u5230\u8fbe\u7269\u7406\u5c42\u540e\uff0c\u5b83\u88ab\u7f16\u7801\uff0c\u5e76\u4f7f\u7528\u94fe\u8def\u4e0a\u7684\u6240\u6709\u53ef\u7528\u7684\u901a\u9053\u3001\u4ee5\u5dee\u5206\u4fe1\u53f7\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u8f93\u3002</p> <p></p> <p>\u56fe2\u201114 PCIe \u8bbe\u5907\u5c42\u6b21\u7ed3\u6784\u7684\u8be6\u7ec6\u6846\u56fe</p> <p>\u63a5\u6536\u7aef\u5bf9\u7269\u7406\u5c42\u7684\u8f93\u5165\u6bd4\u7279\u8fdb\u884c\u89e3\u7801\uff0c\u68c0\u67e5\u672c\u5c42\u7ea7\u6240\u80fd\u53d1\u73b0\u7684\u9519\u8bef\uff0c\u5982\u679c\u6ca1\u6709\u68c0\u67e5\u5230\u9519\u8bef\uff0c\u90a3\u4e48\u5c31\u5c06\u63a5\u6536\u5230\u7684\u6570\u636e\u5305\u5411\u4e0a\u8f6c\u53d1\u5230\u6570\u636e\u94fe\u8def\u5c42\u3002\u5728\u6570\u636e\u94fe\u8def\u5c42\uff0c\u6570\u636e\u5305\u8fdb\u884c\u4e0d\u540c\u4e8e\u7269\u7406\u5c42\u7684\u9519\u8bef\u68c0\u67e5\uff0c\u5982\u679c\u6ca1\u6709\u53d1\u73b0\u9519\u8bef\u5c31\u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002\u5728\u4e8b\u52a1\u5c42\u6570\u636e\u5305\u88ab\u7f13\u5b58\uff0c\u68c0\u67e5\u9519\u8bef\uff0c\u5e76\u62c6\u89e3\u6210\u539f\u59cb\u4fe1\u606f\uff08\u547d\u4ee4\u3001\u5c5e\u6027\u7b49\uff09\uff0c\u4ee5\u4fbf\u5c06\u8fd9\u4e9b\u6570\u636e\u4f20\u8f93\u5230\u63a5\u6536\u8bbe\u5907\u7684\u6838\u5fc3\u5c42\u3002\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u66f4\u6df1\u5165\u7684\u63a2\u7d22\u6bcf\u4e00\u4e2a\u5c42\u5fc5\u987b\u8981\u505a\u4ec0\u4e48\u624d\u80fd\u8ba9\u4e0a\u8ff0\u8fc7\u7a0b\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u8fc7\u7a0b\u5728\u56fe2\u201114 \u8fdb\u884c\u4e86\u5c55\u793a\u3002\u6211\u4eec\u4ece\u6700\u9876\u7aef\u5f00\u59cb\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#221-device-coresoftware-layer","title":"2.2.1     \u8bbe\u5907\u6838\u5fc3\u5c42/\u8f6f\u4ef6\u5c42\uff08Device Core/Software Layer\uff09","text":"<p>\u8bbe\u5907\u6838\u5fc3\u5c42\u662f\u4e00\u4e2a\u8bbe\u5907\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u4f8b\u5982\u7f51\u7edc\u63a5\u53e3\u6216\u662f\u786c\u76d8\u9a71\u52a8\u63a7\u5236\u5668\u3002\u5b83\u5e76\u4e0d\u662f PCIe \u534f\u8bae\u89c4\u8303\u4e2d\u6240\u5b9a\u4e49\u7684\u4e00\u4e2a\u5c42\u7ea7\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5f53\u505a\u4e00\u4e2a PCIe \u7684\u5c42\u7ea7\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4f4d\u4e8e\u4e8b\u52a1\u5c42\u7684\u4e0a\u65b9\uff0c\u800c\u4e14\u5b83\u662f\u6240\u6709\u8bf7\u6c42\u7684\u6e90\u5934\u6216\u662f\u76ee\u7684\u5730\u3002\u5b83\u4e3a\u4e8b\u52a1\u5c42\u63d0\u4f9b\u4e86\u9700\u8981\u53d1\u9001\u7684\u8bf7\u6c42\u4fe1\u606f\uff0c\u5176\u4e2d\u7684\u4fe1\u606f\u5305\u62ec\u4e8b\u52a1\u7c7b\u578b\u3001\u5730\u5740\u3001\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\u91cf\u7b49\u7b49\u3002\u5f53\u4e8b\u52a1\u5c42\u63a5\u6536\u5230\u8f93\u5165\u6570\u636e\u5305\u65f6\uff0c\u5b83\u4e5f\u662f\u4e8b\u52a1\u5c42\u5411\u4e0a\u8f6c\u53d1\u8f93\u5165\u6570\u636e\u5305\u4fe1\u606f\u7684\u76ee\u7684\u5730\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#222-transaction-layer","title":"2.2.2     \u4e8b\u52a1\u5c42\uff08Transaction Layer\uff09","text":"<p>\u4e3a\u4e86\u54cd\u5e94\u6765\u81ea\u8f6f\u4ef6\u5c42\u7684\u8bf7\u6c42\uff0c\u4e8b\u52a1\u5c42\u751f\u6210\u51fa\u7ad9\u6570\u636e\u5305\uff08outbound packet\uff09\u3002\u5b83\u4e5f\u4f1a\u68c0\u67e5\u5165\u7ad9\u6570\u636e\u5305\uff08inbound packet\uff09\uff0c\u5e76\u5c06\u5165\u7ad9\u6570\u636e\u5305\u5185\u5305\u542b\u7684\u4fe1\u606f\u5411\u4e0a\u8f6c\u53d1\u7ed9\u8f6f\u4ef6\u5c42\u3002\u4e8b\u52a1\u5c42\u652f\u6301\u975e\u62a5\u544a\u5f0f\u8bf7\u6c42\uff08non\u2010posted transaction\uff09\u7684\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff0c\u5e76\u5c06\u5165\u7ad9\u5b8c\u6210\u5305\uff08inbound Completion\uff09\u4e0e\u5148\u524d\u4f20\u8f93\u7684\u51fa\u7ad9\u975e\u62a5\u544a\u5f0f\u8bf7\u6c42\u5305\u5173\u8054\u8d77\u6765\uff0c\u5373\u77e5\u9053\u8fd9\u4e2a\u5b8c\u6210\u5305\u662f\u5bf9\u5e94\u5230\u54ea\u4e2a\u975e\u62a5\u544a\u5f0f\u8bf7\u6c42\u5305\u3002\u4e8b\u52a1\u5c42\u6240\u5904\u7406\u7684\u4e8b\u52a1\u4f7f\u7528\u7684\u6570\u636e\u5305\u79cd\u7c7b\u4e3a TLP\uff0cTLP \u53ef\u4ee5\u5206\u4e3a\u56db\u4e2a\u8bf7\u6c42\u79cd\u7c7b\uff1a</p> <ol> <li> <p>\u5185\u5b58\uff08Memory\uff09</p> </li> <li> <p>IO</p> </li> <li> <p>\u914d\u7f6e\uff08Configuration\uff09</p> </li> <li> <p>\u6d88\u606f\uff08 Messages\uff09</p> </li> </ol> <p>\u524d\u4e09\u79cd\u5728 PCI \u548c PCI-X \u4e2d\u5c31\u5df2\u7ecf\u5f97\u5230\u652f\u6301\uff0c\u4f46\u662f\u6d88\u606f\u662f PCIe \u4e2d\u7684\u4e00\u4e2a\u65b0\u7684\u8bf7\u6c42\u79cd\u7c7b\u3002\u4e00\u4e2a\u8bf7\u6c42\u5305\u5411\u76ee\u6807\u8bbe\u5907\u4f20\u9001\u547d\u4ee4\uff0c\u76ee\u6807\u8bbe\u5907\u4f5c\u4e3a\u54cd\u5e94\u8bf7\u6c42\u800c\u53d1\u56de\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5b8c\u6210\u5305\uff0c\u8fd9\u4e8c\u8005\u7ec4\u5408\u8d77\u6765\u5c31\u662f\u5bf9\u4e00\u4e2a\u4e8b\u52a1\u7684\u5b9a\u4e49\uff0c\u5373\u4e00\u4e2a\u4e8b\u52a1\u7531\u4e00\u4e2a\u8bf7\u6c42\u5305\u4ee5\u53ca\u6240\u6709\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u5171\u540c\u7ec4\u6210\u3002\u5982\u88682\u20112 \u5217\u51fa\u4e86 PCIe \u8bf7\u6c42\u7684\u7c7b\u578b\u3002</p> <p></p> <p>\u88682\u20112 PCIe\u8bf7\u6c42\u7c7b\u578b</p> <p>\u8fd9\u4e9b\u8bf7\u6c42\u8fd8\u53ef\u4ee5\u88ab\u5f52\u4e3a\u4e24\u7c7b\uff0c\u5982\u4e0a\u8868\u7684\u53f3\u8fb9\u4e00\u5217\uff1a\u975e\u62a5\u544a\u548c\u62a5\u544a\uff08non\u2010posted and posted\uff09\u3002\u5bf9\u4e8e\u975e\u62a5\u544a\u5f0f\u8bf7\u6c42\uff0c\u53d1\u8d77\u65b9\u9996\u5148\u5411\u5b8c\u6210\u65b9\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5b8c\u6210\u65b9\u5e94\u8be5\u4ea7\u751f\u4e00\u4e2a\u5b8c\u6210\u5305\u4f5c\u4e3a\u54cd\u5e94\u3002\u8bfb\u8005\u4eec\u5e94\u8be5\u8ba4\u51fa\u6765\u4e86\uff0c\u8fd9\u5c31\u662f\u4ece PCI-X \u90a3\u91cc\u7ee7\u627f\u6765\u7684\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\u3002\u4f8b\u5982\uff0c\u6240\u6709\u7684\u8bfb\u8bf7\u6c42\u90fd\u662f\u975e\u62a5\u544a\u5f0f\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8bfb\u8bf7\u6c42\u6240\u8bf7\u6c42\u7684\u6570\u636e\u9700\u8981\u901a\u8fc7\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u7ed9\u53d1\u8d77\u65b9\u3002\u53ef\u80fd\u4ee4\u4f60\u611f\u5230\u51fa\u4e4e\u610f\u6599\uff0cIO \u5199\u8bf7\u6c42\u548c\u914d\u7f6e\u5199\u8bf7\u6c42\u4e5f\u662f\u975e\u62a5\u544a\u5f0f\u7684\u3002\u5c3d\u7ba1\u5b83\u4eec\u5728\u53d1\u9001\u7ed9\u76ee\u6807\u8bbe\u5907\u7684\u547d\u4ee4\u4e2d\u5c31\u5df2\u7ecf\u5305\u542b\u4e86\u8981\u5199\u5165\u76ee\u6807\u8bbe\u5907\u7684\u6570\u636e\uff0c\u4f46\u662f\u8fd9\u4e24\u79cd\u8bf7\u6c42\u4f9d\u7136\u9700\u8981\u76ee\u6807\u8bbe\u5907\u5728\u5199\u5165\u5b8c\u6210\u540e\u8fd4\u56de\u5b8c\u6210\u5305\uff0c\u4ee5\u6b64\u6765\u8ba9\u53d1\u8d77\u65b9\u786e\u8ba4\u6570\u636e\u88ab\u6b63\u786e\u65e0\u8bef\u7684\u5199\u5165\u5230\u76ee\u7684\u8bbe\u5907\u4e2d\u3002</p> <p>\u4e0e\u4e0a\u8ff0\u7684\u8bf7\u6c42\u76f8\u53cd\u5730\uff0c\u5185\u5b58\u5199\u8bf7\u6c42\u548c\u6d88\u606f\u8bf7\u6c42\u90fd\u662f\u62a5\u544a\u5f0f\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5b8c\u6210\u65b9\u5728\u5b8c\u6210\u8fd9\u4e9b\u8bf7\u6c42\u540e\u4e0d\u9700\u8981\u5411\u53d1\u8d77\u65b9\u8fd4\u56de\u5b8c\u6210\u5305 TLP\u3002\u62a5\u544a\u5f0f\u4e8b\u52a1\u5bf9\u6574\u4f53\u6027\u80fd\u63d0\u5347\u662f\u6709\u597d\u5904\u7684\uff0c\u56e0\u4e3a\u53d1\u8d77\u65b9\u4e0d\u9700\u8981\u7b49\u5f85\u54cd\u5e94\uff0c\u4e5f\u4e0d\u9700\u8981\u627f\u62c5\u5bf9\u5b8c\u6210\u5305\u8fdb\u884c\u5904\u7406\u7684\u989d\u5916\u5f00\u9500\u3002\u8fd9\u91cc\u505a\u51fa\u7684\u53d6\u820d\u5c31\u662f\u53d1\u8d77\u65b9\u65e0\u6cd5\u5f97\u5230\u5199\u8bf7\u6c42\u662f\u5426\u88ab\u6b63\u786e\u65e0\u8bef\u7684\u5b8c\u6210\u7684\u53cd\u9988\u4fe1\u606f\u3002\u62a5\u544a\u5f0f\u8fd9\u79cd\u64cd\u4f5c\u884c\u4e3a\u7ee7\u627f\u81ea PCI\uff0c\u5b83\u4f9d\u7136\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u64cd\u4f5c\u65b9\u6cd5\uff0c\u867d\u7136\u65e0\u6cd5\u5f97\u5230\u53cd\u9988\u4fe1\u606f\uff0c\u4f46\u662f\u53d1\u751f\u9519\u8bef\u7684\u53ef\u80fd\u6027\u6bd4\u8f83\u5c0f\u5e76\u4e14\u4f7f\u7528\u62a5\u544a\u5f0f\u5f97\u5230\u7684\u6027\u80fd\u63d0\u5347\u4e5f\u6bd4\u8f83\u660e\u663e\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5c3d\u7ba1\u5b83\u4eec**\u4e0d\u8981\u6c42**\u8fd4\u56de\u5b8c\u6210\u5305\uff0c\u62a5\u544a\u5f0f\u5199\u64cd\u4f5c\u4ecd\u7136\u8981\u53c2\u4e0e\u6570\u636e\u94fe\u8def\u5c42\u7684 Ack/Nak \u534f\u8bae\uff0c\u4ee5\u6b64\u6765\u4fdd\u8bc1\u8f83\u4e3a\u53ef\u9760\u7684\u6570\u636e\u5305\u4f20\u8f93\u3002\u5173\u4e8e\u8fd9\u4e00\u70b9\u7684\u66f4\u591a\u5185\u5bb9\uff0c\u8bf7\u89c1\u7b2c\u5341\u7ae0\u201cAck/Nak \u534f\u8bae\u201d\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2221-tlp","title":"2.2.2.1   TLP \u57fa\u7840\u5185\u5bb9","text":"<p>PCIe \u8bf7\u6c42\u5305\u548c\u5b8c\u6210\u5305\u7684\u5305\u7c7b\u578b\u88ab\u7f57\u5217\u5728\u88682\u20113 \u4e2d\u3002</p> <p></p> <p>\u88682\u20113 PCIe \u7684 TLP \u7c7b\u578b</p> <p>TLPs \u8d77\u59cb\u4e8e\u53d1\u9001\u65b9\u7684\u4e8b\u52a1\u5c42\uff0c\u7ec8\u6b62\u4e8e\u63a5\u6536\u65b9\u7684\u4e8b\u52a1\u5c42\uff0c\u5982\u56fe2\u201115 \u6240\u793a\u3002\u5f53 TLP \u9014\u7ecf\u53d1\u9001\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u4ee5\u53ca\u7269\u7406\u5c42\u65f6\uff0c\u8fd9\u4e24\u5c42\u5206\u522b\u4f1a\u5411\u6570\u636e\u5305\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u4fe1\u606f\uff0c\u63a5\u6536\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u4f1a\u5206\u522b\u6839\u636e\u53d1\u9001\u65b9\u5bf9\u5e94\u5c42\u6240\u6dfb\u52a0\u7684\u4fe1\u606f\u6765\u8fdb\u884c\u6821\u9a8c\uff0c\u4ee5\u6b64\u786e\u8ba4\u6570\u636e\u5305\u662f\u5426\u5728\u94fe\u8def\u4f20\u8f93\u4e2d\u4f9d\u65e7\u4fdd\u6301\u6b63\u786e\u6ca1\u6709\u51fa\u9519\u3002</p> <p></p> <p>\u56fe2\u201115 TLP \u7684\u8d77\u70b9\u4e0e\u76ee\u7684\u5730</p> <p>TLP \u7ec4\u5305. \u5982\u56fe2\u201116 \u5c55\u793a\u4e86\u4e00\u4e2a\u5c01\u88c5\u5b8c\u6210\u7684 TLP \u7684\u5404\u4e2a\u90e8\u5206\u662f\u5982\u4f55\u5728\u94fe\u8def\u4e0a\u8fdb\u884c\u4f20\u8f93\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u4e2d\u53d1\u73b0\u8fd9\u4e2a\u6570\u636e\u5305\u4e2d\u7684\u4e0d\u540c\u90e8\u5206\u662f\u5206\u522b\u7531\u4e0d\u540c\u7684\u5c42\u6765\u6dfb\u52a0\u7684\u3002\u4e3a\u4e86\u66f4\u5bb9\u6613\u770b\u51fa\u8fd9\u4e2a\u6570\u636e\u5305\u662f\u600e\u4e48\u6784\u6210\u7684\uff0c\u6211\u4eec\u5c06 TLP \u7684\u4e0d\u540c\u90e8\u5206\u7528\u4e0d\u540c\u7684\u989c\u8272\u8fdb\u884c\u6807\u8bc6\uff0c\u4ee5\u6b64\u6765\u8868\u793a\u5bf9\u5e94\u7684\u90e8\u5206\u662f\u7531\u54ea\u4e00\u5c42\u6dfb\u52a0\u7684\uff1a\u7ea2\u8272\u4ee3\u8868\u4e8b\u52a1\u5c42\uff0c\u84dd\u8272\u4ee3\u8868\u6570\u636e\u94fe\u8def\u5c42\uff0c\u7eff\u8272\u4ee3\u8868\u7269\u7406\u5c42\u3002</p> <p></p> <p>\u56fe2\u201116 TLP \u7ec4\u5305\u5f62\u5f0f</p> <p>\u8bbe\u5907\u6838\u5fc3\u5c42\u8d1f\u8d23\u5c06\u7ec4\u6210 TLP \u7684\u6838\u5fc3\u90e8\u5206\u7684\u4fe1\u606f\u53d1\u9001\u7ed9\u4e8b\u52a1\u5c42\uff0c\u5373\u4e0a\u56fe\u4e2d\u7684\u9996\u90e8\u548c\u6570\u636e\u3002\u6bcf\u4e2a TLP \u90fd\u4f1a\u6709\u4e00\u4e2a\u9996\u90e8\uff0c\u800c\u6709\u4e9b TLP \u4f1a\u6ca1\u6709\u6570\u636e\u90e8\u5206\uff0c\u4f8b\u5982\u8bfb\u8bf7\u6c42\u3002</p> <p>\u4e8b\u52a1\u5c42\u8fd8\u53ef\u4ee5\u9009\u62e9\u6dfb\u52a0 ECRC\uff08End-to-End CRC\uff0c \u7aef\u5230\u7aef CRC\uff09\u5b57\u6bb5\uff0c\u8fd9\u4e2a ECRC \u7531\u4e8b\u52a1\u5c42\u8fdb\u884c\u8ba1\u7b97\u5e76\u9644\u52a0\u5728\u6570\u636e\u5305\u7684\u540e\u9762\u3002CRC \u7684\u610f\u601d\u662f\u5faa\u73af\u5197\u4f59\u6821\u9a8c\u7801\uff0c\u5b83\u88ab\u51e0\u4e4e\u6240\u6709\u7684\u4e32\u884c\u4f20\u8f93\u67b6\u6784\u6240\u4f7f\u7528\uff0c\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u5b83\u5b9e\u73b0\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\u540c\u65f6\u53c8\u80fd\u63d0\u4f9b\u5f88\u5f3a\u7684\u9519\u8bef\u68c0\u6d4b\u529f\u80fd\u3002CRC \u8fd8\u53ef\u4ee5\u68c0\u6d4b\u201c\u7a81\u53d1\u9519\u8bef\u201d\uff0c\u5373\u4e00\u4e32\u91cd\u590d\u7684\u9519\u8bef\u6bd4\u7279\uff0c\u8fd9\u4e00\u4e32\u6bd4\u7279\u7684\u957f\u5ea6\u53d6\u51b3\u4e8e CRC \u7684\u957f\u5ea6\uff08\u5bf9\u4e8e PCIe \u6765\u8bf4\u662f 32\u6bd4\u7279\uff09\u3002\u56e0\u4e3a\u8fd9\u79cd\u7c7b\u578b\u7684\u9519\u8bef\u5728\u53d1\u9001\u4e00\u957f\u4e32\u6bd4\u7279\u65f6\u4f1a\u9047\u5230\uff0c\u56e0\u6b64 CRC \u7684\u8fd9\u79cd\u7279\u6027\u975e\u5e38\u9002\u7528\u4e8e\u4e32\u884c\u4f20\u8f93\u3002ECRC \u5b57\u6bb5\u533a\u57df\u5728\u901a\u8fc7\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u4e4b\u95f4\u7684\u4efb\u4f55\u670d\u52a1\u70b9\uff08\u670d\u52a1\u70b9\uff08service point\uff09\uff0c\u901a\u5e38\u6307\u7684\u662f\u4ea4\u6362\u673a\u6216\u8005\u6839\u7ec4\u4ef6\u7684\u7aef\u53e3\u8fd9\u4e9b\u6709 TLP \u8def\u7531\u529f\u80fd\u7684\u5730\u65b9\uff09\u65f6\u90fd\u4e0d\u6539\u53d8\uff0c\u8fd9\u4f7f\u5f97\u76ee\u7684\u7aef\u53ef\u4ee5\u7528\u5b83\u6765\u9a8c\u8bc1\u5728\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u90fd\u6ca1\u6709\u53d1\u751f\u9519\u8bef\u3002</p> <p>\u5bf9\u4e8e TLP \u7684\u4f20\u8f93\uff0cTLP \u7684\u6838\u5fc3\u90e8\u5206\u7531\u4e8b\u52a1\u5c42\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\uff0c\u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8d23\u5728 TLP \u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5e8f\u5217\u53f7\u548c\u53e6\u5916\u4e00\u4e2a\u88ab\u79f0\u4e3a LCRC\uff08Link CRC, \u94fe\u8defCRC\uff09 CRC \u5b57\u6bb5\u533a\u57df\u3002LCRC \u88ab\u5bf9\u7aef\u63a5\u6536\u65b9\u7528\u6765\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\uff0c\u5e76\u5c06\u94fe\u8def\u4e0a\u4f20\u8f93\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u7684\u68c0\u67e5\u7ed3\u679c\u90fd\u6c47\u62a5\u7ed9\u53d1\u9001\u65b9\u3002\u5584\u4e8e\u601d\u8003\u7684\u8bfb\u8005\u53ef\u80fd\u4f1a\u6709\u7591\u95ee\uff0c\u5982\u679c LCRC \u5df2\u7ecf\u8bc1\u660e\u4e86\u8fd9\u6b21\u94fe\u8def\u4f20\u8f93\u662f\u65e0\u5dee\u9519\u7684\uff0c\u800c LCRC \u53c8\u662f\u6570\u636e\u5305\u5fc5\u9700\u542b\u6709\u7684\u5b57\u6bb5\uff0c\u90a3\u4e48 ECRC \u8fd8\u6709\u4ec0\u4e48\u4f5c\u7528\u5462\uff1f\u8fd9\u4e2a\u7591\u95ee\u7684\u56de\u7b54\u662f\uff0c\u8fd8\u4f7f\u7528 ECRC \u662f\u56e0\u4e3a\u8fd8\u6709\u4e00\u4e2a\u5730\u65b9\u7684\u4f20\u8f93\u9519\u8bef\u6ca1\u6709\u88ab\u68c0\u67e5\uff0c\u90a3\u5c31\u662f\u8d1f\u8d23\u8def\u7531\u6570\u636e\u5305\u7684\u8bbe\u5907\u5185\u90e8\u3002\u5f53\u4e00\u4e2a\u6570\u636e\u5305\u5230\u8fbe\u4e00\u4e2a\u7aef\u53e3\uff0c\u5e76\u8fdb\u884c\u9519\u8bef\u548c\u8def\u7531\u68c0\u67e5\uff0c\u7136\u540e\u5f53\u5b83\u88ab\u4ece\u53e6\u4e00\u4e2a\u7aef\u53e3\u53d1\u51fa\u65f6\uff0c\u8bbe\u5907\u4f1a\u8ba1\u7b97\u51fa\u4e00\u4e2a\u65b0\u7684 LCRC \u503c\u5e76\u6dfb\u52a0\u5728\u6570\u636e\u5305\u4e2d\uff0c\u65b0\u7684LCRC \u4f1a\u53d6\u4ee3\u8001\u7684 LCRC \u3002\u5185\u90e8\u7aef\u53e3\u4e4b\u95f4\u7684\u8f6c\u53d1\u53ef\u80fd\u4f1a\u9047\u5230 PCIe \u534f\u8bae\u6ca1\u6709\u68c0\u67e5\u5230\u7684\u9519\u8bef\uff0c\u8fd9\u65f6\u5019\u5c31\u9700\u8981 ECRC \u6765\u53d1\u6325\u5b83\u7684\u4f5c\u7528\u4e86\u3002\u8fd9\u91cc\u53ef\u4ee5\u7406\u89e3\u4e3a\uff0c\u5f53 TLP \u5230\u8fbe\u4ea4\u6362\u673a\u7684\u4e00\u4e2a\u63a5\u6536\u7aef\u53e3\u65f6\uff0c\u4ea4\u6362\u673a\u4f1a\u5728\u63a5\u6536\u7aef\u53e3\u5bf9\u5176 LCRC \u8fdb\u884c\u6821\u9a8c\uff0c\u7136\u540e\u6839\u636e\u8def\u7531\u4fe1\u606f\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u8f6c\u53d1\uff0c\u4f46\u662f\u8fd9\u4e2a\u8f6c\u53d1\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u5bf9 LCRC \u8fdb\u884c\u6821\u9a8c\u7684\uff0c\u76f4\u5230\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684\u8f93\u51fa\u7aef\u53e3\uff0c\u7136\u540e\u5728\u8f93\u51fa\u7aef\u53e3\u7ed9\u6570\u636e\u5305\u52a0\u4e0a\u65b0\u7684 LCRC \u540e\u53d1\u9001\u51fa\u53bb\uff0c\u4e0d\u96be\u53d1\u73b0\u56e0\u4e3a\u5728\u5185\u90e8\u8f6c\u53d1\u8fc7\u7a0b\u4e2d\u4e0d\u5bf9 LCRC \u8fdb\u884c\u6821\u9a8c\uff0c\u56e0\u6b64\u82e5\u8f6c\u53d1\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u9519\u8bef\u5219\u5c31\u9700\u8981\u901a\u8fc7\u66f4\u5185\u5c42\u5c01\u88c5\u7684 ECRC \u6765\u8fdb\u884c\u6821\u9a8c\u4e86\uff0c\u5426\u5219\u5185\u90e8\u8f6c\u53d1\u8fc7\u7a0b\u662f\u5426\u51fa\u9519\u5c06\u65e0\u4ece\u53ef\u77e5\u3002</p> <p>\u6700\u540e\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c01\u88c5\u597d\u7684\u6570\u636e\u5305\u88ab\u8f6c\u53d1\u7ed9\u7269\u7406\u5c42\uff0c\u7269\u7406\u5c42\u5c06\u5176\u4ed6\u4e00\u4e9b\u5b57\u7b26\u6dfb\u52a0\u5230\u6570\u636e\u5305\u4e2d\uff0c\u8fd9\u4e9b\u5b57\u7b26\u53ef\u4ee5\u8ba9\u63a5\u6536\u65b9\u77e5\u9053\u63a5\u4e0b\u6765\u5c06\u4f1a\u63a5\u6536\u4ec0\u4e48\uff08\u4f8b\u5982\u6807\u8bc6\u4e00\u4e2a\u6570\u636e\u5305\u7684\u5f00\u59cb\u6216\u7ed3\u5c3e\uff09\u3002\u5bf9\u4e8e\u524d\u4e24\u4ee3\u7684 PCIe\uff0c\u7269\u7406\u5c42\u5c06\u5728\u6570\u636e\u5305\u7684\u5934\u548c\u5c3e\u6dfb\u52a0\u63a7\u5236\u5b57\u7b26\u3002\u800c\u5728\u7b2c\u4e09\u4ee3 PCIe \u4e2d\u4e0d\u518d\u4f7f\u7528\u63a7\u5236\u5b57\u7b26\uff0c\u800c\u662f\u5728\u6570\u636e\u5305\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u6bd4\u7279\u6765\u63d0\u4f9b\u5173\u4e8e\u6570\u636e\u5305\u7684\u4fe1\u606f\u3002\u7ecf\u8fc7\u8fd9\u4e9b\u5904\u7406\u540e\uff0c\u6570\u636e\u5305\u88ab\u7f16\u7801\uff0c\u7136\u540e\u5728\u94fe\u8def\u4e0a\u6240\u6709\u53ef\u7528\u901a\u9053\u4e2d\u4ee5\u5dee\u5206\u5f62\u5f0f\u4f20\u8f93\u3002</p> <p>TLP \u62c6\u5305. \u5f53\u5bf9\u7aef\u7684\u63a5\u6536\u65b9\u770b\u5230\u4e86\u8f93\u5165\u7684\u6bd4\u7279\u6d41\u65f6\uff0c\u5b83\u9700\u8981\u5bf9\u6b64\u524d\u7ec4\u5305\u65f6\u6dfb\u52a0\u7684\u90a3\u4e9b\u90e8\u5206\u8fdb\u884c\u8bc6\u522b\u548c\u5265\u9664\uff0c\u8fd9\u6837\u5c31\u80fd\u6062\u590d\u51fa\u53d1\u9001\u65b9\u8bbe\u5907\u7684\u8bbe\u5907\u6838\u5fc3\u5c42\u7684\u539f\u59cb\u8bf7\u6c42\u4fe1\u606f\u3002\u5982\u56fe2\u201117 \u6240\u793a\uff0c\u7269\u7406\u5c42\u5c06\u4f1a\u786e\u8ba4\u5f53\u524d\u6bd4\u7279\u6d41\u4e2d\u662f\u5426\u5b58\u5728\u6b63\u786e\u7684\u201c\u8d77\u59cb\u201d\u3001\u201c\u7ed3\u675f\u201d\u6216\u8005\u5176\u4ed6\u5b57\u7b26\uff0c\u5e76\u5c06\u5b83\u4eec\u5265\u9664\uff0c\u7136\u540e\u5c06\u5265\u9664\u4e86\u8fd9\u4e9b\u5b57\u7b26\u540e\u7684 TLP \u8f6c\u53d1\u7ed9\u6570\u636e\u94fe\u8def\u5c42\u3002\u6570\u636e\u94fe\u8def\u5c42\u5c06\u9996\u5148\u8fdb\u884c LCRC \u4ee5\u53ca\u5e8f\u5217\u53f7\u7684\u9519\u8bef\u6821\u9a8c\u3002\u5982\u679c\u5e76\u672a\u53d1\u73b0\u9519\u8bef\uff0c\u90a3\u4e48\u6570\u636e\u94fe\u8def\u5c42\u5c06\u4f1a\u628a LCRC \u548c\u5e8f\u5217\u53f7\u4ece TLP \u5265\u9664\uff0c\u5e76\u5c06 TLP \u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002\u5982\u679c\u63a5\u6536\u65b9\u662f\u4e00\u4e2a\u4ea4\u6362\u673a\uff0c\u90a3\u4e48\u5c06\u5728\u4e8b\u52a1\u5c42\u5bf9\u8fd9\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u89e3\u6790\u8bc4\u4f30\uff0c\u4ece\u5b83\u7684\u6570\u636e\u5305\u5934\u4e2d\u627e\u5230\u8def\u7531\u4fe1\u606f\u6765\u786e\u5b9a\u8fd9\u4e2a\u6570\u636e\u5305\u8981\u88ab\u8f6c\u53d1\u5230\u54ea\u4e00\u4e2a\u7aef\u53e3\u3002\u5373\u4f7f\u8fd9\u4e2a\u4ea4\u6362\u673a\u5e76\u4e0d\u662f TLP \u6700\u7ec8\u7684\u76ee\u7684\u5730\uff0c\u5b83\u4e5f\u53ef\u4ee5\u5bf9\u8fd9\u4e2a TLP \u8fdb\u884c ECRC \u6821\u9a8c\u4ee5\u53ca\u5728\u53d1\u73b0\u9519\u8bef\u65f6\u8fdb\u884c ECRC \u9519\u8bef\u6c47\u62a5\u3002\u4f46\u662f\uff0c\u4ea4\u6362\u673a\u4e0d\u80fd\u66f4\u6539\u8fd9\u4e2a TLP \u4e2d\u7684 ECRC\uff0c\u8fd9\u662f\u5e0c\u671b\u6700\u7ec8\u7684\u76ee\u6807\u8bbe\u5907\u4e5f\u53ef\u4ee5\u68c0\u6d4b\u5230\u8fd9\u4e2a ECRC \u9519\u8bef\u3002</p> <p>\u5982\u679c\u76ee\u6807\u8bbe\u5907\u6709\u80fd\u529b\u5e76\u4e14\u542f\u7528\u4e86 ECRC \u6821\u9a8c\u7684\u529f\u80fd\uff0c\u90a3\u4e48\u5b83\u5c06\u5bf9 ECRC \u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002\u82e5 TLP \u5230\u8fbe\u4e86\u6700\u7ec8\u7684\u76ee\u7684\u8bbe\u5907\uff0c\u800c\u4e14\u6821\u9a8c\u65e0\u9519\uff0c\u90a3\u4e48\u5728\u4e8b\u52a1\u5c42\u4e2d\u5c06\u628a\u8fd9\u4e2a ECRC \u5b57\u6bb5\u5265\u9664\uff0c\u4f7f\u5f97\u6574\u4e2a\u6570\u636e\u5305\u53ea\u5269\u4e0b\u9996\u90e8\u548c\u6570\u636e\u90e8\u5206\uff0c\u5e76\u5c06\u8fd9\u4e9b\u5269\u4f59\u90e8\u5206\u8f6c\u53d1\u7ed9\u8f6f\u4ef6\u5c42\u3002</p> <p></p> <p>\u56fe2\u201117 TLP \u7684\u62c6\u5305</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2222-non-posted-transactions","title":"2.2.2.2   \u975e\u62a5\u544a\u5f0f\u4e8b\u52a1 (Non-Posted Transactions)","text":"<p>\u666e\u901a\u8bfb\uff08Ordinary Reads\uff09. \u5982\u56fe2\u201118 \u5c55\u793a\u4e86\u4e00\u4e2a\u5185\u5b58\u8bfb\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u7531\u7aef\u70b9\u53d1\u5f80\u7cfb\u7edf\u5185\u5b58\u3002\u5728\u5185\u5b58\u8bfb\u8bf7\u6c42 TLP \u4e2d\u6709\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u90e8\u5206\uff0c\u90a3\u5c31\u662f\u76ee\u6807\u5730\u5740\uff08\u5173\u4e8e\u66f4\u591a\u6709\u5173 TLP \u5185\u5bb9\u7684\u8be6\u7ec6\u8bb2\u89e3\uff0c\u8bf7\u89c1\u7b2c\u4e94\u7ae0\u201cTLP \u5143\u7d20\u201d\uff09\u3002\u4e00\u4e2a\u5185\u5b58\u8bf7\u6c42\u7684\u5730\u5740\u53ef\u4ee5\u662f 32 \u4f4d\u6216\u8005 64 \u4f4d\u7684\uff0c\u8fd9\u4e5f\u51b3\u5b9a\u4e86\u6570\u636e\u5305\u7684\u8def\u7531\u65b9\u5f0f\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u4e8b\u52a1\u901a\u8fc7\u4e24\u4e2a\u4ea4\u6362\u673a\u7684\u8def\u7531\u540e\u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e86\u76ee\u6807\u8bbe\u5907\uff0c\u4f8b\u5b50\u4e2d\u7684\u76ee\u6807\u8bbe\u5907\u4e3a\u6839\u7ec4\u4ef6\u3002\u5f53\u6839\u7ec4\u4ef6\u5bf9\u8bf7\u6c42\u5305\u8fdb\u884c\u8bd1\u7801\uff0c\u5e76\u8bc6\u522b\u51fa\u4e86\u6570\u636e\u5305\u4e2d\u7684\u5730\u5740\u6307\u5411\u4e86\u7cfb\u7edf\u5185\u5b58\uff0c\u5b83\u5c06\u4ece\u90a3\u6bb5\u7cfb\u7edf\u5185\u5b58\u4e2d\u53d6\u51fa\u7aef\u70b9\u6240\u8bf7\u6c42\u7684\u6570\u636e\u3002\u4e3a\u4e86\u5c06\u8fd9\u4e9b\u4ece\u5185\u5b58\u4e2d\u53d6\u51fa\u6765\u7684\u6570\u636e\u8fd4\u56de\u7ed9\u53d1\u8d77\u65b9\uff0c\u6839\u7ec4\u4ef6\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\u5c06\u4ea7\u751f\u8db3\u591f\u591a\u7684\u5b8c\u6210\u5305\uff0c\u8fd9\u4e9b\u6570\u91cf\u7684\u5b8c\u6210\u5305\u8db3\u4ee5\u5c06\u53d1\u8d77\u65b9\u6240\u8bf7\u6c42\u7684\u5168\u90e8\u6570\u636e\u90fd\u8fd4\u56de\u56de\u53bb\u3002PCIe \u4e2d\u89c4\u5b9a\u4e00\u4e2a\u6570\u636e\u5305\u4e2d\u6570\u636e\u8377\u8f7d\u6700\u5927\u4e3a 4KB\uff0c\u4f46\u662f\u5b9e\u9645\u8bbe\u8ba1\u7684\u8bbe\u5907\u4e2d\u4e00\u822c\u4f1a\u4f7f\u7528\u7684\u6570\u636e\u8377\u8f7d\u4f1a\u6bd4 4KB \u5c0f\uff0c\u56e0\u6b64\u9700\u8981\u597d\u51e0\u4e2a\u5b8c\u6210\u5305\u624d\u80fd\u8db3\u591f\u5c06\u6bd4\u8f83\u5927\u91cf\u7684\u6570\u636e\u8fd4\u56de\u7ed9\u53d1\u8d77\u65b9\u3002</p> <p>\u8fd9\u4e9b\u5b8c\u6210\u5305\u5185\u4e5f\u5305\u542b\u4e86**\u8def\u7531\u4fe1\u606f**\uff0c\u7528\u4e8e\u5c06\u5b83\u4eec\u6307\u5f15\u56de\u5230\u53d1\u8d77\u65b9\uff0c\u8fd9\u662f\u56e0\u4e3a\u53d1\u8d77\u65b9\u5728\u539f\u5148\u7684\u8bf7\u6c42\u5305\u4e2d\u5c31\u9644\u5e26\u4e86\u9700\u8981\u8fd4\u56de\u7684\u5730\u5740\u7684\u4fe1\u606f\uff0c\u6240\u4ee5\u5b8c\u6210\u65b9\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5730\u5740\u7528\u6765\u653e\u5728\u5b8c\u6210\u5305\u4e2d\u4f5c\u4e3a\u5b8c\u6210\u5305\u7684\u8def\u7531\u4fe1\u606f\u3002\u8fd9\u4e2a\u201c\u8fd4\u56de\u5730\u5740\u201d\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5b83\u5c31\u662f PCI \u4e2d\u5b9a\u4e49\u7684\u8bbe\u5907 ID\uff0c\u8fd9\u4e2a\u8bbe\u5907 ID \u7531\u4e09\u4e2a\u4e1c\u897f\u7ec4\u6210\uff1a\u53d1\u8d77\u65b9\u6240\u5c5e PCI \u603b\u7ebf\u5728\u7cfb\u7edf\u4e2d\u7684 PCI \u603b\u7ebf\u53f7\u3001\u53d1\u8d77\u65b9\u5728\u6240\u5c5e PCI \u603b\u7ebf\u4e0a\u7684\u8bbe\u5907\u53f7\u3001\u53d1\u8d77\u65b9\u5728\u6240\u5c5e\u8bbe\u5907\u4e2d\u7684\u529f\u80fd\u53f7\u3002\u8fd9\u6837\u7684\u603b\u7ebf\u53f7\u3001\u8bbe\u5907\u53f7\u3001\u529f\u80fd\u53f7\u7ec4\u5408\u8d77\u6765\u7684\u4fe1\u606f\uff08\u6709\u65f6\u88ab\u7f29\u5199\u4e3a BDF\uff0cBus\u3001Device\u3001Function\uff09\u5c31\u662f\u5b8c\u6210\u5305\u7528\u6765\u8fd4\u56de\u5230\u53d1\u8d77\u65b9\u7684\u8def\u7531\u4fe1\u606f\u3002</p> <p>\u6b63\u5982 PCI-X \u6240\u505a\u7684\u90a3\u6837\uff0c\u53d1\u8d77\u65b9\u53ef\u4ee5\u540c\u65f6\u6709\u591a\u4e2a\u6b63\u5728\u8fdb\u884c\u7684**\u62c6\u5206\u4e8b\u52a1**\uff0c\u5b83\u5fc5\u987b\u80fd\u591f\u5c06\u8f93\u5165\u7684\u5b8c\u6210\u5305\u548c\u6b63\u786e\u7684\u8bf7\u6c42\u5173\u8054\u8d77\u6765\u3002\u4e3a\u4e86\u4fbf\u4e8e\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0c\u53d1\u8d77\u65b9\u5728\u539f\u5148\u7684\u8bf7\u6c42\u5305\u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\u503c\u79f0\u4e3a Tag\uff0c\u8fd9\u4e2a Tag \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u800c\u8a00\u90fd\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e00\u4e2a\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u90fd\u6709\u4e00\u4e2a\u4e0e\u5176\u4ed6\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u4e0d\u540c\u7684 Tag \u53f7\u3002\u5b8c\u6210\u65b9\u4f1a\u5c06\u8fd9\u4e2a\u4e8b\u52a1\u7684 Tag \u62f7\u8d1d\u8fdb\u5b8c\u6210\u5305\u4e2d\uff0c\u8fd9\u6837\u53d1\u8d77\u65b9\u5c31\u53ef\u4ee5\u5feb\u901f\u5730\u901a\u8fc7\u5b8c\u6210\u5305\u4e2d\u7684 Tag \u6765\u5c06\u8fd9\u4e2a\u5b8c\u6210\u5305\u4e0e\u6b63\u786e\u7684\u8bf7\u6c42\u5173\u8054\u8d77\u6765\uff0c\u4e5f\u5c31\u662f\u627e\u5230\u4e86\u8fd9\u4e2a\u5b8c\u6210\u5305\u662f\u7528\u6765\u670d\u52a1\u54ea\u4e2a\u8bf7\u6c42\u7684\u3002</p> <p>\u6700\u540e\u8fd8\u8981\u8bf4\u4e00\u70b9\uff0c\u5b8c\u6210\u65b9\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u5b8c\u6210\u5305\u4e2d\u7684\u5b8c\u6210\u72b6\u6001\u5b57\u6bb5\u4e2d\u7684\u6bd4\u7279\uff0c\u4ee5\u6b64\u6765\u8868\u793a\u51fa**\u4e8b\u52a1\u7684\u9519\u8bef\u60c5\u51b5**\u3002\u8fd9\u81f3\u5c11\u53ef\u4ee5\u8ba9\u53d1\u8d77\u65b9\u5bf9\u54ea\u91cc\u53ef\u80fd\u51fa\u9519\u4e86\u6709\u4e00\u4e2a\u5927\u81f4\u7684\u4e86\u89e3\u3002\u53d1\u8d77\u65b9\u5982\u4f55\u53bb\u5904\u7406\u5927\u591a\u6570\u7684\u9519\u8bef\uff0c\u8fd9\u4e2a\u4e8b\u60c5\u4e00\u822c\u662f\u7531\u8f6f\u4ef6\u6765\u51b3\u5b9a\uff0c\u8fd9\u5e76\u4e0d\u5728 PCIe \u534f\u8bae\u89c4\u8303\u7684\u8303\u56f4\u5185\u3002</p> <p></p> <p>\u56fe2\u201118 \u975e\u62a5\u544a\u5f0f\u8bfb\u7684\u793a\u4f8b</p> <p>\u9501\u5b9a\u8bfb\uff08Locked Reads\uff09. \u9501\u5b9a\u7684\u5185\u5b58\u8bfb\u8fd9\u79cd\u8bfb\u8bf7\u6c42\u662f\u4e3a\u4e86\u652f\u6301\u539f\u5b50\u8bfb-\u4fee\u6539-\u5199\u64cd\u4f5c\uff0c\u6240\u8c13\u539f\u5b50\u64cd\u4f5c\u5c31\u662f\u4e00\u79cd\u4e0d\u53ef\u4e2d\u65ad\u7684\u4e8b\u52a1\uff0c\u5904\u7406\u5668\u4f7f\u7528\u8fd9\u79cd\u4e8b\u52a1\u6765\u8fdb\u884c\u6d4b\u8bd5\u4ee5\u53ca\u8bbe\u7f6e\u4fe1\u53f7\u6807\u5fd7\u7b49\u4efb\u52a1\u3002\u5f53\u6d4b\u8bd5\u548c\u8bbe\u7f6e\u4fe1\u53f7\u6807\u6b63\u5728\u8fdb\u884c\u4e2d\u65f6\uff0c\u4e0d\u5141\u8bb8\u5176\u4ed6\u5bf9\u4fe1\u53f7\u6807\u7684\u8bbf\u95ee\u53d1\u751f\uff0c\u4e0d\u5141\u8bb8\u53d1\u751f\u7ade\u4e89\u7684\u60c5\u51b5\u3002\u4e3a\u4e86\u907f\u514d\u53d1\u751f\u7ade\u4e89\u60c5\u51b5\uff0c\u5904\u7406\u5668\u4f7f\u7528\u4e00\u4e2a\u9501\u5b9a\u6307\u793a\u7b26\uff08\u4f8b\u5982\u5e76\u884c\u603b\u7ebf\u524d\u6bb5\u7684\u4e00\u4e2a\u5355\u72ec\u7684 pin\uff09\uff0c\u6765\u963b\u6b62\u603b\u7ebf\u4e0a\u7684\u5176\u4ed6\u4e8b\u52a1\uff0c\u76f4\u5230\u8fd9\u4e2a\u9501\u5b9a\u7684\u4e8b\u52a1\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u662f\u5bf9\u8fd9\u4e2a\u4e3b\u9898\u5185\u5bb9\u7684\u4e00\u4e2a\u9ad8\u5c42\u6b21\u4ecb\u7ecd\u3002\u6709\u5173\u88ab\u9501\u5b9a\u4e8b\u52a1\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u9644\u5f55 D\uff0c\u201c\u9501\u5b9a\u4e8b\u52a1\u201d\u3002</p> <p>\u56de\u987e\u4e00\u4e0b\u5386\u53f2\uff0c\u5728 PCI \u7684\u65e9\u671f\uff0c\u534f\u8bae\u89c4\u8303\u7684\u5236\u5b9a\u8005\u4eec\u9884\u671f PCI \u5c06\u4f1a\u5b9e\u9645\u53d6\u4ee3\u5904\u7406\u5668\u603b\u7ebf\u3002\u56e0\u6b64\uff0cPCI \u534f\u8bae\u89c4\u8303\u4e2d\u8981\u6c42\u603b\u7ebf\u8981\u80fd\u652f\u6301\u5904\u7406\u5668\u8981\u5b8c\u6210\u7684\u4e8b\u60c5\uff0c\u6bd4\u5982\u9501\u5b9a\u4e8b\u52a1\u3002\u7136\u800c\uff0cPCI \u5f88\u5c11\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528\uff0c\u6700\u7ec8\uff0c\u8fd9\u79cd\u5904\u7406\u5668\u603b\u7ebf\u652f\u6301\u7684\u4e1c\u897f\u5927\u90e8\u5206\u90fd\u88ab\u4e22\u5f03\u4e86\u3002\u4e0d\u8fc7\uff0c\u9501\u5b9a\u5468\u671f\u4f9d\u7136\u5b58\u5728\uff0c\u7528\u4ee5\u652f\u6301\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0c\u5728\u66f4\u8fdb\u4e00\u6b65\u7684 PCIe \u7684\u53d1\u5c55\u4e2d\u4e5f\u4fdd\u7559\u4e86\u5b83\uff0c\u4ee5\u5b9e\u73b0\u5bf9\u4e00\u4e9b\u9057\u7559\u4e8b\u52a1\u7684\u652f\u6301\u3002\u4e5f\u8bb8\u662f\u4e3a\u4e86\u52a0\u901f\u5411 PCIe \u7684\u8fc1\u79fb\uff0c\u5728\u65b0\u7684 PCIe \u8bbe\u5907\u4e2d\u7981\u6b62\u63a5\u6536\u9501\u5b9a\u8bf7\u6c42\uff0c\u53ea\u6709\u90a3\u4e9b\u4f20\u7edf\u8bbe\u5907\u624d\u80fd\u591f\u4f7f\u7528\u5b83\u3002\u5728\u56fe2\u201119 \u6240\u793a\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e00\u4e2a\u53d1\u8d77\u65b9\u53d1\u51fa\u4e86\u4e00\u4e2a MRdLk\uff08\u9501\u5b9a\u8bfb\uff09\u6765\u53d1\u8d77\u4e8b\u52a1\u3002\u6839\u636e\u5b9a\u4e49\u8fd9\u6837\u7684\u8bf7\u6c42\u4ec5\u5141\u8bb8\u6765\u81ea CPU\uff0c\u56e0\u6b64\u5728 PCIe \u4e2d\u4ec5\u6709\u6839\u7ec4\u4ef6\u7684\u7aef\u53e3\u53ef\u4ee5\u53d1\u8d77\u8fd9\u79cd\u4e8b\u52a1\u3002</p> <p>\u8fd9\u4e2a\u9501\u5b9a\u8bf7\u6c42\u4f7f\u7528\u76ee\u6807\u5185\u5b58\u5730\u5740\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\uff0c\u5e76\u6700\u7ec8\u5230\u8fbe\u4e86\u4f20\u7edf\u8bbe\u5907\u7684\u7aef\u70b9\u3002\u5f53\u6570\u636e\u5305\u7ecf\u8fc7\u6cbf\u9014\u7684\u6bcf\u4e2a\u8def\u7531\u8bbe\u5907\u65f6\uff08\u79f0\u4e3a\u670d\u52a1\u70b9\uff09\uff0c\u6570\u636e\u5305\u7684\u51fa\u53e3\u7aef\u53e3\u88ab\u9501\u5b9a\uff0c\u8fd9\u610f\u5473\u7740\u5728\u88ab\u89e3\u9501\u4e4b\u524d\u8fd9\u6761\u8def\u5f84\u90fd\u4e0d\u80fd\u901a\u8fc7\u5176\u4ed6\u7684\u6570\u636e\u5305\u3002</p> <p></p> <p>\u56fe2\u201119 \u975e\u62a5\u544a\u5f0f\u9501\u5b9a\u8bfb\u4e8b\u52a1\u534f\u8bae</p> <p>\u5f53\u5b8c\u6210\u65b9\u63a5\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\u5305\u5e76\u5c06\u5176\u5185\u5bb9\u8fdb\u884c\u8bd1\u7801\uff0c\u5b83\u5c06\u6536\u96c6\u8bf7\u6c42\u6240\u9700\u8981\u7684\u6570\u636e\uff0c\u5e76\u4f7f\u7528\u8fd9\u4e9b\u6570\u636e\u4ea7\u751f\u4e00\u4e2a\u6216\u591a\u4e2a\u9501\u5b9a\u5b8c\u6210\u5305\u3002\u8fd9\u4e9b\u5b8c\u6210\u5305\u5c06\u4f1a\u88ab\u8def\u7531\u56de\u5230\u53d1\u8d77\u65b9\uff0c\u4f7f\u7528\u7684\u8def\u7531\u4fe1\u606f\u662f\u53d1\u8d77\u65b9 ID\uff0c\u5b8c\u6210\u5305\u8def\u5f84\u4e0a\u7684\u51fa\u53e3\u7aef\u53e3\u4e5f\u4f1a\u88ab\u9501\u5b9a\u3002</p> <p>\u5982\u679c\u5b8c\u6210\u65b9\u9047\u5230\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u65e0\u6cd5\u6b63\u5e38\u54cd\u5e94\u8bf7\u6c42\uff0c\u90a3\u4e48\u5b83\u5c06\u5411\u53d1\u8d77\u65b9\u8fd4\u56de\u4e00\u4e2a\u4e0d\u542b\u6709\u6570\u636e\u7684\u9501\u5b9a\u5b8c\u6210\u5305\uff08\u6b63\u5e38\u7684\u8bfb\u8bf7\u6c42\u5b8c\u6210\u5305\u5e94\u8be5\u542b\u6709\u8981\u8fd4\u56de\u7684\u6570\u636e\uff0c\u800c\u8fd9\u91cc\u4e0d\u5305\u542b\u6570\u636e\u90a3\u4e48\u6211\u4eec\u5c31\u77e5\u9053\u51fa\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898\uff09\uff0c\u5e76\u4f7f\u7528\u5b8c\u6210\u5305\u7684\u72b6\u6001\u6307\u793a\u533a\u57df\u6765\u6807\u8bc6\u53d1\u751f\u7684\u9519\u8bef\u7684\u4e00\u4e9b\u4fe1\u606f\u3002\u53d1\u8d77\u65b9\u63a5\u6536\u5230\u8fd9\u6837\u7684\u5b8c\u6210\u5305\u5c31\u660e\u767d\u4e86\u8fd9\u4e2a\u9501\u5b9a\u8bf7\u6c42\u5931\u8d25\u4e86\uff0c\u5b83\u5c31\u4f1a\u53d6\u6d88\u8fd9\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\uff0c\u7136\u540e\u7531\u8f6f\u4ef6\u6765\u51b3\u5b9a\u63a5\u4e0b\u6765\u8981\u505a\u4ec0\u4e48\u3002</p> <p>IO\u548c\u914d\u7f6e\u5199\uff08IO and Configuration Writes\uff09. \u5982\u56fe2\u201120 \u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u975e\u62a5\u544a\u5f0f IO \u5199\u4e8b\u52a1\u3002\u4e0e\u9501\u5b9a\u8bf7\u6c42\u76f8\u4f3c\uff0c\u8fd9\u6837\u7684\u4e00\u5957 IO \u64cd\u4f5c\u6d41\u7a0b\u7684\u76ee\u7684\u8bbe\u5907\u53ea\u80fd\u662f\u4e00\u4e2a\u4f20\u7edf\u7aef\u70b9\uff08Legacy Endpoint\uff09\u3002\u8bf7\u6c42\u5305\u4f7f\u7528 IO \u5730\u5740\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u5728\u4ea4\u6362\u673a\u4e2d\u88ab\u8def\u7531\u8f6c\u53d1\uff0c\u76f4\u5230\u5b83\u5230\u8fbe\u76ee\u6807\u7aef\u70b9\u3002\u5f53\u5b8c\u6210\u65b9\u63a5\u6536\u5230\u8fd9\u4e2a\u5199\u8bf7\u6c42\u5305\uff0c\u5b83\u63a5\u6536\u8bf7\u6c42\u5305\u5185\u7684\u6570\u636e\u5e76\u8fd4\u56de\u4e00\u4e2a\u5355\u72ec\u7684\u4e0d\u542b\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff0c\u4ee5\u6b64\u6765\u786e\u8ba4\u81ea\u5df1\u6536\u5230\u4e86\u8fd9\u4e2a\u5199\u8bf7\u6c42\u5305\u3002\u5b8c\u6210\u5305\u4e2d\u7684\u72b6\u6001\u6807\u8bc6\u533a\u57df\u5c06\u4f1a\u6307\u793a\u51fa\u662f\u5426\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u5982\u679c\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u53d1\u8d77\u65b9\u7684\u8f6f\u4ef6\u9700\u8981\u5bf9\u9519\u8bef\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u5982\u679c\u5b8c\u6210\u5305\u4e2d\u663e\u793a\u5e76\u672a\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u4e48\u53d1\u8d77\u65b9\u5c31\u8ba4\u4e3a\u5199\u6570\u636e\u88ab\u6210\u529f\u7684\u9001\u8fbe\u76ee\u6807\u8bbe\u5907\u5e76\u6210\u529f\u5199\u5165\uff0c\u53ef\u4ee5\u5141\u8bb8\u9488\u5bf9\u8fd9\u4e00\u4e2a\u5b8c\u6210\u65b9\u7684\u6307\u4ee4\u5e8f\u5217\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u53d1\u8d77\u65b9\u4e2d\u6709\u4e00\u7cfb\u5217\u7684\u9488\u5bf9\u5b8c\u6210\u65b9\u7684\u6307\u4ee4\uff0c\u5f53\u77e5\u9053\u8fd9\u4e00\u4e2a IO \u5199\u8bf7\u6c42\u5b8c\u6210\u4e86\u4e4b\u540e\uff0c\u5141\u8bb8\u6267\u884c\u6307\u4ee4\u5e8f\u5217\u4e2d\u7684\u4e0b\u4e00\u4e2a\u6307\u4ee4\uff0c\u5373\u60f3\u8868\u8fbe\u7684\u662f\u9700\u8981\u786e\u8ba4\u8fd9\u4e2a\u5199\u8bf7\u6c42\u6210\u529f\u4e86\u624d\u5141\u8bb8\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\u3002\u8fd9\u5f88\u597d\u7684\u603b\u7ed3\u4e86\u975e\u62a5\u544a\u5f0f\u5199\u7684\u76ee\u7684\uff1a\u4e0d\u540c\u4e8e\u4e00\u4e2a\u5185\u5b58\u5199\uff08MWr \u662f\u62a5\u544a\u5f0f\u7684\uff09\uff0c\u975e\u62a5\u544a\u5f0f\u5199\u4e0d\u80fd\u4ec5\u4ec5\u77e5\u9053\u6570\u636e\u88ab\u9001\u5f80\u4e86\u76ee\u7684\u65b9\uff0c\u8fd8\u5fc5\u987b\u8981\u77e5\u9053\u6570\u636e\u771f\u7684\u5230\u8fbe\u4e86\u76ee\u7684\u65b9\u624d\u884c\uff0c\u5426\u5219\u5728\u903b\u8f91\u4e0a\u4e0d\u80fd\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u6b65\u3002\u53c8\u5982\u540c\u9501\u5b9a\u64cd\u4f5c\u4e00\u6837\uff0c\u975e\u62a5\u544a\u5f0f\u5199\u8bf7\u6c42\u53ea\u80fd\u7531\u5904\u7406\u5668\u53d1\u51fa\u3002</p> <p></p> <p>\u56fe2\u201120 \u975e\u62a5\u544a\u5f0f\u5199\u4e8b\u52a1\u534f\u8bae</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2223-posted-writes","title":"2.2.2.3   \u62a5\u544a\u5f0f\u5199 (Posted Writes)","text":"<p>\u5185\u5b58\u5199\uff08Memory Writes\uff09. \u5185\u5b58\u5199\u8bf7\u6c42\u5fc5\u7136\u662f\u62a5\u544a\u5f0f\u7c7b\u578b\u7684\uff0c\u5b83\u4e0d\u9700\u8981\u8fd4\u56de\u5b8c\u6210\u5305\u3002\u4e00\u65e6\u8fd9\u79cd\u5199\u8bf7\u6c42\u5305\u88ab\u53d1\u51fa\uff0c\u53d1\u8d77\u65b9\u4e0d\u9700\u8981\u7b49\u5230\u4efb\u4f55\u53cd\u9988\u5c31\u53ef\u4ee5\u7ee7\u7eed\u53bb\u8fdb\u884c\u4e0b\u4e00\u6761\u8bf7\u6c42\uff0c\u4e0d\u9700\u8981\u5728\u8fd4\u56de\u5b8c\u6210\u5305\u8fd9\u4ef6\u4e8b\u60c5\u4e0a\u82b1\u8d39\u65f6\u95f4\u548c\u5e26\u5bbd\u3002\u56e0\u6b64\uff0c\u62a5\u544a\u5f0f\u5199\u4f1a\u6bd4\u975e\u62a5\u544a\u5f0f\u5199\u66f4\u52a0\u5feb\u901f\u4e14\u9ad8\u6548\uff0c\u5e76\u5f88\u597d\u7684\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u3002\u5982\u56fe2\u201121 \u6240\u793a\uff0c\u8bf7\u6c42\u5305\u4f7f\u7528\u5185\u5b58\u5730\u5740\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u5728\u7cfb\u7edf\u4e2d\u8fdb\u884c\u8def\u7531\u8f6c\u53d1\uff0c\u5e76\u6700\u7ec8\u5230\u8fbe\u5b8c\u6210\u65b9\u3002\u4e00\u65e6\u94fe\u8def\u6210\u529f\u7684\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u53d1\u9001\u8fc7\u53bb\uff08\u8fd9\u91cc\u7684\u6210\u529f\u662f\u6307\u628a\u6570\u636e\u5305\u4f20\u8f93\u4e86\u8fc7\u53bb\uff0c\u800c\u4e0d\u9700\u8981\u5f97\u5230\u5b8c\u6210\u65b9\u7684\u6210\u529f\u786e\u8ba4\uff09\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u5728\u94fe\u8def\u4e0a\u5c31\u5df2\u7ecf\u7ed3\u675f\u4e86\uff0c\u94fe\u8def\u4e0a\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f20\u8f93\u5176\u4ed6\u7684\u6570\u636e\u5305\u4e86\u3002\u6700\u7ec8\uff0c\u5b8c\u6210\u65b9\u63a5\u6536\u5199\u8bf7\u6c42\u5305\u4e2d\u7684\u6570\u636e\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u624d\u771f\u6b63\u5b8c\u6210\u3002\u5f53\u7136\uff0c\u8fd9\u79cd\u4e8b\u52a1\u6267\u884c\u65b9\u6cd5\u5728\u63d0\u5347\u6548\u7387\u7684\u540c\u65f6\u4e5f\u820d\u5f03\u4e86\u4e00\u4e9b\u4e1c\u897f\uff0c\u56e0\u4e3a\u5b8c\u6210\u65b9\u4e0d\u9700\u8981\u53d1\u9001\u5b8c\u6210\u5305\uff0c\u6240\u4ee5\u8fd9\u4e5f\u610f\u5473\u7740\u5b83\u65e0\u6cd5\u5c06\u9519\u8bef\u62a5\u544a\u7ed9\u53d1\u8d77\u65b9\u3002\u5982\u679c\u5b8c\u6210\u65b9\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u9519\u8bef\uff0c\u5e76\u5411 RC \u53d1\u4e00\u4e2a\u6d88\u606f\u6765\u901a\u77e5\u7cfb\u7edf\u8f6f\u4ef6\u8fd9\u4e9b\u60c5\u51b5\uff0c\u4f46\u662f\u53d1\u8d77\u65b9\u5bf9\u8fd9\u4e9b\u662f\u5b8c\u5168\u4e0d\u77e5\u60c5\u7684\u3002</p> <p></p> <p>\u56fe2\u201121 \u62a5\u544a\u5f0f\u5185\u5b58\u5199\u4e8b\u52a1\u534f\u8bae</p> <p>\u6d88\u606f\u5199\uff08Message Writes\uff09. \u5341\u5206\u6709\u8da3\u7684\u662f\uff0c\u6d88\u606f\u4e0d\u540c\u4e8e\u6211\u4eec\u524d\u9762\u6240\u8bf4\u7684\u90a3\u4e9b\u8bf7\u6c42\u4e8b\u52a1\uff0c\u5b83\u6709\u597d\u51e0\u79cd\u8def\u7531\u65b9\u6cd5\uff08\u524d\u9762\u7684\u90fd\u662f\u901a\u8fc7\u5185\u5b58\u5730\u5740\u3001IO \u5730\u5740\u4e2d\u7684\u4e00\u79cd\uff09\uff0c\u5728\u6d88\u606f\u5185\u90e8\u4e13\u95e8\u6709\u4e00\u4e2a\u533a\u57df\u6765\u6807\u8bc6\u4f7f\u7528\u7684\u662f\u54ea\u4e00\u79cd\u8def\u7531\u65b9\u5f0f\u3002\u4f8b\u5982\uff0c\u6709\u4e00\u4e9b\u6d88\u606f\u662f\u62a5\u544a\u5f0f\u5199\u8bf7\u6c42\uff0c\u5176\u76ee\u7684\u65b9\u4e3a\u7279\u5b9a\u7684\u5b8c\u6210\u65b9\uff1b\u6709\u4e00\u4e9b\u662f\u6839\u7ec4\u4ef6\u5411\u6240\u6709\u7aef\u70b9\u5e7f\u64ad\u7684\u8bf7\u6c42\uff1b\u8fd8\u6709\u4e00\u4e9b\u662f\u7aef\u70b9\u53d1\u51fa\u7684\u8981\u81ea\u52a8\u8def\u7531\u5230\u6839\u7ec4\u4ef6\u7684\u8bf7\u6c42\u3002\u60f3\u8981\u5b66\u4e60\u66f4\u591a\u5173\u4e8e\u4e0d\u540c\u7684\u8def\u7531\u7c7b\u578b\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u7b2c\u56db\u7ae0\u201c\u5730\u5740\u7a7a\u95f4\u548c\u4e8b\u52a1\u8def\u7531\u201d\u3002</p> <p>\u6d88\u606f\u5728 PCIe \u4e2d\u5f88\u6709\u7528\uff0c\u5b83\u53ef\u4ee5\u4f7f\u5f97 PCIe \u8fbe\u5230\u51cf\u5c11\u5f15\u811a\u6570\u91cf\u7684\u8bbe\u8ba1\u76ee\u6807\u3002\u5b83\u4f7f\u5f97 PCIe \u4e0d\u518d\u9700\u8981\u8fb9\u5e26\u4fe1\u53f7\uff0c\u800c\u5728 PCI \u4e2d\u5219\u662f\u9700\u8981\u7528\u8fb9\u5e26\u4fe1\u53f7\u6765\u62a5\u544a\u4e2d\u65ad\u3001\u529f\u8017\u7ba1\u7406\u4e8b\u9879\u4ee5\u53ca\u9519\u8bef\u4fe1\u606f\uff0c\u800c\u5728 PCIe \u4e2d\u4f7f\u7528\u6d88\u606f\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u4fe1\u606f\u4f7f\u7528\u6570\u636e\u5305\u6765\u8fdb\u884c\u62a5\u544a\uff0c\u6570\u636e\u5305\u662f\u76f4\u63a5\u5728\u4e00\u822c\u6570\u636e\u8def\u5f84\u4e0a\u4f20\u8f93\u7684\uff0c\u56e0\u6b64\u4e0d\u518d\u9700\u8981\u989d\u5916\u7684\u8fb9\u5e26\u4fe1\u53f7\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2224-qosquality-of-service","title":"2.2.2.4   QoS\u670d\u52a1\u8d28\u91cf\uff08Quality of Service\uff09","text":"<p>PCIe \u4ece\u4e00\u5f00\u59cb\u5c31\u88ab\u8bbe\u8ba1\u4e3a\u80fd\u591f\u652f\u6301\u65f6\u95f4\u654f\u611f\uff08time\u2010sensitive\uff09\u4e8b\u52a1\uff0c\u4f8b\u5982\u6d41\u89c6\u9891\u3001\u97f3\u9891\u5e94\u7528\u7a0b\u5e8f\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\u6570\u636e\u5fc5\u987b\u88ab\u53ca\u65f6\u4f20\u8f93\u624d\u80fd\u4fdd\u8bc1\u6570\u636e\u6709\u6548\u3002\u8fd9\u88ab\u79f0\u4e3a\u63d0\u4f9b\u4e86 QoS\uff0c\u5b83\u662f\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e9b\u4e1c\u897f\u6765\u5b9e\u73b0\u7684\u3002\u9996\u5148\uff0c\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u88ab\u8f6f\u4ef6\u5206\u914d\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8fd9\u4e2a\u4f18\u5148\u7ea7\u662f\u901a\u8fc7\u8bbe\u7f6e\u6570\u636e\u5305\u5185\u7684\u4e00\u4e2a 3 \u6bd4\u7279\u7684\u5b57\u6bb5\u533a\u57df\u6765\u8fdb\u884c\u6807\u8bc6\u7684\uff0c\u79f0\u4e4b\u4e3a TC (Traffic class, \u6d41\u91cf\u7c7b\u578b)\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u7ed9\u4e00\u4e2a\u6570\u636e\u5305\u5206\u914d\u4e00\u4e2a\u7f16\u53f7\u8f83\u5927\u7684 TC \u8868\u793a\u5e0c\u671b\u7ed9\u4e0e\u8fd9\u4e2a\u6570\u636e\u5305\u4e00\u4e2a\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002\u7b2c\u4e8c\uff0c\u4f7f\u7528\u591a\u7f13\u51b2\u533a\uff0c\u79f0\u4e3a VC (Virtual Channels, \u865a\u62df\u901a\u9053)\uff0c\u5c06\u5176\u6784\u5efa\u5728\u786c\u4ef6\u7684\u6bcf\u4e00\u4e2a\u7aef\u53e3\u4e2d\uff0c\u6570\u636e\u5305\u4f1a\u6839\u636e\u5176 TC \u503c\uff0c\u6765\u88ab\u653e\u5165\u76f8\u5e94\u7684 VC \u4e2d\uff08\u76f8\u5e94\u7684\u7f13\u5b58\u533a\u4e2d\uff09\u3002\u7b2c\u4e09\uff0c\u7531\u4e8e\u73b0\u5728\u5bf9\u4e8e\u4e00\u4e2a\u7aef\u53e3\u6765\u8bf4\uff0c\u5728\u4e00\u4e2a\u65f6\u523b\u5c06\u4f1a\u6709\u591a\u4e2a\u7f13\u51b2\u533a\u90fd\u5b58\u5728\u53ef\u4ee5\u8fdb\u884c\u4f20\u8f93\u7684\u6570\u636e\u5305\uff0c\u56e0\u6b64\u9700\u8981\u6709\u5bf9 VC \u8fdb\u884c\u9009\u62e9\u7684\u4ef2\u88c1\u903b\u8f91\u3002\u6700\u540e\uff0c\u4ea4\u6362\u673a\u5fc5\u987b\u5728\u76f8\u7ade\u4e89\u7684\u5404\u4e2a\u8f93\u5165\u7aef\u53e3\u95f4\u505a\u51fa\u9009\u62e9\uff0c\u4ee5\u4fbf\u8bbf\u95ee\u76f8\u5e94\u7aef\u53e3\u7684 VC \u3002\u8fd9\u4e00\u6b65\u88ab\u79f0\u4e3a\u7aef\u53e3\u4ef2\u88c1\uff0c\u5b83\u53ef\u4ee5\u7531\u786c\u4ef6\u6765\u8fdb\u884c\u5206\u914d\u6216\u662f\u7531\u8f6f\u4ef6\u6765\u8fdb\u884c\u7f16\u7a0b\u914d\u7f6e\u3002\uff08\u8bd1\u6ce8\uff1a\u8fd9\u4e0e\u7b2c\u4e09\u70b9\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u7b2c\u4e09\u70b9\u662f\u5728\u4e00\u4e2a\u7aef\u53e3\u5185\u5bf9\u591a\u4e2a VC \u8fdb\u884c\u4ef2\u88c1\u9009\u62e9\uff0c\u800c\u7aef\u53e3\u4ef2\u88c1\u662f\u6307\u5404\u4e2a\u7aef\u53e3\u5df2\u7ecf\u9009\u62e9\u597d\u4e86\u6b64\u6b21\u8bbf\u95ee\u7684 VC\uff0c\u9700\u8981\u7531\u4ea4\u6362\u673a\u4ef2\u88c1\u9009\u62e9\u8bbf\u95ee\u54ea\u4e00\u4e2a\u7aef\u53e3\u3002\uff09\u6240\u6709\u7684\u8fd9\u4e9b\u786c\u4ef6\u90e8\u4ef6\u90fd\u5fc5\u987b\u8981\u80fd\u591f\u652f\u6301\u7cfb\u7edf\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u4f18\u5148\u7ea7\u6392\u5e8f\u3002\u5982\u679c\u4e00\u4e2a\u8fd9\u6837\u7684\u7cfb\u7edf\u88ab\u6b63\u786e\u7684\u7f16\u7a0b\u914d\u7f6e\uff0c\u5b83\u53ef\u4ee5\u4e3a\u7ed9\u5b9a\u7684\u8def\u5f84\u63d0\u4f9b\u6709\u4fdd\u969c\u7684\u670d\u52a1\u3002</p> <p>\u56fe2\u201122\u9610\u8ff0\u4e86 QoS \u7684\u6982\u5ff5\uff0c\u5176\u4e2d\u7684\u89c6\u9891\u6444\u50cf\u5934\u4ee5\u53ca SCSI \u8bbe\u5907\u90fd\u9700\u8981\u5411\u7cfb\u7edf DRAM \u53d1\u9001\u6570\u636e\u3002\u8fd9\u4e8c\u8005\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u6444\u50cf\u5934\u662f\u5bf9\u65f6\u6548\u6027\u8981\u6c42\u4e25\u683c\u7684\uff0c\u5982\u679c\u4f20\u8f93\u8def\u5f84\u65e0\u6cd5\u6ee1\u8db3\u6444\u50cf\u5934\u7684\u5e26\u5bbd\uff0c\u90a3\u4e48\u5c06\u51fa\u73b0\u4e22\u5e27\u7684\u73b0\u8c61\u3002\u56e0\u6b64\u7cfb\u7edf\u9700\u8981\u4fdd\u969c\u6444\u50cf\u5934\u6240\u9700\u8981\u7684\u6700\u5c0f\u5e26\u5bbd\uff0c\u5426\u5219\u5b83\u6355\u6349\u7684\u89c6\u9891\u753b\u9762\u5c06\u4f1a\u51fa\u73b0\u4e0d\u7a33\u5b9a\u3002\u4e0e\u6b64\u540c\u65f6\uff0cSCSI \u6570\u636e\u9700\u8981\u6b63\u786e\u65e0\u8bef\u7684\u8fdb\u884c\u4f20\u8f93\uff0c\u4f46\u662f\u5bf9\u4e8e\u5b83\u6765\u8bf4\u4f20\u8f93\u9700\u8981\u7684\u65f6\u95f4\u957f\u77ed\u5e76\u4e0d\u662f\u90a3\u4e48\u91cd\u8981\u3002\u663e\u7136\uff0c\u5f53\u89c6\u9891\u6570\u636e\u548cSCSI\u6570\u636e\u540c\u65f6\u9700\u8981\u88ab\u53d1\u9001\u65f6\uff0c\u89c6\u9891\u6570\u636e\u6d41\u5e94\u5f53\u5177\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002QoS \u6307\u7684\u662f\u7cfb\u7edf\u7684\u4e00\u79cd\u80fd\u529b\uff0c\u662f\u7cfb\u7edf\u4e3a\u6570\u636e\u5305\u5206\u914d\u4e0d\u540c\u4f18\u5148\u7ea7\u5e76\u5c06\u8fd9\u4e9b\u6570\u636e\u5305\u6309\u7167\u786e\u5b9a\u6027\u7684\u5ef6\u65f6\u3001\u5e26\u5bbd\u5728\u7cfb\u7edf\u62d3\u6251\u4e2d\u8fdb\u884c\u8def\u7531\u7684\u80fd\u529b\u3002\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8e QoS \u7684\u7ec6\u8282\uff0c\u8bf7\u53c2\u9605\u7b2c\u4e03\u7ae0\u201c\u670d\u52a1\u8d28\u91cf\u201d\u3002</p> <p></p> <p>\u56fe2\u201122 QoS \u793a\u4f8b</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2225-transaction-ordering","title":"2.2.2.5   \u4e8b\u52a1\u6392\u5e8f\uff08Transaction Ordering\uff09","text":"<p>\u5728\u4e00\u4e2a VC  (Virtual Channels) \u5185\uff0c\u6570\u636e\u5305\u4e00\u822c\u5168\u90fd\u6309\u7167\u5b83\u4eec\u5230\u8fbe\u7684\u5148\u540e\u987a\u5e8f\u8fdb\u884c\u6392\u5e8f\u548c\u79fb\u52a8\uff0c\u4f46\u662f\u4e5f\u6709\u4f8b\u5916\u60c5\u51b5\u3002PCIe \u534f\u8bae\u7ee7\u627f\u4e86 PCI \u7684\u4e8b\u52a1\u6392\u5e8f\u6a21\u578b\uff0c\u5305\u62ec\u652f\u6301 PCI-X \u4e2d\u52a0\u5165\u7684\u5bbd\u677e\u6392\u5e8f\u3002\u8fd9\u4e9b\u6392\u5e8f\u89c4\u5219\u4fdd\u8bc1\u4e86\u4f7f\u7528\u76f8\u540c TC \u7684\u6570\u636e\u5305\u90fd\u4f1a\u6309\u7167\u6b63\u786e\u7684\u987a\u5e8f\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u88ab\u8def\u7531\u8f6c\u53d1\uff0c\u9632\u6b62\u6f5c\u5728\u7684\u6b7b\u9501\u6216\u8005\u6d3b\u9501\u60c5\u51b5\u3002\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u7531\u4e8e\u6392\u5e8f\u89c4\u5219\u4ec5\u5e94\u7528\u4e8e  VC\uff0c\u4e14\u4f7f\u7528\u4e0d\u540c TC \u7684\u6570\u636e\u5305\u4e00\u822c\u4e0d\u4f1a\u88ab\u5212\u5206\u8fdb\u540c\u4e00\u4e2a VC\uff0c\u56e0\u6b64\u4f7f\u7528\u4e0d\u540c\u7684 TC \u7684\u6570\u636e\u5305\u5728\u8f6f\u4ef6\u770b\u6765\u5c31\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u3002\u8fd9\u79cd\u6392\u5e8f\u5728\u4e8b\u52a1\u5c42\u4e2d\u7684 VC \u4e2d\u7ef4\u62a4\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2226-flow-control","title":"2.2.2.6   \u6d41\u91cf\u63a7\u5236\uff08Flow Control\uff09","text":"<p>\u4e32\u884c\u4f20\u8f93\u6240\u4f7f\u7528\u7684\u4e00\u4e2a\u5178\u578b\u534f\u8bae\u662f\uff0c\u8981\u6c42\u53d1\u9001\u65b9\u4ec5\u5728\u5bf9\u7aef\u6709\u8db3\u591f\u7684\u7f13\u51b2\u533a\u63a5\u6536\u65f6\u624d\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u6837\u7684\u89c4\u5b9a\u5220\u53bb\u4e86\u603b\u7ebf\u4e0a\u6d6a\u8d39\u6027\u80fd\u7684\u64cd\u4f5c\u4e8b\u4ef6\uff0c\u6bd4\u5982 PCI \u4e2d\u5141\u8bb8\u8fdb\u884c\u7684\u65ad\u5f00\u4e0e\u91cd\u8bd5( disconnects and retries)\uff0c\u8fd9\u4f7f\u5f97\u8fd9\u7c7b\u95ee\u9898\u5728\u4f20\u8f93\u4e2d\u5f97\u5230\u6d88\u9664\u3002\u8fd9\u6837\u505a\u7684\u4ee3\u4ef7\u662f\uff0c\u63a5\u6536\u65b9\u5fc5\u987b\u8db3\u591f\u9891\u7e41\u7684\u62a5\u544a\u5b83\u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u6765\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u4f20\u8f93\u505c\u987f\uff0c\u800c\u4e14\u8fd9\u6837\u7684\u62a5\u544a\u4e5f\u9700\u8981\u5360\u7528\u63a5\u6536\u65b9\u81ea\u5df1\u7684\u4e00\u70b9\u5e26\u5bbd\u3002\u5728 PCIe \u4e2d\uff0c\u8fd9\u4e2a\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u7684\u62a5\u544a\u662f\u7531 DLLP\uff08Data Link Layer Packet\uff09\u6765\u5b8c\u6210\u7684\uff0c\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u8bb2\u5230 DLLP\u3002\u8fd9\u91cc\u4e0d\u4f7f\u7528 TLP \u7684\u539f\u56e0\u662f\u4e3a\u4e86\u907f\u514d\u53ef\u80fd\u51fa\u73b0\u7684\u6b7b\u9501\u73b0\u8c61\uff0c\u5982\u679c\u4f7f\u7528TLP\u5219\u53ef\u80fd\u51fa\u73b0\uff0c\u4f8b\u5982\u4e00\u4e2a\u8bbe\u5907 A \u4f5c\u4e3a\u53d1\u9001\u65b9\u9700\u8981\u5bf9\u63a5\u6536\u65b9 B \u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u8fdb\u884c\u66f4\u65b0\uff0c\u4f46\u662f\u5f53A\u7684\u63a5\u6536\u7f13\u51b2\u533a\u6ee1\u5bfc\u81f4\u5b83\u53c8\u65e0\u6cd5\u63a5\u6536\u6765\u81eaB\u7684\u53ef\u7528\u7f13\u51b2\u533a\u62a5\u544a\uff0c\u8fd9\u6837\u5c31\u51fa\u73b0\u4e86\u4e00\u4e2a\u6b7b\u5faa\u73af\u3002\u800c DLLP \u53ef\u4ee5\u4e0d\u7ba1\u7f13\u51b2\u533a\u72b6\u6001\u5c31\u8fdb\u884c\u6536\u53d1\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u6b7b\u9501\u7684\u95ee\u9898\u3002\u8fd9\u6837\u7684\u6d41\u91cf\u63a7\u5236\u534f\u8bae\u7531\u786c\u4ef6\u7ea7\u8fdb\u884c\u81ea\u52a8\u7ba1\u7406\uff0c\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u662f\u900f\u660e\u7684\u3002</p> <p></p> <p>\u56fe2\u201123 \u6d41\u91cf\u63a7\u5236\u57fa\u7840\u64cd\u4f5c</p> <p>\u5982\u56fe2\u201123 \u6240\u793a\uff0c\u63a5\u6536\u65b9\u5185\u7684 VC \u7f13\u51b2\u533a\u5185\u7f13\u5b58\u4e86\u63a5\u6536\u5230\u7684 TLP\u3002\u63a5\u6536\u65b9\u5c06\u81ea\u5df1\u7684\u7f13\u51b2\u533a\u5927\u5c0f\u901a\u8fc7\u6d41\u91cf\u63a7\u5236 DLLP \u6765\u544a\u77e5\u53d1\u9001\u65b9\u3002\u53d1\u9001\u65b9\u5c06\u4f1a\u8ddf\u8e2a\u63a5\u6536\u65b9\u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u7684\u503c\uff0c\u5e76\u4e14\u4e0d\u5141\u8bb8\u53d1\u51fa\u5927\u4e8e\u8fd9\u4e2a\u53ef\u7528\u7a7a\u95f4\u7684\u6570\u636e\u5305\u3002\u5f53\u63a5\u6536\u65b9\u5bf9\u7f13\u51b2\u533a\u4e2d\u7684 TLP \u8fdb\u884c\u4e86\u5904\u7406\uff0c\u5e76\u5c06\u8fd9\u4e2a TLP \u79fb\u51fa\u4e86\u7f13\u51b2\u533a\uff0c\u6b64\u65f6\u7f13\u51b2\u533a\u4e2d\u5c31\u7a7a\u95f2\u51fa\u4e86\u65b0\u7684\u53ef\u7528\u7a7a\u95f4\uff0c\u90a3\u4e48\u63a5\u6536\u65b9\u5c06\u4f1a\u5b9a\u671f\u7684\u53d1\u9001\u6d41\u91cf\u63a7\u5236\u66f4\u65b0 DLLP \uff0c\u4fdd\u6301\u53d1\u9001\u65b9\u80fd\u591f\u83b7\u53d6\u5230\u6700\u65b0\u7684\u53ef\u7528\u7a7a\u95f4\u7684\u503c\u3002\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u8fd9\u65b9\u9762\u7684\u5185\u5bb9\uff0c\u8bf7\u89c1\u7b2c\u516d\u7ae0\u201c\u6d41\u91cf\u63a7\u5236\u201d\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#223-data-link-layer","title":"2.2.3     \u6570\u636e\u94fe\u8def\u5c42\uff08Data Link Layer\uff09","text":"<p>\u6570\u636e\u94fe\u8def\u5c42\u8fd9\u4e00\u5c42\u7684\u903b\u8f91\u662f\u7528\u6765\u8d1f\u8d23\u94fe\u8def\u7ba1\u7406\u7684\uff0c\u5b83\u4e3b\u8981\u8868\u73b0\u4e3a3\u4e2a\u529f\u80fd\uff1aTLP \u9519\u8bef\u7ea0\u6b63\u3001\u6d41\u91cf\u63a7\u5236\u4ee5\u53ca\u4e00\u4e9b\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u3002\u5b83\u662f\u901a\u8fc7\u5982\u56fe2\u201124 \u6240\u793a\u7684 DLLP \u6765\u5b8c\u6210\u8fd9\u4e9b\u529f\u80fd\u7684\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2231-dllpsdata-link-layer-packet","title":"2.2.3.1   DLLPs\u6570\u636e\u94fe\u8def\u5c42\u5305\uff08Data Link Layer Packet\uff09","text":"<p>DLLP \u662f\u4e00\u79cd\u5728\u4f4d\u4e8e\u540c\u4e00\u6761\u94fe\u8def\u4e0a\u7684\u672c\u7aef\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e0e\u5bf9\u7aef\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e4b\u95f4\u4f20\u8f93\u7684\u6570\u636e\u5305\u3002\u4e8b\u52a1\u5c42\u5bf9\u8fd9\u4e9b\u6570\u636e\u5305\u5e76\u65e0\u611f\u77e5\uff0c\u5b83\u4eec\u53ea\u5728\u4e24\u4e2a\u76f8\u4e34\u8fd1\u7684\u8bbe\u5907\u4e4b\u95f4\u4f20\u8f93\uff0c\u4e0d\u4f1a\u88ab\u8def\u7531\u5230\u4efb\u4f55\u5176\u4ed6\u5730\u65b9\u3002DLLP\u901a\u5e38\u8981\u5c0f\u4e8eTLP\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0bDLLP\u53ea\u67098Bytes\uff0c\u8fd9\u662f\u4e00\u4ef6\u597d\u4e8b\uff0c\u56e0\u4e3aDLLP\u7684\u5927\u5c0f\u4e5f\u5f71\u54cd\u7740\u7ef4\u62a4\u94fe\u8def\u6240\u9700\u8981\u7684\u5f00\u9500\u3002</p> <p></p> <p>\u56fe2\u201124 DLLP\u7684\u8d77\u59cb\u5730\u548c\u76ee\u7684\u5730</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#l-dllp-dllp-assembly","title":"l DLLP \u7ec4\u5305\uff08DLLP Assembly\uff09","text":"<p>\u5982\u56fe2\u201124 \u6240\u793a\uff0c\u4e00\u4e2a DLLP \u8d77\u6e90\u4e8e\u53d1\u9001\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5e76\u7ed3\u675f\u4e8e\u63a5\u6536\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u3002\u5728\u8fd9\u4e2a DLLP \u4e2d\u7531\u53d1\u9001\u65b9\u7ed9 DLLP Core \u52a0\u4e0a\u4e86\u4e00\u4e2a 16 \u6bd4\u7279 CRC\uff0c\u7528\u6765\u4f9b\u63a5\u6536\u65b9\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002\u5728\u52a0\u5b8c CRC \u4e4b\u540e\uff0c\u8fd9\u4e2a DLLP \u88ab\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\uff0c\u5728\u8fd9\u4e00\u5c42\u91cc\u7ed9 DLLP \u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff08\u8fd9\u79cd\u65b9\u6cd5\u662f Gen1 \u548c Gen2 \u7684\u65b9\u6cd5\uff0cGen3 \u4e0d\u518d\u4f7f\u7528\uff09\uff0c\u5e76\u5bf9\u52a0\u5b8c\u4e24\u79cd\u5b57\u7b26\u7684 DLLP \u8fdb\u884c\u7f16\u7801\uff0c\u7136\u540e\u901a\u8fc7\u94fe\u8def\u4e0a\u7684\u6240\u6709\u901a\u9053\u8fdb\u884c\u5dee\u5206\u4f20\u8f93\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#l-dllp-dllp-disassembly","title":"l DLLP \u62c6\u5305\uff08DLLP Disassembly\uff09","text":"<p>\u5f53\u63a5\u6536\u65b9\u7684\u7269\u7406\u5c42\u63a5\u6536\u5230\u4e86\u4e00\u4e2a DLLP \uff0c\u8fd9\u4e2a DLLP \u7684\u6bd4\u7279\u6d41\u5c06\u88ab\u8bd1\u7801\u5e76\u5265\u53bb\u5305\u8d77\u59cb\u5b57\u7b26\u4e0e\u5305\u7ed3\u675f\u5b57\u7b26\u3002\u5269\u4f59\u7684 DLLP \u90e8\u5206\u88ab\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5728\u8fd9\u91cc\u8fdb\u884c CRC \u9519\u8bef\u6821\u9a8c\uff0c\u5e76\u6839\u636e\u5305\u7684\u5185\u5bb9\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002\u63a5\u6536\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u5c31\u5df2\u7ecf\u662f DLLP \u7684\u6700\u7ec8\u76ee\u7684\u5730\uff0c\u5b83\u4e0d\u4f1a\u88ab\u7ee7\u7eed\u5411\u4e0a\u5448\u4ea4\u7ed9\u4e8b\u52a1\u5c42\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2232-acknak-acknak-protocol","title":"2.2.3.2   Ack/Nak \u534f\u8bae\uff08Ack/Nak Protocol\uff09","text":"<p>\u5982\u56fe2\u201125 \u6240\u793a\u662f\u4e00\u79cd\u57fa\u4e8e\u786c\u4ef6\u7684\u81ea\u52a8\u91cd\u8bd5\u673a\u5236\u3002\u5982\u56fe2\u201126 \u6240\u793a\uff0c\u6bcf\u4e00\u4e2a\u88ab\u53d1\u9001\u65b9\u53d1\u51fa\u7684 TLP \u90fd\u88ab\u52a0\u4e0a\u4e86 LCRC \u4e0e\u5e8f\u5217\u53f7\uff0c\u5728\u63a5\u6536\u65b9\u4f1a\u5bf9\u8fd9\u4e24\u4e2a\u4fe1\u606f\u8fdb\u884c\u68c0\u67e5\u3002\u53d1\u9001\u65b9\u7684\u91cd\u4f20\u7f13\u5b58\u4fdd\u5b58\u7740\u6bcf\u4e2a\u88ab\u53d1\u9001\u7684 TLP \u7684\u526f\u672c\uff0c\u76f4\u5230\u5bf9\u7aef\u786e\u8ba4\u6210\u529f\u6536\u5230\u4e86\u8fd9\u4e2a TLP\u3002\u8fd9\u4e2a\u786e\u8ba4\u6210\u529f\u6536\u5230\u7684\u8fc7\u7a0b\u662f\u901a\u8fc7\u63a5\u6536\u65b9\u53d1\u9001 Ack DLLP \u6765\u5b9e\u73b0\u7684\uff0c\u5728\u8fd9\u4e2a Ack DLLP \u4e2d\u5305\u542b\u6709\u63a5\u6536\u65b9\u6210\u529f\u63a5\u6536\u7684\u4e0a\u4e00\u4e2a TLP \u7684\u5e8f\u5217\u53f7\u3002\u5f53\u53d1\u9001\u65b9\u6536\u5230\u8fd9\u4e2a Ack DLLP\uff0c\u5b83\u5c06\u4f1a\u628a\u91cc\u9762\u5e8f\u5217\u53f7\u6240\u5bf9\u5e94\u7684 TLP\u3001\u4ee5\u53ca\u8fd9\u4e2a TLP \u4e4b\u524d\u7684\u6240\u6709 TLP\uff0c\u90fd\u4ece\u91cd\u4f20\u7f13\u5b58\u5185\u6e05\u9664\u3002</p> <p>\u5982\u679c\u63a5\u6536\u65b9\u68c0\u6d4b\u5230\u4e86\u4e00\u4e2a TLP \u9519\u8bef\uff0c\u5b83\u5c06\u4f1a\u628a\u8fd9\u4e2a TLP \u4e22\u5f03\uff0c\u5e76\u5411\u53d1\u9001\u65b9\u8fd4\u56de\u4e00\u4e2a Nak DLLP\uff0c\u4ee5\u671f\u671b\u53d1\u9001\u65b9\u80fd\u5bf9\u672a\u786e\u8ba4\u6210\u529f\u63a5\u6536\u7684 TLP \u8fdb\u884c\u91cd\u4f20\uff0c\u5e76\u901a\u8fc7\u91cd\u4f20\u83b7\u5f97\u4e00\u4e2a\u5b8c\u597d\u7684 TLP\u3002\u7531\u4e8e\u9519\u8bef\u68c0\u6d4b\u901a\u5e38\u662f\u5341\u5206\u8fc5\u901f\u7684\u64cd\u4f5c\uff0c\u56e0\u6b64\u4ece\u9519\u8bef\u68c0\u6d4b\u5f00\u59cb\u5230\u53d1\u8d77\u91cd\u4f20\u7684\u65f6\u95f4\u4e5f\u6bd4\u8f83\u77ed\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u8f83\u77ed\u7684\u65f6\u95f4\u5185\u7ea0\u6b63\u53d1\u751f\u7684\u9519\u8bef\u3002\u8fd9\u4e00\u64cd\u4f5c\u8fc7\u7a0b\u88ab\u79f0\u4e3a Ack/Nak\uff08Acknowledge/NotAcknowledge\uff09 \u534f\u8bae\u3002</p> <p></p> <p>\u56fe2\u201125 \u6570\u636e\u94fe\u8def\u5c42\u91cd\u4f20\u673a\u5236</p> <p></p> <p>\u56fe2\u201126 \u5728\u6570\u636e\u94fe\u8def\u5c42\u4e2d\u7684 TLP \u4e0e DLLP \u7684\u5305\u7ed3\u6784</p> <p>\u4e00\u4e2a DLLP \u7684\u57fa\u7840\u5f62\u5f0f\u5982\u56fe2\u201126 \u6240\u793a\uff0c\u5b83\u7531 4 \u5b57\u8282\u7684 DLLP \u7c7b\u578b\u57df\u4ee5\u53ca 2 \u5b57\u8282 CRC \u7ec4\u6210\uff0c\u5176\u4e2d DLLP \u7c7b\u578b\u57df\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u5176\u4ed6\u7684\u4fe1\u606f\u3002</p> <p>\u5982\u56fe2\u201127 \u6240\u793a\uff0c\u5b83\u5c55\u793a\u4e86\u4e00\u4e2a\u5185\u5b58\u8bfb TLP \u901a\u8fc7\u4ea4\u6362\u673a\u7684\u793a\u4f8b\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u6b65\u9aa41a\uff1a\u53d1\u8d77\u65b9\u53d1\u9001\u4e00\u4e2a\u5185\u5b58\u8bfb\u8bf7\u6c42\uff0c\u5e76\u5728\u81ea\u8eab\u7684\u91cd\u4f20\u7f13\u5b58\u4e2d\u4e5f\u4fdd\u5b58\u4e00\u4e2a\u8bf7\u6c42\u5305\u7684\u526f\u672c\u3002\u4ea4\u6362\u673a\u63a5\u6536\u8fd9\u4e2a MRd TLP\uff08Memory Read TLP\uff0c\u4ee5\u540e\u7b80\u5199\u4e3a MRd TLP\uff09\uff0c\u5e76\u6821\u9a8c LCRC \u4ee5\u53ca\u5e8f\u5217\u53f7\u3002</p> <p>\u6b65\u9aa41b\uff1a\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64\u4ea4\u6362\u673a\u5411\u53d1\u8d77\u65b9\u8fd4\u56de\u4e00\u4e2a Ack DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0c\u53d1\u8d77\u65b9\u5c06\u5176\u91cd\u4f20\u7f13\u5b58\u4e2d\u4fdd\u5b58\u7684 MRd TLP \u526f\u672c\u4e22\u5f03\u3002</p> </li> <li> <p>\u6b65\u9aa42a\uff1a\u4ea4\u6362\u673a\u5c06\u8fd9\u4e2a MRd TLP \u8f6c\u53d1\u5230\u6b63\u786e\u7684\u8f93\u51fa\u7aef\u53e3\uff0c\u4f7f\u7528\u7684\u8def\u7531\u4fe1\u606f\u662f\u8fd9\u4e2a MRd TLP \u7684\u5185\u5b58\u5730\u5740\uff0c\u5728\u8f6c\u53d1\u51fa\u53bb\u7684\u540c\u65f6\uff0c\u4ea4\u6362\u673a\u4f1a\u5728\u8fd9\u4e2a\u8f93\u51fa\u7aef\u53e3\u7684\u91cd\u4f20\u7f13\u5b58\u5185\u4fdd\u5b58\u4e00\u4efd\u8fd9\u4e2a TLP \u7684\u526f\u672c\u3002\u5b8c\u6210\u65b9\u63a5\u6536\u5230\u8fd9\u4e2a MRd TLP \u5e76\u5bf9\u5176\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002</p> <p>\u6b65\u9aa42b\uff1a\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64\u5b8c\u6210\u65b9\u5411\u4ea4\u6362\u673a\u8fd4\u56de\u4e00\u4e2a Ack DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0c\u4ea4\u6362\u673a\u4e4b\u524d\u8f93\u51fa\u8fd9\u4e2a TLP \u7684\u8f93\u51fa\u7aef\u53e3\u4f1a\u5c06\u5176\u91cd\u4f20\u7f13\u5b58\u4e2d\u4fdd\u5b58\u7684\u8fd9\u4e2a MRd TLP \u7684\u526f\u672c\u4e22\u5f03\u3002</p> </li> <li> <p>\u6b65\u9aa43a\uff1a\u4f5c\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u6700\u7ec8\u76ee\u7684\u5730\uff0c\u5b8c\u6210\u65b9\u5c06\u4f1a\u6821\u9a8c MRd TLP \u4e2d\u7684 ECRC \u5b57\u6bb5\u57df\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u57df\u662f\u53ef\u9009\u7684\u4e0d\u662f\u5fc5\u9700\u7684\u3002\u82e5\u6821\u9a8c\u672a\u51fa\u9519\uff0c\u5219\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u5448\u4ea4\u7ed9\u8bbe\u5907\u6838\u5fc3\u5c42\u3002\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u8bf7\u6c42\u547d\u4ee4\u4e2d\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u8bbe\u5907\u5c06\u4f1a\u6536\u96c6\u88ab\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u53d1\u8d77\u65b9\u8fd4\u56de\u4e00\u4e2a CplD\uff08Completion with Data TLP\uff0c\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff09\uff0c\u540c\u65f6\u5b83\u4e5f\u5c06\u5728\u81ea\u5df1\u7684\u91cd\u4f20\u7f13\u5b58\u4e2d\u4fdd\u5b58\u8fd9\u4e2a CplD TLP \u7684\u526f\u672c\u3002\u5f53\u4ea4\u6362\u673a\u63a5\u6536\u5230\u8fd9\u4e2a CplD TLP \u65f6\u5c06\u4f1a\u5bf9\u5176\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002</p> <p>\u6b65\u9aa43b\uff1a\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64\u4ea4\u6362\u673a\u5411\u5b8c\u6210\u65b9\u8fd4\u56de\u4e00\u4e2a Ack DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0c\u5b8c\u6210\u65b9\u5c06\u5176\u91cd\u4f20\u7f13\u5b58\u4e2d\u4fdd\u5b58\u7684\u8fd9\u4e2a CplD TLP \u7684\u526f\u672c\u6e05\u9664\u3002</p> </li> <li> <p>\u6b65\u9aa44a\uff1a\u4ea4\u6362\u673a\u5bf9\u8fd9\u4e2a CplD TLP \u4e2d\u7684\u53d1\u8d77\u65b9 ID \u8fdb\u884c\u8bd1\u7801\uff0c\u5e76\u901a\u8fc7\u8fd9\u4e2a\u4fe1\u606f\u5c06 CplD TLP \u8def\u7531\u81f3\u6b63\u786e\u7684\u8f93\u51fa\u7aef\u53e3\uff0c\u8f93\u51fa\u7684\u540c\u65f6\u5728\u8fd9\u4e2a\u8f93\u51fa\u7aef\u53e3\u7684\u91cd\u4f20\u7f13\u5b58\u5185\u4fdd\u5b58 CplD TLP \u7684\u526f\u672c\u3002\u5f53\u53d1\u8d77\u65b9\u63a5\u6536\u5230\u8fd9\u4e2a CplD TLP \u65f6\u5c06\u4f1a\u5bf9\u5176\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002</p> <p>\u6b65\u9aa44b\uff1a\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64\u53d1\u8d77\u65b9\u5411\u4ea4\u6362\u673a\u8fd4\u56de\u4e00\u4e2a Ack DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0c\u4ea4\u6362\u673a\u4e4b\u524d\u8f93\u51fa\u8fd9\u4e2a CplD TLP \u7684\u8f93\u51fa\u7aef\u53e3\u4f1a\u5c06\u5176\u91cd\u4f20\u7f13\u5b58\u4e2d\u4fdd\u5b58\u7684\u8fd9\u4e2a CplD TLP \u7684\u526f\u672c\u4e22\u5f03\u3002\u53d1\u8d77\u65b9\u5c06\u6821\u9a8c ECRC \u5b57\u6bb5\u57df\uff08\u8fd9\u4e2a\u5b57\u6bb5\u662f\u53ef\u9009\u7684\uff0c\u4e0d\u662f\u5fc5\u9700\u7684\uff09\uff0c\u6821\u9a8c\u672a\u51fa\u9519\u5219\u5c06\u5b8c\u6210\u5305\u91cc\u7684\u6570\u636e\u5411\u4e0a\u5448\u4ea4\u7ed9\u8bbe\u5907\u6838\u5fc3\u5c42\u903b\u8f91\u3002</p> </li> </ol> <p></p> <p>\u56fe2\u201127 \u4f7f\u7528 Ack/Nak \u534f\u8bae\u7684\u975e\u62a5\u544a\u5f0f\u4e8b\u52a1</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2233-flow-control","title":"2.2.3.3   \u6d41\u91cf\u63a7\u5236\uff08Flow Control\uff09","text":"<p>\u6570\u636e\u94fe\u8def\u5c42\u7684\u7b2c\u4e8c\u4e2a\u4e3b\u8981\u529f\u80fd\u5c31\u662f\u6d41\u91cf\u63a7\u5236\u3002\u5728\u7cfb\u7edf\u4e0a\u7535\u548c\u590d\u4f4d\u4e4b\u540e\uff0c\u6d41\u91cf\u63a7\u5236\u673a\u5236\u88ab\u6570\u636e\u94fe\u8def\u5c42\u7684\u786c\u4ef6\u81ea\u52a8\u521d\u59cb\u5316\uff0c\u5e76\u5728\u6574\u4e2a\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u66f4\u65b0\u3002\u5173\u4e8e\u8fd9\u4e9b\u5185\u5bb9\u7684\u6982\u8ff0\u5df2\u7ecf\u5728 TLP \u7684\u90a3\u4e00\u8282\u7ed9\u51fa\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\u60f3\u8981\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u8fd9\u4e00\u4e3b\u9898\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u7b2c\u516d\u7ae0\u201c\u6d41\u91cf\u63a7\u5236\u201d\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2234-power-management","title":"2.2.3.4   \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09","text":"<p>\u6700\u540e\u8981\u4ecb\u7ecd\u7684\u4e00\u70b9\uff0c\u6570\u636e\u94fe\u8def\u5c42\u4e5f\u53c2\u4e0e\u4e86\u7535\u6e90\u7ba1\u7406\uff0c\u56e0\u4e3a\u94fe\u8def\u4e0e\u7cfb\u7edf\u7535\u6e90\u72b6\u6001\u76f8\u5173\u7684\u8bf7\u6c42\u548c\u63e1\u624b\u4e5f\u53ef\u4ee5\u901a\u8fc7 DLLP \u6765\u8fdb\u884c\u3002\u60f3\u4e86\u89e3\u5173\u4e8e\u8fd9\u4e00\u4e3b\u9898\u7684\u66f4\u8be6\u7ec6\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u7b2c\u5341\u516d\u7ae0\u201c\u7535\u6e90\u7ba1\u7406\u201d\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#224-physical-layer","title":"2.2.4     \u7269\u7406\u5c42\uff08Physical Layer\uff09","text":""},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2241-general","title":"2.2.4.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u7269\u7406\u5c42\u662f PCIe \u534f\u8bae\u5c42\u6b21\u91cc\u7684\u6700\u5e95\u5c42\uff0c\u5982\u56fe2\u201114\u3002TLP \u548c DLLP \u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u6570\u636e\u5305\u90fd\u9700\u8981\u4ece\u6570\u636e\u94fe\u8def\u5c42\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\uff0c\u8fd9\u6837\u624d\u80fd\u901a\u8fc7\u94fe\u8def\u4f20\u8f93\u81f3\u5bf9\u7aef\u63a5\u6536\u65b9\u8bbe\u5907\uff0c\u5e76\u4ece\u63a5\u6536\u65b9\u7684\u7269\u7406\u5c42\u5411\u4e0a\u8f6c\u53d1\u81f3\u5b83\u7684\u6570\u636e\u94fe\u8def\u5c42\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u5c06\u5173\u4e8e\u7269\u7406\u5c42\u7684\u8ba8\u8bba\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\u903b\u8f91\u90e8\u5206\u548c\u7535\u6c14\u90e8\u5206\u3002\u6211\u4eec\u8fd9\u91cc\u4e5f\u5c06\u4fdd\u7559\u8fd9\u79cd\u5212\u5206\u65b9\u5f0f\u3002\u903b\u8f91\u7269\u7406\u5c42\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u7684\u6570\u5b57\u903b\u8f91\uff0c\u8fd9\u4e9b\u6570\u5b57\u903b\u8f91\u662f\u5173\u4e8e\u51c6\u5907\u5c06\u6570\u636e\u5305\u5728\u94fe\u8def\u4e0a\u8fdb\u884c\u4e32\u884c\u4f20\u8f93\u7684\u903b\u8f91\u4ee5\u53ca\u76f8\u53cd\u7684\u8f93\u5165\u6570\u636e\u5305\u7684\u5904\u7406\u903b\u8f91\u3002\u7535\u6c14\u7269\u7406\u5c42\u662f\u7269\u7406\u5c42\u7684\u6a21\u62df\u7535\u8def\u63a5\u53e3\uff0c\u5b83\u4e0e\u94fe\u8def\u76f4\u63a5\u76f8\u8fde\uff0c\u5b83\u4e3a\u6bcf\u4e2a\u901a\u9053\u63d0\u4f9b\u5dee\u5206\u9a71\u52a8\u5668\u4ee5\u53ca\u5dee\u5206\u63a5\u6536\u5668\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2242-physical-layer-logical","title":"2.2.4.2   \u903b\u8f91\u7269\u7406\u5c42\uff08Physical Layer-Logical\uff09","text":"<p>\u7531\u6570\u636e\u94fe\u8def\u5c42\u8f6c\u53d1\u6765\u7684 TLP \u4e0e DLLP \u88ab\u7269\u7406\u5c42\u4e2d\u7684\u7f13\u5b58\u6240\u8bb0\u5f55\uff0c\u5728\u8fd9\u4e2a\u7f13\u5b58\u4e2d\u4f1a\u5bf9\u8fd9\u4e9b\u6570\u636e\u5305\u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u8fd9\u4e24\u4e2a\u5b57\u7b26\u5c06\u6709\u52a9\u4e8e\u63a5\u6536\u7aef\u7528\u6765\u68c0\u6d4b\u6570\u636e\u5305\u7684\u8fb9\u754c\u3002\u7531\u4e8e\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\u5206\u522b\u51fa\u73b0\u5728\u6570\u636e\u5305\u7684\u4e24\u7aef\uff08\u5934\u548c\u5c3e\uff09\uff0c\u56e0\u6b64\u4ed6\u4eec\u4e5f\u88ab\u79f0\u4f5c\u201c\u7ec4\u5e27\u201d\u5b57\u7b26\u3002\u5982\u56fe2\u201128 \u5c55\u793a\u4e86\u7ec4\u5e27\u5b57\u7b26\u88ab\u6dfb\u52a0\u5728 TLP \u548c DLLP \u4e0a\uff0c\u5b83\u4e5f\u5c55\u793a\u4e86\u8fd9\u4e24\u79cd\u5b57\u7b26\u7684\u5b57\u6bb5\u957f\u5ea6\u3002</p> <p></p> <p>\u56fe2\u201128 \u7269\u7406\u5c42\u4e2d\u7684 TLP \u4e0e DLLP \u7684\u7ed3\u6784</p> <p>\u5728\u7269\u7406\u5c42\u4e2d\uff0c\u6570\u636e\u5305\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u8282\u90fd\u5c06\u88ab\u5206\u5272\u5230\u94fe\u8def\u6240\u4f7f\u7528\u7684\u6240\u6709\u901a\u9053\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u5b57\u8282\u6761\u5e26\u5316\uff08byte striping\uff09\u3002\u5b9e\u9645\u4e0a\uff0c\u6bcf\u4e2a\u901a\u9053\u5728\u94fe\u8def\u4e0a\u90fd\u626e\u6f14\u7740\u4e00\u4e2a\u72ec\u7acb\u7684\u4e32\u884c\u4f20\u8f93\u8def\u5f84\uff0c\u8fd9\u4e9b\u901a\u9053\u4eec\u5404\u81ea\u4f20\u8f93\u7684\u6570\u636e\u4f1a\u5728\u63a5\u6536\u7aef\u88ab\u805a\u5408\u3002\u6bcf\u4e2a\u5b57\u8282\u90fd\u8fdb\u884c\u4e86\u6270\u7801\uff0c\u4ee5\u6b64\u6765\u51cf\u5c11\u5728\u4f20\u8f93\u7ebf\u4e0a\u4f20\u8f93\u8fde\u7eed\u91cd\u590d\u7684\u201c0\u201d\u6216\u201c1\u201d\uff0c\u8fd9\u6709\u52a9\u4e8e\u51cf\u5c11\u94fe\u8def\u4e0a\u7684 EMI\uff08electro-magnetic interference\uff0c\u7535\u78c1\u5e72\u6270\uff09\u3002</p> <p>\u5bf9\u4e8e\u524d\u4e24\u4ee3\u7684 PCIe\uff08Gen1 \u548c Gen2\uff09\uff0c8 \u6bd4\u7279\u7684\u5b57\u7b26\u5c06\u88ab\u7f16\u7801\u4e3a10\u6bd4\u7279\u201c\u7b26\u53f7\uff08symbol\uff09\u201d\uff0c\u6240\u4f7f\u7528\u7684\u7f16\u7801\u65b9\u5f0f\u88ab\u79f0\u4e3a 8b/10b \u7f16\u7801\u3002\u8fd9\u79cd\u7f16\u7801\u589e\u52a0\u4e86\u8f93\u51fa\u6570\u636e\u6d41\u7684\u989d\u5916\u5f00\u9500\uff0c\u4f46\u662f\u4e5f\u5e26\u6765\u4e86\u4e0d\u5c11\u6709\u7528\u7684\u7279\u6027\uff08\u5173\u4e8e\u8fd9\u91cc\u7684\u66f4\u591a\u5185\u5bb9\u8bf7\u89c1\u201c8b/10b \u7f16\u7801\u201d\u4e00\u8282\uff09\u3002PCIe Gen3 \u7684\u7269\u7406\u5c42\u903b\u8f91\u5728\u4f7f\u7528 Gen3 \u901f\u7387\u8fdb\u884c\u4f20\u8f93\u65f6\uff08\u56e0\u4e3a\u4e5f\u53ef\u4ee5\u5411\u4e0b\u517c\u5bb9 Gen1\u3001Gen2 \u901f\u7387\uff09\uff0c\u4e0d\u518d\u4f7f\u7528 8b/10b \u7f16\u7801\u65b9\u5f0f\uff0c\u800c\u662f\u91c7\u7528\u4e86\u53e6\u4e00\u79cd\u88ab\u79f0\u4e3a 128b/130b \u7684\u7f16\u7801\uff0c\u5b83\u4f1a\u5c06\u6570\u636e\u5305\u7684\u5b57\u8282\u6270\u7801\u540e\u8fdb\u884c\u4f20\u8f93\u3002\u6bcf\u4e2a\u901a\u9053\u768410b \u7b26\u53f7\uff08\u5bf9\u4e8eGen1 Gen2\uff09\u6216\u8005\u6bcf\u4e2a\u901a\u9053\u7684\u6570\u636e\u5305\u7684\u5b57\u8282\uff08\u5bf9\u4e8e Gen3\uff09\u968f\u540e\u5c31\u4f1a\u5728\u94fe\u8def\u7684\u6bcf\u4e2a\u901a\u9053\u4e0a\u4ee5\u4e32\u884c\u5dee\u5206\u7684\u5f62\u5f0f\u88ab\u4f20\u8f93\uff0c\u5bf9\u5e94\u7684\u901f\u7387\u4e3a Gen1 2.5GT/s\uff0cGen2 5GT/s\uff0cGen3 8GT/s\u3002</p> <p>\u5f53\u6570\u636e\u5305\u7684\u6bd4\u7279\u5230\u8fbe\u63a5\u6536\u7aef\u65f6\uff0c\u63a5\u6536\u7aef\u4ee5\u8bad\u7ec3\u5f97\u5230\u7684\u65f6\u949f\u901f\u7387\u5bf9\u8fd9\u4e9b\u6570\u636e\u5305\u7684\u6bd4\u7279\u8fdb\u884c\u63a5\u6536\u3002\u5982\u679c\u4f7f\u7528\u7684\u662f 8b/10b \u7f16\u7801\uff0c\u90a3\u4e48\u8f93\u5165\u7684\u6bd4\u7279\u6d41\u5c06\u88ab\u4e32\u5e76\u8f6c\u6362\u5668\u8f6c\u6362\u6210 10 \u6bd4\u7279\u7b26\u53f7\uff0c\u7136\u540e\u51c6\u5907\u7528\u6765\u505a 8b/10b \u89e3\u7801\u3002\u7136\u800c\uff0c\u5728\u89e3\u7801\u4e4b\u524d\uff0c10 \u6bd4\u7279\u7b26\u53f7\u5c06\u4f1a\u7ecf\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\uff0c\u8fd9\u662f\u4e00\u4e2a\u806a\u660e\uff08clever\uff09\u7684\u8bbe\u5907\uff0c\u5b83\u53ef\u4ee5\u5bf9\u4e24\u4e2a\u76f8\u8fde\u63a5\u8bbe\u5907\u5404\u81ea\u5185\u90e8\u65f6\u949f\u4e4b\u95f4\u7684\u5fae\u5c0f\u9891\u7387\u5dee\u5f02\u8fdb\u884c\u8865\u507f\u3002\u63a5\u4e0b\u6765\uff0c10 \u6bd4\u7279\u7b26\u53f7\u88ab 8b/10b \u89e3\u7801\u5668\u89e3\u7801\uff0c\u6b63\u786e\u5730\u6062\u590d\u6210 8 \u6bd4\u7279\u5b57\u7b26\u3002</p> <p>PCIe Gen3 \u4e0e\u524d\u9762\u6240\u8ff0\u7684\u8fd9\u4e2a\u8fc7\u7a0b\u4e0d\u540c\uff0c\u5bf9\u4e8e Gen3 \u7684\u7269\u7406\u5c42\u903b\u8f91\u6765\u8bf4\uff0c\u5f53\u63a5\u6536\u5230\u4ee5 Gen3 \u901f\u7387\u4f20\u8f93\u7684\u6570\u636e\u5305\u4e32\u884c\u6bd4\u7279\u6d41\u65f6\uff0c\u5c06\u4f7f\u7528\u4e32\u5e76\u8f6c\u6362\u5668\u5c06\u8fd9\u4e2a\u6bd4\u7279\u6d41\u8f6c\u6362\u4e3a\u5b57\u8282\u6d41\uff0c\u8fd9\u4e2a\u4e32\u5e76\u8f6c\u6362\u5668\u5df2\u7ecf\u5efa\u7acb\u4e86\u5757\u9501\u5b9a\uff08Block Lock\uff0c\u8fd9\u662f\u94fe\u8def\u8bad\u7ec3\u4e2d\u7684\u4e00\u4e2a\u8981\u7d20\uff09\u3002\u968f\u540e\u5b57\u8282\u6d41\u4f1a\u901a\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\u8fdb\u884c\u65f6\u949f\u5bb9\u5fcd\u5ea6\u8865\u507f\u3002\u5728 Gen3 \u901f\u7387\u4e0b\u6570\u636e\u5305\u6570\u636e\u5e76\u6ca1\u6709\u4f7f\u7528 8b/10b \u7f16\u7801\uff0c\u56e0\u6b64\u53ef\u4ee5\u8df3\u8fc7 8b/10b \u89e3\u7801\u8fd9\u4e00\u6b65\u3002\u6700\u7ec8\uff0c\u6bcf\u4e2a\u901a\u9053\u4e2d\u7684 8 \u6bd4\u7279\u5b57\u7b26\u90fd\u5c06\u7ecf\u8fc7\u89e3\u6270\uff0c\u7136\u540e\u7ecf\u8fc7\u53cd\u6761\u5e26\u5316\uff08de\u2010scrambled\uff09\u4e4b\u540e\u5c06\u6240\u6709\u901a\u9053\u5185\u7684\u5b57\u8282\u805a\u5408\u91cd\u65b0\u6062\u590d\u6210\u5355\u7b26\u53f7\u6d41\uff0c\u8fd9\u6837\u5c31\u5728\u63a5\u6536\u7aef\u6062\u590d\u51fa\u4e86\u53d1\u9001\u7aef\u6240\u53d1\u51fa\u7684\u6570\u636e\u6d41\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2243-link-training-and-initialization","title":"2.2.4.3   \u94fe\u8def\u8bad\u7ec3\u548c\u521d\u59cb\u5316\uff08Link Training and Initialization\uff09","text":"<p>\u7269\u7406\u5c42\u7684\u53e6\u4e00\u4e2a\u4efb\u52a1\u5c31\u662f\u8d1f\u8d23\u94fe\u8def\u7684\u521d\u59cb\u5316\u4ee5\u53ca\u8bad\u7ec3\u8fc7\u7a0b\u3002\u5728\u8fd9\u4e2a\u5168\u81ea\u52a8\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e3a\u4e86\u8ba9\u94fe\u8def\u51c6\u5907\u597d\u8fdb\u884c\u6b63\u5e38\u5de5\u4f5c\uff0c\u6211\u4eec\u91c7\u7528\u4e86\u51e0\u4e2a\u6b65\u9aa4\uff0c\u4e3b\u8981\u4e3a\u786e\u5b9a\u51e0\u4e2a\u53ef\u9009\u6761\u4ef6\u7684\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u94fe\u8def\u5bbd\u5ea6\u53ef\u4ee5\u4ece 1 \u901a\u9053\u5230 32 \u901a\u9053\uff0c\u5e76\u4e14\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u901f\u5ea6\u3002\u94fe\u8def\u8bad\u7ec3\u8fc7\u7a0b\u5c06\u4f1a\u53d1\u73b0\u8fd9\u4e9b\u53ef\u9009\u9879\uff0c\u5e76\u901a\u8fc7\u4e00\u4e2a\u72b6\u6001\u673a\u6765\u5bfb\u6c42\u4e00\u4e2a\u5efa\u7acb\u6700\u4f73\u8fde\u63a5\u7684\u7ec4\u5408\uff0c\u4e5f\u5c31\u662f\u8bf4\u94fe\u8def\u8bad\u7ec3\u5c06\u4f1a\u786e\u8ba4\u8fd9\u4e9b\u53ef\u9009\u9879\u5177\u4f53\u7684\u503c\uff08\u94fe\u8def\u5bbd\u5ea6\u3001\u901f\u7387\u7b49\uff09\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u4e3a\u4e86\u786e\u4fdd\u6267\u884c\u6b63\u786e\u4ee5\u53ca\u6700\u4f18\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u68c0\u67e5\u6216\u8005\u5efa\u7acb\u4e00\u4e9b\u4e1c\u897f\uff0c\u4f8b\u5982\uff1a</p> <ul> <li> <p>\u94fe\u8def\u5bbd\u5ea6\uff08Link width\uff09</p> </li> <li> <p>\u94fe\u8def\u6570\u636e\u7387\uff08Link data rate\uff09</p> </li> <li> <p>\u901a\u9053\u8c03\u8f6c\uff08Lane reversal\uff09\u2014\u2014 \u4ea4\u6362\u591a\u4e2a\u901a\u9053\u95f4\u7684\u8fde\u63a5\u987a\u5e8f</p> </li> <li> <p>\u6781\u6027\u53cd\u8f6c\uff08Polarity inversion\uff09\u2014\u2014 \u901a\u9053\u6781\u6027\u8fde\u63a5\u76f8\u53cd\uff0cTX_P \u5e94\u5f53\u8fde\u63a5\u5bf9\u7aef\u7684 RX_P\uff0c\u82e5\u76f8\u53cd\u5219\u53d8\u6210\u4e86 TX_P \u8fde\u63a5\u4e86\u5bf9\u7aef\u7684 RX_N\u3002</p> </li> <li> <p>\u6bcf\u4e2a\u901a\u9053\u7684\u4f4d\u9501\u5b9a\uff08bit lock\uff09\u2014\u2014 \u6062\u590d\u51fa\u53d1\u9001\u65b9\u7684\u65f6\u949f\u3002</p> </li> <li> <p>\u6bcf\u4e2a\u901a\u9053\u7684\u7b26\u53f7\u9501\u5b9a\uff08symbol lock\uff09\u2014\u2014 \u5728\u6bd4\u7279\u6d41\u4e2d\u627e\u5230\u4e00\u4e2a\u53ef\u8fa8\u8ba4\u7684\u4f4d\u7f6e\u3002</p> </li> <li> <p>\u591a\u901a\u9053\u94fe\u8def\u4e2d\u7684 Lane-to-Lane \u6b6a\u659c\u53bb\u9664\u3002</p> </li> </ul>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2244-physical-layer-electrical","title":"2.2.4.4   \u7535\u6c14\u7269\u7406\u5c42\uff08Physical Layer-Electrical\uff09","text":"<p>\u7269\u7406\u7684\u53d1\u9001\u5668\u548c\u63a5\u6536\u5668\u662f\u901a\u8fc7\u4e00\u4e2a AC \u8026\u5408\u94fe\u8def\u76f8\u8fde\u63a5\uff0c\u5982\u56fe2\u201129 \u6240\u793a\u3002\u6240\u8c13\u201cAC \u8026\u5408\uff08\u4ea4\u6d41\u8026\u5408\uff09\u201d\uff0c\u610f\u601d\u662f\u4e24\u4e2a\u8bbe\u5907\u76f8\u8fde\u63a5\u7684\u7269\u7406\u8def\u5f84\u4e0a\u653e\u7f6e\u6709\u7535\u5bb9\uff0c\u5b83\u7528\u4e8e\u8ba9\u4fe1\u53f7\u7684\u9ad8\u9891\u90e8\u5206\uff08AC \u4ea4\u6d41\uff09\u901a\u8fc7\uff0c\u800c\u963b\u585e\u4f4e\u9891\uff08DC \u76f4\u6d41\uff09\u90e8\u5206\u3002\u8bb8\u591a\u4e32\u884c\u4f20\u8f93\u65b9\u5f0f\u4e2d\u90fd\u4f7f\u7528\u4e86\u8fd9\u79cd\u65b9\u6cd5\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u7684\u5171\u6a21\u7535\u538b\u4e0d\u540c\uff08\u5171\u6a21\u7535\u538b\u6307\u7684\u662f0\u30011\u7535\u5e73\u4ea4\u754c\u5904\u7684\u7535\u538b\uff09\uff0c\u8fd9\u610f\u5473\u7740\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u53c2\u8003\u7535\u538b\u3002\u5f53\u4e24\u4e2a\u8bbe\u5907\u7684\u7269\u7406\u8fde\u63a5\u8ddd\u79bb\u5f88\u8fd1\u65f6\uff0c\u8fd9\u4e00\u7279\u6027\u4f18\u52bf\u5e76\u4e0d\u660e\u663e\uff0c\u800c\u82e5\u5b83\u4eec\u8ddd\u79bb\u8f83\u8fdc\uff0c\u4f8b\u5982\u4f4d\u4e8e\u4e0d\u540c\u7684\u5927\u697c\u91cc\uff0c\u90a3\u4e48\u5b83\u4eec\u5c06\u5f88\u96be\u4f7f\u7528\u4e00\u4e2a\u5b8c\u5168\u76f8\u540c\u7684\u516c\u5171\u7684\u53c2\u8003\u7535\u538b\u3002</p> <p></p> <p>\u56fe2\u201129 \u7535\u6c14\u7269\u7406\u5c42</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#2245-ordered-sets","title":"2.2.4.5   \u5b57\u7b26\u96c6\uff08Ordered Sets\uff09","text":"<p>\u6700\u540e\u8981\u4ecb\u7ecd\u7684\u4e00\u79cd\u53ea\u4f7f\u7528\u7269\u7406\u5c42\u5728\u8bbe\u5907\u4e4b\u95f4\u53d1\u9001\u7684\u6d41\u3002\u5c3d\u7ba1\u8fd9\u79cd\u4fe1\u606f\u5bf9\u4e8e\u63a5\u6536\u7aef\u6765\u8bf4\u5f88\u5bb9\u6613\u8fdb\u884c\u8bc6\u522b\uff0c\u4f46\u662f\u5b83\u5e76\u6ca1\u6709\u88ab\u505a\u6210\u6570\u636e\u5305\u7684\u5f62\u5f0f\uff0c\u539f\u56e0\u662f\u6bd4\u5982\u5b83\u6ca1\u6709\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\u3002\u56e0\u6b64\u4f5c\u4e3a\u4e00\u79cd\u66ff\u4ee3\u65b9\u6cd5\uff0c\u8fd9\u79cd\u4fe1\u606f\u88ab\u7ec4\u7ec7\u6210\u4e86\u4e00\u79cd\u88ab\u53eb\u505a\u201c\u5b57\u7b26\u96c6\uff08Ordered Sets\uff09\u201d\u7684\u4e1c\u897f\uff0c\u5b83\u8d77\u59cb\u4e8e\u53d1\u9001\u7aef\u7684\u7269\u7406\u5c42\uff0c\u7ec8\u6b62\u4e8e\u63a5\u6536\u7aef\u7684\u7269\u7406\u5c42\uff0c\u5982\u56fe2\u201130 \u6240\u793a\u90a3\u6837\u3002\u5bf9\u4e8e Gen1 \u548c Gen2 \u7684\u6570\u636e\u7387\u4e0b\uff0c\u4e00\u4e2a\u5b57\u7b26\u96c6\u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u7684 COM \u5b57\u7b26\u4f5c\u4e3a\u8d77\u59cb\uff0c\u7136\u540e\u540e\u9762\u63a5\u7740 3 \u4e2a\u6216\u4ee5\u4e0a\u7684\u5176\u4ed6\u5b57\u7b26\u7528\u4e8e\u5b9a\u4e49\u8981\u53d1\u9001\u7684\u4fe1\u606f\u3002\u5173\u4e8e\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u5b57\u7b26\u5728 PCIe \u4e2d\u7684\u547d\u540d\u7684\u66f4\u7ec6\u8282\u7684\u8ba8\u8bba\u8bf7\u89c1\u201c\u5b57\u7b26\u7b26\u53f7\uff08Character Notation\uff09\u201d\u4e00\u8282\uff0c\u5bf9\u4e8e\u73b0\u9636\u6bb5\u6765\u8bf4\u53ea\u8981\u77e5\u9053 COM \u5b57\u7b26\u7684\u7279\u6027\u80fd\u8ba9\u6211\u4eec\u8fbe\u5230\u60f3\u8981\u7684\u8bbe\u8ba1\u76ee\u6807\u5373\u53ef\u3002\u5b57\u7b26\u96c6\u7684\u5927\u5c0f\u603b\u662f 4 \u5b57\u8282\u7684\u6574\u6570\u500d\uff0c\u56fe2\u201131 \u5c55\u793a\u4e86\u4e00\u4e2a\u5b57\u7b26\u96c6\u7684\u4f8b\u5b50\u3002\u5728 Gen3 \u64cd\u4f5c\u6a21\u5f0f\u4e2d\uff0c\u5b57\u7b26\u96c6\u7684\u683c\u5f0f\u5c31\u4e0d\u540c\u4e8e\u4e0a\u8ff0\u7684 Gen1/Gen2 \u683c\u5f0f\u4e86\u3002\u66f4\u591a\u8be6\u7ec6\u5185\u5bb9\u8bf7\u89c1\u7b2c\u5341\u56db\u7ae0\u201c\u94fe\u8def\u521d\u59cb\u5316\u548c\u8bad\u7ec3\u201d\u3002\u5b57\u7b26\u96c6\u6c38\u8fdc\u53ea\u4f1a\u7ec8\u6b62\u4e8e\u94fe\u8def\u7684\u5bf9\u7aef\u8bbe\u5907\uff0c\u800c\u4e0d\u4f1a\u88ab\u4ea4\u6362\u673a\u8def\u7531\u8f6c\u53d1\u81f3 PCIe \u7f51\u7edc\u4e2d\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u7aef\u8bbe\u5907\u5982\u679c\u662f\u4ea4\u6362\u673a\u90a3\u4e48\u5b83\u7684\u6700\u7ec8\u76ee\u7684\u5730\u5c31\u662f\u4ea4\u6362\u673a\u3002</p> <p></p> <p>\u56fe2\u201130 \u5b57\u7b26\u96c6\u7684\u51fa\u53d1\u5730\u548c\u76ee\u7684\u5730</p> <p>\u5b57\u7b26\u96c6\u5728\u94fe\u8def\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u540c\u6837\u6709\u5e94\u7528\uff0c\u8bf7\u53c2\u9605\u7b2c\u5341\u56db\u7ae0\u201c\u94fe\u8def\u521d\u59cb\u5316\u548c\u8bad\u7ec3\u201d\u3002\u5b83\u4eec\u4e5f\u88ab\u7528\u4e8e\u8865\u507f\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u5185\u90e8\u65f6\u949f\u7684\u8f7b\u5fae\u5dee\u5f02\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u65f6\u949f\u5bb9\u5fcd\u5ea6\u8865\u507f\u3002\u6700\u540e\u4e00\u70b9\uff0c\u5b57\u7b26\u96c6\u8fd8\u53ef\u4ee5\u7528\u4e8e\u6307\u793a\u94fe\u8def\u8fdb\u5165\u6216\u8005\u9000\u51fa\u4f4e\u529f\u8017\u72b6\u6001\u3002</p> <p></p> <p>\u56fe2\u201131 \u5b57\u7b26\u96c6\u7ed3\u6784</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#23-protocol-review-example","title":"2.3 \u534f\u8bae\u56de\u987e\uff08Protocol Review Example\uff09","text":"<p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u793a\u4f8b\u6765\u56de\u987e\u6574\u4e2a\u94fe\u8def\u534f\u8bae\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u5c06\u4ece\u53d1\u8d77\u65b9\u53d1\u8d77\u4e00\u4e2a\u5185\u5b58\u8bfb\u8bf7\u6c42\uff08MRd\uff09\u5f00\u59cb\uff0c\u76f4\u5230\u53d1\u8d77\u65b9\u4ece\u5b8c\u6210\u65b9\u83b7\u5f97\u6240\u8bf7\u6c42\u7684\u6570\u636e\u4e3a\u6b62\uff0c\u8bb2\u89e3\u8fd9\u8fc7\u7a0b\u4e2d\u6240\u53d1\u751f\u7684\u64cd\u4f5c\u6b65\u9aa4\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#231-memory-read-request","title":"2.3.1     \u5185\u5b58\u8bfb\u8bf7\u6c42\uff08Memory Read Request\uff09","text":"<p>\u5173\u4e8e\u6211\u4eec\u5f00\u59cb\u8ba8\u8bba\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u8bf7\u53c2\u8003\u56fe2\u201132\u3002\u53d1\u8d77\u65b9\u7684\u8bbe\u5907\u6838\u5fc3\u5c42\u6216\u8005\u8bf4\u662f\u8f6f\u4ef6\u5c42\u5c06\u4f1a\u5411\u4e8b\u52a1\u5c42\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u4e2d\u5305\u542b\u4e86\u8fd9\u4e9b\u4fe1\u606f\uff1a32 \u6bd4\u7279\u6216 64 \u6bd4\u7279\u7684\u5185\u5b58\u5730\u5740\u3001\u4e8b\u52a1\u7c7b\u578b\u3001\u9700\u8981\u8bfb\u53d6\u7684\u6570\u91cf\u603b\u91cf\uff08\u4ee5dw\u4e3a\u5355\u4f4d\u8ba1\u6570\uff09\u3001\u6d41\u91cf\u7c7b\u578b\u3001\u5b57\u8282\u4f7f\u80fd\u3001\u5c5e\u6027\u7b49\u7b49\u3002</p> <p></p> <p>\u56fe2\u201132 \u5185\u5b58\u8bfb\u8bf7\u6c42\u7684\u5404\u9636\u6bb5</p> <p>\u4e8b\u52a1\u5c42\u4f7f\u7528\u4e0a\u9762\u6240\u8ff0\u7684\u90a3\u4e9b\u4fe1\u606f\u6765\u6784\u5efa\u4e00\u4e2a MRd TLP\u3002\u5173\u4e8e TLP \u5185\u90e8\u683c\u5f0f\u7684\u7ec6\u8282\u6211\u4eec\u7a0d\u540e\u518d\u8fdb\u884c\u63cf\u8ff0\uff0c\u76ee\u524d\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053 TLP \u7684 Header \u5927\u5c0f\u4e3a 3DW \u6216 4DW\uff0c\u8fd9\u53d6\u51b3\u4e8e\u5b83\u7684\u5730\u5740\u5b57\u6bb5\u7684\u5927\u5c0f\uff0832 \u4f4d\u5730\u5740\u5bf9\u5e94 3DW Header\uff0c64 \u4f4d\u5730\u5740\u5bf9\u5e94 4DW Header\uff09\u3002\u6b64\u5916\uff0c\u5728 Header \u4e2d\u8fd8\u6709\u4e8b\u52a1\u5c42\u52a0\u5165\u7684\u53d1\u8d77\u65b9 ID\u5b57\u6bb5\uff08bus#\uff0cdevice#\uff0cfunction#\uff09\uff0c\u5b8c\u6210\u65b9\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u53d1\u8d77\u65b9 ID \u5b57\u6bb5\u6765\u8fd4\u56de\u5b8c\u6210\u5305\u3002TLP \u968f\u540e\u88ab\u7f6e\u5165\u76f8\u5e94\u4f18\u5148\u7ea7\u7684\u865a\u62df\u901a\u9053\u7f13\u5b58\u4e2d\uff0c\u7b49\u5f85\u8f6e\u5230\u5b83\u88ab\u53d1\u9001\u3002\u4e00\u65e6\u8fd9\u4e2a TLP \u88ab\u9009\u4e2d\uff0c\u6d41\u91cf\u63a7\u5236\u903b\u8f91\u5c06\u4f1a\u786e\u8ba4\u5bf9\u7aef\u8bbe\u5907\u7684\u63a5\u6536\u7f13\u5b58\uff08\u865a\u62df\u901a\u9053\uff09\u6709\u8db3\u591f\u7684\u53ef\u7528\u7a7a\u95f4\u6765\u63a5\u6536\u8fd9\u4e2a TLP\uff0c\u7136\u540e MRd TLP \u5c31\u88ab\u5411\u4e0b\u53d1\u9001\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u5728\u6570\u636e\u94fe\u8def\u5c42\u4e2d\uff0c\u6570\u636e\u5305\u88ab\u52a0\u4e0a 12 \u6bd4\u7279\u7684\u5e8f\u5217\u53f7\u4ee5\u53ca32 \u6bd4\u7279\u7684 LCRC\u3002\u5e76\u5728\u91cd\u4f20\u7f13\u5b58\u4e2d\u4fdd\u5b58\u8fd9\u4e2aTLP\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u7136\u540e\u8fd9\u4e2a\u6570\u636e\u5305\u5c31\u88ab\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\u3002</p> <p>\u5728\u7269\u7406\u5c42\u4e2d\uff0c\u6570\u636e\u5305\u88ab\u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u4ee5\u53ca\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u7136\u540e\u5728\u6240\u6709\u53ef\u7528\u7684\u901a\u9053\u4e0a\u8fdb\u884c\u5b57\u8282\u6761\u5e26\u5316\uff0c\u518d\u8fdb\u884c\u6270\u7801\u30018b/10b \u7f16\u7801\u3002\u6700\u7ec8\u8fd9\u4e2a\u6570\u636e\u5305\u7684\u6bd4\u7279\u5728\u94fe\u8def\u4e0a\u7684\u6bcf\u4e2a\u901a\u9053\u5185\u4ee5\u4e32\u884c\u5dee\u5206\u7684\u5f62\u5f0f\u4f20\u8f93\u5230\u5bf9\u7aef\u3002</p> <p>\u5b8c\u6210\u65b9\u63a5\u6536\u5230\u8f93\u5165\u7684\u6bd4\u7279\u6d41\uff0c\u5b83\u5c06\u8fd9\u4e2a\u6bd4\u7279\u6d41\u5148\u8fdb\u884c\u4e32\u5e76\u8f6c\u6362\u5c06\u6bd4\u7279\u6d41\u6062\u590d\u6210 10 \u6bd4\u7279\u7b26\u53f7\uff0c\u7136\u540e\u8ba9\u5b83\u4eec\u901a\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\u3002\u968f\u540e 10 \u6bd4\u7279\u7b26\u53f7\u88ab\u89e3\u7801\u540e\u6062\u590d\u6210\u5b57\u8282\uff0c\u7136\u540e\u6bcf\u4e2a\u901a\u9053\u4e0a\u7684\u5b57\u8282\u90fd\u88ab\u89e3\u6270\u4ee5\u53ca\u53cd\u6761\u5e26\u5316\u3002\u63a5\u4e0b\u6765\u5b8c\u6210\u65b9\u7269\u7406\u5c42\u68c0\u6d4b\u5230\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u5e76\u5c06\u5b83\u4eec\u4ece TLP \u4e2d\u5265\u9664\u3002\u5269\u4f59\u7684 TLP \u88ab\u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u5b8c\u6210\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u5c06\u5bf9\u63a5\u6536\u5230\u7684 TLP \u8fdb\u884c LCRC \u9519\u8bef\u6821\u9a8c\uff0c\u5e76\u68c0\u67e5 TLP \u5e8f\u5217\u53f7\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728 TLP \u4e22\u5931\u6216 TLP \u5931\u5e8f\u3002\u82e5\u8fd9\u4e9b\u6b65\u9aa4\u90fd\u65e0\u9519\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c06\u751f\u6210\u4e00\u4e2a Ack \u4fe1\u606f\uff0c\u91cc\u9762\u5305\u542b\u4e86\u4e0e\u8fd9\u4e2a MRd TLP \u4e2d\u76f8\u540c\u7684\u5e8f\u5217\u53f7\u3002\u7136\u540e\u518d\u7ed9\u8fd9\u4e2a Ack \u4fe1\u606f\u52a0\u4e0a 16 \u6bd4\u7279\u7684 CRC\uff0c\u8fd9\u6837\u5c31\u7ec4\u6210\u4e86\u4e00\u4e2a Ack DLLP\uff0c\u5c06\u8fd9\u4e2a Ack DLLP \u9001\u56de\u7269\u7406\u5c42\uff0c\u7531\u7269\u7406\u5c42\u52a0\u4e0a\u76f8\u5e94\u7684\u7ec4\u5e27\u7b26\u53f7\uff0c\u5e76\u628a Ack DLLP \u4f20\u8f93\u7ed9\u53d1\u8d77\u65b9\u3002</p> <p>\u53d1\u8d77\u65b9\u7684\u7269\u7406\u5c42\u63a5\u6536\u5230 Ack DLLP \u540e\uff0c\u5bf9\u5176\u7ec4\u5e27\u7b26\u53f7\u8fdb\u884c\u68c0\u67e5\u548c\u5265\u9664\uff0c\u7136\u540e\u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002\u5982\u679c\u6570\u636e\u94fe\u8def\u5c42\u5bf9\u5176 CRC \u6821\u9a8c\u65e0\u9519\uff0c\u5b83\u5c06\u4f1a\u7528 Ack DLLP \u5185\u7684\u5e8f\u5217\u53f7\u4e0e\u91cd\u4f20\u7f13\u5b58\u4e2d\u4fdd\u5b58\u7684 TLP \u526f\u672c\u7684\u5e8f\u5217\u53f7\u8fdb\u884c\u6bd4\u8f83\uff0c\u5e76\u5c06\u4e0e Ack DLLP \u4e2d\u5e8f\u5217\u53f7\u76f8\u5339\u914d\u7684 TLP \u526f\u672c\u4ece\u91cd\u4f20\u7f13\u5b58\u4e2d\u6e05\u9664\u3002\u76f8\u53cd\u5730\uff0c\u82e5\u53d1\u8d77\u65b9\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2a Nak DLLP\uff0c\u90a3\u4e48\u5b83\u5c06\u628a\u5e8f\u5217\u53f7\u5339\u914d\u7684\u8fd9\u4e2a MRd TLP \u8fdb\u884c\u91cd\u4f20\u3002\u7531\u4e8e DLLP \u4ec5\u5bf9\u6570\u636e\u94fe\u8def\u5c42\u6709\u610f\u4e49\uff0c\u6240\u4ee5\u5728\u8fd9\u4e9b DLLP \u7684\u64cd\u4f5c\u4e2d\u5c06\u4e0d\u4f1a\u6709\u4e1c\u897f\u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002</p> <p>\u9664\u4e86\u4e0a\u8ff0\u7684\u4ea7\u751f Ack DLLP \u4e4b\u5916\uff0c\u5b8c\u6210\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u8fd8\u5c06\u628a TLP \u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002\u5728\u5b8c\u6210\u65b9\u7684\u4e8b\u52a1\u5c42\u4e2d\uff0cTLP \u88ab\u7f6e\u4e8e\u4e0e\u5176\u4f18\u5148\u7ea7\u76f8\u5bf9\u5e94\u7684\u865a\u62df\u901a\u9053\u63a5\u6536\u7f13\u5b58\u4e2d\uff0c\u7b49\u5f85\u88ab\u5904\u7406\u3002\u7136\u540e\u53ef\u4ee5\u5bf9 TLP \u8fdb\u884c ECRC \u6821\u9a8c\uff08ECRC \u4e3a\u53ef\u9009\u9879\uff09\uff0c\u82e5\u6821\u9a8c\u65e0\u9519\uff0c\u90a3\u4e48 TLP Header \u7684\u5185\u5bb9\uff08\u5730\u5740\u3001\u53d1\u8d77\u65b9 ID\u3001MRd \u4e8b\u52a1\u7c7b\u578b\u3001\u8bf7\u6c42\u6570\u636e\u603b\u91cf\u3001\u6d41\u91cf\u7c7b\u578b\u7b49\uff09\u5c06\u88ab\u5411\u4e0a\u8f6c\u53d1\u81f3\u5b8c\u6210\u65b9\u7684\u8f6f\u4ef6\u5c42\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#232-cpldcompletion-with-data","title":"2.3.2     Cpld\uff08Completion with Data, \u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff09","text":"<p>\u4e0b\u9762\u5f00\u59cb\u4ecb\u7ecd\u6b64\u6b21\u4e3e\u4f8b\u56de\u987e PCIe \u534f\u8bae\u7684\u53e6\u4e00\u534a\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003\u56fe2\u201133\u3002\u4e3a\u4e86\u670d\u52a1 MRd \u8bf7\u6c42\uff0c\u5b8c\u6210\u65b9\u7684\u8bbe\u5907\u6838\u5fc3\u5c42/\u8f6f\u4ef6\u5c42\u5c06\u4f1a\u5411\u5b83\u7684\u4e8b\u52a1\u5c42\u53d1\u9001\u4e00\u4e2a CplD\uff08Completion with Data\uff0c\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff09\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u5b8c\u6210\u5305\u8bf7\u6c42\u4e2d\u5305\u542b\u4e86\u4e0e MRd \u8bf7\u6c42\u4e2d\u76f8\u540c\u7684\u53d1\u8d77\u65b9 ID\u3001Tag\uff0c\u8fd8\u5305\u542b\u4e86\u4e8b\u52a1\u7c7b\u578b\u4ee5\u53ca\u53e6\u5916\u7684\u5b8c\u6210\u5305\u5934\u5185\u5bb9\uff0c\u5e76\u4e14\u5b8c\u6210\u5305\u4e2d\u8fd8\u5305\u542b\u4e86\u88ab\u8bf7\u6c42\u7684\u6570\u636e\u3002</p> <p></p> <p>\u56fe2\u201133 \u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\u7684\u5404\u9636\u6bb5</p> <p>\u4e8b\u52a1\u5c42\u4f7f\u7528 CplD \u8bf7\u6c42\u4e2d\u7684\u8fd9\u4e9b\u4fe1\u606f\u6765\u6784\u5efa\u4e00\u4e2a CplD TLP\uff0c\u8fd9\u79cd TLP \u7684 Header \u56fa\u5b9a\u4e3a3DW\uff08\u8fd9\u662f\u7531\u4e8e CplD TLP \u4f7f\u7528\u53d1\u8d77\u65b9 ID\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\uff0c\u56e0\u6b64\u4e0d\u4f1a\u9700\u8981\u7528\u5230 64 \u6bd4\u7279\u7684\u5730\u5740\uff09\u3002\u4e8b\u52a1\u5c42\u4e5f\u4f1a\u5c06\u81ea\u8eab\u7684\u5b8c\u6210\u65b9 ID\u6dfb\u52a0\u5230 CplD TLP Header \u4e2d\u3002\u8fd9\u4e2a\u6570\u636e\u5305\u968f\u540e\u88ab\u653e\u7f6e\u5165\u4e00\u4e2a\u5408\u9002\u7684\u865a\u62df\u901a\u9053\u7684\u53d1\u9001\u7f13\u5b58\u4e2d\uff0c\u4e00\u65e6\u8fd9\u4e2a\u865a\u62df\u901a\u9053\u88ab\u4ef2\u88c1\u9009\u4e2d\u5e76\u8981\u53d1\u9001\u8fd9\u4e2a CplD TLP\uff0c\u6d41\u91cf\u63a7\u5236\u903b\u8f91\u5c06\u4f1a\u786e\u8ba4\u5bf9\u7aef\u8bbe\u5907\u6709\u8db3\u591f\u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u6765\u63a5\u6536\u5b83\uff0c\u5f53\u786e\u8ba4\u8db3\u591f\u540e\u5219\u5c06\u8fd9\u4e2a CplD TLP \u5411\u4e0b\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u5982\u524d\u6587\u6240\u8ff0\u90a3\u6837\uff0c\u6570\u636e\u94fe\u8def\u5c42\u7ed9\u6570\u636e\u5305\u52a0\u4e0a 12 \u6bd4\u7279\u7684\u5e8f\u5217\u53f7\u548c 32 \u6bd4\u7279\u7684 LCRC\u3002\u7136\u540e\u5c06\u6dfb\u52a0\u5b8c\u8fd9\u4e9b\u4fe1\u606f\u7684 TLP \u4fdd\u5b58\u4e00\u4efd\u526f\u672c\u5728\u91cd\u4f20\u7f13\u5b58\u4e2d\uff0c\u4e4b\u540e\u53d8\u5c06\u6570\u636e\u5305\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\u3002</p> <p>\u4f9d\u7136\u5982\u524d\u6587\u6240\u8ff0\u90a3\u6837\uff0c\u7269\u7406\u5c42\u7ed9\u6570\u636e\u5305\u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u5e76\u5c06\u5176\u5728\u6240\u6709\u53ef\u7528\u901a\u9053\u4e0a\u8fdb\u884c\u5b57\u8282\u6761\u5e26\u5316\uff0c\u518d\u8fdb\u884c\u6270\u7801\u30018b/10b \u7f16\u7801\u3002\u6700\u7ec8\uff0c\u8fd9\u4e2a CplD TLP \u6570\u636e\u5305\u5728\u94fe\u8def\u7684\u6240\u6709\u901a\u9053\u4e0a\u4ee5\u4e32\u884c\u5dee\u5206\u7684\u5f62\u5f0f\u88ab\u4f20\u8f93\u81f3\u5bf9\u7aef\u3002</p> <p>\u5f53\u53d1\u8d77\u65b9\u63a5\u6536\u5230\u8fd9\u4e2a CplD TLP \u7684\u8f93\u5165\u6bd4\u7279\u6d41\u65f6\uff0c\u5b83\u5c06\u6bd4\u7279\u6d41\u8f6c\u6362\u6062\u590d\u6210 10 \u6bd4\u7279\u7b26\u53f7\uff0810bit symbol\uff09\uff0c\u5e76\u8ba9 10bit \u7b26\u53f7\u6d41\u901a\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\u3002\u968f\u540e 10bit \u7b26\u53f7\u88ab\u89e3\u7801\u6062\u590d\u4e3a\u5b57\u8282\uff0c\u5e76\u8fdb\u884c\u89e3\u6270\u548c\u5b57\u8282\u53cd\u6761\u5e26\u5316\u3002\u7136\u540e\u7269\u7406\u5c42\u5c31\u80fd\u68c0\u6d4b\u5230\u8fd9\u4e2a CplD TLP \u7684\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u5e76\u5c06\u8fd9\u4e24\u4e2a\u5b57\u7b26\u5265\u53bb\u3002\u4e4b\u540e\u4fbf\u5c06\u5269\u4f59\u7684 CplD TLP \u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u548c\u4e4b\u524d\u4e00\u6837\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5bf9 CplD TLP \u8fdb\u884c LCRC \u6821\u9a8c\uff0c\u5e76\u68c0\u67e5\u5e8f\u5217\u53f7\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728 TLP \u4e22\u5931\u6216\u51fa\u73b0 TLP \u5931\u5e8f\u3002\u5982\u679c\u5e76\u672a\u51fa\u73b0\u9519\u8bef\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c06\u4ea7\u751f\u4e00\u4e2a Ack DLLP\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e0e CplD TLP \u4e2d\u76f8\u540c\u7684\u5e8f\u5217\u53f7\uff0c\u5e76\u7ed9\u8fd9\u4e2a Ack DLLP \u52a0\u4e0a 16 \u6bd4\u7279 CRC\uff0c\u7136\u540e\u5c06\u5176\u9001\u56de\u7ed9\u7269\u7406\u5c42\u52a0\u4e0a\u76f8\u5e94\u7684\u7ec4\u5e27\u5b57\u7b26\u5e76\u5c06\u8fd9\u4e2a Ack DLLP \u4f20\u8f93\u7ed9\u5b8c\u6210\u65b9\u3002</p> <p>\u5b8c\u6210\u65b9\u7684\u7269\u7406\u5c42\u5c06\u4f1a\u68c0\u6d4b\u5e76\u5265\u9664 Ack DLLP \u7684\u7ec4\u5e27\u5b57\u7b26\uff0c\u5e76\u5c06\u5269\u4f59\u7684\u90e8\u5206\u5411\u4e0a\u8f6c\u53d1\u7ed9\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5728\u8fd9\u91cc\u5bf9 Ack DLLP \u7684 CRC \u8fdb\u884c\u6821\u9a8c\u3002\u82e5\u6821\u9a8c\u65e0\u9519\uff0c\u5b8c\u6210\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u5c06 Ack DLLP \u4e2d\u7684\u5e8f\u5217\u53f7\u4e0e\u91cd\u4f20\u7f13\u5b58\u4e2d\u7684 TLP \u7684\u5e8f\u5217\u53f7\u8fdb\u884c\u5bf9\u6bd4\u3002\u4e0e Ack DLLP \u5e8f\u5217\u53f7\u76f8\u5339\u914d\u7684 TLP \u5c06\u88ab\u4ece\u91cd\u4f20\u7f13\u5b58\u4e2d\u6e05\u9664\u3002\u53cd\u4e4b\uff0c\u82e5\u5b8c\u6210\u65b9\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2a Nak DLLP\uff0c\u90a3\u4e48\u5b83\u5c06\u4f7f\u7528\u91cd\u4f20\u7f13\u5b58\u4e2d\u5b58\u50a8\u7684 CplD TLP \u526f\u672c\u6765\u8fdb\u884c\u91cd\u4f20\u3002</p> <p>\u4e0e\u6b64\u540c\u65f6\uff0c\u53d1\u8d77\u65b9\u7684\u4e8b\u52a1\u5c42\u5728\u67d0\u4e2a\u865a\u62df\u901a\u9053\u7684\u7f13\u5b58\u4e2d\u63a5\u6536\u5230\u4e86\u8fd9\u4e2a CplD TLP\u3002\u4f5c\u4e3a\u4e00\u4e2a\u53ef\u9009\u64cd\u4f5c\uff0c\u4e8b\u52a1\u5c42\u53ef\u4ee5\u6821\u9a8c\u8fd9\u4e2a TLP \u7684 ECRC\u3002\u82e5\u6821\u9a8c\u65e0\u9519\uff0c\u4e8b\u52a1\u5c42\u5c06\u8fd9\u4e2a CplD TLP \u7684 Header \u5185\u5bb9\u3001\u6570\u636e\u8377\u8f7d\u4ee5\u53ca\u8bf7\u6c42\u5b8c\u6210\u72b6\u6001\u4fe1\u606f\u5411\u4e0a\u5448\u4ea4\u7ed9\u53d1\u8d77\u65b9\u7684\u8f6f\u4ef6\u5c42\u3002\u81f3\u6b64\uff0c\u5927\u529f\u544a\u6210\u3002</p>"},{"location":"pcie/02%20PCIe%20%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E6%A6%82%E8%BF%B0/#_4","title":"\u672f\u8bed\u7ffb\u8bd1","text":"\u82f1\u6587 \u7ffb\u8bd1 Function \u529f\u80fd Endpoint \u7aef\u70b9 Bridge \u6865 Dual-simplex \u53cc\u5355\u5de5 Link \u94fe\u8def Lane \u901a\u9053 bit \u6bd4\u7279 Common Clock \u516c\u5171\u65f6\u949f skew \u504f\u659c Differential Signaling \u5dee\u5206\u4fe1\u53f7 forwarded clock \u968f\u8def\u65f6\u949f Recovered Clock \u6062\u590d\u65f6\u949f deserializer \u89e3\u4e32\u5668 side-band control signal \u8fb9\u5e26\u63a7\u5236\u4fe1\u53f7 Switches \u4ea4\u6362\u673a Root Complex \u6839\u7ec4\u4ef6 forward bridge \u524d\u5411\u6865 reverse bridge \u53cd\u5411\u6865 legacy \u4f20\u7edf configuration header \u914d\u7f6e\u9996\u90e8 Device Core \u8bbe\u5907\u6838\u5fc3\u5c42 Transaction Level \u4e8b\u52a1\u5c42 Data Link Level \u6570\u636e\u94fe\u8def\u5c42 Physical Level \u7269\u7406\u5c42 Ordered set Packet \u5b57\u7b26\u5e8f\u5217\u5305 byte striping logic \u5b57\u8282\u6761\u5e26\u5316\u903b\u8f91 Scrambler \u6270\u7801\u5668 elastic buffers \u5f39\u6027\u7f13\u5b58 de-scrambler \u89e3\u6270\u5668 byte unstriping logic \u5b57\u8282\u53cd\u6761\u5e26\u5316\u903b\u8f91 Link Training and Status State Machine \u94fe\u8def\u8bad\u7ec3\u72b6\u6001\u673a Virtual Channel \u865a\u62df\u901a\u9053 inbound packet \u5165\u7ad9\u6570\u636e\u5305 outbound packet \u51fa\u7ad9\u6570\u636e\u5305 non-posted \u975e\u62a5\u544a\u5f0f Split Transaction Protocol \u62c6\u5206\u4e8b\u52a1\u534f\u8bae requester \u53d1\u8d77\u65b9 completer \u5b8c\u6210\u65b9 framing \u7ec4\u5e27 clock tolerance compensation \u65f6\u949f\u5bb9\u5fcd\u5ea6\u8865\u507f Replay Buffer \u91cd\u4f20\u7f13\u5b58 <p>\u539f\u6587\uff1a  Mindshare</p> <p>\u8bd1\u8005\uff1a  Michael ZZY</p> <p>\u6821\u5bf9\uff1a  XTang</p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/","title":"03 PCIe \u914d\u7f6e\u6982\u8ff0","text":""},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#chapter-3-configuration-overview-pcie","title":"Chapter 3      Configuration Overview //PCIe\u914d\u7f6e\u6982\u8ff0","text":""},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#_1","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u524d\u4e00\u7ae0\u8282\u5bf9PCIe\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u4e86\u5168\u9762\u4ecb\u7ecd\uff0c\u6211\u4eec\u5c06\u5176\u770b\u4f5c\u662f\u4e00\u79cd\u201c\u6267\u884c\u5c42\uff08executive level\uff09\u201d\u6982\u8ff0\u3002\u5b83\u5bf9\u534f\u8bae\u4e2d\u63cf\u8ff0PCIe\u7aef\u53e3\u5206\u5c42\u8bbe\u8ba1\u65b9\u6cd5\u8fdb\u884c\u4e86\u4ecb\u7ecd\u3002\u5728\u4ecb\u7ecd\u4e8b\u52a1\u534f\u8bae\u65f6\u4e5f\u4e00\u5e76\u4ecb\u7ecd\u4e86\u5404\u79cd\u6570\u636e\u5305\u7684\u79cd\u7c7b\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u5bf9\u5982\u4f55\u5bf9PCIe\u73af\u5883\u8fdb\u884c\u914d\u7f6e\u6765\u5c55\u5f00\u4ecb\u7ecd\u3002\u5185\u5bb9\u5305\u62ec\u4e86\u5b9e\u73b0Function\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u7a7a\u95f4\u3001\u5982\u4f55\u53d1\u73b0\u4e00\u4e2aFunction\u3001\u5982\u4f55\u4ea7\u751f\u5e76\u8def\u7531\u8f6c\u53d1\u914d\u7f6e\u4e8b\u52a1\u3001 PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\uff08PCI-compatible configuration space\uff09\u4e0ePCIe\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u7684\u4e0d\u540c\u70b9\uff08PCIe extended configuration space\uff09\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u662f\u5982\u4f55\u533a\u5206\u5f00EP\u548cBridge\u7684\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u7684\u5185\u5bb9\u5c06\u63cf\u8ff0Function\u5982\u4f55\u901a\u8fc7\u57fa\u5740\u5bc4\u5b58\u5668\uff08Base Address Register\uff0cBARs\uff09\u6765\u8bf7\u6c42\u8bbf\u95eememory\u6216\u8005IO\u5730\u5740\u7a7a\u95f4\uff0c\u4ee5\u53ca\u8fd9\u79cd\u8bf7\u6c42\u7684\u76ee\u7684\u4e0e\u4f5c\u7528\uff0c\u5e76\u4e14\u5c06\u4ecb\u7ecd\u8f6f\u4ef6\u662f\u5982\u4f55\u521d\u59cb\u5316\u8fd9\u4e24\u79cd\u5730\u5740\u7a7a\u95f4\u7684\u3002\u53e6\u5916\u5728\u4e0b\u4e00\u7ae0\u8fd8\u4f1a\u63cf\u8ff0Bridge\u7684Base/Limit\u5bc4\u5b58\u5668\uff08\u57fa/\u8fb9\u754c\u5bc4\u5b58\u5668\uff09\u662f\u5982\u4f55\u88ab\u521d\u59cb\u5316\u7684\uff0c\u56e0\u4e3a\u53ea\u6709\u5f53Base/Limit\u5bc4\u5b58\u5668\u521d\u59cb\u5316\u540eSwitch\u624d\u80fd\u5728PCIe\u7f51\u7edc\u4e2d\u8def\u7531\u8f6c\u53d1TLP\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#31-definition-of-busdevice-and-function","title":"3.1 \u603b\u7ebf/\u8bbe\u5907/\u529f\u80fd/\u7684\u5b9a\u4e49\uff08Definition of Bus,Device and Function\uff09","text":"<p>\u6b63\u5982PCI\u4e00\u6837\uff0c\u6bcf\u4e2aPCIe\u529f\u80fd\uff08Function\uff09\u7684\u6807\u8bc6\u5728\u5176\u6240\u5728\u7684\u8bbe\u5907\u5185\uff0c\u4ee5\u53ca\u8fd9\u4e2a\u8bbe\u5907\u6240\u8fde\u63a5\u7684\u603b\u7ebf\u5185\uff0c\u90fd\u662f\u552f\u4e00\u7684\u3002\u5176\u6807\u8bc6\u7b26\u4e00\u822c\u88ab\u79f0\u4e3a\u201cBDF\u201d\u3002\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a PCIe \u62d3\u6251\u7ed3\u6784\uff0c\u914d\u7f6e\u8f6f\u4ef6\u8d1f\u8d23\u68c0\u6d4b\u51fa\u62d3\u6251\u4e2d\u7684\u6bcf\u4e2aBus\u3001Device\u548cFunction\uff0c\u7f29\u5199\u4e3aBDF\u3002\u63a5\u4e0b\u6765\u7684\u51e0\u8282\u5c06\u4f1a\u7ed3\u5408\u4e00\u4e2aPCIe\u62d3\u6251\u7684\u793a\u4f8b\uff0c\u6765\u8ba8\u8bbaBDF\u7684\u4e3b\u8981\u7279\u5f81\u3002\u56fe 3\u20111\u5c55\u793a\u4e86\u4e00\u4e2aPCIe\u62d3\u6251\u7ed3\u6784\uff0c\u56fe\u4e2d\u7740\u91cd\u6807\u8bc6\u4e86\u793a\u4f8b\u7cfb\u7edf\u4e2d\u7684Buses\u3001Devices\u548cFunctions\u3002\u672c\u7ae0\u540e\u7eed\u5185\u5bb9\u5c06\u89e3\u91ca\u603b\u7ebf\u7f16\u53f7\u548c\u8bbe\u5907\u7f16\u53f7\u5206\u914d\u7684\u8fc7\u7a0b\u3002</p> <p></p> <p>\u56fe 3\u20111\u793a\u4f8b\u7cfb\u7edf</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#32-pciepcie-buses","title":"3.2 PCIe\u603b\u7ebf\uff08PCIe Buses\uff09","text":"<p>\u8f6f\u4ef6\u603b\u5171\u53ef\u4ee5\u5206\u914d256\u4e2a\u603b\u7ebf\u7f16\u53f7\u3002\u7b2c\u4e00\u4e2a\u603b\u7ebf\u53f7\uff0cBus 0\uff0c\u901a\u5e38\u7531\u786c\u4ef6\u5206\u914d\u7ed9RC\uff08Root Complex\uff09\u3002Bus 0\u7531\u4e00\u4e2a\u96c6\u6210\u6709EP\u7684\u865a\u62dfPCI\u603b\u7ebf\uff0c\u4e00\u5230\u591a\u4e2a\u865a\u62dfPCI-to-PCI Bridges\uff08P2P\uff09\u7ec4\u6210\u3002\u5176\u4e2d\u7684P2P Bridges\u62e5\u6709\u4e0d\u53ef\u66f4\u6539\u3001\u786c\u4ef6\u7f16\u7801\uff08hard-coded\uff09\u7684\u8bbe\u5907\u53f7\u548c\u529f\u80fd\u53f7\u3002\u6bcf\u4e2aP2P Bridge\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u603b\u7ebf\uff0c\u5176\u4ed6PCIe\u8bbe\u5907\u53ef\u4ee5\u8fde\u63a5\u5728\u5230\u8fd9\u4e9b\u65b0\u4ea7\u751f\u7684\u603b\u7ebf\u4e0a\u53bb\u3002\u6bcf\u4e2a\u603b\u7ebf\u90fd\u5fc5\u987b\u88ab\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684\u603b\u7ebf\u53f7\u3002\u914d\u7f6e\u8f6f\u4ef6\u5206\u914d\u603b\u7ebf\u53f7\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9996\u5148\u4eceBus 0/Device 0/Function 0\u5f00\u59cb\u641c\u7d22\u5176\u4ed6\u7684Bridges\u3002\u5f53\u627e\u5230\u4e00\u4e2aBridge\u4e4b\u540e\uff0c\u8f6f\u4ef6\u5c31\u7ed9\u8fd9\u4e2aBridge\u4ea7\u751f\u7684\u65b0\u603b\u7ebf\u5206\u914d\u4e00\u4e2a\u4e0e\u4e0a\u4e00\u7ea7\u603b\u7ebf\u7684\u603b\u7ebf\u53f7\u4e0d\u540c\u7684\u3001\u6570\u5b57\u66f4\u5927\u7684\u7f16\u53f7\u3002\u4e00\u65e6\u65b0\u603b\u7ebf\u88ab\u5206\u914d\u4e86\u4e00\u4e2a\u603b\u7ebf\u53f7\u4e4b\u540e\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u4ece\u65b0\u603b\u7ebf\u7ee7\u7eed\u641c\u7d22\u66f4\u65b0\u7684Bridges\uff0c\u800c\u4e0d\u662f\u5728\u4e0a\u4e00\u7ea7\u603b\u7ebf\u4e0a\u7ee7\u7eed\u641c\u7d22\u3002\u8fd9\u88ab\u79f0\u4e3a\u201c\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\uff08depth first search\uff09\u201d\uff0c\u5173\u4e8e\u8fd9\u79cd\u641c\u7d22\u7684\u7ec6\u8282\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cEnumeration \u2013 Discovering the Topology\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#33-pciepcie-devices","title":"3.3 PCIe\u8bbe\u5907\uff08PCIe Devices\uff09","text":"<p>PCIe\u5141\u8bb8\u5728\u5355\u4e2aPCI\u603b\u7ebf\u4e0a\u6700\u591a\u6302\u8f7d32\u4e2a\u8bbe\u5907\uff0c\u7136\u800cPCIe\u70b9\u5bf9\u70b9\uff08point-to-point\uff09\u7684\u6027\u8d28\u610f\u5473\u7740\u53ea\u6709\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u76f4\u63a5\u8fde\u63a5\u5728PCIe\u94fe\u8def\u4e0a\uff0c\u4e5f\u5c31\u662fDevice 0\u3002\u4f46\u662f\uff0c\u901a\u8fc7RC\u548cSwitches\u5305\u542b\u7684\u865a\u62dfPCI\u603b\u7ebf\u3002\u66f4\u591a\u7684\u8bbe\u5907\u53ef\u4ee5\u201c\u8fde\u63a5\u201d\u5230\u603b\u7ebf\u4e0a\u3002</p> <p>\u6bcf\u4e2a\u8bbe\u5907\u90fd\u5fc5\u987b\u5b9e\u73b0Function 0\uff0c\u5176\u6700\u591a\u53ef\u4ee5\u67098\u4e2a\u529f\u80fd\uff08Function\uff09\u3002\u5f53\u4e00\u4e2a\u8bbe\u5907\u62e5\u67092\u4e2a\u6216\u4ee5\u4e0a\u7684Function\u65f6\uff0c\u79f0\u4e4b\u4e3a\u591a\u529f\u80fd\u8bbe\u5907\uff08Multi-Function Device\uff09\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#34-pciepcie-functions","title":"3.4 PCIe\u529f\u80fd\uff08PCIe Functions\uff09","text":"<p>\u6b63\u5982\u6b64\u524d\u6240\u8ba8\u8bba\u7684\u4e00\u6837\uff0cFunction\u88ab\u8bbe\u8ba1\u4e3a\u6bcf\u4e2a\u8bbe\u5907\u4e2d\u4e4b\u5185\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\u6b21\u3002\u8fd9\u4e9bFunction\u53ef\u80fd\u5305\u542b\u786c\u76d8\u9a71\u52a8\u63a5\u53e3\u3001\u663e\u793a\u63a7\u5236\u5668\u3001\u4ee5\u592a\u7f51\u63a7\u5236\u5668\u3001USB\u63a7\u5236\u5668\u7b49\u7b49\u3002\u591aFunction\u7684\u8bbe\u5907\u4e0d\u9700\u8981\u4f9d\u6b21\u6309\u7167\u7f16\u53f7\u9010\u4e2a\u5b9e\u73b0 Function\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u53ea\u5b9e\u73b0Function 0\u30012\u30017\u3002\u56e0\u6b64\uff0c\u5f53\u914d\u7f6e\u8f6f\u4ef6\u68c0\u6d4b\u5230\u4e86\u4e00\u4e2a\u591aFunction\u8bbe\u5907\u65f6\uff0c\u5fc5\u987b\u68c0\u67e5\u6240\u6709\u53ef\u80fd\u7684Function\uff0c\u4ee5\u4e86\u89e3\u5f53\u524dDevice\u5b58\u5728\u54ea\u4e9bFunction\u3002\u6bcf\u4e2aFunction\u90fd\u6709\u5b83\u4eec\u81ea\u5df1\u7684\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u7528\u4e8e\u8bbe\u7f6e\u4e0eFunction\u76f8\u5173\u7684\u8d44\u6e90\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#35-configuration-address-space","title":"3.5 \u914d\u7f6e\u5730\u5740\u7a7a\u95f4\uff08Configuration Address Space\uff09","text":"<p>\u521d\u671f\u7684PC\u9700\u8981\u7528\u6237\u8bbe\u7f6e\u5f00\u5173\u548c\u8df3\u7ebf\u6765\u7ed9\u6bcf\u4e2a\u5b89\u88c5\u4e0a\u53bb\u7684\u677f\u5361\u5206\u914d\u8d44\u6e90\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u7ecf\u5e38\u4f1a\u5bfc\u81f4memory\u3001IO\u548c\u4e2d\u65ad\u7684\u8bbe\u7f6e\u51fa\u73b0\u51b2\u7a81\u3002\u8fd9\u4e4b\u540e\u51fa\u73b0\u7684\u4e24\u79cdIO\u67b6\u6784\u2014\u2014\u6269\u5c55ISA\uff08EISA\uff0cExtended ISA\uff09\u548cIBM PS2\u7cfb\u7edf\uff0c\u662f\u521d\u6b21\u5b9e\u73b0\u4e86\u5373\u63d2\u5373\u7528\uff08plug and play\uff09\u7684\u67b6\u6784\u3002\u5728\u8fd9\u4e9b\u67b6\u6784\u4e2d\uff0c\u914d\u7f6e\u6587\u4ef6\u968f\u6bcf\u4e2a\u63d2\u4ef6\u5361\u4e00\u8d77\u88ab\u63d0\u4f9b\uff0c\u5141\u8bb8\u7cfb\u7edf\u8f6f\u4ef6\u5206\u914d\u57fa\u672c\u8d44\u6e90\u3002PCI\u6269\u5c55\u4e86\u8fd9\u79cd\u914d\u7f6e\u7279\u6027\uff0c\u5b83\u901a\u8fc7\u5b9e\u73b0\u6807\u51c6\u5316\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\uff0c\u5141\u8bb8\u901a\u7528\u7684Shrink-Wrapped\uff08\u538b\u7f29\u5305\u88c5\uff09\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u51e0\u4e4e\u6240\u6709\u7684\u7cfb\u7edf\u8d44\u6e90\u3002PCI \u5728\u62e5\u6709\u4e86\u4e00\u4e2a\u6807\u51c6\u5316\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u9519\u8bef\u62a5\u544a\u7684\u5f00\u542f\u4e0e\u5173\u95ed\u3001\u4f20\u9001\u4e2d\u65ad\u3001\u8fdb\u884c\u5730\u5740\u6620\u5c04\u4ee5\u53ca\u66f4\u591a\u5176\u4ed6\u7684\u64cd\u4f5c\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u8f6f\u4ef6\u8fd9\u4e00\u5355\u4e00\u6a21\u5757\uff0c\u6765\u8fdb\u884c\u7cfb\u7edf\u8d44\u6e90\u7684\u5206\u914d\u548c\u914d\u7f6e\uff0c\u8fd9\u6d88\u9664\u4e86\u51e0\u4e4e\u6240\u6709\u7684\u8d44\u6e90\u51b2\u7a81\u3002</p> <p>PCI\u4e3a\u6bcf\u4e2aFunction\u90fd\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4e13\u7528\u7684\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u5757\u3002\u6620\u5c04\u5728\u8fd9\u4e2a\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684\u5bc4\u5b58\u5668\u4eec\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2aFunction\u7684\u5b58\u5728\uff0c\u5e76\u5bf9\u8fd9\u4e2aFunction\u8fdb\u884c\u4e00\u822c\u64cd\u4f5c\u548c\u72b6\u6001\u68c0\u67e5\u3002\u5927\u591a\u6570\u9700\u8981\u6807\u51c6\u5316\u7684\u57fa\u672c\u529f\u80fd\u90fd\u5b58\u5728\u4e8e\u914d\u7f6e\u5bc4\u5b58\u5668\u5757\u7684Header\u4e2d\uff0c\u4f46\u662fPCI\u67b6\u6784\u5e08\u610f\u8bc6\u5230\u82e5\u5c06\u53ef\u9009\u529f\u80fd\uff08option feature\uff0c\u533a\u522b\u4e8e\u524d\u9762\u7684\u57fa\u672c\u529f\u80fd\uff09\u4e5f\u6807\u51c6\u5316\u53ef\u4ee5\u5e26\u6765\u5f88\u591a\u597d\u5904\uff0c\u8fd9\u4e9b\u53ef\u9009\u529f\u80fd\u6807\u51c6\u5316\u540e\u7684\u7ed3\u6784\u88ab\u79f0\u4e3a\u201c\u80fd\u529b\u7ed3\u6784\u201d\uff0c\uff08capability structures\uff0c\u4f8b\u5982\u7535\u6e90\u7ba1\u7406\u3001\u70ed\u63d2\u62d4\u7b49\u7b49\uff09\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2aFunction\uff0c\u90fd\u542b\u6709256byte\u7684PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\uff08PCI-Compatible configuration space\uff09\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#351-pcipci-compatible-space","title":"3.5.1     PCI\u517c\u5bb9\u7a7a\u95f4\uff08PCI-Compatible Space\uff09","text":"<p>\u5728\u9605\u8bfb\u4e0b\u9762\u7684\u8ba8\u8bba\u5185\u5bb9\u65f6\uff0c\u8bf7\u540c\u65f6\u53c2\u9605\u56fe 3\u20112\u3002\u4e4b\u6240\u4ee5\u5c06\u8fd9256Byte\u547d\u540d\u4e3aPCI-compatible configuration space\uff08PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\uff09\uff0c\u662f\u56e0\u4e3a\u8fd9\u4e9b\u914d\u7f6e\u7a7a\u95f4\u539f\u672c\u5c31\u662f\u4e3aPCI\u6240\u8bbe\u8ba1\u7684\u3002\u8fd9\u4e2a\u914d\u7f6e\u7a7a\u95f4\u7684\u524d16DW\uff0864bytes\uff09\u662f\u914d\u7f6e\u5934\u90e8\uff08header\uff09\uff0c\u6709\u4e24\u79cd\u7c7b\u578b\u7684Header\uff0c\u5206\u522b\u4e3aType 0\u548cType 1\u3002Type 0 Header\u5bf9\u4e8e\u6bcf\u4e2aFunction\u90fd\u662f\u5fc5\u987b\u542b\u6709\u7684\uff0c\u9664\u4e86Bridge\uff0c\u5bf9\u4e8eBridge Function\u6765\u8bf4\u5b83\u4f7f\u7528\u7684\u662fType 1 Header\u3002\u5269\u4f59\u768448DW\u662f\u4e00\u4e9b\u53ef\u9009\u5bc4\u5b58\u5668\uff0c\u5305\u62ecPCI\u80fd\u529b\u7ed3\u6784\uff08capability structure\uff09\u3002\u5bf9\u4e8ePCIe Functions\u800c\u8a00\uff0c\u4e00\u90e8\u5206 capability structure\u4e5f\u662f\u5fc5\u987b\u7684\u3002\u4f8b\u5982PCIe Function\u5c31\u5fc5\u987b\u5b9e\u73b0\u5982\u4e0b\u7684\u80fd\u529b\u7ed3\u6784\uff1a</p> <ul> <li> <p>PCI Express\u80fd\u529b\uff08PCI Express Capability\uff09</p> </li> <li> <p>\u7535\u6e90\u7ba1\u7406</p> </li> <li> <p>MSI\u3001MSI-X</p> </li> </ul> <p></p> <p>\u56fe 3\u20112 PCI\u517c\u5bb9\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#352-extended-configuration-space","title":"3.5.2     \u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\uff08Extended Configuration Space\uff09","text":"<p>\u5728\u9605\u8bfb\u4e0b\u9762\u7684\u8ba8\u8bba\u5185\u5bb9\u65f6\uff0c\u8bf7\u540c\u65f6\u53c2\u9605\u56fe 3\u20113\u3002\u5f53\u5f15\u5165PCIe\u4e4b\u540e\uff0c\u6700\u521d\u59cb\u7684256byte\u914d\u7f6e\u7a7a\u95f4\u5df2\u7ecf\u4e0d\u8db3\u4ee5\u653e\u4e0b\u6240\u6709\u65b0\u9700\u8981\u7684Capability Structure\u4e86\u3002\u56e0\u6b64\u914d\u7f6e\u7a7a\u95f4\u7684\u5927\u5c0f\u4ece\u539f\u5148\u7684\u6bcf\u4e2aFunction 256Byte\u6269\u5c55\u81f3\u4e86\u6bcf\u4e2aFunction 4KByte\u3002\u65b0\u589e\u52a0\u51fa\u6765\u7684960DW\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u53ea\u80fd\u901a\u8fc7\u589e\u5f3a\u914d\u7f6e\u673a\u5236\uff08Enhanced configuration mechanism\uff09\u6765\u8fdb\u884c\u8bbf\u95ee\uff0c\u56e0\u4e3a\u4f20\u7edf\u7684PCI\u8f6f\u4ef6\u65e0\u6cd5\u53d1\u73b0\u8fd9\u4e2a\u533a\u57df\u5e76\u8fdb\u884c\u8bbf\u95ee\uff0c\u6240\u4ee5\u8fd9\u90e8\u5206\u533a\u57df\u5bf9\u4e8e PCI \u662f\u4e0d\u53ef\u89c1\u7684\u3002\u5728\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u5185\u5305\u542b\u4e86\u65b0\u589e\u52a0\u7684PCIe\u53ef\u9009\u6269\u5c55\u80fd\u529b\u5bc4\u5b58\u5668\uff08Extended Capability register\uff09\uff0c\u56fe 3\u20113\u7f57\u5217\u51fa\u4e86\u4e00\u90e8\u5206\u6269\u5c55\u80fd\u529b\u5bc4\u5b58\u5668\u3002</p> <p></p> <p>\u56fe 3\u20113\u6bcf\u4e2aPCIe Function\u6240\u62e5\u6709\u76844KB\u914d\u7f6e\u7a7a\u95f4</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#36-host-to-pci-bridge","title":"3.6 Host-to-PCI Bridge\u914d\u7f6e\u5bc4\u5b58\u5668","text":""},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#361-general","title":"3.6.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5bf9Host-to-Bridge\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u8bbf\u95ee\u4e0d\u5fc5\u4f7f\u7528\u524d\u9762\u7684\u7ae0\u8282\u6240\u63d0\u5230\u7684\u914d\u7f6e\u673a\u5236\uff0c\u5728\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u5b83\u901a\u5e38\u6620\u5c04\u4e3a\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\uff0c\u8fd9\u5bf9\u5e73\u53f0\u56fa\u4ef6\u662f\u5df2\u77e5\u7684\u3002\u7136\u800c\uff0c\u5b83\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u683c\u5f0f\u6392\u5e03\u548c\u7528\u6cd5\u90fd\u5fc5\u987b\u9075\u4ecePCI 2.3\u534f\u8bae\u89c4\u8303\u4e2d\u6240\u5b9a\u4e49\u7684Type 0\u6a21\u677f\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#362-rconly-the-root-sends-configuration-request","title":"3.6.2     \u53ea\u6709RC\u53d1\u9001\u914d\u7f6e\u8bf7\u6c42\uff08Only the Root Sends Configuration Request\uff09","text":"<p>\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u58f0\u660e\u4e86\uff0c\u53ea\u6709RC\u53ef\u4ee5\u53d1\u8d77\u914d\u7f6e\u8bf7\u6c42\u3002RC\u4f5c\u4e3a CPU \u4e0e PCIe \u62d3\u6251\u7684\u8054\u7edc\u5458\uff0c\u5176\u4f20\u5165 CPU \u7684 PCIe \u8bf7\u6c42\u5305\u5e76\u5728 PCIe \u4e8b\u52a1\u5b8c\u6210\u540e\u5411\u5904\u7406\u5668\u62a5\u544a\u3002\u4e4b\u6240\u4ee5\u9650\u5236 CPU \u53ea\u80fd\u901a\u8fc7RC\u53d1\u8d77\u914d\u7f6e\u4e8b\u52a1\uff0c\u662f\u56e0\u4e3a\u8981\u662f\u5176\u4ed6\u8bbe\u5907\u4e5f\u6709\u8fd9\u79cd\u80fd\u529b\uff0c\u90a3\u4e48\u4ed6\u4eec\u53ef\u4ee5\u4efb\u610f\u6539\u53d8\u914d\u7f6e\u5185\u5bb9\uff0c\u8fd9\u6837\u5c31\u4f1a\u5e26\u6765\u6df7\u4e71\u3002</p> <p>\u7531\u4e8e\u53ea\u6709RC\u80fd\u53d1\u8d77\u8fd9\u4e9b\u914d\u7f6e\u8bf7\u6c42\uff0c\u6240\u4ee5\u8fd9\u4e9b\u914d\u7f6e\u8bf7\u6c42\u53ea\u80fd\u5728\u62d3\u6251\u4e2d\u5411\u4e0b\u8f6c\u53d1\uff0c\u610f\u5473\u7740Peer-to-Peer\u7684\u914d\u7f6e\u8bf7\u6c42\u662f\u88ab\u65e0\u6cd5\u5b9e\u73b0\u7684\u3002\u8bf7\u6c42\u5305\u4f7f\u7528\u76ee\u7684\u8bbe\u5907ID\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u8fdb\u884c\u8def\u7531\u8f6c\u53d1\uff0c\u8fd9\u4e2a\u76ee\u7684\u8bbe\u5907ID\u5c31\u662f\u5b83\u7684BDF\uff08\u62d3\u6251\u4e2d\u7684Bus\u7f16\u53f7\uff0cBus\u4e0a\u7684Device\u7f16\u53f7\uff0cDevice\u4e2d\u7684Function\u7f16\u53f7\uff09\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#37-generating-configuration-transactions","title":"3.7 \u751f\u6210\u914d\u7f6e\u4e8b\u52a1\uff08Generating Configuration Transactions\uff09","text":"<p>\u5904\u7406\u5668\u4e00\u822c\u65e0\u6cd5\u76f4\u63a5\u8fdb\u884c\u914d\u7f6e\u8bfb\u5199\u8bf7\u6c42\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53ea\u80fd\u4ea7\u751fmemory\u8bf7\u6c42\u548cIO\u8bf7\u6c42\u3002\u8fd9\u610f\u5473\u7740RC\u9700\u8981\u5c06 CPU \u7684\u5176\u4ed6\u7c7b\u578b\u8bbf\u95ee\u8f6c\u6362\u6210\u914d\u7f6e\u8bf7\u6c42\uff0c\u8fd9\u6837\u624d\u80fd\u8fdb\u884c\u914d\u7f6e\u7684\u64cd\u4f5c\u8fc7\u7a0b\u3002\u914d\u7f6e\u7a7a\u95f4\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u673a\u5236\u8fdb\u884c\u8bbf\u95ee\uff1a</p> <ul> <li> <p>\u4f20\u7edf\u7684PCI\u914d\u7f6e\u673a\u5236\uff0c\u4f7f\u7528IO\u95f4\u63a5\u8bbf\u95ee\uff08IO-indirect access\uff09</p> </li> <li> <p>\u589e\u5f3a\u578b\u914d\u7f6e\u673a\u5236\uff0c\u4f7f\u7528\u5185\u5b58\u6620\u5c04\u8bbf\u95ee\uff08memory-mapped access\uff09</p> </li> </ul>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#371-pcilegacy-pci-mechanism","title":"3.7.1     \u4f20\u7edfPCI\u673a\u5236\uff08Legacy PCI Mechanism\uff09","text":"<p>\u5728PCI\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u4e86IO-indirect\u65b9\u6cd5\uff0c\u7528\u6765\u6307\u793a\u7cfb\u7edf\uff08RC\u6216\u5176\u7b49\u6548\u7684\u7ec4\u4ef6\uff09\u8fdb\u884cPCI\u914d\u7f6e\u8bbf\u95ee\u3002\u5728\u5f53\u65f6\u7684\u5386\u53f2\u80cc\u666f\u4e0b\uff0c\u5360\u4e3b\u5bfc\u5730\u4f4d\u7684PC\u5904\u7406\u5668\uff08Intel x86\uff09\u88ab\u8bbe\u8ba1\u4e3a\u4ec5\u80fd\u5bfb\u574064KB\u7684IO\u5730\u5740\u7a7a\u95f4\u3002\u5728 PCI \u534f\u8bae\u4ea7\u751f\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6709\u9650\u7684IO\u7a7a\u95f4\u5df2\u7ecf\u53d8\u5f97\u975e\u5e38\u6df7\u4e71\uff0c\u53ea\u6709\u5c11\u6570\u51e0\u4e2a\u53ef\u7528\u7684\u5730\u5740\u8303\u56f4\uff1a0800h-08FFh\uff0c\u548c0C00h-0CFFh\u3002\u56e0\u6b64\uff0c\u5c06\u6240\u6709\u53ef\u80fd\u7684Function\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u90fd\u6620\u5c04\u5230IO\u7a7a\u95f4\u662f\u4e0d\u53ef\u884c\u7684\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u4e5f\u5341\u5206\u6709\u9650\uff0c\u5c06\u8fd9\u4e9b\u914d\u7f6e\u7a7a\u95f4\u90fd\u6620\u5c04\u8fdb\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u4e5f\u4e0d\u662f\u4e2a\u597d\u65b9\u6cd5\u3002\u4e8e\u662f\uff0c\u534f\u8bae\u89c4\u8303\u7684\u4f5c\u8005\u4f7f\u7528\u4e86\u4e00\u79cd\u5e38\u7528\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f7f\u7528\u95f4\u63a5\u5730\u5740\u6620\u5c04\uff08indirect address mapping\uff09\u3002\u4e3a\u6b64\uff0c\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u5bc4\u5b58\u5668\u4fdd\u5b58\u76ee\u6807\u5730\u5740\uff0c\u540c\u65f6\u7528\u7b2c\u4e8c\u4e2a\u5bc4\u5b58\u5668\u4fdd\u5b58\u6765\u81ea\u6216\u662f\u53d1\u5f80\u76ee\u6807\u7684\u6570\u636e\u3002\u4e00\u6b21\u5bf9\u76ee\u6807Function\u7684\u4e00\u6b21\u8bfb\u5199\u4e8b\u52a1\uff0c\u9700\u8981\u5148\u5c06\u5f85\u8bbf\u95ee\u7684\u5730\u5740\u5199\u5165\u5730\u5740\u5bc4\u5b58\u5668\uff0c\u968f\u540e\u518d\u8bfb\u5199\u6570\u636e\u5bc4\u5b58\u5668\u3002\u8fd9\u5f88\u597d\u7684\u89e3\u51b3\u4e86\u5730\u5740\u7a7a\u95f4\u6709\u9650\u7684\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u610f\u5473\u7740\u4ea7\u751f\u4e00\u6b21\u914d\u7f6e\u8bbf\u95ee\u9700\u8981\u4e24\u6b21IO\u8bbf\u95ee\u3002</p> <p>PCI\u517c\u5bb9\u673a\u5236\u4f7f\u7528RC\u7684Host Bridge\u4e2d\u7684\u4e24\u4e2a32bit\u7684IO\u7aef\u53e3\u3002\u5b83\u4eec\u5206\u522b\u662f**\u914d\u7f6e\u5730\u5740\u7aef\u53e3**\uff08Configuration Address Port\uff09\uff0c\u4f4d\u4e8eIO\u5730\u5740\u533a\u57df0CF8h-0CFBh\uff0c\u548c**\u914d\u7f6e\u6570\u636e\u7aef\u53e3**\uff08Configuration Data Port\uff09\uff0c\u4f4d\u4e8eIO\u5730\u5740\u533a\u57df0CFCh-0CFFh\u3002</p> <p>\u8981\u8bbf\u95ee\u4e00\u4e2aFunction\u7684PCI\u517c\u5bb9\u914d\u7f6e\u5bc4\u5b58\u5668\uff0c\u9996\u5148\u8981\u5c06\u76ee\u6807\u7684Bus\u3001Device\u3001Function\u548cDW\u53f7\u5199\u5165\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff0c\u5e76\u5c06\u5176\u4f7f\u80fdbit\u7f6e\u4e3a\u6709\u6548\u3002\u7136\u540e\u7b2c\u4e8c\u6b65\uff0c\u4e00\u4e2a1\u62162\u62164Byte\u7684IO\u8bfb\u6216\u5199\u5c06\u4f1a\u53d1\u9001\u5230\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u3002RC\u7684Host Bridge\u5c06\u5bf9\u7ed9\u5b9a\u7684\u76ee\u6807\u603b\u7ebf\u548c\u5728Bridge\u4e0b\u73b0\u5b58\u7684\u603b\u7ebf\u8303\u56f4\u8fdb\u884c\u6bd4\u8f83\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u5728\u8fd9\u4e2a\u8303\u56f4\u5185\uff0c\u8fd9\u4e2aBridge\u5219\u4f1a\u53d1\u8d77\u914d\u7f6e\u8bfb\u6216\u5199\u8bf7\u6c42\uff08\u8fd9\u53d6\u51b3\u4e8e\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684IO\u8bbf\u95ee\u662f\u8bfb\u64cd\u4f5c\u8fd8\u662f\u5199\u64cd\u4f5c\uff09\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3711-configuration-address-port","title":"3.7.1.1   \u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09","text":"<p>\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u4ec5\u5728\u5904\u7406\u5668\u5bf9\u5176\u5b8c\u6210\u4e00\u4e2a\u5b8c\u6574\u768432bit\u5199\u64cd\u4f5c\u65f6\uff0c\u9501\u5b58\u4f4f\u5199\u5165\u7684\u4fe1\u606f\uff0c\u5982\u56fe 3\u20114\uff0c\u82e5\u5bf9\u8fd9\u4e2a\u7aef\u53e3\u8fdb\u884c\u8bfb\u64cd\u4f5c\u5219\u4f1a\u8fd4\u56de\u5b83\u7684\u8fd9\u4e9b\u5185\u5bb9\u3002\u5199\u5165\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u7684\u4fe1\u606f\u5fc5\u987b\u9075\u7167\u4e0b\u9762\u6240\u63cf\u8ff0\u7684\u683c\u5f0f\uff08\u56fe 3\u20114\uff09\u3002</p> <p></p> <p>\u56fe 3\u20114\u5730\u5740\u4f4d\u4e8e0CF8h\u7684\u914d\u7f6e\u5730\u5740\u7aef\u53e3</p> <ul> <li> <p>Bits[1:0]\u56fa\u5b9a\u4e3a0\u4e0d\u53d8\uff0c\u4e14\u53ea\u8bfb\u7684\uff0c\u5728\u8bfb\u53d6\u65f6\u53ea\u80fd\u8fd4\u56de**0**\u3002\u5b83\u7684\u4f4d\u7f6e\u662fDW\u5bf9\u9f50\u7684\uff0c\u4e0d\u5141\u8bb8\u6307\u5b9a\u5b57\u8282\uff08byte-specific\uff09\u504f\u79fb\u91cf\u3002</p> </li> <li> <p>Bits[7:2]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Function\u7684PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\u5185\u7684**\u76ee\u6807DW**\uff08target dword\uff0c\u5176\u4e5f\u88ab\u79f0\u4f5c\u5bc4\u5b58\u5668\u53f7\uff09\uff0c\u4e5f\u5c31\u662f\u7528\u6765\u6807\u8bc6Function\u5185\u7684\u5bc4\u5b58\u5668\u53f7\uff0c\u8981\u6c42\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5fc5\u987b\u4f4d\u4e8e\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\u4e2d\u3002\u8fd9\u79cd\u673a\u5236\u4ec5\u9650\u4e8e\u517c\u5bb9 PCI \u7684\u914d\u7f6e\u7a7a\u95f4\u4e2d\u4f7f\u7528\u3002\uff08\u4f8b\u5982\u4e00\u4e2aFunction\u914d\u7f6e\u7a7a\u95f4\u7684\u524d64DW\uff09\u3002</p> </li> <li> <p>Bits[10:8]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Device\u5185\u7684\u76ee\u6807Function\u53f7(0-7)\u3002</p> </li> <li> <p>Bits[15:11]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Device\u53f7(0-31)\u3002</p> </li> <li> <p>Bits[23:16]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Bus\u53f7(0-255)\u3002</p> </li> <li> <p>Bits[30:24]\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a0\u3002</p> </li> <li> <p>Bit[31]\u4e3a\u4f7f\u80fd\u4f4d\uff0c\u82e5\u8981\u5c06\u968f\u540e\u7684\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684IO\u8bbf\u95ee\u8f6c\u6362\u4e3a\u914d\u7f6e\u8bbf\u95ee\u5219\u5fc5\u987b\u8981\u5c06\u8be5bit\u7f6e\u4e3a1\u3002\u5f53\u8be5bit\u4e3a0\u65f6\uff0c\u82e5\u6709IO\u8bfb\u6216\u8005IO\u5199\u88ab\u53d1\u9001\u5230\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff0c\u90a3\u4e48\u8fd9\u4e9b\u4e8b\u52a1\u90fd\u4f1a\u88ab\u5f53\u6210\u666e\u901a\u7684IO\u8bf7\u6c42\u6765\u5904\u7406\u3002</p> </li> </ul>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3712-bus-compare-and-data-port-usage","title":"3.7.1.2   \u603b\u7ebf\u6bd4\u8f83\u548c\u6570\u636e\u7aef\u53e3\u7684\u4f7f\u7528\uff08Bus Compare and Data Port Usage\uff09","text":"<p>\u5982\u56fe 3\u20115\uff0cRC\u5185\u7684Host Bridge\u5b9e\u73b0\u4e86\u4e00\u4e2a\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09\u5bc4\u5b58\u5668\u548c\u4e00\u4e2a\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09\u5bc4\u5b58\u5668\u3002\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08\u56fe 3-5 \u4e2d\u7684 Sec\uff09\u6307\u7684\u662f\u5f53\u524dBridge\u4e0b\u76f4\u63a5\u8fde\u63a5\u7684\u603b\u7ebf\u7684\u7f16\u53f7\uff0c\u4f8b\u5982\u56fe\u4e2dRC\u7684Host/PCI Bridge\u4ea7\u751f\u4e86Bus 0\uff0c\u56e0\u6b64Host/PCI Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5c31\u662f0\u3002\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08\u56fe 3-5 \u4e2d\u7684 Sub\uff09\u6307\u7684\u662fBridge\u4e4b\u4e0b\u7684\u53ef\u4f5c\u4e3a\u76ee\u6807\u603b\u7ebf\u7684\u603b\u7ebf\u53f7\uff0c\u4f8b\u5982\u56fe\u4e2dDevice 1\u7684Sub=9\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u5728Device 1\u4e0b\u6e38\u6700\u5927\u7684\u603b\u7ebf\u53f7\u662f Bus 9\uff0c\u800c\u5b83\u7684Sec=5\u5219\u8bf4\u660e\u5176\u4e0b\u6e38\u7684\u603b\u7ebf\u53f7\u7f16\u53f7\u4ece Bus 5 \u5f00\u59cb\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662fSec\u548cSub\u5171\u540c\u6307\u5b9a\u51fa\u4e86\u8fd9\u4e2a\u8bbe\u5907\u4e0b\u53ef\u8bbf\u95ee\u603b\u7ebf\u7684\u8303\u56f4\uff08\u5bf9\u4e8eDevice 1\u6765\u8bf4\u5c31\u662f5-9\uff09\u3002</p> <p>\u5728\u4e00\u4e2a\u5355RC\u7684\u7cfb\u7edf\u4e2d\uff0cHost-Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5e94\u8be5\u88ab\u56fa\u5b9a\u4e3a0\uff0c\u4e5f\u5c31\u662f\u5b83\u7684\u53ef\u8bfb\u53ef\u5199\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u4ece\u4e00\u590d\u4f4d\u5c31\u88ab\u5f3a\u5236\u7f6e\u4e3a0\uff0c\u6216\u8005\u8bf4\uff0cHost-Bridge\u77e5\u9053\u5b83\u8bbf\u95ee\u5230\u7684\u7b2c\u4e00\u4e2a\u603b\u7ebf\u4e00\u5b9a\u662fBus 0\u3002\u82e5\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff0c\u89c1\u56fe 3\u20114\uff09\u7684bit 31\u88ab\u7f6e\u4e3a1\uff0c\u90a3\u4e48Bridge\u5c31\u4f1a\u5c06\u76ee\u6807\u603b\u7ebf\u53f7\u4e0eBridge\u4e4b\u4e0b\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u6b64\u6765\u68c0\u67e5\u8fd9\u4e2a\u76ee\u6807\u603b\u7ebf\u662f\u5426\u4ece\u5c5e\u4e8e\u5f53\u524dBridge\u4e4b\u4e0b\u3002</p> <p>\u5f53Bridge\u6536\u5230\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5b83\u5c06\u4f1a\u8bc4\u4f30\u76ee\u6807\u603b\u7ebf\u53f7\u662f\u5426\u5728\u5176\u4e0b\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u8303\u56f4\u5185\uff0c\u8fd9\u4e2a\u8303\u56f4\u5927\u4e8e\u7b49\u4e8e\u4ece\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Sec\uff09\uff0c\u5c0f\u4e8e\u7b49\u4e8e\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Sub\uff09\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u53f7\u4e0e\u5f53\u524d\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u8bf4\u660e\u5f53\u524d\u7684\u6b21\u7ea7\u603b\u7ebf\u5c31\u662f\u76ee\u6807\u603b\u7ebf\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5c31\u4f1a\u88ab\u4f5c\u4e3a\u4e00\u4e2a**Type 0\u914d\u7f6e\u8bf7\u6c42**\u6765\u4f20\u8f93\u3002\u5f53\u8bbe\u5907\u4eec\u6536\u5230\u4e00\u4e2aType 0\u8bf7\u6c42\uff0c\u5b83\u4eec\u5c31\u77e5\u9053\u5f53\u524d\u4e00\u7ea7\u672c\u5730\u603b\u7ebf\u4e0a\u7684\u67d0\u4e2a\u8bbe\u5907\u5c31\u662f\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\uff08\u800c\u4e0d\u662f\u5728\u66f4\u4e0b\u4e00\u7ea7\u7684\u603b\u7ebf\u6240\u5c5e\u7684\u8bbe\u5907\uff09\u3002</p> <p>\u82e5\u76ee\u6807\u603b\u7ebf\u53f7\u8981\u5927\u4e8eBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Sec\uff09\uff0c\u4f46\u662f\u5c0f\u4e8e\u6216\u8005\u7b49\u4e8eBridge\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Sub\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bf7\u6c42\u5c06\u4f1a\u4f5c\u4e3a**Type 1\u914d\u7f6e\u8bf7\u6c42**\u88ab\u8f6c\u53d1\u5230Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\u3002\u5bf9\u4e8e\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\uff0c\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\u5b83\uff1a\u5c3d\u7ba1\u8fd9\u4e2a\u8bf7\u6c42\u9700\u8981\u7ecf\u8fc7\u8fd9\u6761\u603b\u7ebf\uff0c\u4f46\u662f\u5b83\u7684\u76ee\u6807\u8bbe\u5907\u5e76\u4e0d\u5728\u8fd9\u4e00\u7ea7\u603b\u7ebf\u4e0a\uff0c\u76f8\u53cd\u5730\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5c06\u4f1a\u7531\u5f53\u524d\u603b\u7ebf\u4e0a\u7684Bridge\u4eec\u5411\u4e0b\u8f6c\u53d1\u5230\u5404\u81ea\u7684\u4e0b\u4e00\u7ea7\u603b\u7ebf\u4e0a\uff0c\u5f53\u7136\u8f6c\u53d1\u8be5Type 1\u914d\u7f6e\u8bf7\u6c42\u7684Bridge\u5fc5\u987b\u662f\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5305\u542b\u4e86\u76ee\u6807\u603b\u7ebf\u7684\u3002\u6240\u6709\uff0cType 1\u914d\u7f6e\u8bf7\u6c42\u53ea\u5bf9Bridge\u8bbe\u5907\u6709\u4f5c\u7528\u3002\u66f4\u591a\u5173\u4e8eType 0\u548cType 1\u914d\u7f6e\u8bf7\u6c42\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201cConfiguration Request\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3713-hostsingle-host-system","title":"3.7.1.3   \u5355Host\u7cfb\u7edf\uff08Single Host System\uff09","text":"<p>RC\u4e2d\u7684Host/PCI Bridge\u4f1a\u5c06\u5199\u5165\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09\u7684\u4fe1\u606f\u9501\u5b58\u8d77\u6765\uff0c\u5982\u56fe 3\u20111\u3002\u82e5bit 31\u88ab\u7f6e\u4e3a1\u4e14\u76ee\u6807\u603b\u7ebf\u5728\u5f53\u524dBridge\u4e0b\u65b9\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u90a3\u4e48Bridge\u5c06\u628a\u63a5\u4e0b\u6765\u7684\u5904\u7406\u5668\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08Configuration Data Port\uff09\u7684\u8bbf\u95ee\u8f6c\u6362\u6210\u9488\u5bf9Bus 0\u7684\u914d\u7f6e\u8bf7\u6c42\u3002\u5904\u7406\u5668\u5c06\u4f1a\u5411\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff080CFCh\uff09\u53d1\u8d77\u4e00\u4e2aIO\u8bfb\u8bf7\u6c42\u6216\u8005\u4e00\u4e2aIO\u5199\u8bf7\u6c42\u3002\u8fd9\u4fc3\u4f7fBridge\u751f\u6210\u4e00\u4e2a\u914d\u7f6e\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u662f\u8bfb\u8bf7\u6c42\u8fd8\u662f\u5199\u8bf7\u6c42\u53d6\u51b3\u4e8eIO\u8bbf\u95ee\u662f\u8bfb\u8fd8\u662f\u5199\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u4e3aBus 0\uff0c\u90a3\u4e48\u5b83\u5c06\u662f\u4e00\u4e2aType 0\u914d\u7f6e\u8bf7\u6c42\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u662f\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\u7684\u5176\u4ed6\u603b\u7ebf\uff0c\u90a3\u4e48\u5b83\u5c06\u662f\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u4e0d\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u8fd9\u4e2aBridge\u5c06\u4e0d\u4f1a\u5bf9\u8fd9\u4e2a\u8bf7\u6c42\u8fdb\u884c\u8f6c\u53d1\u64cd\u4f5c\u3002</p> <p></p> <p>\u56fe 3\u20115 \u5355Root\u7cfb\u7edf</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3714-hostmulti-host-system","title":"3.7.1.4   \u591aHost\u7cfb\u7edf\uff08Multi-Host System\uff09","text":"<p>\u82e5\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u5b58\u5728\u591a\u4e2aRC\uff0c\u5982\u56fe 3\u20116\u6240\u793a\uff0c\u90a3\u4e48\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u548c\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u5c06\u88ab\u8fd9\u4e24\u4e2aRC\u5404\u81ea\u7684Host/PCI Bridge\u590d\u7528\uff0c\u4e14\u4e24\u79cd\u914d\u7f6e\u7aef\u53e3\u5404\u81ea\u7684IO\u5730\u5740\u5728\u4e24\u4e2aHost/PCI Bridge\u4e2d\u76f8\u540c\uff0c\u4e5f\u5c31\u662f\u4e24\u4e2aRC\u4f7f\u7528\u76f8\u540c\u7684\u4e00\u4e2aIO\u5730\u5740\u6765\u8bbf\u95ee\u5404\u81ea\u914d\u7f6e\u5730\u5740\u5bc4\u5b58\u5668\uff0c\u540c\u7406\uff0c\u8bbf\u95ee\u914d\u7f6e\u6570\u636e\u5bc4\u5b58\u5668\u4e5f\u662f\u3002\u4e3a\u4e86\u9632\u6b62\u4e89\u7528\uff0c\u5728\u4e24\u4e2aHost/PCI Bridge\u4e2d\u540c\u65f6\u53ea\u80fd\u6709\u4e00\u4e2a\u54cd\u5e94\u5904\u7406\u5668\u5bf9\u914d\u7f6e\u7aef\u53e3\u7684\u8bbf\u95ee\u3002</p> <ol> <li> <p>\u5f53\u5904\u7406\u5668\u53d1\u8d77\u5bf9\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684IO\u5199\u64cd\u4f5c\u65f6\uff0c\u901a\u8fc7\u914d\u7f6e\u4e24\u4e2aHost Bridge\uff08 the host bridges are configured, //TODO\uff09\uff0c\u4ec5\u6709\u4e00\u4e2aHost Bridge\u4f1a\u53c2\u4e0e\u5230\u6b64\u6b21\u4e8b\u52a1\u4e2d\u6765\u3002</p> </li> <li> <p>\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\uff08Enumeration\uff09\uff0c\u8f6f\u4ef6\u5c06\u641c\u7d22\u6240\u6709\u6d3b\u8dc3\uff08active\uff09Bridge\u4e4b\u4e0b\u7684\u6240\u6709\u603b\u7ebf\uff0c\u5e76\u5bf9\u8fd9\u4e9b\u603b\u7ebf\u8fdb\u884c\u7f16\u53f7\u3002\u5f53\u8fd9\u4e00\u603b\u7ebf\u641c\u7d22\u8fc7\u7a0b\u5b8c\u6210\u540e\uff08\u4e0d\u662f\u679a\u4e3e\u8fc7\u7a0b\u5b8c\u6210\uff09\uff0c\u8f6f\u4ef6\u5c06\u4f7f\u80fd\u90a3\u4e2a\u4e0d\u6d3b\u8dc3\u7684Host Bridge\uff0c\u5e76\u7ed9\u5b83\u8d4b\u4e88\u4e00\u4e2a\u603b\u7ebf\u7f16\u53f7\uff0c\u8fd9\u4e2a\u603b\u7ebf\u7f16\u53f7\u4f1a\u5728\u4e4b\u524d\u90a3\u4e9b\u6d3b\u8dc3Bridge\u7684\u603b\u7ebf\u7f16\u53f7\u8303\u56f4\u4e4b\u5916\uff0c\u7136\u540e\u8f6f\u4ef6\u7ee7\u7eed\u8fdb\u884c\u679a\u4e3e\u8fc7\u7a0b\u3002\u8fd9\u4e24\u4e2aHost Bridge\u90fd\u4f1a\u770b\u89c1\u8bf7\u6c42\uff0c\u4f46\u662f\u7531\u4e8e\u5b83\u4eec\u4e8c\u8005\u62e5\u6709\u76f8\u4e92\u4e0d\u91cd\u53e0\u7684\u603b\u7ebf\u7f16\u53f7\u8303\u56f4\uff0c\u800c\u5b83\u4eec\u5404\u81ea\u53c8\u53ea\u4f1a\u5bf9\u81ea\u5df1\u7684\u8303\u56f4\u5185\u7684\u8bf7\u6c42\u4f5c\u51fa\u54cd\u5e94\uff0c\u56e0\u6b64\u5e76\u4e0d\u4f1a\u5b58\u5728\u51b2\u7a81\u7684\u60c5\u51b5\u3002</p> </li> <li> <p>\u5728\u4e0a\u9762\u7684\u8fc7\u7a0b\u4e4b\u540e\uff0c\u4e24\u4e2aHost Bridge\u90fd\u4f1a\u6536\u5230\u5bf9\u5404\u81ea\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684\u8bbf\u95ee\uff0c\u800c\u968f\u540e\u8fdb\u884c\u7684\u7684\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684\u8bfb\u8bbf\u95ee\u6216\u5199\u8bbf\u95ee\uff0c\u5219\u4ec5\u4f1a\u88ab\u5305\u542b\u76ee\u6807\u603b\u7ebf\u7684Host/PCI Bridge\u6240\u63a5\u6536\u3002\u63a5\u6536\u8bbf\u95ee\u7684Bridge\u5c06\u4f1a\u54cd\u5e94\u5904\u7406\u5668\u7684\u4e8b\u52a1\uff0c\u800c\u53e6\u4e00\u4e2aBridge\u5219\u4f1a\u5ffd\u7565\u8fd9\u4e2a\u4e8b\u52a1\u3002</p> </li> <li>\u82e5\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u6b21\u7ea7\u603b\u7ebf\uff0c\u90a3\u4e48Bridge\u5c06\u628a\u8fd9\u4e2a\u8bbf\u95ee\u8f6c\u6362\u6210Type 0\u914d\u7f6e\u8bbf\u95ee\u3002</li> <li>\u5426\u5219\uff0c\u8fd9\u4e2a\u8bbf\u95ee\u5c06\u88ab\u8f6c\u6362\u6210Type 1\u914d\u7f6e\u8bbf\u95ee\u3002</li> </ol> <p>\u7f16\u8005\u6ce8\uff1a\u4e0a\u6587\u4e2d\u7684\u4e24\u4e2a RC \u662f\u5bf9\u5e94\u4e8e\u56fe 3-6 \u7684\u60c5\u51b5\uff0c\u66f4\u4e00\u822c\u7684\u60c5\u51b5\u4e2d\u4f1a\u5b58\u5728 1-N \u4e2a RC\u3002</p> <p></p> <p>\u56fe 3\u20116\u591aRoot\u7cfb\u7edf</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#372-enhanced-configuration-access-mechanism","title":"3.7.2     \u589e\u5f3a\u578b\u914d\u7f6e\u8bbf\u95ee\u673a\u5236\uff08Enhanced Configuration Access Mechanism\uff09","text":""},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3721-general","title":"3.7.2.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5f53\u534f\u8bae\u5236\u5b9a\u8005\u5728\u9009\u62e9PCI-X\u548c\u4e4b\u540e\u7684PCIe\u8be5\u5982\u4f55\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u65f6\uff0c\u6709\u4e24\u4e2a\u8003\u8651\u3002\u7b2c\u4e00\u4e2a\uff0c\u6bcf\u4e2aFunction\u7684256Byte\u7a7a\u95f4\u9650\u5236\u4e86\u90a3\u4e9b\u60f3\u8981\u5728\u8fd9\u4e2a\u7a7a\u95f4\u5185\u653e\u4e00\u4e9b\u4e13\u6709\u4fe1\u606f\u7684\u5382\u5546\uff0c\u800c\u4e14\u672a\u6765\u7684\u534f\u8bae\u5236\u5b9a\u8005\u53ef\u80fd\u4e5f\u9700\u8981\u66f4\u591a\u7684\u7a7a\u95f4\u6765\u653e\u7f6e\u66f4\u591a\u7684\u80fd\u529b\u7ed3\u6784\uff08capability structure\uff09\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u7a7a\u95f4\u4ece\u6bcf\u4e2aFunction 256Bytes\u6269\u5c55\u81f34Kbytes\u3002\u7b2c\u4e8c\u4e2a\u8981\u8003\u8651\u7684\u662f\uff0cPCI\u534f\u8bae\u5e94\u7528\u7684\u65f6\u4ee3\u591a\u5904\u7406\u5668\u7cfb\u7edf\u8fd8\u5f88\u5c11\u3002\u5bf9\u4e8e\u65e7\u7684\u6a21\u578b\u6765\u8bf4\uff0c\u5f53\u7cfb\u7edf\u4e2d\u4ec5\u6709\u4e00\u4e2aCPU\u4e14\u5176\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u65f6\uff0c\u751f\u6210\u4e00\u6b21\u8bbf\u95ee\u9700\u8981\u4e24\u6b65\u5e76\u4e0d\u4f1a\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u4f46\u662f\u5bf9\u4e8e\u4f7f\u7528\u591a\u6838\u591a\u7ebf\u7a0bCPU\u7684\u8ba1\u7b97\u673a\u6765\u8bf4\uff0c\u4f7f\u7528IO\u95f4\u63a5\u8bbf\u95ee\u6a21\u578b\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e9b\u95ee\u9898\uff0c\u56e0\u4e3a\u6ca1\u6709\u673a\u5236\u80fd\u591f\u963b\u6b62\u591a\u7ebf\u7a0b\u540c\u4e00\u65f6\u95f4\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u3002\u56e0\u6b64\uff0c\u5728\u6ca1\u6709\u7ebf\u7a0b\u9501\u673a\u5236\uff08lock semantics\uff09\u65f6\u4e0d\u518d\u4f7f\u7528\u201c2\u6b65\u201d\u6a21\u578b\uff08IO\u95f4\u63a5\u8bbf\u95ee\uff09\u3002\u5728\u6ca1\u6709\u7ebf\u7a0b\u9501\u673a\u5236\u7684\u60c5\u51b5\u4e0b\uff0c\u5f53\u7ebf\u7a0bA\u5f80\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08CF8h\uff09\u5199\u5165\u4e00\u4e2a\u503c\u540e\uff0c\u5728\u5b83\u7ee7\u7eed\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08CFCh\uff09\u505a\u76f8\u5e94\u7684\u64cd\u4f5c\u4e4b\u524d\uff0c\u5e76\u6ca1\u6709\u4e00\u4e2a\u673a\u5236\u6765\u9632\u6b62\u7ebf\u7a0bB\u5c06\u8fd9\u4e2a\u503c\u8986\u76d6\u6389\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u65b0\u95ee\u9898\uff0c\u534f\u8bae\u5236\u5b9a\u8005\u51b3\u5b9a\u91c7\u7528\u4e00\u4e2a\u4e0d\u540c\u4e8eIO\u95f4\u63a5\u8bbf\u95ee\u7684\u65b9\u6cd5\u3002\u4ed6\u4eec\u4e0d\u518d\u5c1d\u8bd5\u53bb\u4fdd\u7559\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u662f\u901a\u8fc7\u5c06\u6240\u6709\u914d\u7f6e\u7a7a\u95f4\u90fd\u6620\u5c04\u5230\u5185\u5b58\u5730\u5740\uff0c\u4ee5\u6b64\u6765\u521b\u9020\u51fa\u4e00\u4e2a\u5355\u6b65\uff08single-step\uff09\u3001\u4e0d\u53ef\u4e2d\u65ad\uff08uninterruptable\uff09\u7684\u8bbf\u95ee\u8fc7\u7a0b\u3002\u7531\u4e8e\u4e00\u4e2a\u9488\u5bf9\u7279\u5b9a\u5730\u5740\u8303\u56f4\u7684memory\u8bf7\u6c42\u4f1a\u5728\u603b\u7ebf\u4e0a\u4ea7\u751f\u4e00\u4e2a\u914d\u7f6e\u8bf7\u6c42\uff0c\u6240\u4ee5\u8fd9\u79cd\u8bbf\u95ee\u65b9\u5f0f\u53ea\u9700\u8981\u4e00\u4e2a\u547d\u4ee4\u5e8f\u5217\u5373\u53ef\u3002\u8fd9\u79cd\u65b9\u5f0f\u5e26\u6765\u7684\u5f00\u9500\u8003\u91cf\uff08trade-off\uff09\u5728\u4e8e\u5730\u5740\u5927\u5c0f\u3002\u6bcf\u4e2aFunction\u6620\u5c04\u5730\u5740\u7a7a\u95f4\u9700\u89814KB\uff0c\u5b9e\u73b0\u6700\u5927\u6570\u91cf\u7684 function \u9700\u8981256MB\u7684memory\uff08\u5185\u5b58\uff09\u5730\u5740\u7a7a\u95f4\u3002\u7531\u4e8e\u73b0\u4ee3\u4f53\u7cfb\u7ed3\u6784\u4e00\u822c\u652f\u630136\u523048\u4f4d\u7684\u7269\u7406\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u6240\u4ee5\u76f8\u8f83\u4e8e\u73b0\u5728\u7684\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u7684\u603b\u5927\u5c0f\uff0c256MB\u7684\u7a7a\u95f4\u5360\u7528\u5f88\u5c11\u3002</p> <p>\u4e3a\u4e86\u5904\u7406\u5730\u5740\u6620\u5c04\uff0c\u6bcf\u4e2aFunction\u76844KB\u914d\u7f6e\u7a7a\u95f4\u90fd\u4ee5\u4e00\u4e2a4KB\u5bf9\u9f50\u7684\u5730\u5740\u4f5c\u4e3a\u8d77\u59cb\u5730\u5740\uff0c\u4e14\u8fd9\u4e9b4KB\u914d\u7f6e\u7a7a\u95f4\u6240\u6620\u5c04\u7684\u5730\u5740\u90fd\u8981\u4f4d\u4e8e\u90a3\u6bb5\u4e3a\u4e86\u914d\u7f6e\u8bbf\u95ee\u800c\u9884\u7559\u7684256MB\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u5185\u3002\u5e76\u4e14\u73b0\u5728\u7684\u5730\u5740\u4e2d\u7684bit\u8fd8\u643a\u5e26\u4e86\u8bc6\u522b\u4fe1\u606f\uff08identifying information\uff09\uff0c\u7528\u4e8e\u8868\u793a\u54ea\u4e00\u4e2aFunction\u662f\u8bbf\u95ee\u76ee\u6807\uff08\u89c1\u8868 3\u20111\uff09\u3002</p> <p></p> <p>\u8868 3\u20111\u589e\u5f3a\u578b\u914d\u7f6e\u673a\u5236\u7684\u5185\u5b58\u6620\u5c04\u5730\u5740\u8303\u56f4</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3722-some-rules","title":"3.7.2.2   \u4e00\u4e9b\u89c4\u5219\uff08Some Rules\uff09","text":"<p>\u5982\u679c\u4e00\u4e2a\u8bbf\u95ee\u8de8\u4e86dword\u5730\u5740\u8fb9\u754c\uff08\u8de8\u8d8a\u4e86\u76f8\u90bb\u7684\u4e24\u4e2a\u5185\u5b58DW\u7684\u8fb9\u754c\uff0c\u5373\u64cd\u4f5c\u957f\u5ea6\u5927\u4e8e\u4e86\u4e00\u4e2aDW\uff0c\u6216\u8005\u662f\u64cd\u4f5c\u957f\u5ea6\u7b49\u4e8e\u4e00\u4e2aDW\u4f46\u662f\u8d77\u59cb\u5730\u5740\u6ca1\u6709\u4f4d\u4e8eDW\u5bf9\u9f50\u7684\u5730\u5740\uff09\uff0c\u90a3\u4e48RC\u53ef\u4ee5\u4e0d\u652f\u6301\u5b83\u8bbf\u95ee\u589e\u5f3a\u578b\u914d\u7f6e\u5185\u5b58\u7a7a\u95f4\u3002RC\u4eec\u4e5f\u4e0d\u9700\u8981\u652f\u6301\u67d0\u4e9b\u603b\u7ebf\u9501\u5b9a\u534f\u8bae\uff08bus locking protocol\uff09\uff0c\u4e00\u4e9b\u5904\u7406\u5668\u4f7f\u7528\u8fd9\u4e9b\u603b\u7ebf\u9501\u5b9a\u534f\u8bae\u6765\u5b9e\u73b0\u539f\u5b50\u64cd\u4f5c\u6216\u662f\u4e0d\u53ef\u4e2d\u65ad\u7684\u4e00\u7cfb\u5217\u547d\u4ee4\u3002\u8f6f\u4ef6\u5728\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u65f6\uff0c\u9700\u8981\u907f\u514d\u4e0a\u8ff0\u8fd9\u4e24\u79cd\u60c5\u51b5\uff0c\u9664\u975e\u8f6f\u4ef6\u77e5\u9053RC\u53ef\u4ee5\u652f\u6301\u5b83\u4eec\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#38-configuration-requests","title":"3.8 \u914d\u7f6e\u8bf7\u6c42\uff08Configuration Requests\uff09","text":"<p>Bridge\u4e3a\u4e86\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\uff0c\u5c06\u4f1a\u4ea7\u751f\u4e24\u79cd\u7c7b\u578b\u7684\u914d\u7f6e\u8bf7\u6c42\uff0c\u5206\u522b\u4e3aType 0\u548cType 1\u3002\u5177\u4f53\u4ea7\u751f\u54ea\u4e00\u79cd\u7c7b\u578b\u7684\u914d\u7f6e\u8bf7\u6c42\uff0c\u53d6\u51b3\u4e8e\u76ee\u6807\u603b\u7ebf\u53f7\u662f\u5426\u4e0e\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09\u76f8\u5339\u914d\u3002\u4e0b\u9762\u5c06\u8fdb\u884c\u8bb2\u89e3\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#381-type-0type-0-configuration-request","title":"3.8.1     Type 0\u914d\u7f6e\u8bf7\u6c42\uff08Type 0 Configuration Request\uff09","text":"<p>\u5982\u679c\u76ee\u6807\u603b\u7ebf\u53f7\u4e0e\u6b21\u7ea7\u603b\u7ebf\u53f7\u76f8\u5339\u914d\uff0cBridge\u5c06\u4ea7\u751f\u4e00\u4e2aType 0\u914d\u7f6e\u8bfb/\u5199\uff0c\u5e76\u8f6c\u53d1\u5230\u5b83\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\uff0c\u5e76\uff1a</p> <ol> <li> <p>\u603b\u7ebf\u4e0a\u7684\u8bbe\u5907\u4eec\u68c0\u67e5\u914d\u7f6e\u8bf7\u6c42\u4e2d\u7684Device Number\uff08\u8bbe\u5907\u53f7\uff09\uff0c\u770b\u8c01\u624d\u662f\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5916\u90e8\u94fe\u8def\uff08external Link\uff09\u4e0a\u7684EP\u603b\u662fDevice 0\u3002</p> </li> <li> <p>\u88ab\u9009\u4e2d\u7684\u8bbe\u5907\u68c0\u67e5Function Number\uff0c\u770b\u770b\u8bbe\u5907\u5185\u7684\u54ea\u4e2aFunction\u88ab\u9009\u4e2d\u3002</p> </li> <li> <p>\u88ab\u9009\u4e2d\u7684Function\u4f7f\u7528Register Number\u5b57\u6bb5\u57df\u6765\u9009\u62e9\u5b83\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684DW\uff0c\u8fd9\u4e2aDW\u5c31\u662f\u76ee\u6807DW\uff0c\u5e76\u4f7f\u7528First Dword Byte Enable\u5b57\u6bb5\u57df\u6765\u9009\u51fa\u8fd9\u4e2aDW\u4e2d\u8981\u88ab\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u7684\u5b57\u8282\u4eec\u3002</p> </li> </ol> <p>\u5982\u56fe 3\u20117\u4e2d\u7ed9\u51fa\u4e86Type 0\u914d\u7f6e\u5199\u8bf7\u6c42\u548c\u8bfb\u8bf7\u6c42\u7684Header\u683c\u5f0f\u3002\u5728\u8bfb\u5199\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0cType\u5b57\u6bb5\u90fd\u662f00100\uff0c\u800cFormat\uff08Fmt\uff09\u5b57\u6bb5\u5219\u7528\u4e8e\u6307\u793a\u662f\u8bfb\u8bf7\u6c42\u8fd8\u662f\u5199\u8bf7\u6c42\u3002</p> <p></p> <p>\u56fe 3\u20117 Type 0\u914d\u7f6e\u8bfb\u8bf7\u6c42\u548c\u5199\u8bf7\u6c42\u7684Header</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#382-type-1type-1-configuration-request","title":"3.8.2     Type 1\u914d\u7f6e\u8bf7\u6c42\uff08Type 1 Configuration Request\uff09","text":"<p>\u5f53Bridge\u5f97\u5230\u7684\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u5e76\u4e0d\u662f\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff0c\u4f46\u662f\u76ee\u6807\u603b\u7ebf\u53f7\u53c8\u5728\u4ece\u5c5e\u603b\u7ebf\uff08Subordinate Bus\uff09\u7684\u8303\u56f4\u5185\uff0c\u90a3\u4e48Bridge\u5c06\u5411\u6b21\u7ea7\u603b\u7ebf\u8f6c\u53d1\u4e00\u4e2aType 1\u8bf7\u6c42\u5305\u3002\u6b21\u7ea7\u603b\u7ebf\u4e0a\u7684\u975eBridge\u7684\u8bbe\u5907\uff08EP\uff09\u5c06\u4f1a\u5ffd\u7565Type 1\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\u5e76\u4e0d\u662f\u5f53\u524d\u603b\u7ebf\u3002\u4f46\u662f\u6b21\u7ea7\u603b\u7ebf\u4e0a\u7684Bridge\u770b\u5230Type 1\u8bf7\u6c42\u5219\u5c06\u4f1a\u8fdb\u884c\u4e0e\u4e0a\u4e00\u7ea7Bridge\u76f8\u540c\u7684\u6bd4\u5bf9\u64cd\u4f5c\uff0c\u5f53\u76ee\u6807\u603b\u7ebf\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\u65f6\uff1a</p> <ul> <li> <p>\u5982\u679c\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5305\u5c06\u4eceType 1\u88ab\u8f6c\u6362\u6210Type 0\uff0c\u5e76\u8f6c\u53d1\u5230\u6b21\u7ea7\u603b\u7ebf\u4e0a\u3002\u6b21\u7ea7\u603b\u7ebf\u4e0a\u7684\u672c\u5730\u8bbe\u5907\u5c06\u4f1a\u50cf\u6b64\u524d\u63cf\u8ff0\u7684\u4e00\u6837\u68c0\u67e5\u8bf7\u6c42\u5305\u7684Header\u3002</p> </li> <li> <p>\u82e5\u76ee\u6807\u603b\u7ebf\u53f7\u4e0d\u662f\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u4f46\u662f\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u8bf7\u6c42\u5305\u5c06\u4f1a\u7ee7\u7eed\u4ee5Type 1\u8bf7\u6c42\u7684\u683c\u5f0f\u88ab\u8f6c\u53d1\u5230\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\u3002</p> </li> </ul> <p>\u5982\u56fe 3-8 \u5c55\u793a\u4e86Type 1\u914d\u7f6e\u8bfb\u8bf7\u6c42\u548c\u5199\u8bf7\u6c42\u7684Header\u683c\u5f0f\u3002\u5728\u8bfb\u5199\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0cType\u5b57\u6bb5\u57df\u90fd\u662f00101\uff0c\u800cFormat\uff08Fmt\uff09\u5b57\u6bb5\u5219\u7528\u6765\u6307\u793a\u8fd9\u662f\u8bfb\u8fd8\u662f\u5199\u3002</p> <p></p> <p>\u56fe 3\u20118 Type 1\u914d\u7f6e\u8bfb\u8bf7\u6c42\u548c\u5199\u8bf7\u6c42\u7684Header</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#39-pciexample-pci-compatible-configuration-access","title":"3.9 PCI\u517c\u5bb9\u914d\u7f6e\u8bbf\u95ee\u793a\u4f8b\uff08Example PCI-Compatible Configuration Access\uff09","text":"<p>\u8bf7\u53c2\u9605\u56fe 3\u20119\u3002</p> <p>\u8bd1\u8005\uff1a\u5728\u6b64\u56fe\u4e2d\u7ea0\u6b63\u4e86\u539f\u4e66\u7248\u672c\u7684\u4e00\u4e2a\u9519\u8bef\uff08\u8be5\u9519\u8bef\u4e3aerrata\u4e2d\u7684\u7b2c1\u6761\uff09\uff0cBus 6\u7684\u4e2d\u95f4\u7684Bridge\u7684Sub\u5e94\u8be5\u4e3a9\u800c\u4e0d\u662f8\uff0c\u539f\u56fe\u4e2d\u4e3a8\u3002</p> <p>\u4e3a\u4e86\u66f4\u597d\u8bf4\u660e\u4f20\u7edf\u7684CF8h/CFCh\u673a\u5236\u6765\u4ea7\u751f\u914d\u7f6e\u8bf7\u6c42\uff0c\u8bf7\u53c2\u8003\u4e0b\u9762\u7684x86\u6c47\u7f16\u4ee3\u7801\uff0c\u8fd9\u6bb5\u4ee3\u7801\u4f7f\u5f97RC\u6267\u884c\u4e00\u4e2a2byte\u7684\u8bfb\u64cd\u4f5c\uff0c\u64cd\u4f5c\u76ee\u6807\u4e3aBus 4\uff0cDevice 0\uff0cFunction 0\uff0cRegister 0\uff08\u8fd9\u4e2aRegister 0\u5c31\u662f\u5382\u5546Vendor ID\uff09\u3002</p> <p><code>mov  dx,0CF8h   ;\u5c06dx\u8bbe\u7f6e\u4e3a\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684\u5730\u5740</code></p> <p><code>mov  eax,8004000h ;enable bit=1\uff0cbus 4\uff0cdev 0\uff0cfunc 0\uff0cDW 0</code></p> <p><code>out  dx,eax    ;IO\u5199\u6765\u8bbe\u7f6e\u5730\u5740\u7aef\u53e3</code></p> <p><code>mov  dx,0CFCh   ;\u5c06dx\u8bbe\u7f6e\u4e3a\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684\u5730\u5740</code></p> <p><code>in   ax,dx    ;\u4ece\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u8bfb\u51fa2byte\u6570\u636e</code></p> <p>\u4ee3\u7801\u4e2d\u7684out\u6307\u4ee4\u5c06\u4ea7\u751f\u4e00\u4e2aIO\u5199\u64cd\u4f5c\uff0c\u4ece\u5904\u7406\u5668\u5199\u5165\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff0c\u8fd9\u4e2a\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u4f4d\u4e8eRC\u7684Host Bridge\uff080CF8h\uff09\uff0c\u5982\u56fe 3\u20114\u3002</p> <ol> <li> <p>Host Bridge\u5c06\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u4e2d\u7684\u76ee\u6807\u603b\u7ebf\u53f7\uff08\u8fd9\u91cc\u662f4\uff09\u4e0eBridge\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\uff08\u8fd9\u91cc\u662f0\u523010\uff09\u8fdb\u884c\u6bd4\u8f83\u3002\u5f88\u660e\u663e\u76ee\u6807\u603b\u7ebf\u53f7\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u56e0\u6b64Bridge\u5c31\u51c6\u5907\u597d\u4e86\u63a5\u4e0b\u6765\u4ea7\u751f\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u7684\u5730\u3002</p> </li> <li> <p>\u4ee3\u7801\u4e2d\u7684in\u6307\u4ee4\u5c06\u4ea7\u751f\u4e00\u4e2aIO\u8bfb\u4e8b\u52a1\uff0c\u8bfb\u4e8b\u52a1\u4ea7\u751f\u81ea\u5904\u7406\u5668\u5e76\u53d1\u5f80RC Host Bridge\u4e2d\u7684\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u3002\u8fd9\u662f\u4e00\u4e2a\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684\u524d\u4e24\u4e2abyte\u8fdb\u884c\u8bfb\u53d6\u7684\u8bfb\u4e8b\u52a1\u3002</p> </li> <li> <p>\u7531\u4e8e\u76ee\u6807\u603b\u7ebf\u53f7\u4e0d\u662fbus 0\uff0c\u6240\u4ee5Host/PCI Bridge\u5bf9bus 0\u53d1\u8d77\u4e00\u4e2aType 1\u914d\u7f6e\u8bfb\u8bf7\u6c42\u3002</p> </li> <li> <p>bus 0\u4e0a\u7684\u6240\u6709\u8bbe\u5907\u90fd\u4f1a\u9501\u5b58\u8fd9\u4e2a\u4e8b\u52a1\u8bf7\u6c42\uff0c\u5e76\u53d1\u73b0\u5b83\u662f\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u3002\u56e0\u6b64RC\u4e2d\u7684\u4e24\u4e2a\u865a\u62dfPCI-to-PCI Bridges\u5404\u81ea\u90fd\u5c06Type 1\u8bf7\u6c42\u4e2d\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u4e0e\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u8fdb\u884c\u6bd4\u8f83\u3002</p> </li> <li> <p>\u76ee\u7684\u5730bus 4\u4f4d\u4e8e\u5de6\u4fa7Bridge\u7684\u4e0b\u65b9\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u4e2d\uff0c\u6240\u4ee5\u5de6\u4fa7Bridge\u5c06\u628a\u8fd9\u4e2a\u8bf7\u6c42\u6570\u636e\u5305\u53d1\u9001\u5230\u5b83\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\uff0c\u4f46\u662f\u8fd9\u4e2a\u8bf7\u6c42\u4ecd\u7136\u662f\u4e00\u4e2aType 1\u8bf7\u6c42\uff0c\u56e0\u4e3a\u76ee\u6807\u603b\u7ebf\u5e76\u4e0d\u662f\u8fd9\u4e2a\u5de6\u4fa7Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u3002</p> </li> <li> <p>\u56fe\u5de6\u4fa7\u7684Switch\u7684\u4e0a\u65b9\u7aef\u53e3\u5c06\u63a5\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u5c06\u5b83\u4f20\u9001\u7ed9Switch\u4e2d\u9760\u4e0a\u65b9\u7684PCI-to-PCI Bridge\u3002</p> </li> <li> <p>\u8fd9\u4e2aSwitch\u4e2d\u9760\u4e0a\u65b9\u7684PCI-to-PCI Bridge\u786e\u5b9a\u76ee\u6807\u603b\u7ebf\u5728\u81ea\u5df1\u4e0b\u65b9\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u56e0\u6b64\u5b83\u5c06\u8bf7\u6c42\u6570\u636e\u5305\u7ee7\u7eed\u4ee5Type 1\u8bf7\u6c42\u7684\u683c\u5f0f\u8f6c\u53d1\u5230bus 2\u4e0a\u3002</p> </li> <li> <p>bus 2\u4e0a\u7684\u4e24\u4e2aBridge\u90fd\u63a5\u6536\u5230\u4e86Type 1\u8bf7\u6c42\u5305\u3002\u504f\u53f3\u4fa7\u7684Bridge\u786e\u5b9a\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\u3002</p> </li> <li> <p>bus 2\u4e0a\u504f\u53f3\u4fa7\u7684Bridge\u5c06\u8fd9\u4e2a\u914d\u7f6e\u8bfb\u8bf7\u6c42\u53d1\u9001\u5230bus 4\u4e0a\uff0c\u800c\u4e14\u8fd9\u6b21\u4f1a\u5c06\u539f\u672c\u4e3aType 1\u7684\u8bf7\u6c42\u8f6c\u6362\u6210Type 0\u914d\u7f6e\u8bfb\u8bf7\u6c42\u6765\u53d1\u9001\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u3002</p> </li> <li> <p>bus 4\u4e0a\u7684Device 0\u63a5\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\u5305\uff0c\u5e76\u5bf9\u6570\u636e\u5305\u4e2d\u7684\u76ee\u6807Device\u53f7\u3001Function\u53f7\u3001Register\u53f7\u7684\u5b57\u6bb5\u8fdb\u884c\u8bd1\u7801\uff0c\u4ee5\u6b64\u6765\u9009\u4e2d\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684\u76ee\u6807DW\u3002\uff08\u5982\u56fe 3\u20113\uff09</p> </li> <li> <p>First Dword Byte Enable\u5b57\u6bb5\u4e2d\u7684bit 0\u548cbit 1\u90fd\u88ab\u7f6e\u4e3a\u6709\u6548\uff0c\u56e0\u6b64Function\u5c06\u5728\u5b8c\u6210\u5305\u4e2d\u8fd4\u56de\u5b83\u7684\u524d\u4e24\u4e2a\u5b57\u8282\uff08\u524d\u4e24\u4e2a\u5b57\u8282\u4e5f\u5c31\u662fVendor ID\uff09\u3002\u7136\u540e\u5b8c\u6210\u5305\u4f7f\u7528\u4eceType 0\u8bf7\u6c42\u5305\u4e2d\u83b7\u5f97\u7684Requester ID\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\uff0c\u901a\u8fc7\u8def\u7531\u8f6c\u53d1\uff0c\u6700\u7ec8\u56de\u5230Host Bridge\u3002</p> </li> <li> <p>\u8bfb\u51fa\u6765\u76842byte\u6570\u636e\u5c06\u4f1a\u5448\u4ea4\u7ed9\u5904\u7406\u5668\uff0c\u4ee5\u6b64\u6765\u5b8c\u6210in\u6307\u4ee4\u7684\u6267\u884c\u3002Vendor ID\u7684\u503c\u88ab\u653e\u7f6e\u5728\u5904\u7406\u5668\u7684AX\u5bc4\u5b58\u5668\u4e2d\u3002</p> </li> </ol>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#310-example-enhanced-configuration-access","title":"3.10     \u589e\u5f3a\u578b\u914d\u7f6e\u8bbf\u95ee\u793a\u4f8b\uff08Example Enhanced Configuration Access\uff09","text":"<p>\u8bf7\u53c2\u9605\u56fe 3\u20119\u3002</p> <p>\u4e0b\u9762\u7684x86\u6c47\u7f16\u4ee3\u7801\u5c06\u4f7f\u5f97RC\u6267\u884c\u4e00\u4e2a2byte\u7684\u8bfb\u64cd\u4f5c\uff0c\u64cd\u4f5c\u76ee\u6807\u4e3aBus 4\uff0cDevice 0\uff0cFunction 0\uff0cRegister 0\uff08\u8fd9\u4e2aRegister 0\u5c31\u662f\u5382\u5546Vendor ID\uff09\u3002\u5728\u8fd9\u6bb5\u4ee3\u7801\u5de5\u4f5c\u4e4b\u524d\uff0cHost Bridge\u5fc5\u987b\u5df2\u7ecf\u88ab\u5206\u914d\u4e86\u4e00\u4e2a\u57fa\u5730\u5740\uff08base address value\uff09\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5047\u8bbe\u589e\u5f3a\u578b\u914d\u7f6e\u5185\u5b58\u6620\u5c04\u8303\u56f4\uff08Enhanced Configuration memory-mapped range\uff09\u7684256MB\u5bf9\u9f50\u57fa\u5740\u4e3aE0000000h\u3002</p> <p><code>mov  ax,[E0400000h] ;\u5185\u5b58\u6620\u5c04\u914d\u7f6e\u7684\u8bfb\u64cd\u4f5c</code> </p> <ul> <li> <p>\u5730\u5740[63:28]\u8868\u793a\u6574\u4f53\u589e\u5f3a\u578b\u914d\u7f6e\u5730\u5740\u8303\u56f4\u7684256MB\u5bf9\u9f50\u7684\u57fa\u5730\u5740\u7684\u9ad836bit\uff0c\u5728\u672c\u4f8b\u4e2d\uff0c\u8fd9\u4e2a\u6574\u4f53\u589e\u5f3a\u578b\u914d\u7f6e\u5730\u5740\u8303\u56f4\u4e3a00000000-E0000000h\u3002</p> </li> <li> <p>\u5730\u5740[27:20]\u7528\u4e8e\u9009\u62e9\u76ee\u6807bus\uff08\u672c\u4f8b\u4e2d\u4e3abus 4\uff09</p> </li> <li> <p>\u5730\u5740[19:15]\u7528\u4e8e\u9009\u62e9bus\u4e0a\u7684\u76ee\u6807device\uff08\u672c\u4f8b\u4e2d\u4e3adevice 0\uff09</p> </li> <li> <p>\u5730\u5740[14:12]\u7528\u4e8e\u9009\u62e9device\u5185\u7684\u76ee\u6807function\uff08\u672c\u4f8b\u4e2d\u4e3afunction 0\uff09</p> </li> <li> <p>\u5730\u5740[11:2]\u7528\u4e8e\u9009\u62e9function\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684\u76ee\u6807DW\uff08\u672c\u4f8b\u4e2d\u4e3aDW 0\uff09</p> </li> <li> <p>\u5730\u5740[1:0]\u7528\u4e8e\u5b9a\u4e49\u9009\u4e2d\u7684DW\u4e2d\u7684\u8d77\u59cbbyte\u7684\u4f4d\u7f6e\uff08\u672c\u4f8b\u4e2d\u4e3abyte 0\uff09</p> </li> </ul> <p>\u5904\u7406\u5668\u53d1\u8d77\u4e00\u4e2a2byte\u7684memory read\uff0c\u8bfb\u53d6\u7684\u8d77\u59cb\u5730\u5740\u4e3aE0400000h\uff0c\u8fd9\u4e2a\u5730\u5740\u4f1a\u88abRC\u4e2d\u7684Host Bridge\u9501\u5b58\u4e0b\u6765\u3002Host Bridge\u8bc6\u522b\u5230\u8fd9\u4e2a\u5730\u5740\u4f4d\u4e8e\u7528\u6765\u8fdb\u884c\u914d\u7f6e\u7684\u533a\u57df\u4e4b\u5185\uff0c\u5b83\u5c06\u4ea7\u751f\u4e00\u4e2a\u914d\u7f6e\u8bfb\u8bf7\u6c42\uff0c\u8bfb\u53d6\u7684\u4f4d\u7f6e\u4e3aBus 4\u2014Device 0\u2014Function 0\u2014dword 0\u2014\u9996\u4e24\u4e2a\u5b57\u8282\u3002\u5269\u4e0b\u7684\u64cd\u4f5c\u5c31\u8ddf\u524d\u9762\u7684\u5c0f\u8282\u4e2d\u6240\u8bb2\u7684\u4e00\u6837\u4e86\uff0c\u4e5f\u5c31\u662f\u5982\u4f55\u628a\u8bfb\u51fa\u6765\u7684\u4fe1\u606f\u901a\u8fc7\u5b8c\u6210\u5305\u8fd4\u56de\u7ed9Host\u3002</p> <p></p> <p>\u56fe 3\u20119\u914d\u7f6e\u8bfb\u8bbf\u95ee\u793a\u4f8b</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#311-enumeration-discovering-the-topology","title":"3.11     \u679a\u4e3e\u2014\u2014\u641c\u7d22\u53d1\u73b0\u62d3\u6251\uff08Enumeration-Discovering the Topology\uff09","text":"<p>\u5728\u5b8c\u6210\u4e86\u7cfb\u7edf\u4e0a\u7535\u6216\u662f\u590d\u4f4d\u4e4b\u540e\uff0c\u914d\u7f6e\u8f6f\u4ef6\u9700\u8981\u626b\u63cfPCIe\u7f51\u7edc\u7ed3\u6784\uff0c\u6765\u641c\u7d22\u53d1\u73b0\u6574\u4e2a\u673a\u5668\u7684\u62d3\u6251\uff0c\u5e76\u5b66\u4e60\u8fd9\u4e2a\u7f51\u7edc\u7ed3\u6784\u662f\u5982\u4f55\u88ab\u586b\u5145\u7684\uff08\u4f8b\u5982\u91cc\u9762\u90fd\u6709\u591a\u5c11\u603b\u7ebf\u3001\u591a\u5c11\u8bbe\u5907\u4ee5\u53ca\u5b83\u4eec\u7684\u7f16\u53f7\u7b49\u7b49\uff09\u3002\u5728\u8fd9\u8fdb\u884c\u4e4b\u524d\uff0c\u5982\u56fe 3\u201110\u6240\u793a\uff0c\u8f6f\u4ef6\u552f\u4e00\u77e5\u9053\u7684\u5c31\u662f\u62d3\u6251\u4e2d\u6709\u4e00\u4e2aHost/PCI Bridge\u4ee5\u53ca\u8fd9\u4e2aBridge\u7684\u6b21\u7ea7\u603b\u7ebfBus 0\u3002\u9700\u8981\u6ce8\u610f\uff0c\u4e00\u4e2aBridge\u81ea\u8eab\u4e0a\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u79f0\u4e3a\u4e3b\u603b\u7ebf\uff08Primary Bus\uff09\uff0c\u800c\u8fd9\u4e2aBridge\u81ea\u8eab\u4e0b\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u79f0\u4e3a\u6b21\u7ea7\u603b\u7ebf\uff08Secondary Bus\uff09\u3002\u626b\u63cfPCIe\u7ed3\u6784\u6765\u53d1\u73b0\u6574\u4f53\u62d3\u6251\u7ed3\u6784\u7684\u8fc7\u7a0b\u88ab\u79f0\u4e3a**\u679a\u4e3e\u8fc7\u7a0b**\u3002</p> <p></p> <p>\u56fe 3\u201110\u521a\u542f\u52a8\u65f6\u8f6f\u4ef6\u6240\u8ba4\u4e3a\u7684\u62d3\u6251\u7ed3\u6784</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3111-functiondiscovering-the-presence-or-absence-of-a-function","title":"3.11.1    \u641c\u7d22\u67d0\u4e2aFunction\u662f\u5426\u5b58\u5728\uff08Discovering the Presence or Absence of a Function\uff09","text":"<p>\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u7684\u914d\u7f6e\u8f6f\u4ef6\u53d1\u73b0\u4e00\u4e2aFunction\u7684\u65b9\u5f0f\u4e00\u822c\u662f\u8bfb\u53d6\u8fd9\u4e2aFunction\u7684Vendor ID\u5bc4\u5b58\u5668\u3002PCI-SIG\u7ed9\u6bcf\u4e2a\u5382\u5546\u90fd\u5206\u914d\u4e86\u4e00\u4e2a\u552f\u4e00\u7684Vendor ID\uff0c\u6bcf\u4e2a\u5382\u5546\u90fd\u4f1a\u5c06\u81ea\u5df1\u8bbe\u8ba1\u7684Function\u4e2d\u7684Vendor ID\u5bc4\u5b58\u5668\u7684\u503c\u56fa\u5b9a\u4e3a\u81ea\u5df1\u7684Vendor ID\u3002\u901a\u8fc7\u8bfb\u53d6\u6574\u4e2a\u7cfb\u7edf\u4e2d\u7684Bus\u2014Device\u2014Function\u8fd9\u4e09\u8005\u6240\u6709\u7ec4\u5408\u4e2d\u7684Vendor ID\u5bc4\u5b58\u5668\uff0c\u679a\u4e3e\u8f6f\u4ef6\u53ef\u4ee5\u641c\u7d22\u904d\u6574\u4e2a\u62d3\u6251\uff0c\u5e76\u5f97\u77e5\u6709\u54ea\u4e9b\u8bbe\u5907\u5b58\u5728\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u76f8\u5f53\u7684\u7b80\u5355\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e24\u4e2a\u95ee\u9898\uff1a\u76ee\u6807\u8bbe\u5907\u53ef\u80fd\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u5b83\u867d\u7136\u5b58\u5728\u4f46\u662f\u6ca1\u6709\u51c6\u5907\u597d\u54cd\u5e94\u4e8b\u52a1\u8bf7\u6c42\u3002\u4e0b\u9762\u5c06\u4ecb\u7ecd\u5982\u4f55\u5904\u7406\u8fd9\u4e24\u79cd\u60c5\u51b5\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#31111-device-not-present","title":"3.11.1.1 \u8bbe\u5907\u4e0d\u5b58\u5728\uff08Device not Present\uff09","text":"<p>\u76ee\u6807\u8bbe\u5907\u5728\u7cfb\u7edf\u4e2d\u4e0d\u5b58\u5728\u7684\u8fd9\u4e2a\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u5728\u679a\u4e3e\u641c\u7d22\u8fc7\u7a0b\u4e2d\u53d1\u751f\u5f88\u591a\u6b21\u3002\u5f53\u5b83\u53d1\u751f\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u5b83\u6709\u6b63\u786e\u7684\u7406\u89e3\u3002\u5728PCI\u4e2d\uff0c\u914d\u7f6e\u8bfb\u8bf7\u6c42\uff08Configuration Read Request\uff09\u6709\u53ef\u80fd\u5728\u603b\u7ebf\u4e0a\u6267\u884c\u8d85\u65f6\uff08timeout\uff09\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e3b\u8bbe\u5907\u653e\u5f03\uff08Master Abort\uff09\u7684\u9519\u8bef\u60c5\u51b5\u3002\u7531\u4e8e\u6ca1\u6709\u8bbe\u5907\u6765\u9a71\u52a8\u603b\u7ebf\uff0c\u6240\u6709\u7684\u4fe1\u53f7\u90fd\u662f\u62c9\u9ad8\u7684\uff0c\u90a3\u4e48\u6570\u636e\u4f4d\u5728\u603b\u7ebf\u4e0a\u5c31\u662f\u5168\u4e3a1\u7684\uff0c\u8fd9\u4e2a\u5168\u4e3a1\u7684\u503c\u5c06\u6210\u4e3a\u603b\u7ebf\u4e0a\u88ab\u770b\u89c1\u7684\u6570\u636e\u503c\u3002\u8fd9\u4f7f\u5f97\u503c\u4e3aFFFFh\u7684Vendor ID\u5e76\u6ca1\u6709\u88ab\u5206\u914d\u51fa\u53bb\uff0c\u800c\u662f\u4f5c\u4e3a\u4e00\u4e2a\u4fdd\u7559\u503c\u3002\u5982\u679c\u679a\u4e3e\u8f6f\u4ef6\u6536\u5230\u7684\u8bfb\u53d6Vendor ID\u7684\u7ed3\u679c\u662fFFFFh\uff0c\u90a3\u4e48\u5b83\u5c31\u77e5\u9053\u5b83\u8bfb\u53d6\u7684\u8bbe\u5907\u4e0d\u5b58\u5728\u3002\u7531\u4e8e\u8fd9\u79cd\u60c5\u51b5\u5176\u5b9e\u5e76\u4e0d\u662f\u4e00\u79cd\u9519\u8bef\u60c5\u51b5\uff0c\u56e0\u6b64\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\uff0cMaster Abort\u5e76\u4e0d\u4f1a\u88ab\u5f53\u505a\u662f\u4e00\u4e2a\u9519\u8bef\u6765\u8fdb\u884c\u62a5\u544a\u3002</p> <p>\u5bf9\u4e8ePCIe\u6765\u8bf4\uff0c\u9488\u5bf9\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8bbe\u5907\u7684\u914d\u7f6e\u8bfb\u8bf7\u6c42\u5c06\u4f7f\u5f97\u76ee\u6807\u8bbe\u5907\u4e0a\u65b9\u8fde\u63a5\u7684Bridge\u8fd4\u56de\u4e00\u4e2a\u4e0d\u643a\u5e26\u6570\u636e\u7684\u5b8c\u6210\u5305\uff0c\u8fd9\u4e2a\u5b8c\u6210\u5305\u7684\u72b6\u6001\u5b57\u6bb5\u5c06\u88ab\u7f6e\u4e3aUR\uff08Unsupported Request\uff0c\u4e0d\u88ab\u652f\u6301\u7684\u8bf7\u6c42\uff09\u3002\u4e3a\u4e86\u5411\u540e\u517c\u5bb9\u4f20\u7edf\u7684\u679a\u4e3e\u6a21\u578b\uff0c\u82e5RC\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u6536\u5230\u8fd9\u6837\u7684\u5b8c\u6210\u5305\uff0c\u5b83\u5c06\u4f1a\u7ed9\u5904\u7406\u5668\u8fd4\u56de\u6570\u636eFFFFh\u3002\u6ce8\u610f\uff0c\u679a\u4e3e\u8f6f\u4ef6\u662f\u4f9d\u8d56\u4e8e\u63a5\u6536\u5230\u4e00\u4e2a\u8fd4\u56de\u503c\u4e3a\u51681\uff08FFFFh\uff09\u7684\u914d\u7f6e\u8bfb\u8bf7\u6c42\u6765\u5224\u5b9a\u76ee\u6807\u8bbe\u5907\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u800c\u7cfb\u7edf\u4e2d\u7684\u5728\u8bfb\u53d6\u8fd9\u6837\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8bbe\u5907Function\u7684Vendor ID\u65f6\uff0c\u5176\u5b9e\u662f\u8fd4\u56de\u4e86\u4e00\u4e2a\u72b6\u6001\u4e3aUnsupported Request\u7684\u4e0d\u643a\u5e26\u6570\u636e\u7684\u5b8c\u6210\u5305\u3002</p> <p>\u5f53\u51fa\u73b0\u8bbe\u5907\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u65f6\uff0c\u4e5f\u9700\u8981\u907f\u514d\u610f\u5916\u5730\u53d1\u9001\u9519\u8bef\u62a5\u544a\uff0c\u8fd9\u5f88\u91cd\u8981\u3002\u5c3d\u7ba1\u8fd9\u79cd\u8d85\u65f6\u6216\u8005UR\u7684\u7ed3\u679c\u5728\u7cfb\u7edf\u6b63\u5e38\u8fd0\u884c\u662f\u786e\u5b9e\u662f\u51fa\u9519\u7684\u60c5\u51b5\uff0c\u4f46\u662f\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u5b83\u5e76\u4e0d\u80fd\u88ab\u8ba4\u4e3a\u662f\u9519\u8bef\uff0c\u5b83\u662f\u4e00\u79cd\u6b63\u5e38\u7684\u53ef\u4ee5\u9884\u6599\u5230\u7684\u7ed3\u679c\u3002\u4e3a\u4e86\u80fd\u66f4\u7b80\u5355\u7684\u907f\u514d\u8fd9\u79cd\u6df7\u4e71\uff0c\u8bbe\u5907\u4eec\u4e00\u822c\u5728\u8fd9\u8fc7\u7a0b\u4e2d\u90fd\u4e0d\u542f\u7528\u9519\u8bef\u4fe1\u53f7\uff0c\u76f4\u5230\u679a\u4e3e\u5b8c\u6210\u624d\u542f\u7528\u3002\u5bf9\u4e8ePCIe\u6765\u8bf4\uff0c\u8bb0\u5f55\u8fd9\u79cd\u4e8b\u4ef6\uff08\u76ee\u6807\u8bbe\u5907\u4e0d\u5b58\u5728\uff09\u4ecd\u7136\u662f\u6709\u4f5c\u7528\u7684\uff0c\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48PCIe\u80fd\u529b\u5bc4\u5b58\u5668\u5757\uff08PCIe Capability register block\uff09\u4e2d\u5b58\u5728\u7b2c4\u4e2a\u201c\u9519\u8bef\u201d\u72b6\u6001\u4f4d\uff0c\u88ab\u79f0\u4e3aUnsupported Request Status\uff0c\u4e0d\u53d7\u652f\u6301\u7684\u8bf7\u6c42\u72b6\u6001\uff08\u66f4\u591a\u5173\u4e8e\u8fd9\u90e8\u5206\u7684\u5185\u5bb9\u8bf7\u89c1\u201cEnabling/Disabling Error Reporting\u201d\u4e00\u8282\uff09\u3002\u7531\u4e8e\u6709\u8fd9\u4e2a\u72b6\u6001\u4f4d\u7684\u5b58\u5728\uff0c\u53d1\u751f\u76ee\u6807\u8bbe\u5907\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u5c31\u53ef\u4ee5\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u800c\u4e14\u4e0d\u4f1a\u88ab\u5f53\u505a\u662f\u4e00\u4e2a\u9519\u8bef\uff0c\u8fd9\u4e00\u70b9\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u82e5\u68c0\u6d4b\u5230\u4e00\u4e2a\u9519\u8bef\u90a3\u4e48\u679a\u4e3e\u8fc7\u7a0b\u5c06\u88ab\u505c\u6b62\u5e76\u8c03\u7528\u7cfb\u7edf\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u3002\u5728\u679a\u4e3e\u8fd8\u6ca1\u8fdb\u884c\u5b8c\u7684\u8fd9\u4e2a\u65f6\u95f4\u6bb5\uff0c\u9519\u8bef\u5904\u7406\u8f6f\u4ef6\u7684\u80fd\u529b\u53ef\u80fd\u5341\u5206\u6709\u9650\uff0c\u4f7f\u5f97\u95ee\u9898\u65e0\u6cd5\u88ab\u89e3\u51b3\u3002\u8fd9\u5c06\u9020\u6210\u679a\u4e3e\u8f6f\u4ef6\u8fd0\u884c\u5931\u8d25\uff0c\u56e0\u4e3a\u901a\u5e38\u662f\u5728\u64cd\u4f5c\u7cfb\u7edf\uff08OS\uff09\u6216\u8005\u5176\u4ed6\u9519\u8bef\u5904\u7406\u8f6f\u4ef6\u53ef\u7528\u4e4b\u524d\u5c31\u5df2\u7ecf\u6267\u884c\u679a\u4e3e\u8f6f\u4ef6\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u98ce\u9669\uff0c\u5728\u679a\u4e3e\u671f\u95f4\uff0c\u901a\u5e38\u4e0d\u5e94\u8be5\u62a5\u544a\u9519\u8bef\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#31112-device-not-ready","title":"3.11.1.2 \u8bbe\u5907\u672a\u51c6\u5907\u597d\uff08Device not Ready\uff09","text":"<p>\u524d\u9762\u63d0\u5230\u7684\u53ef\u80fd\u4f1a\u53d1\u751f\u7684\u53e6\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u76ee\u6807\u8bbe\u5907\u867d\u7136\u5b58\u5728\uff0c\u4f46\u662f\u53ef\u80fd\u5e76\u672a\u51c6\u5907\u597d\u54cd\u5e94\u914d\u7f6e\u8bbf\u95ee\u3002\u5bf9\u4e8e\u914d\u7f6e\u64cd\u4f5c\u6765\u8bf4\uff0c\u9700\u8981\u8003\u8651\u53d1\u8d77\u914d\u7f6e\u7684\u65f6\u95f4\u70b9\uff0c\u56e0\u4e3a\u8bbe\u5907\u51c6\u5907\u597d\u88ab\u8bbf\u95ee\u662f\u9700\u8981\u65f6\u95f4\u7684\u3002\u5982\u679c\u6570\u636e\u901f\u7387\u5c0f\u4e8e\u7b49\u4e8e5.0GT/s\uff0c\u8f6f\u4ef6\u5fc5\u987b\u5728\u590d\u4f4d\u540e\u7b49\u5f85100ms\u518d\u53d1\u8d77\u914d\u7f6e\u8bf7\u6c42\u3002\u5982\u679c\u6570\u636e\u901f\u7387\u9ad8\u4e8e5.0GT/s\uff08Gen3\u901f\u7387\uff09\uff0c\u8f6f\u4ef6\u5fc5\u987b\u5728\u94fe\u8def\u8bad\u7ec3\uff08Link Training\uff09\u5b8c\u6210100ms\u4e4b\u540e\u518d\u5c1d\u8bd5\u53d1\u8d77\u914d\u7f6e\u64cd\u4f5c\u3002\u4e4b\u6240\u4ee5\u66f4\u9ad8\u7684\u901f\u7387\u9700\u8981\u66f4\u591a\u7684\u5ef6\u65f6\uff08Gen3\u9700\u8981\u5728\u94fe\u8def\u8bad\u7ec3\u5b8c\u6210\u540e\u7b49\u5f85100ms\u800c\u4e0d\u662f\u590d\u4f4d\u5b8c\u6210\u7b49\u5f85100ms\uff09\uff0c\u8fd9\u662f\u56e0\u4e3aGen3\u7684\u94fe\u8def\u8bad\u7ec3\u4e2d\u7684\u5747\u8861\u8fc7\u7a0b\uff08Equalization Process\uff09\u53ef\u80fd\u9700\u8981\u6bd4\u8f83\u957f\u7684\u65f6\u95f4\uff08\u7ea650ms\uff0c\u5173\u4e8e\u8fd9\u91cc\u7684\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cLink Equalization Overview\u201d\u4e00\u8282\uff09\u3002</p> <p>\u5728PCI 2.3\u4e2d\u5b9a\u4e49\u4e86\u521d\u59cb\u5316\u65f6\u95f4\uff08Initialization Time\uff0cTrhfa-\u4ece\u590d\u4f4d\u91ca\u653e\u5230\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u6240\u7ecf\u5386\u7684\u65f6\u95f4\uff09\uff0c\u521d\u59cb\u5316\u65f6\u95f4\u8d77\u59cb\u4e8eRST#\u88ab\u7f6e\u4e3a\u65e0\u6548\uff0c\u7ed3\u675f\u4e8e225\u4e2aPCI\u65f6\u949f\u5468\u671f\u4e4b\u540e\u3002\u5728\u8fd9\u6bb5\u957f\u5ea6\u4e3a\u4e00\u79d2\u7684\u65f6\u95f4\u5185\uff0cFunction\u6b63\u5728\u4e3a\u54cd\u5e94\u7b2c\u4e00\u6b21\u914d\u7f6e\u8bbf\u95ee\u505a\u51c6\u5907\uff0c\u8fd9\u4e2a\u65f6\u95f4\u957f\u5ea6\u4e5f\u88abPCIe\u534f\u8bae\u6240\u4f7f\u7528\uff0c\u534f\u8bae\u89c4\u5b9a\u521d\u59cb\u5316\u65f6\u95f4\u4e3a1.0s\uff08+50%/-0%\uff09\u3002\u4e00\u4e2aFunction\u53ef\u4ee5\u5229\u7528\u8fd9\u6bb5\u65f6\u95f4\u6765\u586b\u5145\u81ea\u5df1\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\uff0c\u4f8b\u5982\u52a0\u8f7d\u4e00\u4e2a\u5916\u6302\u7684\u4e32\u884cEEPROM\u7684\u5185\u5bb9\u505a\u4e3a\u5bc4\u5b58\u5668\u521d\u59cb\u503c\u3002\u52a0\u8f7dEEPROM\u5185\u5bb9\u9700\u8981\u82b1\u8d39\u4e00\u70b9\u65f6\u95f4\uff0c\u52a0\u8f7d\u5b8c\u6210\u524dFunction\u90fd\u6ca1\u6709\u51c6\u5907\u597d\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\u3002</p> <p>\u5728PCI\u4e2d\uff0c\u82e5\u5728Function\u51c6\u5907\u597d\u4e4b\u524d\u5c31\u6536\u5230\u4e86\u4e00\u4e2a\u914d\u7f6e\u8bbf\u95ee\uff0c\u90a3\u4e48\u5b83\u6709\u4e09\u4e2a\u9009\u62e9\uff1a\u5ffd\u7565\u8fd9\u4e2a\u8bf7\u6c42\u3001\u91cd\u8bd5\uff08Retry\uff09\u8fd9\u4e2a\u8bf7\u6c42\u3001\u63a5\u6536\u8fd9\u4e2a\u8bf7\u6c42\u4f46\u662f\u5ef6\u671f\u54cd\u5e94\u76f4\u5230Function\u81ea\u8eab\u5b8c\u5168\u51c6\u5907\u597d\u4e3a\u6b62\u3002\u6700\u540e\u4e00\u79cd\u9009\u62e9\u7684\u54cd\u5e94\u53ef\u80fd\u4f1a\u7ed9\u70ed\u63d2\u62d4\uff08Hot-plug\uff09\u7cfb\u7edf\u5e26\u6765\u9ebb\u70e6\uff0c\u56e0\u4e3a\u5ef6\u671f\u54cd\u5e94\u7684\u65f6\u957f\u53ef\u80fd\u4f1a\u8fbe\u52301s\uff0c\u5728\u8fd91s\u4e2d\u603b\u7ebf\u90fd\u662f\u505c\u6b62\u7684\uff0c\u76f4\u5230\u8fd9\u4e2a\u8bf7\u6c42\u88ab\u6267\u884c\u5b8c\uff0c\u603b\u7ebf\u624d\u91cd\u65b0\u5de5\u4f5c\u3002</p> <p>\u5728PCIe\u4e2d\u6211\u4eec\u4e5f\u9762\u4e34\u7740\u76f8\u540c\u7684\u95ee\u9898\uff0c\u4f46\u662f\u95ee\u9898\u7684\u8fc7\u7a0b\u6709\u4e00\u70b9\u4e0d\u540c\u3002\u9996\u5148\uff0cPCIe Function\u5728\u4e34\u65f6\u65e0\u6cd5\u54cd\u5e94\u914d\u7f6e\u8bbf\u95ee\u65f6\u5fc5\u987b\u8981\u7ed9\u51fa\u4e00\u4e2a\u5b8c\u6210\u5305\uff0c\u8fd9\u4e2a\u5b8c\u6210\u5305\u4e5f\u8981\u88ab\u7f6e\u4e3a\u6307\u5b9a\u7684\u72b6\u6001\uff0c\u8fd9\u4e2a\u72b6\u6001\u4e3aConfiguration Request Retry Status\uff08CRS\uff0c\u914d\u7f6e\u8bf7\u6c42\u91cd\u8bd5\u72b6\u6001\uff09\u3002\u8fd9\u4e2a\u72b6\u6001\u53ea\u6709\u5728\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\u7684\u65f6\u5019\u624d\u662f\u5408\u6cd5\u7684\uff0c\u5982\u679c\u5176\u4ed6\u7684\u8bf7\u6c42\u6536\u5230\u4e86\u8fd9\u4e2a\u72b6\u6001\u7684\u5b8c\u6210\u5305\uff0c\u5219\u53ef\u80fd\u4f1a\u8ba4\u4e3a\u6570\u636e\u5305\u683c\u5f0f\u9519\u8bef\uff08Malformed Packet error\uff09\u3002\u8fd9\u79cd\u72b6\u6001\u7684\u54cd\u5e94\u4e5f\u53ea\u5728\u590d\u4f4d\u540e\u76841\u79d2\u540e\u6709\u6548\uff0c\u56e0\u4e3a\u57281\u79d2\u4e4b\u540eFunction\u5c31\u88ab\u8ba4\u4e3a\u662f\u53ef\u4ee5\u6b63\u5e38\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\u4e86\uff0c\u5982\u679c1\u79d2\u4e4b\u540e\u8fd9\u4e2aFunction\u90fd\u8fd8\u65e0\u6cd5\u6b63\u5e38\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\uff0c\u90a3\u4e48\u5c31\u8ba4\u4e3a\u5b83\u5df2\u7ecf\u635f\u574f\u4e86\u3002</p> <p>\u9664\u4e86\u7cfb\u7edf\u590d\u4f4d\u4e4b\u540e\u7684\u90a3\u4e00\u6bb5\u65f6\u95f4\u4e4b\u5916\uff0cRC\u5904\u7406\u914d\u7f6e\u8bfb\u8bf7\u6c42\u7684CRS\uff08\u914d\u7f6e\u91cd\u8bd5\u72b6\u6001\uff09\u5b8c\u6210\u5305\u7684\u65b9\u5f0f\u4e0d\u662f\u901a\u7528\u7684\u3002\u5728\u7cfb\u7edf\u590d\u4f4d\u540e\u7684\u90a3\u4e00\u5c0f\u6bb5\u65f6\u95f4\u91cc\uff0cRC\u6709\u4e24\u4e2a\u53ef\u4ee5\u8fdb\u884c\u7684\u64cd\u4f5c\u4f9b\u9009\u62e9\uff0c\u9009\u62e9\u54ea\u4e00\u79cd\u5219\u53d6\u51b3\u4e8eRoot\u63a7\u5236\u5bc4\u5b58\u5668\uff08Root Control Register\uff09\u4e2dCRS Software Visibility\u8fd9\u4e00bit\u7684\u503c\uff08\u5982\u56fe 3\u201111\uff09\u3002</p> <p></p> <p>\u56fe 3\u201111 PCIe\u80fd\u529b\u5757\u4e2d\u7684Root\u63a7\u5236\u5bc4\u5b58\u5668</p> <ul> <li> <p>\u5982\u679c\u8fd9\u4e2abit\u88ab\u7f6e\u4e3a1\uff0c\u800c\u4e14\u53d1\u51fa\u7684\u8bf7\u6c42\u662f\u914d\u7f6e\u8bfb\u8bf7\u6c42\uff0c\u8981\u8bfb\u53d6Vendor ID\u5bc4\u5b58\u5668\u7684\u5168\u90e8\u4e24\u4e2abyte\uff08\u679a\u4e3e\u8fc7\u7a0b\u901a\u8fc7\u8fd9\u6837\u7684\u64cd\u4f5c\u6765\u641c\u7d22\u53d1\u73b0\u4e00\u4e2aFunction\u662f\u5426\u5b58\u5728\uff09\uff0c\u90a3\u4e48\u5728\u63a5\u6536\u5230CRS\u5b8c\u6210\u5305\u65f6RC\u9700\u8981\u7ed9Host\u8fd4\u56de\u4f2a\u9020\u76840001h\u4f5c\u4e3a\u8bfb\u53d6\u7684\u5bc4\u5b58\u5668\u503c\uff0c\u5e76\u5c06\u5176\u4ed6\u7684\u6240\u6709\u5b57\u8282\u90fd\u7f6e\u4e3a\u51681\u3002\u8fd9\u4e2aVendor ID\u5e76\u6ca1\u6709\u88ab\u4efb\u4f55\u771f\u5b9e\u7684\u8bbe\u5907\u6240\u4f7f\u7528\uff0c\u8f6f\u4ef6\u5c06\u628a\u8fd9\u4e2a0001h\u7684Vendor ID\u7406\u89e3\u4e3a\u8bbf\u95ee\u8fd9\u4e2a\u8bbe\u5907\u53ef\u80fd\u9700\u8981\u5f88\u957f\u7684\u5ef6\u8fdf\u3002\u8fd9\u4e2a\u4fe1\u606f\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u9009\u62e9\u53bb\u6267\u884c\u5176\u4ed6\u7684\u4efb\u52a1\uff0c\u66f4\u5145\u5206\u7684\u5229\u7528\u8fd9\u6bb5\u7b49\u5f85\u8bbe\u5907\u54cd\u5e94\u7684\u65f6\u95f4\uff0c\u7a0d\u540e\u518d\u8fd4\u56de\u6765\u67e5\u8be2\u8fd9\u4e2a\u8bbe\u5907\u3002\u8981\u8fdb\u884c\u8fd9\u6837\u5b50\u7684\u64cd\u4f5c\uff0c\u8f6f\u4ef6\u5fc5\u987b\u786e\u4fdd\u5176\u5728\u590d\u4f4d\u540e\u5bf9Function\u7684\u7b2c\u4e00\u6b21\u8bbf\u95ee\u5c31\u662f\u8bfb\u53d62 byteVendor ID\u7684\u914d\u7f6e\u8bfb\u8bbf\u95ee\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u914d\u7f6e\u5199\u8bbf\u95ee\u6216\u8005\u662f\u5176\u4ed6\u7684\u914d\u7f6e\u8bfb\u8bbf\u95ee\uff08\u5e76\u4e0d\u662f\u8bfb2byte Vendor ID\uff09\uff0cRC\u5fc5\u987b\u81ea\u52a8\u5730\u4ee5\u4e00\u4e2a\u65b0\u8bf7\u6c42\u7684\u5f62\u5f0f\u5bf9\u4e4b\u524d\u7684\u914d\u7f6e\u8bf7\u6c42\u8fdb\u884c\u91cd\u65b0\u4e0b\u8fbe\u3002</p> </li> </ul>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3112-functionepbridge","title":"3.11.2    \u786e\u8ba4\u67d0\u4e2aFunction\u662fEP\u8fd8\u662fBridge","text":"<p>\u679a\u4e3e\u8fc7\u7a0b\u7684\u4e00\u4e2a\u5173\u952e\u90e8\u5206\u5c31\u662f\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2aFunction\u662fBridge\u8fd8\u662fEP\u3002\u5982\u56fe 3\u201112\u6240\u793a\uff0cHeader\u7c7b\u578b\u5bc4\u5b58\u5668\uff08Header Type Register\uff0c\u4f4d\u4e8e\u914d\u7f6e\u7a7a\u95f4Header\u7684\u504f\u79fb\u5730\u57400Eh\uff09\u7684\u4f4e7bit\u7528\u4e8e\u6807\u8bc6\u8fd9\u4e2aFunction\u7684\u57fa\u672c\u79cd\u7c7b\uff0c\u603b\u5171\u5b9a\u4e49\u4e86\u4e09\u79cd\u4e0d\u540c\u7684\u503c\uff1a</p> <ul> <li> <p>0 = \u4e0d\u662f\u4e00\u4e2aBridge\uff08\u90a3\u4e5f\u5c31\u662f\u4e00\u4e2aPCIe EP\uff09</p> </li> <li> <p>1 = PCI-to-PCI Bridge\uff08\u7f29\u5199\u4e3aP2P\uff09\uff0c\u7528\u4e8e\u8fde\u63a5\u4e24\u6761\u603b\u7ebf</p> </li> <li> <p>2 = \u63d2\u4ef6\u5361Bridge\uff08CardBus Bridge\uff0c\u73b0\u5728\u5f88\u5c11\u4f7f\u7528\u7684\u5386\u53f2\u9057\u7559\u63a5\u53e3\uff09</p> </li> </ul> <p>\u5728\u56fe 3\u20111\u4e2d\uff0c\u6bcf\u4e2a\u865a\u62dfP2P\u7684Header Type\u5b57\u6bb5\uff08DW3\uff0cbyte2\uff09\u7684\u8fd4\u56de\u503c\u90fd\u4e3a1\uff0c\u4e14PCI Express-to-PCI Bridge\uff08Bus 8\uff0cDevice 0\uff09\u7684Header Type\u5b57\u6bb5\u4e5f\u5c06\u8fd4\u56de1\u3002\u4f46\u662f\u5bf9\u4e8eEP\u6765\u8bf4\uff0c\u5b83\u8fd4\u56de\u7684Header Type\u5b57\u6bb5\u662f0\u3002</p> <p></p> <p>\u56fe 3\u201112 Header\u7c7b\u578b\u5bc4\u5b58\u5668</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#312-rcsingle-root-enumeration-example","title":"3.12     \u5355RC\u679a\u4e3e\u793a\u4f8b\uff08Single Root Enumeration Example\uff09","text":"<p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u4f8b\u5b50\u6765\u8ba8\u8bba\u4e00\u4e0b\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u7684\u57fa\u672c\u8981\u7d20\u3002\u5982\u56fe 3\u201113\u5c55\u793a\u4e86\u4e00\u4e2a\u7ecf\u8fc7\u603b\u7ebf\u3001\u8bbe\u5907\u679a\u4e3e\u540e\u7684\u7cfb\u7edf\u793a\u4f8b\u3002\u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u57fa\u4e8e\u8fd9\u6837\u7684\u5047\u8bbe\uff1a\u914d\u7f6e\u8f6f\u4ef6\u5c06\u4f7f\u7528\u672c\u7ae0\u8282\u5b9a\u4e49\u7684\u4e24\u79cd\u914d\u7f6e\u8bbf\u95ee\u673a\u5236\u4e2d\u7684\u4e00\u79cd\u6765\u5b8c\u6210\u679a\u4e3e\u8fc7\u7a0b\u3002\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0c\u5904\u7406\u5668\u4e0a\u6267\u884c\u7684\u914d\u7f6e\u8f6f\u4ef6\u5c06\u5982\u63a5\u4e0b\u6765\u6240\u8bb2\u8ff0\u7684\u90a3\u6837\u6765\u8fdb\u884c\u679a\u4e3e\u8fc7\u7a0b\u3002</p> <ol> <li> <p>\u8f6f\u4ef6\u5c06Host/PCI Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09\u66f4\u65b0\u4e3a0\uff0c\u5e76\u5c06\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09\u66f4\u65b0\u4e3a255\u3002\u4e4b\u6240\u4ee5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u6700\u5927\u503c\u662f\u56e0\u4e3aSub Num\u53ef\u4ee5\u8fd9\u6837\u4e00\u76f4\u4fdd\u6301\u4e0d\u53d8\uff0c\u76f4\u5230Host/PCI Bridge\u4e0b\u65b9\u7684\u6240\u6709\u603b\u7ebf\u90fd\u88ab\u8bc6\u522b\u51fa\u6765\uff0c\u7136\u540e\u518d\u66f4\u65b0\u6210\u51c6\u786e\u7684\u503c\u3002\u5728\u6b64\u65f6\u6b64\u523b\uff0c\u6682\u4e14\u8ba4\u4e3a\u5728Host/PCI Bridge\u4e0b\u65b9\u8bc6\u522b\u5230\u7684\u603b\u7ebf\u8303\u56f4\u4e3aBus 0\u5230255\u3002</p> </li> <li> <p>\u4eceDevice 0\u5f00\u59cb\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4f1a\u5c1d\u8bd5\u53bb\u8bfb\u53d6Bus 0\u4e0a\u768432\u4e2a\u53ef\u80fd\u5b58\u5728\u7684Device\uff0c\u8bfb\u53d6\u7684\u5185\u5bb9\u4e3a\u5b83\u4eec\u5404\u81ea\u7684Function\u4e2d\u7684Vendor ID\u3002\u5982\u679cBus 0\u2014Device 0\u2014Function 0\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u90a3\u4e48\u5c31\u8ba4\u4e3a\u8fd9\u4e2a\u8bbe\u5907\u5b58\u5728\u5e76\u81f3\u5c11\u542b\u6709\u4e00\u4e2aFunction\u3002\u82e5Bus 0\u2014Device 0\u2014Function 0\u6ca1\u6709\u8fd4\u56de\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u5219\u7ee7\u7eed\u53bb\u63a2\u6d4bBus 0\u2014Device 1\u2014Function 0\u3002</p> </li> <li> <p>\u5728\u672c\u4f8b\u4e2d\u7684\u503c\u4e3a1\u7684Header Type\u5b57\u6bb5\uff08\u5982\u56fe 3\u201112\uff09\u8868\u793a\u8fd9\u662f\u4e00\u4e2aPCI-to-PCI Bridge\u3002Header Type\u5bc4\u5b58\u5668\u4e2d\u7684Multifunction\u4f4d\uff08bit 7\uff09\u4e3a0\uff0c\u8fd9\u8868\u793aFunction 0\u5c31\u662f\u8fd9\u4e2aBridge\u4e2d\u552f\u4e00\u7684Function\u3002\u534f\u8bae\u89c4\u8303\u5176\u5b9e\u5e76\u6ca1\u6709\u963b\u6b62\u5728Bridge\u8fd9\u6837\u7684\u8bbe\u5907\u4e2d\u53bb\u5b9e\u73b0\u591a\u4e2aFunction\uff0c\u76f8\u53cd\u5730\uff0c\u5f53\u6709\u591a\u4e2aFunction\u65f6\uff0c\u6bcf\u4e2aFunction\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u865a\u62dfPCI-to-PCI Bridge\uff0c\u751a\u81f3\u8fd8\u53ef\u4ee5\u662f\u4e00\u4e2a\u975eBridge\u7684Function\u3002</p> </li> <li> <p>\u73b0\u5728\u8f6f\u4ef6\u5df2\u7ecf\u627e\u5230\u4e86\u4e00\u4e2aBridge\uff0c\u5e76\u6267\u884c\u4e86\u4e00\u7cfb\u5217\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=0</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=1</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> </ol> <p>\u73b0\u5728\uff0c\u8fd9\u4e2aBridge\u5c31\u8ba4\u4e3a\u5728\u5b83\u4e0b\u65b9\u76f4\u63a5\u76f8\u8fde\u7684\u603b\u7ebf\u7684\u7f16\u53f7\u4e3a1\uff08\u6b21\u7ea7\u603b\u7ebf\u53f7=1\uff09\uff0c\u5b83\u4e0b\u65b9\u4ece\u5c5e\u7684\u6700\u5927\u603b\u7ebf\u53f7\u662f255\uff08\u4ece\u5c5e\u603b\u7ebf\u53f7=255\uff09\u3002</p> <ol> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u5fc5\u987b\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\uff08depth-first\uff09\u7684\u641c\u7d22\u3002\u5728\u7ee7\u7eed\u53d1\u73b0Bus 0\u4e0a\u7684\u5176\u4ed6Device/Function\u4e4b\u524d\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5fc5\u987b\u5148\u641c\u7d22Bus 1\u3002</p> </li> <li> <p>\u8f6f\u4ef6\u8bfb\u53d6Bus 1\u2014Device 0\u2014Function 0\u7684Vendor ID\uff0c\u8fd9\u4e2a\u76ee\u6807\u8bbe\u5907\u5728\u6211\u4eec\u7684\u793a\u4f8b\u56fe 3\u201113\u4e2d\u4e3aBridge C\u3002\u8fd9\u6b21\u8bfb\u53d6\u5c06\u8fd4\u56de\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8fd9\u8868\u793a\u5728Bus 1\u4e0a\u5b58\u5728Device 0\u2014Function 0\u3002</p> </li> <li> <p>\u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a1\uff080000001b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u53c8\u4e00\u4e2aPCI-to-PCI Bridge\u3002\u50cf\u4e4b\u524d\u4e00\u6837\uff0cbit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2aBridge C\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> </li> <li> <p>\u8f6f\u4ef6\u73b0\u5728\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge C\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=1</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=2</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u8f6f\u4ef6\u7ee7\u7eed\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\u7684\u641c\u7d22\uff08depth-first search\uff09\uff0c\u8bfb\u53d6Bus 2\u2014Device 0\u2014Function 0\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 2\u4e0a\u7684Device 0\u2014Function 0\u662fBridge D\u3002</p> </li> <li> <p>\u8bfb\u8bf7\u6c42\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 2\u2014Device 0\u2014Function 0\u5b58\u5728\u3002</p> </li> <li> <p>\u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a1\uff080000001b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u53c8\u4e00\u4e2aPCI-to-PCI Bridge\uff0c\u4e14bit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2aBridge D\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> </li> <li> <p>\u8f6f\u4ef6\u73b0\u5728\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge D\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=2</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=3</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u7ee7\u7eed\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\u7684\u641c\u7d22\uff08depth-first search\uff09\uff0c\u8bfb\u53d6Bus 3\u2014Device 0\u2014Function 0\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 2\u4e0a\u7684Device 0\u2014Function 0\u662fBridge D\u3002</p> </li> <li> <p>\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 3\u2014Device 0\u2014Function 0\u5b58\u5728\u3002</p> </li> <li> <p>\u8fd9\u6b21\u6709\u4e86\u4e0d\u540c\uff0c\u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a0\uff080000000b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u4e00\u4e2aEndpoint Function\uff08EP\uff09\u3002\u7531\u4e8e\u8fd9\u4e2aFunction\u662f\u4e00\u4e2aEP\u800c\u4e0d\u662f\u4e00\u4e2aBridge\uff0c\u5b83\u6709\u4e00\u4e2aType 0 Header\uff0c\u4e14\u5728\u8fd9\u4e2aEP\u4e4b\u4e0b\u5c31\u6ca1\u6709\u522b\u7684PCI\u517c\u5bb9\u603b\u7ebf\u4e86\uff08PCI-Compatible Bus\uff09\u3002\u8fd9\u4e2aEP\u7684bit 7\u7684\u503c\u4e3a1\uff08Multifunction bit=1\uff09\uff0c\u8868\u793a\u8fd9\u4e2aEP\u662f\u4e00\u4e2a\u591aFunction\u8bbe\u5907\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u5bf9Bus 3\u2014Device 0\u4e0a\u7684\u5168\u90e8\u53ef\u80fd\u76848\u4e2aFunction\u8fdb\u884c\u8bbf\u95ee\uff0c\u8bbf\u95ee\u5b83\u4eec\u5404\u81ea\u7684Vendor ID\uff0c\u7136\u540e\u8f6f\u4ef6\u786e\u8ba4\u9664\u4e86Function 0\u4e4b\u5916\u53ea\u5b58\u5728Function 1\u3002Function 1\u4e5f\u662f\u4e00\u4e2aEP\uff08Type 0 Header\uff09\uff0c\u56e0\u6b64\u5728\u8fd9\u4e2a\u8bbe\u5907\uff08Bus 3\u2014Device 0\uff09\u4e4b\u4e0b\u5e76\u4e0d\u5b58\u5728\u4e00\u4e2a\u9644\u52a0\u7684\u603b\u7ebf\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 3\u4e0a\u8fdb\u884c\u626b\u63cf\uff0c\u5bfb\u627eDevice 1\u5230Device 31\u4e0a\u6709\u6548\u7684Function\uff0c\u7136\u800c\u5e76\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u5176\u4ed6\u7684Function\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u5b8c\u6210\u4e86\u5bfb\u627eBridge D\u4e4b\u4e0b\u6240\u6709Function\u7684\u4efb\u52a1\u4e4b\u540e\uff0c\u5c31\u4f1a\u66f4\u65b0Bridge D\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u5c06\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c3\u3002\u7136\u540e\uff0c\u679a\u4e3e\u8f6f\u4ef6\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 2\uff09\uff0c\u5e76\u7ee7\u7eed\u5728\u8fd9\u4e2a\u603b\u7ebf\u4e0a\u626b\u63cf\uff0c\u5bfb\u627e\u6709\u6548\u7684Function\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 3\u4e0a\u7684Device 1\u2014Function 0\u662fBridge E\u3002</p> </li> <li> <p>\u914d\u7f6e\u8bfb\u8bf7\u6c42\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 2\u2014Device 1\u2014Function 0\u5b58\u5728\u3002</p> </li> <li> <p>\u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a1\uff080000001b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u53c8\u4e00\u4e2aPCI-to-PCI Bridge\uff0c\u4e14bit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2aBridge E\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> </li> <li> <p>\u8f6f\u4ef6\u73b0\u5728\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge E\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=2</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=4</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u8f6f\u4ef6\u7ee7\u7eed\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\u7684\u641c\u7d22\uff08depth-first search\uff09\uff0c\u8bfb\u53d6Bus 4\u2014Device 0\u2014Function 0\u7684Vendor ID\u3002</p> </li> <li> <p>\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 4\u2014Device 0\u2014Function 0\u5b58\u5728\u3002</p> </li> <li> <p>\u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a0\uff080000000b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u4e00\u4e2aEP\u8bbe\u5907\uff0c\u4e14bit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2a\u8bbe\u5907\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 4\u4e0a\u8fdb\u884c\u626b\u63cf\uff0c\u5bfb\u627eDevice 1\u5230Device 31\u4e0a\u6709\u6548\u7684Function\uff0c\u7136\u800c\u5e76\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u5176\u4ed6\u7684Function\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u5df2\u7ecf\u5230\u8fbe\u4e86\u8fd9\u4e2a\u641c\u7d22\u5206\u652f\u7684\u5e95\u90e8\uff0c\u56e0\u6b64\u5b83\u4f1a\u66f4\u65b0\u5f53\u524d\u603b\u7ebf\u4e4b\u4e0a\u76f8\u8fde\u7684Bridge\uff0c\u5728\u8fd9\u91cc\u4e3aBridge E\uff0c\u5c06\u5176\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c4\u3002\u7136\u540e\uff0c\u679a\u4e3e\u8f6f\u4ef6\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 2\uff09\uff0c\u5e76\u7ee7\u7eed\u8bfb\u53d6\u8be5\u603b\u7ebf\u4e0a\u7684\u4e0b\u4e00\u4e2a\u8bbe\u5907\uff08Device 2\uff09\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 2\u4e0a\u5e76\u6ca1\u6709\u5b9e\u73b0Device 2\u5230Device 31\uff0c\u56e0\u6b64\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4e0d\u4f1a\u53d1\u73b0Bus 2\u4e0a\u8fd8\u6709\u5176\u4ed6\u7684\u8bbe\u5907\uff0c\u4ec5\u6709Device 0\u548cDevice 1\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u66f4\u65b0Bus 2\u4e4b\u4e0a\u76f8\u8fde\u7684Bridge\uff0c\u5728\u8fd9\u91cc\u4e3aBridge C\uff0c\u5c06\u5176\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c4\uff0c\u5e76\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 1\uff09\uff0c\u7ee7\u7eed\u53bb\u8bfb\u53d6\u8be5\u603b\u7ebf\u4e0a\u7684\u4e0b\u4e00\u4e2a\u8bbe\u5907\uff08Device 1\uff09\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 1\u4e0a\u5e76\u6ca1\u6709\u5b9e\u73b0Device 1\u5230Device 31\uff0c\u56e0\u6b64\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4e0d\u4f1a\u53d1\u73b0Bus 1\u4e0a\u8fd8\u6709\u5176\u4ed6\u7684\u8bbe\u5907\uff0c\u4ec5\u6709Device 0\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u66f4\u65b0Bus 1\u4e4b\u4e0a\u76f8\u8fde\u7684Bridge\uff0c\u5728\u8fd9\u91cc\u4e3aBridge A\uff0c\u5c06\u5176\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c4\uff0c\u5e76\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 0\uff09\uff0c\u7ee7\u7eed\u53bb\u8bfb\u53d6\u8be5\u603b\u7ebf\u4e0a\u7684\u4e0b\u4e00\u4e2a\u8bbe\u5907\uff08Device 1\uff09\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 0\u4e0a\u7684Device 1\u2014Function 0\u662fBridge B\u3002</p> </li> <li> <p>\u5982\u524d\u9762\u6240\u8ff0\u7684\u76f8\u540c\u7684\u8fc7\u7a0b\uff0c\u679a\u4e3e\u8f6f\u4ef6\u53d1\u73b0Bridge B\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge B\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=0</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=5</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u7136\u540e\u679a\u4e3e\u8f6f\u4ef6\u53c8\u5728Bus 5\u4e0a\u53d1\u73b0Bridge F\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge F\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=5</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=6</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u63a5\u7740\u679a\u4e3e\u8f6f\u4ef6\u53c8\u5728Bus 6\u4e0a\u53d1\u73b0Bridge G\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge G\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=6</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=7</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u5f53\u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 7\u4e0a\u641c\u7d22\uff0c\u5b83\u53d1\u73b0\u4e86\u4e00\u4e2a\u5355Function\u7684EP\u8bbe\u5907\uff0cBus 7\u2014Device 0\u2014Function 0\uff0c\u56e0\u6b64\u5c06Bridge G\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u66f4\u65b0\u4e3a7\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u5411\u4e0a\u56de\u5230Bus 6\u7ee7\u7eed\u8fdb\u884c\u641c\u7d22\uff0c\u7136\u540e\u5b83\u53d1\u73b0\u4e86Bridge H\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge H\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=6</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=8</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u7136\u540e\u679a\u4e3e\u8f6f\u4ef6\u53c8\u5728Bus 8\u4e0a\u53d1\u73b0Bridge J\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge J\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=8</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=9</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>Bus 9\u4e0a\u7684\u6240\u6709\u8bbe\u5907\u4ee5\u53ca\u4e0e\u5b83\u4eec\u76f8\u5173\u7684Function\u90fd\u5df2\u7ecf\u5168\u90e8\u88ab\u641c\u7d22\u5b8c\u6210\uff0c\u5b83\u4eec\u90fd\u4e0d\u662fBridge\uff0c\u56e0\u6b64\u4e0b\u65b9\u4e5f\u5c31\u6ca1\u6709\u9644\u52a0\u7684\u603b\u7ebf\uff0c\u6240\u4ee5\u5c06Bridge H\u548cBridge J\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u66f4\u65b0\u4e3a9\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u5411\u4e0a\u56de\u5230Bus 6\u7ee7\u7eed\u8fdb\u884c\u641c\u7d22\uff0c\u7136\u540e\u5b83\u53d1\u73b0\u4e86Bridge I\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge I\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=6</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=10</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> <li> <p>\u5f53\u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 10\u4e0a\u641c\u7d22\uff0c\u5b83\u53d1\u73b0\u4e86\u4e00\u4e2a\u5355Function\u7684EP\u8bbe\u5907\uff0cBus 10\u2014Device 0\u2014Function 0\u3002</p> </li> <li> <p>\u7531\u4e8e\u679a\u4e3e\u8f6f\u4ef6\u5df2\u7ecf\u5230\u8fbe\u4e86\u8fd9\u4e2a\u641c\u7d22\u5206\u652f\u7684\u5e95\u90e8\uff0c\u8fd9\u4e2a\u5e95\u90e8\u662f\u4e5f\u662f\u6574\u4e2aPCIe\u62d3\u6251\u6811\u72b6\u7ed3\u6784\u7684\u5e95\u90e8\uff0c\u56e0\u6b64Bridge B\u3001F\u3001I\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u4f1a\u88ab\u66f4\u65b0\u4e3a10\uff0c\u800cHost/PCI Bridge\u4e5f\u4f1a\u5c06\u4ece\u5c5e\u603b\u7ebf\u5bc4\u5b58\u5668\u66f4\u65b0\u4e3a\u8fd9\u4e2a\u6570\u503c\u3002</p> </li> </ol> <p>\u6bcf\u4e2aBridge\u4e2d\u6700\u7ec8\u7684\u4e3b\u603b\u7ebf\u53f7\u3001\u6b21\u7ea7\u603b\u7ebf\u53f7\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u53ef\u4ee5\u53c2\u9605\u56fe 3\u20119\u3002</p> <p></p> <p>\u56fe 3\u201113\u5355Root\u7cfb\u7edf</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#313-rcmulti-root-enumeration-example","title":"3.13     \u591aRC\u679a\u4e3e\u793a\u4f8b\uff08Multi-Root Enumeration Example\uff09","text":""},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3131-general","title":"3.13.1    \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u8003\u8651\u5982\u56fe 3\u201114\u6240\u793a\u7684\u591aRC\u7cfb\u7edf\u3002\u5728\u8fd9\u4e2a\u7cfb\u7edf\u4e2d\uff0c\u6bcf\u4e2aRC\uff1a</p> <ul> <li> <p>\u5b9e\u73b0\u4e86\u5404\u81ea\u7684\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09\u548c\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08Configuration Data Port\uff09\uff0c\u5e76\u4e14\u5404\u4e2aRC\u4e2d\u7684\u8fd9\u4e9b\u76f8\u5e94\u7684\u7aef\u53e3\u7684IO\u5730\u5740\u662f\u76f8\u540c\u7684\uff0c\u6bd4\u5982RC 0\u548cRC 1\u7684\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684IO\u5730\u5740\u76f8\u540c\u3002</p> </li> <li> <p>\u90fd\u5b9e\u73b0\u4e86\u589e\u5f3a\u578b\u914d\u7f6e\u673a\u5236\u3002</p> </li> <li> <p>\u90fd\u5305\u542b\u4e00\u4e2aHost/PCI Bridge</p> </li> <li> <p>\u5b9e\u73b0\u4e86\u5404\u81ea\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff0c\u4f46\u662f\u4e0d\u540cRC\u7684\u8fd9\u4e24\u4e2a\u5bc4\u5b58\u5668\u5bf9\u4e8e\u914d\u7f6e\u8f6f\u4ef6\u6765\u8bf4\u662f\u4e0d\u540c\u7684\u64cd\u4f5c\u5730\u5740\u3002</p> </li> </ul> <p>\u5728\u56fe\u793a\u4e2d\uff0c\u6bcf\u4e2aRC\u90fd\u662f\u4e00\u4e2a\u82af\u7247\u7ec4\u6210\u5458\uff0c\u8fd9\u5176\u4e2d\u7684\u4e00\u4e2aRC\u88ab\u8bbe\u8ba1\u4e3a\u4e3bRC\uff0c\u5b83\u7684Bridge\u4e0b\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u4e3aBus 0\uff0c\u5b83\u88ab\u79f0\u4e3a\u4e3bRC\uff08Primary Root Complex\uff09\u3002\u800c\u53e6\u4e00\u4e2aRC\u7684Bridge\u4e0b\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u5219\u662f\u88ab\u6682\u65f6\u8ba4\u4e3a\u662fBus 255\uff0c\u5b83\u88ab\u79f0\u4e3a\u6b21\u7ea7RC\uff08Secondary Root Complex\uff09\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3132-rcmulti-root-enumeration-process","title":"3.13.2    \u591aRC\u679a\u4e3e\u8fc7\u7a0b\uff08Multi-Root Enumeration Process\uff09","text":"<p>\u5728\u5bf9\u56fe 3\u201114\u4e2d\u5de6\u4fa7\u7684\u6811\u72b6\u7ed3\u6784\u8fdb\u884c\u679a\u4e3e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6b21\u7ea7RC\u7684Host/PCI Bridge\u5c06\u4f1a\u5ffd\u7565\u6240\u6709\u7684\u914d\u7f6e\u8bbf\u95ee\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u4e2d\u6700\u5927\u7684\u4e5f\u4e0d\u4f1a\u8d85\u8fc79\u3002\u9700\u8981\u6ce8\u610f\uff0c\u867d\u7136Bus 8\u88ab\u68c0\u6d4b\u5230\u4e86\u5e76\u4e14\u4e5f\u88ab\u7f16\u4e86\u53f7\uff0c\u4f46\u662f\u8fd9\u6761\u603b\u7ebf\u4e0a\u5e76\u6ca1\u6709\u8fde\u63a5\u8bbe\u5907\u3002\u4e00\u65e6\u5de6\u4fa7\u6811\u72b6\u7ed3\u6784\u7684\u679a\u4e3e\u8fc7\u7a0b\u5b8c\u6210\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5c31\u4f1a\u8fdb\u884c\u5982\u4e0b\u7684\u8fd9\u4e9b\u6b65\u9aa4\u6765\u5bf9\u6b21\u7ea7RC\u8fdb\u884c\u679a\u4e3e\uff1a</p> <ol> <li> <p>\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201114\uff09\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4f1a\u628a\u6b21\u7ea7RC\u4e2dHost/PCI Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u90fd\u66f4\u6539\u4e3a64\u3002\uff0864\u548c128\u8fd9\u4e24\u4e2a\u503c\u5728\u591aRC\u7cfb\u7edf\u4e2d\u88ab\u7ecf\u5e38\u7528\u6765\u4f5c\u4e3a\u8d77\u59cb\u603b\u7ebf\u5730\u5740\uff0c\u4f46\u662f\u8fd9\u53ea\u662f\u8f6f\u4ef6\u7684\u4e00\u4e2a\u4e60\u60ef\uff0c\u5728PCI\u6216\u8005PCIe\u7684\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u5bf9\u8fd9\u79cd\u914d\u7f6e\u65b9\u5f0f\u6709\u786c\u6027\u89c4\u5b9a\u3002\u6bd4\u5982\u5728\u672c\u4f8b\u4e2d\u5373\u4f7f\u7ed9\u6b21\u7ea7RC\u7684\u8d77\u59cb\u603b\u7ebf\u5730\u5740\u8bbe\u7f6e\u4e3a10\uff0c\u4e5f\u4e0d\u4f1a\u5f15\u8d77\u4efb\u4f55\u9519\u8bef\u3002\uff09</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u5f00\u59cb\u5728Bus 64\u4e0a\u8fdb\u884c\u641c\u7d22\uff0c\u5e76\u53d1\u73b0\u4e86\u4e0eRC\u4e0b\u65b9\u7aef\u53e3\u76f8\u8fde\u7684Bridge\u3002</p> </li> <li> <p>\u7136\u540e\u679a\u4e3e\u8f6f\u4ef6\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> </li> <li> <p>\u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=64</p> </li> <li> <p>\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=65</p> </li> <li> <p>\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> </li> </ol> <p>\u73b0\u5728\uff0c\u8fd9\u4e2aBridge\u5c31\u8ba4\u4e3a\u5728\u5b83\u4e0b\u65b9\u4e0e\u5b83\u76f4\u63a5\u76f8\u8fde\u7684\u603b\u7ebf\u7f16\u53f7\u4e3a65\uff08\u6b21\u7ea7\u603b\u7ebf\u53f7=65\uff09\uff0c\u5e76\u4e14\u5b83\u4e0b\u65b9\u6700\u5927\u7684\u603b\u7ebf\u53f7\u4e3a255\uff08\u4ece\u5c5e\u603b\u7ebf\u53f7=255\uff09\u3002</p> <p>\u8bd1\u6ce8\uff1a\u8fd9\u91cc\u539f\u4e66\u6709\u8bef\uff0c\u539f\u4e66\u5199\u5176\u4e0b\u65b9\u7684\u6700\u5927\u603b\u7ebf\u53f7\u4e3a65\uff0c\u4f46\u662f\u5e94\u8be5\u662f255\uff0c\u53ea\u4e0d\u8fc7\u4e4b\u540e\u8fd9\u4e2a\u53f7\u4f1a\u88ab\u66f4\u65b0\u4e3a65</p> <ol> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus65\u4e0a\u8fdb\u884c\u641c\u7d22\uff0c\u5e76\u53d1\u73b0\u4e86Device 0\uff0c\u4e14\u5b83\u4ec5\u6709\u4e00\u4e2aFunction 0\u3002\u8fdb\u4e00\u6b65\u641c\u7d22\u7684\u7ed3\u679c\u663e\u793a\uff0c\u5728Bus 65\u4e0a\u5e76\u6ca1\u6709\u5176\u4ed6\u7684Device\u4e86\uff0c\u56e0\u6b64\u641c\u7d22\u8fc7\u7a0b\u8fd4\u56de\u5230\u4e0a\u4e00\u7ea7\u603b\u7ebf\u3002</p> </li> <li> <p>\u679a\u4e3e\u8f6f\u4ef6\u56de\u5230Bus 64\u7ee7\u7eed\u8fdb\u884c\uff0c\u7136\u800c\u4e5f\u6ca1\u6709\u53d1\u73b0\u4efb\u4f55\u5176\u4ed6\u7684\u8bbe\u5907\uff0c\u56e0\u6b64\u5c31\u5c06Host/PCI Bridge\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u66f4\u65b0\u4e3a65\u3002</p> </li> <li> <p>\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u6b21\u7ea7RC\u7684\u679a\u4e3e\u8fc7\u7a0b\u3002</p> </li> </ol> <p></p> <p>\u56fe 3\u201114\u591aRoot\u7cfb\u7edf</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3133-hot-plug-considerations","title":"3.13.3    \u70ed\u63d2\u62d4\u6ce8\u610f\u4e8b\u9879\uff08Hot-Plug Considerations\uff09","text":"<p>\u70ed\u63d2\u62d4\uff0c\u6307\u7684\u662f\u4e00\u4e2a\u63d2\u4ef6\u5361\uff08add-in card\uff09\u53ef\u4ee5\u5728\u7cfb\u7edf\u8fd0\u884c\u65f6\u63d2\u5165\u6216\u62d4\u51fa\u3002\u5728\u8fd9\u79cd\u70ed\u63d2\u62d4\u73af\u5883\u4e2d\uff0c\u5bf9\u4e8e\u56fe 3\u201114\u4e2d\u7684Bus 8\u6765\u8bf4\uff0c\u53ef\u80fd\u5e26\u6765\u6f5c\u5728\u7684\u9ebb\u70e6\u3002\u82e5\u7cfb\u7edf\u5df2\u7ecf\u5b8c\u6210\u679a\u4e3e\uff0c\u5e76\u5df2\u7ecf\u6b63\u5e38\u7684\u5f00\u59cb\u8fd0\u884c\u4e86\uff0c\u8fd9\u65f6\u5c06\u4e00\u4e2a\u542b\u6709Bridge\u7684\u63d2\u4ef6\u5361\u63d2\u5230Bus 8\u4e0a\uff0c\u5219\u6709\u53ef\u80fd\u4f1a\u5f15\u53d1\u95ee\u9898\u3002\u8fd9\u4e2a\u63d2\u4ef6\u5361\u5185\u7684Bridge\u5206\u914d\u7ed9\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u5c06\u4f1a\u6bd4\u81ea\u5df1\u7684\u4e3b\u603b\u7ebf\u4e0a\u7684\u5176\u4ed6\u4ece\u5c5e\u603b\u7ebf\u7684\u7f16\u53f7\u8fd8\u8981\u5927\uff0c\u5e76\u4e14\u5c06\u5b8c\u5168\u5305\u542b\u8fd9\u4e9b\u603b\u7ebf\u53f7\uff0c\u610f\u601d\u5c31\u662f\u8bf4\uff0cBus 8\u4e0b\u65b9\u82e5\u51fa\u73b0\u4e86\u65b0\u603b\u7ebf\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b0\u603b\u7ebf\u53ef\u80fd\u8981\u88ab\u5206\u914d\u4e3aBus 9\uff0c\u800c\u8fd9\u5c31\u4e0e\u5df2\u7ecf\u5b58\u5728\u7684Bus 9\u4ea7\u751f\u4e86\u51b2\u7a81\u3002\u8fd9\u662f\u56e0\u4e3a\u65b0\u7684\u603b\u7ebf\u53f7\u5fc5\u987b\u5728\u63d2\u4ef6\u5361\u4e0a\u65b9\u7684Bridge\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u5bf9\u4e8e\u672c\u4f8b\uff08\u56fe 3\u201114\uff09\u6765\u8bf4\u4e5f\u5c31\u662f\u57286-9\u7684\u8303\u56f4\u5185\u3002</p> <p>\u4e00\u79cd\u7528\u6765\u5206\u914dBus 8\u4e0b\u65b9\u8fd9\u4e9b\u65b0\u589e\u7684\u603b\u7ebf\u53f7\u7684\u65b9\u6cd5\u662f\uff0c\u5c06\u5f53\u524d\u7684Bus 9\u7684\u7f16\u53f7\u589e\u5927\uff0c\u4e3aBus 8\u4e0b\u7684\u65b0\u589e\u603b\u7ebf\u53f7\u817e\u51fa\u7f16\u53f7\u7684\u7a7a\u95f4\u3002\u5c3d\u7ba1\u5728\u7cfb\u7edf\u8fd0\u884c\u65f6\u8c03\u6574\u603b\u7ebf\u53f7\u662f\u53ef\u4ee5\u505a\u5230\u7684\uff0c\u4f46\u662f\u636e\u6709\u7ecf\u9a8c\u7684\u4eba\u8bf4\uff0c\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u7684\u6548\u679c\u4e0d\u662f\u5f88\u597d\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u7b80\u5355\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u6f5c\u5728\u7684\u95ee\u9898\uff1a\u53ea\u9700\u8981\u5728\u53d1\u73b0\u672a\u586b\u5145\u7684\u63d2\u4ef6\u5361\u63d2\u69fd\u65f6\uff0c\u7b80\u5355\u5730\u7559\u51fa\u4e00\u6bb5\u603b\u7ebf\u7f16\u53f7\u95f4\u9694\uff08bus number gap\uff09\u5373\u53ef\u3002\u4f8b\u5982\uff0c\u5f53Bus 8\u88ab\u5206\u914d\u4e86\u603b\u7ebf\u53f78\uff0c\u4f46\u662f\u5728\u5b83\u4e0b\u65b9\u53d1\u73b0\u4e86\u4e00\u4e2a\u7a7a\u7684\u63d2\u4ef6\u5361\u63d2\u69fd\uff0c\u90a3\u4e48\u5c31\u7ed9\u4e0b\u4e00\u4e2a\u88ab\u53d1\u73b0\u7684\u603b\u7ebf\u4e00\u4e2a\u66f4\u9ad8\u7684\u603b\u7ebf\u53f7\uff0c\u6bd4\u5982\u7ed9\u5b83\u7f16\u53f719\u800c\u4e0d\u662f9\uff0c\u8fd9\u6837\u5c31\u4e3aBus 8\u4e4b\u4e0b\u4ee5\u540e\u53ef\u80fd\u7684\u65b0\u589e\u603b\u7ebf\u7559\u51fa\u4e86\u7f16\u53f7\u7a7a\u95f4\u3002\u7136\u540e\uff0c\u5982\u679c\u4e00\u4e2a\u5e26\u6709Bridge\u7684\u63d2\u4ef6\u5361\u88ab\u63d2\u5165\uff0c\u90a3\u4e48\u65b0\u589e\u7684\u603b\u7ebf\u5c31\u53ef\u4ee5\u4eceBus 9\u5f00\u59cb\u7f16\u53f7\uff0c\u800c\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u95ee\u9898\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u7559\u51fa\u8fd9\u6837\u7684\u603b\u7ebf\u7f16\u53f7\u95f4\u9694\u5e76\u4e0d\u4f1a\u5f15\u53d1\u95ee\u9898\uff0c\u56e0\u4e3a\u7cfb\u7edf\u603b\u5171\u53ef\u4ee5\u5206\u914d256\u4e2a\u603b\u7ebf\u53f7\uff0c\u7f16\u53f7\u8d44\u6e90\u8f83\u4e3a\u5145\u8db3\u3002</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#314-mindshare-arbor","title":"3.14     MindShare Arbor\uff1a\u8c03\u8bd5/\u9a8c\u8bc1/\u5206\u6790\u548c\u5b66\u4e60\u7684\u8f6f\u4ef6\u5de5\u5177","text":""},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3141-general","title":"3.14.1    \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>MindShare Arbor\u662f\u4e00\u4e2a\u8ba1\u7b97\u673a\u7cfb\u7edf\u8c03\u8bd5\uff08Debug\uff09\u3001\u9a8c\u8bc1\uff08Validation\uff09\u3001\u5206\u6790\uff08Analysis\uff09\u548c\u5b66\u4e60\u7684\u5de5\u5177\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u5bf9\u4efb\u610f\u7684memory\u3001IO\u6216\u8005\u914d\u7f6e\u7a7a\u95f4\u7684\u5730\u5740\u8fdb\u884c\u8bfb\u53d6\u6216\u8005\u5199\u5165\u3002\u8bfb\u53d6\u8fd9\u4e9b\u5730\u5740\u8fd4\u56de\u56de\u6765\u7684\u6570\u636e\u5c06\u4ee5\u4e00\u4e2a\u7b80\u6d01\u660e\u4e86\u4e14\u4fe1\u606f\u4e30\u5bcc\u7684\u6837\u5f0f\u8fdb\u884c\u67e5\u770b\u3002</p> <p>\u672c\u4e66\u7684\u4f5c\u8005\u51b3\u5b9a\u4e0d\u5728\u67d0\u4e00\u4e2a\u6807\u5fd7\u6027\u7684\u7279\u5b9a\u7ae0\u8282\u4e2d\u5bf9\u6240\u6709\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u90fd\u8fdb\u884c\u8be6\u7ec6\u63cf\u8ff0\u3002\u76f8\u53cd\u5730\uff0c\u5404\u4e2a\u5bc4\u5b58\u5668\u5c06\u5206\u6563\u5728\u5168\u4e66\u4e2d\uff0c\u5728\u4e0e\u5b83\u4eec\u5404\u81ea\u76f8\u5173\u7684\u7ae0\u8282\u4e2d\u8fdb\u884c\u8be6\u7ec6\u8bb2\u8ff0\u3002</p> <p>MindShare Arbor\u662f\u4e00\u4e2a\u5f88\u68d2\u7684\u53c2\u8003\u5b66\u4e60\u5de5\u5177\uff0c\u53ef\u4ee5\u7528\u5b83\u6765\u4ee3\u66ff\u4e66\u4e2d\u6ca1\u6709\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4\u7684\u4e13\u7528\u63cf\u8ff0\u7ae0\u8282\u3002\u901a\u8fc7MindShare Arbor\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u7684\u7406\u89e3PCI\u3001PCI-X\u4ee5\u53caPCI Express\u4e2d\u5b9e\u73b0\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u548c\u7ed3\u6784\u3002\u6240\u6709\u7684\u5bc4\u5b58\u5668\u548c\u5b57\u6bb5\u5b9a\u4e49\u90fd\u662f\u6309\u7167\u6700\u65b0\u7248\u672c\u7684PCI Express\u534f\u8bae\u8fdb\u884c\u66f4\u65b0\u7684\u3002\u4e00\u4e9b\u5176\u4ed6\u79cd\u7c7b\u7684\u7ed3\u6784\uff08\u4f8b\u5982x86 MSRs\u3001ACPI\u3001USB\u3001NVM Express\uff09\u4e5f\u53ef\u4ee5\u5728MindShare Arbor\u4e2d\u8fdb\u884c\u67e5\u770b\uff08\u4e00\u4e9b\u6682\u65f6\u6ca1\u6709\u7684\u4e5f\u4f1a\u5f88\u5feb\u5c31\u53ef\u4ee5\u652f\u6301\u67e5\u770b\uff09\u3002</p> <p>\u8bbf\u95eewww.mindshare.com/arbor\u5373\u53ef\u514d\u8d39\u4e0b\u8f7dMindShare Arbor\u7684\u8bd5\u7528\u7248\u3002</p> <p></p> <p>\u56fe 3\u201115 MindShare Arbor\u7684\u90e8\u5206\u622a\u56fe</p>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#3142-mindshare-arbor","title":"3.14.2    MindShare Arbor\u529f\u80fd\u5217\u8868","text":"<ul> <li>\u5305\u542bPCIe 3.0\u534f\u8bae\u4e2d\u7684\u6240\u6709\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u63cf\u8ff0\u5185\u5bb9\u3002</li> <li>\u53ef\u4ee5\u626b\u63cf\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u6240\u6709PCI\u53ef\u89c1Function\u7684\u914d\u7f6e\u7a7a\u95f4\uff0c\u5e76\u4ee5\u53ef\u8bfb\u6027\u6781\u5f3a\u7684\u683c\u5f0f\u5c06\u6bcf\u4e2a\u5bc4\u5b58\u5668\u7684\u8bb2\u89e3\u90fd\u5c55\u793a\u51fa\u6765\u3002</li> <li>\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u4efb\u4f55\u7684memory\u6216\u8005IO\u5730\u5740\u3002</li> <li>\u53ef\u4ee5\u5199\u5165\u4efb\u610f\u7684\u914d\u7f6e\u7a7a\u95f4\u4f4d\u7f6e\u3001memory\u5730\u5740\u6216\u662fIO\u5730\u5740\u3002</li> <li>\u53ef\u4ee5\u5728\u4e00\u4e2a\u5df2\u7ecf\u89e3\u7801\u7684\u683c\u5f0f\u4e2d\u67e5\u770b\u6807\u51c6\u6216\u975e\u6807\u51c6\u7684\u7ed3\u6784\u4f53</li> <li> <p>\u89e3\u7801\u4fe1\u606f\u53ef\u4ee5\u7ed9\u6807\u51c6\u7684PCI\u3001PCI-X\u3001PCI Express\u7ed3\u6784\u4f53\u8fdb\u884c\u89e3\u7801\u3002</p> </li> <li> <p>\u89e3\u7801\u4fe1\u606f\u53ef\u4ee5\u7ed9\u4e00\u4e9b\u57fa\u4e8ex86\u7684\u7ed3\u6784\u4f53\u548c\u8bbe\u5907\u7279\u522b\u7684\u5bc4\u5b58\u5668\u8fdb\u884c\u89e3\u7801\u3002</p> </li> <li> <p>\u53ef\u4ee5\u521b\u5efa\u81ea\u5df1\u5b9a\u4e49\u7684\u57fa\u4e8eXML\u7684\u8bd1\u7801\u6587\u4ef6\uff0c\u6765\u9a71\u52a8Arbor\u7684\u4fe1\u606f\u663e\u793a\u3002</p> </li> <li> <p>\u53ef\u4ee5\u521b\u5efa\u8bd1\u7801\u6587\u4ef6\uff0c\u6765\u5bf9\u914d\u7f6e\u7a7a\u95f4\u3001\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u548cIO\u7a7a\u95f4\u5185\u7684\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p> </li> <li> <p>\u53ef\u4ee5\u4fdd\u5b58\u7cfb\u7edf\u626b\u63cf\u7684\u7ed3\u679c\uff0c\u5e76\u4e4b\u540e\u518d\u5728\u5176\u4ed6\u7cfb\u7edf\u4e0a\u67e5\u770b\u8fd9\u4e2a\u7ed3\u679c\u3002</p> </li> <li> <p>\u4fdd\u5b58\u7684\u7cfb\u7edf\u626b\u63cf\u7ed3\u679c\u662f\u57fa\u4e8eXML\u7684\u5f00\u6e90\u683c\u5f0f\u7684\u6587\u4ef6\u3002</p> </li> <li> <p>\u5df2\u7ecf\u62e5\u6709\u6216\u8005\u5373\u5c06\u62e5\u6709\u7684\u65b0\u529f\u80fd\u7279\u6027</p> </li> <li> <p>\u53ef\u4ee5\u68c0\u67e5\u51e0\u6b21\u626b\u63cf\u7ed3\u679c\u4e4b\u95f4\u7684\u5dee\u5f02\u3002</p> </li> <li> <p>\u53ef\u4ee5\u4e3a\u626b\u63cf\u4e2d\u7684\u8fdd\u89c4\u6216\u8005\u975e\u6700\u4f73\u7684\u8bbe\u7f6e\u8fdb\u884c\u540e\u671f\u5904\u7406\u3002</p> </li> <li> <p>\u53ef\u4ee5\u652f\u6301\u811a\u672c\u6765\u8fbe\u5230\u81ea\u52a8\u5316\u3002</p> </li> <li> <p>\u53ef\u4ee5\u5bf9x86\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\uff08MSRs\u3001paging\u3001segmentation\u3001interrupt tables\u7b49\u7b49\uff09\u3002</p> </li> <li> <p>\u53ef\u4ee5\u5bf9ACPI\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p> </li> <li> <p>\u53ef\u4ee5\u5bf9USB\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p> </li> <li> <p>\u53ef\u4ee5\u5bf9NVM Express\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p> </li> </ul>"},{"location":"pcie/03%20PCIe%20%E9%85%8D%E7%BD%AE%E6%A6%82%E8%BF%B0/#_4","title":"\u672f\u8bed\u7ffb\u8bd1","text":"\u82f1\u6587 \u7ffb\u8bd1 PCI-Compatible configuration space PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4 PCIe extended configuration space PCIe\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4 Base Address Register \u57fa\u5740\u5bc4\u5b58\u5668 bus \u603b\u7ebf device \u8bbe\u5907 function \u529f\u80fd capability structures \u80fd\u529b\u7ed3\u6784 Enhanced configuration mechanism \u589e\u5f3a\u914d\u7f6e\u673a\u5236 IO-indirect access IO\u95f4\u63a5\u8bbf\u95ee memory-mapped access \u5185\u5b58\u6620\u5c04\u8bbf\u95ee Primary Bus Number \u4e3b\u603b\u7ebf\u53f7 Secondary Bus Number \u6b21\u7ea7\u603b\u7ebf\u53f7 Subordinate Bus Number \u4ece\u5c5e\u603b\u7ebf\u53f7 Enumeration \u679a\u4e3e <p>\u539f\u6587\uff1a  Mindshare</p> <p>\u8bd1\u8005\uff1a  Michael ZZY</p> <p>\u6821\u5bf9\uff1a  LJGibbs</p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/","title":"04 \u5730\u5740\u7a7a\u95f4\u4e0e\u4e8b\u52a1\u8def\u7531","text":""},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#chapter-4-address-space-transaction-routing","title":"Chapter 4      Address Space &amp; Transaction Routing//\u5730\u5740\u7a7a\u95f4\u4e0e\u4e8b\u52a1\u8def\u7531","text":""},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#_1","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u524d\u4e00\u7ae0\u8282\u5bf9PCIe\u73af\u5883\u4e2d\u7684\u914d\u7f6e\u64cd\u4f5c\u8fdb\u884c\u4e86\u4ecb\u7ecd\u3002\u8fd9\u4e9b\u4ecb\u7ecd\u5305\u62ec\u7528\u6765\u5b9e\u73b0Function\u914d\u7f6e\u7684\u5bc4\u5b58\u5668\u7684\u7a7a\u95f4\u3001\u4e00\u4e2aFunction\u662f\u5982\u4f55\u88ab\u53d1\u73b0\u7684\u3001\u914d\u7f6e\u4e8b\u52a1\u662f\u5982\u4f55\u88ab\u751f\u6210\u5e76\u8def\u7531\u8f6c\u53d1\u7684\u3001PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\u548cPCIe\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u7684\u4e0d\u540c\u70b9\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u662f\u5982\u4f55\u533a\u5206\u5f00EP\u548cBridge\u7684\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u63cf\u8ff0\u4e00\u4e2aFunction\u901a\u8fc7Base Address Registers\uff08BARs\uff0c\u57fa\u5730\u5740\u5bc4\u5b58\u5668\uff09\u6765\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\uff08memory\u5730\u5740\u7a7a\u95f4\u6216IO\u5730\u5740\u7a7a\u95f4\uff09\u7684\u76ee\u7684\u548c\u65b9\u6cd5\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u9700\u8981\u600e\u6837\u8bbe\u7f6e\u6240\u6709\u7684Bridge\u5185\u7684Base/Limit\u5bc4\u5b58\u5668\u6765\u4f7f\u5f97TLPs\u80fd\u4ece\u4e00\u4e2a\u6e90\u7aef\u53e3\u88ab\u8def\u7531\u8f6c\u53d1\u81f3\u6b63\u786e\u7684\u76ee\u7684\u7aef\u53e3\u3002\u53e6\u5916\uff0c\u672c\u7ae0\u4e5f\u5c06\u4f1a\u8ba8\u8bbaPCIe\u4e2dTLP\u8def\u7531\u7684\u4e00\u822c\u6982\u5ff5\uff0c\u5305\u62ec\u57fa\u4e8e\u5730\u5740\u7684\u8def\u7531\u3001\u57fa\u4e8eID\u7684\u8def\u7531\u548c\u9690\u5f0f\u8def\u7531\uff08implicit routing\uff09\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u7684\u5c06\u5bf9TLP\uff08Transaction Layer Packet\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\u7684\u5185\u5bb9\u8fdb\u884c\u8be6\u7ec6\u63cf\u8ff0\u3002\u6211\u4eec\u5c06\u63cf\u8ff0\u5b83\u7684\u7528\u9014\u3001\u683c\u5f0f\u3001TLP Type\u7684\u5b9a\u4e49\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9b\u76f8\u5173\u5b57\u6bb5\u7684\u8be6\u7ec6\u5185\u5bb9\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#41-i-need-an-address","title":"4.1 \u6211\u9700\u8981\u4e00\u4e2a\u5730\u5740\uff08I Need An Address\uff09","text":"<p>\u51e0\u4e4e\u6240\u6709\u7684\u8bbe\u5907\u4e2d\u90fd\u6709\u80fd\u591f\u8ba9\u8f6f\u4ef6\uff08\u6216\u662f\u5176\u4ed6\u6f5c\u5728\u7684\u8bbe\u5907\uff09\u8bbf\u95ee\u7684\u5185\u90e8\u5bc4\u5b58\u5668\u6216\u662f\u5b58\u50a8\u7a7a\u95f4\u4f4d\u7f6e\u3002\u8fd9\u4e9b\u5185\u90e8\u4f4d\u7f6e\u6709\u53ef\u80fd\u7528\u6765\u63a7\u5236\u8bbe\u5907\u7684\u884c\u4e3a\u3001\u62a5\u544a\u8bbe\u5907\u7684\u72b6\u6001\uff0c\u6216\u8005\u53ef\u80fd\u7528\u6765\u4fdd\u6301\u4f4f\u8bbe\u5907\u8981\u8fdb\u884c\u5904\u7406\u7684\u6570\u636e\u3002\u8fd9\u91cc\u5148\u4e0d\u7ba1\u8fd9\u4e9b\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u7684\u76ee\u7684\uff0c\u6211\u4eec\u8fd9\u91cc\u66f4\u770b\u91cd\u7684\u4e00\u70b9\u662f\u53ef\u4ee5\u4ece\u8bbe\u5907\u5916\u90e8\u6765\u5bf9\u5b83\u4eec\u8fdb\u884c\u8bbf\u95ee\u3002\u8fd9\u610f\u5473\u7740\u8fd9\u4e9b\u5185\u90e8\u4f4d\u7f6e\u9700\u8981\u662f\u53ef\u5bfb\u5740\u7684\uff08addressable\uff09\u3002\u8f6f\u4ef6\u5fc5\u987b\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a\u5e26\u6709\u5730\u5740\u7684\u8bfb\u6216\u8005\u5199\u64cd\u4f5c\uff0c\u4ee5\u6b64\u6765\u8bbf\u95ee\u76ee\u6807\u8bbe\u5907\u5185\u76f8\u5e94\u7684\u5185\u90e8\u4f4d\u7f6e\u3002\u4e3a\u4e86\u8ba9\u8fd9\u79cd\u65b9\u5f0f\u53ef\u884c\uff0c\u8fd9\u4e9b\u5185\u90e8\u4f4d\u7f6e\u90fd\u9700\u8981\u88ab\u5206\u914d\u5730\u5740\uff0c\u5e76\u4e14\u6240\u5206\u914d\u7684\u5730\u5740\u4e5f\u90fd\u5fc5\u987b\u662f\u7cfb\u7edf\u6240\u652f\u6301\u7684\u5730\u5740\u7a7a\u95f4\u3002</p> <p>PCIe\u652f\u6301\u4e09\u4e2a\u5730\u5740\u7a7a\u95f4\uff0c\u4e0ePCI\u4e2d\u7684\u4e09\u4e2a\u5730\u5740\u7a7a\u95f4\u5b8c\u5168\u76f8\u540c\uff1a</p> <p>n \u914d\u7f6e\u7a7a\u95f4\uff08Configuration\uff09</p> <p>n \u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08Memory\uff09</p> <p>n IO\u5730\u5740\u7a7a\u95f4\uff08IO\uff09</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#411-configuration-space","title":"4.1.1     \u914d\u7f6e\u7a7a\u95f4\uff08Configuration Space\uff09","text":"<p>\u5982\u6211\u4eec\u5728Chapter 1\u4e2d\u6240\u8ba8\u8bba\u7684\uff0c\u914d\u7f6e\u7a7a\u95f4\u662f\u7531PCI\u5f15\u5165\u7684\uff0c\u8f6f\u4ef6\u901a\u8fc7\u914d\u7f6e\u7a7a\u95f4\u5c31\u53ef\u4ee5\u7528\u4e00\u79cd\u6807\u51c6\u5316\u7684\u65b9\u6cd5\u6765\u5bf9\u8bbe\u5907\u7684\u72b6\u6001\u8fdb\u884c\u63a7\u5236\u548c\u68c0\u67e5\u3002PCIe\u5bf9PCI\u8f6f\u4ef6\u5177\u6709\u5411\u540e\u517c\u5bb9\u6027\uff0c\u6240\u4ee5PCIe\u4e2d\u4ecd\u7136\u652f\u6301\u914d\u7f6e\u7a7a\u95f4\uff0c\u5e76\u4e14\u652f\u6301\u5b83\u7684\u539f\u56e0\u4e5f\u548cPCI\u4e00\u6837\uff0c\u5373\u7528\u4e00\u79cd\u6807\u51c6\u5316\u7684\u65b9\u6cd5\u6765\u5bf9\u8bbe\u5907\u7684\u72b6\u6001\u8fdb\u884c\u63a7\u5236\u548c\u68c0\u67e5\u3002\u66f4\u591a\u5173\u4e8e\u914d\u7f6e\u7a7a\u95f4\u7684\u4fe1\u606f\uff08\u76ee\u7684\u3001\u5982\u4f55\u8bbf\u95ee\u3001\u5927\u5c0f\u3001\u5185\u5bb9\u7b49\u7b49\uff09\u8bf7\u53c2\u9605Chapter 3\u3002</p> <p>\u5c3d\u7ba1\u914d\u7f6e\u7a7a\u95f4\u51fa\u73b0\u7684\u610f\u4e49\u662f\u6765\u653e\u7f6e\u548c\u4fdd\u6301\u4e00\u4e9b\u6807\u51c6\u5316\u7684\u7ed3\u6784\uff08PCI-defined Header\u3001Capability Structure\u80fd\u529b\u7ed3\u6784\u7b49\u7b49\uff09\uff0c\u4f46\u662fPCIe\u8bbe\u5907\u4e5f\u4f1a\u7ecf\u5e38\u7684\u5c06\u4e00\u4e9b\u8bbe\u5907\u7279\u5b9a\uff08device-specific\uff09\u7684\u5bc4\u5b58\u5668\u6620\u5c04\u5230\u8bbe\u5907\u81ea\u8eab\u7684\u914d\u7f6e\u7a7a\u95f4\u4e2d\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6620\u5c04\u5230\u914d\u7f6e\u7a7a\u95f4\u7684\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\u5e38\u7528\u6765\u4f5c\u4e3a\u63a7\u5236\u5bc4\u5b58\u5668\uff08control\uff09\u3001\u72b6\u6001\u5bc4\u5b58\u5668\uff08status\uff09\u6216\u8005\u6307\u9488\u5bc4\u5b58\u5668\uff08pointer\uff09\uff0c\u800c\u4e0d\u662f\u7528\u6765\u5b58\u50a8\u6570\u636e\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#412-iomemory-and-io-address-spaces","title":"4.1.2     \u5185\u5b58\u548cIO\u5730\u5740\u7a7a\u95f4\uff08Memory and IO Address Spaces\uff09","text":""},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4121-general","title":"4.1.2.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5728PC\u7684\u65e9\u671f\u9636\u6bb5\uff0cIO\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u662f\u901a\u8fc7IO\u5730\u5740\u7a7a\u95f4\uff08IO Address\uff0c\u5b83\u662f\u7531intel\u5b9a\u4e49\u7684\uff09\u6765\u8bbf\u95ee\u7684\u3002\u7136\u800c\uff0c\u7531\u4e8eIO\u5730\u5740\u7a7a\u95f4\u7684\u4e00\u4e9b\u9650\u5236\u548c\u4e0d\u826f\u5f71\u54cd\uff08\u5728\u8fd9\u91cc\u6211\u4eec\u6682\u4e0d\u8ba8\u8bba\uff09\uff0c\u8fd9\u79cd\u5730\u5740\u7a7a\u95f4\u5f88\u5feb\u5c31\u5931\u53bb\u4e86\u8f6f\u4ef6\u548c\u786c\u4ef6\u5382\u5546\u7684\u9752\u7750\u3002\u8fd9\u4f7f\u5f97IO\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u88ab\u6620\u5c04\u5230\u4e86memory\u5730\u5740\u7a7a\u95f4\uff08Memory Address Space\uff0c\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff09\uff0c\u4e00\u822c\u88ab\u79f0\u4f5c\u5185\u5b58\u6620\u5c04IO\u6216\u8005\u7b80\u79f0MMIO\uff08Memory-Mapped IO\uff09\u3002\u7136\u800c\uff0c\u56e0\u4e3a\u65e9\u671f\u7684\u8f6f\u4ef6\u662f\u4f7f\u7528IO\u5730\u5740\u7a7a\u95f4\u6765\u8bbf\u95eeIO\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u7684\uff0c\u6240\u4ee5\u5b9e\u9645\u4e2d\u5e38\u7528\u7684\u505a\u6cd5\u662f\u5c06\u4e00\u5957\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\u65e2\u6620\u5c04\u5230\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u4e5f\u6620\u5c04\u5230IO\u5730\u5740\u7a7a\u95f4\u3002\u8fd9\u4f7f\u5f97\u65b0\u7684\u8f6f\u4ef6\u53ef\u4ee5\u4f7f\u7528\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7MMIO\uff0c\u6765\u5bf9\u8bbe\u5907\u7684\u5185\u90e8\u4f4d\u7f6e\u8fdb\u884c\u8bbf\u95ee\u3002\u800c\u4f20\u7edf\uff08\u65e7\uff09\u7684\u8f6f\u4ef6\u4e5f\u4f9d\u7136\u53ef\u4ee5\u8fd0\u884c\uff0c\u56e0\u4e3a\u5b83\u4f9d\u7136\u53ef\u4ee5\u901a\u8fc7IO\u5730\u5740\u7a7a\u95f4\u6765\u8bbf\u95ee\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668\u3002</p> <p>\u5bf9\u4e8e\u66f4\u52a0\u65b0\u578b\u7684\u8bbe\u5907\uff0c\u5982\u679c\u5b83\u4eec\u4e0d\u518d\u4f9d\u8d56\u8001\u65e7\u7684\u4f20\u7edf\u8f6f\u4ef6\u5e76\u4e14\u4e5f\u4e0d\u9700\u8981\u8003\u8651\u5bf9\u4f20\u7edf\u64cd\u4f5c\u7684\u517c\u5bb9\u95ee\u9898\uff0c\u90a3\u4e48\u5b83\u4eec\u4e00\u822c\u53ea\u8981\u5c06\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u6620\u5c04\u5230\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08MMIO\uff09\u5373\u53ef\uff0c\u800c\u4e0d\u9700\u8981\u8bf7\u6c42IO\u5730\u5740\u7a7a\u95f4\u6765\u8fdb\u884c\u6620\u5c04\u3002\u5b9e\u9645\u4e0a\uff0cPCIe\u534f\u8bae\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528IO\u5730\u5740\u7a7a\u95f4\uff0c\u652f\u6301\u8fd9\u79cd\u64cd\u4f5c\u4ec5\u4ec5\u662f\u56e0\u4e3a\u4e00\u4e9b\u4f20\u7edf\u9057\u7559\u95ee\u9898\uff0c\u5e76\u6709\u53ef\u80fd\u5728\u672a\u6765\u65b0\u7248\u672c\u7684\u534f\u8bae\u4e2d\u88ab\u5f03\u7528\u3002</p> <p>\u5982\u56fe 4\u20111\u6240\u793a\uff0c\u56fe\u4e2d\u5c55\u793a\u4e86\u4e00\u79cd\u901a\u7528\u7684\u5185\u5b58\u548cIO\u7684\u6620\u5c04\u3002\u5185\u5b58\u6620\u5c04\u7684\u5927\u5c0f\u662f\u8fd9\u4e2a\u7cfb\u7edf\u53ef\u4f7f\u7528\u5730\u5740\u8303\u56f4\uff08\u901a\u5e38\u7531CPU\u7684\u53ef\u5bfb\u5740\u8303\u56f4\u51b3\u5b9a\uff09\u7684\u4e00\u4e2a\u51fd\u6570\u3002PCIe\u4e2dIO\u6620\u5c04\u7684\u5927\u5c0f\u88ab\u9650\u5236\u4e3a32bits\uff084GB\uff09\uff0c\u867d\u7136\u5176\u5b9e\u5f88\u591a\u4f7f\u7528Intel\u517c\u5bb9\uff08x86\uff09\u5904\u7406\u5668\u7684\u8ba1\u7b97\u673a\u4e2d\u4ec5\u6709\u4f4e16bit\uff0864KB\uff09\u88ab\u4f7f\u7528\u3002PCIe\u53ef\u4ee5\u652f\u6301\u7684\u5185\u5b58\u5730\u5740\u5927\u5c0f\u8fbe\u523064bit\u3002</p> <p>\u56fe 4\u20111\u7ed9\u51fa\u7684\u6620\u5c04\u793a\u4f8b\u4ec5\u5c55\u793a\u4e86EP\u6240\u58f0\u660e\u4f7f\u7528\u7684MMIO\u548cIO\uff0c\u4f46\u662f\u8fd9\u79cd\u80fd\u529b\u5e76\u4e0d\u662fEP\u6240\u72ec\u6709\u7684\u3002\u5b83\u5bf9\u4e8eSwitch\u548cRC\u6765\u8bf4\u4e5f\u662f\u4e00\u79cd\u5f88\u666e\u901a\u7684\u80fd\u529b\uff0cSwitch\u548cRC\u5185\u90e8\u4e5f\u5b58\u5728\u7740\u53ef\u4ee5\u901a\u8fc7MMIO\u548cIO\u5730\u5740\u6765\u8fdb\u884c\u8bbf\u95ee\u7684\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4122-prefetchable-vs-non-prefetchable-memory-space","title":"4.1.2.2   \u53ef\u9884\u53d6\u7684\u4e0e\u4e0d\u53ef\u9884\u53d6\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u5bf9\u6bd4\uff08Prefetchable vs. Non-Prefetchable Memory Space\uff09","text":"<p>\u56fe 4\u20111\u5c55\u793a\u4e86\u88abPCIe\u8bbe\u5907\u58f0\u660e\u7684\u4e24\u79cd\u4e0d\u540c\u7c7b\u578b\u7684MMIO\uff1a\u53ef\u9884\u53d6MMIO\uff08Prefetchable MMIO\uff0cP-MMIO\uff09\u548c\u4e0d\u53ef\u9884\u53d6MMIO\uff08Non-Prefetchable MMIO\uff0cNP-MMIO\uff09\u3002\u4e86\u89e3\u8fd9\u4e24\u79cd\u5185\u5b58\u7a7a\u95f4\u4e4b\u95f4\u7684\u533a\u522b\u662f\u5341\u5206\u91cd\u8981\u7684\u3002\u53ef\u9884\u53d6\u7a7a\u95f4\u6709\u4e24\u4e2a\u610f\u4e49\u5341\u5206\u660e\u786e\u7684\u5c5e\u6027\uff1a</p> <p>n \u8bfb\u64cd\u4f5c\u4e0d\u5b58\u5728\u526f\u4f5c\u7528\u3002\uff08Reads do not have side effects\uff09</p> <p>n \u5141\u8bb8\u5199\u5408\u5e76\uff08Write merging is allowed\uff09</p> <p>\u5c06MMIO\u7684\u4e00\u4e2a\u533a\u57df\u5b9a\u4e49\u4e3a\u53ef\u9884\u53d6\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u63a8\u6d4b\u6027\u7684\u63d0\u524d\u83b7\u53d6\u8be5\u533a\u57df\u4e2d\u7684\u6570\u636e\uff0c\u4ee5\u9884\u6d4bRequester\u5728\u4e0d\u4e45\u7684\u5c06\u6765\u53ef\u80fd\u9700\u8981\u6bd4\u5f53\u524d\u5b9e\u9645\u8bf7\u6c42\u66f4\u591a\u7684\u6570\u636e\u3002\u4e4b\u6240\u4ee5\u8fd9\u79cd\u5c0f\u578b\u7684Caching\uff08Minor Caching\uff09\u6570\u636e\u64cd\u4f5c\u662f\u5b89\u5168\u7684\uff0c\u662f\u56e0\u4e3a\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u5e76\u4e0d\u4f1a\u6539\u53d8\u76ee\u6807\u8bbe\u5907\u7684\u4efb\u4f55\u72b6\u6001\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u8bf4\u8bfb\u53d6\u67d0\u4e2a\u4f4d\u7f6e\u5e76\u4e0d\u4f1a\u5e26\u6765\u526f\u4f5c\u7528\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aRequester\u8bf7\u6c42\u4ece\u4e00\u4e2a\u5730\u5740\u4e2d\u8bfb\u53d6128byte\u6570\u636e\uff0c\u90a3\u4e48Completer\u53ef\u4ee5\u5728\u7ed9\u51fa\u6b64\u6b21\u8bf7\u6c42\u7684128byte\u4e4b\u540e\u4e5f\u9884\u53d6\u51fa\u4e0b\u4e00\u4e2a128byte\uff0c\u800c\u5f53\u4e0b\u4e00\u4e2a128byte\u88ab\u8bf7\u6c42\u65f6\u6570\u636e\u65e9\u5df2\u7ecf\u88abCompleter\u4ece\u5185\u5b58\u7a7a\u95f4\u4e2d\u9884\u53d6\u51fa\u6765\u4e86\uff0c\u8fd9\u6837\u5c31\u63d0\u9ad8\u4e86\u6027\u80fd\u3002\u7136\u800c\u5982\u679cRequester\u518d\u4e5f\u6ca1\u6709\u8bf7\u6c42\u989d\u5916\u7684\u6570\u636e\uff0c\u90a3\u4e48Completer\u5c31\u9700\u8981\u5c06\u9884\u53d6\u7684\u6570\u636e\u6e05\u9664\u6389\uff0c\u91ca\u653e\u81ea\u8eab\u7684Buffer\u7a7a\u95f4\u3002\u5982\u679c\u8bfb\u53d6\u6570\u636e\u7684\u884c\u4e3a\u6539\u53d8\u4e86\u5bf9\u5e94\u5730\u5740\u4e0a\u7684\u6570\u503c\uff08\u6216\u8005\u6709\u5176\u4ed6\u7684\u4ec0\u4e48\u526f\u4f5c\u7528\uff09\uff0c\u90a3\u4e48\u5c31\u5c06\u4f1a\u65e0\u6cd5\u6062\u590d\u88ab\u6e05\u9664\u7684\u6570\u636e\u4e86\u3002\u7136\u800c\u5bf9\u4e8e\u53ef\u9884\u53d6\u7a7a\u95f4\u6765\u8bf4\uff0c\u8bfb\u53d6\u884c\u4e3a\u5e76\u6ca1\u6709\u4efb\u4f55\u526f\u4f5c\u7528\uff0c\u56e0\u6b64\u5b83\u603b\u662f\u53ef\u4ee5\u56de\u9000\u5e76\u4e14\u5728\u7a0d\u540e\u4e5f\u80fd\u83b7\u5f97\u539f\u59cb\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u539f\u59cb\u7684\u6570\u636e\u4e00\u76f4\u90fd\u4e0d\u53d8\u7684\u5b58\u653e\u5728\u90a3\u91cc\u3002</p> <p>\u4f60\u4e5f\u8bb8\u4f1a\u60f3\u77e5\u9053\u4ec0\u4e48\u6837\u7684\u5185\u5b58\u7a7a\u95f4\u4f1a\u5b58\u5728\u8bfb\u53d6\u64cd\u4f5c\u7684\u526f\u4f5c\u7528\u3002\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u4e00\u4e2a\u5185\u5b58\u6620\u5c04\u7684\u72b6\u6001\u5bc4\u5b58\u5668\uff0c\u5b83\u88ab\u8bbe\u8ba1\u6210\u5728\u8bfb\u53d6\u65f6\u81ea\u52a8\u6e05\u9664\u81ea\u5df1\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u7a0b\u5e8f\u5458\u5728\u8bfb\u53d6\u8fd9\u4e2a\u72b6\u6001\u540e\u8fd8\u9700\u8981\u989d\u5916\u6b65\u9aa4\u6765\u6e05\u9664\u8fd9\u4e9b\u6bd4\u7279\u7684\u64cd\u4f5c\u3002</p> <p>\u505a\u8fd9\u79cd\u53ef\u9884\u53d6\u548c\u4e0d\u53ef\u9884\u53d6\u7684\u533a\u5206\uff0c\u5bf9\u4e8ePCI\u7684\u610f\u4e49\u8981\u5927\u4e8ePCIe\uff0c\u56e0\u4e3aPCI\u603b\u7ebf\u534f\u8bae\u4e2d\u7684\u4e8b\u52a1\u5e76\u6ca1\u6709\u5305\u542b\u4f20\u8f93\u91cf\u5927\u5c0f\u7684\u4fe1\u606f\u3002\u5982\u679c\u8bbe\u5907\u90fd\u5728\u540c\u4e00\u6761\u603b\u7ebf\u4e0a\u4ea4\u6362\u6570\u636e\uff0c\u90a3\u4e48\u6ca1\u6709\u4f20\u8f93\u91cf\u5927\u5c0f\u7684\u4fe1\u606f\u4e5f\u4e0d\u662f\u4ec0\u4e48\u95ee\u9898\uff0c\u56e0\u4e3a\u5728\u540c\u4e00\u603b\u7ebf\u4e0a\u4f1a\u6709\u5b9e\u65f6\u7684\u63e1\u624b\u4fe1\u53f7\u6765\u6307\u793aRequester\u4ec0\u4e48\u65f6\u5019\u6536\u5230\u4e86\u8db3\u591f\u7684\u6570\u636e\u5b8c\u6210\u4e86\u4e8b\u52a1\u3002\u4f46\u662f\u5982\u679c\u6570\u636e\u7684\u4f20\u8f93\u9700\u8981\u8de8\u8fc7\u4e00\u4e2aBridge\u6765\u5230\u53e6\u4e00\u6761\u603b\u7ebf\uff0c\u90a3\u4e48\u60c5\u51b5\u5c31\u4e0d\u50cf\u521a\u624d\u4e00\u6837\u7b80\u5355\u4e86\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8de8\u5230\u4e0d\u540c\u603b\u7ebf\u7684\u8bfb\u64cd\u4f5c\u6765\u8bf4\uff0cBridge\u5728\u6536\u96c6\u53e6\u4e00\u6761\u603b\u7ebf\u4e0a\u7684\u6570\u636e\u65f6\u9700\u8981\u53bb\u731c\u6d4b\u4f20\u8f93\u6570\u636e\u603b\u91cf\u3002\u5982\u679c\u731c\u9519\u4e86\u4f20\u8f93\u91cf\u7684\u5927\u5c0f\u5219\u4f1a\u589e\u52a0\u5ef6\u65f6\u800c\u964d\u4f4e\u6027\u80fd\uff0c\u56e0\u6b64\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u82e5\u62e5\u6709\u9884\u53d6\u7684\u6743\u9650\u5219\u5bf9\u63d0\u5347\u6027\u80fd\u4f1a\u6709\u4e0d\u5c0f\u7684\u5e2e\u52a9\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u5c06\u5185\u5b58\u7a7a\u95f4\u6307\u5b9a\u4e3a\u53ef\u9884\u53d6\u7684\u6982\u5ff5\u5728PCI\u4e2d\u5f88\u6709\u597d\u5904\u3002\u7531\u4e8ePCIe\u8bf7\u6c42\u4e2d\u5305\u542b\u4e86\u4f20\u8f93\u91cf\u5927\u5c0f\u7684\u4fe1\u606f\uff0c\u6240\u4ee5\u53ef\u9884\u53d6\u7a7a\u95f4\u5e76\u4e0d\u50cf\u4ee5\u524d\u5728PCI\u4e2d\u90a3\u6837\u5f15\u4eba\u5173\u6ce8\u4e86\uff0c\u4f46\u662f\u4e3a\u4e86\u5411\u540e\u517c\u5bb9\u6027\uff0cPCIe\u8fd8\u662f\u7ee7\u627f\u4e86\u8fd9\u79cd\u6982\u5ff5\u3002</p> <p></p> <p>\u56fe 4\u20111\u901a\u7528\u7684Memory\u4e0eIO\u7684\u5730\u5740\u6620\u5c04</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#42-barsbase-address-registers","title":"4.2 \u57fa\u5730\u5740\u5bc4\u5b58\u5668BARs\uff08Base Address Registers\uff09","text":""},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#421-general","title":"4.2.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u7684\u6bcf\u4e2a\u8bbe\u5907\u5bf9\u5730\u5740\u7a7a\u95f4\u7684\u6570\u91cf\u548c\u7c7b\u578b\u53ef\u80fd\u90fd\u6709\u4e0d\u540c\u7684\u8981\u6c42\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u8bbe\u5907\u53ef\u80fd\u6709256byte\u5927\u5c0f\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u9700\u8981\u901a\u8fc7IO\u5730\u5740\u7a7a\u95f4\u6765\u8bbf\u95ee\uff0c\u800c\u53e6\u4e00\u4e2a\u8bbe\u5907\u4e2d\u53ef\u80fd\u670916KB\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u9700\u8981\u901a\u8fc7MMIO\u6765\u8bbf\u95ee\u3002</p> <p>\u57fa\u4e8ePCI\u7684\u8bbe\u5907\u4e0d\u5141\u8bb8\u81ea\u5df1\u6765\u51b3\u5b9a\u54ea\u4e9b\u5730\u5740\u53ef\u4ee5\u7528\u6765\u8bbf\u95ee\u5b83\u4eec\u5185\u90e8\u7684\u4f4d\u7f6e\uff0c\u505a\u8fd9\u4e9b\u51b3\u5b9a\u662f\u7cfb\u7edf\u8f6f\u4ef6\u8d1f\u8d23\u7684\u5de5\u4f5c\uff08\u4f8b\u5982BIOS\u548c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff09\u3002\u56e0\u6b64\u8bbe\u5907\u5fc5\u987b\u4e3a\u7cfb\u7edf\u8f6f\u4ef6\u63d0\u4f9b\u4e00\u4e2a\u9014\u5f84\u7528\u6765\u786e\u5b9a\u8bbe\u5907\u5bf9\u5730\u5740\u7a7a\u95f4\u7684\u9700\u6c42\u3002\u4e00\u65e6\u8f6f\u4ef6\u77e5\u9053\u4e86\u8bbe\u5907\u5bf9\u5730\u5740\u7a7a\u95f4\u7684\u9700\u6c42\u662f\u4ec0\u4e48\u6837\u7684\uff0c\u5e76\u5047\u8bbe\u8fd9\u4e2a\u9700\u6c42\u662f\u53ef\u4ee5\u88ab\u6ee1\u8db3\u7684\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u7ed9\u5bf9\u5e94\u7684\u8bbe\u5907\u5206\u914d\u4e00\u6bb5\u53ef\u7528\u7684\u5730\u5740\u8303\u56f4\u548c\u76f8\u5e94\u7684\u5730\u5740\u7a7a\u95f4\u7c7b\u578b\uff08IO\u3001NP-MMIO\u3001P-MMIO\uff09\u3002</p> <p>\u8fd9\u4e9b\u90fd\u662f\u901a\u8fc7\u914d\u7f6e\u7a7a\u95f4Header\u4e2d\u7684\u57fa\u5730\u5740\u5bc4\u5b58\u5668BARs\uff08Base Address Registers\uff09\u6765\u5b8c\u6210\u7684\u3002\u5982\u56fe 4\u20112\u6240\u793a\uff0c\u4e00\u4e2aType 0 Header\u62e5\u67096\u4e2a\u53ef\u7528\u7684BAR\uff08\u6bcf\u4e2a\u5927\u5c0f\u4e3a32bit\uff09\uff0c\u800c\u4e00\u4e2aType 1 Header\u53ea\u62e5\u67092\u4e2aBAR\u3002Type 1 Header\u662f\u5b58\u5728\u4e8e\u6240\u6709Bridge\u8bbe\u5907\u4e2d\u7684\uff0c\u8fd9\u610f\u5473\u7740\u6bcf\u4e2aSwitch\u7aef\u53e3\u548cRC\u7aef\u53e3\u90fd\u4f1a\u62e5\u67091\u4e2aType 1 Header\u3002Type 0 Header\u53ea\u5b58\u5728\u4e8e\u975eBridge\u8bbe\u5907\u4e2d\uff0c\u4f8b\u5982EP\u3002\u5173\u4e8e\u8fd9\u91cc\u7684\u4e00\u4e2a\u4f8b\u5b50\u53ef\u4ee5\u53c2\u9605\u56fe 4\u20113\u3002</p> <p></p> <p>\u56fe 4\u20112\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684BARs</p> <p>\u7cfb\u7edf\u8f6f\u4ef6\u5fc5\u987b\u9996\u5148\u786e\u5b9a\u8bbe\u5907\u6240\u9700\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u77e5\u9053\u8bbe\u5907\u4e2d\u9700\u8981\u901a\u8fc7IO\u6216\u8005MMIO\u8bbf\u95ee\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u7684\u603b\u4f53\u5927\u5c0f\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u8fd8\u77e5\u9053\u5f53\u8fd9\u4e9b\u5bc4\u5b58\u5668\u88ab\u8bbf\u95ee\u65f6\u8bbe\u5907\u5c06\u4f1a\u5982\u4f55\u5de5\u4f5c\uff08\u4f8b\u5982\u8bfb\u53d6\u64cd\u4f5c\u662f\u5426\u6709\u526f\u4f5c\u7528\uff09\u3002\u8fd9\u5c06\u51b3\u5b9a\u8bbe\u5907\u6240\u9700\u8981\u7684\u662f\u53ef\u9884\u53d6MMIO\uff08\u8bfb\u53d6\u64cd\u4f5c\u65e0\u526f\u4f5c\u7528\uff09\u8fd8\u662f\u4e0d\u53ef\u9884\u53d6MMIO\uff08\u8bfb\u53d6\u64cd\u4f5c\u6709\u526f\u4f5c\u7528\uff09\u3002\u77e5\u9053\u4e86\u8fd9\u4e2a\u4fe1\u606f\u4e4b\u540e\uff0c\u8bbe\u5907\u8bbe\u8ba1\u8005\u5c06BARs\u7684\u4f4e\u4f4dbit\u56fa\u5b9a\u4e3a\u67d0\u4e2a\u503c\uff0c\u4ee5\u6b64\u6765\u6307\u793a\u9700\u8981\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002</p> <p>BARs\u7684\u9ad8\u4f4dbit\u662f\u8f6f\u4ef6\u53ef\u8fdb\u884c\u5199\u5165\u7684\u3002\u4e00\u65e6\u7cfb\u7edf\u8f6f\u4ef6\u901a\u8fc7\u68c0\u67e5BARs\u7684\u4f4e\u4f4dbit\u786e\u5b9a\u4e86\u8bbe\u5907\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\uff0c\u7cfb\u7edf\u8f6f\u4ef6\u5c31\u4f1a\u5c06\u5206\u914d\u7ed9\u8fd9\u4e2a\u8bbe\u5907\u7684\u5730\u5740\u8303\u56f4\u7684\u57fa\u5730\u5740\u5199\u5165BAR\u4e2d\u3002\u7531\u4e8e\u4e00\u4e2aEP\uff08\u4f7f\u7528Type 0 Header\uff09\u62e5\u67096\u4e2aBARs\uff0c\u5b83\u6700\u591a\u53ef\u4ee5\u8bf7\u6c426\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u7a7a\u95f4\u3002\u7136\u800c\uff0c\u4e00\u822c\u5b9e\u9645\u4e2d\u8bf7\u6c426\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u7a7a\u95f4\u5e76\u4e0d\u5e38\u89c1\u3002\u7edd\u5927\u591a\u6570\u8bbe\u5907\u4f1a\u8bf7\u6c421\u52303\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u8303\u56f4\u3002</p> <p>\u5e76\u4e0d\u662f\u6240\u6709\u7684BARs\u90fd\u9700\u8981\u88ab\u5b9e\u73b0\u3002\u5982\u679c\u4e00\u4e2a\u8bbe\u5907\u5e76\u4e0d\u9700\u8981\u4f7f\u7528\u6240\u6709\u7684BAR\u6765\u6620\u5c04\u81ea\u5df1\u7684\u5185\u90e8\u5bc4\u5b58\u5668\uff0c\u90a3\u4e48\u591a\u4f59\u7684BARs\u5c06\u4f1a\u88ab\u56fa\u5b9a\u4e3a\u51680\uff0c\u4ee5\u6b64\u6765\u901a\u77e5\u8f6f\u4ef6\u8fd9\u4e9bBARs\u5e76\u6ca1\u6709\u88ab\u5b9e\u73b0\u3002</p> <p>\u4e00\u65e6BARs\u88ab\u7f16\u7a0b\u5199\u5165\uff08programmed\uff09\uff0c\u8bbe\u5907\u5185\u7684\u5185\u90e8\u5bc4\u5b58\u5668\u6216\u8005\u672c\u5730\u5185\u5b58\uff08local memory\uff09\u5c31\u53ef\u4ee5\u901a\u8fc7BARs\u4e2d\u6240\u5199\u5165\u7684\u5730\u5740\u8303\u56f4\u8fdb\u884c\u8bbf\u95ee\u3002\u4efb\u4f55\u65f6\u5019\uff0c\u5f53\u8bbe\u5907\u53d1\u73b0\u4e00\u4e2a\u8bf7\u6c42\u4e8b\u52a1\u7684\u5730\u5740\u662f\u6620\u5c04\u5230\u81ea\u5df1\u7684\u4e00\u4e2aBAR\u65f6\uff0c\u5b83\u5c31\u4f1a\u63a5\u6536\u8fd9\u4e2a\u8bf7\u6c42\u4e8b\u52a1\uff0c\u56e0\u4e3a\u5b83\u81ea\u5df1\u5c31\u662f\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\u3002</p> <p></p> <p>\u56fe 4\u20113 PCIe\u8bbe\u5907\u4e2d\u5bf9Type 0\u3001Type 1 Header\u7684\u7528\u6cd5</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#422-bar132bit","title":"4.2.2     BAR\u793a\u4f8b1\u2014\u201432bit\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42","text":"<p>\u56fe 4\u20114\u5c55\u793a\u4e86\u8bbe\u7f6e\u5efa\u7acb\u4e00\u4e2aBAR\u7684\u57fa\u7840\u6b65\u9aa4\uff0c\u5728\u672c\u4f8b\u4e2d\uff0c\u8981\u8bf7\u6c42\u4e00\u4e2a4KB\u5927\u5c0f\u7684\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\uff08NP-MMIO\uff0cnon-prefetchable memory\uff09\u3002\u5728\u56fe\u4e2d\uff0c\u5c55\u793a\u4e86BAR\u5728\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u7684\u4e09\u4e2a\u8282\u70b9\uff1a</p> <p>\\1.    \u5728\u56fe 4\u20114\u4e2d\u7684\uff081\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230BAR\u5904\u4e8e\u672a\u521d\u59cb\u5316\u7684\u72b6\u6001\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u5df2\u7ecf\u5c06\u4f4e\u4f4dbit\u56fa\u5b9a\u4e3a\u4e00\u4e2a\u6570\u503c\uff0c\u6765\u6307\u793a\u9700\u8981\u7684memory\u7684\u5927\u5c0f\u548c\u7c7b\u578b\uff0c\u4f46\u662f\u9ad8\u4f4dbit\uff08\u53ef\u5199\u53ef\u8bfb\u7684\uff09\u5219\u4ecd\u7136\u662f\u7528X\u6765\u8868\u793a\uff0c\u8fd9\u4ee3\u8868\u5b83\u4eec\u7684\u503c\u8fd8\u672a\u77e5\u3002\u7cfb\u7edf\u8f6f\u4ef6\u5c06\u4f1a\u9996\u5148\u628a\u6bcf\u4e2aBAR\u90fd\u901a\u8fc7\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u53ef\u5199\u5165\u7684bit\u5199\u4e3a\u51681\uff08\u5f53\u7136\uff0c\u88ab\u56fa\u5b9a\u7684\u4f4e\u4f4dbit\u4e0d\u4f1a\u53d7\u5230\u914d\u7f6e\u5199\u64cd\u4f5c\u7684\u5f71\u54cd\uff09\u3002\u5728\u56fe 4\u20114\u7684\uff082\uff09\u4e2d\u5c55\u793a\u7684BAR\u5c31\u662f\u5904\u4e8e\u7b2c\u4e8c\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u9664\u4e86\u88ab\u56fa\u5b9a\u7684\u4f4e\u4f4dbit\u4ee5\u5916\uff0c\u6240\u6709\u7684bit\u90fd\u88ab\u5199\u4e3a1\u3002</p> <p>\u5199\u4e3a\u51681\u8fd9\u4e2a\u64cd\u4f5c\u662f\u4e3a\u4e86\u786e\u5b9a\u6700\u4f4e\u4f4d\u7684\u53ef\u5199\u5165\u7684bit\uff08least-significant writable bit\uff09\u662f\u54ea\u4e00\u4f4d\uff0c\u8fd9\u4e2abit\u7684\u4f4d\u7f6e\u6307\u793a\u4e86\u9700\u8981\u88ab\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6700\u4f4e\u4f4d\u7684\u53ef\u5199\u5165\u7684bit\u4e3abit 12\uff0c\u56e0\u6b64\u8fd9\u4e2aBAR\u9700\u8981\u8bf7\u6c422\u768412\u6b21\u65b9\uff08\u6216\u8005\u8bf4\u662f4KB\uff09\u7684\u5730\u5740\u7a7a\u95f4\u3002\u5982\u679c\u6700\u4f4e\u4f4d\u7684\u53ef\u5199\u5165\u7684bit\u4e3abit 20\uff0c\u90a3\u4e48\u8fd9\u4e2aBAR\u5c31\u8981\u8bf7\u6c422\u768420\u6b21\u65b9\uff081MB\uff09\u7684\u5730\u5740\u7a7a\u95f4\u3002</p> <p>\\2.    \u5728\u8f6f\u4ef6\u5c06BARs\u4e2d\u6240\u6709\u53ef\u5199bit\u90fd\u5199\u4e3a1\u540e\uff0c\u8f6f\u4ef6\u5c06\u4eceBAR0\u5f00\u59cb\uff0c\u4f9d\u6b21\u8bfb\u53d6\u6bcf\u4e2aBAR\u7684\u6570\u503c\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u5404\u4e2aBAR\u8981\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u8868 4\u20111\u4e2d\u603b\u7ed3\u4e86\u672c\u4f8b\u4e2d\u5bf9BAR0\u8fdb\u884c\u914d\u7f6e\u8bfb\u7684\u7ed3\u679c\u3002</p> <p>\\3.    \u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u7684\u6700\u540e\u4e00\u6b65\u5c31\u662f\u7cfb\u7edf\u8f6f\u4ef6\u4e3aBAR 0\u5206\u914d\u4e00\u4e2a\u5730\u5740\u8303\u56f4\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86BAR 0\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u56fe 4\u20114\u7684\uff083\uff09\u4e2d\u5c55\u793a\u4e86BAR\u5904\u4e8e\u7b2c\u4e09\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u6b64\u65f6\u7cfb\u7edf\u8f6f\u4ef6\u5df2\u7ecf\u5c06\u4e00\u5757\u5730\u5740\u533a\u57df\u7684\u8d77\u59cb\u5730\u5740\u5199\u5165\u4e86BAR 0\u4e2d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u8fd9\u4e2a\u8d77\u59cb\u5730\u5740\u4e3aF900_0000h\u3002</p> <p>\u5230\u8fd9\u91cc\u4e3a\u6b62\uff0c\u5bf9BAR 0\u7684\u914d\u7f6e\u5c31\u5b8c\u6210\u4e86\u3002\u4e00\u65e6\u8f6f\u4ef6\u542f\u7528\u4e86\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command register\uff0c\u504f\u79fb\u5730\u574004h\uff09\u4e2d\u7684\u5185\u5b58\u5730\u5740\u8bd1\u7801\uff08memory address decoding\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bbe\u5907\u5c31\u4f1a\u63a5\u53d7\u6240\u6709\u5730\u5740\u5728F900_0000h-F900_0FFFh\uff084KB\u5927\u5c0f\uff09\u8303\u56f4\u5185\u7684memory\u8bf7\u6c42\u3002</p> <p></p> <p>\u8868 4\u20111\u5bf9BAR 0\u5199\u5165\u51681\u540e\u518d\u8bfb\u53d6BAR 0\u65f6\u7684\u7ed3\u679c</p> <p></p> <p>\u56fe 4\u20114\u8bbe\u7f6e\u5efa\u7acb32bit\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7684BAR</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#423-bar264bit","title":"4.2.3     BAR\u793a\u4f8b2\u2014\u201464bit\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42","text":"<p>\u5728\u4e0a\u4e00\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u770b\u5230\u4e86\u901a\u8fc7BAR 0\u6765\u8bf7\u6c42\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08NP-MMIO\uff09\u3002\u5728\u5f53\u524d\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u56fe 4\u20115\u6240\u793a\uff0cBAR 1\u548cBAR 2\u88ab\u7528\u6765\u8bf7\u6c42\u4e00\u575764MB\u7684\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u3002\u8fd9\u91cc\u4f7f\u7528\u4e86\u4e24\u4e2a\u8fde\u7eed\u76f8\u8fde\u7684BAR\u662f\u56e0\u4e3a\u8fd9\u4e2a\u8bbe\u5907\u652f\u6301\u8fd9\u4e2a\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u7684\u8bf7\u6c42\u4f7f\u752864bit\u5730\u5740\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c\u8f6f\u4ef6\u7ed9\u5b83\u5206\u914d\u7684\u5730\u5740\u7a7a\u95f4\u53ef\u4ee5\u8d85\u8fc74GB\u5730\u5740\u8fb9\u754c\uff08\u5e76\u975e\u5fc5\u8981\uff09\u3002\u7531\u4e8e\u5730\u5740\u53ef\u4ee5\u662f64bit\u4f4d\u5bbd\uff0c\u56e0\u6b64\u5fc5\u987b\u5c06\u4e24\u4e2a\u8fde\u7eed\u76f8\u8fde\u7684BAR\u4e00\u8d77\u4f7f\u7528\u3002</p> <p>\u8ddf\u4e0a\u9762\u4e00\u6837\uff0c\u5c06BAR\u5728\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u5206\u4e3a3\u4e2a\u8282\u70b9\uff1a</p> <p>\\1.    \u5728\u56fe 4\u20115\u4e2d\u7684\uff081\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u5bf9BAR\u90fd\u5904\u4e8e\u672a\u521d\u59cb\u5316\u7684\u72b6\u6001\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u5df2\u7ecf\u5c06\u4f4e\u4f4dBAR\uff08\u5728\u672c\u4f8b\u4e2d\u4e3aBAR 1\uff09\u4e2d\u7684\u4f4e\u4f4dbit\u56fa\u5b9a\u4e3a\u4e00\u4e2a\u6570\u503c\uff0c\u6765\u6307\u793a\u9700\u8981\u7684memory\u7684\u5927\u5c0f\u548c\u7c7b\u578b\uff0c\u4f46\u662f\u9ad8\u4f4dBAR\uff08BAR 2\uff09\u4e2d\u7684bit\u5219\u90fd\u662f\u53ef\u8bfb\u53ef\u5199\u7684\uff0c\u6ca1\u6709\u88ab\u56fa\u5b9a\u3002\u7cfb\u7edf\u8f6f\u4ef6\u7684\u7b2c\u4e00\u6b65\u5c31\u662f\u628a\u6bcf\u4e2aBAR\u90fd\u901a\u8fc7\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u53ef\u5199\u5165\u7684bit\u5199\u4e3a\u51681\u3002\u5728\u56fe 4\u20115\u7684\uff082\uff09\u4e2d\u5c55\u793a\u7684BAR\u5c31\u662f\u5904\u4e8e\u7b2c\u4e8c\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u9664\u4e86BAR 1\u4e2d\u88ab\u56fa\u5b9a\u7684\u4f4e\u4f4dbit\u4ee5\u5916\uff0c\u6240\u6709\u7684bit\u90fd\u88ab\u5199\u4e3a1\u3002</p> <p>\\2.    \u5982\u4e0a\u4e00\u4e2a\u4f8b\u5b50\u6240\u8ff0\uff0c\u7cfb\u7edf\u8f6f\u4ef6\u5df2\u7ecf\u8bc4\u4f30\u8fc7BAR 0\u3002\u56e0\u6b64\u8f6f\u4ef6\u7684\u4e0b\u4e00\u6b65\u5c31\u662f\u8bfb\u53d6\u4e0b\u4e00\u4e2aBAR\uff08BAR 1\uff09\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u8bc4\u4f30\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u8bbe\u5907\u662f\u5426\u6b63\u5728\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\u3002\u4e00\u65e6BAR 1\u88ab\u8bfb\u53d6\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u53d1\u73b0\u8bbe\u5907\u6b63\u5728\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u5e76\u4e14\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7c7b\u578b\u4e3a\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08P-MMIO\uff09\uff0c\u8fd9\u4e2a\u5730\u5740\u7a7a\u95f4\u53ef\u4ee5\u88ab\u5206\u914d\u4e3a64bit\u5730\u5740\u8303\u56f4\u7684\u4efb\u4f55\u4e00\u4e2a\u4f4d\u7f6e\u3002\u7531\u4e8e\u8fd9\u4e2a\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42\u652f\u630164bit\u5730\u5740\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u8fde\u7eed\u76f8\u8fde\u7684BAR\uff08\u672c\u4f8b\u4e2d\u4e3aBAR 2\uff09\u5c31\u4f1a\u88ab\u5f53\u505a\u662fBAR 1\u7684\u9ad832bit\u3002\u56e0\u6b64\u8f6f\u4ef6\u4e5f\u4f1a\u8bfb\u53d6BAR 2\u7684\u5185\u5bb9\u3002\u7136\u800c\uff0c\u8f6f\u4ef6\u5e76\u4e0d\u4f1a\u5bf9BAR 2\u8fdb\u884c\u50cf\u5bf9BAR 1\u4e00\u6837\u7684\u4f4e\u4f4dbit\u7684\u8bc4\u4f30\uff0c\u56e0\u4e3a\u8f6f\u4ef6\u4ec5\u4ec5\u662f\u5c06BAR 2\u7b80\u5355\u7684\u5f53\u505aBAR 1\u53d1\u8d77\u768464bit\u5730\u5740\u8bf7\u6c42\u7684\u9ad832bit\u3002\u8868 4\u20112\u4e2d\u603b\u7ed3\u4e86\u672c\u4f8b\u4e2d\u5bf9\u4e24\u4e2aBAR\u90fd\u5199\u5165\u51681\u540e\u518d\u8fdb\u884c\u914d\u7f6e\u8bfb\u7684\u8bfb\u53d6\u7ed3\u679c\u3002</p> <p>\\3.    \u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u7684\u6700\u540e\u4e00\u6b65\u5c31\u662f\u7cfb\u7edf\u8f6f\u4ef6\u4e3a\u8fd9\u4e00\u5bf9BAR\u5206\u914d\u4e00\u4e2a\u5730\u5740\u8303\u56f4\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86\u8fd9\u4e00\u5bf9BAR\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u56fe 4\u20115\u7684\uff083\uff09\u4e2d\u5c55\u793a\u4e86\u8fd9\u4e24\u4e2aBAR\u5904\u4e8e\u7b2c\u4e09\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u8f6f\u4ef6\u5df2\u7ecf\u901a\u8fc7\u4e24\u6b21\u914d\u7f6e\u5199\u64cd\u4f5c\u5c06\u5206\u914d\u7684\u5730\u5740\u533a\u57df\u768464bit\u8d77\u59cb\u5730\u5740\u5199\u5165BAR 1\u4e0eBAR 2\u7684\u7ec4\u5408\u4f53\u4e2d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u9ad8\u4f4dBAR\u7684bit 1\uff08BAR pair\u7684bit 33\uff09\u88ab\u7f6e\u4e3a1\uff0c\u4f4e\u4f4dBAR\u7684bit 30\uff08\u4e5f\u662fBAR pair\u7684bit 30\uff09\u4e5f\u88ab\u7f6e\u4e3a1\uff0c\u8fd9\u8868\u793a\u5176\u5b9e\u5730\u5740\u4e3a2_4000_0000h\u3002\u4e24\u4e2aBAR\u4e2d\u6240\u6709\u5176\u4ed6\u7684\u53ef\u5199bit\u90fd\u5df2\u88ab\u6e05\u96f6\u3002</p> <p>\u5230\u8fd9\u91cc\u4e3a\u6b62\uff0cBAR Pair\uff08BAR 1\u548cBAR 2\uff09\u7684\u914d\u7f6e\u5c31\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002\u4e00\u65e6\u8f6f\u4ef6\u542f\u7528\u4e86\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command register\uff0c\u504f\u79fb\u5730\u574004h\uff09\u4e2d\u7684\u5185\u5b58\u5730\u5740\u8bd1\u7801\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bbe\u5907\u5c31\u4f1a\u63a5\u53d7\u6240\u6709\u5730\u5740\u57282_4000_0000h-2_4300_0000h\uff0864MB\u5927\u5c0f\uff09\u8fd9\u4e2a\u8303\u56f4\u5185\u7684memory\u8bf7\u6c42\u3002</p> <p></p> <p>\u56fe 4\u20115\u8bbe\u7f6e\u5efa\u7acb64bit\u53ef\u9884\u53d6\u5185\u5b58\u7684BAR</p> <p></p> <p>\u8868 4\u20112\u5c06\u4e24\u4e2aBAR\u90fd\u5199\u5165\u4e3a\u51681\u540e\u7684\u8bfb\u53d6\u7ed3\u679c</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#424-bar3io","title":"4.2.4     BAR\u793a\u4f8b3\u2014\u2014IO\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42","text":"<p>\u8ba9\u6211\u4eec\u5728\u524d\u9762\u4e24\u4e2a\u4f8b\u5b50\u7684\u57fa\u7840\u4e0a\u7ee7\u7eed\uff0c\u6211\u4eec\u5047\u8bbe\u5f53\u524d\u7684Function\u8fd8\u9700\u8981\u8bf7\u6c42IO\u7a7a\u95f4\uff0c\u5982\u56fe 4\u20116\u6240\u793a\u3002\u5728\u56fe\u4e2d\uff0c\u8fdb\u884c\u8bf7\u6c42\u7684BAR\uff08\u672c\u4f8b\u4e2d\u4e3aBAR 3\uff09\u5728\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u5206\u4e3a3\u4e2a\u8282\u70b9\uff1a</p> <p>\\1.    \u5728\u56fe 4\u20116\u4e2d\u7684\uff081\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230BAR 3\u5904\u4e8e\u672a\u521d\u59cb\u5316\u7684\u72b6\u6001\u3002\u7cfb\u7edf\u8f6f\u4ef6\u6b64\u524d\u5df2\u7ecf\u5c06\u6bcf\u4e00\u4e2aBAR\u90fd\u5199\u5165\u4e86\u51681\uff08\u5199\u5165BAR\u4e2d\u53ef\u5199\u7684bit\uff0c\u4e0d\u53ef\u5199\u7684\u4e0d\u53d7\u5f71\u54cd\uff09\uff0c\u5e76\u4e14\u5df2\u7ecf\u5bf9BAR 0\u3001BAR 1 BAR 2\u7ec4\u6210\u7684BAR Pair\u8fdb\u884c\u4e86\u8bc4\u4f30\u3002\u73b0\u5728\u8f6f\u4ef6\u8981\u7ee7\u7eed\u770b\u770b\u8bbe\u5907\u662f\u5426\u8fd8\u9700\u8981\u901a\u8fc7BAR 3\u6765\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\u3002\u56fe 4\u20116\u4e2d\u7684\u72b6\u6001\uff082\uff09\u5c55\u793a\u4e86BAR 3\u88ab\u5199\u5165\u51681\u540e\u7684\u6837\u5b50\u3002</p> <p>\\2.    \u8f6f\u4ef6\u73b0\u5728\u5c06\u4f1a\u8bfb\u53d6BAR 3\u7684\u5185\u5bb9\uff0c\u4ee5\u6b64\u6765\u8bc4\u4f30\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u8868 4\u20113\u4e2d\u603b\u7ed3\u4e86\u672c\u6b21\u914d\u7f6e\u8bfb\u7684\u8bfb\u53d6\u7ed3\u679c\u3002</p> <p>\\3.    \u8bfb\u53d6BAR 3\u7684\u5185\u5bb9\u4e4b\u540e\uff0c\u8f6f\u4ef6\u5c31\u77e5\u9053\u4e86\u8fd9\u4e2a\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42\u662f\u8981\u8bf7\u6c42256byte\u5927\u5c0f\u7684IO\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u8f6f\u4ef6\u7684\u6700\u540e\u4e00\u6b65\u64cd\u4f5c\u5c31\u662f\u8981\u4e3a\u8bbe\u5907\u5206\u914d\u4e00\u4e2aIO\u5730\u5740\u7a7a\u95f4\u8303\u56f4\uff0c\u5e76\u5c06\u8fd9\u4e2a\u5730\u5740\u8303\u56f4\u7684\u8d77\u59cb\u5730\u5740\u5199\u5165BAR 3\u3002\u56fe 4\u20116\u4e2d\u7684\u72b6\u6001\uff083\uff09\u6240\u5c55\u793a\u7684BAR 3\u5c31\u662f\u5b8c\u6210\u4e86\u5199\u5165\u8d77\u59cb\u5730\u5740\u7684\u6837\u5b50\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u8fd9\u4e2a\u8bbe\u5907\u7684\u8d77\u59cb\u5730\u5740\u4e3a16KB\uff0c\u6240\u4ee5bit 14\u662f\u88ab\u7f6e\u4e3a1\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u57fa\u5730\u5740\u4e3a4000h\uff0c\u6240\u6709\u7684\u9ad8\u4f4dbit\u90fd\u662f\u6e050\u7684\u3002</p> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5bf9BAR 3\u7684\u914d\u7f6e\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002\u4e00\u65e6\u8f6f\u4ef6\u542f\u7528\u4e86\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command register\uff0c\u504f\u79fb\u5730\u574004h\uff09\u4e2d\u7684IO\u5730\u5740\u8bd1\u7801\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bbe\u5907\u5c31\u4f1a\u63a5\u53d7\u5e76\u54cd\u5e94\u6240\u6709\u5730\u5740\u57284000h-40FFh\uff08256Byte\u5927\u5c0f\uff09\u8fd9\u4e2a\u8303\u56f4\u5185\u7684IO\u4e8b\u52a1\u3002</p> <p></p> <p>\u56fe 4\u20116 IO BAR\u7684\u8bbe\u7f6e\u5efa\u7acb</p> <p></p> <p>\u8868 4\u20113 IO BAR\u88ab\u5199\u5165\u51681\u540e\u518d\u8bfb\u53d6\u7684\u8bfb\u53d6\u7ed3\u679c</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#425-bars","title":"4.2.5     \u6240\u6709\u7684BARs\u90fd\u5fc5\u987b\u6309\u987a\u5e8f\u88ab\u8bc4\u4f30","text":"<p>\u5728\u8bb2\u89e3\u4e86\u524d\u9762\u7684\u4e09\u4e2a\u793a\u4f8b\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u660e\u663e\u7684\u53d1\u73b0\uff0c\u8f6f\u4ef6\u5fc5\u987b\u6309\u987a\u5e8f\u6765\u5bf9BARs\u8fdb\u884c\u8bc4\u4f30\uff0c\u5373BAR 0\u2014BAR 1\u2014BAR 2\u2014BAR 3\u8fd9\u6837\u7684\u987a\u5e8f\u3002</p> <p>\u5927\u591a\u6570\u65f6\u5019\uff0cFunction\u5e76\u4e0d\u9700\u8981\u542f\u7528\u5168\u90e8\u76846\u4e2aBAR\u3002\u5373\u4f7f\u662f\u5728\u6211\u4eec\u4e0a\u9762\u4e3e\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e5f\u4ec5\u4ec5\u662f\u4f7f\u7528\u4e866\u4e2aBAR\u4e2d\u76844\u4e2a\u3002\u5982\u679c\u4e0a\u9762\u4f8b\u5b50\u7684\u57fa\u7840\u4e0a\u5e76\u4e0d\u9700\u8981\u7ee7\u7eed\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u9700\u8981\u5c06BAR 4\u548cBAR 5\u7684\u6240\u6709bit\u90fd\u5f3a\u5236\u56fa\u5b9a\u4e3a\u51680\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u5373\u4f7f\u8f6f\u4ef6\u4e5f\u5bf9BAR 4\u548cBAR 5\u7528\u914d\u7f6e\u5199\u6765\u5199\u5165\u51681\uff0cBAR 4\u548cBAR 5\u7684\u503c\uff08\u51680\uff09\u4e5f\u4e0d\u4f1a\u53d7\u5230\u914d\u7f6e\u5199\u7684\u5f71\u54cd\u3002\u5728\u5bf9BAR 3\u8fdb\u884c\u5b8c\u8bc4\u4f30\uff08evaluate\uff09\u4e4b\u540e\uff0c\u8f6f\u4ef6\u9700\u8981\u7ee7\u7eed\u53bb\u8bc4\u4f30BAR 4\u3002\u4e00\u65e6\u8f6f\u4ef6\u68c0\u6d4b\u5230BAR 4\u4e2d\u6ca1\u6709bit\u88ab\u7f6e\u4e3a1\uff08\u56e0\u4e3aBAR 4\u7684\u6240\u6709bit\u90fd\u88ab\u5f3a\u5236\u56fa\u5b9a\u4e3a0\uff09\uff0c\u8f6f\u4ef6\u5c31\u77e5\u9053\u8fd9\u4e2aBAR\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u7136\u540e\u7ee7\u7eed\u53bb\u8bc4\u4f30\u4e0b\u4e00\u4e2aBAR\uff08\u4e5f\u5c31\u662fBAR 5\uff09\u3002</p> <p>\u5373\u4f7f\u8f6f\u4ef6\u53d1\u73b0\u4e86\u4e00\u4e2aBAR\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u6240\u6709\u7684BAR\u4e5f\u90fd\u5fc5\u987b\u88ab\u8bc4\u4f30\u3002\u5728PCI\u6216\u8005PCIe\u4e2d\uff0c\u5e76\u6ca1\u6709\u89c4\u5b9a\u8bf4\u4e00\u5b9a\u8981\u4ee5BAR 0\u6765\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7528\u6765\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u7684BAR\u3002\u5982\u679c\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u9700\u8981\u7684\u8bdd\uff0c\u4ed6\u4eec\u4e5f\u53ef\u4ee5\u9009\u62e9\u6bd4\u5982\u8bf4BAR 4\u6765\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u7684BAR\uff0c\u5e76\u5c06BAR 0\u3001BAR 1\u3001BAR 2\u3001BAR 3\u3001BAR 5\u7684\u6240\u6709bit\u90fd\u5f3a\u5236\u56fa\u5b9a\u4e3a0\u3002\u8fd9\u4e5f\u518d\u4e00\u6b21\u8bf4\u660e\u4e86\u8f6f\u4ef6\u5fc5\u987b\u6309\u7167\u987a\u5e8f\u5bf9Header\u4e2d\u7684\u6bcf\u4e00\u4e2aBAR\u90fd\u8fdb\u884c\u8bc4\u4f30\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#426-barsresizable-bars","title":"4.2.6     \u5927\u5c0f\u53ef\u53d8\u7684BARs\uff08Resizable BARs\uff09","text":"<p>\u5728PCIe\u534f\u8bae\u76842.1\u7248\u672c\u4e2d\u65b0\u52a0\u5165\u7684\u4e00\u4e2a\u7279\u6027\uff0c\u652f\u6301\u6539\u53d8BAR\u4e2d\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u8fd9\u79cd\u7279\u6027\u662f\u901a\u8fc7\u5728\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u5185\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u80fd\u529b\u7ed3\u6784\uff08Capability Structure\uff09\u6765\u5b9e\u73b0\u7684\u3002\u65b0\u7684Capability Structure\u4f7f\u5f97Function\u80fd\u591f\u516c\u5e03\uff08advertise\uff09\u5b83\u53ef\u4ee5\u64cd\u4f5c\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u7136\u540e\u8ba9\u8f6f\u4ef6\u6839\u636e\u5b9e\u9645\u53ef\u7528\u7684\u7cfb\u7edf\u8d44\u6e90\u6765\u9009\u7528Function\u6240\u516c\u5e03\u7684\u5730\u5740\u7a7a\u95f4\u5927\u5c0f\u4e2d\u7684\u67d0\u4e00\u79cd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aFunction\u7406\u60f3\u60c5\u51b5\u4e0b\u8981\u62e5\u67092GB\u7684\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08Prefetchable Memory Address Space\uff09\uff0c\u4f46\u662f\u5b83\u4e5f\u53ef\u4ee5\u53ea\u4f7f\u75281GB\u3001512MB\u6216\u8005256MB\u7684P-MMIO\u8fdb\u884c\u64cd\u4f5c\uff0c\u5047\u5982\u8bf4\u7cfb\u7edf\u8f6f\u4ef6\u65e0\u6cd5\u5bb9\u7eb3\u66f4\u5927\u7684\u3001\u5927\u4e8e256MB\u7684\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42\uff0c\u90a3\u4e48\u7cfb\u7edf\u8f6f\u4ef6\u5e94\u8be5\u5c31\u53ea\u80fd\u4f7fFunction\u8bf7\u6c42256MB\u7684\u5730\u5740\u7a7a\u95f4\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#43-baselimitbase-and-limit-registers","title":"4.3 Base\u5bc4\u5b58\u5668\u548cLimit\u5bc4\u5b58\u5668\uff08Base and Limit Registers\uff09","text":""},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#431-general","title":"4.3.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u4e00\u65e6\u4e00\u4e2aFunction\u7684BAR\u4eec\u90fd\u88ab\u7f16\u7a0b\u5199\u5165\u4e86\uff0c\u8fd9\u4e2aFunction\u5c31\u77e5\u9053\u81ea\u5df1\u6240\u62e5\u6709\u7684\u5730\u5740\u8303\u56f4\u4e86\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2aFunction\u5c06\u4f1a\u628a\u4efb\u4f55\u76ee\u7684\u5730\u5740\u5728\u8fd9\u4e00\u8303\u56f4\u5185\u7684\u4e8b\u52a1\u90fd\u58f0\u660e\u4e3a\u81ea\u5df1\u7684\uff0c\u8fd9\u4e2a\u5730\u5740\u8303\u56f4\u5c31\u662f\u88ab\u5199\u5165\u5b83\u7684\u67d0\u4e00\u4e2aBAR\u7684\u5730\u5740\u8303\u56f4\u3002\u8fd9\u672c\u8eab\u6ca1\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u662f\u66f4\u91cd\u8981\u7684\u662f\u8981\u8ba4\u8bc6\u5230\uff0cFunction\u8981\u201c\u770b\u5230\u201d\u5b83\u5e94\u8be5\u58f0\u660e\u7684\u4e8b\u52a1\u7684\u552f\u4e00\u529e\u6cd5\u662f\uff0c\u5b83\u4e0a\u65b9\u7684Bridge\u9700\u8981\u5c06\u8fd9\u4e9b\u4e8b\u52a1\u5411\u4e0b\u8f6c\u53d1\u5230\u8fd9\u4e2a\u76ee\u6807Function\u6240\u8fde\u63a5\u7684\u76f8\u5e94\u7684\u94fe\u8def\u3002\u56e0\u6b64\uff0c\u6bcf\u4e2aBridge\uff08\u4f8b\u5982Switch\u7684\u7aef\u53e3\u548cRC\u7aef\u53e3\uff09\u90fd\u9700\u8981\u77e5\u9053\u5b83\u4e0b\u65b9\u6240\u5b58\u5728\u7684\u53ef\u7528\u5730\u5740\u8303\u56f4\uff0c\u8fd9\u6837Bridge\u624d\u80fd\u786e\u5b9a\u54ea\u4e9b\u8bf7\u6c42\u9700\u8981\u4ece\u5b83\u7684\u4e3b\u63a5\u53e3\uff08Primary interface\uff0c\u5b83\u5728\u4e0a\u65b9\uff09\u88ab\u8f6c\u53d1\u5230\u5b83\u7684\u6b21\u7ea7\u63a5\u53e3\uff08Secondary interface\uff0c\u5b83\u5728\u4e0b\u65b9\uff09\u3002\u5982\u679c\u4e00\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u5730\u5740\u662f\u8fd9\u4e2aBridge\u4e0b\u65b9Function\u7684BAR\u4e2d\u7684\u5730\u5740\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bf7\u6c42\u5c31\u5e94\u8be5\u88ab\u8f6c\u53d1\u5230Bridge\u7684\u6b21\u7ea7\u63a5\u53e3\u3002</p> <p>\u5728Bridge\u7684Type 1 Header\u4e2d\u6709Base\u5bc4\u5b58\u5668\u548cLimit\u5bc4\u5b58\u5668\uff0c\u800cBridge\u4e0b\u65b9\u7684\u5730\u5740\u8303\u56f4\u5c06\u4f1a\u88ab\u7f16\u7a0b\u5199\u5165\u8fd9\u4e24\u79cd\u5bc4\u5b58\u5668\u3002\u5728\u6bcf\u4e2aType 1 Header\u4e2d\u53ef\u4ee5\u770b\u5230\u67093\u5957Base\u548cLimit\u5bc4\u5b58\u5668\u3002\u4e4b\u6240\u4ee5\u9700\u8981\u4e09\u5957\u662f\u56e0\u4e3a\u4e00\u4e2aBridge\u4e0b\u7684\u5730\u5740\u8303\u56f4\u53ef\u4ee5\u88ab\u5206\u6210\u4e09\u7c7b\uff1a</p> <p>n \u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\uff08P-MMIO\uff09</p> <p>n \u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\uff08NP-MMIO\uff09</p> <p>n IO\u7a7a\u95f4\uff08IO\uff09</p> <p>\u4e3a\u4e86\u89e3\u91ca\u8fd9\u4e9bBase\u548cLimit\u5bc4\u5b58\u5668\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u8ba9\u6211\u4eec\u5728\u4e0a\u4e00\u8282\u7684\u4f8b\u5b50\u4e0a\u7ee7\u7eed\u8fdb\u884c\u8bb2\u89e3\uff0c\u5e76\u5c06\u4e0a\u4e00\u8282\u4f8b\u5b50\u4e2d\u90a3\u4e2a\u5df2\u7ecf\u5b8c\u6210BAR\u914d\u7f6e\u7684EP\u653e\u5728\u4e00\u4e2aSwitch\u7684\u4e0b\u65b9\uff0c\u5982\u56fe 4\u20117\u6240\u793a\u3002\u56fe\u4e2d\u4e5f\u5217\u51fa\u4e86\u8fd9\u4e2aFunction\u4e2d\u5404\u4e2aBAR\u6240\u62e5\u6709\u7684\u5730\u5740\u8303\u56f4\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u4e0b\u65b9\u5b58\u5728EP\u7684Bridge\u6765\u8bf4\uff0c\u5b83\u7684Base\u548cLimit\u5bc4\u5b58\u5668\u90fd\u9700\u8981\u88ab\u7f16\u7a0b\u5199\u5165\uff0c\u4f46\u5728\u5f00\u59cb\u8fd9\u4e2a\u5199\u5165\u8fc7\u7a0b\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u5173\u6ce8\u4e00\u4e0b\u8fde\u63a5\u5230\u6211\u4eec\u793a\u4f8bEP\u7684Bridge\uff0c\u4e5f\u5c31\u662fSwitch\u7684Port B\u3002</p> <p></p> <p>\u56fe 4\u20117\u8bbe\u7f6e\u5efa\u7acbBase\u548cLimit\u5bc4\u5b58\u5668\u503c\u7684\u793a\u4f8b\u7684\u62d3\u6251</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#432-p-mmioprefetchable-range","title":"4.3.2     P-MMIO\u53ef\u9884\u53d6\u8303\u56f4\uff08Prefetchable Range\uff09","text":"<p>Type 1 Header\u6709\u4e24\u5bf9\u53ef\u9884\u53d6\u5185\u5b58base/limit\u5bc4\u5b58\u5668\u3002\u88ab\u79f0\u4e3aPrefetchable Memory Base/Limit\u7684\u5bc4\u5b58\u5668\u8981\u50a8\u5b58\u53ef\u9884\u53d6\u5730\u5740\u8303\u56f4\u7684\u4f4e32bit\u5730\u5740\u4fe1\u606f\u3002\u5982\u679c\u8fd9\u4e2aBridge\u652f\u6301\u5bf964bit\u5730\u5740\u8fdb\u884c\u8bd1\u7801\uff0c\u90a3\u4e48\u53e6\u4e00\u4e2a\u88ab\u79f0\u4e3aPrefetchable Memory Base/Limit Upper 32bits\u5bc4\u5b58\u5668\u5c31\u4e5f\u9700\u8981\u88ab\u542f\u7528\uff0c\u8981\u7528\u5b83\u6765\u50a8\u5b58\u5730\u5740\u8303\u56f4\u7684\u9ad832bit\uff0c\u4e5f\u5c31\u662fbit[63:32]\u3002\u56fe 4\u20118\u4e2d\u5c55\u793a\u4e86\u8f6f\u4ef6\u5e94\u8be5\u5199\u5165\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4ee5\u6b64\u6765\u6307\u793a\u8fd9\u4e2aBridge\uff08Switch\u7684Port B\uff09\u4e0b\u65b9\u7684\u53ef\u9884\u53d6\u5730\u5740\u8303\u56f4\u4e3a2_4000_0000h-2_43FF_FFFFh\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\u90fd\u88ab\u603b\u7ed3\u5728\u4e86\u8868 4\u20114\u4e2d\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20114\u4e2d\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <p>n Prefetchable Memory Base\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a4001h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit BASE\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Base\u5730\u5740\u4e2d\u7684\u4f4e20bit\u5168\u662f0\uff0c\u8fd9\u610f\u5473\u7740Base\u5730\u5740\u603b\u662f\u57281MB\u8fb9\u754c\u4e0a\u5bf9\u9f50\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u7528\u4e8e\u6307\u793aBridge\u4e2d\u662f\u5426\u652f\u630164bit\u5730\u5740\u8bd1\u7801\uff0c\u8fd94bit\u503c\u4e3a1\u5219\u610f\u5473\u7740Upper Base/Limit\u5bc4\u5b58\u5668\u8981\u88ab\u542f\u7528\u3002</p> <p>n Prefetchable Memory Limit\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a43F1h\u3002</p> <p>n \u7528\u6cd5\u4e0eBase\u5bc4\u5b58\u5668\u76f8\u4f3c\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit LIMIT\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Limit\u5730\u5740\u7684\u4f4e20bit\u4e3a\u51681\uff0816\u8fdb\u5236\u4e0b\u90fd\u662fF\uff09\u3002\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u548cbase\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u542b\u4e49\u76f8\u540c\u3002</p> <p>n Prefetchable Memory Base Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a00000002h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9\u53ef\u9884\u53d6\u5185\u5b58\u768464bit BASE\u5730\u5740\u7684\u9ad832bit\u3002</p> <p>n Prefetchable Memory Limit Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a00000002h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9\u53ef\u9884\u53d6\u5185\u5b58\u768464bit Limit\u5730\u5740\u7684\u9ad832bit\u3002</p> <p></p> <p>\u56fe 4\u20118\u793a\u4f8b\u4e2dPrefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u503c</p> <p></p> <p>\u8868 4\u20114\u793a\u4f8b\u4e2dPrefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u542b\u4e49</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#433-np-mmionon-prefetchable-range","title":"4.3.3     NP-MMIO\u4e0d\u53ef\u9884\u53d6\u8303\u56f4\uff08Non-Prefetchable Range\uff09","text":"<p>\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\u53ea\u652f\u630132bit\u5730\u5740\uff0c\u8fd9\u4e00\u70b9\u4e0d\u540c\u4e8e\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\u8303\u56f4\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\u6765\u8bf4\uff0c\u53ea\u67091\u4e2abase\u5bc4\u5b58\u5668\u548c1\u4e2alimit\u5bc4\u5b58\u5668\u3002\u6309\u7167\u56fe 4\u20117\u7684\u793a\u4f8b\uff0cPort B\u7684Bridge\u4e2d\u7684Non-Prefetchable Memory Base/Limit\u5bc4\u5b58\u5668\u5e94\u8be5\u88ab\u5199\u5165\u7684\u503c\u88ab\u5c55\u793a\u5728\u56fe 4\u20119\u4e2d\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\u90fd\u88ab\u603b\u7ed3\u5728\u4e86\u8868 4\u20115\u4e2d\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20115\u4e2d\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <p>n Non-Prefetchable Memory Base\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3aF900h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit BASE\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Base\u5730\u5740\u4e2d\u7684\u4f4e20bit\u5168\u662f0\uff0c\u8fd9\u610f\u5473\u7740Base\u5730\u5740\u603b\u662f\u57281MB\u8fb9\u754c\u4e0a\u5bf9\u9f50\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u5fc5\u987b\u8981\u4e3a0\u3002</p> <p>n Non-Prefetchable Memory Limit\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3aF900h\u3002</p> <p>n \u7528\u6cd5\u4e0eBase\u5bc4\u5b58\u5668\u76f8\u4f3c\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit LIMIT\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Limit\u5730\u5740\u7684\u4f4e20bit\u4e3a\u51681\uff0816\u8fdb\u5236\u4e0b\u90fd\u662fF\uff09\u3002\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u548cbase\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u542b\u4e49\u76f8\u540c\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u5fc5\u987b\u8981\u4e3a0\u3002</p> <p></p> <p>\u56fe 4\u20119\u793a\u4f8b\u4e2dNon-Prefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u503c</p> <p></p> <p>\u8868 4\u20115\u793a\u4f8b\u4e2dNon-Prefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u542b\u4e49</p> <p>\u8fd9\u4e2a\u4f8b\u5b50\u5c55\u793a\u4e86\u4e00\u4e2a\u5f88\u6709\u8da3\u7684\u60c5\u51b5\uff0c\u90a3\u5c31\u662f\u5b9e\u9645\u4e0aPort B\u4e0b\u65b9\u7684EP\u6240\u62e5\u6709\u7684NP-MMIO\u8303\u56f4\u5927\u5c0f\u4e3a4KB\uff0c\u4f46\u662fPort B\u7684\u914d\u7f6e\u7a7a\u95f4\u5374\u8868\u793a\u51fa\u4e861MB\u7684\u8303\u56f4\uff0c\u8fd9\u8fdc\u5927\u4e8e4KB\u3002\u8fd9\u662f\u56e0\u4e3aType 1 Header\u4e2d\u7684base/limit\u5bc4\u5b58\u5668\u53ea\u80fd\u7528\u6765\u8868\u793a\u5730\u5740\u7684[31:20]\u3002\u4f4e20bit\u4e5f\u5c31\u662f[19:0]\uff0c\u5219\u4f1a\u88ab\u9690\u53bb\u3002\u56e0\u6b64\u5185\u5b58\u7a7a\u95f4base/limit\u5bc4\u5b58\u5668\u6240\u80fd\u6807\u5fd7\u7684\u6700\u5c0f\u8303\u56f4\u5c31\u662f1MB\u3002</p> <p>\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0cEP\u8bf7\u6c42\u5e76\u88ab\u6388\u4e88\u4e864KB\u7684NP-MMIO\uff08F900_0000h-F900_0FFFh\uff09\u3002\u800cPort B\u4e2dNP-MMIO\u7684base/limit\u5bc4\u5b58\u5668\u88ab\u5199\u5165\u7684\u503c\u5219\u6307\u793a\u4e86\u8fd9\u4e2aPort\u4e0b\u5b58\u5728\u7684NP-MMIO\u5927\u5c0f\u4e3a1MB\uff08F900_0000h-F90F_FFFFh\uff09\uff0c\u6216\u8005\u8bf4\u662f1024KB\u3002\u8fd9\u610f\u5473\u7740\u67091020KB\u7684\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08F900_1000h-F90F_FFFFh\uff09\u88ab\u6d6a\u8d39\u4e86\u3002\u5373\u4f7f\u8fd9\u6837\uff0c\u8fd9\u4e9b\u88ab\u6d6a\u8d39\u7684\u5730\u5740\u7a7a\u95f4\u4e5f**\u4e00\u5b9a\u4e0d\u80fd**\u88ab\u5206\u914d\u7ed9\u5176\u4ed6\u7684EP\uff0c\u5426\u5219\u8fd9\u4f1a\u5bfc\u81f4\u5bf9\u6570\u636e\u5305\u7684\u8def\u7531\u673a\u5236\u65e0\u6cd5\u5de5\u4f5c\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#434-ioio-range","title":"4.3.4     IO\u8303\u56f4\uff08IO Range\uff09","text":"<p>\u7c7b\u4f3c\u4e8e\u53ef\u9884\u53d6\u5185\u5b58\u8303\u56f4\uff0cType 1 Header\u4e2dIO base/limit\u5bc4\u5b58\u5668\u4e5f\u6709\u4e24\u5bf9\u3002\u88ab\u79f0\u4e3aIO Base/Limit\u7684\u5bc4\u5b58\u5668\u7528\u4e8e\u5b58\u653eIO\u5730\u5740\u8303\u56f4\u7684\u4f4e16bit\u5730\u5740\u4fe1\u606f\u3002\u82e5\u8fd9\u4e2aBridge\u652f\u630132bit IO\u5730\u5740\u7684\u8bd1\u7801\u64cd\u4f5c\uff08\u73b0\u5b9e\u8bbe\u5907\u4e2d\u5f88\u5c11\u89c1\uff09\uff0c\u90a3\u4e48\u5c31\u8981\u542f\u7528IO Base/Limit Upper 16Bits\u5bc4\u5b58\u5668\u6765\u5b58\u653e\u5730\u5740\u4fe1\u606f\u7684\u9ad816bit\uff0c\u4e5f\u5c31\u662fIO\u5730\u5740\u8303\u56f4\u7684[31:16]\u3002\u6309\u7167\u6211\u4eec\u7684\u524d\u9762\u7684\u793a\u4f8b\uff0c\u5728\u56fe 4\u201110\u4e2d\u7ed9\u51fa\u4e86\u8f6f\u4ef6\u8981\u5199\u5165\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4ee5\u6b64\u6765\u8868\u793a\u8fd9\u4e2aBridge\uff08Port B\uff09\u4e4b\u4e0b\u5b58\u5728\u7684IO\u5730\u5740\u8303\u56f4\u4e3a4000h-4FFFh\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\u90fd\u88ab\u603b\u7ed3\u5728\u4e86\u8868 4\u20116\u4e2d\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20116\u4e2d\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <p>n IO Base\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a40h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c**\u5bc4\u5b58\u5668\u7684\u9ad84bit**\u7528\u6765\u5b58\u653e16bit BASE\u5730\u5740\u7684\u9ad84bit\uff0c\u4e5f\u5c31\u662f[15:12]\u3002Base\u5730\u5740\u4e2d\u7684\u4f4e12bit\u5168\u90e8\u88ab\u8bbe\u7f6e\u4e3a0\uff0c\u8fd9\u610f\u5473\u7740Base\u5730\u5740\u603b\u662f\u57284KB\u8fb9\u754c\u4e0a\u5bf9\u9f50\u3002</p> <p>**\u5bc4\u5b58\u5668\u7684\u4f4e4bit**\u7528\u4e8e\u6307\u793aBridge\u4e2d\u662f\u5426\u652f\u630132bit\u5730\u5740\u8bd1\u7801\uff0c\u8fd94bit\u503c\u4e3a1\u5219\u610f\u5473\u7740Upper Base/Limit\u5bc4\u5b58\u5668\u8981\u88ab\u542f\u7528\u3002</p> <p>n IO Limit\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a40h\u3002</p> <p>n \u7528\u6cd5\u4e0eBase\u5bc4\u5b58\u5668\u76f8\u4f3c\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u9ad84bit\u7528\u6765\u5b58\u653e16bit LIMIT\u5730\u5740\u7684\u9ad84bit\uff0c\u4e5f\u5c31\u662f[15:12]\u3002Limit\u5730\u5740\u7684\u4f4e12bit\u4e3a\u51681\uff0816\u8fdb\u5236\u4e0b\u90fd\u662fF\uff09\u3002\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u548cbase\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u542b\u4e49\u76f8\u540c\u3002</p> <p>n IO Base Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a0000h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9IO\u5730\u5740\u7a7a\u95f4\u768432bit BASE\u5730\u5740\u7684\u9ad816bit\u3002</p> <p>n IO Limit Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a0000h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9IO\u5730\u5740\u7a7a\u95f4\u768432bit Limit\u5730\u5740\u7684\u9ad816bit\u3002</p> <p></p> <p>\u56fe 4\u201110\u793a\u4f8b\u4e2dIO Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u503c</p> <p></p> <p>\u8868 4\u20116\u793a\u4f8b\u4e2dIO Base/Limit \u5bc4\u5b58\u5668\u7684\u542b\u4e49</p> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53c8\u770b\u5230\u4e86\u4e00\u79cd\u60c5\u51b5\uff0cBridge\u88ab\u7f16\u7a0b\u5199\u5165\u7684\u5730\u5740\u7a7a\u95f4\u8981\u8fdc\u5927\u4e8e\u5176\u4e0b\u65b9\u7684Function\u6240\u62e5\u6709\u7684\u7684\u5b9e\u9645IO\u5730\u5740\u7a7a\u95f4\u3002\u4f8b\u5b50\u4e2dEP\u62e5\u6709\u7684\u5730\u5740\u7a7a\u95f4\u4e3a256Byte\uff084000h-40FFh\uff09\u3002\u800cPort B\u88ab\u7f16\u7a0b\u5199\u5165\u7684\u503c\u5374\u8868\u793a\u5176\u4e0b\u65b9\u5b58\u5728\u7684IO\u5730\u5740\u7a7a\u95f4\u4e3a4KB\uff084000h-4FFFh\uff09\u3002\u540c\u524d\u9762\u8ba8\u8bbaMMIO\u65f6\u4e00\u6837\uff0c\u8fd9\u4e5f\u662fType 1 Header\u7684\u4e00\u79cd\u5c40\u9650\u3002\u5bf9\u4e8e\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u6765\u8bf4\uff0c\u4f4e12bit\uff08bit[11:0]\uff09\u7684\u503c\u662f\u88ab\u9690\u53bb\u7684\uff0c\u56e0\u6b64\u80fd\u88ab\u6307\u5b9a\u7684IO\u5730\u5740\u8303\u56f4\u7684\u6700\u5c0f\u503c\u5c31\u662f4KB\u3002\u8fd9\u79cd\u5c40\u9650\u6bd4\u5185\u5b58\u8303\u56f4\u4e2d\u76841MB\u6700\u5c0f\u7a97\u53e3\uff081MB minimum window\uff09\u8981\u66f4\u52a0\u4e25\u91cd\u3002\u5728\u57fa\u4e8ex86\uff08Intel\u517c\u5bb9\uff09\u7684\u7cfb\u7edf\u4e2d\uff0c\u5904\u7406\u5668\u4ec5\u652f\u630116bit\u7684IO\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u7531\u4e8eIO\u5730\u5740\u4fe1\u606f\u4ec5\u6709bit[15:12]\u662f\u53ef\u4ee5\u88ab\u6307\u5b9a\u5728Bridge\u4e2d\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u6700\u591a\u5c31\u53ea\u80fd\u670916\u4e2a\uff082^4\uff09\u4e0d\u540c\u7684IO\u5730\u5740\u8303\u56f4\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#435-baselimit","title":"4.3.5     \u672a\u88ab\u4f7f\u7528\u7684Base\u548cLimit\u5bc4\u5b58\u5668","text":"<p>\u5e76\u4e0d\u662f\u6bcf\u4e2aPCIe\u8bbe\u5907\u90fd\u4f1a\u4f7f\u7528\u5168\u90e8\u76843\u79cd\u5730\u5740\u7a7a\u95f4\uff08P-MMIO\u3001NP-MMIO\u3001IO\uff09\u3002\u5b9e\u9645\u4e0a\uff0cPCIe\u534f\u8bae\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528IO\u5730\u5740\u7a7a\u95f4\uff0c\u652f\u6301\u8fd9\u79cd\u64cd\u4f5c\u4ec5\u4ec5\u662f\u53d7\u4e00\u4e9b\u4f20\u7edf\u9057\u7559\u56e0\u7d20\u5f71\u54cd\uff0c\u5e76\u6709\u53ef\u80fd\u5728\u672a\u6765\u65b0\u7248\u672c\u7684\u534f\u8bae\u4e2d\u88ab\u5f03\u7528\u3002</p> <p>\u6211\u4eec\u6765\u5047\u8bbe\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e00\u4e2aEP\u4e2d\u5e76\u6ca1\u6709\u8bf7\u6c42\u4f7f\u7528\u6240\u6709\u76843\u79cd\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u6837\u7684\u8bbe\u5907\u4e0a\u65b9\u7684Bridge\u6765\u8bf4\uff0c\u5b83\u7684base\u548climit\u5bc4\u5b58\u5668\u5e94\u8be5\u88ab\u914d\u6210\u4ec0\u4e48\u503c\u5462\uff1f\u9996\u5148\uff0c\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u7b80\u5355\u5730\u5c31\u628a\u5b83\u4eec\u5199\u5165\u51680\uff0c\u56e0\u4e3a\u4f4e\u4f4d\u7684\u88ab\u9690\u53bb\u7684\u5730\u5740bit\u4f9d\u7136\u662f\u4e0d\u540c\u7684\uff08base\u4e2d\u4f4e\u4f4dbit\u8ba4\u4e3a\u51680\uff0climit\u4e2d\u4f4e\u4f4dbit\u8ba4\u4e3a\u5168F\uff09\uff0c\u8fd9\u4f9d\u7136\u4f1a\u8868\u793a\u51fa\u4e00\u4e2a\u6709\u6548\u7684\u5730\u5740\u8303\u56f4\u3002\u6240\u4ee5\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u60c5\u51b5\uff0c\u5c31\u5fc5\u987b\u4ee4base\u5bc4\u5b58\u5668\u4e2d\u7684\u5199\u5165\u503c\u5927\u4e8elimit\u5bc4\u5b58\u5668\u7684\u5199\u5165\u503c\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aEP\u5e76\u6ca1\u6709\u8bf7\u6c42IO\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u8fd9\u4e2aFunction\u4e0a\u65b9\u76f4\u63a5\u76f8\u8fde\u7684Bridge\u5c06\u4f1a\u628aIO Limit\u5bc4\u5b58\u5668\u5199\u4e3a00h\uff0c\u5c06IO Base\u5bc4\u5b58\u5668\u5199\u4e3aF0h\u3002\u7531\u4e8eBase\u5730\u5740\u5927\u4e8eLimit\u5730\u5740\uff0cBridge\u4f1a\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u65e0\u6548\u7684\u8bbe\u7f6e\uff0c\u5e76\u4ee5\u6b64\u6765\u8ba4\u5b9a\u5176\u4e0b\u65b9\u6ca1\u6709Function\u62e5\u6709IO\u5730\u5740\u7a7a\u95f4\u3002\uff08\u8fd9\u91cc\u539f\u4e66\u4e2d\u6709\u8bef\uff0c\u5199\u6210\u4e86\u5c06limit\u914d\u7f6e\u4e3a\u5927\u4e8ebase\uff0c\u8fd9\u4e2a\u9519\u8bef\u5728errata\u4e2d\u5df2\u7ecf\u5217\u51fa\uff09</p> <p>\u8fd9\u79cd\u4f7fbase\u548climit\u5bc4\u5b58\u5668\u65e0\u6548\u5316\u914d\u7f6e\u7684\u65b9\u6cd5\u5bf9\u4e8e\u6240\u6709\u76843\u79cdbase/limit\u5bc4\u5b58\u5668\u90fd\u662f\u53ef\u884c\u7684\uff0c\u800c\u4e0d\u53ea\u662f\u9488\u5bf9IO base/limit\u5bc4\u5b58\u5668\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#44-sanity-checkregisters-used-for-address-routing","title":"4.4 \u7406\u89e3\u68c0\u67e5\uff1a\u5bf9\u6240\u6709\u5730\u5740\u8def\u7531\u7684\u5bc4\u5b58\u5668\uff08Sanity Check\uff1aRegisters Used For Address Routing\uff09","text":"<p>\u4e3a\u4e86\u786e\u4fdd\u4f60\u5df2\u7ecf\u7406\u89e3\u4e86\u8bbe\u7f6e\u5efa\u7acbBARs\u548cBase/Limit\u5bc4\u5b58\u5668\u7684\u89c4\u5219\u548c\u65b9\u6cd5\uff0c\u8bf7\u4ed4\u7ec6\u67e5\u770b\u56fe 4\u201111\uff0c\u4ee5\u4fdd\u8bc1\u4f60\u5bf9\u5b83\u4eec\u7684\u6b63\u786e\u8ba4\u77e5\u3002\u6211\u4eec\u7b80\u5355\u7684\u5bf9\u793a\u4f8b\u7cfb\u7edf\u8fdb\u884c\u4e86\u6269\u5c55\uff0c\u5728Switch\u7684Port A\u4e0b\u65b9\u52a0\u5165\u4e86\u53e6\u4e00\u4e2aEP\u4ee5\u53ca\u5b83\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u3002\u8981\u8bb0\u5f97\uff0cType 1 Header\u4e2d\u4e5f\u542b\u67092\u4e2aBAR\uff0c\u5b83\u4eec\u4e5f\u53ef\u4ee5\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u3002\u800c\u4e00\u4e2aBridge\u7684Base/Limit\u5bc4\u5b58\u5668\u8868\u793a\u7684\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u5e76\u4e0d\u5305\u62ecBridge\u81ea\u8eab\u7684BAR\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u4e5f\u5c31\u662f\u8bf4Base/Limit\u5bc4\u5b58\u5668\u53ea\u8868\u793aBridge\u4e0b\u65b9\u5b58\u5728\u7684\u5730\u5740\u7a7a\u95f4\u3002</p> <p></p> <p>\u56fe 4\u201111\u6700\u7ec8\u7684\u5730\u5740\u8def\u7531\u793a\u4f8b\u5efa\u7acb</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#45-tlptlp-routing-basics","title":"4.5 TLP\u8def\u7531\u57fa\u7840\uff08TLP Routing Basics\uff09","text":"<p>\u5728\u524d\u51e0\u4e2a\u5c0f\u8282\u4e2d\u6240\u8bb2\u8ff0\u7684\u8bbe\u7f6e\u5efa\u7acbBARs\u548cBase/Limit\u5bc4\u5b58\u5668\u7684\u76ee\u7684\uff0c\u662f\u4e3a\u4e86\u786e\u4fdd\u6d41\u91cf\uff08traffic\uff09\u53ef\u4ee5\u88ab\u6b63\u786e\u7684\u8def\u7531\u5230\u5b83\u7684\u76ee\u7684Function\uff0c\u4e4b\u540e\u76ee\u7684Function\u5c31\u53ef\u4ee5\u770b\u89c1\u8fd9\u4e9b\u6d41\u91cf\u4e2d\u7684\u4e8b\u52a1\u5e76\u58f0\u660e\u5bf9\u8fd9\u4e9b\u4e8b\u52a1\u7684\u6240\u6709\u6743\u3002\u5728\u4f8b\u5982PCI\u7684\u8fd9\u79cd\u5171\u4eab\u603b\u7ebf\uff08Share-Bus\uff09\u7ed3\u6784\u4e2d\uff0c\u6240\u6709\u7684\u6d41\u91cf\u5bf9\u4e8e\u603b\u7ebf\u4e0a\u7684\u6bcf\u4e2a\u8bbe\u5907\u90fd\u662f\u53ef\u89c1\u7684\u3002\u53ea\u6709\u5f53\u6d41\u91cf\u7684\u76ee\u7684\u5730\u5728\u53e6\u4e00\u6761\u603b\u7ebf\uff0c\u4e5f\u5c31\u662f\u5fc5\u987b\u8de8\u8d8a\u4e00\u4e2aBridge\u65f6\uff0c\u624d\u4f1a\u5bf9\u8bf7\u6c42\u8fdb\u884c\u8def\u7531\u3002\u7531\u4e8ePCIe\u94fe\u8def\u662f\u70b9\u5bf9\u70b9\u7684\uff08point-to-point\uff09\uff0c\u90a3\u4e48\u5728\u8bbe\u5907\u95f4\u53d1\u9001\u4e8b\u52a1\u65f6\u5c31\u9700\u8981\u66f4\u591a\u7684\u8def\u7531\u64cd\u4f5c\u4e86\u3002</p> <p></p> <p>\u56fe 4\u201112\u591a\u7aef\u53e3\u7684PCIe\u8bbe\u5907\u6709\u8fdb\u884c\u8def\u7531\u7684\u804c\u8d23</p> <p>\u5982\u56fe 4\u201112\u6240\u5c55\u73b0\u7684\u8fd9\u6837\uff0c\u4e00\u4e2aPCIe\u62d3\u6251\u4f7f\u7528\u72ec\u7acb\u7684\u3001\u70b9\u5bf9\u70b9\u7684\u94fe\u8def\u6765\u5c06\u5404\u4e2a\u8bbe\u5907\u4e0e\u5b83\u4eec\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u90bb\u8bbe\u5907\uff08neighbors\uff09\u76f8\u8fde\u63a5\u3002\u5f53\u6d41\u91cf\u5230\u8fbe\u94fe\u8def\u63a5\u53e3\u7684\u5165\u7ad9\u7aef\uff08inbound side\uff0c\u6216\u79f0\u4e3aingress port\u5165\u53e3\u7aef\u53e3\uff09\uff0c\u8fd9\u4e2a\u7aef\u53e3\u5c06\u4f1a\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\uff0c\u7136\u540e\u505a\u51fa\u5982\u4e0b\u7684\u4e09\u4e2a\u51b3\u5b9a\u4e2d\u7684\u4e00\u4e2a\uff1a</p> <p>\\1.    \u63a5\u6536\u8fd9\u4e2a\u6d41\u91cf\u5e76\u5728\u81ea\u8eab\u5185\u90e8\u4f7f\u7528\u5b83\u3002</p> <p>\\2.    \u5c06\u8fd9\u4e2a\u6d41\u91cf\u8f6c\u53d1\u81f3\u76f8\u5e94\u7684\u51fa\u7ad9\uff08outbound\uff0c\u6216\u8005egress\u51fa\u53e3\uff09\u7aef\u53e3\u3002</p> <p>\\3.    \u62d2\u7edd\u8fd9\u4e2a\u6d41\u91cf\uff0c\u56e0\u4e3a\u5165\u53e3\u7aef\u53e3\u81ea\u8eab\u65e2\u4e0d\u662f\u8fd9\u4e2a\u6d41\u91cf\u7684\u9884\u671f\u7684\u76ee\u6807\uff0c\u4e5f\u4e0d\u662f\u4e00\u4e2a\u7528\u6765\u5bf9\u5b83\u8fdb\u884c\u8f6c\u53d1\u7684\u63a5\u53e3\u3002\uff08\u6ce8\u610f\uff0c\u8fd8\u5b58\u5728\u5176\u4ed6\u53ef\u80fd\u7684\u539f\u56e0\u5bfc\u81f4\u6d41\u91cf\u88ab\u62d2\u7edd\uff09</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#451-3recievers-check-for-three-types-of-traffic","title":"4.5.1     \u63a5\u6536\u5668\u68c0\u67e53\u79cd\u7c7b\u578b\u7684\u6d41\u91cf\uff08Recievers Check For Three Types of Traffic\uff09","text":"<p>\u5047\u8bbe\u4e00\u6761\u94fe\u8def\u5904\u4e8e\u5b8c\u5168\u53ef\u5de5\u4f5c\u72b6\u6001\uff0c\u90a3\u4e48\u6bcf\u4e2a\u8bbe\u5907\u7684\u63a5\u6536\u63a5\u53e3\uff08\u5165\u53e3\u7aef\u53e3ingress port\uff09\u5fc5\u987b\u5bf9\u5230\u8fbe\u7684\u4e09\u79cd\u94fe\u8def\u6d41\u91cf\u8fdb\u884c\u68c0\u6d4b\u548c\u8bc4\u4f30\uff1aOrdered Sets\uff08\u547d\u4ee4\u96c6\uff09\u3001DLLPs\uff08Data Link Layer Packets\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u4ee5\u53caTLPs\uff08Transaction Layer Packets\u4e8b\u52a1\u5c42\u5305\uff09\u3002Ordered Sets\u548cDLLPs\u5bf9\u4e8e\u94fe\u8def\u6765\u8bf4\u662f\u672c\u5730\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u4e0d\u7528\u88ab\u8def\u7531\u5230\u53e6\u4e00\u6761\u94fe\u8def\u3002TLP\u53ef\u4ee5\u5e76\u4e14\u4e5f\u6709\u53ef\u80fd\u9700\u8981\u88ab\u4ece\u4e00\u6761\u94fe\u8def\u642c\u79fb\u5230\u53e6\u4e00\u6761\u94fe\u8def\uff0c\u8fd9\u79cd\u64cd\u4f5c\u6240\u57fa\u4e8e\u7684\u8def\u7531\u4fe1\u606f\u5b58\u5728\u4e8e\u6570\u636e\u5305\u7684Header\u4e2d\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#452-routing-elements","title":"4.5.2     \u8def\u7531\u5143\u4ef6\uff08Routing Elements\uff09","text":"<p>\u5bf9\u4e8e\u50cfRC\u548cSwitch\u8fd9\u6837\u5177\u6709\u591a\u4e2a\u7aef\u53e3\u7684\u8bbe\u5907\u6765\u8bf4\uff0c\u5b83\u4eec\u53ef\u4ee5\u5728\u7aef\u53e3\u4e4b\u95f4\u8f6c\u53d1TLPs\uff0c\u5b83\u4eec\u6709\u65f6\u4e5f\u88ab\u79f0\u4f5cRouting Agent\uff08\u8def\u7531\u5a92\u4ecb\uff09\u6216\u662fRouting Element\uff08\u8def\u7531\u5143\u4ef6\uff09\u3002\u5b83\u4eec\u4f1a\u63a5\u53d7\u76ee\u6807\u4e3a\u81ea\u8eab\u5185\u90e8\u8d44\u6e90\u7684TLP\uff0c\u4e5f\u4f1a\u5c06TLP\u5728\u81ea\u8eab\u5165\u53e3\u7aef\u53e3\u548c\u51fa\u53e3\u7aef\u53e3\u4e4b\u95f4\u8fdb\u884c\u8f6c\u53d1\u3002</p> <p>\u6709\u8da3\u7684\u662f\uff0cSwitch\u9700\u8981\u652f\u6301Peer-to-Peer\u7684\u8def\u7531\uff0c\u4f46\u662f\u5bf9\u4e8eRC\u6765\u8bf4\u8fd9\u9879\u529f\u80fd\u662f\u53ef\u9009\u7684\u3002Peer-to-Peer\u6d41\u91cf\u901a\u5e38\u662f\u4e00\u4e2aEP\u5411\u53e6\u4e00\u4e2aEP\u53d1\u9001\u6570\u636e\u5305\u3002</p> <p>EP\u53ea\u6709\u4e00\u6761\u94fe\u8def\uff0c\u5e76\u4e14\u5b83\u6c38\u8fdc\u4e0d\u5e0c\u671b\u770b\u5230\u4e00\u4e2a\u76ee\u7684\u5730\u4e0d\u662f\u5b83\u81ea\u5df1\u7684\u6d41\u91cf\uff0c\u5bf9\u4e8e\u5b83\u6765\u8bf4\u53ea\u4f1a\u7b80\u5355\u5730\u63a5\u53d7\u6216\u8005\u62d2\u7edd\u8f93\u5165\u7684TLPs\uff0c\u800c\u4e0d\u4f1a\u8fdb\u884c\u8f6c\u53d1\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#453-tlpthree-methods-of-tlp-routing","title":"4.5.3     TLP\u8def\u7531\u7684\u4e09\u79cd\u65b9\u6cd5\uff08Three Methods of TLP Routing\uff09","text":""},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4531-general","title":"4.5.3.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>TLP\u53ef\u4ee5\u88ab\u57fa\u4e8e\u5730\u5740\u8def\u7531\uff08Memory\u6216IO\uff09\uff0c\u53ef\u4ee5\u88ab\u57fa\u4e8eID\u8def\u7531\uff08Bus\u2014Device\u2014Function\uff09\uff0c\u6216\u8005\u8fd8\u53ef\u4ee5\u88ab\u9690\u5f0f\u8def\u7531\uff08routed implicitly\uff09\u3002\u5177\u4f53\u4f7f\u7528\u7684\u8def\u7531\u529e\u6cd5\u8981\u6839\u636eTLP\u7c7b\u578b\u6765\u51b3\u5b9a\u3002\u8868 4\u20117\u603b\u7ed3\u4e86TLP\u7c7b\u578b\u548c\u8def\u7531\u65b9\u6cd5\u7684\u5bf9\u5e94\u5173\u7cfb\u3002</p> <p></p> <p>\u8868 4\u20117 PCIe TLP\u7c7b\u578b\u5bf9\u5e94\u7684\u8def\u7531\u65b9\u6cd5</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0cMessage\u662f\u552f\u4e00\u4e00\u79cd\u652f\u6301\u591a\u79cd\u8def\u7531\u65b9\u6cd5\u7684TLP\u7c7b\u578b\u3002PCIe\u534f\u8bae\u4e2d\u5b9a\u4e49\u7684\u5927\u591a\u6570message\u4f7f\u7528\u7684\u662f\u9690\u5f0f\u8def\u7531\uff0c\u7136\u800c\u7531\u5382\u5546\u5b9a\u4e49\u7684message\u5219\u6839\u636e\u9700\u8981\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5730\u5740\u8def\u7531\u6216\u8005ID\u8def\u7531\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4532-messagepurpose-of-implicit-routing-and-message","title":"4.5.3.2   \u9690\u5f0f\u8def\u7531\u548cMessage\u7684\u76ee\u7684\uff08Purpose of Implicit Routing and Message\uff09","text":"<p>\u5728\u9690\u5f0f\u8def\u7531\u4e2d\uff0c\u4e0d\u4f7f\u7528\u5730\u5740\u6216\u8005ID\u8fd9\u79cd\u8def\u7531\u4fe1\u606f\uff1b\u76f8\u53cd\uff0c\u8fd9\u4e2a\u6570\u636e\u5305\u662f\u6839\u636e\u5305\u5934\u4e2d\u7684\u4e00\u4e2a\u4ee3\u7801\uff08code\uff09\u6765\u8fdb\u884c\u8def\u7531\u7684\uff0c\u8fd9\u4e2a\u4ee3\u7801\u6307\u793a\u7684\u76ee\u7684\u5730\u662f\u62d3\u6251\u7ed3\u6784\u4e2d\u4e00\u4e2a\u5df2\u77e5\u7684\u4f4d\u7f6e\uff0c\u4f8b\u5982RC\u3002\u8fd9\u79cd\u65b9\u6cd5\u7b80\u5316\u4e86\u4f7f\u7528\u9690\u5f0f\u8def\u7531\u7684message\u8def\u7531\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#l-messagewhy-messages","title":"l \u4e3a\u4ec0\u4e48\u662fMessage\uff1f\uff08Why Messages\uff1f\uff09","text":"<p>Message\u4e8b\u52a1\u5728PCI\u548cPCI-X\u4e2d\u5e76\u6ca1\u6709\u88ab\u5b9a\u4e49\uff0c\u4f46\u662f\u5728PCIe\u4e2d\u88ab\u5f15\u5165\u3002\u52a0\u5165Message\u4f5c\u4e3a\u4e00\u79cd\u6570\u636e\u5305\u7c7b\u578b\u7684\u4e3b\u8981\u7684\u539f\u56e0\u662f\uff0c\u4e3a\u4e86\u7ee7\u7eed\u8fdb\u884cPCIe\u7684\u8bbe\u8ba1\u76ee\u6807\u4e4b\u4e00\uff0c\u4e5f\u5c31\u662f\u5927\u5e45\u5ea6\u5730\u51cf\u5c11\u4ee5\u524dPCI\u4e2d\u7684\u8fb9\u5e26\u4fe1\u53f7\uff08sideband signals\uff09\u7684\u4f7f\u7528\uff0c\u4f8b\u5982\u4e2d\u65adpins\u3001\u9519\u8befpins\u3001\u7535\u6e90\u7ba1\u7406\u4fe1\u53f7\u7b49\u7b49\u3002\u56e0\u6b64\uff0c\u5927\u591a\u6570\u7684\u8fb9\u5e26\u4fe1\u53f7\u90fd\u88ab\u5e26\u5185\uff08in-band\uff09\u6570\u636e\u5305\u6240\u66ff\u4ee3\uff0c\u8fd9\u4e9b\u6570\u636e\u5305\u7684\u5f62\u5f0f\u5c31\u662fMessage TLP\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#l-how-implicit-routing-helps","title":"l \u9690\u5f0f\u8def\u7531\u662f\u600e\u4e48\u63d0\u4f9b\u5e2e\u52a9\u7684\uff1f\uff08How Implicit Routing Helps\uff1f\uff09","text":"<p>\u8981\u4f7f\u7528\u5e26\u5185Message\u6765\u66ff\u4ee3\u8fb9\u5e26\u4fe1\u53f7\uff0c\u5c31\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u5c06\u8fd9\u4e9bMessage\u8def\u7531\u5230\u6b63\u786e\u7684\u6536\u4ef6\u65b9\uff08recipient\uff09\u90a3\u91cc\u53bb\uff0c\u800cMessage\u7684\u6536\u4ef6\u65b9\u4f4d\u4e8e\u4e00\u4e2a\u7531\u6570\u91cf\u4f17\u591a\u7684\u70b9\u5230\u70b9\u94fe\u8def\u7ec4\u6210\u7684\u62d3\u6251\u7ed3\u6784\u4e2d\u3002\u9690\u5f0f\u8def\u7531\u5229\u7528\u4e86\u8fd9\u6837\u4e00\u4e2a\u4e8b\u5b9e\uff1aSwitch\u548c\u5176\u4ed6\u7684\u8def\u7531\u5143\u4ef6\u662f\u53ef\u4ee5\u7406\u89e3\u4e0a\u884c\uff08upstream\uff09\u548c\u4e0b\u884c\uff08downstream\uff09\u7684\u6982\u5ff5\u7684\uff0c\u4e14RC\u662f\u4f4d\u4e8e\u6574\u4e2a\u62d3\u6251\u7ed3\u6784\u7684\u6700\u9876\u7aef\uff0c\u800cEP\u5219\u662f\u4f4d\u4e8e\u62d3\u6251\u7ed3\u6784\u7684\u5e95\u90e8\u3002\u56e0\u6b64\u4e3e\u4f8b\u6765\u8bf4\uff0c\u4e00\u4e2aMessage\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u4ee3\u7801\u6765\u8868\u793a\u5b83\u5e94\u8be5\u88ab\u9001\u5f80RC\uff0c\u6216\u8005\u662f\u8981\u88ab\u9001\u5f80\u4e0b\u884c\u7684\u6240\u6709\u8bbe\u5907\u3002\u4e0a\u8ff0\u7684\u8fd9\u79cd\u80fd\u529b\u80fd\u591f\u6709\u6548\u7684\u51cf\u5c11\u5bf9\u5b9a\u4e49\u5730\u5740\u8303\u56f4\u6216\u662fID\u5217\u8868\u7684\u9700\u8981\uff0c\u800c\u539f\u672c\u662f\u9700\u8981\u9488\u5bf9\u4e0d\u540c\u7684Message\u6765\u5b9a\u4e49\u7279\u5b9a\u7684\u5730\u5740\u8303\u56f4\u6216\u662fID\u5217\u8868\u624d\u80fd\u5b8c\u6210\u8def\u7531\u3002</p> <p>\u4e0d\u540c\u7c7b\u578b\u7684\u9690\u5f0f\u8def\u7531\u7684\u76f8\u5173\u5185\u5bb9\u53ef\u4ee5\u53c2\u9605\u201cImplicit Routing\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#454-split-transaction-protocol","title":"4.5.4     \u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff08Split Transaction Protocol\uff09","text":"<p>\u50cf\u5927\u591a\u6570\u5176\u4ed6\u4e32\u884c\u4f20\u8f93\u6280\u672f\u4e00\u6837\uff0cPCIe\u4f7f\u7528\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff08Split Transaction Protocol\uff09\uff0c\u5b83\u5141\u8bb8\u4e00\u4e2a\u76ee\u6807\u8bbe\u5907\u63a5\u6536\u4e00\u4e2a\u6216\u591a\u4e2a\u8bf7\u6c42\uff0c\u7136\u540e\u518d\u4f7f\u7528\u5355\u72ec\u7684\u5b8c\u6210\u5305\u6765\u5bf9\u8fd9\u4e9b\u8bf7\u6c42\u8fdb\u884c\u54cd\u5e94\u3002\u76f8\u6bd4\u4e8e\u5728PCI\u4e2d\u4f7f\u7528\u7b49\u5f85\u6001\uff08wait-state\uff09\u6216\u662f\u5ef6\u8fdf\u4f20\u8f93\uff08retry\uff09\u6765\u5904\u7406\u8bbf\u95ee\u76ee\u6807\u65f6\u51fa\u73b0\u7684\u5ef6\u8fdf\uff0c\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\u662f\u4e00\u79cd\u663e\u8457\u7684\u8fdb\u6b65\u3002\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\u4e0d\u518d\u4f7f\u7528\u901a\u8fc7\u8bd5\u63a2\u76ee\u6807\u662f\u5426\u5904\u4e8eready\u624d\u8fdb\u884c\u8bbf\u95ee\u7684\u9ad8\u5ef6\u8fdf\u4f20\u8f93\u673a\u5236\uff0c\u800c\u662f\u4f7f\u7528\u76ee\u6807\u8bbe\u5907\u81ea\u5df1\u53d1\u8d77\u54cd\u5e94\u7684\u65b9\u5f0f\uff0c\u65e0\u8bba\u4f55\u65f6\u53ea\u8981\u76ee\u6807\u8bbe\u5907\u5904\u4e8eready\uff0c\u5b83\u90fd\u80fd\u81ea\u5df1\u53d1\u8d77\u54cd\u5e94\uff0c\u800c\u8fd9\u4e2a\u54cd\u5e94\u6240\u5bf9\u5e94\u7684\u8bf7\u6c42\u662f\u6b64\u524d\u5c31\u5df2\u7ecf\u7ed9\u5230\u76ee\u6807\u8bbe\u5907\u7684\u4e86\u3002\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u5f97\u6bcf\u4e2a\u4e8b\u52a1\u7684\u5b8c\u6210\u90fd\u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u5355\u72ec\u7684TLP\u2014\u2014Request\uff08\u8bf7\u6c42\u5305\uff09\u548cCompletion\uff08\u5b8c\u6210\u5305\uff09\uff0c\u800c\u6211\u4eec\u540e\u9762\u5c06\u4f1a\u8bb2\u5230\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5355\u72ec\u7684\u8bfb\u8bf7\u6c42\uff0c\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u5b8c\u6210\u5305\u8fd4\u56de\u3002\u56fe 4\u201113\u5c55\u793a\u4e86\u4e00\u4e2a\u62c6\u5206\u4e8b\u52a1\u4e2d\u7684Request-Completion\u7684\u7ec4\u6210\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u7684\u573a\u666f\u662f\u8f6f\u4ef6\u4eceEP\u8bfb\u53d6\u6570\u636e\u3002</p> <p></p> <p>\u56fe 4\u201113 PCIe\u4e8b\u52a1\u4e2d\u7684\u8bf7\u6c42TLP\u548c\u5b8c\u6210TLP</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#455-postednon-posted","title":"4.5.5     Posted\u4e0eNon-Posted","text":"<p>\u4e3a\u4e86\u51cf\u5c11Request-Completion\u5ef6\u8fdf\u6240\u5e26\u6765\u7684\u5f00\u9500\u548c\u635f\u5931\uff0cMWr\uff08Memory Write\uff09\u4e8b\u52a1\u662fPosted\u7684\uff0c\u8fd9\u610f\u5473\u7740\u4eceRequester\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u5f53\u8fd9\u4e2aPosted\u4e8b\u52a1\u521a\u4eceRequester\u53d1\u51fa\u53bb\uff0c\u5c31\u8ba4\u4e3a\u5b83\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002\u5982\u679c\u60f3\u5e2e\u52a9\u7406\u89e3\uff0c\u53ef\u4ee5\u5c06\u672f\u8bed\u201cPosting\uff08\u90ae\u5bc4\uff09\u201d\u548c\u90ae\u653f\u7cfb\u7edf\uff08postal system\uff09\u8054\u7cfb\u5230\u4e00\u8d77\uff0c\u56e0\u4e3a\u201c\u90ae\u5bc4\u201d\u4e00\u4e2aMWr\u548c\u90ae\u5bc4\u4e00\u5c01\u4fe1\u5341\u5206\u76f8\u4f3c\u3002\u4e00\u65e6\u4f60\u5c06\u8981\u90ae\u5bc4\u7684\u4fe1\u653e\u5165\u90ae\u5c40\u90ae\u7bb1\uff0c\u4f60\u5c31\u4f1a\u76f8\u4fe1\u90ae\u653f\u7cfb\u7edf\u4f1a\u628a\u5b83\u9001\u51fa\u53bb\uff0c\u800c\u4e0d\u5fc5\u53bb\u7b49\u5f85\u6295\u9012\u7684\u786e\u8ba4\u3002\u8fd9\u79cd\u65b9\u6cd5\u6bd4\u7b49\u5f85\u6574\u4e2aRequest-Completion\u4f20\u8f93\u5b8c\u6210\u8981\u5feb\u7684\u591a\u3002\u4f46\u662f\uff0c\u5728\u6240\u6709\u7684\u90ae\u5bc4\u65b9\u6848\u4e2d\u90fd\u4f1a\u5b58\u5728\u4e0d\u786e\u5b9a\u6027\uff0c\u4e8b\u52a1\u662f\u5426\u3001\u4f55\u65f6\u5728\u6700\u7ec8\u7684\u63a5\u6536\u65b9\u88ab\u6210\u529f\u5b8c\u6210\uff0c\u8fd9\u662f\u4e0d\u786e\u5b9a\u7684\u3002</p> <p>\u5728PCIe\u4e2d\uff0c\u5c3d\u7ba1\u6240\u6709\u7684Posted MWr\u4f1a\u5e26\u6765\u4e0d\u786e\u5b9a\u6027\uff0c\u4f46\u662f\u76f8\u6bd4\u4e8e\u8fd9\u79cd\u65b9\u6cd5\u83b7\u5f97\u7684\u6536\u76ca\u6765\u8bf4\uff0c\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\u662f\u6bd4\u8f83\u5c11\u91cf\u4e14\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5bf9IO\u548c\u914d\u7f6e\u7a7a\u95f4\u7684\u5199\u64cd\u4f5c\u51e0\u4e4e\u90fd\u4f1a\u5f71\u54cd\u8bbe\u5907\u7684\u884c\u4e3a\uff0c\u4e14\u8fd9\u79cd\u5f71\u54cd\u8fd8\u662f\u5b9e\u65f6\u4e0e\u8fd9\u4e24\u79cd\u5199\u64cd\u4f5c\u76f8\u5173\u8054\u7684\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u8fd9\u6837\u7684\u5199\u8bf7\u6c42\u6765\u8bf4\uff0c\u975e\u5e38\u6709\u5fc5\u8981\u77e5\u9053\u5b83\u4eec\u662f\u5426\u5b8c\u6210\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u5b8c\u6210\u3002\u57fa\u4e8e\u8fd9\u6837\u7684\u539f\u56e0\uff0cIO\u5199\u548c\u914d\u7f6e\u5199\u5fc5\u987b\u8981\u662fNon-Posted\u7684\uff0c\u5b83\u4eec\u603b\u662f\u9700\u8981\u6536\u5230\u4e00\u4e2a\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u6765\u62a5\u544a\u81ea\u8eab\u64cd\u4f5c\u7684\u72b6\u6001\u3002</p> <p>\u603b\u7ed3\u6765\u8bf4\uff0cNon-Posted\u4e8b\u52a1\u9700\u8981\u5b8c\u6210\u5305\uff0cPosted\u4e8b\u52a1\u4e0d\u9700\u8981\u5b8c\u6210\u5305\u800c\u4e14\u4e5f\u6c38\u8fdc\u4e0d\u5e94\u8be5\u6536\u5230\u4e00\u4e2a\u5b8c\u6210\u5305\u3002\u8868 4\u20118\u5217\u51fa\u4e86\u54ea\u4e9bPCIe\u4e8b\u52a1\u662fPosted\u7684\uff0c\u54ea\u4e9b\u662fNon-Posted\u7684\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20118\u7684\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\uff1a</p> <p>n Memory Write\uff1a</p> <p>\u6240\u6709\u7684Memory Write\u8bf7\u6c42\u90fd\u662fPosted\u7684\u3002\u4e0d\u9700\u8981\u8fd4\u56de\u5b8c\u6210\u5305\uff08Completion\uff09\u3002</p> <p>n Memory Read**\u548c**Memory Read Lock\uff1a</p> <p>\u6240\u6709\u7684Memory Read\u8bf7\u6c42\u90fd\u662fNon-Posted\u7684\u3002\u9700\u8981\u7531Completer\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\uff08\u8fd9\u4e2aCompletion\u7531\u4e00\u4e2a\u6216\u591a\u4e2aTLP\u7ec4\u6210\uff09\uff0cCompleter\u901a\u8fc7Completion\u6765\u4f20\u9012Requester\u6240\u8bf7\u6c42\u7684\u6570\u636e\u4ee5\u53ca\u5f53\u524dMemory Read\u4e8b\u52a1\u7684\u72b6\u6001\u3002\u82e5\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u7528\u4e8e\u62a5\u544a\u9519\u8bef\u72b6\u6001\u7684Completion\u5c06\u4e0d\u542b\u6709\u6570\u636e\u3002</p> <p>n AtomicOP\uff1a</p> <p>\u6240\u6709\u7684AtomicOP\u8bf7\u6c42\u90fd\u662fNon-Posted\u7684\u3002\u9700\u8981\u7531Completer\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\uff0c\u8fd9\u4e2aCompletion\u4e2d\u5305\u542b\u4e86\u76ee\u6807\u4f4d\u7f6e\u7684\u539f\u59cb\u503c\u3002</p> <p>n IO Read**\u548c**IO Write\uff1a</p> <p>\u6240\u6709\u7684IO\u8bf7\u6c42\u90fd\u662fNon-Posted\u7684\u3002\u5bf9\u4e8eIO Write\u548c\u5931\u8d25\u7684Read\u6765\u8bf4\uff0c\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u4e0d\u542b\u6709\u6570\u636e\u7684Completion\u3002\u800c\u5bf9\u4e8e\u6210\u529f\u7684Read\u6765\u8bf4\uff0c\u5219\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\u3002</p> <p>n Configuration Read**\u548c**Configuration Write\uff1a</p> <p>\u6240\u6709\u7684Configuration\u8bf7\u6c42\u90fd\u662fNon-Posted\u7684\u3002\u4e0eIO\u8bf7\u6c42\u7c7b\u4f3c\uff0c\u5bf9\u4e8eConfiguration Write\u548c\u5931\u8d25\u7684Read\u6765\u8bf4\uff0c\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u4e0d\u542b\u6709\u6570\u636e\u7684Completion\u3002\u800c\u5bf9\u4e8e\u6210\u529f\u7684Read\u6765\u8bf4\uff0c\u5219\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\u3002</p> <p>n Message\uff1a</p> <p>\u6240\u6709\u7684Message\u8bf7\u6c42\u90fd\u662fPosted\u7684\u3002\u867d\u7136\u8def\u7531\u65b9\u6cd5\u662f\u53d6\u51b3\u4e8eMessage\u7c7b\u578b\u7684\uff0c\u4f46\u662fMessage\u90fd\u88ab\u8ba4\u4e3a\u662fposted\u8bf7\u6c42\u3002</p> <p>\u7b80\u5355\u603b\u7ed3\u6765\u8bf4\uff0c\u53ea\u6709Memory Write\u548cMessage\u662f Posted\u7684\u3002</p> <p></p> <p>\u8868 4\u20118 Posted\u548cNon-Posted\u4e8b\u52a1</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#456-header","title":"4.5.6     Header\u4e2d\u5b9a\u4e49\u6570\u636e\u5305\u683c\u5f0f\u548c\u7c7b\u578b\u7684\u5b57\u6bb5","text":""},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4561-general","title":"4.5.6.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5982\u56fe 4\u201114\u6240\u793a\uff0c\u6bcf\u4e2aTLP\u90fd\u542b\u6709\u4e00\u4e2a3\u4e2a\u62164\u4e2aDW\uff0812\u621616byte\uff09\u7684Header\u3002\u5728TLP Header\u4e2d\u542b\u6709Format\u548cType\u8fd9\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5b83\u4eec\u7528\u6765\u5b9a\u4e49\u5269\u4f59\u7684Header\u7684\u5185\u5bb9\uff0c\u5e76\u51b3\u5b9a\u8fd9\u4e2aTLP\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u4f20\u9012\u65f6\u6240\u4f7f\u7528\u7684\u8def\u7531\u65b9\u6cd5\u3002</p> <p></p> <p>\u56fe 4\u201114 TLP\u901a\u7528\u76843DW\u548c4DW Header</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4562-headerformattype","title":"4.5.6.2   Header\u4e2dFormat/Type\u5b57\u6bb5\u7684\u7f16\u7801\u542b\u4e49","text":"<p>\u4e0b\u65b9\u7684\u8868 4\u20119\u4e2d\u603b\u7ed3\u4e86TLP Header\u4e2d\u7684Format\u548cType\u5b57\u6bb5\u7684\u7f16\u7801\u542b\u4e49\u3002</p> <p></p> <p>\u8868 4\u20119 TLP Header\u4e2dFormat\u548cType\u5b57\u6bb5\u7f16\u7801\u542b\u4e49</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#457-tlp-header","title":"4.5.7     TLP Header\u6982\u8ff0","text":"<p>\u5f53TLP\u5728\u5165\u53e3\u7aef\u53e3\uff08ingress port\uff09\u88ab\u63a5\u6536\u5230\uff0c\u9996\u5148\u8981\u5728\u7269\u7406\u5c42\u548c\u6570\u636e\u94fe\u8def\u5c42\u5bf9TLP\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\u3002\u5982\u679c\u68c0\u67e5\u65e0\u9519\uff0c\u90a3\u4e48\u518d\u7531\u4e8b\u52a1\u5c42\u6765\u68c0\u67e5\u5f53\u524dTLP\u4f7f\u7528\u7684\u662f\u54ea\u79cd\u8def\u7531\u65b9\u6cd5\u3002\u57fa\u7840\u7684\u6b65\u9aa4\u4e3a\uff1a</p> <p>\\1.    Format\u548cType\u5b57\u6bb5\u786e\u5b9a\u4e86TLP Header\u7684\u5927\u5c0f\u3001\u6570\u636e\u5305\u7684\u683c\u5f0f\u548c\u7c7b\u578b\u3002</p> <p>\\2.    \u6839\u636eTLP\u6240\u4f7f\u7528\u7684\u8def\u7531\u65b9\u6cd5\uff08\u4e0eType\u76f8\u5173\uff09\uff0c\u8bbe\u5907\u5c06\u786e\u5b9a\u8fd9\u4e2aTLP\u7684\u9884\u671f\u63a5\u6536\u8005\u662f\u5426\u5c31\u662f\u81ea\u5df1\u3002\u5982\u679c\u786e\u5b9e\u5c31\u662f\u81ea\u5df1\uff0c\u90a3\u4e48\u8bbe\u5907\u5c06\u63a5\u53d7\uff08\u6216\u8005\u8bf4\u662f\u6d88\u8017\uff09\u8fd9\u4e2aTLP\uff0c\u5426\u5219\u8bbe\u5907\u5c06\u4f1a\u628a\u8fd9\u4e2aTLP\u8f6c\u53d1\u5230\u76f8\u5e94\u7684\u51fa\u53e3\u7aef\u53e3\uff08egress port\uff09\u2014\u2014\u6839\u636e\u8be5\u51fa\u53e3\u7684\u6392\u5e8f\u548c\u6d41\u63a7\u89c4\u5219\u3002</p> <p>\\3.    \u5982\u679c\u8bbe\u5907\u65e2\u4e0d\u662fTLP\u7684\u9884\u671f\u63a5\u6536\u65b9\uff0c\u4e14\u8bbe\u5907\u4e5f\u5e76\u4e0d\u4f4d\u4e8e\u524d\u5f80\u9884\u671f\u63a5\u6536\u65b9\u7684\u8def\u5f84\u4e0a\uff0c\u90a3\u4e48\u5b83\u901a\u5e38\u4f1a\u901a\u8fc7\u4e00\u4e2a\u72b6\u6001\u5b57\u6bb5\u4e3aUnsupported Request\uff08UR\uff09\u7684\u5b8c\u6210\u5305\u6765\u62d2\u7edd\u8fd9\u4e2aTLP\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#46-applying-routing-mechanisms","title":"4.6 \u8def\u7531\u673a\u5236\u7684\u5e94\u7528\u65b9\u6cd5\uff08Applying Routing Mechanisms\uff09","text":"<p>\u4e00\u65e6\u914d\u7f6e\u5b8c\u4e86\u7cfb\u7edf\u5730\u5740\u5e76\u4e14\u4e5f\u5141\u8bb8\u5f00\u59cb\u6267\u884c\u4e8b\u52a1\uff0c\u8bbe\u5907\u5c06\u4f1a\u68c0\u67e5\u8f93\u5165\u7684TLP\u5e76\u4f7f\u7528\u76f8\u5e94\u7684\u914d\u7f6e\u5b57\u6bb5\u57df\u6765\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u8def\u7531\u3002\u4e0b\u9762\u7684\u5c0f\u8282\u5c06\u4f1a\u5bf9PCIe\u7ed3\u6784\u4e2d\u7684TLP\u8def\u7531\u673a\u5236\u57fa\u7840\u7279\u70b9\u548c\u529f\u80fd\u8fdb\u884c\u63cf\u8ff0\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#461-idid-routing","title":"4.6.1     ID\u8def\u7531\uff08ID Routing\uff09","text":"<p>ID\u8def\u7531\u662f\u7528\u6765\u6307\u5411\u4e00\u4e2a\u903b\u8f91\u4f4d\u7f6e\u2014\u2014Bus Num\uff0cDevice Num\uff0cFunction Num\uff0c\u6216\u8005\u4e00\u822c\u79f0\u4e3aBDF\uff0c\u8fd9\u4e2a\u903b\u8f91\u4f4d\u7f6e\u4e00\u822c\u662f\u62d3\u6251\u7ed3\u6784\u4e2d\u7684\u4e00\u4e2aFunction\u3002ID\u8def\u7531\u8fd9\u79cd\u673a\u5236\u5bf9PCI\u548cPCI-X\u534f\u8bae\u4e2d\u7528\u4e8e\u914d\u7f6e\u4e8b\u52a1\u8def\u7531\u7684\u65b9\u6cd5\u662f\u517c\u5bb9\u7684\u3002\u5728PCIe\u4e2d\uff0cID\u8def\u7531\u4ecd\u7136\u4f1a\u88ab\u7528\u6765\u8def\u7531\u914d\u7f6e\u5305\uff0c\u540c\u65f6\u5b83\u8fd8\u53ef\u4ee5\u7528\u6765\u8def\u7531\u5b8c\u6210\u5305\u548c\u4e00\u4e9bMessage\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4611-busdevicefunction","title":"4.6.1.1   Bus\u53f7\uff0cDevice\u53f7\uff0cFunction\u53f7\u7684\u4f7f\u7528\u4e0a\u9650","text":"<p>PCIe\u652f\u6301\u7684\u62d3\u6251\u7ed3\u6784\u7684\u4e0a\u9650\u4e0ePCI\u548cPCI-X\u4e00\u6837\uff1a</p> <p>\\1.    \u4e00\u4e2a\u7cfb\u7edf\u4e2d\u53ef\u4ee5\u5b58\u5728\u7684\u6700\u5927\u603b\u7ebf\u6570\u91cf\u4e3a256\uff0c\u56e0\u4e3aBus\u53f7\u662f8bit\u4f4d\u5bbd\u7684\u3002\u8fd9\u4e2a\u603b\u7ebf\u6570\u91cf\u5305\u62ec\u4e86Switch\u4ea7\u751f\u7684\u5185\u90e8\u603b\u7ebf\u3002</p> <p>\\2.    \u6bcf\u6761\u603b\u7ebf\u4e0a\u6700\u591a\u53ef\u4ee5\u670932\u4e2a\u8bbe\u5907\uff0c\u56e0\u4e3aDevice\u53f7\u662f5bit\u4f4d\u5bbd\u7684\u3002\u4e00\u4e2a\u8001\u5f0f\u7684PCI\u603b\u7ebf\u6216\u662fSwitch\u3001RC\u7684\u5185\u90e8\u603b\u7ebf\u7684\u4e0b\u65b9\u53ef\u4ee5\u6302\u8f7d\u4e0d\u6b62\u4e00\u4e2a\u8bbe\u5907\uff0c\u7136\u800c\u5916\u90e8\u7684PCIe\u94fe\u8def\uff08external PCIe Links\uff09\u5c31\u5fc5\u987b\u8981\u662f\u70b9\u5230\u70b9\u7684\uff08point-to-point\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5916\u90e8PCIe\u94fe\u8def\u4e0b\u65b9\u53ea\u80fd\u6302\u8f7d\u4e00\u4e2a\u8bbe\u5907\u3002\u4e0b\u884c\u7aef\u53e3\uff08Switch\u6216RC\u7684\u4e0b\u884c\u7aef\u53e3\uff09\u4f1a\u5f3a\u5236\u5c06\u5916\u90e8\u94fe\u8def\u7684Device\u53f7\u5b9a\u4e3aDevice 0\uff0c\u56e0\u6b64\u6bcf\u4e2a\u5916\u90e8EP\u90fd\u603b\u4f1a\u662fDevice 0\u3002\u9664\u975e\u4f7f\u7528\u4e86\u66ff\u4ee3\u8def\u7531ID\u89e3\u91ca\uff08Alternative Routing-ID Interpretation\uff0cARI\uff09\uff0c\u82e5\u4f7f\u7528\u4e86ARI\u90a3\u4e48\u8fd9\u4e2a\u5916\u90e8Device\u5c06\u6ca1\u6709Device\u53f7\uff0c\u5173\u4e8eARI\u7684\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cIDO\uff08ID-based Ordering\uff09\u201d\u4e00\u8282\u3002</p> <p>\\3.    \u6bcf\u4e2a\u8bbe\u5907\u4e2d\u6700\u591a\u53ef\u4ee5\u67098\u4e2a\u5185\u90e8Function\uff0c\u56e0\u4e3aFunction\u53f7\u662f3bit\u4f4d\u5bbd\u7684\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4612-tlp-headerid","title":"4.6.1.2   TLP Header\u4e2d\u6709\u5173ID\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5","text":"<p>\u5982\u679c\u4e00\u4e2a\u6536\u5230\u7684TLP\u4e2d\u7684Type\u5b57\u6bb5\u8868\u793a\u4e86\u8fd9\u4e2aTLP\u8981\u4f7f\u7528ID\u8def\u7531\uff0c\u90a3\u4e48TLP Header\u4e2d\u7684ID\u5b57\u6bb5\uff08Bus\uff0cDevice\uff0cFunction\uff09\u5c31\u8981\u7528\u6765\u6267\u884c\u8def\u7531\u68c0\u67e5\uff08routing check\uff09\u3002\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\u4f7f\u75283DW Header\u6765\u8fdb\u884cID\u8def\u7531\uff0c\u6216\u8005\u4f7f\u75284DW Header\u6765\u8fdb\u884cID\u8def\u7531\uff08\u8fd9\u53ea\u53ef\u80fd\u51fa\u73b0\u5728Message\u8def\u7531\u4e2d\uff09\u3002\u56fe 4\u201115\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u7528\u4e8eID\u8def\u7531\u76843DW Header\uff0c\u56fe 4\u201116\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u7528\u4e8eID\u8def\u7531\u76844DW Header\u3002</p> <p></p> <p>\u56fe 4\u201115 3DW TLP Header\u4e2d\u7684ID\u8def\u7531\u5b57\u6bb5</p> <p></p> <p>\u56fe 4\u201116 4DW TLP Header\u4e2d\u7684ID\u8def\u7531\u5b57\u6bb5</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4613-ependpointone-check","title":"4.6.1.3   EP\u8fdb\u884c\u4e00\u6b21\u68c0\u67e5\uff08Endpoint\uff1aOne Check\uff09","text":"<p>\u5bf9\u4e8eID\u8def\u7531\uff0c\u4e00\u4e2aEP\u53ea\u4f1a\u7b80\u5355\u5730\u6839\u636e\u81ea\u5df1\u7684BDF\u6765\u68c0\u67e5TLP Header\u4e2d\u7684ID\u5b57\u6bb5\u3002\u6bcf\u5f53Function\u5728\u81ea\u5df1\u7684\u94fe\u8def\u4e0a\u63a5\u6536\u5230\u4e00\u4e2aType 0\u914d\u7f6e\u5199\u65f6\uff0cFunction\u5c06\u4f1a\u4ece\u914d\u7f6e\u5199\u4e8b\u52a1\u7684TLP Header\u7684byte8-9\u4e2d\u201c\u6355\u83b7\uff08Capture\uff09\u201d\u5230\u81ea\u5df1\u7684Bus\u53f7\u548cDevice\u53f7\u3002Function\u5fc5\u987b\u5c06Bus\u53f7\u548cDevice\u53f7\u5b58\u50a8\u4e0b\u6765\uff0c\u800c\u5177\u4f53\u662f\u5b58\u5728\u4ec0\u4e48\u5730\u65b9\uff0c\u534f\u8bae\u4e2d\u5e76\u6ca1\u6709\u7279\u522b\u6307\u5b9a\u3002\u4fdd\u5b58\u4e0b\u6765\u7684Bus\u548cDevice\u53f7\u88ab\u53ef\u4ee5\u88ab\u7528\u4f5cRequester ID\uff0c\u4f8b\u5982\u5f53\u8fd9\u4e2aEP\u53d1\u8d77\u8bf7\u6c42\u540e\uff0c\u8bf7\u6c42\u7684Completer\u53ef\u4ee5\u5c06\u8fd9\u4e2aRequester ID\u653e\u8fdb\u5b8c\u6210\u5305\u5185\u6765\u8ba9\u5b8c\u6210\u5305\u88ab\u987a\u5229\u8def\u7531\u8fd4\u56de\uff0cRequester ID\u5c31\u662f\u8fd9\u4e2a\u5b8c\u6210\u5305\u7528\u6765\u8def\u7531\u7684\u4fe1\u606f\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4614-switchesbridges","title":"4.6.1.4   Switches\uff08Bridges\uff09\u6bcf\u4e2a\u7aef\u53e3\u8fdb\u884c\u4e24\u6b21\u68c0\u67e5","text":"<p>\u56fe 4\u201117\u4e00\u4e2a\u4f7f\u7528ID\u8def\u7531\u7684\u5165\u7ad9TLP\u5728\u8fdb\u884cSwitch\u7684\u8def\u7531\u68c0\u67e5</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u4f7f\u7528ID\u8def\u7531\u7684TLP\u6765\u8bf4\uff0c\u4e00\u4e2aSwitch\u7aef\u53e3\u9996\u5148\u8981\u68c0\u67e5\u8fd9\u4e2aTLP\u7684\u9884\u671f\u76ee\u7684\u5730\u662f\u4e0d\u662f\u7aef\u53e3\u81ea\u8eab\uff0c\u8fd9\u79cd\u68c0\u67e5\u662f\u901a\u8fc7\u5c06\u7aef\u53e3\u81ea\u8eab\u7684BDF\u4e0eTLP Header\u4e2d\u7684\u76ee\u6807ID\u8fdb\u884c\u6bd4\u8f83\u6765\u8fdb\u884c\u7684\uff0c\u5982\u56fe 4\u201117\u4e2d\u7684\uff081\uff09\u6240\u793a\u3002\u4e0eEP\u4e00\u6837\uff0c\u6bcf\u4e2aSwitch\u7aef\u53e3\u5c06\u4f1a\u4ece\u4e0a\u884c\u7aef\u53e3\u53d1\u73b0\u7684\u6bcf\u6b21\u914d\u7f6e\u5199\uff08Type 0\uff09\u4e8b\u52a1\u4e2d\uff0c\u6355\u83b7\u5230\u81ea\u5df1\u7684Bus\u53f7\u548cDevice\u53f7\u3002\u5982\u679cTLP\u4e2d\u7684\u76ee\u6807ID\u4e0eSwitch\u7aef\u53e3\u7684ID\u76f8\u540c\uff0c\u90a3\u4e48Switch\u7aef\u53e3\u5c31\u4f1a\u6d88\u8017\u6389\uff08consume\uff09\u8fd9\u4e2aTLP\uff0c\u4e5f\u5c31\u662f\u4e0d\u518d\u8f6c\u53d1\u5230\u5176\u4ed6\u5730\u65b9\u800c\u662f\u81ea\u5df1\u4f7f\u7528\u3002\u5982\u679c\u8fd9\u4e24\u4e2aID\u5b57\u6bb5\u5e76\u4e0d\u76f8\u540c\uff0c\u90a3\u4e48Switch\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u4f4d\u7f6e\u662f\u5426\u5728\u81ea\u5df1\u7684\u4e0b\u65b9\u3002\u8fd9\u4e2a\u68c0\u67e5\u7684\u65b9\u5f0f\u662f\uff0c\u901a\u8fc7\u68c0\u67e5\u6b21\u7ea7\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Secondary Bus Number Register\uff09\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number Register\uff09\u6765\u67e5\u770bTLP\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u662f\u5426\u5728Switch\u7aef\u53e3\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff08\u5305\u62ec\u8303\u56f4\u8fb9\u754c\uff09\u3002\u5982\u679c\u5728\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u5c31\u5c06\u8fd9\u4e2aTLP\u5411\u4e0b\u8f6c\u53d1\u3002\u56fe 4\u201117\u4e2d\u7684\uff082\uff09\u6240\u8868\u793a\u7684\u5c31\u662f\u8fd9\u9879\u68c0\u67e5\u3002\u5982\u679c\u6570\u636e\u5305\u5230\u8fbeSwitch\u7684\u4e0a\u884c\u7aef\u53e3\uff0c\u4f46\u662f\u6ca1\u6709\u4e0e\u7aef\u53e3\u7684BDF\u76f8\u5339\u914d\uff0c\u4e14\u4e5f\u4e0d\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u88ab\u4f5c\u4e3a\u4e0a\u884c\u7aef\u53e3\u7684UR\uff08Unsupported Request\uff09\u6765\u5904\u7406\u3002</p> <p>\u5982\u679c\u4e0a\u884c\u7aef\u53e3\u786e\u5b9a\u4e86\u6240\u63a5\u6536\u5230\u7684TLP\u7684\u76ee\u7684\u5730\u662f\u5176\u4e0b\u65b9\u7684\u4e00\u4e2a\u8bbe\u5907\uff08\u4e5f\u5c31\u662f\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u603b\u7ebf\u5728\u4e0a\u884c\u7aef\u53e3\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff09\uff0c\u90a3\u4e48\u4e0a\u884c\u7aef\u53e3\u5c31\u4f1a\u5c06TLP\u5411\u4e0b\u8f6c\u53d1\uff0cSwitch\u6240\u6709\u7684\u4e0b\u884c\u7aef\u53e3\u90fd\u4f1a\u5bf9\u8fd9\u4e2aTLP\u505a\u8ddf\u4e0a\u9762\u4e00\u6837\u7684\u68c0\u67e5\u3002\u6bcf\u4e2a\u4e0b\u884c\u7aef\u53e3\u90fd\u4f1a\u68c0\u67e5\u81ea\u5df1\u662f\u4e0d\u662fTLP\u7684\u76ee\u7684\u5730\uff0c\u5982\u679c\u662f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7aef\u53e3\u5c06\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\u800c\u5176\u4ed6\u7aef\u53e3\u5c06\u4f1a\u5ffd\u7565\u8fd9\u4e2aTLP\u3002\u5982\u679cTLP\u7684\u76ee\u7684\u5730\u5e76\u4e0d\u662f\u4efb\u4f55\u4e00\u4e2a\u4e0b\u884c\u7aef\u53e3\uff0c\u90a3\u4e48\u4e0b\u884c\u7aef\u53e3\u4eec\u90fd\u4f1a\u518d\u53bb\u68c0\u67e5TLP\u7684\u76ee\u6807\u8bbe\u5907\u662f\u5426\u5728\u81ea\u5df1\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u4e2d\u3002\u5982\u679c\u6709\u4e00\u4e2a\u4e0b\u884c\u7aef\u53e3\u68c0\u67e5\u5230\u4e86\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u8bbe\u5907\u5728\u81ea\u5df1\u7684\u4e0b\u65b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7aef\u53e3\u5c31\u4f1a\u5c06TLP\u8f6c\u53d1\u81f3\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u4e14\u5176\u4ed6\u4e0b\u884c\u7aef\u53e3\u5c06\u4f1a\u5ffd\u7565\u8fd9\u4e2aTLP\u3002</p> <p>\u5728\u8fd9\u4e00\u8282\u4e2d\uff0c\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u662f\u8981\u8bb0\u4f4fSwitch\u4e2d\u7684\u6bcf\u4e00\u4e2a\u7aef\u53e3\uff08Port\uff09\u90fd\u662f\u4e00\u4e2aBridge\uff0c\u56e0\u6b64\u5b83\u4eec\u90fd\u6709\u81ea\u5df1\u7684\u914d\u7f6e\u7a7a\u95f4\uff0c\u5e76\u4e14\u5b83\u4eec\u7684\u914d\u7f6e\u7a7a\u95f4Header\u5fc5\u7136\u662fType 1 Header\u3002\u5c3d\u7ba1\u5728\u56fe4-17\u4e2d\u53ea\u5c55\u793a\u4e86\u4e0a\u884c\u7aef\u53e3\u7684Type 1 Header\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u7aef\u53e3\uff08\u6bcf\u4e2aP2P Bridge\uff09\u90fd\u6709\u81ea\u5df1\u7684Type 1 Header\uff0c\u5e76\u4e14\u5728\u6bcf\u4e2a\u7aef\u53e3\u6536\u5230TLP\u65f6\u90fd\u4f1a\u6267\u884c\u4e0a\u9762\u6240\u8ff0\u7684\u4e24\u6b21\u68c0\u67e5\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#462-address-routing","title":"4.6.2     \u5730\u5740\u8def\u7531\uff08Address Routing\uff09","text":"<p>\u4f7f\u7528\u5730\u5740\u8def\u7531\u7684TLP\u5f15\u7528\u7684\u5185\u5b58\uff08\u7cfb\u7edf\u5185\u5b58\u548c\u5185\u5b58\u6620\u5c04IO\uff09\u548cIO\u5730\u5740\u6620\u5c04\u548cPCI/PCI-X\u4e2d\u4e8b\u52a1\u5f15\u7528\u7684\u662f\u4e00\u6837\u7684\u3002\u5982\u679c\u4e00\u4e2aMemory\u8bf7\u6c42\u7684\u76ee\u6807\u5730\u5740\u5c0f\u4e8e4GB\uff08\u5373\u4e00\u4e2a32bit\u5730\u5740\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5fc5\u987b\u4f7f\u75283DW Header\u3002\u800c\u5982\u679c\u5b83\u7684\u76ee\u6807\u5730\u5740\u5927\u4e8e4GB\uff08\u5373\u4e00\u4e2a64bit\u5730\u5740\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c31\u5fc5\u987b\u4f7f\u75284DW Header\u3002IO\u8bf7\u6c42\u7684\u5730\u5740\u88ab\u9650\u5236\u4e3a32bit\uff0c\u5e76\u4e14\u4ec5\u5f53\u4e3a\u4e86\u652f\u6301\u4f20\u7edf\u7684\u65e7\u529f\u80fd\u65f6\u624d\u80fd\u88ab\u4f7f\u80fd\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4621-tlp-header","title":"4.6.2.1   TLP Header\u4e2d\u6709\u5173\u5730\u5740\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5","text":"<p>\u5f53TLP Header\u4e2d\u7684Type\u5b57\u6bb5\u8868\u793a\u8fd9\u4e2aTLP\u4f7f\u7528\u5730\u5740\u8def\u7531\u65f6\uff0c\u90a3\u4e48\u5c31\u8981\u7528Header\u4e2d\u7684Address\u5b57\u6bb5\u6765\u6267\u884c\u8def\u7531\u68c0\u67e5\u3002Address\u5b57\u6bb5\u53ef\u4ee5\u662f32bit\u4e5f\u53ef\u4ee5\u662f64bit\u7684\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#l-32bittlp","title":"l \u4f7f\u752832bit\u5730\u5740\u7684TLP","text":"<p>\u5bf9\u4e8eIO\u548c32bit\u7684Memory\u8bf7\u6c42\uff0c\u5b83\u4eec\u6240\u4f7f\u7528\u76843DW Header\u5982\u56fe 4\u201118\u6240\u793a\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9bTLP\u7684\u76ee\u6807\u5185\u5b58\u6620\u5c04\u5bc4\u5b58\u5668\uff08Memory-Mapped Registers\uff09\u4f1a\u5b58\u5728\u4e8e4GB\u5185\u5b58\u8fb9\u754c\u4ee5\u5185\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#l-64bittlp","title":"l \u4f7f\u752864bit\u5730\u5740\u7684TLP","text":"<p>\u5bf9\u4e8e64bit\u7684Memory\u8bf7\u6c42\uff0c\u5b83\u4eec\u6240\u4f7f\u7528\u76844DW Header\u5982\u56fe 4\u201119\u6240\u793a\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9bTLP\u7684\u76ee\u6807\u5185\u5b58\u6620\u5c04\u5bc4\u5b58\u5668\uff08Memory-Mapped Registers\uff09\u4f1a\u5b58\u5728\u4e8e4GB\u5185\u5b58\u8fb9\u754c\u4e4b\u4e0a\u3002</p> <p></p> <p>\u56fe 4\u201118 3DW TLP Header\u4e2d\u7684\u5730\u5740\u8def\u7531\u76f8\u5173\u5b57\u6bb5</p> <p></p> <p>\u56fe 4\u201119 4DW TLP Header\u4e2d\u7684\u5730\u5740\u8def\u7531\u76f8\u5173\u5b57\u6bb5</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4622-ep","title":"4.6.2.2   EP\u5bf9\u5730\u5740\u7684\u68c0\u67e5","text":"<p>\u5982\u679c\u4e00\u4e2aEP\u6536\u5230\u4e86\u4e00\u4e2a\u5730\u5740\u8def\u7531\u7684TLP\uff0c\u90a3\u4e48EP\u5c06\u4f1a\u7528\u5176\u81ea\u8eab\u914d\u7f6eHeader\u4e2d\u7684\u6bcf\u4e00\u4e2aBAR\uff08Base Address Register\u57fa\u5730\u5740\u5bc4\u5b58\u5668\uff09\u4e0eTLP Header\u4e2d\u7684Address\u5b57\u6bb5\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5982\u56fe 4\u201120\u6240\u793a\u3002\u7531\u4e8eEP\u53ea\u6709\u4e00\u4e2a\u94fe\u8def\u63a5\u53e3\uff0c\u56e0\u6b64\u5b83\u53ea\u4f1a\u63a5\u53d7\u6216\u8005\u62d2\u7edd\u6570\u636e\u5305\uff0c\u800c\u4e0d\u4f1a\u5bf9\u5176\u8fdb\u884c\u8f6c\u53d1\u3002\u5982\u679cTLP Header\u4e2d\u7684Address\u5b57\u6bb5\u4e0eEP\u7684\u67d0\u4e00\u4e2aBAR\u6240\u6307\u793a\u7684\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48EP\u5c31\u4f1a\u63a5\u53d7\u8fd9\u4e2aTLP\u3002\u66f4\u591a\u7684\u5173\u4e8eBARs\u662f\u600e\u4e48\u6837\u88ab\u4f7f\u7528\u7684\u5185\u5bb9\u8bf7\u53c2\u9605\u201c\u57fa\u5730\u5740\u5bc4\u5b58\u5668BARs\uff08Base Address Registers\uff09\u201d\u4e00\u8282\uff08\u539f\u4e66126\u9875\uff09\u3002</p> <p></p> <p>\u56fe 4\u201120 EP\u5bf9\u8f93\u5165TLP\u7684\u5730\u5740\u8fdb\u884c\u68c0\u67e5</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4623-switchswitch-routing","title":"4.6.2.3   Switch\u8fdb\u884c\u8def\u7531\uff08Switch Routing\uff09","text":"<p>\u5bf9\u4e8eSwitch\u7aef\u53e3\u6765\u8bf4\uff0c\u5982\u679c\u4e00\u4e2a\u8f93\u5165\u7684TLP\u4f7f\u7528\u7684\u662f\u5730\u5740\u8def\u7531\uff0c\u90a3\u4e48\u7aef\u53e3\u4f1a\u9996\u5148\u68c0\u67e5\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u5730\u5740\u662f\u5426\u5c31\u662f\u7aef\u53e3\u672c\u8eab\uff0c\u8fd9\u79cd\u68c0\u67e5\u662f\u901a\u8fc7\u5c06Switch\u7aef\u53e3\u81ea\u8eabType 1 Header\u4e2d\u7684\u4e24\u4e2aBAR\u4e0eTLP Header\u4e2d\u7684Address\u8fdb\u884c\u6bd4\u5bf9\u6765\u5b9e\u73b0\u7684\uff0c\u5982\u56fe 4\u201121\u4e2d\u7684\u6b65\u9aa41\u6240\u793a\u3002\u5982\u679cTLP Header\u4e2d\u7684Address\u5b57\u6bb5\u4e0e\u67d0\u4e2aBAR\u7684\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u8fd9\u4e2aSwitch\u7aef\u53e3\u5c31\u662fTLP\u7684\u76ee\u7684\uff0c\u7aef\u53e3\u5c06\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\u3002\u5982\u679c\u5e76\u672a\u5339\u914d\u4efb\u4f55\u4e00\u4e2aBAR\u7684\u5730\u5740\u8303\u56f4\uff0c\u90a3\u4e48Switch\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5Base/Limit\u5bc4\u5b58\u5668\u5bf9\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u8fd9\u4e2aTLP\u7684\u76ee\u6807Function\u662f\u5426\u5728\u672c\u7aef\u53e3\u4e4b\u4e0b\u3002\u5982\u679cRequest\u7684\u76ee\u6807\u662fIO\u7a7a\u95f4\uff0c\u90a3\u4e48\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5IO Base\u5bc4\u5b58\u5668\u548cIO Limit\u5bc4\u5b58\u5668\uff0c\u5982\u56fe 4\u201121\u4e2d\u6b65\u9aa42a\u6240\u793a\u3002\u800c\u5982\u679cRequest\u7684\u76ee\u6807\u662fMemory\u7a7a\u95f4\uff0c\u90a3\u4e48\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5\u4e0d\u53ef\u9884\u53d6Base/Limit\u5bc4\u5b58\u5668\u548c\u53ef\u9884\u53d6Base/Limit\u5bc4\u5b58\u5668\uff0c\u5982\u56fe 4\u201121\u4e2d\u6b65\u9aa42b\u6240\u793a\u3002\u66f4\u591a\u5173\u4e8eBase/Limit\u5bc4\u5b58\u5668\u5bf9\u662f\u5982\u4f55\u88ab\u8bc4\u4f30\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201cBase\u5bc4\u5b58\u5668\u548cLimit\u5bc4\u5b58\u5668\uff08Base and Limit Registers\uff09\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 4\u201121 Switch\u68c0\u67e5\u4f7f\u7528\u5730\u5740\u8def\u7531\u7684\u5165\u7ad9TLP\u7684\u8def\u7531\u4fe1\u606f</p> <p>\u4e3a\u4e86\u80fd\u7406\u89e3Switch\u4e2d\u57fa\u4e8e\u5730\u5740\u7684TLP\u8def\u7531\uff0c\u6700\u597d\u8981\u8bb0\u4f4f\u4e00\u70b9\uff0c\u6bcf\u4e2aSwitch\u7aef\u53e3\u81ea\u8eab\u90fd\u662f\u4e00\u4e2aBridge\u3002\u4e0b\u9762\u7684\u6b65\u9aa4\u63cf\u8ff0\u7684\u662f\u4e00\u4e2aBridge\uff08\u4e5f\u5c31\u662fSwitch\u7aef\u53e3\uff09\u63a5\u6536\u4e00\u4e2a\u57fa\u4e8e\u5730\u5740\u8def\u7531\u7684TLP\uff1a</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#l-tlpswitch","title":"l TLP\u5411\u4e0b\u884c\u79fb\u52a8\uff08\u7531Switch\u4e3b\u63a5\u53e3\u63a5\u6536\u5e76\u5411\u4e0b\u8f6c\u53d1\uff09","text":"<p>\\1.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u4e0eSwitch\u7aef\u53e3\u7684\u5176\u4e2d\u4e00\u4e2aBAR\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u8fd9\u4e2aBridge\uff08Switch\u7aef\u53e3\uff09\u5c31\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\uff0c\u56e0\u4e3a\u5176\u81ea\u8eab\u5c31\u662f\u8fd9\u4e2aTLP\u7684\u76ee\u7684\u5730\u3002</p> <p>\\2.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u843d\u5728\u7aef\u53e3\u7684Base/Limit\u5bc4\u5b58\u5668\u6240\u8868\u793a\u7684\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c31\u4f1a\u88ab\u8f6c\u53d1\u5230\u6b21\u7ea7\u63a5\u53e3\uff08Secondary Interface\uff09\uff0c\u4e5f\u5c31\u662f\u5411\u4e0b\u8f6c\u53d1\u3002</p> <p>\\3.    \u82e5\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\u90fd\u4e0d\u7b26\uff0c\u4e14\u4e3b\u63a5\u53e3\uff08Primary Interface\uff09\u4e0a\u6ca1\u6709\u5176\u4ed6\u7684Bridge\u58f0\u660e\u62e5\u6709\u8fd9\u4e2aTLP\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c06\u88abSwitch\u4e3b\u63a5\u53e3\u5f53\u505aUR\uff08Unsupported Request\uff09\u6765\u5904\u7406\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#l-tlp","title":"l TLP\u5411\u4e0a\u884c\u79fb\u52a8\uff08\u7531\u6b21\u7ea7\u63a5\u53e3\u63a5\u6536\u5e76\u5411\u4e0a\u8f6c\u53d1\uff09","text":"<p>\\1.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u4e0e\u5f53\u524dSwitch\u6b21\u7ea7\u63a5\u53e3\uff08Secondary Interface\uff09\u7684\u5176\u4e2d\u4e00\u4e2aBAR\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u8fd9\u4e2aBridge\uff08Switch\u7aef\u53e3\uff09\u5c31\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\uff0c\u56e0\u4e3a\u5176\u81ea\u8eab\u5c31\u662f\u8fd9\u4e2aTLP\u7684\u76ee\u7684\u5730\u3002</p> <p>\\2.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u843d\u5728\u7aef\u53e3\u7684Base/Limit\u5bc4\u5b58\u5668\u6240\u8868\u793a\u7684\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c06\u88abSwitch\u6b21\u7ea7\u63a5\u53e3\u5f53\u505aUR\uff08Unsupported Request\uff09\u6765\u5904\u7406\uff08\u9664\u975e\u8fd9\u4e2a\u7aef\u53e3\u662fSwitch\u7684\u4e0a\u884c\u7aef\u53e3\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u6570\u636e\u5305\u53ef\u80fd\u662f\u4e00\u4e2aPeer-to-Peer\u7684\u4e8b\u52a1\uff0c\u5b83\u5c06\u4f1a\u88ab\u8f6c\u53d1\u81f3\u4e0b\u884c\u7684\u53e6\u4e00\u4e2a\u7aef\u53e3\u4e0a\uff0c\u800c\u4e0d\u662f\u4e4b\u524d\u63a5\u6536\u8fd9\u4e2aTLP\u7684\u7aef\u53e3\uff09\u3002</p> <p>\\3.    \u82e5\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\u90fd\u4e0d\u7b26\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c06\u4f1a\u88ab\u8f6c\u53d1\u81f3\u4e3b\u63a5\u53e3\uff08\u4e0a\u884c\u7aef\u53e3\uff09\uff0c\u56e0\u4e3a\u8fd9\u4e2aTLP\u76ee\u7684\u5730\u65e2\u4e0d\u662f\u5f53\u524d\u7684\u7aef\u53e3Bridge\uff0c\u4e5f\u4e0d\u662f\u8fd9\u4e2aBridge\u4e4b\u4e0b\u7684\u4efb\u4f55\u4e00\u4e2aFunction\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4624-multicast-capabilities","title":"4.6.2.4   \u591a\u64ad\u80fd\u529b\uff08Multicast Capabilities\uff09","text":"<p>\u5728PCIe 2.1\u7248\u672c\u4e2d\uff0c\u65b0\u52a0\u5165\u4e86\u901a\u8fc7\u6307\u5b9a\u4e00\u4e2a\u5730\u5740\u8303\u56f4\u6765\u8fdb\u884c\u591a\u64ad\u7684\u80fd\u529b\u3002\u4efb\u4f55\u63a5\u6536\u5230\u7684TLP\uff0c\u53ea\u8981\u5176\u5730\u5740\u843d\u5728\u88ab\u6307\u5b9a\u4e3a\u591a\u64ad\u8303\u56f4\u7684\u5730\u5740\u8303\u56f4\u4e4b\u5185\uff0c\u5b83\u7684\u8def\u7531\u6216\u8005\u63a5\u53d7\uff08routed/accepted\uff09\u5c31\u8981\u6839\u636e\u591a\u64ad\u89c4\u5219\u6765\u5904\u7406\u3002\u867d\u7136\u8fd9\u4e2a\u591a\u64ad\u7684\u5730\u5740\u8303\u56f4\u4e0d\u4e00\u5b9a\u4f1a\u88ab\u4fdd\u7559\u5728\u4e00\u4e2aFunction\u7684BARs\u4e2d\uff0c\u4e5f\u4e0d\u4e00\u5b9a\u4f1a\u5b58\u5728\u4e8eBridge\u7684Base/Limit\u5bc4\u5b58\u5668\u5bf9\u4e2d\uff0c\u4f46\u662f\u5b83\u4e5f\u9700\u8981\u901a\u8fc7\u5408\u9002\u7684\u65b9\u5f0f\u88ab\u63a5\u53d7\u6216\u8f6c\u53d1\u3002\u66f4\u591a\u7684\u5173\u4e8e\u591a\u64ad\u529f\u80fd\u7684\u4fe1\u606f\u8bf7\u53c2\u9605\u201cMulticast Capability Register\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#463-implicit-routing","title":"4.6.3     \u9690\u5f0f\u8def\u7531\uff08Implicit Routing\uff09","text":"<p>\u9690\u5f0f\u8def\u7531\u901a\u5e38\u88ab\u4e00\u4e9bMessage\u6570\u636e\u5305\u6240\u4f7f\u7528\uff0c\u5b83\u662f\u57fa\u4e8e\u8def\u7531\u5143\u4ef6\u7684\u611f\u77e5\u80fd\u529b\uff0c\u5373\u8def\u7531\u5143\u4ef6\u77e5\u9053\u62d3\u6251\u7ed3\u6784\u5177\u6709\u4e0a\u884c\u548c\u4e0b\u884c\u65b9\u5411\uff0c\u5e76\u4e14\u62d3\u6251\u7684\u6700\u9876\u90e8\u662fRC\u3002\u8fd9\u4f7f\u5f97\u4e00\u4e9b\u7b80\u5355\u7684\u8def\u7531\u65b9\u6cd5\u53ef\u4ee5\u4e0d\u9700\u8981\u53bb\u5206\u914d\u76ee\u6807\u5730\u5740\u6216\u662fID\u5c31\u80fd\u8fdb\u884c\u8def\u7531\u3002\u7531\u4e8eRC\u4e00\u822c\u90fd\u96c6\u6210\u4e86\u7535\u6e90\u7ba1\u7406\uff08power management\uff09\u3001\u4e2d\u65ad\uff08interrupt\uff09\u548c\u9519\u8bef\u5904\u7406\u903b\u8f91\uff08error handling logic\uff09\uff0c\u8fd9\u4f7f\u5f97RC\u57fa\u672c\u4e0a\u662f\u5927\u591a\u6570PCIe Message\u7684\u53d1\u9001\u8005\u6216\u8005\u63a5\u6536\u8005\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4631-messageonly-for-messages","title":"4.6.3.1   \u4ec5\u4e3aMessage\u6240\u4f7f\u7528\uff08Only for Messages\uff09","text":"<p>\u6709\u4e9bMessages\u4f7f\u7528\u5730\u5740\u6216\u8005ID\u8def\u7531\uff0c\u800c\u4e0d\u662f\u9690\u5f0f\u8def\u7531\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u4e9bMessage\u6765\u8bf4\uff0c\u5b83\u4eec\u7684\u8def\u7531\u673a\u5236\u5c31\u8ddf\u524d\u9762\u51e0\u8282\u63cf\u8ff0\u7684ID\u8def\u7531\u548c\u5730\u5740\u8def\u7531\u76f8\u540c\u3002\u7136\u800c\uff0c\u5bf9\u4e8e\u7edd\u5927\u591a\u6570Message\u6765\u8bf4\uff0c\u4f7f\u7528\u7684\u8def\u7531\u673a\u5236\u662f\u9690\u5f0f\u8def\u7531\u3002\u9690\u5f0f\u8def\u7531\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u6a21\u4eff\u8fb9\u5e26\u4fe1\u53f7\uff08side-band signal\uff09\u7684\u884c\u4e3a\uff0c\u4e4b\u6240\u4ee5\u8981\u8fd9\u6837\u662f\u56e0\u4e3aPCIe\u7684\u8bbe\u8ba1\u76ee\u6807\u4e4b\u4e00\u5c31\u662f\u8981\u5c3d\u53ef\u80fd\u7684\u628a\u539f\u672cPCI\u4e2d\u7684\u8fb9\u5e26\u4fe1\u53f7\u90fd\u6e05\u9664\u5e72\u51c0\u3002PCI\u4e2d\u7684\u8fd9\u4e9b\u8fb9\u5e26\u4fe1\u53f7\u4e00\u822c\u662f\u7528\u4e8eHost\u5c06\u4e00\u4e2a\u4e8b\u4ef6\u901a\u77e5\u7ed9\u6240\u6709\u7684\u8bbe\u5907\uff0c\u6216\u8005\u662f\u8bbe\u5907\u5c06\u4e00\u4e2a\u4e8b\u4ef6\u901a\u77e5\u7ed9Host\u3002\u5728PCIe\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528Message TLPs\u6765\u4f20\u8f93\u8fd9\u4e9b\u4e8b\u4ef6\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u8fb9\u5e26\u4fe1\u53f7\u3002\u5728PCIe\u4e2d\u88ab\u5b9a\u4e49\u4e86Message\u7684\u4e8b\u4ef6\u7c7b\u578b\u6709\uff1a</p> <p>n \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09</p> <p>n INTx\u4f20\u7edf\u4e2d\u65ad\u4fe1\u53f7\uff08INTx legacy interrupt signaling\uff09</p> <p>n \u9519\u8bef\u4fe1\u53f7\uff08Error signaling\uff09</p> <p>n \u9501\u5b9a\u4e8b\u52a1\u7684\u652f\u6301\uff08Locked Transaction support\uff09</p> <p>n \u70ed\u63d2\u62d4\u4fe1\u53f7\uff08Hot Plug signaling\uff09</p> <p>n \u5382\u5546\u7279\u5b9a\u4fe1\u53f7\uff08Vendor-specific signaling\uff09</p> <p>n \u63d2\u5165\u5361\u63d2\u69fd\u529f\u8017\u9650\u5236\u8bbe\u7f6e\uff08Slot Power Limit settings\uff09</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4632-tlp-header","title":"4.6.3.2   TLP Header\u4e2d\u6709\u5173\u9690\u5f0f\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5","text":"<p>\u5bf9\u4e8e\u9690\u5f0f\u8def\u7531\u6765\u8bf4\uff0c\u4f7f\u7528TLP Header\u4e2d\u7684\u5b50\u5b57\u6bb5\uff08sub-field\uff09\u6765\u786e\u5b9aMessage\u7684\u76ee\u7684\u5730\u3002\u56fe 4\u201122\u5c55\u793a\u4e86\u4e00\u4e2a\u4f7f\u7528\u9690\u5f0f\u8def\u7531\u7684Message TLP Header\u3002</p> <p></p> <p>\u56fe 4\u201122 4DW Message TLP Header\u4e2d\u7684\u9690\u5f0f\u8def\u7531\u76f8\u5173\u7684\u5b57\u6bb5</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4633-messagetype","title":"4.6.3.3   Message\u7684Type\u5b57\u6bb5\u603b\u7ed3","text":"<p>\u8868 4\u201110\u5c55\u793a\u4e86\u4e00\u4e2aMessage\u7684TLP Header\u4e2dType\u5b57\u6bb5\u7684\u542b\u4e49\u3002\u5982\u8868\u4e2d\u6240\u793a\uff0c\u6700\u9ad8\u76842bit\u7528\u4e8e\u6307\u793a\u8fd9\u4e2a\u6570\u636e\u5305\u662f\u4e00\u4e2aMessage\uff0c\u5269\u4e0b\u7684\u4f4e3bit\u7528\u4e8e\u6307\u793a\u8fd9\u4e2aMessage\u4f7f\u7528\u7684\u8def\u7531\u65b9\u6cd5\u3002\u9700\u8981\u6ce8\u610f\uff0cMessage TLP\u4e0d\u7ba1\u4f7f\u7528\u54ea\u79cd\u8def\u7531\u64cd\u4f5c\uff0c\u90fd\u53ea\u4f1a\u4f7f\u75284DW Header\u3002\u82e5\u4f7f\u7528\u5730\u5740\u8def\u7531\uff0c\u90a3\u4e48\u5c31\u7528byte8-15\u6765\u7ec4\u621064bit\u5730\u5740\uff1b\u82e5\u4f7f\u7528ID\u8def\u7531\uff0c\u90a3\u4e48\u5c31\u7528byte8\u548c9\u6765\u7ec4\u6210\u76ee\u6807BDF\u3002</p> <p></p> <p>\u8868 4\u201110 Message\u8bf7\u6c42Header\u4e2dType\u5b57\u6bb5\u7684\u7528\u6cd5</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4634-ep","title":"4.6.3.4   EP\u7684\u5904\u7406","text":"<p>\u5bf9\u4e8e\u9690\u5f0f\u8def\u7531\uff0cEP\u4f1a\u7b80\u5355\u7684\u68c0\u67e5\u8def\u7531\u5b50\u5b57\u6bb5\uff08sub-field\uff09\u662f\u5426\u9002\u5408\u5b83\u3002\u4f8b\u5982\uff0cEP\u4f1a\u63a5\u53d7\u4e00\u4e2a\u5e7f\u64adMessage\u6216\u662f\u4e00\u4e2a\u7ec8\u6b62\u4e8eEP\u63a5\u6536\u7aef\u7684Message\uff0c\u4f46\u662f\u4e0d\u4f1a\u63a5\u53d7\u9690\u5f0f\u76ee\u7684\u5730\u4e3aRC\u7684Message\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#4635-switch","title":"4.6.3.5   Switch\u7684\u5904\u7406","text":"<p>\u50cfSwitch\u8fd9\u6837\u7684\u8def\u7531\u5143\u4ef6\uff08Routing Element\uff09\u9700\u8981\u8003\u8651TLP\u5230\u8fbe\u4e86\u54ea\u4e2a\u7aef\u53e3\uff0c\u4ee5\u53caTLP\u7684\u8def\u7531\u5b50\u5b57\u6bb5\u662f\u5426\u5bf9\u8fd9\u4e2a\u7aef\u53e3\u6765\u8bf4\u662f\u5408\u9002\u7684\u3002\u4e3e\u4f8b\u6765\u8bf4\uff1a</p> <p>\\1.    \u4e00\u4e2aSwitch\u7684\u4e0a\u884c\u7aef\u53e3\u53ef\u4ee5\u5408\u6cd5\u7684\u63a5\u6536\u4e00\u4e2a\u5e7f\u64adMessage\u3002\u4e0a\u884c\u7aef\u53e3\u5c06\u4f1a\u628a\u8fd9\u4e2a\u5e7f\u64adMessage\u590d\u5236\u4e00\u4efd\uff0c\u5e76\u5411\u5b83\u7684\u6240\u6709\u4e0b\u884c\u7aef\u53e3\u90fd\u8f6c\u53d1\u3002\u5982\u679c\u4e00\u4e2aSwitch\u7684\u4e0b\u884c\u7aef\u53e3\u63a5\u6536\u4e86\u4e00\u4e2a\u9690\u5f0f\u8def\u7531\u7684\u5e7f\u64adMessage\uff08\u8fd9\u610f\u5473\u7740\u8fd9\u4e2aMessage\u5c06\u4f1a\u5411\u4e0a\u884c\u79fb\u52a8\uff09\uff0c\u8fd9\u662f\u4e00\u79cd\u9519\u8bef\uff0c\u5b83\u5c06\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u6765\u5904\u7406\u3002</p> <p>\\2.    \u4e00\u4e2aSwitch\u7684\u4e0b\u884c\u7aef\u53e3\u53ef\u4ee5\u63a5\u6536\u9690\u5f0f\u8def\u7531\u76ee\u7684\u5730\u4e3aRC\u7684Message\uff0c\u4e0b\u884c\u7aef\u53e3\u5c06\u4f1a\u628a\u8fd9\u4e2aMessage\u8f6c\u53d1\u7ed9\u4e0a\u884c\u7aef\u53e3\uff0c\u56e0\u4e3a\u8def\u7531\u5143\u4ef6\u77e5\u9053RC\u6c38\u8fdc\u5728\u4e0a\u884c\u3002\u800cSwitch\u7684\u4e0a\u884c\u7aef\u53e3\u5e76\u4e0d\u4f1a\u4ece\u5916\u754c\u63a5\u53d7\u4e00\u4e2a\u9690\u5f0f\u8def\u7531\u76ee\u7684\u5730\u4e3aRC\u7684Message\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u5b83\u4f1a\u5411\u4e0b\u8f6c\u53d1\uff0c\u4f46\u662fRC\u5374\u5728\u62d3\u6251\u7ed3\u6784\u7684\u4e0a\u65b9\u3002</p> <p>\\3.    \u5982\u679c\u9690\u5f0f\u8def\u7531Message\u8868\u793a\u5b83\u4f1a\u7ec8\u6b62\u5728\u5176\u63a5\u6536\u8005\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u63a5\u6536\u5b83\u7684Switch\u7aef\u53e3\u5c06\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aMessage\uff0c\u800c\u4e0d\u662f\u5c06\u5176\u8f6c\u53d1\u3002</p> <p>\\4.    \u5bf9\u4e8e\u4f7f\u7528\u5730\u5740\u8def\u7531\u6216\u8005ID\u8def\u7531\u7684Message\u6765\u8bf4\uff0cSwitch\u4f1a\u6309\u7167\u4e00\u822c\u5bf9\u5730\u5740\u6216ID\u7684\u68c0\u67e5\u65b9\u5f0f\u6765\u51b3\u5b9a\u662f\u63a5\u6536\u5b83\u4eec\u8fd8\u662f\u8f6c\u53d1\u5b83\u4eec\u3002</p>"},{"location":"pcie/04%20%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BA%8B%E5%8A%A1%E8%B7%AF%E7%94%B1/#47-dllpordered-set","title":"4.7 DLLP\u548cOrdered Set\u4e0d\u4f1a\u88ab\u8def\u7531","text":"<p>DLLP\u548cOrdered Set\u7684\u6d41\u91cf\u5e76\u4e0d\u4f1a\u88ab\u4eceSwitch\u6216\u8005RC\u7684\u5165\u53e3\u7aef\u53e3\u8def\u7531\u5230\u51fa\u53e3\u7aef\u53e3\u3002\u8fd9\u4e9b\u6570\u636e\u5305\u53ea\u4f1a\u901a\u8fc7\u7269\u7406\u5c42\u5230\u7269\u7406\u5c42\u7684\u94fe\u8def\u8fdb\u884c\u4f20\u8f93\uff0c\u4ece\u4e00\u4e2a\u7aef\u53e3\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u7aef\u53e3\u3002</p> <p>DLLP\u8d77\u6e90\u4e8ePCIe\u7aef\u53e3\u7684\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5148\u7ecf\u8fc7\u7269\u7406\u5c42\uff0c\u63a5\u7740\u79bb\u5f00\u7aef\u53e3\u5e76\u5728\u94fe\u8def\u4e0a\u4f20\u8f93\uff0c\u7136\u540e\u5230\u8fbe\u5bf9\u7aef\u7aef\u53e3\u3002\u5728\u5bf9\u7aef\u7aef\u53e3\u4e0a\uff0cDLLP\u5148\u7ecf\u8fc7\u7269\u7406\u5c42\uff0c\u7136\u540e\u6700\u7ec8\u5230\u8fbe\u6570\u636e\u94fe\u8def\u5c42\uff0cDLLP\u5728\u8fd9\u91cc\u88ab\u5904\u7406\u548c\u6d88\u8017\u3002DLLP\u4e0d\u4f1a\u7ee7\u7eed\u6cbf\u7740\u7aef\u53e3\u5411\u4e0a\u5230\u8fbe\u4e8b\u52a1\u5c42\uff0c\u56e0\u6b64\u5b83\u5e76\u4e0d\u5b58\u5728\u8def\u7531\u3002</p> <p>\u76f8\u4f3c\u7684\uff0cOrdered-Set\u6570\u636e\u5305\u8d77\u6e90\u4e8e\u7269\u7406\u5c42\uff0c\u7136\u540e\u79bb\u5f00\u7aef\u53e3\u5e76\u901a\u8fc7\u94fe\u8def\u4f20\u8f93\uff0c\u6700\u7ec8\u5230\u8fbe\u5bf9\u7aef\u7aef\u53e3\u3002\u5728\u5bf9\u7aef\u7aef\u53e3\u4e0a\uff0cOrdered-Set\u5728\u7269\u7406\u5c42\u5c31\u88ab\u5904\u7406\u548c\u6d88\u8017\u3002\u7531\u4e8eOrdered-Set\u4e5f\u4e0d\u4f1a\u7ee7\u7eed\u6cbf\u7740\u7aef\u53e3\u5411\u4e0a\u5230\u8fbe\u6570\u636e\u94fe\u8def\u5c42\u6216\u8005\u4e8b\u52a1\u5c42\uff0c\u56e0\u6b64\u5b83\u4e5f\u4e0d\u5b58\u5728\u8def\u7531\u3002</p> <p>\u6b63\u5982\u672c\u7ae0\u6240\u8ba8\u8bba\u7684\u90a3\u6837\uff0c\u53ea\u6709TLP\u4f1a\u88abSwitch\u548cRC\u8fdb\u884c\u8def\u7531\uff0c\u5b83\u4eec\u8d77\u6e90\u4e8e\u6e90\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\uff0c\u7ed3\u675f\u4e8e\u76ee\u7684\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\u3002</p> <p>\u539f\u6587\uff1a  Mindshare</p> <p>\u8bd1\u8005\uff1a  Michael ZZY</p> <p>\u6821\u5bf9\uff1a  Karl DGR</p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/","title":"\u7b2c\u4e8c\u90e8\u5206    Part Two\uff1aTransaction Layer \u4e8b\u52a1\u5c42","text":""},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#chapter-5-tlp-element-tlp","title":"Chapter 5      TLP Element //TLP \u5143\u7d20","text":""},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#_1","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u63cf\u8ff0\u4e86\u4e00\u4e2a Function \u901a\u8fc7 BARs \u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\uff08\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u6216 IO \u5730\u5740\u7a7a\u95f4\uff09\u7684\u76ee\u7684\u548c\u65b9\u6cd5\uff0c\u8fd8\u63cf\u8ff0\u4e86\u8f6f\u4ef6\u5982\u4f55\u914d\u7f6e Bridge \u7684 Base/Limit \u5bc4\u5b58\u5668\uff0c\u5c06\u6e90\u7aef\u53e3\u7684 TLP \u8def\u7531\u81f3\u6b63\u786e\u7684\u76ee\u7684\u7aef\u53e3\u3002\u6211\u4eec\u8fd8\u8ba8\u8bba\u4e86 PCIe \u4e2d TLP \u8def\u7531\u7684\u4e00\u822c\u6982\u5ff5\uff0c\u5305\u62ec\u57fa\u4e8e\u5730\u5740\u7684\u8def\u7531\u3001\u57fa\u4e8e ID \u7684\u8def\u7531\uff0c\u4ee5\u53ca\u9690\u5f0f\u8def\u7531\uff08implicit routing\uff09\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u5728 PCIe \u8bbe\u5907\u4e4b\u95f4\uff0c\u4fe1\u606f\u662f\u4ee5\u5305\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u8f93\u7684\uff0c\u5305\u4e3b\u8981\u5206\u4e3a\u4e09\u7c7b\uff1aTLP\uff08Transaction Layer Packet\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\u3001DLLP\uff08Data Link Layer Packet\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u548c Ordered Set\uff08\u547d\u4ee4\u96c6\uff0c\u5b83\u5e94\u7528\u4e8e\u7269\u7406\u5c42\uff09\u3002\u672c\u7ae0\u5c06\u8bb2\u8ff0 TLP \u7684\u7528\u6cd5\u3001\u683c\u5f0f\u548c\u4e0d\u540c\u79cd\u7c7b\u7684\u5b9a\u4e49\uff0c\u5e76\u5c06\u8be6\u7ec6\u8bb2\u89e3 TLP \u7684\u76f8\u5173\u5b57\u6bb5\u542b\u4e49\u3002\u5173\u4e8e DLLP \u7684\u5185\u5bb9\u5c06\u4f1a\u5728 Chapter 9 \u201cDLLP Element\u201d \u4e2d\u8fdb\u884c\u5355\u72ec\u8bb2\u89e3\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u5c06\u8ba8\u8bba\u6d41\u91cf\u63a7\u5236\u534f\u8bae\uff08Flow Control Protocol\uff09\u7684\u76ee\u7684\u548c\u8be6\u7ec6\u64cd\u4f5c\u3002\u6d41\u91cf\u63a7\u5236\u662f\u7528\u6765\u786e\u4fdd\u53d1\u9001\u65b9\u5728\u63a5\u6536\u65b9\u65e0\u6cd5\u63a5\u6536 TLP \u65f6\uff0c\u4e0d\u518d\u7ee7\u7eed\u53d1\u9001 TLP\u3002\u6d41\u91cf\u63a7\u5236\u907f\u514d\u4e86\u63a5\u6536\u7f13\u5b58\u7684\u6ea2\u51fa\uff0c\u4e5f\u6d88\u9664\u4e86\u539f\u672c PCI \u5de5\u4f5c\u65b9\u5f0f\u4e2d\u7684\u4e00\u4e9b\u4f4e\u6548\u884c\u4e3a\uff0c\u6bd4\u5982\u65ad\u5f00\uff08disconnect\uff09\u3001\u91cd\u8bd5\uff08retry\uff09\u548c\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#51-introduction-to-packet-based-protocol","title":"5.1 \u57fa\u4e8e\u6570\u636e\u5305\u534f\u8bae\u7684\u4ecb\u7ecd\uff08Introduction to Packet-Based Protocol\uff09","text":""},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#511-general","title":"5.1.1     \u6982\u62ec\uff08General\uff09","text":"<p>\u4e0d\u540c\u4e8e\u5e76\u884c\u603b\u7ebf\uff0cPCIe \u8fd9\u6837\u7684\u4e32\u884c\u603b\u7ebf\u4e0d\u4f7f\u7528\u603b\u7ebf\u4e0a\u7684\u63a7\u5236\u4fe1\u53f7\u6765\u8868\u793a\u67d0\u65f6\u523b\u94fe\u8def\u4e0a\u6b63\u5728\u53d1\u751f\u4ec0\u4e48\u3002\u76f8\u53cd\u5730\uff0cPCIe \u94fe\u8def\u4e0a\u7684\u53d1\u9001\u65b9\u53d1\u51fa\u7684\u6bd4\u7279\u6d41\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u9884\u671f\u7684\u5927\u5c0f\uff0c\u8fd8\u8981\u6709\u4e00\u4e2a\u53ef\u4f9b\u63a5\u6536\u65b9\u8fa8\u8ba4\u7684\u683c\u5f0f\uff0c\u8fd9\u6837\u63a5\u6536\u65b9\u624d\u80fd\u7406\u89e3\u6bd4\u7279\u6d41\u7684\u5185\u5bb9\u3002\u6b64\u5916\uff0cPCIe \u5728\u4f20\u8f93\u6570\u636e\u5305\u65f6\u5e76\u4e0d\u4f7f\u7528\u4efb\u4f55\u76f4\u63a5\u63e1\u624b\u673a\u5236\uff08immediate handshake\uff09\u3002</p> <p>\u9664\u4e86\u903b\u8f91\u7a7a\u95f2\u7b26\u53f7\uff08Logical Idle symbol\uff09\u548c Ordered Set \u7684\u7269\u7406\u5c42\u5305\u5916\uff0c\u5728\u6d3b\u8dc3\u7684 PCIe \u94fe\u8def\u4e0a\u4f20\u8f93\u7684\u4fe1\u606f\u7684\u57fa\u672c\u7ec4\u5757\u88ab\u79f0\u4e3a Packet\uff08\u5305\uff09\uff0c\u5305\u662f\u7531\u7b26\u53f7\u7ec4\u6210\u7684\u3002\u94fe\u8def\u4e0a\u4ea4\u6362\u7684\u4e24\u7c7b\u4e3b\u8981\u7684\u6570\u636e\u5305\u4e3a\u9ad8\u5c42\u7684 TLP\uff08Transaction Layer Packet\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\uff0c\u548c\u4f4e\u5c42\u7684\u7528\u4e8e\u94fe\u8def\u7ef4\u62a4\u7684\u5305\u79f0\u4e3a DLLP\uff08Data Link Layer Packet\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u3002\u8fd9\u4e9b\u5305\u548c\u5b83\u4eec\u7684\u4f20\u8f93\u6d41\u5982\u56fe 5\u20111 \u6240\u793a\u3002\u7269\u7406\u5c42\u7684 Ordered Set \u4e5f\u662f\u4e00\u79cd\u5305\uff0c\u4f46\u662f\u5b83\u5e76\u4e0d\u50cf TLP \u548c DLLP \u4e00\u6837\u4f1a\u88ab\u5c01\u88c5\u4e0a\u5305\u8d77\u59cb\u7b26\u53f7\u548c\u5305\u7ed3\u675f\u7b26\u53f7\uff08\u4e5f\u5c31\u662f\u524d\u9762\u7ae0\u8282\u6240\u8bb2\u7684\u7ec4\u5e27\u7b26\u53f7\uff09\uff0c\u5e76\u4e14 Ordered Set \u4e5f\u5e76\u6ca1\u6709\u50cf TLP \u548c DLLP \u4e00\u6837\u7684\u5b57\u8282\u6761\u5e26\u5316\u8fc7\u7a0b\uff0c\u76f8\u53cd\u5730\uff0cOrdered Set \u4f1a\u5728\u94fe\u8def\u7684\u6bcf\u4e2a\u901a\u9053\uff08lane\uff09\u4e0a\u90fd\u590d\u5236\u4e00\u4efd\uff0c\u800c\u4e0d\u662f\u50cf\u5b57\u8282\u6761\u5e26\u5316\u4e00\u6837\u628a\u4fe1\u606f\u6309\u5b57\u8282\u5206\u914d\u5230\u5404\u4e2a\u901a\u9053\u4e0a\u3002</p> <p></p> <p>\u56fe 5\u20111 TLP \u548c DLLP \u5305</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#512","title":"5.1.2     \u4f7f\u7528\u57fa\u4e8e\u6570\u636e\u5305\u534f\u8bae\u7684\u52a8\u673a","text":"<p>\u4f7f\u7528\u57fa\u4e8e\u5305\u7684\u534f\u8bae\uff08Packet-Based Protocol\uff09\u6709\u4e09\u4e2a\u660e\u663e\u7684\u4f18\u70b9\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u6570\u636e\u5b8c\u6574\u6027\uff08data integrity\uff09\u6765\u8bf4\uff1a</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5121","title":"5.1.2.1   \u7cbe\u5fc3\u5b9a\u4e49\u7684\u6570\u636e\u5305\u683c\u5f0f","text":"<p>\u50cf PCI \u8fd9\u79cd\u65e9\u671f\u7684\u603b\u7ebf\uff0c\u5b83\u4eec\u5141\u8bb8\u603b\u7ebf\u4e0a\u4e0d\u786e\u5b9a\u6570\u636e\u91cf\u5927\u5c0f\u7684\u4f20\u8f93\uff0c\u8fd9\u4f7f\u5f97\u53ea\u8981\u4f20\u8f93\u6ca1\u6709\u7ed3\u675f\u5c31\u65e0\u6cd5\u8bc6\u522b\u51fa\u6570\u636e\u8377\u8f7d\uff08payload\uff09\u7684\u8fb9\u754c\u3002\u6b64\u5916\uff0c\u4efb\u4f55\u4e00\u4e2a\u8bbe\u5907\u90fd\u53ef\u4ee5\u5728\u6b64\u6b21\u4f20\u8f93\u5b8c\u6210\u524d\u7ec8\u6b62\u8fd9\u4e2a\u4f20\u8f93\uff0c\u8fd9\u4f7f\u5f97\u53d1\u9001\u65b9\u5f88\u96be\u53bb\u8ba1\u7b97\u5e76\u4f20\u8f93\u4e00\u4e2a\u8986\u76d6\u4e86\u6574\u4e2a\u6570\u636e\u8377\u8f7d\u7684\u6821\u9a8c\u548c\u6216\u8005 CRC\u3002\u76f8\u53cd\u5730\uff0cPCI \u4f7f\u7528\u4e86\u4e00\u79cd\u7b80\u5355\u7684\u5947\u5076\u6821\u9a8c\u7684\u65b9\u6848\uff0c\u5e76\u5728\u6bcf\u4e2a\u6570\u636e\u9636\u6bb5\uff08data phase\uff09\u8fdb\u884c\u5947\u5076\u6821\u9a8c\u3002\uff08\u8fd9\u91cc\u5982\u679c\u6ca1\u7406\u89e3\u8bf7\u53c2\u9605 Chapter 1 \u5185\u7684 PCI \u76f8\u5173\u5185\u5bb9\uff09</p> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0cPCIe \u5305\u5177\u6709\u4e00\u4e2a\u5df2\u77e5\u7684\u5927\u5c0f\u548c\u683c\u5f0f\u3002\u4f4d\u4e8e\u5305\u7684\u5f00\u5934\u7684\u90e8\u5206\u4e3a Header\uff0c\u5b83\u7528\u6765\u6307\u793a\u8fd9\u4e2a\u5305\u7684\u7c7b\u578b\uff0c\u5e76\u5305\u542b\u4e86\u5fc5\u9700\u5b57\u6bb5\uff08required field\uff09\u548c\u53ef\u9009\u5b57\u6bb5\uff08optional field\uff09\u3002\u9664\u4e86\u5730\u5740\u5b57\u6bb5\u4ee5\u5916\uff0cHeader \u4e2d\u7684\u5176\u4ed6\u5b57\u6bb5\u957f\u5ea6\u90fd\u662f\u56fa\u5b9a\u7684\uff0c\u5730\u5740\u5b57\u6bb5\u53ef\u4ee5\u4e3a 32bit \u4e5f\u53ef\u4ee5\u4e3a 64bit\u3002\u4e00\u65e6\u4e00\u6b21\u4f20\u8f93\u5f00\u59cb\uff0c\u63a5\u6536\u65b9\u4e0d\u80fd\u6682\u505c\u6216\u8005\u63d0\u524d\u7ec8\u6b62\u5b83\u3002\u8fd9\u79cd\u7ed3\u6784\u5316\u7684\u683c\u5f0f\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728 TLP \u4e2d\u52a0\u5165\u4e00\u4e9b\u4fe1\u606f\u6765\u66f4\u6709\u5229\u4e8e\u8fdb\u884c\u53ef\u9760\u7684\u4f20\u8f93\uff0c\u4f8b\u5982\u52a0\u5165\u7ec4\u5e27\u7b26\u53f7\uff08framing symbol\uff09\u3001CRC\u3001\u4ee5\u53ca\u4e00\u4e2a\u5305\u7684\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5122","title":"5.1.2.2   \u4f7f\u7528\u7ec4\u5e27\u7b26\u53f7\u5b9a\u4e49\u5305\u7684\u8fb9\u754c","text":"<p>\u5728 PCIe Gen1 \u548c Gen2 \u64cd\u4f5c\u6a21\u5f0f\u4e2d\u4f7f\u7528\u7684\u662f 8b/10b \u7f16\u7801\uff0c\u56e0\u6b64\u5728\u8fd9 Gen1 \u548c Gen2 \u4e2d\u6bcf\u4e2a TLP \u548c DLLP \u5728\u53d1\u9001\u524d\u90fd\u4f1a\u4f7f\u7528\u8d77\u59cb\u7b26\u53f7\uff08Start\uff09\u548c\u7ed3\u675f\u7b26\u53f7\uff08End\uff09\u8fd9\u4e24\u79cd\u63a7\u5236\u7b26\u53f7\u6765\u8fdb\u884c\u7ec4\u5e27\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ed9\u63a5\u6536\u65b9\u6e05\u6670\u5730\u5b9a\u4e49\u51fa\u5305\u7684\u8fb9\u754c\u3002\u8fd9\u662f\u5728 PCI \u548c PCI-X \u4e0a\u7684\u91cd\u5927\u6539\u8fdb\uff0c\u5728 PCI \u548c PCI-X \u4e2d\u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u7684 FRAME# \u4fe1\u53f7\u6765\u6307\u793a\u4e00\u4e2a\u4e8b\u52a1\u7684\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u5982\u679c FRAME# \u51fa\u73b0\u4e86\u6bdb\u523a\uff0c\u6216\u8005\u5176\u4ed6\u7684\u63a7\u5236\u4fe1\u53f7\u51fa\u73b0\u4e86\u6bdb\u523a\uff0c\u90a3\u4e48\u90fd\u6709\u53ef\u80fd\u9020\u6210\u76ee\u6807\u8bbe\u5907\u5bf9\u603b\u7ebf\u884c\u4e3a\u7684\u8bef\u89e3\u3002\u4e00\u4e2a PCIe \u63a5\u6536\u65b9\u5fc5\u987b\u5728\u6700\u540e\u7684\u94fe\u8def\u6d3b\u52a8\u5f00\u59cb\u6216\u7ed3\u675f\u4e4b\u524d\uff0c\u5c31\u6b63\u786e\u5b8c\u6210\u4e00\u4e2a\u5b8c\u6574 10bit \u7b26\u53f7\u7684\u8bd1\u7801\uff0c\u8fd9\u6837\u63a5\u6536\u65b9\u80fd\u66f4\u5bb9\u6613\u8bc6\u522b\u4e0d\u671f\u671b\u51fa\u73b0\u6216\u8005\u65e0\u6cd5\u8bc6\u522b\u7684\u7b26\u53f7\uff0c\u5e76\u4e14\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u9519\u8bef\u6765\u5904\u7406\u3002</p> <p>\u5bf9\u4e8e PCIe Gen3 \u4f7f\u7528\u7684 128b/130b \u7f16\u7801\u6765\u8bf4\uff0c\u63a7\u5236\u5b57\u7b26\u4e0d\u518d\u88ab\u4f7f\u7528\uff0c\u5e76\u4e14\u4e5f\u6ca1\u6709\u7ec4\u5e27\u7b26\u53f7\u4e86\u3002\u5bf9\u4e8e\u66f4\u591a\u7684\u5173\u4e8e Gen3 \u7f16\u7801\u4e0e\u65e9\u671f\u7248\u672c\u7684\u5dee\u5f02\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605 Chapter 12\u201cPhysical Layer-Logical\uff08Gen3\uff09\u201d\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5123-crc","title":"5.1.2.3   \u4f7f\u7528 CRC \u4fdd\u969c\u6574\u4e2a\u6570\u636e\u5305\u7684\u6b63\u786e\u4f20\u8f93","text":"<p>\u5728 PCI \u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u4f1a\u5728\u5730\u5740\u9636\u6bb5\uff08address phase\uff09\u548c\u6570\u636e\u9636\u6bb5\uff08data phase\uff09\u4e2d\u4f7f\u7528\u5947\u5076\u6821\u9a8c\u8fb9\u5e26\uff08side-band\uff09\u4fe1\u53f7\uff0c\u4f46\u662f\u5728 PCIe \u4e2d\u5219\u4e0d\u540c\u3002PCIe \u4e2d\u4f7f\u7528\u5e26\u5185\uff08in-band\uff09\u7684 CRC \u503c\u6765\u9a8c\u8bc1\u6574\u4e2a\u6570\u636e\u5305\u662f\u5426\u8fdb\u884c\u4e86\u65e0\u9519\u8bef\u7684\u4f20\u8f93\u3002\u540c\u65f6 TLP \u8fd8\u4f1a\u88ab\u53d1\u9001\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u6dfb\u52a0\u4e0a\u4e00\u4e2a\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\uff0c\u8fd9\u4f7f\u5f97\u5f53\u8fd9\u4e2a\u5e8f\u5217\u53f7\u7684\u6570\u636e\u5305\u4f20\u8f93\u51fa\u9519\u65f6\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u5b9a\u4f4d\u5230\u5b83\uff0c\u5e76\u8fdb\u884c\u81ea\u52a8\u7684\u91cd\u4f20\u3002\u53d1\u9001\u65b9\u4f1a\u5728\u81ea\u5df1\u7684 Retry Buffer \u5185\u4fdd\u5b58\u6bcf\u4e2a TLP \u7684\u4e00\u4e2a\u526f\u672c\uff0c\u76f4\u5230\u63a5\u6536\u65b9\u786e\u8ba4\u4e86\u8fd9\u4e2a TLP \u6210\u529f\u65e0\u9519\u4f20\u8f93\u540e\u624d\u4f1a\u5c06\u526f\u672c\u6e05\u9664\u3002\u8fd9\u79cd TLP \u7684\u786e\u8ba4\u673a\u5236\u88ab\u79f0\u4e3a Ack/Nak \u534f\u8bae\uff08\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605 Chapter 10 \u201cAck/Nak Protocol\u201d \uff09\uff0c\u5b83\u7528\u6765\u5f62\u6210\u57fa\u7840\u7684\u94fe\u8def\u7ea7 TLP \u9519\u8bef\u68c0\u6d4b\u548c\u7ea0\u6b63\u673a\u5236\u3002\u8fd9\u79cd Ack/Nak \u534f\u8bae\u63d0\u4f9b\u7684\u9519\u8bef\u6062\u590d\u673a\u5236\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728\u95ee\u9898\u53d1\u751f\u7684\u5730\u65b9\u6216\u8005\u94fe\u8def\u4e0a\u53ca\u65f6\u7684\u89e3\u51b3\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u4e5f\u8981\u6c42\u6709\u4e00\u4e2a\u672c\u5730\u7684\u786c\u4ef6\u89e3\u51b3\u65b9\u6848\u6765\u652f\u6301\u8fd9\u79cd\u534f\u8bae\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#52-tlp-tlp-details","title":"5.2 TLP \u7ec6\u8282\uff08TLP Details\uff09","text":"<p>\u5728 PCIe \u4e2d\uff0c\u9ad8\u5c42\u6b21\u4e8b\u52a1\u8d77\u6e90\u4e8e\u53d1\u9001\u65b9\u7684 Device Core\uff0c\u7ec8\u6b62\u4e8e\u63a5\u6536\u65b9\u7684 Device Core\u3002\u4e8b\u52a1\u5c42\u4f1a\u5904\u7406\u8fd9\u4e9b\u8bf7\u6c42\uff0c\u5176\u4e2d\uff0c\u53d1\u9001\u7aef\u7684\u4e8b\u52a1\u5c42\u7ec4\u88c5 TLP\uff0c\u63a5\u6536\u7aef\u7684\u4e8b\u52a1\u5c42\u89e3\u6790 TLP\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u4e5f\u4f1a\u53c2\u4e0e\u5305\u7684\u7ec4\u88c5\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#521-tlp","title":"5.2.1     TLP \u7684\u7ec4\u5305\u548c\u62c6\u5305","text":"<p>\u5982\u56fe 5\u20112 \u6240\u793a\u7684\u662f\u94fe\u8def\u7684\u53d1\u9001\u7aef\u7ec4\u88c5 TLP \u548c\u63a5\u6536\u7aef\u62c6\u89e3 TLP \u7684\u4e00\u822c\u6d41\u7a0b\u3002\u73b0\u5728\u8ba9\u6211\u4eec\u8bb2\u4e00\u8bb2\u4ece\u4e00\u4e2a\u5305\u7684\u751f\u6210\uff0c\u5230\u5b83\u88ab\u4f20\u9001\u5230\u63a5\u6536\u7aef\u7684 Device Core \u7684\u5404\u4e2a\u6b65\u9aa4\u3002\u4e0b\u9762\u5217\u51fa\u4e86 TLP \u7ec4\u5305\u548c\u62c6\u5305\u7684\u5173\u952e\u9636\u6bb5\uff0c\u5217\u51fa\u7684\u7f16\u53f7\u4e0e\u56fe 5\u20112 \u4e2d\u7684\u7f16\u53f7\u76f8\u5bf9\u5e94\u3002</p> <p></p> <p>\u56fe 5\u20112 PCIe TLP \u7684\u7ec4\u5305\u4e0e\u62c6\u5305</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#_4","title":"\u53d1\u9001\u65b9","text":"<ol> <li> <p>\u8bbe\u5907 A \u7684 Device Core \u5411\u5b83\u7684 PCIe \u63a5\u53e3\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\uff08\u5177\u4f53 Device Core \u662f\u5982\u4f55\u7ed9 PCIe \u63a5\u53e3\u53d1\u9001\u8bf7\u6c42\u7684\uff0c\u8fd9\u5e76\u4e0d\u662f PCIe \u534f\u8bae\u6216\u8005\u672c\u4e66\u7684\u8ba8\u8bba\u8303\u7574\uff09\u3002\u8fd9\u4e2a\u8bf7\u6c42\u4e2d\u5305\u62ec\uff1a</p> </li> <li> <p>\u76ee\u6807\u5730\u5740\u6216\u8005 ID\uff08\u4e5f\u5c31\u662f\u8def\u7531\u4fe1\u606f\uff09</p> </li> <li>\u6e90\u7aef\u4fe1\u606f\uff0c\u4f8b\u5982 Requester ID \u548c Tag</li> <li>\u4e8b\u52a1\u7c7b\u578b/\u6570\u636e\u5305\u7c7b\u578b\uff08\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4f8b\u5982\u4e00\u4e2a\u5185\u5b58\u8bfb\u53d6 MRd\uff09</li> <li> <p>\u6570\u636e\u8377\u8f7d\u5927\u5c0f payload size \u548c\u6570\u636e\u8377\u8f7d\u5185\u5bb9\uff08\u5982\u679c TLP \u9700\u8981\u5e26\u6570\u636e\uff09</p> </li> <li> <p>\u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff0c\u7528\u4e8e\u5206\u914d\u6570\u636e\u5305\u7684\u4f18\u5148\u7ea7\uff09</p> </li> <li> <p>\u8bf7\u6c42\u7684\u81ea\u8eab\u5c5e\u6027\uff08No Snoop \u65e0\u7aa5\u63a2\u3001Relaxed Ordering \u5bbd\u677e\u6392\u5e8f\uff0c\u7b49\u7b49\uff09</p> </li> <li> <p>\u57fa\u4e8e\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u4e8b\u52a1\u5c42\u5c06\u4f1a\u7ec4\u5efa TLP Header\uff0c\u5e76\u5728\u5176\u540e\u9644\u4e0a\u6570\u636e\u8377\u8f7d\uff08\u5982\u679c\u6709\uff09\uff0c\u4ee5\u53ca\u5982\u679c\u542f\u7528\u5e76\u652f\u6301\u53ef\u9009\u9879\u7684\u8bdd\u4e5f\u53ef\u4ee5\u518d\u9644\u4e0a ECRC\uff08End-to-End CRC\uff09\u3002\u968f\u540e TLP \u5c31\u4f1a\u88ab\u653e\u5165\u4e00\u4e2a\u865a\u62df\u901a\u9053 Buffer\u3002\u8fd9\u4e2a\u865a\u62df\u901a\u9053\u4f1a\u6839\u636e\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u6765\u7ba1\u7406 TLP \u7684\u987a\u5e8f\uff0c\u5e76\u5728\u5411\u4e0b\u8f6c\u53d1 TLP \u5230\u6570\u636e\u94fe\u8def\u5c42\u4e4b\u524d\uff0c\u786e\u8ba4\u63a5\u6536\u65b9\u6709\u8db3\u591f\u7684 Buffer \u6765\u63a5\u6536\u4e00\u4e2a TLP\u3002</p> </li> <li> <p>\u5f53 TLP \u5230\u8fbe\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5b83\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\uff0c\u5e76\u57fa\u4e8e TLP \u7684\u5185\u5bb9\u548c\u5e8f\u5217\u53f7\u6765\u8ba1\u7b97\u51fa\u4e00\u4e2a LCRC\uff08Link CRC\uff09\u6765\u9644\u52a0\u5728\u539f TLP \u540e\u3002\u7136\u540e\u4f1a\u5c06\u7ecf\u8fc7\u8fd9\u4e9b\u5904\u7406\u8fc7\u7a0b\u4e4b\u540e\u7684 TLP \u4fdd\u5b58\u4e00\u4e2a\u526f\u672c\uff0c\u8fd9\u4e2a\u526f\u672c\u4f1a\u4fdd\u5b58\u5728\u6570\u636e\u94fe\u8def\u5c42\u7684\u91cd\u4f20 Buffer\uff08Replay Buffer\uff0c\u4e5f\u53ef\u79f0\u4e3a Retry Buffer\uff09\u4e2d\uff0c\u8fd9\u662f\u4e3a\u4e86\u5e94\u5bf9\u4f20\u8f93\u51fa\u9519\u7684\u60c5\u51b5\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u8fd9\u4e2a TLP \u4e5f\u4f1a\u88ab\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\u3002</p> </li> <li> <p>\u7269\u7406\u5c42\u5c06\u4f1a\u8fdb\u884c\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u6765\u51c6\u5907\u5bf9\u8fd9\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u4e32\u884c\u4f20\u8f93\uff0c\u5305\u62ec\u5b57\u8282\u6761\u5e26\u5316\uff08Byte Striping\uff09\u3001\u6270\u7801\uff08Scrambling\uff09\u3001\u7f16\u7801\uff08Encoding\uff09\u4ee5\u53ca\u5e76\u4e32\u8f6c\u6362\uff08Serializing\uff09\u3002\u5bf9\u4e8e Gen1 \u548c Gen2 \u7684\u8bbe\u5907\uff0c\u5f53\u8fdb\u884c 8b/10b \u7f16\u7801\u65f6\uff0c\u4f1a\u5c06 STP \u548c END \u8fd9\u4e24\u4e2a\u63a7\u5236\u5b57\u7b26\u5206\u522b\u52a0\u5728 TLP \u7684\u9996\u7aef\u548c\u5c3e\u7aef\u3002\u6700\u540e\uff0c\u8fd9\u4e2a\u6570\u636e\u5305\u901a\u8fc7\u94fe\u8def\u8fdb\u884c\u4f20\u8f93\u3002\u5728 Gen3 \u64cd\u4f5c\u6a21\u5f0f\u4e2d\uff0cSTP \u4ee4\u724c\uff08STP token\uff09\u4f1a\u88ab\u6dfb\u52a0\u5728 TLP \u7684\u9996\u7aef\uff0c\u4f46\u662f\u5e76\u4e0d\u4f1a\u5728\u5c3e\u7aef\u52a0\u4e0a END\uff0c\u800c\u662f\u5728 STP \u4ee4\u724c\u4e2d\u5305\u542b TLP \u5927\u5c0f\u7684\u4fe1\u606f\u6765\u5224\u65ad TLP \u7684\u5c3e\u90e8\u4f4d\u7f6e\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#_5","title":"\u63a5\u6536\u65b9","text":"<ol> <li> <p>\u5728\u63a5\u6536\u65b9\uff08\u672c\u4f8b\u4e2d\u662f Device B\uff09\uff0c\u4e3a\u4e86\u53d1\u9001\u5305\u6240\u505a\u7684\u4e00\u5207\u51c6\u5907\u73b0\u5728\u90fd\u5fc5\u987b\u64a4\u9500\u3002\u7269\u7406\u5c42\u5c06\u5bf9\u6bd4\u7279\u6d41\u8fdb\u884c\u4e32\u5e76\u8f6c\u6362\uff08deserialize\uff09\u3001\u5bf9\u4e32\u5e76\u8f6c\u6362\u540e\u7684\u7b26\u53f7\u8fdb\u884c\u89e3\u7801\uff0c\u7136\u540e\u518d\u8fdb\u884c\u5b57\u8282\u53cd\u6761\u5e26\u5316\uff08un-stripes\uff09\u3002\u63a7\u5236\u5b57\u7b26\u5c06\u88ab\u79fb\u9664\uff0c\u56e0\u4e3a\u5b83\u4eec\u4ec5\u5728\u7269\u7406\u5c42\u6709\u610f\u4e49\uff0c\u7136\u540e\u8fd9\u4e2a\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> </li> <li> <p>\u6570\u636e\u94fe\u8def\u5c42\u5c06\u4f1a\u8ba1\u7b97 CRC\uff08\u5177\u4f53\u4e00\u70b9\u662f LCRC\uff09\u5e76\u4e0e TLP \u4e2d\u7684 CRC \u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679c CRC \u6bd4\u8f83\u7ed3\u679c\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u518d\u68c0\u67e5\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3002\u5982\u679c\u90fd\u6ca1\u6709\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u5c31\u628a CRC \u548c\u5e8f\u5217\u53f7\u90fd\u4ece TLP \u5265\u9664\uff0c\u5e76\u968f\u540e\u5c06 TLP \u5411\u4e0a\u8f6c\u53d1\u7ed9\u63a5\u6536\u65b9\u4e8b\u52a1\u5c42\uff0c\u4e0e\u6b64\u540c\u65f6\u8981\u901a\u8fc7\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\u4e00\u4e2a Ack DLLP \u6765\u901a\u77e5\u53d1\u9001\u65b9\u8fd9\u4e2a TLP \u88ab\u6210\u529f\u63a5\u6536\u3002\u76f8\u53cd\u5730\uff0c\u5982\u679c\u524d\u9762\u7684\u8fc7\u7a0b\u4e2d\u68c0\u67e5\u51fa\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u5c31\u8981\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\u4e00\u4e2a Nak DLLP\uff0c\u8fd9\u6837\u53d1\u9001\u65b9\u5c06\u4f1a\u4f7f\u7528\u5b83\u7684\u91cd\u4f20 Buffer \u6765\u5bf9 TLP \u8fdb\u884c\u91cd\u4f20\u3002</p> </li> <li> <p>\u5728\u4e8b\u52a1\u5c42\uff0cTLP \u88ab\u8fdb\u884c\u89e3\u7801\uff0c\u5e76\u5c06 TLP \u5185\u7684\u4fe1\u606f\u4f20\u9012\u7ed9 Device Core \u6765\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002\u5982\u679c\u5f53\u524d\u63a5\u6536\u8bbe\u5907\u5c31\u662f\u6570\u636e\u5305\u7684\u6700\u7ec8\u76ee\u7684\u5730\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u68c0\u67e5 ECRC \u9519\u8bef\uff0c\u5e76\u5728\u53d1\u73b0\u4efb\u4f55 ECRC \u9519\u8bef\u65f6\u62a5\u544a\u7ed9 Device Core\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#522-tlp","title":"5.2.2     TLP \u7ed3\u6784","text":"<p>\u4e00\u4e2a\u4e8b\u52a1\u5c42\u5305 TLP \u4e2d\u6bcf\u4e2a\u5b57\u6bb5\u57df\u7684\u57fa\u672c\u7528\u6cd5\u5728\u8868 5\u20111 \u4e2d\u8fdb\u884c\u4e86\u5b9a\u4e49\u3002</p> <p></p> <p>\u8868 5\u20111 TLP Header \u7684 Type \u5b57\u6bb5\u5b9a\u4e49\u4e86\u4e8b\u52a1\u4e0d\u540c\u79cd\u7c7b</p> <p>\u4e0b\u9762\u5bf9\u8868 5\u20111 \u4e2d\u7684\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <ul> <li> <p>Header</p> </li> <li> <p>\u534f\u8bae\u5c42\u6b21\uff1a\u4e8b\u52a1\u5c42</p> </li> <li> <p>\u8be5\u7ec4\u4ef6\u7528\u6cd5\uff1a\u5927\u5c0f\u4e3a 3 \u6216 4DW\uff0812 \u6216 16Bytes\uff09\u3002Header \u7684\u683c\u5f0f\u4f1a\u968f\u7c7b\u578b\u800c\u53d8\u5316\uff0c\u4f46\u662f Header \u4e5f\u5b9a\u4e49\u4e86\u4e00\u4e9b\u53c2\u6570\uff0c\u5305\u62ec\uff1a</p> <ul> <li> <p>\u4e8b\u52a1\u7c7b\u578b\uff08Transaction Type\uff09</p> </li> <li> <p>\u76ee\u6807\u5730\u5740\u3001ID \u7b49</p> </li> <li> <p>\u4f20\u8f93\u6570\u636e\u91cf\u5927\u5c0f\uff08\u5982\u679c\u6709\u6570\u636e\uff09\u3001\u5b57\u8282\u4f7f\u80fd\uff08Byte Enable\uff09</p> </li> <li> <p>\u5c5e\u6027\uff08Attribute\uff09</p> </li> <li> <p>\u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff09</p> </li> </ul> </li> <li> <p>Data</p> </li> <li> <p>\u534f\u8bae\u5c42\u6b21\uff1a\u4e8b\u52a1\u5c42</p> </li> <li> <p>\u8be5\u7ec4\u4ef6\u7528\u6cd5\uff1a\u53ef\u9009\u7684 1-1024DW \u5927\u5c0f\u7684\u6570\u636e\u8377\u8f7d\uff0c\u5177\u4f53\u7684\u5927\u5c0f\u7531\u5b57\u8282\u4f7f\u80fd\u6216\u8005\u5b57\u8282\u5bf9\u9f50\u7684\u5f00\u59cb\u548c\u7ed3\u675f\u5730\u5740\u6765\u8fdb\u884c\u63cf\u8ff0\u3002\u9700\u8981\u6ce8\u610f\u6307\u5b9a\u7684\u957f\u5ea6\u4e0d\u80fd\u4e3a 0\uff0c\u4f46\u662f\u4e00\u4e2a 0 \u957f\u5ea6\u7684\u8bfb\u53d6\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u957f\u5ea6\u4e3a 1DW \u7136\u540e\u5c06\u5b57\u8282\u4f7f\u80fd\u5168\u90e8\u7f6e\u4e3a 0 \u6765\u8fdb\u884c\u8fd1\u4f3c\u5904\u7406\uff08\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4f1a\u4f7f\u7528\uff09\u3002\u6765\u81ea Completer \u7684\u7ed3\u679c\u6570\u636e\u867d\u7136\u662f\u672a\u5b9a\u4e49\u7684\u79cd\u7c7b\uff0c\u4f46\u662f Requester \u5e76\u4e0d\u4f7f\u7528\u5b83\uff0c\u56e0\u6b64\u5c31\u548c\u6307\u5b9a 0 \u957f\u5ea6\u7684\u76ee\u7684\u7b49\u6548\u4e86\u3002</p> </li> <li> <p>Digest/ECRC</p> </li> <li> <p>\u534f\u8bae\u5c42\u6b21\uff1a\u4e8b\u52a1\u5c42</p> </li> <li> <p>\u8be5\u7ec4\u4ef6\u7528\u6cd5\uff1a\u53ef\u9009\u7684\u529f\u80fd\u3002\u5f53\u9700\u8981\u4f7f\u7528\u65f6\uff0cECRC \u7684\u5927\u5c0f\u6c38\u8fdc\u4e3a 1DW\u3002</p> </li> </ul>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#523-tlp-header-generic-tlp-header-format","title":"5.2.3     \u901a\u7528 TLP Header \u683c\u5f0f\uff08Generic TLP Header Format\uff09","text":""},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5231-general","title":"5.2.3.1   \u6982\u62ec\uff08General\uff09","text":"<p>\u5982\u56fe 5\u20113 \u4e2d\uff0c\u5c55\u793a\u4e86\u4e00\u4e2a 4DW \u7684\u901a\u7528 TLP Header \u7684\u683c\u5f0f\u548c\u5185\u5bb9\u3002\u5728\u672c\u8282\u5185\uff0c\u4f1a\u5bf9\u51e0\u4e4e\u6240\u6709\u4e8b\u52a1\u7684 TLP Header \u4e2d\u7684\u516c\u5171\u5b57\u6bb5\u8fdb\u884c\u603b\u7ed3\uff0c\u5e76\u4f1a\u5728\u7a0d\u540e\u8ba8\u8bba\u4e0e\u7279\u5b9a\u4e8b\u52a1\u7c7b\u578b\u76f8\u5173 Header \u683c\u5f0f\u5dee\u5f02\u3002</p> <p></p> <p>\u56fe 5\u20113 \u901a\u7528 TLP Header \u7684\u5404\u5b57\u6bb5\u57df</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5232-header","title":"5.2.3.2   \u901a\u7528 Header \u5404\u5b57\u6bb5\u6458\u8981","text":"<p>\u8868 5\u20112 \u4e2d\u5bf9\u901a\u7528 TLP Header \u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u5927\u5c0f\u548c\u7528\u9014\u8fdb\u884c\u4e86\u603b\u7ed3\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u56fe 5\u20113 \u4e2d\u88ab\u6807\u6ce8\u4e3a\u201cR\u201d\u7684\u5b57\u6bb5\u662f\u4fdd\u7559\u5b57\u6bb5\uff08reserve\uff09\uff0c\u5e94\u8be5\u88ab\u7f6e\u4e3a 0\u3002</p> Header \u4e2d\u7684\u5b57\u6bb5\u540d Header \u4e2d\u7684\u4f4d\u7f6e \u5b57\u6bb5\u4f5c\u7528 Fmt[2:0]  \u683c\u5f0f  (Format) Byte  0  Bit  7:5 \u8fd9\u4e9b bit \u7684\u7f16\u7801\u4fe1\u606f\u662f\u5173\u4e8e Header \u7684\u5927\u5c0f\uff0c\u4ee5\u53ca\u8fd9\u4e2a TLP \u4e2d\u662f\u5426\u5b58\u5728\u6570\u636e\u8377\u8f7d\u90e8\u5206\uff1a  000b\uff1a3DW Header\uff0c\u65e0\u6570\u636e\u8377\u8f7d  001b\uff1a4DW Header\uff0c\u65e0\u6570\u636e\u8377\u8f7d  010b\uff1a3DW Header\uff0c\u6709\u6570\u636e\u8377\u8f7d  011b\uff1a4DW Header\uff0c\u6709\u6570\u636e\u8377\u8f7d  100b\uff1a1DW\uff0c\u5c5e\u4e8e Prefix TLP  \u4e0d\u96be\u53d1\u73b0\uff0c\u9664\u4e86 Prefix TLP \u5916\uff0c\u53ea\u8981 Fmt[0]=0 \u90a3\u4e48\u5c31\u662f 3DW Header\uff0c\u53cd\u4e4b\u5219\u4e3a 4DW Header\u3002\u82e5 Fmt[1]=0 \u90a3\u4e48\u5c31\u65e0\u6570\u636e\u8377\u8f7d\uff0c\u53cd\u4e4b\u5219\u6709\u6570\u636e\u8377\u8f7d\u3002  \u5bf9\u4e8e\u4f4e\u4e8e 4GB \u7684\u5730\u5740\uff0c\u5fc5\u987b\u4f7f\u7528 3DW Header\u3002\u534f\u8bae\u89c4\u5b9a\uff0c\u5982\u679c\u4f7f\u7528 4DW Header \u4f46\u662f\u5730\u5740\u5c0f\u4e8e 4GB\uff0c\u4e5f\u5c31\u662f\u8bf4\u5c06 64bit \u5730\u5740\u7684\u9ad8 32bit \u7f6e\u4e3a 0\uff0c\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u4e0b\u63a5\u6536\u65b9\u7684\u884c\u4e3a\u662f\u672a\u8fdb\u884c\u5b9a\u4e49\u7684\uff08undefined\uff09\u3002 Type[4:0]  \u7c7b\u578b Byte  0  Bit  4:0 \u8fd9\u4e9b bit \u7f16\u7801\u7684\u4fe1\u606f\u662f TLP \u7684\u4e0d\u540c\u4e8b\u52a1\u7c7b\u578b\u3002Type \u5b57\u6bb5\u7528\u6765\u8ddf Fmt[1:0]\u5b57\u6bb5\u4e00\u8d77\u6307\u5b9a\u4e86\u4e8b\u52a1\u7c7b\u578b\u3001Header \u5927\u5c0f\u3001\u4ee5\u53ca\u662f\u5426\u5b58\u5728\u6570\u636e\u8377\u8f7d\u3002\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u9605\u201cGeneric Header  Field Details\u201d\u4e00\u8282\u3002 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  (Traffic  Class) Byte  1  Bit  6:4 \u8fd9\u4e9b bit \u8868\u793a\u5c06\u5e94\u7528\u4e8e\u8fd9\u4e2a TLP \u548c\u4e0e\u4e4b\u5b8c\u6210\u76f8\u5173\uff08\u5982\u679c\u9700\u8981\u5b8c\u6210\u5305\uff09\u7684\u6d41\u91cf\u7c7b\u578b\uff1a  000b\uff1aTraffic Class  0\uff08\u9ed8\u8ba4\uff09  001b\uff1aTraffic Class  1  \u2026\u2026  111b\uff1aTraffic Class  7  TC 0 \u662f\u9ed8\u8ba4\u7c7b\u578b\uff0c\u800c TC 1-7 \u662f\u7528\u6765\u63d0\u4f9b\u5dee\u5f02\u5316\u7684\u670d\u52a1\u3002\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u9605\u201cTraffic Class\u201d\u4e00\u8282\u3002 Attr[2]  \u5c5e\u6027  (Attribute) Byte  1  Bit  2 \u8fd9\u4e2a\u7b2c\u4e09\u4f4d\u7684 Attribute \u4f4d\uff08\u5b83\u5171\u6709 3 \u4f4d\uff09\u7528\u4e8e\u8868\u793a\u8fd9\u4e2a TLP \u662f\u5426\u4f7f\u7528\u57fa\u4e8e ID \u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\u201d\u4e00\u8282\u3002 TH  TLP \u5904\u7406\u63d0\u793a  (TLP  Processing Hints) Byte  1  Bit  0 \u5b83\u7528\u4e8e\u8868\u793a\u4f55\u65f6 TLP \u4e2d\u4f1a\u5305\u542b TLP \u63d0\u793a\uff08TLP Hints\uff09\uff0c\u4ee5\u4fbf\u8ba9\u7cfb\u7edf\u4e86\u89e3\u5982\u4f55\u66f4\u597d\u7684\u5904\u7406\u8fd9\u4e2a TLP\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTPH\uff08TLP Processing Hints\uff09\u201d\u3002 TD  TLP \u6458\u8981  (TLP  Digest) Byte  2  Bit  7 \u5982\u679c TD=1\uff0c\u90a3\u4e48\u8fd9\u4e2a TLP \u4e2d\u5c06\u5305\u62ec\u53ef\u9009\u7684 4Byte TLP Digest \u5b57\u6bb5\uff0c\u4e5f\u5c31\u662f ECRC \u503c\u3002  \u5b83\u6709\u4e00\u4e9b\u89c4\u5219\uff1a  \u6240\u6709\u7684\u63a5\u6536\u8005\u90fd\u5fc5\u987b\u8981\u901a\u8fc7\u8fd9\u4e2a bit \u6765\u68c0\u67e5\u662f\u5426\u5b58\u5728 Digest \u5b57\u6bb5\u3002  \u5982\u679c\u4e00\u4e2a TLP \u7684 TD=1\uff0c\u4f46\u662f\u5b83\u53c8\u6ca1\u6709 Digest\uff0c\u90a3\u4e48\u5b83\u5c06\u88ab\u5f53\u505a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u5904\u7406\u3002  \u5982\u679c\u63a5\u6536\u8bbe\u5907\u652f\u6301 ECRC \u6821\u9a8c\uff0c\u4e14\u6b64 TLP \u5185 TD=1\uff0c\u90a3\u4e48\u8fd9\u4e2a\u63a5\u6536\u8bbe\u5907\u5fc5\u987b\u8fdb\u884c\u6821\u9a8c\u3002  \u5982\u679c\u4e00\u4e2a\u4f5c\u4e3a TLP \u6700\u7ec8\u76ee\u7684\u5730\u7684\u8bbe\u5907\u5e76\u4e0d\u652f\u6301 ECRC \u6821\u9a8c\uff08\u56e0\u4e3a\u8fd9\u662f\u53ef\u9009\u529f\u80fd\uff09\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u8981\u5ffd\u7565 Digest \u5b57\u6bb5\u3002  \u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cCRC\u201d\u548c\u201cECRC Generating and Checking\u201d\u8fd9\u4e24\u8282\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  (Poisoned Data) Byte 2  Bit 6 \u5982\u679c EP=1\uff0c\u90a3\u4e48\u5c31\u8ba4\u4e3a\u6240\u6709\u4f34\u968f\u6b64\u6570\u636e\u7684\u6570\u636e\u90fd\u662f\u65e0\u6548\u7684\uff0c\u5c3d\u7ba1\u76f8\u5173\u4e8b\u52a1\u4f9d\u7136\u5141\u8bb8\u6b63\u5e38\u7684\u5b8c\u6210\u3002\u5173\u4e8e Poisoned \u6570\u636e\u5305\u7684\u66f4\u591a\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cData Poisoning\u201d\u4e00\u8282\u3002 Attr[1:0]  \u5c5e\u6027  (Attributes) Byte  2  Bit  5:4 Bit 5 = Relax Ordering\uff08\u5bbd\u677e\u6392\u5e8f\uff09\uff1a\u5f53\u5b83\u88ab\u7f6e\u4e3a 1 \u65f6\uff0c\u8fd9\u4e2a TLP \u4f1a\u542f\u7528 PCI-X \u7684\u5bbd\u677e\u6392\u5e8f\u3002\u5982\u679c\u5b83\u4e3a 0\uff0c\u5219\u662f\u7528 PCI \u7684\u4e25\u683c\u7684 PCI \u6392\u5e8f\uff08strict PCI ordering\uff09\u3002  Bit 4 = No Snoop\uff08\u65e0\u7aa5\u63a2\uff09\uff1a\u5f53\u7f6e\u4e3a 1 \u65f6\uff0cRequester \u7684\u610f\u601d\u662f\u8fd9\u4e2a TLP \u4e0d\u4f1a\u5b58\u5728 host cache \u4e00\u81f4\u6027\u7684\u95ee\u9898\uff08host cache coherency issues\uff09\uff0c\u56e0\u6b64\u7cfb\u7edf\u786c\u4ef6\u53ef\u4ee5\u901a\u8fc7\u8df3\u8fc7\u666e\u901a\u5904\u7406\u5668\u5bf9\u8fd9\u4e2a\u8bf7\u6c42\u7684 cache \u7aa5\u63a2\uff0c\u4ee5\u6b64\u6765\u8282\u7701\u65f6\u95f4\u3002\u800c\u5f53\u8fd9\u4e00\u4f4d\u88ab\u7f6e\u4e3a 0 \u65f6\uff0c\u9700\u8981\u8fdb\u884c PCI-type \u7684 cache \u7aa5\u63a2\u4fdd\u62a4\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  (Address  Type) Byte  2  Bit  3:2 \u5bf9\u4e8e Memory \u548c Atomic \u8bf7\u6c42\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u652f\u6301\u865a\u62df\u5316\u7cfb\u7edf\uff08virtualized system\uff09\u7684\u5730\u5740\u8f6c\u6362\u3002\u8fd9\u4e2a\u5730\u5740\u8f6c\u6362\u534f\u8bae\u7531\u4e00\u4e2a\u5355\u72ec\u7684\u89c4\u8303\u8fdb\u884c\u63cf\u8ff0\uff0c\u88ab\u79f0\u4e3a Address  Translation Services\uff0c\u53ef\u4ee5\u770b\u5230\u8be5\u5b57\u6bb5\u7684\u7f16\u7801\u4e3a\uff1a  00 = \u9ed8\u8ba4/\u672a\u8f6c\u6362\uff08Default/Untranslated\uff09  01 = \u8f6c\u6362\u8bf7\u6c42\uff08Translation Request\uff09  10 = \u5df2\u8f6c\u6362\uff08Translated\uff09  11 = \u4fdd\u7559 reserve Length[9:0]  \u957f\u5ea6 Byte  2  Bit  1:0     Byte  3  Bit  7:0 TLP \u6570\u636e\u8377\u8f7d\u4f20\u8f93\u91cf\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a DW\uff0c\u7f16\u7801\u65b9\u5f0f\u4e3a\uff1a  00 0000 0001b = 1DW  00 0000 0010b = 2DW  \u2026\u2026  11 1111 1111b = 1023DW  00 0000 0000 = 1024DW Last  DW BE[3:0]  \u672b\u5c3e DW \u7684\u5b57\u8282\u4f7f\u80fd  (Last  DW Byte Enable) Byte  7  Bit  7:4 \u8fd9\u4e2a\u5b57\u6bb5\u4e2d\u7684 4 \u4e2a\u9ad8\u6709\u6548\u7684 bit\uff0c\u4e0e\u6570\u636e\u8377\u8f7d\u4e2d\u6700\u540e\u4e00\u4e2a DW \u4e2d\u7684 4 \u4e2a Byte \u4e00\u4e00\u5bf9\u5e94\u3002  Bit 7 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 3 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  Bit 6 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 2 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  Bit 5 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 1 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  Bit 4 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 0 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002 1<sup>st</sup>  DW BE[3:0]  \u7b2c\u4e00\u4e2a DW \u7684\u5b57\u8282\u4f7f\u80fd  (First  DW Byte Enable) Byte  7  Bit  3:0 \u8fd9\u4e2a\u5b57\u6bb5\u4e2d\u7684 4 \u4e2a\u9ad8\u6709\u6548\u7684 bit\uff0c\u4e0e\u6570\u636e\u8377\u8f7d\u4e2d\u7b2c\u4e00\u4e2a DW \u4e2d\u7684 4 \u4e2a Byte \u4e00\u4e00\u5bf9\u5e94\u3002  Bit 3 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 3 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  Bit 2 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 2 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  Bit 1 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 1 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  Bit 0 = 1\uff1a\u672b\u5c3e DW \u7684 Byte 0 \u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002 <p>\u8868 5\u20112 \u901a\u7528 TLP Header \u7684\u5404\u5b57\u6bb5\u6458\u8981</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#524-tlp-header-generic-tlp-header-details","title":"5.2.4     \u901a\u7528 TLP Header \u8be6\u7ec6\u8bf4\u660e\uff08Generic TLP Header Details\uff09","text":"<p>\u5728\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u5bf9\u56fe 5\u20113 \u4e2d\u5c55\u793a\u7684 TLP Header \u7684\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u90fd\u8fdb\u884c\u7ec6\u8282\u63cf\u8ff0\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5241-header-typeformat","title":"5.2.4.1   Header \u7684 Type/Format \u5b57\u6bb5\u7f16\u7801\u542b\u4e49","text":"<p>\u8868 5\u20113 \u4e2d\u603b\u7ed3\u4e86 TLP Header \u4e2d Type \u5b57\u6bb5\u548c Fmt \u5b57\u6bb5\uff08Format\uff09\u7684\u7f16\u7801\u542b\u4e49\u3002</p> TLP \u4e8b\u52a1\u79cd\u7c7b Fmt[2:0] Type[4:0] Memory  Read \u8bf7\u6c42  \uff08MRd\uff09 000=3DW\uff0c\u65e0\u6570\u636e  001=4DW\uff0c\u65e0\u6570\u636e 0 0000 Memory  Read Locked \u8bf7\u6c42  \uff08MRdLk\uff09 000=3DW\uff0c\u65e0\u6570\u636e  001=4DW\uff0c\u65e0\u6570\u636e 0  0001 Memory  Write \u8bf7\u6c42  \uff08MWr\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  0000 IO  Read \u8bf7\u6c42  \uff08IORd\uff09 000=3DW\uff0c\u65e0\u6570\u636e  \uff08IO \u8bf7\u6c42\u4e3a 3DW Header\uff09 0  0010 IO  Write \u8bf7\u6c42  \uff08IOWr\uff09 010=3DW\uff0c\u6709\u6570\u636e  \uff08IO \u8bf7\u6c42\u4e3a 3DW Header\uff09 0  0010 \u914d\u7f6e Type 0 Read \u8bf7\u6c42  \uff08CfgRd0\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  0100 \u914d\u7f6e Type 0 Write \u8bf7\u6c42  \uff08CfgWr0\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  0100 \u914d\u7f6e Type 1 Read \u8bf7\u6c42  \uff08CfgRd1\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  0101 \u914d\u7f6e Type 1 Write \u8bf7\u6c42  \uff08CfgWr1\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  0101 Message \u8bf7\u6c42  \uff08Msg\uff09 001=4DW\uff0c\u65e0\u6570\u636e 1  0 rrr*  \uff08\u89c1\u8868 4\u201110\uff09 Message \u5e26\u6570\u636e\u7684\u8bf7\u6c42  \uff08MsgD\uff09 011=4DW\uff0c\u6709\u6570\u636e 1  0 rrr*  \uff08\u89c1\u8868 4\u201110\uff09 \u5b8c\u6210\u5305 Completion  \uff08Cpl\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  1010 \u5b8c\u6210\u5305\u5e26\u6570\u636e  \uff08CplD\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  1010 \u9501\u5b9a\u7684\u5b8c\u6210\u5305  \uff08CplLk\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  1011 \u9501\u5b9a\u7684\u5b8c\u6210\u5305\u5e26\u6570\u636e  \uff08CplDLk\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  1011 \u83b7\u53d6\u548c\u589e\u52a0\u539f\u5b50\u64cd\u4f5c\u8bf7\u6c42  \uff08Fetch and Add AtomicOP Request\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  1100 \u65e0\u6761\u4ef6\u7684\u4ea4\u6362\u539f\u5b50\u64cd\u4f5c\u8bf7\u6c42  \uff08Unconditional Swap AtomicOP Request\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  1101 \u5bf9\u6bd4\u548c\u4ea4\u6362\u539f\u5b50\u64cd\u4f5c\u8bf7\u6c42  \uff08Compare and Swap AtomicOP Request\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  1110 \u672c\u5730 TLP \u524d\u7f00  \uff08Local TLP Prefix\uff09 100=TLP  Prefix 0L3L2L1L0 \u7aef\u5230\u7aef TLP \u524d\u7f00  \uff08End-to-End TLP Prefix\uff09 100=TLP  Prefix 1E3E2E1E0 <p>\u8868 5\u20113 TLP Header \u7684 Type \u5b57\u6bb5\u548c Fmt \u5b57\u6bb5\u7f16\u7801\u542b\u4e49</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5242-digestecrc","title":"5.2.4.2   Digest/ECRC \u5b57\u6bb5","text":"<p>TLP \u7684 Digest \u4f4d\u8868\u793a\u662f\u5426\u5b58\u5728 ECRC\uff08End-to-End CRC\uff09\u3002\u5982\u679c\u5f53\u524d\u652f\u6301\u8fd9\u4e2a\u53ef\u9009\u7684\u7279\u6027\uff0c\u5e76\u4e14\u8f6f\u4ef6\u4e5f\u542f\u7528\u4e86\u5b83\uff0c\u90a3\u4e48\u8bbe\u5907\u5c06\u4f1a\u7ed9\u81ea\u5df1\u4ea7\u751f\u7684\u6240\u6709 TLP \u90fd\u8ba1\u7b97\u5e76\u4e14\u6dfb\u52a0\u4e0a\u4e00\u4e2a ECRC\u3002\u9700\u8981\u6ce8\u610f\uff0c\u4f7f\u7528 ECRC \u8981\u6c42\u8bbe\u5907\u542b\u6709\u53ef\u9009\u7684 Advanced Error Reporting \u5bc4\u5b58\u5668\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u7684\u80fd\u529b\uff08Capability\uff09\u548c\u63a7\u5236\u5bc4\u5b58\u5668\u5c31\u4f4d\u4e8e Advanced Error Reporting \u5bc4\u5b58\u5668\u4e2d\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-ecrc","title":"l ECRC \u7684\u751f\u6210\u548c\u68c0\u67e5","text":"<p>ECRC \u8986\u76d6\u4e86\u6240\u6709\u5728\u8de8 Fabric \u8f6c\u53d1\u65f6\u4e0d\u9700\u8981\u66f4\u6539\u7684\u5b57\u6bb5\u3002\u7136\u800c\uff0c\u5f53\u4e00\u4e2a\u6570\u636e\u5305\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u79fb\u52a8\u65f6\uff0c\u6709\u4e24\u4e2a bit \u662f\u53ef\u4ee5\u5408\u6cd5\u7684\u8fdb\u884c\u6539\u53d8\u7684\uff1a</p> <ul> <li> <p>Type \u5b57\u6bb5\u7684 Bit 0\uff1a\u5728\u4e00\u4e2a\u914d\u7f6e\u4e8b\u52a1\u901a\u8fc7\u4e00\u4e2a Bridge \u65f6\uff0c\u8fd9\u4e2a\u914d\u7f6e\u4e8b\u52a1\u6709\u53ef\u80fd\u4ece Type 1 \u53d8\u6210 Type 0\uff0c\u56e0\u4e3a\u8fd9\u4e2a Bridge \u7684\u6b21\u7ea7\u603b\u7ebf\u6709\u53ef\u80fd\u5c31\u662f\u914d\u7f6e\u4e8b\u52a1\u7684\u76ee\u6807\u603b\u7ebf\u3002\u5728\u8fd9\u4e2a\u60c5\u51b5\u4e0b\uff0cType \u5730\u6bb5\u7684 bit 0 \u7684\u503c\u5c31\u4f1a\u4ece 1 \u53d8\u6210 0\u3002</p> </li> <li> <p>EP\uff08Error/Poisoned\uff09bit\uff1a\u5f53\u4e00\u4e2a TLP \u5728\u7f51\u7edc\u7ed3\u6784\u4e2d\u79fb\u52a8\u65f6\uff0c\u5982\u679c\u4e0e\u8fd9\u4e2a\u6570\u636e\u5305\u76f8\u5173\u7684\u6570\u636e\u88ab\u8ba4\u4e3a\u662f\u635f\u574f\u7684\uff0c\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u5f15\u53d1\u8fd9\u4e2a bit \u503c\u7684\u6539\u53d8\u3002\u8fd9\u662f\u4e00\u79cd\u53ef\u9009\u7684\u7279\u6027\uff0c\u79f0\u4e3a\u9519\u8bef\u8f6c\u53d1\uff08error forwarding\uff09\u3002</p> </li> </ul>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-ecrc_1","title":"l \u8c01\u6765\u68c0\u67e5 ECRC","text":"<p>ECRC \u7684\u9884\u5b9a\u76ee\u6807\u662f TLP \u7684\u6700\u7ec8\u63a5\u6536\u8005\u3002\u5bf9 LCRC\uff08Link CRC\uff09\u7684\u6821\u9a8c\u662f\u7528\u6765\u9a8c\u8bc1\u5728\u5f53\u524d\u7ed9\u5b9a\u94fe\u8def\u4e0a\u7684\u4f20\u8f93\u6ca1\u6709\u51fa\u9519\uff0c\u4f46\u662f\u4f1a\u5728 Switch/Bridge \u7684\u51fa\u53e3\u7aef\u53e3\uff08egress port\uff09\u91cd\u65b0\u8ba1\u7b97\u4e00\u4e2a LCRC\uff0c\u7136\u540e\u518d\u8f6c\u53d1\u7ed9\u4e0b\u4e00\u7ea7\u94fe\u8def\uff0c\u4e5f\u5c31\u662f\u8bf4\u540c\u4e00\u4e2a LCRC \u7684\u4f5c\u7528\u8303\u56f4\u4e0d\u4f1a\u8de8 Switch/Bridge\uff0c\u90a3\u4e48\u8fd9\u5c06\u4f1a\u4f7f\u5f97 Switch/Bridge \u8fd9\u4e9b\u8def\u7531\u5143\u4ef6\u5185\u90e8\u53d1\u751f\u7684\u9519\u8bef\u88ab\u63a9\u76d6\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5c31\u5728 TLP \u5728 Requester \u5230 Completer \u7684\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u90fd\u52a0\u4e0a\u4e00\u4e2a\u4e0d\u4f1a\u6539\u53d8\u7684 ECRC\uff08\u4e5f\u5c31\u662f\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d ECRC \u90fd\u4e0d\u4f1a\u88ab\u5176\u4ed6\u8bbe\u5907\u91cd\u65b0\u8ba1\u7b97\u548c\u66ff\u6362\uff09\u3002\u5f53\u76ee\u6807\u8bbe\u5907\u68c0\u67e5 ECRC \u65f6\uff0c\u4efb\u4f55\u5728\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u53d1\u751f\u7684\u9519\u8bef\u90fd\u4f1a\u6781\u5bb9\u6613\u88ab\u53d1\u73b0\u3002</p> <p>\u5173\u4e8e ECRC \u6821\u9a8c\u4e2d Switch \u7684\u4f5c\u7528\uff0cPCIe \u534f\u8bae\u505a\u4e86\u4e24\u4e2a\u58f0\u660e\uff1a</p> <ul> <li> <p>\u5982\u679c\u4e00\u4e2a Switch \u652f\u6301 ECRC \u6821\u9a8c\uff0c\u90a3\u4e48\u5b83\u9700\u8981\u5bf9 TLP \u76ee\u7684\u5730\u4e3a Switch \u81ea\u8eab\u65f6\uff0c\u5bf9\u8fd9\u4e2a TLP \u4e2d\u7684 ECRC \u8fdb\u884c\u6821\u9a8c\u3002\u5982\u679c TLP \u7684\u76ee\u7684\u5730\u5e76\u4e0d\u662f Switch \u81ea\u8eab\uff0c\u90a3\u4e48 Switch \u5fc5\u987b\u5728\u4fdd\u6301 ECRC \u4e0d\u53d8\u7684\u524d\u63d0\u4e0b\u5bf9\u5176\u8fdb\u884c\u8f6c\u53d1\uff0c\u628a ECRC \u4f5c\u4e3a TLP \u4e0d\u53ef\u5206\u5272\u7684\u4e00\u90e8\u5206\u3002\u201cOn all other TLPs a Switch must preserve the ECRC (forward it untouched) as an integral part of the TLP.\u201d</p> </li> <li> <p>\u6ce8\u610f\uff0cSwitch \u4e5f\u53ef\u4ee5\u5bf9\u901a\u8fc7\u5b83\u7684 TLP \u8fdb\u884c ECRC \u68c0\u67e5\u3002\u7531 Switch \u53d1\u73b0\u7684 ECRC \u9519\u8bef\u7684\u62a5\u544a\u65b9\u6cd5\u548c\u5176\u4ed6\u8bbe\u5907\u4e00\u6837\uff0c\u4f46\u662f\u8fd9\u4e0d\u4f1a\u6539\u53d8 TLP \u901a\u8fc7 Switch \u7684\u7ee7\u7eed\u4f20\u8f93\u3002\u201cNote that a Switch may perform ECRC checking on TLPs passing through the Switch. ECRC Errors detected by the Switch are reported in the same way any other device would report them, but do not alter the TLPs passage through the Switch.\u201d</p> </li> </ul>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5243-using-byte-enables","title":"5.2.4.3   \u4f7f\u7528\u5b57\u8282\u4f7f\u80fd\uff08Using Byte Enables\uff09","text":""},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l","title":"l \u6574\u4f53\u8bf4\u660e","text":"<p>\u7c7b\u4f3c PCI \u4e00\u6837\uff0c\u5bf9\u4e8e\u6709\u65f6\u4f20\u8f93\u5927\u5c0f\u6216\u8005\u8d77\u59cb/\u7ed3\u675f\u5730\u5740\u4e0d\u662f DW \u5bf9\u9f50\u65f6\uff0cPCIe \u4e5f\u9700\u8981\u4e00\u79cd\u673a\u5236\u6765\u6839\u636e\u9700\u8981\u534f\u8c03\u5176 DW \u5bf9\u9f50\u5730\u5740\u3002\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0cPCIe \u5229\u7528\u4e86 2 \u4e2a\u5b57\u8282\u4f7f\u80fd\uff08Byte Enable\uff09\u5b57\u6bb5\uff0c\u5982\u56fe 5\u20113 \u4e2d\u548c\u8868 5\u20112 \u4e2d\u6240\u4ecb\u7ecd\uff0c\u5206\u522b\u662f\u9996 DW \u5b57\u8282\u4f7f\u80fd\uff08First DW Byte Enable\uff09\u548c\u5c3e DW \u5b57\u8282\u4f7f\u80fd\uff08Last DW Byte Enable\uff09\uff0c\u5b83\u4eec\u4f7f\u5f97 Requester \u53ef\u4ee5\u5bf9\u7b2c\u4e00\u4e2a DW \u548c\u6700\u540e\u4e00\u4e2a DW \u771f\u6b63\u6709\u6548\u4f20\u8f93\u7684\u5b57\u8282\u8fdb\u884c\u9650\u5b9a\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l_1","title":"l \u5b57\u8282\u4f7f\u80fd\u89c4\u5219","text":"<ol> <li> <p>\u5b57\u8282\u4f7f\u80fd\u5730\u5404\u4e2a bit \u662f\u9ad8\u6709\u6548\u7684\u3002\u5982\u679c\u67d0\u4e2a\u5b57\u8282\u4f7f\u80fd bit \u503c\u4e3a 0\uff0c\u90a3\u4e48\u5c31\u8868\u793a\u6570\u636e\u8377\u8f7d\u4e2d\u76f8\u5e94\u7684\u5b57\u8282\u4e0d\u5e94\u8be5\u88ab Completer \u4f7f\u7528\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5b57\u8282\u662f\u65e0\u6548\u7684\u3002\u82e5\u67d0\u4e2a\u5b57\u8282\u4f7f\u80fd bit \u503c\u4e3a 1\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u76f8\u5e94\u7684\u5b57\u8282\u5e94\u8be5\u88ab Completer \u4f7f\u7528\u3002</p> </li> <li> <p>\u5982\u679c\u6709\u6548\u7684\u6570\u636e\u5168\u90fd\u5728\u4e00\u4e2a\u5355\u72ec\u7684 DW \u4e2d\uff0c\u90a3\u4e48\u5c3e DW \u5b57\u8282\u4f7f\u80fd\uff08Last DW Byte Enable\uff09\u5fc5\u987b\u4e3a 0000b\u3002</p> </li> <li> <p>\u5982\u679c Header \u4e2d\u7684 Length \u5b57\u6bb5\u8868\u793a\u4e86\u8fd9\u6b21\u4f20\u8f93\u6570\u636e\u91cf\u5927\u4e8e 1DW\uff0c\u90a3\u4e48\u9996 DW \u5b57\u8282\u4f7f\u80fd\uff08First DW Byte Enable\uff09\u81f3\u5c11\u8981\u6709 1 \u4e2a bit \u662f\u6709\u6548\u7684\u3002</p> </li> <li> <p>\u5982\u679c Header \u4e2d\u7684 Length \u5b57\u6bb5\u8868\u793a\u4e86\u8fd9\u6b21\u4f20\u8f93\u6570\u636e\u91cf\u5927\u4e8e\u7b49\u4e8e 3DW\uff0c\u90a3\u4e48\u9996 DW \u5b57\u8282\u4f7f\u80fd\u548c\u5c3e DW \u5b57\u8282\u4f7f\u80fd\u90fd\u5fc5\u987b\u662f\u76f8\u8fde\u7684 bit \u4e3a 1\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e2d\uff0c\u5b57\u8282\u4f7f\u80fd\u4ec5\u80fd\u7528\u6765\u63d0\u4f9b\u6709\u6548\u8d77\u59cb\u5730\u5740\u548c\u7ed3\u675f\u5730\u5740\u4e0e DW \u5bf9\u9f50\u5730\u5740\u7684\u5b57\u8282\u504f\u79fb\u91cf\u3002</p> </li> <li> <p>\u5982\u679c\u4f20\u8f93\u6570\u636e\u91cf\u5927\u5c0f\u4e3a 1DW\uff0c\u90a3\u4e48\u624d\u80fd\u5141\u8bb8\u53ea\u6709\u9996 DW \u5b57\u8282\u4f7f\u80fd\u5185\u662f\u4e0d\u8fde\u7eed\u4e3a 1 \u7684\u60c5\u51b5\u3002</p> </li> <li> <p>\u5982\u679c\u4f20\u8f93\u6570\u636e\u91cf\u5927\u5c0f\u4e3a 1-2DW\uff0c\u90a3\u4e48\u624d\u80fd\u5141\u8bb8\u9996 DW \u5b57\u8282\u4f7f\u80fd\u548c\u7b2c\u4e8c DW \u5b57\u8282\u4f7f\u80fd\u5185\u90fd\u662f\u4e0d\u8fde\u7eed\u4e3a 1 \u7684\u60c5\u51b5\u3002</p> </li> <li> <p>\u5982\u679c\u4e00\u4e2a\u5199\u8bf7\u6c42\uff0c\u5176 Length \u5b57\u6bb5\u8868\u793a\u5176\u6570\u636e\u4f20\u8f93\u957f\u5ea6\u4e3a 1DW\uff0c\u4f46\u662f\u5b83\u7684\u5b57\u8282\u4f7f\u80fd\u5747\u4e3a\u65e0\u6548\uff0c\u8fd9\u79cd\u60c5\u51b5\u5bf9 Completer \u4e0d\u4f1a\u6709\u5f71\u54cd\u3002</p> </li> <li> <p>\u5982\u679c\u4e00\u4e2a\u8bfb\u8bf7\u6c42\uff0c\u5176 Length \u5b57\u6bb5\u8868\u793a\u5176\u9700\u8981\u7684\u6570\u636e\u4f20\u8f93\u957f\u5ea6\u4e3a 1DW\uff0c\u4f46\u662f\u6ca1\u6709\u5b57\u8282\u4f7f\u80fd\u6709\u6548\uff0c\u90a3\u4e48 Completer \u4f1a\u8fd4\u56de\u4e00\u4e2a 1DW \u6570\u636e\u8377\u8f7d\uff0c\u8fd9\u79cd\u6570\u636e\u8377\u8f7d\u662f\u672a\u5b9a\u4e49\u6570\u636e\uff08undefined data\uff09\u3002\u8fd9\u79cd\u60c5\u51b5\u53ef\u80fd\u88ab\u7528\u4f5c\u4e00\u79cd\u5237\u65b0\u673a\u5236\uff08Flush mechanism\uff09\uff0c\u5b83\u5229\u7528\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\uff0c\u5728\u8fd9\u4e2a undefine data \u7684\u8bfb\u8bf7\u6c42\u5b8c\u6210\u5305\u8fd4\u56de\u4e4b\u524d\uff0c\u5f3a\u5236\u4e4b\u524d\u53d1\u51fa\u7684\u6240\u6709 posted write \u8f93\u51fa\u5230\u5185\u5b58\u4e2d\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l_2","title":"l \u5b57\u8282\u4f7f\u80fd\u793a\u4f8b","text":"<p>\u5982\u56fe 5\u20114 \u5c55\u793a\u4e86\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u662f\u5982\u4f55\u4f7f\u7528\u7684\u3002\u6ce8\u610f\uff0c\u6570\u636e\u4f20\u8f93\u957f\u5ea6\u5fc5\u987b\u4ece\u7b2c\u4e00\u4e2a DW \u4e2d\u7684\u4efb\u4f55\u6709\u6548\u5b57\u8282\u5ef6\u4f38\u81f3\u6700\u540e\u4e00\u4e2a DW \u4e2d\u7684\u4efb\u4f55\u6709\u6548\u5b57\u8282\u3002\u56e0\u4e3a\u6570\u636e\u4f20\u8f93\u91cf\u5927\u4e8e 2DW\uff0c\u5b57\u8282\u4f7f\u80fd\u5c31\u53ea\u80fd\u7528\u6765\u6807\u8bc6\u8fd9\u6b21\u4f20\u8f93\u4e2d\u8d77\u59cb\u5730\u5740\u7684\u4f4d\u7f6e\uff082d\uff09\u548c\u7ed3\u675f\u5730\u5740\u7684\u4f4d\u7f6e\uff0834d\uff09\u3002</p> <p></p> <p>\u56fe 5\u20114 \u9996 DW \u5b57\u8282\u4f7f\u80fd\u548c\u5c3e DW \u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u7684\u4f7f\u7528</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5244-transaction-descriptor-fields","title":"5.2.4.4   \u4e8b\u52a1\u63cf\u8ff0\u7b26\u5b57\u6bb5\uff08Transaction Descriptor Fields\uff09","text":"<p>\u5f53\u4e8b\u52a1\u5728 Requester \u548c Completer \u4e4b\u95f4\u79fb\u52a8\u65f6\uff0c\u5fc5\u987b\u8981\u80fd\u591f\u5bf9\u5404\u4e2a\u4e8b\u52a1\u8fdb\u884c\u552f\u4e00\u7684\u6807\u8bc6\uff0c\u56e0\u4e3a\u5728\u4efb\u4f55\u65f6\u523b\u7684 Requester \u4e2d\u90fd\u6709\u53ef\u80fd\u6709\u8bb8\u591a\u7684\u62c6\u5206\u4e8b\u52a1\u5728\u6392\u961f\u3002\u4e3a\u4e86\u66f4\u597d\u7684\u8fdb\u884c\u6807\u8bc6\uff0cPCIe \u534f\u8bae\u5728 TLP Header \u4e2d\u5b9a\u4e49\u4e86\u591a\u4e2a\u91cd\u8981\u5b57\u6bb5\uff0c\u6765\u7ec4\u6210\u4e00\u4e2a\u552f\u4e00\u7684\u4e8b\u52a1\u63cf\u8ff0\u7b26\uff08Transaction Descriptor\uff09\uff0c\u5982\u56fe 5\u20115 \u6240\u793a\u3002</p> <p></p> <p>\u56fe 5\u20115 \u4e8b\u52a1\u63cf\u8ff0\u7b26\u5b57\u6bb5</p> <p>\u867d\u7136\u4e8b\u52a1\u63cf\u8ff0\u7b26\u5728 TLP Header \u4e2d\u5e76\u4e0d\u662f\u4f4d\u7f6e\u5168\u8fde\u7eed\u7684\u5b57\u6bb5\uff0c\u4f46\u662f\u8fd9\u4e9b\u4e0d\u8fde\u7eed\u5b57\u6bb5\u5408\u8d77\u6765\u53ef\u4ee5\u4e00\u8d77\u63cf\u8ff0\u4e8b\u52a1\u7684\u5173\u952e\u5c5e\u6027\uff0c\u5305\u62ec\uff1a</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-idtransaction-id","title":"l \u4e8b\u52a1 ID\uff08Transaction ID\uff09","text":"<p>\u4e8b\u52a1 ID \u7531 Requester ID\uff08Requester \u7684 BDF\uff09\u548c TLP \u7684 Tag \u5b57\u6bb5\u5171\u540c\u7ec4\u6210\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-traffic-class","title":"l \u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff09","text":"<p>\u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff0cTC\uff09\u662f\u7531 Requester \u7684 Device Core \u6765\u6dfb\u52a0\u8fdb TLP \u7684\uff0c\u5e76\u4e14\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u4ece Requester \u4f20\u8f93\u5230 Completer \u7684\u8fc7\u7a0b\u4e2d TC \u90fd\u4e0d\u53d1\u751f\u6539\u53d8\u3002\u5728\u62d3\u6251\u7ed3\u6784\u7684\u6bcf\u4e2a\u94fe\u8def\u4e2d\uff0cTC \u90fd\u6620\u5c04\u5230\u5176\u4e2d\u4e00\u4e2a\u865a\u62df\u901a\u9053\uff08Virtual Channel\uff09\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-transaction-attributes","title":"l \u4e8b\u52a1\u5c5e\u6027\uff08Transaction Attributes\uff09","text":"<p>\u7528\u4e8e\u8868\u793a\u57fa\u4e8e ID \u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3001\u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09\u4ee5\u53ca\u65e0\u7aa5\u63a2\uff08No Snoop\uff09\u7684 bit \u4e5f\u5b58\u5728\u4e8e\u8bf7\u6c42\u5305\u4e2d\uff0c\u88ab\u53d1\u9001\u7ed9 Completer\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5245-tlp","title":"5.2.4.5   \u5e26\u6709\u6570\u636e\u8377\u8f7d\u7684 TLP \u7684\u4e00\u4e9b\u989d\u5916\u89c4\u5219","text":"<p>\u5f53\u4e00\u4e2a TLP \u5e26\u6709\u6570\u636e\u8377\u8f7d\u65f6\uff0c\u5c31\u8981\u9075\u4ece\u5982\u4e0b\u89c4\u5219\uff1a</p> <ol> <li> <p>Length \u5b57\u6bb5\u4ec5\u8868\u793a\u6570\u636e\u8377\u8f7d\u7684\u957f\u5ea6\u3002</p> </li> <li> <p>\u6570\u636e\u8377\u8f7d\u7684\u9996\u5b57\u8282\uff08\u7d27\u6328\u7740 Header \u7684\u5b57\u8282\uff09\u7684\u5730\u5740\u6c38\u8fdc\u662f\u6700\u4f4e\u4f4d\u7684\u3002</p> </li> <li> <p>Length \u5b57\u6bb5\u6c38\u8fdc\u8868\u793a\u7684\u662f\u6574\u6570 DW \u7684\u4f20\u8f93\u957f\u5ea6\u3002\u5bf9\u4e8e\u4e0d\u6ee1\u6574\u6570 DW \u7684\u60c5\u51b5\u662f\u4f7f\u7528\u9996 DW \u5b57\u8282\u4f7f\u80fd\u548c\u5c3e DW \u5b57\u8282\u4f7f\u80fd\u6765\u8fdb\u884c\u8868\u793a\u7684\u3002</p> </li> <li> <p>\u5728\u534f\u8bae\u4e2d\u6709\u58f0\u660e\uff0c\u5f53\u4e00\u4e2a Completer \u5728\u54cd\u5e94\u4e00\u4e2a\u5355\u72ec\u7684 Memory \u8bf7\u6c42\u65f6\u5982\u679c\u8fd4\u56de\u4e86\u591a\u4e2a TLP\uff0c\u90a3\u4e48\u4e2d\u95f4\u7684\uff08\u4e5f\u5c31\u662f\u975e\u9996\u5c3e\u7684\uff09TLP \u7684\u6570\u636e\u8377\u8f7d\u7684\u5730\u5740\u5fc5\u987b\u7ed3\u675f\u4e8e RC \u7684 64byte \u6216 128byte \u81ea\u7136\u5bf9\u9f50\u7684\u8fb9\u754c\u4e0a\u3002\u5177\u4f53\u662f\u90a3\u79cd\u8fb9\u754c\u662f\u7531\u4e00\u4e2a\u53ef\u914d\u7f6e\u4f4d\u79f0\u4e3a RCB\uff08\u8bfb\u5b8c\u6210\u8fb9\u754c\uff0cRead Completion Boundary\uff09\u6765\u63a7\u5236\u7684\u3002\u6240\u6709\u7684\u5176\u4ed6\u8bbe\u5907\u9075\u5faa PCI-X \u534f\u8bae\uff0c\u5e76\u4f1a\u5c06\u8fd9\u79cd\u60c5\u51b5\u7684 TLP \u622a\u65ad\u5728 128byte \u81ea\u7136\u5bf9\u9f50\u8fb9\u754c\u4e0a\u3002</p> </li> <li> <p>\u5f53\u53d1\u9001 Message \u8bf7\u6c42\u65f6\uff0cLength \u5b57\u6bb5\u662f\u4fdd\u7559\u5b57\u6bb5\uff0c\u9664\u975e Message \u662f\u5e26\u6709\u6570\u636e\u8377\u8f7d\u7684\uff0c\u4e5f\u5c31\u662f MsgD\u3002</p> </li> <li> <p>TLP \u7684\u6570\u636e\u8377\u8f7d\u4e00\u5b9a\u4e0d\u80fd\u5927\u4e8e\u8bbe\u5907\u63a7\u5236\u5bc4\u5b58\u5668\uff08Device Control Register\uff09\u4e2d\u7684\u6700\u5927\u6570\u636e\u8377\u8f7d\u5b57\u6bb5\uff08Max_Payload_Size\uff09\u3002\u56e0\u4e3a\u53ea\u6709\u5199\u4e8b\u52a1\u4f1a\u5e26\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64\u8fd9\u79cd\u9650\u5236\u5e76\u4e0d\u5e94\u7528\u4e8e\u8bfb\u8bf7\u6c42\u3002\u63a5\u6536\u65b9\u9700\u8981\u5728\u88ab\u5199\u5165\u65f6\u68c0\u67e5\u662f\u5426\u5b58\u5728 Max_Payload_Size \u7684\u8fdd\u4f8b\uff0c\u5982\u679c\u5b58\u5728\u5219\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>\u63a5\u6536\u65b9\u8fd8\u9700\u8981\u68c0\u67e5 Length \u5b57\u6bb5\u548c TLP \u5b9e\u9645\u4f20\u8f93\u7684\u6570\u636e\u8377\u8f7d\u957f\u5ea6\u3002\u5982\u679c\u4e8c\u8005\u4e0d\u76f8\u540c\u5219\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>\u8bf7\u6c42\u5305\u4e2d\u7684\u8d77\u59cb\u5730\u5740\u548c\u4f20\u8f93\u957f\u5ea6\u7684\u7ec4\u5408\u4fe1\u606f\uff0c\u4e00\u5b9a\u4e0d\u80fd\u9020\u6210\u8de8 4KB \u8fb9\u754c\u7684 Memory \u8bbf\u95ee\u3002\u867d\u7136\u8fd9\u79cd\u68c0\u67e5\u662f\u53ef\u9009\u7684\uff0c\u4f46\u662f\u4e00\u65e6\u53d1\u73b0\u4e86\u8de8 4KB \u8fb9\u754c\u8bbf\u95ee\u7684\u60c5\u51b5\u5c31\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#525-tlp-tlp-tlp","title":"5.2.5     \u5177\u4f53\u7684 TLP \u683c\u5f0f\uff1a\u8bf7\u6c42 TLP \u548c\u5b8c\u6210 TLP","text":"<p>\u5728\u672c\u8282\u4e2d\uff0c\u5c06\u4f1a\u63cf\u8ff0\u7528\u6765\u6784\u6210\u5177\u4f53\u7684\u4e00\u4e9b\u4e8b\u7269\u7c7b\u578b\u7684 TLP 3DW Header \u548c 4DW Header\u3002\u8bb8\u591a\u901a\u7528\u7684\u5b57\u6bb5\u5c31\u5982\u524d\u6587\u6240\u8ff0\uff0c\u56e0\u6b64\u6211\u4eec\u628a\u91cd\u70b9\u653e\u5728\u90a3\u4e9b\u9700\u8981\u6839\u636e\u5177\u4f53\u4e8b\u52a1\u7c7b\u578b\u8fdb\u884c\u5177\u4f53\u5904\u7406\u7684\u5b57\u6bb5\u4e0a\u3002\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u662f\u5173\u4e8e TLP Header \u7684\u8be6\u7ec6\u63cf\u8ff0\uff0c\u76f8\u5173\u7684 TLP \u7c7b\u578b\u4e3a\uff1a1\uff09IO Request\uff0c2\uff09Memory Requests\uff0c3\uff09Configuration Requests\uff0c4\uff09Completions\uff0c\u4ee5\u53ca 5\uff09Message Request\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5251-io-io-request","title":"5.2.5.1   IO \u8bf7\u6c42\uff08IO Request\uff09","text":"<p>\u867d\u7136\u534f\u8bae\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528 IO \u4e8b\u52a1\uff0c\u4f46\u662f\u5bf9\u4e8e\u4f20\u7edf\u9057\u7559\u8bbe\u5907\u8fd8\u662f\u5141\u8bb8\u7684\uff0c\u5e76\u4e14\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u9700\u8981\u901a\u8fc7 IO \u4e8b\u52a1\u6765\u517c\u5bb9\u90a3\u4e9b\u5b58\u5728\u7cfb\u7edf IO \u6620\u5c04\u800c\u4e0d\u662f\u5185\u5b58\u6620\u5c04\u7684\u8bbe\u5907\u3002\u867d\u7136 IO \u4e8b\u52a1\u4ece\u6280\u672f\u4e0a\u8bb2\u662f\u53ef\u4ee5\u8bbf\u95ee 32bit IO \u8303\u56f4\u7684\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8bb8\u591a\u7cfb\u7edf\uff08\u548c CPU\uff09\u90fd\u4f1a\u5c06 IO \u8bbf\u95ee\u9650\u5236\u5728\u4f4e 16bit\uff0864KB\uff09\u8303\u56f4\u5185\u3002\u56fe 5\u20116 \u5c55\u793a\u4e86\u7cfb\u7edf IO \u6620\u5c04\u4ee5\u53ca 16bit \u548c 32bit \u5730\u5740\u8fb9\u754c\u3002\u81ea\u8eab\u4e0d\u662f\u4f20\u7edf\u9057\u7559\u8bbe\u5907\u7684\u8bbe\u5907\u662f\u4e0d\u5141\u8bb8\u8bbf\u95ee BAR \u4e2d\u7684 IO \u5730\u5740\u7a7a\u95f4\u7684\u3002</p> <p></p> <p>\u56fe 5\u20116 \u7cfb\u7edf IO \u6620\u5c04</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-io-request-header","title":"l IO Request Header \u7684\u683c\u5f0f","text":"<p>\u5982\u56fe 5\u20117 \u6240\u793a\u662f\u4e00\u4e2a 3DW IO Request Header\uff0c\u5176\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u4f1a\u5728\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u4e2d\u8fdb\u884c\u63cf\u8ff0\u3002</p> <p></p> <p>\u56fe 5\u20117 3DW IO Request Header \u683c\u5f0f</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-io-request-header_1","title":"l IO Request Header \u5404\u5b57\u6bb5","text":"<p>\u4e00\u4e2a IO Request Header \u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20114 \u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8e Header \u4e2d\u7684 Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 IO \u8bf7\u6c42\u7684\u5305\u683c\u5f0f\u5b57\u6bb5\uff1a  000b=IO  Read\uff083DW\uff0c\u65e0\u6570\u636e\uff09  010b=IO  Write\uff083DW\uff0c\u6709\u6570\u636e\uff09 Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 0010b=IO \u8bf7\u6c42 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 IO \u8bf7\u6c42\u7684 TC \u6c38\u8fdc\u4e3a 0\uff0c\u786e\u4fdd\u8fd9\u4e9b\u5305\u6c38\u8fdc\u4e0d\u4f1a\u5e72\u6270\u9ad8\u4f18\u5148\u7ea7\u7684\u5305\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u7531\u4e8e IO \u8bf7\u6c42\u4e0d\u4f7f\u7528\u57fa\u4e8e ID \u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 TH  TLP \u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u7531\u4e8e IO \u8bf7\u6c42\u4e0d\u4f7f\u7528 TLP \u5904\u7406\u63d0\u793a\uff08TLP Processing Hints\uff09\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 TD  TLP \u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u8868\u793a TLP \u7684\u672b\u5c3e\u662f\u5426\u5b58\u5728 Digest \u5b57\u6bb5\uff0c\u4e5f\u5c31\u662f ECRC\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u8868\u793a TLP \u7684\u6570\u636e\u8377\u8f7d\uff08\u5982\u679c\u6709\uff09\u662f\u5426\u88ab\u6c61\u67d3\uff08poisoned\uff09\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 \u7531\u4e8e IO \u8bf7\u6c42\u4e0d\u4f7f\u7528\u5bbd\u677e\u6392\u5e8f\uff08Relaxed  Ordering\uff09\u548c\u65e0\u7aa5\u63a2\uff08No Snoop\uff09\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u4e3a 0\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u7531\u4e8e IO \u8bf7\u6c42\u4e0d\u4f7f\u7528\u5730\u5740\u7c7b\u578b\u5b57\u6bb5\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a 0\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u8be5\u5b57\u6bb5\u7528\u6765\u8868\u793a\u4ee5 DW \u4e3a\u5355\u4f4d\u7684\u6570\u636e\u8377\u8f7d\u5927\u5c0f\u3002\u5bf9\u4e8e IO \u8bf7\u6c42\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u4e3a 1\uff0c\u56e0\u4e3a IO \u8bf7\u6c42\u4e0d\u80fd\u4f20\u8f93\u8d85\u8fc7 4Byte\u3002\u7531\u9996 DW \u5b57\u8282\u4f7f\u80fd\u6765\u9650\u5b9a\u4f7f\u7528\u54ea\u4e2a Byte\u3002 Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u76f8\u5e94\u5b8c\u6210\u5305\u7684\u201c\u8fd4\u56de\u5730\u5740\u201d\u3002  Byte 4,7:0=Bus  Number  Byte 5,7:3=Device  Number  Byte 5,2:0=Function  Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u6765\u6807\u8bc6\u6765\u81ea Requester \u7684\u5177\u4f53\u6bcf\u4e2a\u8bf7\u6c42\u3002\u6bcf\u4e2a\u88ab\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684 Tag \u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u4f7f\u7528 Tag[4:0]\uff0c\u4f46\u662f\u6269\u5c55 Tag\uff08Extended Tag\uff09\u548c Phantom Function \u53ef\u9009\u9879\u53ef\u4ee5\u5c06 Tag \u7684\u4f7f\u7528\u6269\u5c55\u4e3a Tag[10:0]\uff0c\u8fd9\u6837\u5c31\u5141\u8bb8\u591a\u8fbe 2048 \u4e2a\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u540c\u65f6\u8fdb\u884c\u3002 Last  DW BE[3:0]  \u5c3e DW \u5b57\u8282\u4f7f\u80fd Byte  7 Bit 7:4 \u56e0\u4e3a IO \u8bf7\u6c42\u6570\u636e\u5927\u5c0f\u53ea\u80fd\u662f 1DW \u4ee5\u5185\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a 0000b\u3002 1<sup>st</sup>  DW BE[3:0]  \u9996 DW \u5b57\u8282\u4f7f\u80fd Byte  7 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u7b2c\u4e00\u4e2a DW \u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002\u5bf9\u4e8e IO \u8bf7\u6c42\u6765\u8bf4\uff0c\u6240\u6709\u7684 bit \u7ec4\u5408\u90fd\u662f\u5141\u8bb8\u7684\uff08\u5305\u62ec 0000b\uff09\u3002 Address[31:2]  \u5730\u5740 Byte  8 Bit 7:0  Byte  9 Bit 7:0  Byte  10 Bit 7:0  Byte  11 Bit 7:2 \u8be5\u5b57\u6bb5\u662f 32bit \u8d77\u59cb\u5730\u5740\u7684\u9ad8 30bit\u3002\u800c\u6700\u4f4e 2bit \u662f\u4fdd\u7559\u4f4d\uff0800b\uff09\uff0c\u8fd9\u4f7f\u5f97 32bit \u8d77\u59cb\u5730\u5740\u4e00\u5b9a\u662f DW \u5bf9\u9f50\u7684\u3002 <p>\u8868 5\u20114 IO Request Header \u5404\u5b57\u6bb5</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5252-memory-memory-request","title":"5.2.5.2   Memory \u8bf7\u6c42\uff08Memory Request\uff09","text":"<p>PCIe \u7684 Memory \u4e8b\u52a1\u5305\u542b\u4e24\u79cd\u7c7b\u578b\uff1a\u7b2c\u4e00\u79cd\u662f\u8bfb\u8bf7\u6c42\u53ca\u5176\u76f8\u5bf9\u5e94\u7684\u5b8c\u6210\u5305\uff0c\u7b2c\u4e8c\u79cd\u662f\u5199\u8bf7\u6c42\u3002\u7cfb\u7edf\u5185\u5b58\u6620\u5c04\u5982\u6240\u793a\uff0c\u5c55\u793a\u4e86 3DW \u4e0e 4DW \u7684 Memory \u8bf7\u6c42\u5305\u3002\u9700\u8981\u8bb0\u4f4f\u534f\u8bae\u89c4\u8303\u4e2d\u591a\u6b21\u91cd\u7533\u7684\u4e00\u70b9\uff0cMemory \u4f20\u8f93\u7edd\u5bf9\u4e0d\u5141\u8bb8\u8de8 4KB \u5730\u5740\u8fb9\u754c\u3002</p> <p></p> <p>\u56fe 5\u20118 3DW \u548c 4DW \u7684 Memory Request Header \u683c\u5f0f</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-memory-request-header","title":"l Memory Request Header \u5404\u5b57\u6bb5","text":"<p>\u4e00\u4e2a 4DW \u7684 Memory Request Header \u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20115 \u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002\u6ce8\u610f\uff0c3DW \u548c 4DW Header \u7684\u533a\u522b\u4ec5\u4ec5\u662f\u8d77\u59cb\u5730\u5740\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u5b57\u6bb5\u5927\u5c0f\u4e0d\u540c\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8e Header \u4e2d\u7684 Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 IO \u8bf7\u6c42\u7684\u5305\u683c\u5f0f\u5b57\u6bb5\uff1a  000b=Memory  Read\uff083DW \u65e0\u6570\u636e\uff09  010b=Memory  Write\uff083DW \u6709\u6570\u636e\uff09  001b=Memory  Read\uff084DW \u65e0\u6570\u636e\uff09  011b=Memory  Write\uff084DW \u6709\u6570\u636e\uff09  1xxb=TLP \u524d\u7f00\u5df2\u7ecf\u88ab\u6dfb\u52a0\u5230\u5305\u7684\u5f00\u5934\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTPH\uff08TLP Processing Hints\uff09\u201d\u4e00\u8282 Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 0000b=  Memory Read \u6216 Write  0 0001b=  Memory Read Locked  Type \u5b57\u6bb5\u4e0e Fmt[1:0]\u5171\u540c\u6307\u5b9a\u4e8b\u52a1\u7c7b\u578b\u3001Header \u5927\u5c0f\u4ee5\u53ca\u662f\u5426\u6709\u6570\u636e\u8377\u8f7d\u3002 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 \u8fd9\u4e2a\u5b57\u6bb5\u7684\u7f16\u7801\u4fe1\u606f\u662f\u8bf7\u6c42\u5305\u53ca\u5176\u5b8c\u6210\u5305\u7684\u6d41\u91cf\u7c7b\u578b\u3002  000b=TC  0\uff08\u9ed8\u8ba4\uff09  \u2026\u2026  111b=TC  7  \u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTraffic Class\uff08TC\uff09\u201d\u4e00\u8282\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u8868\u793a\u8fd9\u4e2a TLP \u662f\u5426\u4f7f\u7528\u57fa\u4e8e ID \u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\uff08IDO\uff09\u201d\u4e00\u8282\u3002 TH  TLP \u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u6307\u793a\u662f\u5426\u5305\u542b TLP \u63d0\u793a\u4fe1\u606f\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTPH\uff08TLP Processing  Hints\uff09\u201d\u4e00\u8282\u3002 TD  TLP \u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u5982\u679c\u4e3a 1\uff0c\u5219 TLP \u4e2d\u5b58\u5728 TLP Digest \u5b57\u6bb5\uff0c\u5373\u5b58\u5728 ECRC\u3002  \u4e00\u4e9b\u89c4\u5219\uff1a  \u6240\u6709\u7684\u63a5\u6536\u8005\u90fd\u8981\u4f7f\u7528\u8fd9\u4e2a TD bit \u68c0\u67e5\u662f\u5426\u5b58\u5728 Digest \u5b57\u6bb5\u3002  l TD=1 \u4f46\u662f\u4e0d\u542b\u6709 Digest \u5b57\u6bb5\u7684 TLP \u88ab\u5f53\u505a\u7578\u5f62\uff08Malformed\uff09  l \u5982\u679c TD=1\uff0c\u4e14\u63a5\u6536\u8005\u4e5f\u542f\u7528\u4e86 ECRC \u68c0\u67e5\uff0c\u90a3\u4e48\u5c31\u5fc5\u987b\u5bf9 ECRC \u8fdb\u884c\u68c0\u67e5\u3002  l \u5982\u679c\u63a5\u6536\u8005\u5e76\u4e0d\u652f\u6301\u53ef\u9009\u7684 ECRC \u6821\u9a8c\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u8981\u5ffd\u7565 TLP \u4e2d\u7684 Digest \u5b57\u6bb5\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u5982\u679c\u4e3a 1\uff0c\u90a3\u4e48\u4f34\u968f\u8fd9\u4e2a TLP \u7684\u6570\u636e\u8377\u8f7d\u5c31\u90fd\u88ab\u8ba4\u4e3a\u662f\u6709\u9519\u8bef\u7684\uff0c\u5c3d\u7ba1\u8fd9\u4e2a\u4e8b\u52a1\u8fd8\u662f\u53ef\u4ee5\u7167\u5e38\u5b8c\u6210\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 l Bit 5 =\u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09  \u5f53 Bit 5=1\uff0c\u8fd9\u4e2a TLP \u5c31\u4f7f\u7528 PCI-X \u7684\u5bbd\u677e\u6392\u5e8f\u3002\u5426\u5219\uff0c\u4f7f\u7528\u4e25\u683c\u7684 PCI \u6392\u5e8f\u3002  l Bit 6=\u65e0\u7aa5\u63a2\uff08No Snoop\uff09  \u5f53 Bit 6=1\uff0c\u7cfb\u7edf\u8f6f\u4ef6\u5c31\u4e0d\u9700\u8981\u8fdb\u884c\u5173\u4e8e\u8fd9\u4e2a TLP \u7684\u5904\u7406\u5668 Cache \u4e00\u81f4\u6027\u7aa5\u63a2\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u8fd9\u4e2a\u5b57\u6bb5\u652f\u6301\u865a\u62df\u7cfb\u7edf\uff08virtualized systems\uff09\u7684\u5730\u5740\u7ffb\u8bd1\u3002\u5730\u5740\u7ffb\u8bd1\u534f\u8bae\u662f\u7531\u4e00\u4e2a\u5355\u72ec\u7684\u534f\u8bae\u89c4\u8303\u6765\u63cf\u8ff0\u7684\uff0c\u79f0\u4e3a\u5730\u5740\u7ffb\u8bd1\u670d\u52a1\uff08Address Translation Services\uff09\uff0cAT \u4e2d\u7684\u7f16\u7801\u4fe1\u606f\u4e3a\uff1a  00=\u9ed8\u8ba4/\u672a\u7ffb\u8bd1  01=\u7ffb\u8bd1\u8bf7\u6c42  10=\u5df2\u7ffb\u8bd1  11=\u4fdd\u7559\u4f4d Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 TLP \u6570\u636e\u8377\u8f7d\u7684\u957f\u5ea6\uff0c\u5355\u4f4d\u4e3a DW\u3002\u6700\u5927\u4e3a 1024DW\uff084KB\uff09\uff0c\u7f16\u7801\u5982\u4e0b\uff1a  00  0000 0001b=1DW  00  0000 0010b=2DW  \u2026\u2026  11  1111 1111b=1023DW  00  0000 0000b=1024DW Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76f8\u5e94\u5b8c\u6210\u5305\u7684\u201c\u8fd4\u56de\u5730\u5740\u201d\u3002  Byte 4,7:0=Bus  Number  Byte 5,7:3=Device  Number  Byte 5,2:0=Function  Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u6765\u6807\u8bc6\u6765\u81ea Requester \u7684\u5177\u4f53\u6bcf\u4e2a\u8bf7\u6c42\u3002\u6bcf\u4e2a\u88ab\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684 Tag \u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u4f7f\u7528 Tag[4:0]\uff0c\u5982\u679c Control Register \u4e2d\u7684 Extended Tag \u4f4d\u88ab\u7f6e\u4e3a 1\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06 Tag \u7684\u4f7f\u7528\u6269\u5c55\u4e3a Tag[7:0]\uff0c\u8fd9\u6837\u5c31\u5141\u8bb8\u6700\u591a\u4f7f\u7528 256 \u4e2a Tag\u3002 Last  DW BE[3:0]  \u5c3e DW \u5b57\u8282\u4f7f\u80fd Byte  7 Bit 7:4 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u6700\u540e\u4e00\u4e2a DW \u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282 1<sup>st</sup>  DW BE[3:0]  \u9996 DW \u5b57\u8282\u4f7f\u80fd Byte  7 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u7b2c\u4e00\u4e2a DW \u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002 Address[63:32]  \u9ad8 32bit \u5730\u5740 Byte  8 Bit 7:0  Byte  9 Bit 7:0  Byte  10 Bit 7:0  Byte  11 Bit 7:2 \u8be5\u5b57\u6bb5\u662f Memory \u4f20\u8f93\u7684 64bit \u8d77\u59cb\u5730\u5740\u7684\u9ad8 32bit\u3002 Address[31:2]  \u4f4e 32bit \u5730\u5740 Byte  12 Bit 7:0  Byte  13 Bit 7:0  Byte  14 Bit 7:0  Byte  15 Bit 7:2 \u8be5\u5b57\u6bb5\u662f Memory \u4f20\u8f93\u7684 64bit \u8d77\u59cb\u5730\u5740\u7684\u4f4e 32bit\u3002\u800c\u6700\u4f4e 2bit \u662f\u4fdd\u7559\u4f4d\u59cb\u7ec8\u4e3a 0\uff0c\u8fd9\u6837\u5c31\u5f3a\u5236\u8d77\u59cb\u5730\u5740\u662f DW \u5bf9\u9f50\u7684\u3002 <p>\u8868 5\u20115 4DW Memory Request Header \u5404\u5b57\u6bb5</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-memory-request","title":"l Memory Request \u6ce8\u610f\u4e8b\u9879","text":"<p>Memory \u8bf7\u6c42\u7684\u7279\u6027\u5305\u62ec\uff1a</p> <ol> <li> <p>Memory \u6570\u636e\u4f20\u8f93\u4e0d\u5141\u8bb8\u8de8 4KB \u8fb9\u754c\u3002</p> </li> <li> <p>\u6240\u6709\u7684\u5185\u5b58\u6620\u5c04\u5199\uff08Memory-Mapped Write\uff09\u90fd\u662f Posted \u7684\uff0c\u4ee5\u6b64\u6765\u63d0\u5347\u6027\u80fd\u3002</p> </li> <li> <p>\u4f7f\u7528 32bit \u6216\u8005 64bit \u5730\u5740\u65b9\u5f0f\u3002</p> </li> <li> <p>\u6570\u636e\u8377\u8f7d\u5927\u5c0f\u5728 0-1024DW \u4e4b\u95f4\uff080-4KB\uff09\u3002</p> </li> <li> <p>QoS\uff08Quality of Service\uff09\u7279\u6027\u53ef\u4ee5\u88ab\u4f7f\u7528\uff0c\u6700\u591a\u53ef\u4ee5\u6709 8 \u4e2a\u6d41\u91cf\u7c7b\u578b\u3002</p> </li> <li> <p>No Snoop \u5c5e\u6027\u53ef\u4ee5\u5728\u4e8b\u52a1\u8bbf\u95ee\u4e3b\u5b58\u65f6\uff0c\u7528\u6765\u51cf\u8f7b\u7cfb\u7edf\u5bf9\u7aa5\u63a2\u5904\u7406\u5668 Cache \u7684\u9700\u6c42\u3002</p> </li> <li> <p>Relaxed Ordering \u5c5e\u6027\u53ef\u4ee5\u4f7f\u5f97\u6570\u636e\u5305\u4f20\u8f93\u8def\u5f84\u4e0a\u7684\u8bbe\u5907\u5bf9\u8fd9\u4e2a TLP \u4f7f\u7528\u5bbd\u677e\u6392\u5e8f\u89c4\u5219\uff0c\u4ee5\u6b64\u6765\u63d0\u5347\u6027\u80fd\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5253-configuration-configuration-request","title":"5.2.5.3   Configuration \u8bf7\u6c42\uff08Configuration Request\uff09","text":"<p>PCIe \u50cf PCI \u4e00\u6837\u4f7f\u7528 Type 0 \u548c Type 1 \u914d\u7f6e\u8bf7\u6c42\uff0c\u4ee5\u6b64\u6765\u4fdd\u6301\u5411\u540e\u517c\u5bb9\u6027\u3002\u4e00\u4e2a Type 1 \u914d\u7f6e\u8bf7\u6c42\u4f1a\u5411\u4e0b\u884c\u4f20\u64ad\uff0c\u76f4\u5230\u4e00\u4e2a Bridge \u7684\u6b21\u7ea7\u603b\u7ebf\uff08Secondary Bus\uff09\u6b63\u597d\u662f\u8fd9\u4e2a Type 1 \u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\uff0c\u5728\u8fd9\u65f6\u8fd9\u4e2a Bridge \u5c31\u4f1a\u628a\u8fd9\u4e2a\u914d\u7f6e\u4e8b\u52a1\u4ece Type 1 \u8f6c\u6362\u4e3a Type 0\u3002Bridge \u662f\u901a\u8fc7\u6b64\u524d\u7f16\u7a0b\u5199\u5165\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u6765\u5f97\u77e5\u4f55\u65f6\u5e94\u8be5\u5bf9\u914d\u7f6e\u4e8b\u52a1\u8fdb\u884c Type \u8f6c\u6362\u4ee5\u53ca\u7ee7\u7eed\u8f6c\u53d1\uff0c\u5176\u4e2d\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u5305\u62ec\u4e3b\u603b\u7ebf\u53f7\uff08Primary Bus Number\uff09\u3001\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09\u4ee5\u53ca\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09\u3002\u5173\u4e8e\u8fd9\u91cc\u7684\u66f4\u591a\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201c\u4f20\u7edf PCI \u673a\u5236\uff08Legacy PCI Mechanism\uff09\u201d\u4e00\u8282\u3002</p> <p>\u5982\u56fe 5\u20119 \u4e2d\uff0c\u4e00\u4e2a Type 1 \u914d\u7f6e\u8bf7\u6c42\u6b63\u5728\u6309\u7167\u89c4\u5219\u5411\u4e0b\u884c\u79fb\u52a8\uff0c\u5b83\u5728 Switch \u5de6\u4fa7\u7684\u4e0b\u884c\u7aef\u53e3\u7684 Bridge \u88ab\u8f6c\u6362\u6210 Type 0\uff0c\u8fd9\u79cd\u8f6c\u6362\u662f\u901a\u8fc7\u6539\u53d8 TLP Header \u4e2d\u7684 Type \u5b57\u6bb5 Bit 0 \u6765\u5b8c\u6210\u7684\uff08Type \u4ece 0 0101b \u53d8\u4e3a 0 0100b\uff09\u3002\u6ce8\u610f\uff0c\u4e0d\u540c\u4e8e PCI\uff0cPCIe \u4e2d\u4e0b\u884c\u7684\u4e00\u6761\u94fe\u8def\u4e0a\u53ea\u80fd\u7531\u4e00\u4e2a\u8bbe\u5907\uff0c\u56e0\u6b64\u94fe\u8def\u4e0a\u4e0d\u9700\u8981\u6709 IDSEL \u6216\u8005\u5176\u4ed6\u6307\u793a\u4fe1\u53f7\u6765\u544a\u8bc9\u8bbe\u5907\u9700\u8981\u58f0\u660e\u81ea\u5df1\u5360\u6709 Type 0 \u914d\u7f6e\u8bf7\u6c42\uff0c\u4e5f\u5c31\u662f\u8bf4\u8bbe\u5907\u53ea\u8981\u4ece\u4e0a\u884c\u6536\u5230\u4e86 Type 0 \u914d\u7f6e\u8bf7\u6c42\uff0c\u5c31\u77e5\u9053\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\u5c31\u5fc5\u7136\u662f\u81ea\u5df1\u3002</p> <p></p> <p>\u56fe 5\u20119 3DW \u914d\u7f6e\u8bf7\u6c42\u4ee5\u53ca Header \u683c\u5f0f</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-configuration-request-header","title":"l Configuration Request Header \u5404\u5b57\u6bb5\u7684\u5b9a\u4e49","text":"<p>\u56fe 5\u20119 \u4e2d\u5c55\u793a\u7684 Configuration Request Header \u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20116 \u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8e Header \u4e2d\u7684 Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 \u914d\u7f6e\u8bf7\u6c42\u59cb\u7ec8\u4e3a 3DW Header\uff1a  000b=Configuration  Read\uff08\u65e0\u6570\u636e\uff09  010b=  Configuration Write\uff08\u6709\u6570\u636e\uff09 Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 0100b=  Type 0 \u914d\u7f6e\u8bf7\u6c42  0 0101b=  Type 1 \u914d\u7f6e\u8bf7\u6c42 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 \u914d\u7f6e\u8bf7\u6c42\u7684 TC \u5fc5\u987b\u4e3a 0\uff0c\u4ee5\u786e\u4fdd\u8fd9\u4e9b\u914d\u7f6e\u5305\u6c38\u8fdc\u4e0d\u4f1a\u5f71\u54cd\u5230\u9ad8\u4f18\u5148\u7ea7\u7684\u5305\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u914d\u7f6e\u8bf7\u6c42\u7684\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a 0\u3002 TH  TLP \u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u914d\u7f6e\u8bf7\u6c42\u7684\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a 0\u3002 TD  TLP \u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u7528\u4e8e\u6307\u793a TLP \u7684\u672b\u5c3e\u662f\u5426\u6709 1DW \u7684 Digest \u5b57\u6bb5\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u7528\u4e8e\u6307\u793a\u6570\u636e\u8377\u8f7d\u662f\u88ab\u6c61\u67d3\u7684\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 \u914d\u7f6e\u8bf7\u6c42\u7684 Relaxed Ordering \u548c No Snoop \u5b57\u6bb5\u90fd\u4e3a 0\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u914d\u7f6e\u8bf7\u6c42\u7684 Address Type \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a 0\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u914d\u7f6e\u8bf7\u6c42\u7684\u6570\u636e\u8377\u8f7d\u5927\u5c0f\u5b57\u6bb5\u6c38\u8fdc\u4e3a 1\uff0c4bit \u5b57\u8282\u4f7f\u80fd\u7684\u6240\u6709\u7ec4\u5408\u90fd\u662f\u5141\u8bb8\u7684\u3002 Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76f8\u5e94\u5b8c\u6210\u5305\u7684\u201c\u8fd4\u56de\u5730\u5740\u201d\u3002  Byte 4,7:0=Bus  Number  Byte 5,7:3=Device  Number  Byte 5,2:0=Function  Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u6765\u6807\u8bc6\u6765\u81ea Requester \u7684\u5177\u4f53\u6bcf\u4e2a\u8bf7\u6c42\u3002\u6bcf\u4e2a\u88ab\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684 Tag \u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u4f7f\u7528 Tag[4:0]\uff08\u4e5f\u5c31\u662f\u540c\u65f6\u53ef\u4ee5\u6709 32 \u4e2a\u672a\u5b8c\u6210\u7684\u4e8b\u52a1\u5728\u8fdb\u884c\uff09\uff0c\u5982\u679c Control Register \u4e2d\u7684 Extended Tag \u4f4d\u88ab\u7f6e\u4e3a 1\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06 Tag \u7684\u4f7f\u7528\u6269\u5c55\u4e3a Tag[7:0]\uff0c\u8fd9\u6837\u5c31\u5141\u8bb8\u6700\u591a\u4f7f\u7528 256 \u4e2a Tag\u3002 Last  DW BE[3:0]  \u5c3e DW \u5b57\u8282\u4f7f\u80fd Byte  7 Bit 7:4 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u6700\u540e\u4e00\u4e2a DW \u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002\u7531\u4e8e\u914d\u7f6e\u8bf7\u6c42\u7684\u6570\u636e\u8377\u8f7d\u53ea\u80fd\u4e3a 1DW\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a 0 1<sup>st</sup>  DW BE[3:0]  \u9996 DW \u5b57\u8282\u4f7f\u80fd Byte  7 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u7b2c\u4e00\u4e2a DW \u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002\u5bf9\u4e8e\u914d\u7f6e\u8bf7\u6c42\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u6240\u6709\u7ec4\u5408\u90fd\u662f\u5141\u8bb8\u7684\uff08\u5305\u62ec\u5168 0\uff09\u3002 Completer  ID[15:0]  Completer  ID Byte  8 Bit 7:0  Byte  9 Bit 7:0 \u7528\u4e8e\u6307\u793a\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u8981\u8bbf\u95ee\u7684 Completer\u3002  Byte 8,7:0=Bus Number  Byte 9,7:3=Device Number  Byte 9,2:0=Function Number Ext  Register Number[3:0]  \u6269\u5c55\u5bc4\u5b58\u5668\u53f7  \uff08Extended Register Number\uff09 Byte  10 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u63d0\u4f9b\u4e86\u5728\u8bbf\u95ee\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\uff08Extended Config Space\uff09\u65f6 DW \u7a7a\u95f4\u7684\u9ad8 4bit\uff0c\u5b83\u4e0e Register Number \u5171\u540c\u7ec4\u5408\u6210 10bit \u5730\u5740\uff0c\u7528\u4e8e\u8bbf\u95ee 1024DW\uff08\u4e5f\u5c31\u662f 4096Byte\uff09\u7684\u7a7a\u95f4\u3002\u5bf9\u4e8e PCI-Compatible \u914d\u7f6e\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a 0\u3002 Register  Number[3:0]  \u5bc4\u5b58\u5668\u53f7  \uff08Register Number\uff09 Byte  11 Bit 7:0 \u7528\u4e8e\u6307\u793a\u5bc4\u5b58\u5668\u53f7\uff0c\u662f\u914d\u7f6e DW \u7a7a\u95f4\u7684\u4f4e 8bit\u3002\u6700\u4f4e\u7684 2bit \u59cb\u7ec8\u4e3a 0\uff0c\u4ee5\u5f3a\u5236\u8fdb\u884c DW \u5bf9\u9f50\u7684\u8bbf\u95ee\u3002 <p>\u8868 5\u20116 \u914d\u7f6e\u8bf7\u6c42 Header \u5404\u5b57\u6bb5</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-configuration-request","title":"l Configuration Request \u6ce8\u610f\u4e8b\u9879","text":"<p>\u914d\u7f6e\u8bf7\u6c42\u7684 Header \u603b\u4e3a 3DW \u683c\u5f0f\uff0c\u8def\u7531\u4fe1\u606f\u4e3a Bus Number\u3001Device Number \u548c Function Number\u3002\u6240\u6709\u7684\u8bbe\u5907\u90fd\u4f1a\u5728\u63a5\u6536\u5230\u4e00\u4e2a Type 0 \u914d\u7f6e\u5199\u8bf7\u6c42\u65f6\u4ece\u8bf7\u6c42\u5305\u4e2d\u6355\u83b7\u51fa\u5b83\u4eec\u81ea\u5df1\u7684 Bus Number \u548c Device Number\u3002\u4e4b\u6240\u4ee5\u8fd9\u6837\uff0c\u662f\u56e0\u4e3a\u8fd9\u4e9b\u8bbe\u5907\u4e4b\u540e\u4f1a\u7528\u81ea\u5df1\u6355\u83b7\u5230\u7684 Type 0 \u914d\u7f6e\u5199\u4e2d\u7684 Bus Number \u548c Device Number \u6765\u4f5c\u4e3a Requester ID\uff0c\u7528\u6765\u5728\u4ee5\u540e\u53d1\u8d77\u8bf7\u6c42\u65f6\u4f7f\u7528\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5254-completion","title":"5.2.5.4   \u5b8c\u6210\u5305\uff08Completion\uff09","text":"<p>Completion\uff08\u5b8c\u6210\u5305\uff09\u662f\u7528\u6765\u54cd\u5e94 Non-Posted \u8bf7\u6c42\u7684\uff0c\u9664\u975e\u6709\u9519\u8bef\u963b\u6b62\u4e86\u53d1\u9001\u5b8c\u6210\u5305\u3002\u4f8b\u5982\uff0cMemory\u3001IO\u3001Configuration Read \u8bf7\u6c42\u901a\u5e38\u5c31\u662f\u7531\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\u6765\u54cd\u5e94\u3002\u53e6\u4e00\u65b9\u9762\uff0cIO \u6216\u8005 Configuration \u5199\u8bf7\u6c42\u901a\u5e38\u4e5f\u7531\u65e0\u6570\u636e\u7684\u5b8c\u6210\u5305\u6765\u54cd\u5e94\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u5b8c\u6210\u5305\u4ec5\u4ec5\u662f\u7528\u6765\u62a5\u544a\u4e8b\u52a1\u7684\u72b6\u6001\u3002</p> <p>\u5728\u5b8c\u6210\u5305\u4e2d\u7684\u8bb8\u591a\u5b57\u6bb5\u7684\u503c\uff0c\u90fd\u4e0e\u5b83\u76f8\u5173\u7684\u8bf7\u6c42\u5305\u4e2d\u7684\u5b57\u6bb5\u76f8\u540c\uff0c\u5305\u62ec TC\uff08Traffic Class\uff0c\u6d41\u91cf\u7c7b\u578b\uff09\u3001Attr\uff08Attribute\uff0c\u5c5e\u6027\uff09\u4ee5\u53ca Requester ID\uff08\u8bf7\u6c42\u8005 ID\uff0c\u7528\u6765\u5c06\u5b8c\u6210\u5305\u8def\u7531\u56de\u5230\u8bf7\u6c42\u8005\u53bb\uff09\u3002\u56fe 5\u201110 \u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u54cd\u5e94 Non-Posted \u8bf7\u6c42\u7684\u5b8c\u6210\u5305\uff0c\u5e76\u4e14\u8fd8\u5c55\u793a\u4e86\u8fd9\u4e2a\u5b8c\u6210\u5305\u7684 3DW Header\u3002\u5728\u6b63\u5e38\u64cd\u4f5c\u4e2d\uff0cCompleter ID \u5e76\u6ca1\u6709\u4ec0\u4e48\u989d\u5916\u7684\u7528\u5904\uff0c\u4f46\u82e5\u662f\u5728\u7cfb\u7edf\u8c03\u8bd5\u671f\u95f4\u80fd\u591f\u77e5\u9053\u5b8c\u6210\u5305\u4ece\u54ea\u91cc\u6765\uff0c\u90a3\u4e48\u8fd9\u5bf9\u9519\u8bef\u7684\u8bca\u65ad\u5c31\u6709\u8f83\u5927\u7684\u5e2e\u52a9\u3002</p> <p></p> <p>\u56fe 5\u201110 3DW \u5b8c\u6210\u5305 Header \u683c\u5f0f</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-completion-header","title":"l Completion Header \u5404\u5b57\u6bb5\u7684\u5b9a\u4e49","text":"<p>\u56fe 5\u201110 \u4e2d\u5c55\u793a\u7684 Completion Header \u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20117 \u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8e Header \u4e2d\u7684 Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 \u5b8c\u6210\u5305\u59cb\u7ec8\u4e3a 3DW Header\uff1a  000b=Cpl\uff0c\u65e0\u6570\u636e  010b=CplD\uff0c\u6709\u6570\u636e Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 1010b=\u5b8c\u6210\u5305 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 \u5b8c\u6210\u5305\u7684\u8be5\u5b57\u6bb5\u5fc5\u987b\u4e0e\u76f8\u5e94\u7684\u8bf7\u6c42\u5305\u76f8\u540c\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u8868\u793a\u8fd9\u4e2a TLP \u662f\u5426\u4f7f\u7528\u57fa\u4e8e ID \u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\uff08IDO\uff09\u201d\u4e00\u8282\u3002 TH  TLP \u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u5b8c\u6210\u5305\u4e2d\uff0c\u6b64\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5 TD  TLP \u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u7528\u4e8e\u6307\u793a TLP \u7684\u672b\u5c3e\u662f\u5426\u6709 1DW \u7684 Digest \u5b57\u6bb5\uff0c\u5982\u679c\u4e3a 1 \u5219\u8bf4\u660e\u5b58\u5728\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u5982\u679c\u4e3a 1\uff0c\u5219\u8868\u793a\u6570\u636e\u8377\u8f7d\u662f\u88ab\u6c61\u67d3\u7684\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 \u5b8c\u6210\u5305\u7684\u8be5\u5b57\u6bb5\u5fc5\u987b\u4e0e\u76f8\u5e94\u7684\u8bf7\u6c42\u5305\u76f8\u540c\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u5b8c\u6210\u5305\u7684 Address Type \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a 0\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u7528\u4e8e\u8868\u793a\u5b8c\u6210\u5305\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a DW\u3002 Completer  ID[15:0]  Completer  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a Completer \u662f\u8c01\uff0c\u7528\u4e8e\u652f\u6301\u8c03\u8bd5\u3002  Byte 4,7:0=Compl  Bus Number  Byte 5,7:3=Compl  Device Number  Byte 5,2:0=Compl  Function Number Compl.  Status[2:0]  \u5b8c\u6210\u5305\u72b6\u6001  \uff08Completion Status Code\uff09 Byte  6 Bit 7:5 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u8868\u793a\u5b8c\u6210\u5305\u7684\u72b6\u6001\u3002  000b=Successful  Completion\uff08SC\uff09\u6210\u529f\u5b8c\u6210  001b=Unsupported  Request\uff08UR\uff09\u4e0d\u652f\u6301\u7684\u8bf7\u6c42  010b=Config  Req Retry Status\uff08CRS\uff09\u914d\u7f6e\u8bf7\u6c42\u91cd\u8bd5\u72b6\u6001  100b=Completer  Abort\uff08CA\uff09\u5b8c\u6210\u8005\u7ec8\u6b62  \u9664\u4e86\u4e0a\u8ff0 bit \u7ec4\u5408\u4e4b\u5916\u7684\u90fd\u662f\u4fdd\u7559\u7801\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cSummary of Completion Status Codes\u201d\u4e00\u8282\u3002 BCM  \u5b57\u8282\u6570\u5df2\u4fee\u6539  \uff08Byte Count Modified\uff09 Byte  6 Bit 4 \u8fd9\u4e2a\u5b57\u6bb5\u4ec5\u7531 PCI-X \u5b8c\u6210\u5305\u4f7f\u7528\uff0c\u7528\u6765\u8868\u793a Byte Count \u5b57\u6bb5\u4ec5\u62a5\u544a\u7b2c\u4e00\u4e2a\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\uff0c\u800c\u4e0d\u662f\u603b\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cUsing The Byte Count Modified Bit\u201d\u4e00\u8282\u3002 Byte  Count[11:0]  \u5b57\u8282\u6570 Byte  6 Bit 3:0  Byte  7 Bit 7:0 Byte Count \u5b57\u6bb5\u662f\u7528\u6765\u670d\u52a1\u8bfb\u8bf7\u6c42\u7684\uff0c\u5b83\u4e5f\u662f\u6765\u6e90\u4e8e\u539f\u59cb\u8bf7\u6c42\u4e2d\u7684 Length \u5b57\u6bb5\u3002\u4e00\u4e9b\u7279\u522b\u60c5\u51b5\u4e0b\uff0c\u4f1a\u51fa\u73b0\u4f7f\u7528\u591a\u5b8c\u6210\u5305\u8fd4\u56de\u6570\u636e\u8377\u8f7d\uff0c\u8bf7\u53c2\u9605\u201cData  Returned For Read Request\u201d\u4e00\u8282 Requester  ID[15:0]  Requester  ID Byte  8 Bit 7:0  Byte  9 Bit 7:0 \u8be5\u5b57\u6bb5\u662f\u4ece\u539f\u59cb\u8bf7\u6c42\u4e2d\u590d\u5236\u6765\u7684\uff0c\u7528\u4e8e\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u6765\u5e2e\u52a9\u5b8c\u6210\u5305\u8fd4\u56de Requester\u3002  Byte 4,7:0=Req  Bus Number  Byte 5,7:3=Req  Device Number  Byte 5,2:0=Req  Function Number Tag[7:0]  Tag Byte  10 Bit 7:0 \u5b8c\u6210\u5305\u4e2d\u7684 Tag \u5fc5\u987b\u4e0e\u76f8\u5e94\u8bf7\u6c42\u4e2d\u7684 Tag \u4e00\u6837\u3002Requester \u6536\u5230\u8fd9\u4e2a\u5b8c\u6210\u5305\u65f6\u662f\u901a\u8fc7 Tag \u6765\u5c06\u5b8c\u6210\u5305\u4e0e\u539f\u59cb\u8bf7\u6c42\u5173\u8054\u8d77\u6765\u7684\u3002 Lower  Address[6:0]  \u4f4e\u4f4d\u5730\u5740 Byte  11 Bit 6:0 \u8fd9\u4e2a\u5b57\u6bb5\u662f\u4e00\u4e2a\u8bfb\u8bf7\u6c42\u6240\u8fd4\u56de\u7684\u7b2c\u4e00\u7ec4\u6570\u636e\u7684\u4f4e 7bit \u5730\u5740\u3002\u5b83\u662f\u7531\u8bf7\u6c42 Length \u548c Byte Enable \u5171\u540c\u8ba1\u7b97\u51fa\u6765\u7684\uff0c\u5b83\u53ef\u4ee5\u5c55\u793a\u51fa\u5728\u5230\u8fbe\u4e0b\u4e00\u4e2a\u8bfb\u5b8c\u6210\u5305\u8fb9\u754c\u4e4b\u524d\u8fd8\u80fd\u4f20\u8f93\u591a\u5c11\u5b57\u8282\u6570\u636e\uff0c\u4ee5\u6b64\u6765\u534f\u52a9 Buffer \u7ba1\u7406\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cCalculation Lower Address Field\u201d\u4e00\u8282\u3002 <p>\u8868 5\u20117 \u5b8c\u6210\u5305 Header \u683c\u5f0f</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-summary-of-completion-status-codes","title":"l \u5b8c\u6210\u5305\u72b6\u6001\u7801\u603b\u7ed3\uff08Summary of Completion Status Codes\uff09","text":"<ul> <li> <p>000b\uff08SC\uff09Successful Completion \u6210\u529f\u5b8c\u6210\uff1a\u8bf7\u6c42\u88ab\u6b63\u786e\u670d\u52a1\u3002</p> </li> <li> <p>001b\uff08UR\uff09Unsupported Request \u4e0d\u652f\u6301\u7684\u8bf7\u6c42\uff1a\u5bf9\u4e8e Completer \u6765\u8bf4\uff0c\u6b64\u8bf7\u6c42\u662f\u975e\u6cd5\u7684\u6216\u8005\u662f\u65e0\u6cd5\u88ab\u8bc6\u522b\u7684\u3002\u8fd9\u662f\u4e00\u79cd\u51fa\u9519\u7684\u60c5\u51b5\uff0c\u81f3\u4e8e Completer \u5982\u4f55\u8fdb\u884c\u54cd\u5e94\u5219\u8981\u6839\u636e Completer \u5bf9\u5e94\u7684 PCIe \u534f\u8bae\u7248\u672c\u6765\u3002\u5728 PCIe 1.1 \u4e4b\u524d\uff0c\u8fd9\u79cd\u60c5\u51b5\u88ab\u89c6\u4e3a\u4e00\u79cd\u4e0d\u53ef\u7ea0\u6b63\u7684\u9519\u8bef\uff0c\u4f46\u662f\u5728 1.1 \u548c\u4e4b\u540e\u7684\u7248\u672c\u4e2d\uff0c\u5b83\u88ab\u4f5c\u4e3a\u4e00\u79cd Advisory Non-Fatal Error\uff08\u62a5\u544a\u7684\u975e\u81f4\u547d\u9519\u8bef\uff09\u3002\u66f4\u591a\u8be6\u7ec6\u5185\u5bb9\u8bf7\u53c2\u9605\u201cUnsupported Request\uff08UR\uff09 Status\u201d\u4e00\u8282\u3002</p> </li> <li> <p>010b\uff08CRS\uff09Configuration Request Retry Status \u914d\u7f6e\u8bf7\u6c42\u91cd\u8bd5\u72b6\u6001\uff1aCompleter \u4e34\u65f6\u7684\u65e0\u6cd5\u670d\u52a1\u4e00\u4e2a\u914d\u7f6e\u8bf7\u6c42\uff0c\u56e0\u6b64\u8fd9\u4e2a\u8bf7\u6c42\u5e94\u8be5\u7a0d\u540e\u518d\u6b21\u5c1d\u8bd5\u3002</p> </li> <li> <p>100b\uff08CA\uff09Completer Abort \u5b8c\u6210\u8005\u7ec8\u6b62\uff1aCompleter \u5e94\u8be5\u5df2\u7ecf\u5bf9\u8bf7\u6c42\u4e8b\u52a1\u8fdb\u884c\u4e86\u670d\u52a1\uff0c\u4f46\u662f\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u5bfc\u81f4\u4e86\u670d\u52a1\u5931\u8d25\u3002\u8fd9\u662f\u4e00\u79cd\u4e0d\u53ef\u7ea0\u6b63\u7684\u9519\u8bef\u3002</p> </li> </ul>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-calculating-the-lower-address-field","title":"l \u8ba1\u7b97\u4f4e\u4f4d\u5730\u5740\u5b57\u6bb5\uff08Calculating the Lower Address Field\uff09","text":"<p>Completer \u8bbe\u7f6e\u8fd9\u4e2a\u5b57\u6bb5\u662f\u7528\u6765\u53cd\u6620\u8fd4\u56de\u7ed9 Requester \u7684\u6570\u636e\u8377\u8f7d\u4e2d\uff0c\u7b2c\u4e00\u4e2a enabled \u7684\u5b57\u8282\u7684\u5b57\u8282\u5bf9\u9f50\u5730\u5740\uff08byte-aligned address\uff09\u3002\u786c\u4ef6\u4f1a\u901a\u8fc7\u539f\u59cb\u8bf7\u6c42\u4e2d\u7684 DW \u8d77\u59cb\u5730\u5740\u4ee5\u53ca\u9996 DW \u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\uff081<sup>st</sup> DW Byte Enable\uff09\u4e2d\u7684\u5b57\u8282\u4f7f\u80fd\u60c5\u51b5\uff0c\u6765\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u5730\u5740\u7684\u503c\u3002</p> <p>\u5bf9\u4e8e MRd\uff08Memory Read\uff09\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u5730\u5740\u5c31\u662f\u4ece DW \u8d77\u59cb\u5730\u5740\u5f00\u59cb\u7684\u504f\u79fb\u91cf\uff1a</p> <ul> <li> <p>\u5982\u679c\u9996 DW \u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a 1111b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a DW \u4e2d\u7684\u6240\u6709\u5b57\u8282\u90fd\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f 0\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u4e0e DW \u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740\u76f8\u540c\u3002</p> </li> <li> <p>\u5982\u679c\u9996 DW \u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a 1110b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a DW \u4e2d\u7684\u9ad8 3 \u4e2a\u5b57\u8282\u90fd\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f 1\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u7b49\u4e8e DW \u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740+1\u3002</p> </li> <li> <p>\u5982\u679c\u9996 DW \u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a 1100b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a DW \u4e2d\u7684\u9ad8 2 \u4e2a\u5b57\u8282\u90fd\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f 2\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u7b49\u4e8e DW \u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740+2\u3002</p> </li> <li> <p>\u5982\u679c\u9996 DW \u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a 1000b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a DW \u4e2d\u7684\u4ec5\u6709\u6700\u9ad8\u5b57\u8282\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f 3\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u7b49\u4e8e DW \u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740+3\u3002</p> </li> </ul> <p>\u4e00\u65e6\u4e0a\u8ff0\u7684\u8ba1\u7b97\u5b8c\u6210\uff0c\u8ba1\u7b97\u7ed3\u679c\u7684\u4f4e 7bit \u5c31\u4f1a\u88ab\u653e\u5165\u5b8c\u6210\u5305 Header \u7684 Lower Address \u5b57\u6bb5\uff0c\u5f53\u8bfb\u5b8c\u6210\u5305\u5c0f\u4e8e\u6574\u4e2a\u6570\u636e\u8377\u8f7d\u56e0\u800c\u9700\u8981\u505c\u6b62\u5728\u7b2c\u4e00\u4e2a RCB\uff08Read Completion Boundary\uff09\u65f6\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u6709\u52a9\u4e8e\u66f4\u597d\u7684\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u3002\u82e5\u60f3\u5c06\u4e00\u4e2a\u4e8b\u52a1\u62c6\u5206\u6210\u591a\u4e2a\u90e8\u5206\uff0c\u5219\u5fc5\u987b\u8981\u5728 RCB \u4e0a\u8fdb\u884c\u62c6\u5206\uff0c\u800c\u5230\u8fbe\u7b2c\u4e00\u4e2a RCB \u65f6\u6240\u4f20\u8f93\u7684\u5b57\u8282\u6570\u91cf\u662f\u6839\u636e\u8d77\u59cb\u5730\u5740\u800c\u5b9a\u7684\u3002</p> <p>\u5bf9\u4e8e AtomicOp\uff08\u539f\u5b50\u64cd\u4f5c\uff09\u5b8c\u6210\u5305\uff0cLower Address \u5b57\u6bb5\u662f\u4fdd\u7559\u4f4d\u3002\u5bf9\u4e8e\u6240\u6709\u5176\u4ed6\u5b8c\u6210\u5305\u7c7b\u578b\uff08\u975e\u8bfb\u8bf7\u6c42\u3001\u975e\u539f\u5b50\u64cd\u4f5c\uff09\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a 0\u3002</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-using-the-byte-count-modified-bit","title":"l \u4f7f\u7528\u5b57\u8282\u6570\u4fee\u6539\u4f4d\uff08Using The Byte Count Modified Bit\uff09","text":"<p>\u8fd9\u4e2a bit \u4ec5\u7531 PCI-X Completer \u8fdb\u884c\u8bbe\u7f6e\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u7528\u4e86 PCIe \u5230 PCI-X \u7684 Bridge\uff0c\u90a3\u4e48\u8fd9\u4e9b PCI-X Completer \u4eec\u5c31\u4e5f\u53ef\u4ee5\u51fa\u73b0\u5728 PCIe \u62d3\u6251\u7ed3\u6784\u4e2d\u3002\u4f7f\u7528\u8fd9\u4e2a bit \u7684\u89c4\u5219\u5305\u62ec\uff1a</p> <ol> <li> <p>\u5f53\u4e00\u4e2a\u8bfb\u8bf7\u6c42\u8981\u62c6\u5206\u6210\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\u65f6\uff0cByte Count Modified \u8fd9\u4e00\u4f4d\u53ea\u80fd\u7531 PCI-X Completer \u8fdb\u884c\u7f6e\u4f4d\u3002</p> </li> <li> <p>\u4ec5\u6709\u4e00\u7cfb\u5217\u5b8c\u6210\u5305\u4e2d\u7684\u7b2c\u4e00\u4e2a\u53ef\u4ee5\u5c06\u8fd9\u4e2a bit \u7f6e\u4e3a 1\uff0c\u8fd9\u8868\u793a\u7b2c\u4e00\u4e2a\u5b8c\u6210\u5305\u5185\u5305\u542b\u7684 Byte Count \u5b57\u6bb5\u53ea\u53cd\u6620\u8fd9\u4e2a\u5b8c\u6210\u5305\uff08\u7b2c\u4e00\u4e2a\u5b8c\u6210\u5305\uff09\u7684\u6570\u636e\u8377\u8f7d\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u4e8b\u52a1\u7684\u6570\u636e\u8377\u8f7d\uff08\u901a\u5e38\u60c5\u51b5\u4e0b\u662f\u8868\u793a\u6574\u4e2a\u4e8b\u52a1\u7684\u603b\u6570\u636e\u8377\u8f7d\uff09\u3002\u8fd9\u6837 Requester \u5c31\u77e5\u9053\uff0c\u5373\u4f7f Byte Count \u770b\u8d77\u6765\u4f3c\u4e4e\u8868\u793a\u8fd9\u662f\u8fd9\u4e2a\u8bf7\u6c42\u7684\u6700\u540e\u4e00\u4e2a\u5b8c\u6210\u5305\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u5b8c\u6210\u5305\u4e4b\u540e\u8fd8\u4f1a\u6709\u5b8c\u6210\u5305\uff0c\u4ee5\u6b64\u6765\u6ee1\u8db3\u539f\u59cb\u8bf7\u6c42\u5bf9\u6570\u636e\u91cf\u7684\u9700\u6c42\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u968f\u540e\u7684\u4e00\u7cfb\u5217\u5b8c\u6210\u5305\u6765\u8bf4\uff0cBCM \u4f4d\u5fc5\u987b\u7f6e\u4e3a 0\uff0c\u4e14 Byte Count \u5b57\u6bb5\u8981\u7528\u6765\u53cd\u6620\u5269\u4e0b\u7684\u6240\u6709\u6570\u636e\u8377\u8f7d\u989d\u5b57\u8282\u6570\uff0c\u5c31\u50cf\u5b83\u901a\u5e38\u7684\u542b\u4e49\u4e00\u6837\u3002</p> </li> <li> <p>\u5f53\u8bbe\u5907\u63a5\u6536\u5230 BCM \u4f4d\u4e3a 1 \u7684\u5b8c\u6210\u5305\u65f6\uff0c\u5b83\u5fc5\u987b\u8981\u6b63\u786e\u7684\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u3002</p> </li> <li> <p>Completer \u8981\u5728\u5e26\u6709\u6570\u636e\u8377\u8f7d\u7684\u5b8c\u6210\u5305\u4e2d\u8bbe\u7f6e Lower Address \u5b57\u6bb5\uff0c\u4ee5\u6b64\u6765\u53cd\u6620\u8fd4\u56de\u7684\u7b2c\u4e00\u4e2a\u6709\u6548\u5b57\u8282\u7684\u5730\u5740\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-data-returned-for-read-requests","title":"l \u8bfb\u8bf7\u6c42\u6570\u636e\u8fd4\u56de\uff08Data Returned For Read Requests\uff09:","text":"<ol> <li> <p>\u4e00\u4e2a\u8bfb\u8bf7\u6c42\u53ef\u80fd\u9700\u8981\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\uff0c\u4f46\u662f\u6700\u7ec8\u4f20\u8f93\u7684\u6570\u636e\u603b\u91cf\u5fc5\u987b\u7b49\u4e8e\u539f\u59cb\u8bf7\u6c42\u4e2d\u8981\u6c42\u7684\u5927\u5c0f\uff0c\u5426\u5219\u53ef\u80fd\u5bfc\u81f4\u5b8c\u6210\u5305\u8d85\u65f6\u9519\u8bef\uff08Completion Timeout error\uff09\u3002</p> </li> <li> <p>\u4e00\u4e2a\u5b8c\u6210\u5305\u53ea\u80fd\u7528\u4e8e\u670d\u52a1\u4e00\u4e2a\u8bf7\u6c42\u3002</p> </li> <li> <p>IO \u548c Configuration \u8bfb\u8bf7\u6c42\u6240\u8bf7\u6c42\u7684\u6570\u636e\u91cf\u6c38\u8fdc\u662f 1DW\uff0c\u5e76\u4e14\u53ea\u80fd\u7531\u4e00\u4e2a\u5355\u72ec\u7684\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\u3002</p> </li> <li> <p>\u72b6\u6001\u7801\u4e0d\u662f SC\uff08Successful Completion\uff09\u7684\u5b8c\u6210\u5305\u5c06\u4f1a\u7ec8\u6b62\u5f53\u524d\u4e8b\u52a1\u3002</p> </li> <li> <p>\u5728\u4f7f\u7528\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u54cd\u5e94\u8bfb\u8bf7\u6c42\u65f6\uff0c\u5fc5\u987b\u6ce8\u610f\u8bfb\u5b8c\u6210\u5305\u8fb9\u754c\uff08RCB\uff0cRead Completion Boundary\uff09\u3002\u5bf9\u4e8e RC \u6765\u8bf4\uff0cRCB \u4f1a\u662f 64Bytes \u6216\u8005 128Bytes\uff0c\u8fd9\u662f\u56e0\u4e3a RC \u53ef\u4ee5\u66f4\u6539\u5728\u5176\u7aef\u53e3\u95f4\u79fb\u52a8\u7684\u6570\u636e\u5305\u7684\u5927\u5c0f\uff0c\u5177\u4f53\u7684 RCB \u7684\u503c\u53ef\u4ee5\u5728\u914d\u7f6e\u5bc4\u5b58\u5668\u4e2d\u770b\u5230\u3002</p> </li> <li> <p>Bridge \u548c EP \u53ef\u4ee5\u7528\u4e00\u4e2a bit \u6765\u5b9e\u73b0\u8f6f\u4ef6\u5bf9 RCB \u5927\u5c0f\u7684\u9009\u62e9\uff0c64bytes \u6216\u8005 128bytes\u3002</p> </li> <li> <p>\u5b8c\u5168\u5728\u4e00\u4e2a\u5bf9\u9f50 RCB \u8fb9\u754c\u5185\u7684\u5b8c\u6210\u5305\u4eec\u5fc5\u987b\u4e00\u6b21\u5b8c\u6210\u4f20\u8f93\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u4e9b RCB \u8fb9\u754c\u5185\u7684\u5b8c\u6210\u5305\u7684\u4f20\u8f93\u662f\u4e0d\u4f1a\u5230\u8fbe RCB \u7684\uff0c\u800c RCB \u624d\u662f\u5141\u8bb8\u63d0\u524d\u505c\u6b62\u4f20\u8f93\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5c31\u5fc5\u987b\u5bf9\u4e00\u4e2a RCB \u8fb9\u754c\u5185\u7684\u6240\u6709\u5b8c\u6210\u5305\u4e00\u6b21\u5b8c\u6210\u4f20\u8f93\u800c\u4e0d\u80fd\u4e2d\u9014\u505c\u6b62\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u4e00\u4e2a\u5355\u72ec\u7684\u8bfb\u8bf7\u6c42\u6765\u8bf4\uff0c\u82e5\u4f7f\u7528\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u4e9b\u6570\u636e\u5fc5\u987b\u4ee5\u5730\u5740\u9012\u589e\u7684\u987a\u5e8f\u6765\u8fd4\u56de\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-receiver-completion-handling-rules","title":"l \u63a5\u6536\u8005\u5bf9\u5b8c\u6210\u5305\u7684\u5904\u7406\u89c4\u5219\uff08Receiver Completion Handling Rules\uff09:","text":"<ol> <li> <p>\u5982\u679c\u4e00\u4e2a\u5df2\u7ecf\u88ab\u63a5\u6536\u7684\u5b8c\u6210\u5305\u5e76\u6ca1\u6709\u5339\u914d\u4e0a\u4efb\u4f55\u4e00\u4e2a\u5f85\u5b8c\u6210\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u5b83\u5c31\u662f\u4e00\u4e2a Unexpected Completion\uff08\u610f\u5916\u5b8c\u6210\u5305\uff09\uff0c\u5c06\u88ab\u5f53\u505a\u662f\u4e00\u79cd\u9519\u8bef\u6765\u5904\u7406\u3002</p> </li> <li> <p>\u5982\u679c\u5b8c\u6210\u5305\u72b6\u6001\u4e0d\u662f SC \u6216\u8005 CRS\uff0c\u90a3\u4e48\u5c31\u5c06\u88ab\u5f53\u505a\u662f\u9519\u8bef\u6765\u5904\u7406\uff0c\u5e76\u4e14\u4f1a\u6e05\u7a7a\u4e0e\u4e4b\u76f8\u5173\u8054\u7684 Buffer \u7a7a\u95f4\u3002</p> </li> <li> <p>\u5f53 RC \u5728\u8fdb\u884c\u914d\u7f6e\u4e8b\u52a1\u65f6\u63a5\u6536\u5230\u4e00\u4e2a CRS \u72b6\u6001\u7684\u5b8c\u6210\u5305\uff0c\u90a3\u4e48\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u5c31\u88ab\u7ec8\u6b62\u4e86\u3002\u968f\u540e\u8981\u8fdb\u884c\u7684\u4e8b\u60c5\u662f\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u4e0d\u540c\u7684\uff0c\u4f46\u662f\u5982\u679c RC \u652f\u6301\u8fd9\u79cd CRS \u72b6\u6001\u7684\u5b8c\u6210\u5305\u5904\u7406\uff0c\u90a3\u4e48\u5177\u4f53\u7684\u64cd\u4f5c\u5c06\u7531 RC \u63a7\u5236\u5bc4\u5b58\u5668\u4e2d\u7684 CRS Software Visibility \u4f4d\u6765\u8fdb\u884c\u5b9a\u4e49\u8bbe\u7f6e\u3002</p> </li> </ol> <p>\u2014  \u5982\u679c CRS Software Visibility \u6ca1\u6709\u542f\u7528\uff0c\u90a3\u4e48 RC \u5c06\u4f1a\u91cd\u65b0\u53d1\u51fa\u914d\u7f6e\u8bf7\u6c42\uff0c\u76f4\u5230\u91cd\u590d\u4e86\u4e00\u5b9a\u7684\u6b21\u6570\uff08\u5177\u4f53\u5b9e\u73b0\u4e2d\u6307\u5b9a\uff09\u4e4b\u540e\u5c31\u4f1a\u653e\u5f03\u91cd\u53d1\u7684\u64cd\u4f5c\uff0c\u5e76\u8ba4\u4e3a\u8bf7\u6c42\u76ee\u6807\u5b58\u5728\u95ee\u9898\u3002</p> <p>\u2014  \u5982\u679c CRS Software Visibility \u662f\u542f\u7528\u7684\uff0c\u90a3\u4e48\u7528\u6765\u652f\u6301\u5b83\u7684\u8f6f\u4ef6\u90fd\u4f1a\u9996\u5148\u8bfb\u53d6 Vendor ID \u5b57\u6bb5\u7684\u4e24\u4e2a\u5b57\u8282\uff0c\u5982\u679c\u786c\u4ef6\u63a5\u6536\u5230\u4e86\u8fd9\u4e2a\u8bfb\u8bf7\u6c42\u7684 CRS \u5b8c\u6210\u5305\uff0c\u5b83\u5c06\u7ed9\u8fd4\u56de\u7684 Vendor ID \u5c06\u4f1a\u662f 0001h\u3002\u8fd9\u4e2a\u503c\u662f PCI-SIG \u89c4\u5b9a\u7684\u4fdd\u7559\u503c\uff0c\u5b83\u5e76\u4e0d\u5bf9\u5e94\u4efb\u4f55\u6709\u6548\u7684 Vendor\uff0c\u5e76\u4f1a\u901a\u77e5\u8f6f\u4ef6\u53d1\u751f\u4e86\u8fd9\u6837\u7684\u4e8b\u4ef6\u3002\u8fd9\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u5728\u7b49\u5f85\u76ee\u6807 Function \u51c6\u5907\u5c31\u7eea\u7684\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff08\u901a\u5e38\u5728\u590d\u4f4d\u540e\u9700\u8981 1s \u65f6\u95f4\uff09\uff0c\u53bb\u6267\u884c\u5176\u4ed6\u7684\u4efb\u52a1\uff0c\u800c\u4e0d\u662f\u505c\u6ede\u4e0d\u524d\u3002\u4efb\u4f55\u5176\u4ed6\u7684\u914d\u7f6e\u8bfb\u6216\u8005\u5199\uff08\u9664\u4e86\u6700\u5f00\u59cb\u7684\u914d\u7f6e\u8bfb Vendor ID\uff09\u90fd\u4f1a\u88ab RC \u81ea\u52a8\u91cd\u8bd5\u91cd\u53d1\uff0c\u76f4\u5230\u8fbe\u5230\u8bbe\u8ba1\u7684\u91cd\u590d\u6b21\u6570\u3002</p> <ol> <li> <p>\u5982\u679c\u4e00\u4e2a\u8bf7\u6c42\u5e76\u4e0d\u662f\u914d\u7f6e\u8bf7\u6c42\uff0c\u4f46\u662f\u5b83\u7684\u5b8c\u6210\u5305\u51fa\u73b0\u4e86 CRS \u72b6\u6001\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b8c\u6210\u5305\u5c06\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>\u5f53\u5b8c\u6210\u5305\u72b6\u6001\u7801\u4e3a\u4fdd\u7559\u7ec4\u5408\u65f6\uff0c\u5e76\u4e0d\u662f\u5b9a\u4e49\u51fa\u7684\u90a3\u51e0\u79cd\uff0c\u5c31\u628a\u5b83\u5f53\u505a UR\uff08Unsupported Request\uff09\u4e00\u6837\u5904\u7406\u3002</p> </li> <li> <p>\u5982\u679c\u63a5\u6536\u5230\u7684\u4e00\u4e2a\u8bfb\u5b8c\u6210\u5305\u6216\u8005\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u5b8c\u6210\u5305\u7684\u72b6\u6001\u7801\u4e0d\u662f SC\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b8c\u6210\u5305\u5c31\u4e0d\u4f1a\u643a\u5e26\u6570\u636e\uff0c\u5e76\u4e14 Requester \u5fc5\u987b\u8981\u8003\u8651\u7ec8\u6b62\u8fd9\u4e2a\u5b8c\u6210\u5305\u5bf9\u5e94\u7684\u8bf7\u6c42\u3002\u81f3\u4e8e Requester \u5177\u4f53\u5982\u4f55\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u5219\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u5b9a\u3002</p> </li> <li> <p>\u5728\u4f7f\u7528\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u54cd\u5e94\u4e00\u4e2a\u8bfb\u8bf7\u6c42\u7684\u60c5\u51b5\u4e0b\uff0c\u4efb\u4f55\u4e00\u4e2a\u5b8c\u6210\u5305\u7684\u72b6\u6001\u53ea\u8981\u4e0d\u662f SC\uff0c\u90a3\u4e48\u5c31\u4f1a\u7ec8\u6b62\u8fd9\u4e2a\u4e8b\u52a1\u3002\u8bbe\u5907\u5982\u4f55\u5904\u7406\u51fa\u9519\u4e4b\u524d\u63a5\u6536\u5230\u7684\u6570\u636e\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u5b9a\u3002</p> </li> <li> <p>\u4e3a\u4e86\u4fdd\u6301\u5bf9 PCI \u7684\u517c\u5bb9\u6027\uff0cRC \u9700\u8981\u5728\u4e00\u4e2a\u914d\u7f6e\u4e8b\u52a1\u88ab UR \u7ed3\u675f\u65f6\uff0c\u5408\u6210\u4e00\u4e2a\u5168 1 \u7684\u8bfb\u53d6\u503c\u3002\u8fd9\u5c31\u7c7b\u540c\u4e8e\u679a\u4e3e\u8f6f\u4ef6\u5c1d\u8bd5\u4ece\u4e0d\u5b58\u5728\u7684\u8bbe\u5907\u4e2d\u8bfb\u53d6\u6570\u636e\u65f6\u7684\u51fa\u73b0\u7684 PCI Master Abort \u4e00\u6837\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#5255-message-requests","title":"5.2.5.5   \u6d88\u606f\u8bf7\u6c42\uff08Message Requests\uff09","text":"<p>Message \u8bf7\u6c42\u53d6\u4ee3\u4e86 PCI/PCI-X \u4e2d\u4f7f\u7528\u7684\u8bb8\u591a\u4e2d\u65ad\uff08interrupt\uff09\u3001\u9519\u8bef\uff08error\uff09\u548c\u7535\u6e90\u7ba1\u7406\uff08power management\uff09\u7684\u8fb9\u5e26\u4fe1\u53f7\u3002\u6240\u6709\u7684 Message \u8bf7\u6c42\u4f7f\u7528\u7684\u90fd\u662f 4DW Header \u683c\u5f0f\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u6bcf\u79cd Message \u90fd\u4f7f\u7528\u4e86 Header \u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u3002\u5bf9\u4e8e Header \u4e2d\u7684 Byte8-15 \u6765\u8bf4\uff0c\u5728\u4e00\u4e9b\u79cd\u7c7b\u7684 Message \u4e2d\u5c31\u6ca1\u6709\u5176\u5b9a\u4e49\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5b83\u5c31\u662f\u4fdd\u7559\u5b57\u6bb5\u3002Message \u7684\u5904\u7406\u65b9\u5f0f\u66f4\u50cf\u662f Posted \u7684 MWr \u4e8b\u52a1\uff0c\u4f46\u662f Message \u7684\u8def\u7531\u65b9\u5f0f\u53ef\u4ee5\u662f\u57fa\u4e8e\u5730\u5740\u7684\u3001\u57fa\u4e8e ID \u7684\uff0c\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5\u662f\u9690\u5f0f\u8def\u7531\u3002TLP Header \u4e2d\u7684\u8def\u7531\u5b50\u57df\uff08routing subfield\uff09\uff0c\u4e5f\u5c31\u662f Byte 0 bit 2:0\uff0c\u5b83\u7528\u6765\u8868\u793a\u4f7f\u7528\u7684\u662f\u54ea\u79cd\u8def\u7531\u65b9\u6cd5\uff0c\u5e76\u4e14\u76f8\u5e94\u7684\u5728 Header \u4e2d\u5b9a\u4e49\u4e86\u54ea\u4e9b\u9644\u52a0\u7684\u5b57\u6bb5\uff0c\u4f8b\u5982\u4f7f\u7528\u57fa\u4e8e ID \u8def\u7531\u7684 Header \u4e2d\u5c31\u4f1a\u6709\u7528\u4e8e\u8def\u7531\u7684 BDF\u3002\u901a\u7528\u7684 Message \u8bf7\u6c42 Header \u683c\u5f0f\u5982\u56fe 5\u201111 \u6240\u793a\u3002</p> <p></p> <p>\u56fe 5\u201111 4DW \u7684 Message \u8bf7\u6c42 Header \u683c\u5f0f</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-message-header-message-request-header-fields","title":"l Message \u8bf7\u6c42 Header \u5404\u5b57\u6bb5\uff08Message Request Header Fields\uff09","text":"\u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8e Header \u4e2d\u7684 Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 Message \u59cb\u7ec8\u4e3a 4DW Header\uff1a  001b=4DW\uff0c\u65e0\u6570\u636e  011b=4DW\uff0c\u6709\u6570\u636e Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 TLP \u5305\u7684 Type \u5b57\u6bb5\u3002  Bit 4:3\uff1a  10b=Msg  Bit 2:0\uff1a\uff08Message \u8def\u7531\u5b50\u57df\uff09000b=\u5230 RC \u7684\u9690\u5f0f\u8def\u7531\u3002001b=\u4f7f\u7528\u5730\u5740\u8def\u7531  010b=\u4f7f\u7528 ID \u8def\u7531  011b=\u6765\u81ea RC \u7684\u9690\u5f0f\u8def\u7531\u5e7f\u64ad 100b=\u672c\u5730\uff1b\u7ec8\u7ed3\u4e8e\u9996\u7ea7\u63a5\u6536\u8005  101b=\u6536\u96c6\u5e76\u8def\u7531\u81f3 RC  \u5176\u4ed6\u503c=\u4fdd\u7559\u503c\uff0c\u4f5c\u4e3a\u672c\u5730\u5904\u7406 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 Message \u7684 TC \u59cb\u7ec8\u4e3a 0\uff0c\u4ee5\u786e\u4fdd\u5b83\u4eec\u4e0d\u4f1a\u5f71\u54cd\u5230\u9ad8\u4f18\u5148\u7ea7\u7684\u6570\u636e\u5305\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u8868\u793a\u8fd9\u4e2a TLP \u662f\u5426\u4f7f\u7528\u57fa\u4e8e ID \u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\uff08IDO\uff09\u201d\u4e00\u8282\u3002 TH  TLP \u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 Message \u4e2d\uff0c\u9664\u975e\u53e6\u6709\u6ce8\u660e\uff0c\u6b64\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 TD  TLP \u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u5982\u679c\u4e3a 1\uff0c\u5219\u8bf4\u660e TLP \u7684\u672b\u5c3e\u5b58\u5728 1DW \u7684 Digest \u5b57\u6bb5\uff08\u5728 LCRC \u548c END \u5b57\u7b26\u4e4b\u524d\uff09\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u5982\u679c\u4e3a 1\uff0c\u5219\u8868\u793a\u6570\u636e\u8377\u8f7d\u662f\u88ab\u6c61\u67d3\u7684\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 Message \u4e2d\uff0c\u9664\u975e\u53e6\u6709\u6ce8\u660e\uff0c\u6b64\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 Message \u7684 Address Type \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a 0\uff0c\u4f46\u662f\u5e76\u4e0d\u8981\u6c42\u751a\u81f3\u4e0d\u9f13\u52b1\u63a5\u6536\u65b9\u5bf9\u8fd9\u4e2a\u5b57\u6bb5\u8fdb\u884c\u68c0\u67e5\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u7528\u4e8e\u8868\u793a\u5b8c\u6210\u5305\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a DW\u3002\u5bf9\u4e8e Message \u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u59cb\u7ec8\u4e3a 0\uff08\u65e0\u6570\u636e\uff09\u6216 1\uff08\u6709 1DW \u6570\u636e\uff09\u3002 Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u53d1\u9001 Message \u7684 Requester \u662f\u8c01\u3002  Byte 4,7:0=Requester  Bus Number  Byte 5,7:3=Requester  Device Number  Byte 5,2:0=Requester  Function Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u7531\u4e8e\u6240\u6709\u7684 Message \u8bf7\u6c42\u90fd\u662f Posted \u7684\uff0c\u4e0d\u9700\u8981 Requester \u63a5\u6536\u5b8c\u6210\u5305\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u7ed9 Message \u5206\u914d Tag\u3002\u8fd9\u4e2a\u5b57\u6bb5\u5e94\u8be5\u4e3a 0\u3002 Message  Code[7:0]  Message \u6807\u8bc6\u7801 Byte  7 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u5305\u542b\u7684\u6807\u8bc6\u7801\u8868\u793a\u53d1\u9001\u7684 Message \u662f\u4ec0\u4e48\u79cd\u7c7b\u3002  0000 0000b=\u89e3\u9501 Message\uff08Unlock Message\uff09  0001 0000b=\u5ef6\u8fdf\u5bb9\u5fcd\u62a5\u544a\uff08Lat. Tolerance Reporting\uff09  0001 0010b=\u4f18\u5316\u7684 Buffer \u5237\u65b0/\u586b\u6ee1\uff08Optimized Buffer Flush/Fill\uff09  0001 xxxxb=\u7535\u6e90\u7ba1\u7406 Message\uff08Power Mgt. Message\uff09  0010 0xxxb=INTx Message  0011 00xxb=\u9519\u8bef Message\uff08Error Message\uff09  0100 xxxxb=\u5ffd\u7565 Message\uff08Ignored Message\uff09  0101 0000b=\u8bbe\u7f6e\u63d2\u69fd\u529f\u8017 Message\uff08Set Slot Power Message\uff09  0111 111xb=\u5382\u5546\u5b9a\u4e49\u7684 Message\uff08Vendor Defined Message\uff09 Address[63:32]  \u9ad8 32bit \u5730\u5740 Byte  8 Bit 7:0  Byte  9 Bit 7:0  Byte  10 Bit 7:0  Byte  11 Bit 7:0 \u5982\u679c Message \u9009\u7528\u4e86\u5730\u5740\u8def\u7531\uff08\u89c1\u4e0a\u9762\u4ecb\u7ecd\u7684 Type[4:0]\u5b57\u6bb5\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b57\u6bb5\u7684\u5185\u5bb9\u5c31\u662f 64bit \u8d77\u59cb\u5730\u5740\u7684\u9ad8 32bit\u3002\u5982\u679c\u4f7f\u7528\u662f ID \u8def\u7531\uff0c\u90a3\u4e48 Byte8-9 \u5c31\u7ec4\u6210\u76ee\u6807 ID\u3002  \u5426\u5219\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u4e0d\u4f7f\u7528\u3002 Address[31:0]  \u4f4e 32bit \u5730\u5740 Byte  12 Bit 7:0  Byte  13 Bit 7:0  Byte  14 Bit 7:0  Byte  15 Bit 7:0 \u5982\u679c Message \u9009\u7528\u4e86\u5730\u5740\u8def\u7531\uff08\u89c1\u4e0a\u9762\u4ecb\u7ecd\u7684 Type[4:0]\u5b57\u6bb5\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b57\u6bb5\u7684\u5185\u5bb9\u5c31\u662f 64bit \u8d77\u59cb\u5730\u5740\u7684\u4f4e 32bit\uff08\u6700\u4f4e\u7684 2bit \u5fc5\u987b\u4e3a 0\uff0c\u4ee5\u4fdd\u6301 DW \u5bf9\u9f50\uff09\u3002  \u5426\u5219\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u4e0d\u4f7f\u7528\u3002 <p>\u8868 5\u20118 Message \u8bf7\u6c42 Header \u5404\u5b57\u6bb5</p>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-message-using-the-byte-count-modified-bit","title":"l Message \u6ce8\u610f\u4e8b\u9879\uff08Using The Byte Count Modified Bit\uff09","text":"<p>\u63a5\u4e0b\u6765\u51e0\u4e2a\u5c0f\u8282\u7684\u5217\u8868\u4f1a\u5217\u51fa 9 \u79cd Message \u7ec4\uff08\u5982\u8868 5\u20118 \u4e2d\u7ed9\u51fa\u7684\uff09\u7684\u5404\u81ea\u4f7f\u7528\u7684\u66f4\u5177\u4f53\u7684 Message Code\u3002\u8fd9 9 \u79cd Message \u7ec4\u4e3a\uff1a</p> <ol> <li> <p>INTx \u4e2d\u65ad\u4fe1\u53f7\uff08INTx Interrupt Signaling\uff09</p> </li> <li> <p>\u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09</p> </li> <li> <p>\u9519\u8bef\u4fe1\u53f7\uff08Error Signaling\uff09</p> </li> <li> <p>\u652f\u6301\u9501\u5b9a\u4e8b\u52a1\uff08Locked Transaction Support\uff09</p> </li> <li> <p>\u652f\u6301\u63d2\u69fd\u529f\u8017\u9650\u5236\uff08Slot Power Limit Support\uff09</p> </li> <li> <p>\u5382\u5546\u5b9a\u4e49\u7684 Message\uff08Vendor-Defined Message\uff09</p> </li> <li> <p>\u5ffd\u7565 Message\uff08Ignored Message\uff0c\u4e0e PCIe 1.1 \u4e2d\u7684\u70ed\u63d2\u62d4\u652f\u6301\u76f8\u5173\uff09</p> </li> <li> <p>\u5ef6\u8fdf\u5bb9\u5fcd\u62a5\u544a\uff08Latency Tolerance Reporting\uff0cLTR\uff09</p> </li> <li> <p>\u4f18\u5316\u7684 Buffer \u5237\u65b0\u548c\u586b\u6ee1\uff08Optimized Buffer Flush and Fill\uff0cOBFF\uff09</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-intx-messageintx-interrupt-messages","title":"l INTx \u4e2d\u65ad Message\uff08INTx Interrupt Messages\uff09","text":"<p>\u8bb8\u591a\u8bbe\u5907\u90fd\u9002\u7528 PCI 2.3 \u7684 MSI\uff08Message Signaled Interrupt\uff09\u65b9\u6cd5\u6765\u4f20\u8f93\u4e2d\u65ad\uff0c\u4f46\u662f\u5bf9\u4e8e\u8001\u7684\u8bbe\u5907\u6765\u8bf4\u53ef\u80fd\u4f1a\u4e0d\u652f\u6301 MSI\u3002\u5bf9\u4e8e\u8fd9\u4e9b\u60c5\u51b5\uff0cPCIe \u5b9a\u4e49\u4e86\u4e00\u4e2a\u201c\u865a\u62df\u7ebf virtual wire\u201d\u4f5c\u4e3a\u66ff\u4ee3\u65b9\u6848\uff0c\u8bbe\u5907\u901a\u8fc7\u53d1\u9001 Message \u6765\u6a21\u62df PCI \u4e2d\u65ad\u5f15\u811a\uff08INTA-INTD\uff09\u7684\u62c9\u8d77\u4e0e\u91ca\u653e\u3002\u4e2d\u65ad\u8bbe\u5907\u53d1\u51fa\u7b2c\u4e00\u4e2a Message \u6765\u901a\u77e5\u4e0a\u884c\u8bbe\u5907\u81ea\u5df1\u62c9\u8d77\u4e86\u4e00\u4e2a\u4e2d\u65ad\u3002\u4e00\u65e6\u8fd9\u4e2a\u4e2d\u65ad\u88ab\u54cd\u5e94\u5904\u7406\uff08Serviced\uff09\u4e86\uff0c\u90a3\u4e48\u4e2d\u65ad\u8bbe\u5907\u5c31\u53d1\u51fa\u7b2c\u4e8c\u4e2a Message \u6765\u8868\u793a\u8fd9\u4e2a\u201c\u865a\u62df\u4e2d\u65ad\u7ebf\u201d\u5df2\u7ecf\u91ca\u653e\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u79cd\u534f\u8bae\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cVirtual INTx Signaling\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u8868 5\u20119 INTx \u4e2d\u65ad\u4fe1\u53f7 Message \u7684\u4ee3\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528 INTx Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>INTx Message \u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64 Length \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> </li> <li> <p>\u5b83\u4eec\u53ea\u4f1a\u7531\u4e0a\u884c\u7aef\u53e3\uff08Upstream Port\uff09\u53d1\u51fa\u3002\u5bf9\u63a5\u6536\u5230\u7684\u6570\u636e\u5305\u8fdb\u884c\u8fd9\u65b9\u9762\u7684\u89c4\u5219\u68c0\u67e5\u662f\u53ef\u9009\u9879\uff0c\u4f46\u662f\u5982\u679c\u8fdb\u884c\u4e86\u68c0\u67e5\uff0c\u90a3\u4e48\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>INTx Message \u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578b TC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>\u94fe\u8def\u4e24\u7aef\u7684\u7ec4\u4ef6\u5fc5\u987b\u8ddf\u8e2a\u56db\u79cd\u865a\u62df\u4e2d\u65ad\uff08virtual interrupt\uff09\u7684\u72b6\u6001\u3002\u5982\u679c\u4e0a\u884c\u7aef\u53e3\u7684\u4e00\u4e2a\u4e2d\u65ad\u7684\u903b\u8f91\u72b6\u6001\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u53d1\u51fa\u76f8\u5e94\u7684 INTx Message\u3002</p> </li> <li> <p>\u5f53\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command Register\uff09\u4e2d\u7684 Interrupt Disable \u4f4d\u88ab\u7f6e\u4e3a 1 \u65f6\uff0cINTx \u4fe1\u53f7\u662f\u88ab\u7981\u7528\u7684\uff08\u5c31\u50cf\u7269\u7406\u4e2d\u65ad\u7ebf\u7684\u7c7b\u4f3c\u60c5\u51b5\u4e00\u6837\uff09\u3002</p> </li> <li> <p>\u5982\u679c\u5728 Interrupt Disable \u4f4d\u4e3a 1 \u65f6\uff0c\u8bbe\u5907\u7684\u4efb\u4f55\u4e00\u4e2a\u865a\u62df INTx \u4fe1\u53f7\u4ecd\u4e3a\u6fc0\u6d3b\u72b6\u6001\uff0c\u90a3\u4e48\u4e0a\u884c\u7aef\u53e3\u5fc5\u987b\u53d1\u51fa\u5bf9\u5e94\u7684\u91ca\u653e INTx Message\uff08Deassert_INTx Message\uff09\u3002</p> </li> <li> <p>Switch \u7684\u5404\u4e2a\u4e0b\u884c\u7aef\u53e3\u5fc5\u987b\u72ec\u7acb\u7684\u8ddf\u8e2a\u56db\u79cd INTx \u4fe1\u53f7\u72b6\u6001\uff0c\u5e76\u7ec4\u5408\u6210\u4e0a\u884c\u7aef\u53e3\u7684\u72b6\u6001\u3002</p> </li> <li> <p>RC \u7684\u5404\u4e2a\u4e0b\u884c\u7aef\u53e3\u5fc5\u987b\u72ec\u7acb\u7684\u8ddf\u8e2a\u4e0b\u884c\u7aef\u53e3\u7684 INTx \u4fe1\u53f7\u72b6\u6001\uff0c\u5e76\u5c06\u5b83\u4eec\u8f6c\u6362\u6210\u7cfb\u7edf\u4e2d\u65ad\uff0c\u5177\u4f53\u7684\u8f6c\u6362\u65b9\u5f0f\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u5b9a\u3002</p> </li> <li> <p>INTx Message \u4f7f\u7528\u201cLocal-Terminate at Receiver \u5728\u63a5\u6536\u8005\u672c\u5730\u7ed3\u675f\u201d\u7684\u8def\u7531\u7c7b\u578b\u6765\u4f7f\u5f97\u4e00\u4e2a Switch \u5728\u5fc5\u8981\u65f6\u5bf9\u6307\u5b9a\u7684\u4e2d\u65ad\u5f15\u811a\u8fdb\u884c\u91cd\u6620\u5c04\uff08\u53c2\u9605\u201cMapping and Collapsing INTx Messages\u201d\u4e00\u8282\uff09\u3002\u56e0\u6b64\uff0cINTx Message \u4e2d\u7684 Requester ID \u6709\u53ef\u80fd\u662f\u6700\u540e\u4e00\u4e2a\u4f20\u9001\u8005\u6240\u6307\u5b9a\u7684\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-messagepower-management-messages","title":"l \u7535\u6e90\u7ba1\u7406 Message\uff08Power Management Messages\uff09","text":"<p>PCIe \u5bf9 PCI \u7684\u7535\u6e90\u7ba1\u7406\u662f\u517c\u5bb9\u7684\uff0c\u5e76\u4e14\u8fd8\u52a0\u5165\u4e86\u57fa\u4e8e\u786c\u4ef6\u7684\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u3002Message \u662f\u7528\u6765\u4f20\u8fbe\u4e00\u4e9b\u5173\u4e8e\u7535\u6e90\u7ba1\u7406\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u5982\u679c\u60f3\u4e86\u89e3\u5b8c\u6574\u7684 PCIe \u7535\u6e90\u7ba1\u7406\u534f\u8bae\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u90a3\u4e48\u8bf7\u53c2\u9605 Chapter 16 \u201cPower Management\u201d\u4e00\u7ae0\u3002\u8868 5\u201110 \u603b\u7ed3\u4e86\u56db\u79cd\u7535\u6e90\u7ba1\u7406 Message \u7c7b\u578b\u3002</p> <p></p> <p>\u8868 5\u201110 \u7535\u6e90\u7ba1\u7406 Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528\u7535\u6e90\u7ba1\u7406 Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>\u7535\u6e90\u7ba1\u7406 Message \u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64 Length \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> </li> <li> <p>\u7535\u6e90\u7ba1\u7406 Message \u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578b TC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>\u5f53\u4e00\u4e2a\u4e0b\u884c\u7aef\u53e3\u6536\u5230\u4e86\u4e00\u4e2a\u94fe\u8def\u5bf9\u7aef\u7535\u6e90\u7ba1\u7406\u8bf7\u6c42\uff0c\u8bf7\u6c42\u8981\u5c06\u94fe\u8def\u7535\u6e90\u72b6\u6001\u66f4\u6539\u4e3a L1\uff0c\u4f46\u662f\u4e0b\u884c\u7aef\u53e3\u62d2\u7edd\u8fd9\u79cd\u66f4\u6539\uff0c\u90a3\u4e48\u5b83\u5c31\u8981\u53d1\u51fa PM_Active_State_Nak \u8fd9\u79cd\u7535\u6e90\u7ba1\u7406 Message\u3002</p> </li> <li> <p>\u5f53\u4e00\u4e2a\u7ec4\u4ef6\u8bf7\u6c42\u7535\u6e90\u7ba1\u7406\u4e8b\u4ef6\uff08Power Management Event\uff09\u65f6\uff0c\u5b83\u7684\u4e0a\u884c\u7aef\u53e3\u9700\u8981\u53d1\u51fa PM_PME\uff0c\u8fd9\u4e2a Message \u5c06\u88ab\u9690\u5f0f\u8def\u7531\u81f3 RC\u3002</p> </li> <li> <p>PM_Turn_Off \u4f1a\u5411\u4e0b\u53d1\u9001\u7ed9\u6240\u6709\u7684 EP\uff08\u7531 RC \u53d1\u51fa\uff0c\u8fdb\u884c\u9690\u5f0f\u8def\u7531\u7684\u5e7f\u64ad\uff09\u3002</p> </li> <li> <p>PME_TO_Ack \u662f\u7531 EP \u7684\u4e0a\u884c\u7aef\u53e3\u53d1\u51fa\u7684\u3002\u5bf9\u4e8e\u62e5\u6709\u591a\u4e2a\u4e0b\u884c\u7aef\u53e3\u7684 Switch \u6765\u8bf4\uff0c\u53ea\u6709\u5f53\u6240\u6709\u7684\u4e0b\u884c\u7aef\u53e3\u90fd\u6536\u5230\u4e86\u8fd9\u4e2a Message\uff0c\u624d\u4f1a\u5c06\u5176\u8f6c\u53d1\u81f3\u4e0a\u884c\uff08\u4e5f\u5c31\u662f\u6c47\u805a\u6536\u96c6\uff0c\u5e76\u8def\u7531\u8f6c\u53d1\u7ed9 RC\uff09\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-messageerror-messages","title":"l \u9519\u8bef Message\uff08Error Messages\uff09","text":"<p>\u5f53\u542f\u7528\u4e86\u9519\u8bef Message \u7684\u7ec4\u4ef6\u68c0\u6d4b\u5230\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06\u9519\u8bef Message \u5411\u4e0a\u53d1\u9001\uff08\u9690\u5f0f\u8def\u7531\u81f3 RC\uff09\u3002\u4e3a\u4e86\u534f\u52a9\u8f6f\u4ef6\uff0c\u8ba9\u8f6f\u4ef6\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u5904\u7406\u8fd9\u4e2a\u9519\u8bef\uff0c\u5728 Error Message \u4e2d\u4f7f\u7528 Header \u4e2d\u7684 Requester ID \u5b57\u6bb5\u6765\u8868\u793a\u8bf7\u6c42\u8005\u3002\u8868 5\u201111 \u603b\u7ed3\u4e86\u4e09\u79cd Error Message \u7c7b\u578b\u3002</p> <p></p> <p>\u8868 5\u201111 \u9519\u8bef Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528 Error Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>Error Message \u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64 Length \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> </li> <li> <p>Error Message \u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578b TC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>RC \u4f1a\u5c06 Error Message \u8f6c\u6362\u6210\u7cfb\u7edf\u6307\u5b9a\u7684\u4e8b\u4ef6\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-locked-transaction-support","title":"l \u652f\u6301\u9501\u5b9a\u4e8b\u52a1\uff08Locked Transaction Support\uff09","text":"<p>\u89e3\u9501 Message\uff08Unlock Message\uff09\u88ab\u5e94\u7528\u4e8e PCI \u5b9a\u4e49\u7684\u9501\u5b9a\u4e8b\u52a1\u534f\u8bae\u4e2d\uff08Locked Transaction Protocol\uff09\uff0c\u5e76\u4e14\u5728 PCIe \u4e2d\u4f9d\u7136\u5bf9\u4f20\u7edf PCI \u9057\u7559\u8bbe\u5907\u53ef\u7528\u3002\u8fd9\u79cd\u534f\u8bae\u8d77\u59cb\u4e8e\u4e00\u4e2a MRd Lock \u8bf7\u6c42\u3002\u5f53\u8fd9\u4e2a\u8bf7\u6c42\u5728\u88ab\u9001\u8fbe\u5230\u76ee\u6807\u8bbe\u5907\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6cbf\u9014\u7684\u7aef\u53e3\u4eec\u90fd\u4f1a\u53d1\u73b0\u5b83\uff0c\u8fd9\u4e9b\u7aef\u53e3\u4f1a\u5b9e\u73b0\u4e00\u4e2a\u539f\u5b50\u201c\u8bfb-\u4fee\u6539-\u5199\u201d\u534f\u8bae\uff08read-modify-write protocol\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u4eec\u5c06\u4f1a\u9501\u5b9a VC0\uff08Virtual Channel 0\uff09\u8ba9\u5176\u4ed6\u7684\u8bf7\u6c42\u4e0d\u80fd\u4f7f\u7528\uff0c\u76f4\u5230\u6536\u5230 Unlock Message \u624d\u4f1a\u5bf9 VC0 \u89e3\u9501\u3002\u8fd9\u79cd Unlock Message \u4f1a\u88ab\u53d1\u9001\u81f3 Locked \u4e8b\u52a1\u7684\u76ee\u6807\u8bbe\u5907\uff0c\u4ee5\u6b64\u6765\u91ca\u653e\u4f20\u8f93\u8def\u5f84\u4e2d\u7684\u6240\u6709\u88ab\u9501\u5b9a\u7684\u7aef\u53e3\uff0c\u5e76\u7528\u4e8e\u6700\u7ec8\u5b8c\u6210\u9501\u5b9a\u4e8b\u52a1\u7684\u4e00\u7cfb\u5217\u884c\u4e3a\u3002\u8868 5\u201112 \u603b\u7ed3\u4e86 Unlock Message \u7684\u6807\u8bc6\u7801\u3002</p> <p></p> <p>\u8868 5\u201112 \u89e3\u9501 Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528 Unlock Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>Unlock Message \u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64 Length \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> </li> <li> <p>Unlock Message \u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578b TC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-messageset-slot-power-limit-message","title":"l \u8bbe\u7f6e\u63d2\u69fd\u529f\u7387\u9650\u5236 Message\uff08Set Slot Power Limit Message\uff09","text":"<p>\u8fd9\u79cd Message \u662f\u7531\u4e0b\u884c\u7aef\u53e3\u53d1\u9001\u7ed9\u63d2\u5728\u63d2\u69fd\u4e0a\u7684\u8bbe\u5907\u7684\u3002\u8fd9\u91cc\u9762\u7684\u529f\u7387\u9650\u5236\u4fe1\u606f\u4f1a\u50a8\u5b58\u5728 EP \u7684\u8bbe\u5907\u80fd\u529b\u5bc4\u5b58\u5668\u4e2d\uff08Device Capabilities Register\uff09\u3002\u8868 5\u201112 \u603b\u7ed3\u4e86 Unlock Message \u7684\u6807\u8bc6\u7801\u3002</p> <p></p> <p>\u8868 5\u201113 \u63d2\u69fd\u529f\u7387\u9650\u5236 Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528 Set Slot Power Limit Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>Set Slot Power Limit Message \u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578b TC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62 TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>Set Slot Power Limit Message \u7684\u6570\u636e\u8377\u8f7d\u4e3a 1DW\uff0c\u56e0\u6b64 Length \u5b57\u6bb5\u7684\u503c\u4e3a 1\u3002\u800c\u5728 32bit \u6570\u636e\u8377\u8f7d\u4e2d\u4ec5\u6709\u4f4e 10bit \u7528\u4e8e\u8fdb\u884c\u63d2\u69fd\u529f\u7387\u653e\u5927\u6216\u51cf\u5c0f\uff1b\u5269\u4e0b\u7684\u9ad8\u4f4d\u5fc5\u987b\u90fd\u7f6e\u4e3a 0\u3002</p> </li> <li> <p>\u5f53\u6570\u636e\u94fe\u8def\u5c42\u8f6c\u6362\u4e3a DL-Up \u72b6\u6001\u65f6\uff0c\u8be5\u6d88\u606f\u4f1a\u81ea\u52a8\u53d1\u9001\u3002\u6216\u8005\u662f\u653e\u6570\u636e\u94fe\u8def\u5c42\u5df2\u7ecf\u62a5\u544a\u4e86 DL-Up \u72b6\u6001\uff0c\u7136\u540e\u53d1\u751f\u4e86\u4e00\u4e2a\u914d\u7f6e\u5199\u6765\u5199\u5165 Slot Capabilities Register \u65f6\uff0c\u8be5\u6d88\u606f\u4e5f\u4f1a\u81ea\u52a8\u53d1\u9001\u3002</p> </li> <li> <p>\u5982\u679c\u63d2\u69fd\u4e2d\u7684\u677f\u5361\u6d88\u8017\u7684\u529f\u7387\u5df2\u7ecf\u4f4e\u4e8e\u4e86\u6307\u5b9a\u7684\u529f\u7387\u9650\u5236\uff0c\u90a3\u4e48\u53ef\u4ee5\u5ffd\u7565\u8fd9\u79cd Message\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-message-0-1vendor-defined-message-0-and-1","title":"l \u5382\u5546\u5b9a\u4e49\u7684 Message 0 \u548c 1\uff08Vendor-Defined Message 0 and 1\uff09","text":"<p>Vendor-Defined Message \u662f\u7528\u4e8e\u8fdb\u884c PCIe Message \u80fd\u529b\u7684\u6269\u5c55\uff0c\u8fd9\u79cd\u6269\u5c55\u65e2\u53ef\u4ee5\u901a\u8fc7\u534f\u8bae\u672c\u8eab\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5382\u5546\u6765\u6307\u5b9a\u7684\u6269\u5c55\u3002\u8fd9\u79cd Message \u7684 Header \u683c\u5f0f\u5982\u56fe 5\u201112 \u6240\u793a\uff0cMessage \u6807\u8bc6\u7801\u5982\u8868 5\u201112\u3002</p> <p></p> <p>\u56fe 5\u201112 \u5382\u5546\u5b9a\u4e49\u7684 Message Header \u683c\u5f0f</p> <p></p> <p>\u8868 5\u201114 \u5382\u5546\u5b9a\u4e49\u7684 Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528Vendor-Defined Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>Vendor-Defined Message 0 \u548c1 \u53ef\u4ee5\u6709\u4e5f\u53ef\u4ee5\u6ca1\u6709\u6570\u636e\u8377\u8f7d\u3002</p> </li> <li> <p>Message \u7528Vendor ID \u6765\u8fdb\u884c\u533a\u5206\u3002</p> </li> <li> <p>Attr[2]\u548cAttr[1:0]\u5e76\u4e0d\u662f\u4fdd\u7559\u4f4d\u3002</p> </li> <li> <p>\u5982\u679c\u63a5\u6536\u8005\u65e0\u6cd5\u8ba4\u51fa\u8fd9\u79cdMessage\uff1a</p> <ul> <li> <p>Type 1 Message \u53ef\u4ee5\u88ab\u5b89\u9759\u7684\u5ffd\u7565\u4e22\u5f03\u6389\u3002</p> </li> <li> <p>Type 0 Message \u8981\u88ab\u4f5c\u4e3aUnsupported Request\uff08UR\uff09\u8fd9\u79cd\u9519\u8bef\u60c5\u51b5\u6765\u5904\u7406\u3002</p> </li> </ul> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-messageignored-message","title":"l \u88ab\u5ffd\u7565\u7684Message\uff08Ignored Message\uff09","text":"<p>\u5982\u679c\u76f4\u63a5\u5217\u51fa\u4e00\u6574\u4e2a\u76ee\u5f55\u7684\u9700\u8981\u88ab\u5ffd\u7565\u7684Message\uff0c\u800c\u4e0d\u53bb\u8bb2\u5ffd\u7565\u7684\u524d\u56e0\u540e\u679c\uff0c\u90a3\u53ef\u80fd\u4f1a\u542c\u8d77\u6765\u6709\u4e00\u4e9b\u5947\u602a\u3002\u8fd9\u4e9bMessage \u5176\u5b9e\u662f\u539f\u6765\u7684\u70ed\u63d2\u62d4\u4fe1\u53f7Message\uff08Hot Plug Signaling Message\uff09\uff0c\u5b83\u4eec\u7528\u4e8e\u652f\u6301\u8bbe\u5907\uff0c\u8fd9\u4e9b\u8bbe\u5907\u4e0a\u5177\u6709\u70ed\u63d2\u62d4\u6307\u793a\u5668\uff0c\u5e76\u4e14\u53ea\u9700\u8981\u6309\u4e0b\u8fd9\u4e2a\u63d2\u5361\u8bbe\u5907\u4e0a\u7684\u6309\u94ae\u800c\u4e0d\u662f\u7cfb\u7edf\u677f\u4e0a\u7684\u6309\u94ae\u3002\u8fd9\u79cdMessage \u7c7b\u578b\u662f\u7531PCIe 1.0a \u7248\u672c\u6240\u5b9a\u4e49\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u9009\u9879\u5728PCIe 1.1 \u7248\u672c\u4e2d\u5c31\u5df2\u7ecf\u4e0d\u518d\u652f\u6301\u4e86\uff0c\u56e0\u6b64\u8fd9\u91cc\u6240\u8bb2\u7684\u8fd9\u4e9b\u7ec6\u8282\u5185\u5bb9\u4ec5\u4f5c\u4e3a\u53c2\u8003\u3002\u6b63\u5982\u540d\u5b57\u8981\u8868\u8fbe\u7684\u90a3\u6837\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d1\u9001\u65b9\u4e0d\u8981\u53d1\u9001\u8fd9\u4e9bMessage\uff0c\u5e76\u4e14\u4e5f\u5f3a\u70c8\u5efa\u8bae\u63a5\u6536\u65b9\u5c31\u7b97\u6536\u5230\u5b83\u4eec\u4e5f\u8981\u5ffd\u89c6\u6389\u3002\u5982\u679c\u65e0\u8bba\u5982\u4f55\u4ecd\u8981\u4f7f\u7528\u8fd9\u4e9bMessage\uff0c\u90a3\u4e48\u5b83\u4eec\u5fc5\u987b\u8981\u7b26\u5408PCIe 1.0a \u7684\u534f\u8bae\u7ec6\u8282\u3002</p> <p></p> <p>\u8868 5\u201115 \u70ed\u63d2\u62d4Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528Hot Plug Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>Hot Plug Message \u7531\u4e0b\u884c\u7aef\u53e3\u53d1\u9001\u7ed9\u63d2\u69fd\u4e2d\u7684\u677f\u5361\u3002</p> </li> <li> <p>Attention_Button Message \u662f\u7531\u63d2\u69fd\u4e2d\u7684\u8bbe\u5907\u5411\u4e0a\u884c\u53d1\u9001\u7684\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-messagelatency-tolerance-reporting-message","title":"l \u5ef6\u8fdf\u5bb9\u5fcd\u62a5\u544aMessage\uff08Latency Tolerance Reporting Message\uff09","text":"<p>LTR Message \u662f\u7528\u6765\u62a5\u544a\u4e00\u4e2a\u8bbe\u5907\u53ef\u63a5\u53d7\u7684\u8bfb\u5199\u670d\u52a1\u5ef6\u8fdf\uff0c\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u9879\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u79cd\u7535\u6e90\u7ba1\u7406\u6280\u672f\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cLTR\uff08Latency Tolerance Reporting\uff09\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 5\u201113 LTR Message Header \u683c\u5f0f</p> <p></p> <p>\u8868 5\u201116 LTR Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528LTR Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>LTR Message \u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> </li> <li> <p>LTR Message \u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> </li> </ol>"},{"location":"pcie/05%20TLP%20%E5%85%83%E7%B4%A0/#l-buffer-messageoptimized-buffer-flush-and-fill","title":"l \u4f18\u5316\u7684Buffer \u5237\u65b0\u548c\u586b\u5145Message\uff08Optimized Buffer Flush and Fill\uff09","text":"<p>OBFF Message \u7528\u6765\u5411EP \u62a5\u544a\u5e73\u53f0\u7535\u6e90\u60c5\u51b5\uff0c\u4ee5\u6b64\u6765\u4fc3\u8fdb\u66f4\u9ad8\u6548\u7684\u7cfb\u7edf\u7535\u6e90\u7ba1\u7406\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u79cd\u6280\u672f\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cOBBF\uff08Optimized Buffer Flush and Fill\uff09\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 5\u201114 OBBF Message Header \u683c\u5f0f</p> <p></p> <p>\u8868 5\u201117 OBBF Message \u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528OBFF Message \u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <ol> <li> <p>OBFF Message \u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length \u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> </li> <li> <p>OBFF Message \u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> </li> <li> <p>Header \u4e2d\u7684Requester ID \u5fc5\u987b\u4e3a\u4f20\u9001\u4e2d\u7684\u7aef\u53e3\u7684ID\u3002</p> </li> </ol> <p>\u539f\u6587\uff1a  Mindshare</p> <p>\u8bd1\u8005\uff1a  Michael ZZY</p> <p>\u6821\u5bf9\uff1a  </p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/","title":"06 \u6d41\u91cf\u63a7\u5236","text":""},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#chapter-6-flow-control","title":"Chapter 6      Flow Control //\u6d41\u91cf\u63a7\u5236","text":""},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#_1","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u8282\u8ba8\u8bba\u4e86\u4e3b\u8981\u7684\u4e09\u79cd\u7c7b\u578b\u7684\u6570\u636e\u5305\uff1aTLP \u4e8b\u52a1\u5c42\u5305\uff08Transaction Layer Packets\uff09\u3001DLLP \u6570\u636e\u94fe\u8def\u5c42\u5305\uff08Data Link Layer Packets\uff09\u3001Ordered Sets \u547d\u4ee4\u96c6\u3002\u5e76\u4e14\u5728\u4e0a\u4e00\u7ae0\u4e2d\u4e3b\u8981\u8bb2\u8ff0 TLP \u7684\u7528\u6cd5\u3001\u683c\u5f0f\u548c\u4e0d\u540c\u79cd\u7c7b\u7684\u5b9a\u4e49\uff0c\u5e76\u5c06\u8be6\u7ec6\u7684\u8bb2\u89e3 TLP \u7684\u76f8\u5173\u5b57\u6bb5\u542b\u4e49\u3002\u5173\u4e8e DLLP \u7684\u5185\u5bb9\u5c06\u4f1a\u5728 Chapter 9 \u201cDLLP Element\u201d\u4e2d\u8fdb\u884c\u5355\u72ec\u8bb2\u89e3\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u8ba8\u8bba\u6d41\u91cf\u63a7\u5236\u534f\u8bae\uff08Flow Control\uff09\u7684\u76ee\u7684\u4ee5\u53ca\u7ec6\u8282\u64cd\u4f5c\u3002\u6d41\u91cf\u63a7\u5236\u662f\u7528\u6765\u786e\u4fdd\u5728\u63a5\u6536\u8005\u65e0\u6cd5\u63a5\u6536 TLP \u65f6\uff0c\u53d1\u9001\u65b9\u4e0d\u4f1a\u518d\u7ee7\u7eed\u53d1\u9001 TLP\u3002\u8fd9\u907f\u514d\u4e86\u63a5\u6536 Buffer \u6ea2\u51fa\uff0c\u4e5f\u6d88\u9664\u4e86\u539f\u672c PCI \u5de5\u4f5c\u65b9\u5f0f\u4e2d\u7684\u4e00\u4e9b\u4f4e\u6548\u884c\u4e3a\uff0c\u6bd4\u5982\u65ad\u5f00\uff08disconnect\uff09\u3001\u91cd\u8bd5\uff08retry\uff09\u548c\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u5c06\u4f1a\u8ba8\u8bba\u7528\u4e8e\u652f\u6301 QoS\uff08Quality of Service\uff09\u7684\u673a\u5236\uff0c\u5e76\u63cf\u8ff0\u5bf9\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u4e0d\u540c\u6570\u636e\u5305\u7684\u4f20\u8f93\u65f6\u95f4\u548c\u5e26\u5bbd\u8fdb\u884c\u63a7\u5236\u7684\u610f\u4e49\u3002\u8fd9\u4e9b\u673a\u5236\u5305\u62ec\uff0c\u7279\u5b9a\u5e94\u7528\u7684\u8f6f\u4ef6\u5c06\u4f1a\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u8bbe\u5907\u5185\u6784\u5efa\u53ef\u9009\u7684\u786c\u4ef6\u6765\u542f\u7528\u4e8b\u52a1\u4f18\u5148\u7ea7\u7ba1\u7406\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#61-flow-control-concept","title":"6.1 \u6d41\u91cf\u63a7\u5236\u6982\u5ff5\uff08Flow Control Concept\uff09","text":"<p>\u6bcf\u6761 PCIe \u94fe\u8def\u4e24\u7aef\u7684\u7aef\u53e3\u90fd\u5fc5\u987b\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236\u673a\u5236\u3002\u5728\u4e00\u4e2a\u6570\u636e\u5305\u5141\u8bb8\u88ab\u53d1\u51fa\u4e4b\u524d\uff0c\u6d41\u91cf\u63a7\u5236\u673a\u5236\u5fc5\u987b\u786e\u8ba4\u63a5\u6536\u7aef\u53e3\u62e5\u6709\u8db3\u591f\u7684\u53ef\u7528 Buffer \u7a7a\u95f4\u6765\u63a5\u6536\u6570\u636e\u5305\u3002\u800c\u5728\u50cf PCI \u8fd9\u79cd\u5e76\u884c\u603b\u7ebf\u4e2d\uff0c\u5c3d\u7ba1\u4e0d\u77e5\u9053\u76ee\u6807\u65b9\u662f\u5426\u51c6\u5907\u597d\u4e86\u5904\u7406\u6570\u636e\uff0c\u4e8b\u52a1\u4e5f\u4f1a\u5c1d\u8bd5\u53bb\u53d1\u9001\u6267\u884c\uff0c\u5982\u679c\u56e0\u4e3a\u6ca1\u6709\u8db3\u591f\u7684\u53ef\u7528 Buffer \u7a7a\u95f4\uff0c\u8bf7\u6c42\u88ab\u62d2\u7edd\u4e86\uff0c\u90a3\u4e48\u4e8b\u52a1\u5c31\u4f1a\u4e00\u76f4\u91cd\u8bd5\uff08Retry\uff09\u76f4\u81f3\u5b8c\u6210\u3002\u8fd9\u5c31\u662f PCI \u7684\u201cDelayed Transaction Model \u5ef6\u8fdf\u7684\u4e8b\u52a1\u6a21\u578b\u201d\uff0c\u7136\u800c\u8fd9\u79cd\u65b9\u5f0f\u7684\u6548\u7387\u5f88\u4f4e\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\u673a\u5236\u53ef\u4ee5\u6539\u5584\u5f53\u591a\u4e2a\u865a\u62df\u901a\u9053\uff08Virtual Channel\uff0cVC\uff09\u88ab\u5360\u7528\u65f6\u7684\u4f20\u8f93\u6548\u7387\u3002\u6bcf\u4e2a\u865a\u62df\u901a\u9053\u81ea\u5df1\u7684\u4e8b\u52a1\u662f\u4e0e\u5176\u4ed6 VC \u7684\u4e8b\u52a1\u6d41\u91cf\u76f8\u72ec\u7acb\u7684\uff0c\u56e0\u4e3a\u6d41\u91cf\u63a7\u5236 Buffer \u662f VC \u5404\u81ea\u5355\u72ec\u7ef4\u62a4\u7684\u3002\u56e0\u6b64\uff0c\u82e5\u4e00\u4e2a VC \u7684\u6d41\u63a7 Buffer \u6ee1\u4e86\uff0c\u5b83\u4e5f\u4e0d\u4f1a\u963b\u585e\u5bf9\u5176\u4ed6 VC Buffer \u7684\u8bbf\u95ee\u3002PCIe \u652f\u6301\u6700\u591a 8 \u6761\u865a\u62df\u901a\u9053\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\u673a\u5236\u4f7f\u7528\u4e00\u79cd\u57fa\u4e8e\u4fe1\u7528\uff08Credit-based\uff09\u7684\u673a\u5236\uff0c\u4f7f\u5f97\u53d1\u9001\u7aef\u53e3\u53ef\u4ee5\u77e5\u9053\u63a5\u6536\u7aef\u53e3\u6709\u591a\u5c11\u53ef\u7528\u7684 Buffer \u7a7a\u95f4\u3002\u4f5c\u4e3a\u5b83\u4eec\u521d\u59cb\u5316\u7684\u4e00\u90e8\u5206\uff0c\u6bcf\u4e2a\u63a5\u6536\u8005\u90fd\u8981\u5c06\u81ea\u5df1\u7684 Buffer \u5927\u5c0f\u62a5\u544a\u7ed9\u94fe\u8def\u5bf9\u7aef\u7684\u53d1\u9001\u8005\uff0c\u5e76\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f7f\u7528 DLLP \u6765\u5b9a\u671f\u5730\u66f4\u65b0\u8fd9\u4e2a\u201c\u4fe1\u7528\u503c\u201d\u3002\u6280\u672f\u4e0a\u6765\u8bf4\uff0cDLLP \u663e\u7136\u662f\u4e00\u79cd\u5f00\u9500\uff0c\u56e0\u4e3a\u5b83\u5e76\u4e0d\u643a\u5e26\u4efb\u4f55\u6570\u636e\u8377\u8f7d\uff0c\u4f46\u662f DLLP \u5f00\u9500\u5f88\u5c0f\uff08\u59cb\u7ec8\u4e3a 8 \u4e2a\u7b26\u53f7\u5927\u5c0f\uff09\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u5176\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u6700\u5c0f\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\u903b\u8f91\u5b9e\u9645\u4e0a\u662f\u4e24\u4e2a\u5c42\u7ea7\u7684\u5171\u540c\u804c\u8d23\uff1a\u4e8b\u52a1\u5c42\u5305\u542b\u4e86\u8ba1\u6570\u5668\u7528\u4e8e\u5bf9\u53ef\u7528 Buffer \u7a7a\u95f4\u8fdb\u884c\u8ba1\u6570\uff0c\u4f46\u662f\u6570\u636e\u94fe\u8def\u5c42\u4e5f\u8981\u8d1f\u8d23\u53d1\u9001\u548c\u63a5\u6536\u8fd9\u4e9b\u5305\u542b\u4e86\u53ef\u7528 Buffer \u7a7a\u95f4\u4fe1\u606f\u7684 DLLP\u3002\u5982\u56fe 6\u20111 \u5c55\u793a\u4e86\u8fd9\u79cd\u5171\u540c\u804c\u8d23\u3002\u5728\u6d41\u91cf\u63a7\u5236\u7684\u7684\u5de5\u4f5c\u8fc7\u7a0b\u4e2d\uff1a</p> <ul> <li> <p>\u8bbe\u5907\u62a5\u544a\u53ef\u7528\u7684 Buffer \u7a7a\u95f4\uff1a\u63a5\u6536\u8005\u7684\u6bcf\u4e2a\u7aef\u53e3\u90fd\u8981\u62a5\u544a\u81ea\u5df1\u7684\u6d41\u91cf\u63a7\u5236 Buffer \u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a credit\uff08\u4fe1\u7528\uff09\u3002\u4e00\u4e2a Buffer \u4e2d credit \u7684\u6570\u91cf\u4f1a\u4ece\u81ea\u8eab\u63a5\u6536\u4fa7\u4e8b\u52a1\u5c42\u53d1\u9001\u81f3\u53d1\u9001\u4fa7\u6570\u636e\u94fe\u8def\u5c42\uff08\u5982\u56fe 6\u20111\uff09\u3002\u5728\u5408\u9002\u7684\u65f6\u95f4\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c06\u4f1a\u4ea7\u751f\u4e00\u4e2a\u6d41\u91cf\u63a7\u5236 DLLP \u6765\u5c06\u8fd9\u4e2a credit \u4fe1\u606f\u8f6c\u53d1\u81f3\u6bcf\u4e2a\u6d41\u91cf\u63a7\u5236 Buffer \u7684\u94fe\u8def\u5bf9\u7aef\u7684\u63a5\u6536\u8005\u7684\u3002</p> </li> <li> <p>\u63a5\u6536\u8005\u5bc4\u5b58 Credit\uff1a\u63a5\u6536\u8005\u6536\u5230\u6d41\u91cf\u63a7\u5236 DLLP\uff0c\u5e76\u5c06 credit \u503c\u4f20\u8f93\u81f3\u81ea\u8eab\u53d1\u9001\u4fa7\u4e8b\u52a1\u5c42\u3002\u8fd9\u5c31\u5b8c\u6210\u4e86 credit \u4ece\u94fe\u8def\u7684\u4e00\u7aef\u5230\u5bf9\u7aef\u7684\u4f20\u8f93\u3002\u8fd9\u4e9b\u64cd\u4f5c\u662f\u53cc\u5411\u8fdb\u884c\u7684\uff0c\u76f4\u5230\u6240\u6709\u7684\u6d41\u91cf\u63a7\u5236\u4fe1\u606f\u90fd\u5b8c\u6210\u4e86\u4ea4\u6362\u3002</p> </li> <li> <p>\u53d1\u9001\u8005\u68c0\u67e5 Credit\uff1a\u5728\u53d1\u9001\u8005\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2a TLP \u4e4b\u524d\uff0c\u5b83\u9700\u8981\u68c0\u67e5\u6d41\u91cf\u63a7\u5236\u8ba1\u6570\u5668\uff08Flow Control Counter\uff09\uff0c\u4ee5\u6b64\u6765\u77e5\u9053\u5bf9\u65b9\u662f\u5426\u6709\u8db3\u591f\u7684 credit\u3002\u5982\u679c credit \u6570\u91cf\u8db3\u591f\uff0c\u90a3\u4e48\u5c31\u5c06 TLP \u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\uff0c\u4f46\u662f\u5982\u679c credit \u4e0d\u8db3\uff0c\u90a3\u4e48 TLP \u7684\u53d1\u9001\u64cd\u4f5c\u5c31\u4f1a\u88ab\u963b\u585e\u76f4\u81f3\u83b7\u77e5\u7684\u66f4\u591a\u7684\u8db3\u591f\u7684\u6d41\u91cf\u63a7\u5236 credit\u3002</p> </li> </ul> <p></p> <p>\u56fe 6\u20111 \u6d41\u91cf\u63a7\u5236\u903b\u8f91\u6240\u5904\u7684\u4f4d\u7f6e</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#62-buffer-creditflow-control-buffer-and-credits","title":"6.2 \u6d41\u91cf\u63a7\u5236 Buffer \u548c Credit\uff08Flow Control Buffer and Credits\uff09","text":"<p>\u4e00\u4e2a\u7aef\u53e3\u6240\u652f\u6301\u7684\u6bcf\u4e2a VC\uff08Virtual Channel\uff09\u8d44\u6e90\u90fd\u4f1a\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236 Buffer\u3002\u56de\u60f3\u4e00\u4e0b\uff0c\u94fe\u8def\u4e24\u7aef\u7684\u7aef\u53e3\u53ef\u80fd\u652f\u6301\u7684 VC \u6570\u91cf\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u6b64\u7531\u8f6f\u4ef6\u8fdb\u884c\u914d\u7f6e\u548c\u542f\u7528\u7684 VC \u7684\u6700\u5927\u6570\u91cf\u5c31\u662f\u4e24\u4e2a\u7aef\u53e3\u95f4\u7684\u6700\u5927\u516c\u5171 VC \u6570\u91cf\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#621-vc-buffer-vc-flow-control-buffer-organization","title":"6.2.1     VC \u6d41\u91cf\u63a7\u5236 Buffer \u7684\u7ec4\u6210\uff08VC Flow Control Buffer Organization\uff09","text":"<p>\u63a5\u6536\u8005\u7684\u6bcf\u4e2a VC \u6d41\u63a7 buffer \u662f\u6309\u7167\u901a\u8fc7 VC \u7684\u6bcf\u79cd\u4e8b\u52a1\u7c7b\u522b\u6765\u8fdb\u884c\u7ba1\u7406\u7684\u3002\u8fd9\u4e9b\u7c7b\u522b\u4e3a\uff1a</p> <ul> <li> <p>Posted \u4e8b\u52a1\u2014\u2014MWr\uff08Memory Write\uff09\u548c Message</p> </li> <li> <p>Non-Posted \u4e8b\u52a1\u2014\u2014MRd\uff08Memory Read\uff09\u3001\u914d\u7f6e\u8bfb/\u5199\u3001IO \u8bfb/\u5199</p> </li> <li> <p>\u5b8c\u6210\u5305\u2014\u2014\u8bfb\u548c\u5199\u5b8c\u6210\u5305</p> </li> </ul> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u6bcf\u4e2a\u65e2\u6709 Header \u4e5f\u6709\u6570\u636e\u8377\u8f7d\u7684\u4e8b\u52a1\u7c7b\u522b\uff0c\u90fd\u4f1a\u88ab\u5206\u6210 Header \u548c\u6570\u636e\u4e24\u90e8\u5206\u3002\u8fd9\u5c06\u4ea7\u51fa 6 \u79cd\u4e0d\u540c\u7684 Buffer\uff0c\u6bcf\u4e2a Buffer \u90fd\u5b9e\u73b0\u81ea\u5df1\u7684\u6d41\u63a7\u3002\uff08\u89c1\u56fe 6\u20112\uff09\u3002</p> <p></p> <p>\u56fe 6\u20112 \u6d41\u63a7 Buffer \u7ec4\u6210</p> <p>\u5bf9\u4e8e\u6709\u4e9b\u4e8b\u52a1\uff0c\u4f8b\u5982\u8bfb\u8bf7\u6c42\uff0c\u5b83\u53ea\u7531 Header \u7ec4\u6210\uff0c\u800c\u50cf\u5199\u8bf7\u6c42\u5c31\u65e2\u6709 Header \u4e5f\u6709\u6570\u636e\u8377\u8f7d\u3002\u53d1\u9001\u8005\u5fc5\u987b\u786e\u8ba4 Header \u7684 Buffer \u7a7a\u95f4\u548c\u6570\u636e\u8377\u8f7d\u7684 Buffer \u7a7a\u95f4\u90fd\u6ee1\u8db3\u4e86\u4e8b\u52a1\u4f20\u8f93\u7684\u9700\u6c42\uff0c\u624d\u80fd\u53d1\u9001\u4e8b\u52a1\u3002\u6ce8\u610f\uff0c\u5f53\u4e8b\u52a1\u88ab\u8f6c\u53d1\u81f3\u8f6f\u4ef6\u6216\u8005\u662f\u5728 Switch \u4e2d\u88ab\u8f6c\u53d1\u81f3\u51fa\u53e3\u7aef\u53e3\u65f6\uff0c\u5fc5\u987b\u5728 VC \u6d41\u63a7 Buffer \u4e2d\u4fdd\u6301\u4e8b\u52a1\u987a\u5e8f\u3002\u56e0\u6b64\uff0c\u63a5\u6536\u8005\u4e5f\u5fc5\u987b\u8ddf\u8e2a Buffer \u5185\u7684 Header \u548c\u6570\u636e\u8377\u8f7d\u7684\u987a\u5e8f\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#622-creditflow-control-credits","title":"6.2.2     \u6d41\u63a7 Credit\uff08Flow Control Credits\uff09","text":"<p>\u63a5\u6536\u8005\u9700\u8981\u62a5\u544a Buffer \u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u4f7f\u7528\u7684\u5355\u4f4d\u662f Credit\uff0c\u6216\u8005\u53eb\u6d41\u91cf\u63a7\u5236 Credit\u3002Header \u548c\u6570\u636e\u8377\u8f7d Buffer \u7684\u4e00\u4e2a\u6d41\u63a7 Credit\uff08FCC\uff0cFlow Control Credit\uff09\u7684\u5927\u5c0f\u503c\u5206\u522b\u4e3a\uff1a</p> <ul> <li>Header Credit\uff1aHeader \u5927\u5c0f\u7684\u6700\u5927\u503c+digest</li> </ul> <p>\u2014  \u5b8c\u6210\u5305\u4e3a 4DW</p> <p>\u2014  \u8bf7\u6c42\u5305\u4e3a 5DW</p> <ul> <li>\u6570\u636e Credit\uff1a4DW\uff0816byte \u5bf9\u9f50\uff09</li> </ul> <p>\u6d41\u91cf\u63a7\u5236 DLLP \u4f1a\u4f20\u8fbe\u8fd9\u4e2a\u4fe1\u606f\uff0c\u800c DLLP \u81ea\u8eab\u7684\u4f20\u8f93\u662f\u4e0d\u9700\u8981\u6d41\u63a7 Credit \u7684\u3002\u8fd9\u662f\u56e0\u4e3a DLLP \u4ea7\u751f\u548c\u7ec8\u7ed3\u7684\u5730\u65b9\u90fd\u662f\u5728\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5e76\u4e0d\u9700\u8981\u4f7f\u7528\u5230\u4e8b\u52a1\u5c42 Buffer\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#63-initial-flow-control-advertisement","title":"6.3 \u521d\u59cb\u6d41\u91cf\u63a7\u5236\u901a\u544a\uff08Initial Flow Control Advertisement\uff09","text":"<p>\u5728\u6d41\u63a7\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\uff0cPCIe \u8bbe\u5907\u4eec\u4f1a\u901a\u8fc7\u5bf9 Buffer \u7a7a\u95f4\u7684\u6d41\u63a7 Credit \u8fdb\u884c\u201cadvertising \u901a\u544a\u201d\u7684\u65b9\u5f0f\uff0c\u6765\u76f8\u4e92\u4f20\u8fbe\u5404\u81ea\u7684 Buffer \u5927\u5c0f\u3002PCIe \u4e5f\u4e13\u95e8\u5b9a\u4e49\u4e86\u4e00\u4e9b Buffer \u9700\u8981\u7684\u6d41\u63a7 Credit \u521d\u59cb\u503c\u3002\u4e00\u4e2a\u901a\u544a\u8fc7\u81ea\u5df1\u7684\u521d\u59cb Buffer \u7a7a\u95f4\u7684\u63a5\u53d7\u8005\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u4fdd\u8bc1\u5b83\u7684 Buffer \u7a7a\u95f4\u6c38\u8fdc\u4e0d\u4f1a\u6ea2\u51fa\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#631-minimum-and-maximum-flow-control-advertisement","title":"6.3.1     \u6d41\u63a7\u901a\u544a\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff08Minimum and Maximum Flow Control Advertisement\uff09","text":"<p>\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u5404\u79cd\u4e0d\u540c\u7684\u6d41\u63a7 Buffer \u7c7b\u578b\u6240\u62a5\u544a\u7684 Credit \u6570\u91cf\u7684\u6700\u5c0f\u503c\uff0c\u8868 6\u20111 \u5217\u51fa\u4e86\u8fd9\u4e9b Buffer \u7c7b\u578b\u5bf9\u5e94\u7684 Credit \u6700\u5c0f\u503c\u3002\u7136\u800c\uff0c\u8bbe\u5907\u4e00\u822c\u901a\u544a\u7684 Credit \u6570\u91cf\u4f1a\u8fdc\u5927\u4e8e\u6700\u5c0f\u503c\uff0c\u8868 6\u20112 \u5217\u51fa\u4e86\u534f\u8bae\u6240\u5141\u8bb8\u7684 Credit \u6570\u91cf\u901a\u544a\u7684\u6700\u5927\u503c\u3002</p> Credit \u7c7b\u578b \u901a\u544a\uff08Advertisement\uff09\u6700\u5c0f\u503c Posted  Request Header  \uff08PH\uff09  Posted \u8bf7\u6c42 Header 1 \u5355\u4f4d\uff1a  Credit \u503c= 1 \u4e2a 4DW Header+Digest= 5DW Posted  Request Data  \uff08PD\uff09  Posted \u8bf7\u6c42\u6570\u636e \u8fd9\u4e2a\u503c\u662f Max_Payload_Size \u7684\u6700\u5927\u503c\u7528 Credit \u7684\u8868\u793a\u3002  \u4f8b\u5982\uff1a\u5982\u679c\u652f\u6301\u7684\u6700\u5927\u7684 Max_Payload_Size \u4e3a 1024Byte\uff0c\u90a3\u4e48\u5141\u8bb8\u7684\u6700\u5c0f\u7684\u521d\u59cb Credit \u503c\u5c31\u662f 040h\uff0864*16byte\uff09\u3002 Non-Posted  Request Header  \uff08NPH\uff09  Non-Posted \u8bf7\u6c42 Header 1 \u5355\u4f4d\uff1a  Credit \u503c= 1 \u4e2a 4DW Header+Digest= 5DW Non-Posted  Request Data  \uff08NPD\uff09  Non-Posted \u8bf7\u6c42\u6570\u636e 1 \u5355\u4f4d\uff1a  Credit \u503c= 1 \u4e2a 4DW Header+Digest= 5DW  2 \u5355\u4f4d\uff1a  \u5982\u679c\u63a5\u6536\u65b9\u652f\u6301 AtomicOP \u8def\u7531\u6216\u8005\u5177\u6709\u4f5c\u4e3a AtomicOP \u5b8c\u6210\u8005\u7684\u80fd\u529b\uff0c\u90a3\u4e48 Credit \u503c\u53ef\u4ee5\u4e3a 02h\u3002 Completion  Header  \uff08CplH\uff09  \u5b8c\u6210\u5305 Header 1 \u5355\u4f4d\uff1a  Credit \u503c= 1 \u4e2a 3DW Header+Digest= 4DW\u3002\u8fd9\u79cd\u60c5\u51b5\u662f\u5bf9\u4e8e\u652f\u6301 Peer-to-Peer \u7684 RC \u548c Switch\u3002  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cb Credit \u503c=\u5168 0\u3002\u5e94\u7528\u4e8e\u4e0d\u652f\u6301 Peer-to-Peer \u7684 RC \u548c EP\u3002 Completion  Data  \uff08CplD\uff09  \u5b8c\u6210\u5305\u6570\u636e n \u5355\u4f4d\uff1a  \u8fd9\u4e2a\u503c\u662f Max_Payload_Size \u6216\u8005\u662f\u8bfb\u8bf7\u6c42 size \u8fd9\u4e8c\u8005\u53ef\u80fd\u7684\u6700\u5927\u503c\uff08\u4e00\u822c\u8bfb\u8bf7\u6c42 size \u4f1a\u6bd4\u524d\u8005\u5c0f\uff09\u9664\u4ee5 FC \u5355\u4f4d\u5927\u5c0f\uff084DW\uff09\u3002\u8fd9\u79cd\u60c5\u51b5\u662f\u5bf9\u4e8e\u652f\u6301 Peer-to-Peer \u7684 RC \u548c Switch\u3002  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cb Credit \u503c=\u5168 0\u3002\u5e94\u7528\u4e8e\u4e0d\u652f\u6301 Peer-to-Peer \u7684 RC \u548c EP\u3002 <p>\u8868 6\u20111 \u6d41\u63a7\u901a\u544a\u6700\u5c0f\u503c</p> Credit \u7c7b\u578b \u901a\u544a\uff08Advertisement\uff09\u6700\u5927\u503c Posted  Request Header  \uff08PH\uff09  Posted \u8bf7\u6c42 Header 128 \u5355\u4f4d\uff1a  128 Credits=128*5DW=2560 Bytes Posted  Request Data  \uff08PD\uff09  Posted \u8bf7\u6c42\u6570\u636e 2048 \u5355\u4f4d\uff1a  \u503c\u4e3a\u8bbe\u5907\u652f\u6301\u591a\u6709 Function\uff088 \u4e2a\uff09\u7684 Max_Payload_Size\uff084096 bytes\uff09\u603b\u548c,\u603b\u548c\u4e3a 8x4096=32768,\u9664\u4ee5 Credit \u5927\u5c0f\uff084DW\uff09\u30022048 Credits=2048x4DW=32768Bytes Non-Posted  Request Header  \uff08NPH\uff09  Non-Posted \u8bf7\u6c42 Header 128 \u5355\u4f4d\uff1a  128 Credits=128*5DW=2560 Bytes Non-Posted  Request Data  \uff08NPD\uff09  Non-Posted \u8bf7\u6c42\u6570\u636e \u4f5c\u8005\u65e0\u6cd5\u7ed9 Non-Posted \u6570\u636e\u627e\u5230\u4e00\u4e2a\u51c6\u786e\u7684 Credit \u6570\u91cf\u6700\u5927\u503c\u3002\u7ed9\u51fa\u7684\u5355\u7eaf\u6570\u636e\u7684 Credit \u6570\u91cf\u6700\u5927\u503c\u4e3a 2048\u3002\u7136\u800c\uff0c\u4e00\u79cd\u66f4\u5408\u7406\u7684\u8ba1\u7b97\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 Non-Posted Header \u6765\u9650\u5236\u5728 128 Credits \u5185\uff0c\u56e0\u4e3a Non-Posted \u6570\u636e\u603b\u662f\u4e0e Non-Posted Header \u76f8\u5173\u8054\u3002 Completion  Header  \uff08CplH\uff09  \u5b8c\u6210\u5305 Header 128 \u5355\u4f4d\uff1a  128 Credits=128*4DW=2048 Bytes\u3002\u8fd9\u662f\u5bf9\u4e0d\u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\u7684\u9650\u5236\uff08\u4f8b\u5982\u652f\u6301 Peer-to-Peer \u7684 RC \u548c Switch\uff09\u3002  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cb Credit \u503c=\u5168 0\u3002\u5e94\u7528\u4e8e\u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\uff08\u4f8b\u5982\u4e0d\u652f\u6301 Peer-to-Peer \u7684 RC \u548c EP\uff09\u3002 Completion  Data  \uff08CplD\uff09  \u5b8c\u6210\u5305\u6570\u636e 2048 \u5355\u4f4d\uff1a  \u503c\u4e3a\u8bbe\u5907\u652f\u6301\u591a\u6709 Function\uff088 \u4e2a\uff09\u7684 Max_Payload_Size\uff084096 bytes\uff09\u603b\u548c,\u603b\u548c\u4e3a 8x4096=32768,\u9664\u4ee5 Credit \u5927\u5c0f\uff084DW\uff09\u3002  2048 Credits=2048x4DW=32768Bytes  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cb Credit \u503c=\u5168 0\u3002\u5e94\u7528\u4e8e\u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\uff08\u4f8b\u5982\u4e0d\u652f\u6301 Peer-to-Peer \u7684 RC \u548c EP\uff09\u3002 <p>\u8868 6\u20112 \u6d41\u63a7\u901a\u544a\u6700\u5927\u503c</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#632-creditinfinite-credits","title":"6.3.2     \u65e0\u9650 Credit\uff08Infinite Credits\uff09","text":"<p>\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u5982\u679c\u6d41\u63a7 Credit \u503c\u4e3a 00h\uff0c\u90a3\u4e48\u5176\u610f\u601d\u5c31\u662f\u62e5\u6709\u65e0\u9650\u591a\u7684 Credit\u3002\u5728\u6d41\u63a7\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u4e0d\u4f1a\u518d\u8fdb\u884c\u4efb\u4f55\u7684\u901a\u544a\uff08advertisement\uff09\u3002\u53d1\u8d77\u4e8b\u52a1\u7684\u8bbe\u5907\u5fc5\u987b\u8981\u4fdd\u7559\u8db3\u591f\u7684 buffer \u7a7a\u95f4\uff0c\u8fd9\u4e9b buffer \u7a7a\u95f4\u7528\u6765\u5b58\u653e\u6267\u884c\u62c6\u5206\u4e8b\u52a1\uff08split transaction\uff09\u7684\u8fc7\u7a0b\u4e2d\u8fd4\u56de\u7684\u6570\u636e\u4ee5\u53ca\u72b6\u6001\u4fe1\u606f\u3002\u8fd9\u4e9b\u4e8b\u52a1\u7ec4\u5408\u5305\u62ec\uff1a</p> <ul> <li> <p>Non-Posted \u8bfb\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u6570\u636e</p> </li> <li> <p>Non-Posted \u8bfb\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u72b6\u6001</p> </li> <li> <p>Non-Posted \u5199\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u72b6\u6001</p> </li> </ul>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#633-credit","title":"6.3.3     \u65e0\u9650 Credit \u901a\u544a\u7684\u7279\u6b8a\u7528\u6cd5","text":"<p>\u534f\u8bae\u89c4\u8303\u6307\u51fa\uff0c\u5f53\u4e00\u4e2a\u8bbe\u5907\u53ea\u5b9e\u73b0\u4e86 VC0 \u65f6\uff0c\u9700\u8981\u6709\u4e00\u4e9b\u7279\u522b\u7684\u8003\u8651\u3002\u4f8b\u5982\uff0c\u4ec5\u6709\u7684\u4e24\u79cd Posted \u5199\u8bf7\u6c42\uff1aIO Write \u4e0e Configuration Write\uff0c\u4e8c\u8005\u4ec5\u5141\u8bb8\u4f7f\u7528 VC0\u3002\u56e0\u6b64\uff0cNon-Posted \u6570\u636e buffer \u5e76\u4e0d\u4f1a\u88ab VC1-VC7 \u6240\u4f7f\u7528\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u4e3a VC1-VC7 \u5ba3\u544a\u4e00\u4e2a\u65e0\u9650 Credit \u503c\u3002\u7136\u800c Non-Posted Header \u4ecd\u7136\u9700\u8981\u8fdb\u884c\u64cd\u4f5c\uff0c\u6240\u4ee5 Header Credit \u7684\u503c\u9700\u8981\u7ee7\u7eed\u66f4\u65b0\uff0c\u800c\u5e76\u975e\u4fdd\u6301\u65e0\u9650\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#64-flow-control-initialization","title":"6.4 \u6d41\u91cf\u63a7\u5236\u521d\u59cb\u5316\uff08Flow Control Initialization\uff09","text":""},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#641-general","title":"6.4.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5728\u53d1\u9001\u4efb\u4f55\u4e8b\u52a1\u4e4b\u524d\uff0c\u90fd\u9700\u8981\u8fdb\u884c\u6d41\u63a7\u521d\u59cb\u5316\uff08flow control initialization\uff09\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5728\u6d41\u63a7\u521d\u59cb\u5316\u6210\u529f\u5b8c\u6210\u4e4b\u524d\uff0cTLP \u662f\u4e0d\u80fd\u5728\u94fe\u8def\u4e0a\u8fdb\u884c\u53d1\u9001\u7684\u3002\u6d41\u63a7\u521d\u59cb\u5316\u4f1a\u53d1\u751f\u4e8e\u7cfb\u7edf\u4e2d\u7684\u6bcf\u4e00\u4e2a\u94fe\u8def\uff0c\u5176\u8fc7\u7a0b\u4e3b\u8981\u4e3a\u94fe\u8def\u4e24\u7aef\u8bbe\u5907\u4e4b\u95f4\u7684\u4e00\u6b21\u63e1\u624b\u3002\u8fd9\u4e00\u8fc7\u7a0b\u4f1a\u5728\u7269\u7406\u5c42\u7684\u94fe\u8def\u8bad\u7ec3\uff08link training\uff09\u5b8c\u6210\u540e\u5c31\u5f00\u59cb\u8fdb\u884c\u3002\u94fe\u8def\u5c42\u89c2\u5bdf LinkUp \u4fe1\u53f7\u662f\u5426\u6709\u6548\uff0c\u83b7\u77e5\u7269\u7406\u5c42\u4f55\u65f6\u5904\u4e8e Ready \u72b6\u6001\uff0c\u5982\u56fe 6\u20113 \u6240\u793a\u3002</p> <p></p> <p>\u56fe 6\u20113 \u7269\u7406\u5c42\u62a5\u544a\u81ea\u5df1\u5df2\u7ecf Ready</p> <p>\u4e00\u65e6\u6d41\u91cf\u63a7\u5236\u521d\u59cb\u5316\u5f00\u59cb\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8fc7\u7a0b\u4ece\u6839\u672c\u4e0a\u6765\u8bf4\u5728\u5404\u4e2a\u865a\u62df\u901a\u9053\uff08VC\uff09\u4e0a\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5f53\u4e00\u4e2a VC \u88ab\u542f\u7528\u65f6\uff0c\u786c\u4ef6\u5c31\u8d1f\u8d23\u63a7\u5236\u5b83\u7684\u6d41\u91cf\u63a7\u5236\u521d\u59cb\u5316\u8fc7\u7a0b\u3002VC0 \u9ed8\u8ba4\u603b\u662f\u542f\u7528\uff0c\u56e0\u6b64\u5b83\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u662f\u81ea\u52a8\u7684\u3002\u8fd9\u4f7f\u5f97\u914d\u7f6e\u4e8b\u52a1\u53ef\u4ee5\u904d\u5386\u6574\u4e2a\u62d3\u6251\u7ed3\u6784\uff0c\u5e76\u8fdb\u884c\u679a\u4e3e\u8fc7\u7a0b\u3002\u5176\u4ed6\u7684 VC \u53ea\u6709\u5728\u914d\u7f6e\u8f6f\u4ef6\u5bf9\u94fe\u8def\u4e24\u7aef\u90fd\u8fdb\u884c\u4e86\u8bbe\u7f6e\u5e76\u4e14\u542f\u7528\u5b83\u4eec\u4e4b\u540e\u624d\u4f1a\u8fdb\u884c\u521d\u59cb\u5316\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#642-the-fc-initialization-sequence","title":"6.4.2     \u6d41\u63a7\u521d\u59cb\u5316\u6d41\u7a0b\uff08The FC Initialization Sequence\uff09","text":"<p>\u6d41\u63a7\u521d\u59cb\u5316\u8fc7\u7a0b\u6d89\u53ca\u5230\u94fe\u8def\u5c42\u7684 DLCMSM\uff08Data Link Control and Management State Machine\uff0c\u6570\u636e\u94fe\u8def\u63a7\u5236\u4e0e\u7ba1\u7406\u72b6\u6001\u673a\uff09\u3002\u5982\u56fe 6\u20114 \u6240\u793a\uff0c\u590d\u4f4d\u540e\u72b6\u6001\u673a\u5c06\u5904\u4e8e DL_Inactive \u72b6\u6001\u3002\u5728 DL_Inactive \u72b6\u6001\u4e2d\uff0c\u4f1a\u53d1\u51fa DL_Down \u4fe1\u53f7\uff0c\u8fd9\u4e2a\u4fe1\u53f7\u4f1a\u4f5c\u7528\u4e8e\u94fe\u8def\u5c42\u548c\u4e8b\u52a1\u5c42\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u4e5f\u4f1a\u5728\u6b64\u72b6\u6001\u4e2d\u7b49\u5f85\u7269\u7406\u5c42\u7684 LinkUp \u4fe1\u53f7\uff0c\u6b64\u4fe1\u53f7\u662f\u7528\u4e8e\u8868\u793a LTSSM\uff08Link Training and Status State Machine\uff0c\u94fe\u8def\u8bad\u7ec3\u548c\u72b6\u6001\u72b6\u6001\u673a\uff09\u5df2\u7ecf\u5b8c\u6210\u4e86\u5de5\u4f5c\uff0c\u4e5f\u5c31\u662f\u7269\u7406\u5c42\u5df2\u7ecf\u5904\u4e8e Ready \u72b6\u6001\u3002\u5f53\u7269\u7406\u5c42 Ready \u540e\uff0c\u5c06\u4f1a\u4f7f\u5f97 DLCMSM \u8df3\u8f6c\u81f3 DL_Init \u72b6\u6001\uff0c\u5b83\u5305\u542b\u4e24\u7ea7\u5b50\u72b6\u6001\u7528\u4e8e\u5904\u7406\u6d41\u63a7\u521d\u59cb\u5316\uff1aFC_INIT1 \u548c FC_INIT2\u3002</p> <p></p> <p>\u56fe 6\u20114 DLCMSM \u6570\u636e\u94fe\u8def\u63a7\u5236\u4e0e\u7ba1\u7406\u72b6\u6001\u673a</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#643-fc_init1-fc_init1-details","title":"6.4.3     FC_Init1 \u8be6\u7ec6\u8bf4\u660e\uff08FC_Init1 Details\uff09","text":"<p>\u5728 FC_Init1 \u72b6\u6001\u4e2d\uff0c\u8bbe\u5907\u4f1a\u8fde\u7eed\u7684\u53d1\u9001\u4e00\u7cfb\u5217\u7684 3 \u79cd InitFC1 \u6d41\u63a7 DLLP \u6765\u901a\u544a\u5b83\u7684\u63a5\u6536 Buffer \u5927\u5c0f\uff08\u89c1\u56fe 6\u20115\uff09\u3002\u6839\u636e\u534f\u8bae\u89c4\u8303\uff0c\u6570\u636e\u5305\u5fc5\u987b**\u6309\u7167\u8fd9\u6837\u7684\u987a\u5e8f**\u6765\u8fdb\u884c\u53d1\u9001\uff1aPosted\uff0cNon-Posted\uff0cCompletion \u5b8c\u6210\u5305\uff0c\u5982\u56fe 6\u20116 \u6240\u793a\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u5f3a\u70c8\u5efa\u8bae\u9891\u7e41\u7684\u91cd\u590d\u8fd9\u4e9b DLLP \u7684\u53d1\u9001\uff0c\u8fd9\u4f1a\u4f7f\u63a5\u6536\u8bbe\u5907\u80fd\u591f\u66f4\u5bb9\u6613\u7684\u53d1\u73b0\u5b83\u4eec\uff0c\u7279\u522b\u662f\u5728\u5f53\u524d\u6ca1\u6709 TLP \u6216\u8005 DLLP \u9700\u8981\u53d1\u9001\u7684\u60c5\u51b5\u4e0b\u3002</p> <p>\u6bcf\u4e2a\u8bbe\u5907\u90fd\u9700\u8981\u4ece\u5bf9\u7aef\u8bbe\u5907\u63a5\u6536\u5230\u8fd9\u4e00\u7cfb\u5217 DLLP\uff0c\u8fd9\u6837\u5b83\u624d\u53ef\u4ee5\u5c06\u5bf9\u7aef\u8bbe\u5907\u7684 Buffer \u7a7a\u95f4\u5927\u5c0f\u8bb0\u5f55\u4e0b\u6765\u3002\u4e00\u65e6\u8bbe\u5907\u5df2\u7ecf\u53d1\u9001\u51fa\u4e86\u81ea\u8eab\u7684 Buffer \u7a7a\u95f4\u5927\u5c0f\u7684\u503c\uff0c\u5e76\u4e14\u63a5\u6536\u5230\u4e86\u8db3\u591f\u6b21\u6570\u7684\u5b8c\u6574\u7684 DLLP \u5e8f\u5217\uff0c\u6240\u8c13\u8db3\u591f\u6b21\u6570\u662f\u6307\uff0c\u8bbe\u5907\u8db3\u4ee5\u76f8\u4fe1\u63a5\u6536\u5230\u7684\u5bf9\u7aef Buffer \u5927\u5c0f\u7684\u503c\u662f\u6b63\u786e\u7684\uff0c\u90a3\u4e48\u6b64\u65f6\u8bbe\u5907\u5c31\u5df2\u7ecf\u53ef\u4ee5\u8df3\u51fa FC_INIT1 \u72b6\u6001\u4e86\u3002\u8981\u8fdb\u884c\u8df3\u51fa\u7684\u64cd\u4f5c\uff0c\u8bbe\u5907\u9700\u8981\u5c06\u63a5\u6536\u5230\u7684\u503c\u8bb0\u5f55\u5728\u4f20\u8f93\u8ba1\u6570\u5668\uff08transmit counter\uff09\u4e2d\uff0c\u7f6e\u8d77\u4e00\u4e2a\u5185\u90e8\u7684 flag \u4fe1\u53f7\uff08FL1\uff09\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u8df3\u8f6c\u5230 FC_INIT2 \u72b6\u6001\u6765\u8fdb\u884c\u521d\u59cb\u5316\u64cd\u4f5c\u4e2d\u7684\u7b2c\u4e8c\u6b65\u3002</p> <p></p> <p>\u56fe 6\u20115 INIT1 \u6d41\u63a7 DLLP \u683c\u5f0f\u53ca\u5185\u5bb9</p> <p></p> <p>\u56fe 6\u20116 \u8bbe\u5907\u5728 DL_Init \u72b6\u6001\u4e0b\u53d1\u9001 InitFC1 DLLP</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#644-fc_init2-fc_init2-details","title":"6.4.4     FC_Init2 \u8be6\u7ec6\u8bf4\u660e\uff08FC_Init2 Details\uff09","text":"<p>\u5728 FC_Init2 \u8fd9\u4e2a\u72b6\u6001\u4e2d\uff0c\u8bbe\u5907\u9700\u8981\u8fde\u7eed\u7684\u53d1\u9001 InitFC2 DLLP\u3002\u53d1\u9001 DLLP \u7684\u987a\u5e8f\u548c FC_Init1 \u4e2d\u4e00\u6837\uff0c\u5e76\u4e14\u5176\u4e2d\u4e5f\u5305\u542b\u4e86\u76f8\u540c\u7684\u6709\u5173 Credit \u7684\u4fe1\u606f\uff0c\u4f46\u662f\u8fd9\u4e9b DLLP \u8fd8\u6709\u4e00\u4e2a\u4f5c\u7528\u5c31\u662f\u53d1\u9001\u65b9\u7528\u6765\u786e\u8ba4\u6d41\u63a7\u521d\u59cb\u5316\uff08FC initialization\uff09\u5df2\u7ecf\u6210\u529f\u3002\u7531\u4e8e\u8bbe\u5907\u5728 FC_Init1 \u72b6\u6001\u4e2d\u5c31\u5df2\u7ecf\u5bc4\u5b58\u4e86\u5bf9\u7aef\u7684\u53ef\u7528 Buffer \u503c\uff0c\u56e0\u6b64\u5b83\u4e0d\u5728\u9700\u8981\u4efb\u4f55\u5173\u4e8e Credit \u6570\u91cf\u7684\u4fe1\u606f\uff0c\u5b83\u5728\u7b49\u5f85 InitFC2 DLLP \u65f6\u4f1a\u5ffd\u7565\u4f20\u6765\u7684\u6240\u6709 InitFC1 DLLP\u3002\u867d\u7136\u5bf9\u4e8e\u94fe\u8def\u53e6\u4e00\u7aef\u8bbe\u5907\u6765\u8bf4\u6b64\u65f6\u5e76\u6ca1\u6709\u5b8c\u6210\u521d\u59cb\u5316\uff0c\u4f46\u662f\u8bbe\u5907\u53ef\u4ee5\u5728\u6b64\u65f6\u53d1\u9001 TLP\u3002\u521d\u59cb\u5316\u7684\u5b8c\u6210\u4e0e\u5426\u662f\u901a\u8fc7 DL_Up \u4fe1\u53f7\u6765\u5bf9\u4e8b\u52a1\u5c42\u8fdb\u884c\u6307\u793a\u7684\u3002\uff08\u89c1\u56fe 6\u20117\uff09</p> <p>\u4f60\u53ef\u80fd\u4f1a\u6709\u7591\u95ee\uff0c\u521d\u59cb\u5316\u8fc7\u7a0b\u4e3a\u4ec0\u4e48\u8fd8\u9700\u8981\u8fd9\u4e2a\u7b2c\u4e8c\u9636\u6bb5\u5462\uff1f\u4e00\u4e2a\u7b80\u5355\u7684\u56de\u7b54\u662f\uff1a\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u5728\u5b8c\u6210\u6d41\u63a7\u521d\u59cb\u5316\uff08FC Initialization\uff09\u65f6\u9700\u8981\u7684\u65f6\u95f4\u53ef\u80fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u800c\u8fd9\u6837\u4e24\u6b65\u7684\u65b9\u6cd5\u53ef\u4ee5\u786e\u4fdd\u5728\u8f83\u5feb\u7684\u8bbe\u5907\u5b8c\u6210\u521d\u59cb\u5316\u540e\uff0c\u8f83\u6162\u7684\u90a3\u4e00\u7aef\u4f9d\u7136\u80fd\u591f\u7ee7\u7eed\u63a5\u6536\u5230\u9700\u8981\u7684\u6d41\u63a7\u4fe1\u606f\uff08FC Information\uff09\u3002</p> <p>\u4e00\u65e6\u8bbe\u5907\u63a5\u6536\u5230\u4e86\u4efb\u610f Buffer \u79cd\u7c7b\u7684 FC_INIT2 \u6570\u636e\u5305\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u7f6e\u8d77\u4e00\u4e2a\u5185\u90e8\u7684 flag\uff08FL2\uff09\u3002\uff08\u8fd9\u4e2a\u64cd\u4f5c\u4e0d\u9700\u8981\u7b49\u5f85\u63a5\u6536\u5230\u6240\u6709\u79cd\u7c7b\u7684 FC_INIT2 \u6570\u636e\u5305\uff09\u6ce8\u610f\uff0cFL2 \u4e5f\u53ef\u4ee5\u5728\u63a5\u6536\u5230\u4e00\u4e2a UpdateFC \u5305\u6216\u8005 TLP \u4e4b\u540e\u88ab\u7f6e\u8d77\u7684\u3002\u5f53\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u90fd\u5b8c\u6210\u4e86\u8fd9\u4e9b\u6b65\u9aa4\u5e76\u4e14\u90fd\u53d1\u9001\u51fa\u4e86 InitFC2 DLLP \u4e4b\u540e\uff0cDLCMSM \u5c06\u4f1a\u8df3\u8f6c\u81f3 DL_Active \u72b6\u6001\uff0c\u94fe\u8def\u5c42\u521d\u59cb\u5316\u5b8c\u6210\u3002</p> <p></p> <p>\u56fe 6\u20117 FC \u503c\u5df2\u7ecf\u5bc4\u5b58-\u63a5\u4e0b\u6765\u53d1\u9001 InitFC2 \u5e76\u62a5\u544a DL_Up</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#645-fc_init1-fc_init2-rate-of-fc_init1-and-fc_init2-transmission","title":"6.4.5     FC_INIT1 \u548c FC_INIT2 \u7684\u4f20\u8f93\u901f\u7387\uff08Rate of FC_INIT1 and FC_INIT2 Transmission\uff09","text":"<p>\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u4e86\u53d1\u9001 FC_INIT DLLP \u4e4b\u95f4\u7684\u5ef6\u65f6\uff0c\u5982\u4e0b\uff1a</p> <ul> <li>VC0\uff1a\u57fa\u4e8e\u786c\u4ef6\u8fdb\u884c\u6d41\u63a7\u7684 VC0 \u8981\u6c42 FC_INIT1 \u5305\u548c FC_INIT2 \u5305\u8981 \u201c\u4ee5\u6700\u5927\u901f\u7387\u8fde\u7eed\u4f20\u8f93\"\u3002\u4e5f\u5c31\u662f\u8bf4\u91cd\u53d1\u8ba1\u65f6\u5668\uff08resend timer\uff09\u8bbe\u7f6e\u7684\u91cd\u53d1\u95f4\u9694\u503c\u4e3a 0\u3002</li> <li>VC1-VC7\uff1a\u5f53\u8f6f\u4ef6\u542f\u52a8\u4e86\u5176\u4ed6 VC\uff08VC0 \u4e4b\u5916\uff09\u7684\u6d41\u63a7\u521d\u59cb\u5316\u65f6\uff0cFC_INIT DLLP \u5e8f\u5217\u9700\u8981\u5728\u201c\u5f53\u6ca1\u6709\u5176\u4ed6 TLP \u6216\u8005 DLLP \u9700\u8981\u4f20\u8f93\u65f6\u201d\u88ab\u91cd\u590d\u53d1\u9001\u3002</li> <li>\u9700\u8981\u6ce8\u610f\uff0c\u4e24\u7ec4 DLLP \u5e8f\u5217\u53d1\u9001\u7684\u8d77\u59cb\u65f6\u523b\u6700\u591a\u53ea\u80fd\u95f4\u9694 17us\u3002</li> </ul>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#646","title":"6.4.6     \u6d41\u63a7\u521d\u59cb\u5316\u534f\u8bae\u8fdd\u4f8b","text":"<p>\u8bbe\u5907\u5bf9\u6d41\u63a7\u521d\u59cb\u5316\u534f\u8bae\u8fdd\u4f8b\u7684\u68c0\u6d4b\u662f\u53ef\u9009\u7684\u3002\u68c0\u6d4b\u5230\u7684\u9519\u8bef\u53ef\u4ee5\u4f5c\u4e3a\u6570\u636e\u94fe\u8def\u5c42\u534f\u8bae\u9519\u8bef\u8fdb\u884c\u62a5\u544a\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#65-introduction-to-flow-control-mechanism","title":"6.5 \u6d41\u63a7\u673a\u5236\u7684\u4ecb\u7ecd\uff08Introduction to Flow Control Mechanism\uff09","text":""},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#651-general","title":"6.5.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u6d41\u91cf\u63a7\u5236\u673a\u5236\u6240\u8981\u6c42\u7684\u5bc4\u5b58\u5668\u3001\u8ba1\u6570\u5668\uff0c\u4ee5\u53ca\u4e00\u7cfb\u5217\u7684\u673a\u5236\u7528\u4e8e\u62a5\u544a\uff08reporting\uff09\u3001\u8ffd\u8e2a\uff08tracking\uff09\u548c\u8ba1\u7b97\uff08calculating\uff09\u4e00\u4e2a\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u88ab\u53d1\u51fa\u3002\u8fd9\u4e9b\u5143\u7d20\u5e76\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u5b83\u4eec\u7684\u5b9e\u9645\u5b9e\u73b0\u662f\u7531\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u6765\u51b3\u5b9a\u7684\u3002\u672c\u8282\u5c06\u4ecb\u7ecd\u534f\u8bae\u89c4\u8303\u6a21\u578b\uff0c\u5e76\u89e3\u91ca\u76f8\u5173\u6982\u5ff5\u548c\u5bf9\u9700\u6c42\u8fdb\u884c\u5b9a\u4e49\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#652-the-flow-control-elements","title":"6.5.2     \u6d41\u63a7\u76f8\u5173\u5143\u7d20\uff08The Flow Control Elements\uff09","text":"<p>\u56fe 6\u20118 \u8bf4\u660e\u4e86\u7528\u4e8e\u7ba1\u7406\u6d41\u91cf\u63a7\u5236\u7684\u5143\u7d20\u3002\u56fe\u4e2d\u5c55\u793a\u4e86\u5728\u8fde\u8def\u4e0a\u5355\u5411\u4f20\u8f93\u7684\u4e8b\u52a1\uff0c\u800c\u53e6\u4e00\u7ec4\u8fd9\u4e9b\u6d41\u63a7\u5143\u7d20\u5219\u652f\u6301\u76f8\u53cd\u65b9\u5411\u7684\u4f20\u8f93\u3002\u6bcf\u4e2a\u5143\u7d20\u7684\u4e3b\u8981\u529f\u80fd\u90fd\u4f1a\u518d\u4e0b\u9762\u7684\u5185\u5bb9\u4e2d\u5217\u51fa\u3002\u867d\u7136\u5bf9\u4e8e\u5168\u90e8\u7684 6 \u79cd\u63a5\u6536 buffer \u90fd\u91cd\u590d\u6709\u8fd9\u4e9b\u6d41\u63a7\u5143\u7d20\uff0c\u4f46\u662f\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u5728\u672c\u4f8b\u5b50\u4e2d\u4ec5\u8003\u8651 Non-Posted Header \u6d41\u63a7\u3002</p> <p>\u4e0e\u7ba1\u7406\u6d41\u63a7\u76f8\u5173\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u662f\u6d41\u63a7\u66f4\u65b0 DLLP\uff08Flow Control Update\uff09\uff0c\u5b83\u4e5f\u662f\u5728\u94fe\u8def\u6b63\u5e38\u4f20\u8f93\u671f\u95f4\u552f\u4e00\u53ef\u4f7f\u7528\u7684\u6d41\u63a7\u5305\u3002FC Update \u5305\u7684\u683c\u5f0f\u5982\u56fe 6\u20119 \u6240\u793a</p> <p></p> <p>\u56fe 6\u20118 \u6d41\u63a7\u5143\u7d20</p> <p></p> <p>\u56fe 6\u20119 \u6d41\u63a7 DLLP \u7684\u7c7b\u578b\u548c\u5305\u683c\u5f0f</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#6521-transmitter-elements","title":"6.5.2.1   \u53d1\u9001\u65b9\u6d41\u63a7\u5143\u7d20\uff08Transmitter Elements\uff09","text":"<ul> <li> <p>\u4e8b\u52a1\u7b49\u5f85\u7f13\u51b2\u533a\uff08Transactions Pending Buffer\uff09\uff1a\u628a\u5c06\u8981\u53d1\u9001\u8fdb\u7edf\u4e00\u865a\u62df\u901a\u9053\u7684\u4e8b\u52a1\u6682\u5b58\u8d77\u6765\u3002</p> </li> <li> <p>Credit \u6d88\u8017\u8ba1\u6570\u5668\uff08Credits Consumed counter\uff09\uff1a\u8be5\u8ba1\u6570\u5668\u662f\u8bb0\u5f55\u53d1\u9001\u7ed9\u5bf9\u7aef\u5f53\u524d\u7c7b\u578b Buffer \u7684\u6240\u6709\u4e8b\u52a1\u7684 Credit \u603b\u548c\uff08\u4e5f\u5c31\u662f\u6d88\u8017\u4e86\u63a5\u6536\u7aef\u591a\u5c11 Credit\uff09\uff0c\u8fd9\u4e2a\u8ba1\u6570\u503c\u4e5f\u53ef\u4ee5\u88ab\u7f29\u5199\u6210\u201cCC\u201d\u3002</p> </li> <li> <p>Credit \u989d\u5ea6\u8ba1\u6570\u5668\uff08Credit Limit count\uff09\uff1a\u8be5\u8ba1\u6570\u5668\u7684\u521d\u59cb\u503c\u7531\u5bf9\u7aef\u63a5\u6536\u8005\u76f8\u5e94\u7c7b\u578b\u7684 Buffer \u5927\u5c0f\u800c\u51b3\u5b9a\u3002\u5728\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u5bf9\u7aef\u63a5\u6536\u8005\u4f1a\u5b9a\u671f\u7684\u53d1\u9001\u6d41\u63a7\u66f4\u65b0\u5305\uff08FC Update\uff09\uff0c\u4ee5\u4fbf\u5728\u63a5\u6536\u65b9 Buffer \u53ef\u7528\u65f6\u66f4\u65b0\u6d41\u63a7 Credit\u3002\u8fd9\u4e2a\u503c\u53ef\u4ee5\u88ab\u7f29\u5199\u4e3a\u201cCL\u201d\u3002</p> </li> <li> <p>\u6d41\u63a7\u95e8\u63a7\u903b\u8f91\uff08Flow Control Gating Logic\uff09\uff1a\u5b83\u7528\u4e8e\u8fdb\u884c\u8ba1\u7b97\u6765\u786e\u5b9a\u5bf9\u7aef\u63a5\u53d7\u8005\u662f\u5426\u6709\u8db3\u591f\u7684\u6d41\u63a7 Credit \u6765\u63a5\u6536\u7b49\u5f85\u53d1\u9001\u4e2d\u7684 TLP\uff08Pending TLP\uff0cPTLP\uff09\u3002\u672c\u8d28\u4e0a\u6765\u8bf4\uff0c\u8fd9\u4e2a\u903b\u8f91\u5c31\u662f\u68c0\u67e5 CREDITS_CONSUMED\uff08CC\uff09\u52a0\u4e0a\u4e0b\u4e00\u4e2a PTLP \u6240\u9700\u8981\u6d88\u8017\u7684 Credit \u662f\u5426\u5927\u4e8e CREDIT_LIMIT\uff08CL\uff09\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u4e86\u4e0b\u9762\u7684\u65b9\u7a0b\uff0c\u4ee5\u6b64\u6765\u5b8c\u6210\u4e0a\u8ff0\u7684\u68c0\u67e5\uff0c\u65b9\u7a0b\u4e2d\u6240\u6709\u7684\u503c\u7684\u5355\u4f4d\u90fd\u662f Credit\u3002</p> </li> </ul> <p></p> <p>\u5173\u4e8e\u5e94\u7528\u6b64\u65b9\u7a0b\u5f0f\u7684\u4f8b\u5b50\uff0c\u8bf7\u53c2\u9605 6.6 \u4e2d\u7684\u201cStage 1 \u2013 Flow Control Following Initialization\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#6522-receiver-elements","title":"6.5.2.2   \u63a5\u6536\u65b9\u6d41\u63a7\u5143\u7d20\uff08Receiver Elements\uff09","text":"<ul> <li> <p>\u6d41\u63a7\u7f13\u51b2\u533a\uff08Flow Control Buffer\uff09\uff1a\u50a8\u5b58\u8f93\u5165\u7684 Header \u6216\u8005\u6570\u636e\u3002</p> </li> <li> <p>Credit \u5206\u914d\u8ba1\u6570\uff08Credit Allocated\uff09\uff1a\u8bb0\u5f55\u5df2\u5206\u914d\uff08\u53ef\u7528\uff09\u7684\u5168\u90e8\u7684\u6d41\u63a7 Credit \u6570\u91cf\u3002\u5b83\u662f\u7531\u786c\u4ef6\u8fdb\u884c\u521d\u59cb\u5316\u7684\uff0c\u53cd\u6620\u4e86\u5df2\u5206\u914d\u7684\u6d41\u63a7 Buffer \u7684\u5927\u5c0f\u3002\u8fd9\u4e9b Buffer \u4f1a\u5728\u4e8b\u52a1\u5230\u8fbe\u65f6\u88ab\u586b\u5145\uff0c\u4f46\u662f\u586b\u5145\u8fdb\u53bb\u7684\u4e8b\u52a1\u6700\u7ec8\u90fd\u4f1a\u88ab\u63a5\u6536\u7aef\u53d6\u51fa\uff0c\u4e5f\u5c31\u662f\u4ece Buffer \u4e2d\u79fb\u9664\u3002\u5f53\u5b83\u4eec\u88ab\u79fb\u9664\u65f6\uff0c\u8fd9\u90e8\u5206\u7684 Buffer \u7a7a\u95f4 Credit \u6570\u91cf\u5c06\u4f1a\u88ab\u52a0\u5230 CREDIT_ALLOCATED \u8ba1\u6570\u503c\u4e0a\u3002\u56e0\u6b64\u8fd9\u4e2a\u8ba1\u6570\u5668\u4f1a\u8bb0\u5f55\u5e76\u8868\u5f81\u5f53\u524d\u53ef\u7528\u7684 Credit \u6570\u91cf\u3002</p> </li> <li> <p>\u5df2\u63a5\u6536 Credit \u8ba1\u6570\u5668\uff08Credit Received counter\uff0coptional\uff09\uff1a\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u9879\uff0c\u5b83\u7528\u4e8e\u8bb0\u5f55\u8fdb\u5165\u6d41\u63a7 Buffer \u7684\u6240\u6709 TLP \u7684\u603b Credit \u6570\u91cf\u3002\u5f53\u6d41\u63a7\u529f\u80fd\u6b63\u5e38\u65f6\uff0cCREDIT_RECEIVED \u8ba1\u6570\u503c\u5e94\u8be5\u5c0f\u4e8e\u7b49\u4e8e CREDIT_ALLOCTED \u8ba1\u6570\u503c\u3002\u5982\u679c\u5e76\u672a\u6ee1\u8db3\u8fd9\u4e8c\u8005\u7684\u201c\u5c0f\u4e8e\u7b49\u4e8e\u201d\u6761\u4ef6\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d1\u751f buffer \u6ea2\u51fa\u5e76\u68c0\u6d4b\u5230\u51fa\u9519\u3002\u534f\u8bae\u89c4\u8303\u63a8\u8350\u8bbe\u8ba1\u8005\u5b9e\u73b0\u8fd9\u4e00\u53ef\u9009\u7684\u673a\u5236\uff0c\u5e76\u4e14\u9700\u8981\u6ce8\u610f\u7684\u662f\u8fd9\u91cc\u82e5\u51fa\u73b0\u8fdd\u4f8b\u5219\u5e94\u8be5\u5c06\u5176\u89c6\u4f5c\u662f\u4e00\u4e2a Fatal Error\uff0c\u5373\u975e\u5e38\u4e25\u91cd\u7684\u9519\u8bef\u3002</p> </li> </ul>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#66-flow-control-example","title":"6.6 \u6d41\u63a7\u793a\u4f8b\uff08Flow Control Example\uff09","text":"<p>\u63a5\u4e0b\u6765\u5c06\u4f1a\u4ee5 Non-Posted Header \u6d41\u63a7 Buffer \u4f5c\u4e3a\u4f8b\u5b50\u8fdb\u884c\u8bb2\u89e3\uff0c\u5e76\u5c1d\u8bd5\u6355\u6349\u51fa\u5728\u591a\u79cd\u60c5\u51b5\u4e0b\u6d41\u63a7\u5b9e\u73b0\u7684\u7ec6\u5fae\u5dee\u522b\u3002\u5bf9\u6d41\u63a7\u7684\u8ba8\u8bba\u5c06\u4f1a\u5206\u4e3a\u5982\u4e0b\u51e0\u4e2a\u57fa\u672c\u9636\u6bb5\uff1a</p> <ul> <li> <p>\u9636\u6bb5\u4e00\uff1a\u5728\u521d\u59cb\u5316\u4e4b\u540e\u7d27\u8ddf\u7740\u4f20\u8f93\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u8ffd\u8e2a\uff0c\u4ee5\u6b64\u6765\u89e3\u91ca\u6d41\u63a7\u5143\u7d20\u4e2d\u7684\u8ba1\u6570\u5668\u548c\u5bc4\u5b58\u5668\u7684\u4e00\u4e9b\u57fa\u672c\u64cd\u4f5c\u3002</p> </li> <li> <p>\u9636\u6bb5\u4e8c\uff1a\u53d1\u9001\u65b9\u53d1\u9001\u4e8b\u52a1\u7684\u901f\u5ea6\u5927\u4e8e\u63a5\u6536\u65b9\u80fd\u5904\u7406\u4e8b\u52a1\u7684\u901f\u5ea6\uff0c\u4f7f\u5f97\u63a5\u6536\u65b9 Buffer \u88ab\u586b\u6ee1\u3002</p> </li> <li> <p>\u9636\u6bb5\u4e09\uff1a\u5f53\u8ba1\u6570\u5668\u7ffb\u8f6c\u5230 0\uff08\u6301\u7eed\u589e\u5927\u540e\u56de\u5230 0\uff09\uff0c\u6d41\u63a7\u673a\u5236\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f46\u662f\u9700\u8981\u8003\u8651\u51e0\u4e2a\u95ee\u9898\u3002</p> </li> <li> <p>\u9636\u6bb5\u56db\uff1a\u63a5\u6536\u65b9\u53ef\u4ee5\u5bf9 Buffer \u6ea2\u51fa\u9519\u8bef\u8fdb\u884c\u68c0\u67e5\uff0c\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u9879\u3002</p> </li> </ul>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#661-flow-control-following-initialization","title":"6.6.1     \u9636\u6bb5\u4e00\u2014\u2014\u521d\u59cb\u5316\u540e\u7684\u6d41\u63a7\uff08Flow Control Following Initialization\uff09","text":"<p>\u4e00\u65e6\u6d41\u63a7\u521d\u59cb\u5316\u5b8c\u6210\u540e\uff0c\u8bbe\u5907\u5c31\u5df2\u7ecf\u51c6\u5907\u597d\u8fdb\u884c\u6b63\u5e38\u5de5\u4f5c\u4e86\u3002\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\u7684\u6d41\u63a7 Buffer \u5927\u5c0f\u4e3a 2KB\uff0c\u4e14\u79cd\u7c7b\u4e3a Non-Posted Header Buffer\uff0c\u56e0\u6b64 1 \u4e2a Credit \u4ee3\u8868 5dwords \u5927\u5c0f\uff0c\u4e5f\u5c31\u662f 20Bytes\u3002\u8fd9\u610f\u5473\u7740\u53ef\u7528\u7684\u6d41\u63a7\u5355\u4f4d\u6570\u91cf\u4e3a 102d\uff0866h\uff09\u3002\u56fe 6\u201110 \u663e\u793a\u51fa\u4e86\u6d89\u53ca\u5230\u7684\u6d41\u63a7\u5143\u7d20\uff0c\u5305\u62ec\u6d41\u63a7\u521d\u59cb\u5316\u540e\u5404\u8ba1\u6570\u5668\u548c\u5bc4\u5b58\u5668\u7684\u503c\u3002</p> <p>\u5f53\u53d1\u9001\u65b9\u51c6\u5907\u597d\u8981\u53d1\u9001\u4e00\u4e2a TLP \u65f6\uff0c\u5b83\u5fc5\u987b\u9996\u5148\u68c0\u67e5\u6d41\u63a7 Credit\u3002\u6211\u4eec\u7ed9\u51fa\u7684\u4f8b\u5b50\u4f1a\u6bd4\u8f83\u7b80\u5355\uff0c\u56e0\u4e3a\u53d1\u51fa\u7684\u6570\u636e\u5305\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a Non-Posted Header\uff0c\u5b83\u6c38\u8fdc\u53ea\u4f1a\u9700\u8981 1 \u4e2a FC Credit \u5373\u53ef\uff0c\u5e76\u4e14\u6211\u4eec\u4e5f\u4e8b\u5148\u5047\u8bbe\u8fd9\u4e2a\u4e8b\u52a1\u4e2d\u4e0d\u5b58\u5728\u6570\u636e\u8377\u8f7d\u3002</p> <p>\u5173\u4e8e Header Credit \u7684\u68c0\u67e5\u4f7f\u7528\u7684\u662f\u65e0\u7b26\u53f7\u7b97\u672f\uff082 \u7684\u8865\u7801\uff0c2\u2019s complement\uff09\uff0c\u5b83\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u516c\u5f0f\uff1a</p> <p></p> <p>\u4ee3\u5165\u56fe 6\u201110 \u4e2d\u6240\u793a\u7684\u503c\u5f97\u5230\uff1a</p> <p></p> <p></p> <p>\u56fe 6\u201110 \u521d\u59cb\u5316\u540e\u7684\u6d41\u63a7\u5143\u7d20</p> <p>\u5728\u672c\u4f8b\u4e2d\uff0c\u5c06\u5f53\u524d CREDITS_CONSUMED \u8ba1\u6570\u503c\uff08CC\uff09\u52a0\u4e0a PTLP \u6240\u9700\u7684 Credit\uff08Header \u9700\u8981 1 Credit\uff0c\u4e5f\u5c31\u662f PTLP \u6240\u9700\u7684 Credit \u6570\u91cf=01h\uff09\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a CREDITS_REQUIRED\uff08CR\uff09\uff0c\u4e5f\u5c31\u662f 00h+01h=01h\u3002\u7136\u540e\u518d\u7528 CREDIT_LIMIT \u8ba1\u6570\u503c\uff08CL\uff09\u51cf\u53bb CREDITS_REQUIRED\uff08CR\uff09\uff0c\u8fd9\u6837\u5c31\u80fd\u786e\u5b9a\u662f\u5426\u6709\u8db3\u591f\u7684\u53ef\u7528 Credit\u3002</p> <p>\u4e0b\u9762\u7684\u63cf\u8ff0\u5305\u542b\u4e86\u5bf9\u5229\u7528 2 \u7684\u8865\u7801\uff08\u5c31\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u719f\u77e5\u7684\u8865\u7801\uff0c\u53e6\u4e00\u4e2a 1 \u7684\u8865\u7801\u5176\u5b9e\u662f\u53cd\u7801\uff09\u8fdb\u884c\u51cf\u6cd5\u7684\u7b80\u8981\u56de\u987e\u3002\u5f53\u4f7f\u7528 2 \u7684\u8865\u7801\u8fdb\u884c\u51cf\u6cd5\u8ba1\u7b97\u65f6\uff0c\u5c06\u8981\u51cf\u53bb\u7684\u6570\u5148\u8f6c\u6362\u4e3a\u53cd\u7801\uff081 \u7684\u8865\u7801\uff09\u518d\u52a0 1\uff0c\u8fd9\u8981\u5c31\u5f97\u5230\u4e86\u51cf\u6570\u7684\u8865\u7801\uff082 \u7684\u8865\u7801\uff09\u3002\u7136\u540e\u518d\u5c06\u88ab\u51cf\u6570\u4e0e\u51cf\u6570\u7684\u8865\u7801\uff082 \u7684\u8865\u7801\uff09\u76f8\u52a0\uff0c\u5e76\u4e22\u5f03\u6700\u9ad8\u4f4d\u8fdb\u4f4d\u3002</p> <p>Credit \u68c0\u67e5\uff1a</p> <p></p> <p>CR \u8f6c\u6362\u4e3a 2 \u7684\u8865\u7801\uff1a</p> <p></p> <p>CR \u7684 2 \u7684\u8865\u7801\u52a0\u4e0a CL\uff1a</p> <p></p> <p>\u7ed3\u679c\u662f\u5426\u5c0f\u4e8e\u7b49\u4e8e 80h \u5462\uff1f\u662f\u7684\u3002\u51cf\u6cd5\u8fd0\u7b97\u540e\u7684\u7ed3\u679c\u5c0f\u4e8e\u7b49\u4e8e\u8ba1\u6570\u5668\u6700\u5927\u503c\u7684\u4e00\u534a\uff0c\u8fd9\u91cc\u662f\u7528\u6a21 256 \u7684\u8ba1\u6570\u5668\u8fdb\u884c\u8bb0\u5f55\u7684\uff0c\u56e0\u6b64\u6700\u5927\u503c\u7684\u4e00\u534a\u5c31\u662f 128\uff0c\u6ee1\u8db3\u6b64\u6761\u4ef6\u6211\u4eec\u5c31\u8ba4\u4e3a\u63a5\u6536 Buffer \u6709\u8db3\u591f\u7684\u7a7a\u95f4\uff0c\u53ef\u4ee5\u53d1\u9001\u5f53\u524d\u7684\u6570\u636e\u5305\u3002\u8fd9\u5176\u4e2d\u53ea\u4f7f\u7528\u4e00\u534a\u7684\u8ba1\u6570\u5668\u503c\u7684\u505a\u6cd5\u53ef\u4ee5\u907f\u514d\u6f5c\u5728\u7684\u8ba1\u6570\u9519\u8bef\u7684\u95ee\u9898\uff0c\u53c2\u9605\u201cStage3\u2014Counter Roll Over\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 6\u201111 \u7b2c\u4e00\u4e2a TLP \u53d1\u9001\u540e\u7684\u6d41\u63a7\u5143\u7d20</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#662-buffer-flow-control-buffer-fills-up","title":"6.6.2     \u9636\u6bb5\u4e8c\u2014\u2014\u6d41\u63a7 Buffer \u5df2\u6ee1\uff08Flow Control Buffer Fills Up\uff09","text":"<p>\u5047\u8bbe\u73b0\u5728\u63a5\u6536\u65b9\u5df2\u7ecf\u6709\u4e00\u6bb5\u65f6\u95f4\u6ca1\u6709\u4ece\u6d41\u63a7 Buffer \u4e2d\u79fb\u9664\u4e8b\u52a1\u4e86\uff0c\u6216\u8bb8\u662f Device Core \u7e41\u5fd9\uff0c\u65e0\u6cd5\u5904\u7406\u4e8b\u52a1\u3002\u6700\u7ec8\u6d41\u63a7 Buffer \u5b8c\u5168\u88ab\u586b\u6ee1\uff0c\u5982\u56fe 6\u201112 \u6240\u793a\u3002\u6b64\u65f6\u5982\u679c\u53d1\u9001\u65b9\u53c8\u5e0c\u671b\u53d1\u9001\u4e00\u4e2a TLP\uff0c\u90a3\u4e48\u5b83\u5148\u8fdb\u884c\u6d41\u63a7 Credit \u68c0\u67e5\uff1a</p> <p>Credit Limit\uff08CL\uff09=66h</p> <p>Credits Required\uff08CR\uff09=67h</p> <p>\u8fdb\u884c CL-CR \u65e0\u7b26\u53f7\u51cf\u6cd5\u8fd0\u7b97\uff0c\u4e5f\u5c31\u662f\u51cf\u6570\u8f6c\u6362\u4e3a 2 \u7684\u8865\u7801\u7684\u52a0\u6cd5\u8fd0\u7b97\uff1a</p> <p></p> <p>\u4e0d\u96be\u53d1\u73b0 FFh&lt;=80h \u5e76\u4e0d\u6210\u7acb\uff0c\u56e0\u6b64\u4e0d\u80fd\u53d1\u9001\u6570\u636e\u5305\u3002</p> <p>\u8fd9\u4e2a\u901a\u9053\u4f1a\u4e00\u76f4\u88ab\u963b\u585e\uff0c\u76f4\u5230\u53d1\u9001\u65b9\u63a5\u6536\u5230 Update Flow Control DLLP\uff08\u66f4\u65b0\u6d41\u63a7 DLLP\uff09\uff0c\u8fd9\u4e2a DLLP \u5c06 CREDIT_LIMIT\uff08CL\uff09\u7684\u503c\u66f4\u65b0\u4e3a 67h \u6216\u8005\u66f4\u5927\u7684\u503c\u3002\u5f53\u65b0\u7684\u503c\u5b58\u5165 CL \u5bc4\u5b58\u5668\u65f6\uff0c\u53d1\u9001\u65b9\u7684 Credit \u68c0\u67e5\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e86\uff0c\u4e5f\u5c31\u53ef\u4ee5\u53d1\u9001\u4e0b\u4e00\u4e2a TLP \u4e86\uff08Header \u53ea\u5360 1 \u4e2a Credit\uff09\u3002</p> <p></p> <p>00h&lt;=80h \u6210\u7acb\uff0c\u53ef\u4ee5\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u91cc\u4e4b\u6240\u4ee5 CREDIT_LIMIT \u503c\u52a0 1 \u5c31\u591f\u7528\u662f\u56e0\u4e3a\u6211\u4eec\u662f\u4f7f\u7528 Non-Posted Header \u6d41\u63a7 Buffer\uff0cHeader \u53ea\u5360 1 \u4e2a Credit\u3002</p> <p></p> <p>\u56fe 6\u201112 \u6d41\u63a7 Buffer \u586b\u6ee1\u540e\u7684\u6d41\u63a7\u5143\u7d20</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#663-0counters-roll-over","title":"6.6.3     \u9636\u6bb5\u4e09\u2014\u2014\u8ba1\u6570\u5668\u7ffb\u8f6c\u4e3a 0\uff08Counters Roll Over\uff09","text":"<p>\u7531\u4e8e Credit Limit\uff08CL\uff09\u548c Credit Required\uff08CR\uff09\u8ba1\u6570\u53ea\u4f1a\u5411\u4e0a\u589e\u52a0\uff0c\u5b83\u4eec\u6700\u7ec8\u4f1a\u7ffb\u8f6c\u4e3a 0\u3002\u5f53 CL \u7ffb\u8f6c\u800c CR \u8fd8\u6ca1\u7ffb\u8f6c\u65f6\uff0cCredit \u68c0\u67e5\uff08CL-CR\uff09\u5c31\u4f1a\u51fa\u73b0\u8f83\u5c0f\u503c\u7684 CL \u51cf\u53bb\u8f83\u5927\u503c\u7684 CR \u7684\u60c5\u51b5\u3002\u7136\u800c\uff0c\u5728\u4f7f\u7528\u65e0\u7b26\u53f7\u7b97\u672f\u65f6\uff0c\u8fd9\u79cd\u60c5\u51b5\u5e76\u4e0d\u4f1a\u5f15\u53d1\u95ee\u9898\u3002\u5982\u524d\u9762\u7684\u4f8b\u5b50\u6240\u63cf\u8ff0\u7684\u90a3\u6837\uff0c\u5f53\u4f7f\u7528 2 \u7684\u8865\u7801\u8fdb\u884c\u51cf\u6cd5\u8fd0\u7b97\u65f6\uff0c\u662f\u53ef\u4ee5\u5f97\u5230\u6b63\u786e\u7684\u5904\u7406\u7ed3\u679c\u7684\u3002\u56fe 6\u201113 \u5c55\u793a\u4e86 CL \u7ffb\u8f6c\u524d\u540e\uff0cCL \u4e0e CR \u7684\u503c\uff0c\u4ee5\u53ca CL-CR \u7684 2 \u7684\u8865\u7801\u51cf\u6cd5\u8fd0\u7b97\u7ed3\u679c\u3002</p> <p></p> <p>\u56fe 6\u201113 \u6d41\u63a7\u8ba1\u6570\u5668\u7ffb\u8f6c\u95ee\u9898</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#664-buffer-fc-buffer-overflow-error-check","title":"6.6.4     \u9636\u6bb5\u56db\u2014\u2014\u6d41\u63a7 Buffer \u6ea2\u51fa\u9519\u8bef\u68c0\u67e5\uff08FC Buffer Overflow Error Check\uff09","text":"<p>\u5c3d\u7ba1\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u64cd\u4f5c\uff0c\u4f46\u662f\u534f\u8bae\u89c4\u8303\u8fd8\u662f\u63a8\u8350\u5b9e\u73b0\u8fd9\u4e2a FC Buffer \u6ea2\u51fa\u9519\u8bef\u68c0\u67e5\u673a\u5236\u3002\u56fe 6\u201114 \u5c55\u793a\u4e86\u548c\u6ea2\u51fa\u9519\u8bef\u68c0\u67e5\u76f8\u5173\u8054\u7684\u6d41\u63a7\u5143\u7d20\uff0c\u5305\u62ec\uff1a</p> <ul> <li> <p>Credits Received\uff08CR\uff09\u8ba1\u6570\u5668\uff08\u8bd1\u6ce8\uff1a \u6ce8\u610f\u8fd9\u91cc CR \u4e0d\u662f\u524d\u9762\u7684 Credit Required\uff09</p> </li> <li> <p>Credits Allocated\uff08CA\uff09\u8ba1\u6570\u5668</p> </li> <li> <p>\u9519\u8bef\u68c0\u67e5\u903b\u8f91\uff08Error Check Logic\uff09</p> </li> </ul> <p>\u8fd9\u4e9b\u5143\u7d20\u4f7f\u5f97\u63a5\u6536\u65b9\u53ef\u4ee5\u4f7f\u7528\u8ddf\u53d1\u9001\u65b9\u76f8\u540c\u7684\u65b9\u5f0f\u6765\u8bb0\u5f55\u6d41\u63a7 Credit\u3002\u5982\u679c\u6d41\u63a7\u673a\u5236\u6b63\u786e\u8fd0\u884c\uff0c\u90a3\u4e48\u53d1\u9001\u65b9\u7684 Credits Consumed \u8ba1\u6570\u503c\uff08CC\uff09\u6c38\u8fdc\u4e0d\u4f1a\u8d85\u8fc7\u5b83\u7684 Credit Limit\uff08CL\uff09\uff0c\u5e76\u4e14\u63a5\u6536\u65b9\u7684 Credits Received\uff08CR\uff09\u4e5f\u6c38\u8fdc\u4e0d\u4f1a\u8d85\u8fc7\u5b83\u7684 Credits Allocated \u8ba1\u6570\u503c\uff08CA\uff09\u3002</p> <p>\u82e5\u68c0\u6d4b\u5230\u4e0b\u9762\u7684\u516c\u5f0f\u6210\u7acb\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u51fa\u73b0\u4e86\u6ea2\u51fa\u60c5\u51b5\u3002\u6ce8\u610f\u516c\u5f0f\u4e2d\u7684 Field Size \u5bf9 Header \u6765\u8bf4\u4e3a 8\uff0c\u5bf9\u6570\u636e\u6765\u8bf4\u4e3a 12\u3002</p> <p></p> <p>\u5f53\u516c\u5f0f\u6210\u7acb\u65f6\uff0c\u8bf4\u660e\u53d1\u9001\u81f3 FC Buffer \u7684 Credits \u6570\u91cf\u5df2\u7ecf\u8d85\u8fc7\u4e86\u53ef\u7528\u7684\u6570\u91cf\uff0c\u4e5f\u5c31\u662f\u8bf4\u53d1\u751f\u4e86\u6ea2\u51fa\u3002\u6ce8\u610f\u5728 PCIe 1.0a \u7248\u672c\u4e2d\u5b9a\u4e49\u7684\u516c\u5f0f\u4e2d\u4f7f\u7528\u7684\u662f\u2265\u800c\u4e0d\u662f\uff1e\u3002\u8fd9\u662f\u4e00\u4e2a\u9519\u8bef\uff0c\u56e0\u4e3a CA=CR\uff08Credits Received\uff09\u65f6\u5e76\u6ca1\u6709\u53d1\u751f\u6ea2\u51fa\u3002</p> <p></p> <p>\u56fe 6\u201114 Buffer \u6ea2\u51fa\u9519\u8bef\u68c0\u67e5</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#67-flow-control-update","title":"6.7 \u6d41\u63a7\u66f4\u65b0\uff08Flow Control Update\uff09","text":"<p>\u5f53\u63a5\u6536\u65b9\u7684 Buffer \u5185\u6709\u4e8b\u52a1\u88ab\u79fb\u9664\u65f6\uff0c\u4e5f\u5c31\u8bf4\u660e\u8fd9\u4e00\u90e8\u5206 Buffer \u7a7a\u95f4\u53c8\u53d8\u4e3a\u53ef\u7528\u4e86\uff0c\u90a3\u4e48\u63a5\u6536\u65b9\u5c31\u9700\u8981\u5b9a\u671f\u7684\u7528\u6700\u65b0\u7684\u6d41\u63a7 Credit \u6570\u91cf\u6765\u66f4\u65b0\u5bf9\u7aef\u8bbe\u5907\u3002\u56fe 6\u201115 \u7ed9\u51fa\u4e86\u4e00\u4e2a\u4f8b\u5b50\uff0c\u793a\u4f8b\u4e2d\u53d1\u9001\u65b9\u539f\u672c\u7531\u4e8e Buffer \u5df2\u6ee1\u7684\u539f\u56e0\u963b\u585e\u4e86 Header \u4e8b\u52a1\u7684\u53d1\u9001\uff0c\u800c\u540e\u63a5\u6536\u65b9\u4ece\u6d41\u63a7 Buffer \u4e2d\u79fb\u9664\u4e86 3 \u4e2a Header\uff0c\u8fd9\u4f7f\u5f97\u73b0\u5728\u6709\u53ef\u7528\u7684 Buffer \u7a7a\u95f4\u4e86\uff0c\u4f46\u662f\u6b64\u65f6\u5bf9\u7aef\u8bbe\u5907\u5e76\u4e0d\u77e5\u9053\u8fd9\u4ef6\u4e8b\u3002\u5f53 3 \u4e2a Header \u4ece Buffer \u4e2d\u79fb\u9664\u65f6\uff0cCREDITS_ALLOCATED \u8ba1\u6570\u503c\uff08CA\uff09\u4f1a\u4ece 66h \u589e\u52a0\u81f3 69h\uff0c\u8fd9\u4e2a\u65b0\u7684\u8ba1\u6570\u503c\u88ab\u62a5\u544a\u7ed9\u5bf9\u7aef\u8bbe\u5907\uff08\u53d1\u9001\u65b9\uff09\u7684 CREDIT_LIMIT \u5bc4\u5b58\u5668\uff0c\u62a5\u544a\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u6d41\u63a7\u66f4\u65b0\u5305\uff08FC Update packet\uff09\u3002\u4e00\u65e6 CREDIT_LIMIT \u88ab\u66f4\u65b0\uff0c\u53d1\u9001\u65b9\u5c31\u53ef\u4ee5\u7ee7\u7eed\u53d1\u9001 TLP \u4e86\u3002</p> <p>\u9700\u8981\u7279\u522b\u6307\u51fa\u7684\u4e00\u70b9\u662f\uff0c\u8fd9\u91cc\u66f4\u65b0\u62a5\u544a\u7684\u662f CREDITS_ALLOCATED \u5bc4\u5b58\u5668\u7684\u5b9e\u9645\u503c\u3002\u5176\u5b9e\u6211\u4eec\u672c\u53ef\u4ee5\u53ea\u62a5\u544a\u5bc4\u5b58\u5668\u503c\u7684\u53d8\u5316\u91cf\uff0c\u6bd4\u5982\u201cNon-Posted Header +3 Credits\u201d\uff0c\u4f46\u662f\u8fd9\u79cd\u8868\u793a\u4f1a\u5b58\u5728\u4e00\u4e2a\u6f5c\u5728\u7684\u95ee\u9898\u3002\u4e3a\u4e86\u7406\u89e3\u8fd9\u5176\u4e2d\u6240\u542b\u7684\u98ce\u9669\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u5982\u679c\u5305\u542b\u4e86\u5bc4\u5b58\u5668\u53d8\u5316\u589e\u91cf\u4fe1\u606f\u7684 DLLP \u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u9020\u6210\u4e86\u4e22\u5931\uff0c\u6b64\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u5bf9\u4e8e DLLP \u6765\u8bf4\u662f\u6ca1\u6709 replay \u673a\u5236\u7684\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u9519\u8bef\u90a3\u4e48\u5904\u7406\u65b9\u5f0f\u5c31\u662f\u7b80\u5355\u7684\u628a DLLP \u4e22\u5f03\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u589e\u91cf\u4fe1\u606f\u5c06\u4f1a\u4e22\u5931\uff0c\u5e76\u4e14\u6ca1\u6709\u65b9\u6cd5\u6062\u590d\u5b83\u3002</p> <p>\u53cd\u8fc7\u6765\u8bf4\uff0c\u5982\u679c\u62a5\u544a\u7684\u662f\u5bc4\u5b58\u5668\u7684\u5b9e\u9645\u503c\u800c\u4e0d\u662f\u589e\u91cf\uff0c\u90a3\u4e48\u5728 DLLP \u4f20\u8f93\u5931\u8d25\u65f6\uff0c\u4e0b\u4e00\u4e2a DLLP \u4f9d\u7136\u53ef\u4ee5\u5b8c\u6210\u8ba1\u6570\u503c\u7684\u540c\u6b65\u66f4\u65b0\u3002\u867d\u7136\u8fd9\u79cd\u60c5\u51b5\u6709\u65f6\u4f1a\u6d6a\u8d39\u4e00\u4e9b\u65f6\u95f4\uff0c\u6bd4\u5982\u53d1\u9001\u65b9\u9700\u8981\u5728\u4e00\u4e2a DLLP \u53d1\u9001\u5931\u8d25\u65f6\u7b49\u5f85\u4e0b\u4e00\u4e2a DLLP \u6765\u66f4\u65b0\u6d41\u63a7 Credit\uff0c\u4f46\u662f\u5e76\u4e0d\u4f1a\u6709\u4fe1\u606f\u7684\u4e22\u5931\u51fa\u73b0\u3002</p> <p></p> <p>\u56fe 6\u201115 \u6d41\u63a7\u66f4\u65b0\u793a\u4f8b</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#671-dllp-fc_update-dllp-format-and-content","title":"6.7.1     \u6d41\u63a7\u66f4\u65b0 DLLP \u683c\u5f0f\u548c\u5185\u5bb9\uff08FC_Update DLLP Format and Content\uff09","text":"<p>\u56de\u60f3\u4e00\u4e0b\uff0c\u6d41\u63a7\u66f4\u65b0\u5305\u4e0e\u6d41\u63a7\u521d\u59cb\u5316\u5305\u4e00\u6837\uff0c\u5305\u542b\u4e24\u4e2a Credit \u5b57\u6bb5\uff0c\u4e00\u4e2a\u662f Header Credit \u5b57\u6bb5\uff0c\u4e00\u4e2a\u662f Data Credit \u5b57\u6bb5\uff0c\u5982\u56fe 6\u201116 \u6240\u793a\u3002\u63a5\u6536\u65b9\u62a5\u544a\u5728 HdrFC \u548c DataFC \u5b57\u6bb5\u7684 Credit \u503c\u53ef\u80fd\u5df2\u7ecf\u66f4\u65b0\u4e86\u5f88\u591a\u6b21\uff0c\u4e5f\u6709\u53ef\u80fd\u81ea\u4ece\u4e0a\u6b21\u53d1\u9001\u66f4\u65b0\u5305\u540e\u5c31\u6ca1\u6709\u53d8\u8fc7\u3002</p> <p></p> <p>\u56fe 6\u201116 \u6d41\u63a7\u66f4\u65b0\u5305\u7684\u683c\u5f0f\u548c\u5185\u5bb9</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#672-flow-control-update-frequency","title":"6.7.2     \u6d41\u63a7\u66f4\u65b0\u9891\u7387\uff08Flow Control Update Frequency\uff09","text":"<p>\u9488\u5bf9\u6d41\u63a7\u66f4\u65b0 DLLP \u5e94\u8be5\u5982\u4f55\u53d1\u9001\uff0c\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u5404\u79cd\u89c4\u5219\u4ee5\u53ca\u5efa\u8bae\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002\u5b83\u4eec\u662f\u4e3a\u4e86\uff1a</p> <ul> <li> <p>\u5c3d\u53ef\u80fd\u65e9\u7684\u5c06\u6700\u65b0\u7684 CREDITS_ALLOCATED\uff08CA\uff09\u544a\u77e5\u7ed9\u53d1\u9001\u65b9\uff0c\u7279\u522b\u662f\u5f53\u6709\u4e8b\u52a1\u5df2\u7ecf\u88ab\u963b\u585e\u7684\u65f6\u5019\u3002</p> </li> <li> <p>\u786e\u7acb FC \u5305\u4e4b\u95f4\u7684\u5ef6\u65f6\u6700\u574f\u60c5\u51b5\u3002</p> </li> <li> <p>\u5e73\u8861\u5404\u76f8\u5173\u7684\u6d41\u63a7\u64cd\u4f5c\u7684\u9700\u6c42\uff0c\u4f8b\u5982\uff1a</p> </li> </ul> <p>\u2014  \u9700\u8981\u8db3\u591f\u9891\u7e41\u7684\u62a5\u544a Credit \u4fe1\u606f\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u4e8b\u52a1\u963b\u585e</p> <p>\u2014  \u5e0c\u671b\u51cf\u5c11\u6d41\u63a7\u66f4\u65b0 DLLP \u6240\u9700\u8981\u7684\u94fe\u8def\u5e26\u5bbd</p> <p>\u2014  \u9009\u62e9\u6700\u4f18\u7684 Buffer \u5927\u5c0f</p> <p>\u2014  \u9009\u62e9\u6700\u5927\u7684\u6570\u636e\u8377\u8f7d\u5927\u5c0f</p> <ul> <li>\u68c0\u6d4b\u6d41\u63a7\u5305\u4e4b\u95f4\u5173\u4e8e\u6700\u5927\u65f6\u5ef6\u7684\u8fdd\u4f8b\u60c5\u51b5\u3002</li> </ul> <p>\u6d41\u63a7\u66f4\u65b0\u4ec5\u5728\u94fe\u8def\u5904\u4e8e\u6d3b\u8dc3\u72b6\u6001\uff08active state\uff0cL0 or L0s\uff09\u65f6\u624d\u80fd\u4f7f\u7528\u3002\u6240\u6709\u5176\u4ed6\u7684\u94fe\u8def\u72b6\u6001\u8868\u793a\u66f4\u52a0\u79ef\u6781\u7684\u7535\u6e90\u7ba1\u7406\uff0c\u5b83\u5177\u6709\u66f4\u957f\u7684\u6062\u590d\u65f6\u5ef6\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#6721-credits_allocatedimmediate-notification-of-ca","title":"6.7.2.1   \u7acb\u5373\u901a\u544a CREDITS_ALLOCATED\uff08Immediate Notification of CA\uff09","text":"<p>\u5f53\u4e00\u4e2a\u6d41\u63a7 Buffer \u5df2\u7ecf\u6ee1\u5230\u65e0\u6cd5\u63a5\u6536\u6700\u5927\u7684\u6570\u636e\u5305\u65f6\uff0c\u534f\u8bae\u89c4\u8303\u8981\u6c42\u8981\u5728 Buffer \u51fa\u73b0\u66f4\u591a\u53ef\u7528\u7a7a\u95f4\u65f6\u7acb\u5373\u53d1\u9001\u4e00\u4e2a FC_Update DLLP\u3002\u5b58\u5728\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ul> <li> <p>\u6700\u5927\u6570\u636e\u5305\u5927\u5c0f=1Credit\u3002\u5f53\u6570\u636e\u5305\u7684\u53d1\u9001\u7531\u4e8e\u975e\u65e0\u9650\u7684 NPH\uff08Non-Posted Header\uff09\u3001NPD\uff08Non-Posted Data\uff09\u3001PH\uff08Posted Header\uff09\u548c CplH\uff08Completion Header\uff09\u8fd9\u4e9b\u79cd\u7c7b\u7684 Buffer \u5df2\u6ee1\u800c\u88ab\u963b\u585e\u65f6\uff0c\u82e5\u6b64\u65f6\u6709 1 \u4e2a\u6216\u591a\u4e2a\u7684 Credit \u53d8\u4e3a\u53ef\u7528\uff08\u5df2\u5206\u914d\uff09\uff0c\u90a3\u4e48\u6d41\u63a7\u66f4\u65b0\u5305\uff08UpdataFC Packet\uff09\u5fc5\u987b\u8981\u88ab\u5b89\u6392\u4f20\u8f93\u3002</p> </li> <li> <p>\u6700\u5927\u6570\u636e\u5305\u5927\u5c0f=Max_Payload_Size\u3002\u5bf9\u4e8e\u975e\u65e0\u9650\u7684 PD \u548c CplD \u7684 Credit \u7c7b\u578b\uff0c\u6d41\u63a7 Buffer \u7a7a\u95f4\u53ef\u80fd\u4f1a\u51cf\u5c0f\u5230\u65e0\u6cd5\u53d1\u9001\u6700\u5927\u6570\u636e\u5305\u7684\u7a0b\u5ea6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53 1 \u4e2a\u6216\u591a\u4e2a\u7684 Credit \u53d8\u4e3a\u53ef\u7528\uff08\u5df2\u5206\u914d\uff09\uff0c\u6d41\u63a7\u66f4\u65b0\u5305\u5fc5\u987b\u8981\u88ab\u5b89\u6392\u4f20\u8f93\u3002</p> </li> </ul>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#6722-dllp-maximum-latency-between-updatefc","title":"6.7.2.2   \u6d41\u63a7\u66f4\u65b0 DLLP \u95f4\u6700\u5927\u5ef6\u65f6\uff08Maximum Latency Between UpdateFC\uff09","text":"<p>\u6bcf\u79cd FC Credit \u7c7b\u578b\uff08\u975e\u65e0\u9650\uff09\u7684\u6d41\u63a7\u66f4\u65b0\u5305\u5b89\u6392\u53d1\u9001\u7684\u9891\u7387\u81f3\u5c11\u8981\u8fbe\u5230\u6bcf 30us\uff08-0%/+50%\uff09\u53d1\u9001\u4e00\u6b21\u3002\u5982\u679c\u8bbe\u7f6e\u4e86\u63a7\u5236\u94fe\u8def\u5bc4\u5b58\u5668\uff08Control Link Register\uff09\u5185\u7684\u6269\u5c55\u540c\u6b65\u4f4d\uff08Extended Sync bit\uff09\uff0c\u90a3\u4e48\u5b89\u6392\u66f4\u65b0\u7684\u9891\u7387\u5fc5\u987b\u4e0d\u4f4e\u4e8e 120us\uff08-0%/+50%\uff09\u4e00\u6b21\u3002\u6ce8\u610f\uff0c\u5b9e\u9645\u5b89\u6392\u53d1\u9001\u6d41\u63a7\u66f4\u65b0\u5305\u7684\u9891\u7387\u53ef\u80fd\u8981\u6bd4\u534f\u8bae\u89c4\u8303\u4e2d\u8981\u6c42\u7684\u66f4\u9891\u7e41\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#6723-payload-size","title":"6.7.2.3   \u57fa\u4e8e Payload Size \u548c\u94fe\u8def\u5bbd\u5ea6\u8ba1\u7b97\u66f4\u65b0\u9891\u7387","text":"<p>\u534f\u8bae\u89c4\u8303\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u516c\u5f0f\u7528\u4e8e\u8ba1\u7b97\u66f4\u65b0\u9891\u7387\uff0c\u8fd9\u4e2a\u8ba1\u7b97\u662f\u57fa\u4e8e\u6700\u5927 Payload Size \u4ee5\u53ca\u94fe\u8def\u5bbd\u5ea6\u7684\u3002\u5728\u4e0b\u9762\u5c55\u793a\u7684\u516c\u5f0f\u4e2d\uff0c\u4f7f\u7528\u7b26\u53f7\u65f6\u95f4\uff08symbol time\uff09\u6765\u5b9a\u4e49\u6d41\u63a7\u66f4\u65b0\u7684\u53d1\u9001\u95f4\u9694\u3002\u4f5c\u4e3a\u53c2\u8003\uff0c1 \u4e2a\u7b26\u53f7\u65f6\u95f4\u7684\u5b9a\u4e49\u4e3a\u4f20\u8f93 1 \u4e2a symbol \u6240\u9700\u8981\u7684\u65f6\u95f4\uff0cGen1 \u4e3a 4ns\uff0cGen2 \u4e3a 2ns\uff0cGen3 \u4e3a 1ns\u3002\u8868 6\u20113\u3001\u8868 6\u20114\u3001\u8868 6\u20115 \u5c55\u793a\u4e86\u6bcf\u79cd\u901f\u7387\u4e0b\u7684\u539f\u751f\u672a\u8c03\u6574\u7684\u6d41\u63a7\u66f4\u65b0\u53c2\u6570\u503c\u3002\uff08\u8bd1\u6ce8\uff1aUF \u610f\u4e3a UpdateFactor\uff0c\u539f\u6587\u4e2d\u7684 FC \u5e94\u8be5\u662f\u5199\u9519\u4e86\uff0c\u5e94\u8be5\u4e5f\u662f UF\uff09</p> <p></p> <ul> <li> <p>\u6700\u5927\u8377\u8f7d\u5927\u5c0f\uff08MaxPayloadSize\uff09\uff1a\u8fd9\u4e2a\u503c\u5728\u8bbe\u5907\u7684\u63a7\u5236\u5bc4\u5b58\u5668\uff08Control Register\uff09\u4e2d\u7684 Max_Payload_Size \u5b57\u6bb5\u3002</p> </li> <li> <p>TLP \u5f00\u9500\uff08TLP Overhead\uff09\uff1a\u5e38\u6570\u503c\uff0828 symbol\uff09\u8868\u793a\u6d88\u8017\u94fe\u8def\u5e26\u5bbd\u7684\u9644\u52a0 TLP \u7ec4\u4ef6\uff08TLP \u524d\u7f00 Prefix\u3001\u5e8f\u5217\u53f7 Sequence Number\u3001\u5305\u5934 Header\u3001LCRC\u3001\u7ec4\u5e27\u7b26\u53f7 Framing Symbol\uff09\u3002</p> </li> <li> <p>\u66f4\u65b0\u56e0\u5b50\uff08UpdateFactor\uff09\uff1a\u5728\u4e24\u4e2a\u76f8\u90bb\u6d41\u63a7\u66f4\u65b0\u5305\u88ab\u63a5\u6536\u5230\u7684\u4e2d\u95f4\u95f4\u9694\u7684\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff0c\u6240\u80fd\u53d1\u9001\u7684\u6700\u5927\u5927\u5c0f TLP \u7684\u6570\u91cf\u3002\u8fd9\u4e2a\u6570\u5b57\u662f\u4e3a\u4e86\u5e73\u8861\u94fe\u8def\u5e26\u5bbd\u6548\u7387\u548c\u63a5\u6536 Buffer \u5927\u5c0f\u2014\u2014\u56e0\u4e3a\u8fd9\u4e2a\u503c\u4f1a\u968f Max_Payload_Size \u548c\u94fe\u8def\u5bbd\u5ea6\u800c\u53d1\u751f\u53d8\u5316\u3002</p> </li> <li> <p>\u94fe\u8def\u5bbd\u5ea6\uff08LinkWidth\uff09\uff1a\u94fe\u8def\u6240\u4f7f\u7528\u7684\u901a\u9053\uff08Lane\uff09\u6570\u91cf\u3002</p> </li> <li> <p>\u5185\u90e8\u5ef6\u65f6\uff08InternalDelay\uff09\uff1a\u662f\u4e00\u4e2a\u5e38\u6570\u503c\uff0c\u4e3a 19 \u4e2a\u7b26\u53f7\u65f6\u95f4\uff08symbol time\uff09\uff0c\u8868\u793a\u63a5\u6536\u5230 TLP \u5e76\u53d1\u9001 DLLP \u6240\u9700\u8981\u7684\u5185\u90e8\u5904\u7406\u5ef6\u8fdf\u3002</p> </li> </ul> <p>\u516c\u5f0f\u4e2d\u5b9a\u4e49\u7684\u5173\u7cfb\u8868\u660e\uff0c\u53d1\u9001\u6d41\u63a7\u66f4\u65b0\u5305\u7684\u9891\u7387\u968f\u94fe\u8def\u5bbd\u5ea6\u589e\u52a0\u800c\u51cf\u5c11\uff0c\u5efa\u8bae\u4f7f\u7528\u8ba1\u65f6\u5668\u6765\u89e6\u53d1\u6d41\u63a7\u66f4\u65b0\u5305\u7684\u8c03\u5ea6\u53d1\u9001\u3002\u9700\u8981\u6ce8\u610f\uff0c\u8fd9\u4e2a\u516c\u5f0f\u4e0d\u8003\u8651\u63a5\u6536\u65b9\u6216\u662f\u53d1\u9001\u65b9\u5728 L0s \u7535\u6e90\u7ba1\u7406\u72b6\u6001\u65f6\u76f8\u5173\u7684\u5ef6\u65f6\uff08\u8bd1\u6ce8\uff1a\u524d\u9762\u63d0\u5230\u8fc7\u4ec5\u5728 active \u72b6\u6001\u624d\u53ef\u4ee5\u4f7f\u7528\u6d41\u63a7\u66f4\u65b0\uff09\u3002</p> <p></p> <p>\u8868 6\u20113 PCIe Gen1 \u539f\u751f\u672a\u8c03\u6574\u7684 AckNak_LATENCY_TIMER \u503c\uff08\u5355\u4f4d\u4e3a Symbol time\uff09</p> <p></p> <p>\u8868 6\u20114 PCIe Gen2 \u539f\u751f\u672a\u8c03\u6574\u7684 AckNak_LATENCY_TIMER \u503c\uff08\u5355\u4f4d\u4e3a Symbol time\uff09</p> <p></p> <p>\u8868 6\u20115 PCIe Gen3 \u539f\u751f\u672a\u8c03\u6574\u7684 AckNak_LATENCY_TIMER \u503c\uff08\u5355\u4f4d\u4e3a Symbol time\uff09</p> <p>\u8bd1\u6ce8\uff1a\u8bd1\u8005\u5bf9\u4e0a\u9762\u4e09\u4e2a\u8868\u683c\u8fdb\u884c\u4e3e\u4f8b\u8bf4\u660e\uff0c\u9009\u53d6 PCIe Gen1\uff0cMax Payload=256\uff0cx2 Link\uff0c\u4ee3\u5165\u516c\u5f0f\u5f97\u5230((256+28)*1.4/2)+19=217.8\uff0c\u4e0d\u96be\u53d1\u73b0\u5c31\u662f\u5bf9\u5e94\u8868\u4e2d 217 \u8fd9\u4e2a\u503c\u3002</p> <p>\u800c\u5bf9\u4e8e Gen2\u3001Gen3 \u53ef\u80fd\u53d1\u73b0\u4e0d\u7b26\u5408\u516c\u5f0f\uff0c\u5176\u5b9e\u4e0d\u96be\u53d1\u73b0 Gen2=Gen1+51\uff0cGen3=Gen2+45\uff0c\u8fd9\u5e94\u8be5\u662f\u4e66\u4e2d\u6ca1\u6709\u63d0\u4f9b\u4e00\u4e9b\u5e38\u6570\u53c2\u6570\u7684\u539f\u56e0\uff0c\u603b\u4e4b Gen2 \u8868\u683c\u5185\u7684\u503c\u90fd\u7b49\u4e8e Gen1 \u5bf9\u5e94\u7684\u503c\u52a0\u4e0a 51\uff1bGen3 \u8868\u683c\u5185\u7684\u503c\u90fd\u7b49\u4e8e Gen2 \u5bf9\u5e94\u7684\u503c\u52a0\u4e0a 45\u3002</p> <p>\u534f\u8bae\u89c4\u8303\u8ba4\u8bc6\u5230\u8fd9\u4e2a\u516c\u5f0f\u5176\u5b9e\u5bf9\u4e8e\u8bb8\u591a\u5e94\u7528\u573a\u666f\u7684\u4f7f\u7528\u662f\u4e0d\u6070\u5f53\u7684\uff0c\u6bd4\u5982\u90a3\u4e9b\u4f7f\u7528\u5927\u5757\u6570\u636e\u6d41\u7684\u5e94\u7528\u3002\u8fd9\u4e9b\u5e94\u7528\u53ef\u80fd\u4f1a\u8981\u6c42\u5b9e\u9645 Buffer \u7684\u5927\u5c0f\u8981\u5927\u4e8e\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u5927\u5c0f\uff0c\u4ee5\u53ca\u4f7f\u7528\u66f4\u590d\u6742\u7684\u66f4\u65b0\u7b56\u7565\uff0c\u4ee5\u6b64\u6765\u4f18\u5316\u6027\u80fd\u548c\u964d\u4f4e\u529f\u8017\u3002\u7531\u4e8e\u89e3\u51b3\u65b9\u6848\u4f9d\u8d56\u4e8e\u5177\u4f53\u5e94\u7528\u7684\u7279\u5b9a\u9700\u6c42\uff0c\u56e0\u6b64\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u63d0\u4f9b\u6b64\u7c7b\u7b56\u7565\u7684\u5b9a\u4e49\u3002</p>"},{"location":"pcie/06%20%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/#673-error-detection-timera-pseudo-requirement","title":"6.7.3     \u9519\u8bef\u68c0\u6d4b\u8ba1\u65f6\u5668\u2014\u2014\u4e00\u4e2a\u8f6f\u8981\u6c42\uff08Error Detection Timer\u2014\u2014A Pseudo Requirement\uff09","text":"<p>\u534f\u8bae\u89c4\u8303\u4e2d\u4e3a\u6d41\u63a7\u5305\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53ef\u9009\u7684\u8d85\u65f6\uff08time-out\uff09\u673a\u5236\uff0c\u5e76\u4e14\u5f3a\u70c8\u5efa\u8bae\u5b9e\u73b0\u5b83\uff0c\u76ee\u524d\u5b83\u53ea\u662f\u4e00\u4e2a\u8f6f\u8981\u6c42\uff0c\u4f46\u662f\u5728\u672a\u6765\u7248\u672c\u7684\u534f\u8bae\u4e2d\u5b83\u53ef\u80fd\u4f1a\u6210\u4e3a\u4e00\u4e2a\u786c\u6027\u7684\u8981\u6c42\u3002\u5bf9\u4e8e\u4e00\u79cd\u7ed9\u5b9a\u7684 Credit \u7c7b\u578b\uff0c\u5b83\u7684\u4e24\u4e2a\u6d41\u63a7\u5305\u4e4b\u95f4\u7684\u6700\u5927\u5ef6\u65f6\u95f4\u9694\u4e3a 120us\uff0c\u800c\u5bf9\u4e8e\u8d85\u65f6\u673a\u5236\u6765\u8bf4\u8d85\u65f6\u754c\u9650\u4e3a 200us\u3002\u5bf9\u4e8e\u6bcf\u79cd\u6d41\u63a7 Credit \u7c7b\u578b\uff08Posted\u3001Non-Posted\u3001Completion\uff09\uff0c\u90fd\u5404\u81ea\u6709\u5355\u72ec\u7684\u8d85\u65f6\u8ba1\u65f6\u5668\uff0c\u4e14\u6bcf\u4e2a\u8ba1\u65f6\u5668\u90fd\u5728\u6536\u5230\u76f8\u5e94\u7c7b\u578b\u7684\u6d41\u63a7\u66f4\u65b0 DLLP \u65f6\u8fdb\u884c\u590d\u4f4d\u3002\u9700\u8981\u6ce8\u610f\uff0c\u4e0e\u65e0\u9650\u6d41\u63a7 Credit \u76f8\u5173\u8054\u7684\u8d85\u65f6\u8ba1\u65f6\u5668\u4e00\u5b9a\u4e0d\u80fd\u62a5\u544a\u9519\u8bef\u3002</p> <p>\u9664\u5f00\u65e0\u9650 Credit \u7684\u60c5\u51b5\u4e4b\u5916\uff0c\u5176\u4ed6\u60c5\u51b5\u4e0b\u7684\u8d85\u65f6\u610f\u5473\u7740\u94fe\u8def\u5b58\u5728\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\u3002\u5982\u679c\u8d85\u65f6\u53d1\u751f\u4e86\uff0c\u90a3\u4e48\u7269\u7406\u5c42\u5c31\u4f1a\u88ab\u901a\u77e5\u8fdb\u5165\u6062\u590d\u72b6\u6001\uff08Recovery state\uff09\uff0c\u5e76\u91cd\u65b0\u8fdb\u884c\u94fe\u8def\u8bad\u7ec3\uff0c\u4ee5\u671f\u671b\u6e05\u9664\u9519\u8bef\u72b6\u6001\u3002\u8d85\u65f6\u8ba1\u65f6\u5668\u7684\u7279\u6027\u5305\u62ec\uff1a</p> <ul> <li> <p>\u4ec5\u5728\u94fe\u8def\u5904\u4e8e active \u72b6\u6001\uff08L0 or L0s\uff09\u624d\u8fdb\u884c\u5de5\u4f5c\u3002</p> </li> <li> <p>\u6700\u5927\u65f6\u95f4\u9650\u4e3a 200us\uff08-0%/+50%\uff09</p> </li> <li> <p>\u5f53\u63a5\u6536\u5230\u521d\u59cb\u5316\uff08Init\uff09\u6216\u8005\u6d41\u63a7\u66f4\u65b0\u5305\uff08Update FCP\uff09\u65f6\uff0c\u8ba1\u65f6\u5668\u5c31\u4f1a\u590d\u4f4d\u3002\u6216\u8005\u53ef\u9009\u7684\uff0c\u4e5f\u53ef\u4ee5\u5728\u63a5\u6536\u5230\u4efb\u4f55 DLLP \u65f6\u90fd\u590d\u4f4d\u8ba1\u65f6\u5668\u3002</p> </li> <li> <p>\u8d85\u65f6\uff08Timeout\uff09\u4f1a\u5f3a\u5236\u7269\u7406\u5c42\u8fdb\u5165 LTSSM\uff08\u94fe\u8def\u8bad\u7ec3\u548c\u72b6\u6001\u72b6\u6001\u673a\uff0cLink Training and Status State Machine\uff09\u7684\u6062\u590d\u72b6\u6001\uff08Recovery State\uff09\u3002</p> </li> </ul> <p>\u539f\u6587\uff1a  Mindshare</p> <p>\u8bd1\u8005\uff1a  Michael ZZY</p> <p>\u6821\u5bf9\uff1a  LJGibbs </p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/","title":"07 QoS \u670d\u52a1\u8d28\u91cf","text":""},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#chapter-7-quality-of-service-qos","title":"Chapter 7      Quality of Service //QoS\u670d\u52a1\u8d28\u91cf","text":""},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#_1","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u8282\u8ba8\u8bba\u4e86\u6d41\u91cf\u63a7\u5236\u534f\u8bae\uff08Flow Control\uff09\u7684\u76ee\u7684\u4ee5\u53ca\u7ec6\u8282\u64cd\u4f5c\u3002\u6d41\u91cf\u63a7\u5236\u662f\u7528\u6765\u786e\u4fdd\u5728\u63a5\u6536\u8005\u65e0\u6cd5\u63a5\u6536TLP\u65f6\uff0c\u53d1\u9001\u65b9\u4e0d\u4f1a\u518d\u7ee7\u7eed\u53d1\u9001TLP\u3002\u8fd9\u907f\u514d\u4e86\u63a5\u6536Buffer\u6ea2\u51fa\uff0c\u4e5f\u6d88\u9664\u4e86\u539f\u672cPCI\u5de5\u4f5c\u65b9\u5f0f\u4e2d\u7684\u4e00\u4e9b\u4f4e\u6548\u884c\u4e3a\uff0c\u6bd4\u5982\u65ad\u5f00\uff08disconnect\uff09\u3001\u91cd\u8bd5\uff08retry\uff09\u548c\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u4f1a\u8ba8\u8bba\u7528\u4e8e\u652f\u6301QoS\uff08Quality of Service\uff09\u7684\u673a\u5236\uff0c\u5e76\u63cf\u8ff0\u5bf9\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u4e0d\u540c\u6570\u636e\u5305\u7684\u4f20\u8f93\u65f6\u95f4\u548c\u5e26\u5bbd\u8fdb\u884c\u63a7\u5236\u7684\u610f\u4e49\u3002\u8fd9\u4e9b\u673a\u5236\u5305\u62ec\uff0c\u7279\u5b9a\u5e94\u7528\u7684\u8f6f\u4ef6\u5c06\u4f1a\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u8bbe\u5907\u5185\u6784\u5efa\u53ef\u9009\u7684\u786c\u4ef6\u6765\u542f\u7528\u4e8b\u52a1\u4f18\u5148\u7ea7\u7ba1\u7406\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u5c06\u4f1a\u8ba8\u8bbaPCIe\u62d3\u6251\u7ed3\u6784\u4e2d\u7684\u4e8b\u52a1\u5bf9\u6392\u5e8f\u7684\u8981\u6c42\u3002\u8fd9\u4e9b\u89c4\u5219\u662f\u7ee7\u627f\u81eaPCI\u7684\uff0c\u5b83\u4eec\u8bb8\u591a\u90fd\u53d7\u5230\u201c\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff08Producer/Consumer\uff09\u201d\u7a0b\u5e8f\u8bbe\u8ba1\u6a21\u578b\u7684\u63a8\u52a8\uff0c\u56e0\u6b64\u5728\u4e0b\u4e00\u7ae0\u5185\u4f1a\u63cf\u8ff0\u8fd9\u4e2a\u6a21\u578b\u7684\u673a\u5236\u539f\u7406\u3002\u539f\u59cb\u7684\u89c4\u5219\u4e2d\u8fd8\u8003\u8651\u4e86\u5fc5\u987b\u8981\u907f\u514d\u7684\u90a3\u4e9b\u6b7b\u9501\u60c5\u51b5\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#71-qosmotivation","title":"7.1 QoS\u7684\u51fa\u53d1\u70b9\uff08Motivation\uff09","text":"<p>\u5982\u4eca\u7684\u8bb8\u591a\u8ba1\u7b97\u673a\u7cfb\u7edf\u5e76\u4e0d\u542b\u6709\u7528\u4e8e\u7ba1\u7406\u5916\u8bbe\u6d41\u91cf\u7684\u673a\u5236\uff0c\u4f46\u662f\u6709\u4e00\u4e9b\u5e94\u7528\u662f\u9700\u8981\u8fd9\u79cd\u673a\u5236\u7684\u3002\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u6d41\u5a92\u4f53\u89c6\u9891\u901a\u8fc7\u4e00\u4e2a\u901a\u7528\u6570\u636e\u603b\u7ebf\uff08General-Purpose data bus\uff09\u8fdb\u884c\u4f20\u8f93\uff0c\u8fd9\u8981\u6c42\u6570\u636e\u8981\u5728\u6b63\u786e\u7684\u65f6\u95f4\u8fdb\u884c\u4f20\u8f93\u3002\u5728\u5d4c\u5165\u5f0f\u5f15\u5bfc\u63a7\u5236\u7cfb\u7edf\u4e2d\uff0c\u53ca\u65f6\u7684\u4f20\u8f93\u89c6\u9891\u6570\u636e\u5bf9\u4e8e\u7cfb\u7edf\u64cd\u4f5c\u6765\u8bf4\u4e5f\u662f\u6781\u4e3a\u5173\u952e\u7684\u3002\u7531\u4e8e\u9884\u89c1\u5230\u4e86\u8fd9\u4e9b\u9700\u6c42\uff0c\u539f\u59cb\u7684PCIe\u534f\u8bae\u89c4\u8303\u4e2d\u5c31\u5305\u542b\u4e86QoS\uff08\u670d\u52a1\u8d28\u91cf\uff09\u673a\u5236\uff0c\u5b83\u53ef\u4ee5\u4f7f\u5f97\u67d0\u4e9b\u6d41\u91cf\u66f4\u4f18\u5148\u88ab\u4f20\u8f93\u6216\u5904\u7406\u3002\u66f4\u5e7f\u4e49\u7684\u8bf4\u6cd5\u662f\uff0c\u8fd9\u662f\u4e00\u79cd\u5dee\u5f02\u5316\u7684\u670d\u52a1\uff08Differentiated Service\uff09\uff0c\u56e0\u4e3a\u6570\u636e\u5305\u4f1a\u6839\u636e\u88ab\u5206\u914d\u5230\u7684\u4f18\u5148\u7ea7\u4e0d\u540c\u800c\u53d7\u5230\u4e0d\u540c\u7684\u5904\u7406\u5bf9\u5f85\uff0c\u5e76\u4e14\u8fd9\u79cd\u673a\u5236\u5141\u8bb8\u6709\u4e00\u4e2a\u8303\u56f4\u8f83\u5e7f\u7684\u670d\u52a1\u504f\u597d\uff08\u4e5f\u5c31\u662f\u5141\u8bb8\u7684\u4f18\u5148\u7ea7\u6bd4\u8f83\u591a\uff09\u3002\u5728\u8fd9\u4e2a\u8303\u56f4\u7684\u9ad8\u7684\u4e00\u7aef\uff0cQoS\u673a\u5236\u53ef\u4ee5\u4e3a\u8fd9\u4e2a\u4f18\u5148\u7ea7\u7684\u5e94\u7528\u63d0\u4f9b\u53ef\u9884\u6d4b\u7684\uff08Predictable\uff09\u4ee5\u53ca\u53ef\u4fdd\u8bc1\u7684\uff08Guaranteed\uff09\u7684\u6027\u80fd\u3002\u8fd9\u79cd\u7ea7\u522b\u7684\u670d\u52a1\u652f\u6301\u88ab\u79f0\u4e3a\u201cIsochronous\uff08\u540c\u6b65\u7684\uff09\u201d\u670d\u52a1\uff08\u53ef\u4ee5\u7c7b\u6bd4\u540c\u6b65\u4ee5\u592a\u7f51\u3001TTE\uff0c\u8fd9\u91cc\u7684Isochronous\u5c31\u662f\u8fd9\u4e2a\u540c\u6b65\u7684\u542b\u4e49\uff09\uff0c\u8fd9\u4e2a\u672f\u8bed\u6765\u6e90\u4e8e\u4e24\u4e2a\u5e0c\u814a\u5355\u8bcd\u201cisos\u201d\uff08\u76f8\u7b49\uff09\u548c\u201cchronos\u201d\uff08\u65f6\u95f4\uff09\uff0c\u5408\u8d77\u6765\u5c31\u8868\u793a\u67d0\u4e2a\u4e8b\u60c5\u4ee5\u76f8\u540c\u7684\u65f6\u95f4\u95f4\u9694\u53d1\u751f\u3002\u8981\u4f7f\u5f97\u8fd9\u6837\u7684\u673a\u5236\u5728PCIe\u4e2d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fd9\u8981\u6c42\u786c\u4ef6\u5143\u7d20\u548c\u8f6f\u4ef6\u5143\u7d20\u7684\u5171\u540c\u4f5c\u7528\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#72-basic-elements","title":"7.2 \u57fa\u672c\u5143\u7d20\uff08Basic Elements\uff09","text":"<p>\u652f\u6301\u9ad8\u7ea7\u522b\u7684\u670d\u52a1\u7ed9\u7cfb\u7edf\u6027\u80fd\u63d0\u51fa\u4e86\u4e00\u4e9b\u8981\u6c42\u3002\u4f8b\u5982\uff0c\u4f20\u8f93\u901f\u7387\u9700\u8981\u8db3\u591f\u7684\u9ad8\uff0c\u8fd9\u6837\u624d\u80fd\u6ee1\u8db3\u5e94\u7528\u5728\u4e00\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u4f20\u8f93\u8db3\u591f\u591a\u7684\u6570\u636e\u7684\u9700\u6c42\uff0c\u540c\u65f6\u8fd9\u4e5f\u4f7f\u5f97\u5e94\u7528\u80fd\u591f\u9002\u5e94\u4e0e\u5176\u4ed6\u6d41\u91cf\u4e4b\u95f4\u7684\u7ade\u4e89\u3002\u53e6\u5916\uff0c\u4f20\u8f93\u65f6\u5ef6\u4e5f\u9700\u8981\u8db3\u591f\u4f4e\uff0c\u8fd9\u6837\u624d\u80fd\u786e\u8ba4\u6570\u636e\u5305\u53ca\u65f6\u4f20\u8f93\u5230\u8fbe\uff0c\u907f\u514d\u51fa\u73b0\u5ef6\u8fdf\u95ee\u9898\u3002\u6700\u540e\uff0c\u5fc5\u987b\u8981\u5bf9\u9519\u8bef\u5904\u7406\u8fdb\u884c\u7ba1\u7406\uff0c\u8fd9\u6837\u5b83\u624d\u4e0d\u4f1a\u5f71\u54cd\u5230\u9700\u8981\u53ca\u65f6\u4f20\u8f93\u7684\u6570\u636e\u5305\u7684\u4f20\u8f93\u3002\u8981\u5b9e\u73b0\u4e0a\u8ff0\u8fd9\u4e9b\u76ee\u6807\uff0c\u9700\u8981\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u786c\u4ef6\u5143\u7d20\uff0c\u5176\u4e2d\u4e00\u79cd\u5c31\u662f\u4e00\u7ec4\u79f0\u4e3aVirtual Channel Capability Block\uff08\u865a\u62df\u901a\u9053\u80fd\u529b\u5757\uff09\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7ec4\uff0c\u5982\u56fe 7\u20111\u6240\u793a\u3002</p> <p></p> <p>\u56fe 7\u20111\u865a\u62df\u901a\u9053\u80fd\u529b\u5bc4\u5b58\u5668</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#721-tctraffic-class","title":"7.2.1     \u6d41\u91cf\u7c7b\u578bTC\uff08Traffic Class\uff09","text":"<p>\u6211\u4eec\u6240\u9700\u8981\u7684\u7b2c\u4e00\u4ef6\u4e8b\u60c5\u662f\u8981\u7528\u4e00\u79cd\u65b9\u5f0f\u6765\u533a\u5206\u5404\u79cd\u6d41\u91cf\uff0c\u4e5f\u5c31\u662f\u9700\u8981\u7528\u4e00\u4e9b\u4e1c\u897f\u6765\u533a\u5206\u54ea\u4e9b\u6570\u636e\u5305\u5177\u6709\u9ad8\u4f18\u5148\u7ea7\u3002\u8fd9\u79cd\u9700\u6c42\u662f\u901a\u8fc7\u4e3a\u6570\u636e\u5305\u6807\u660e\u6d41\u91cf\u7c7b\u578b\uff08TC\uff09\u6765\u5b8c\u6210\u7684\uff0c\u6d41\u91cf\u7c7b\u578b\uff08TC\uff09\u4e2d\u5b9a\u4e49\u4e868\u4e2a\u4f18\u5148\u7ea7\uff0c\u5b83\u901a\u8fc7TLP Header\u4e2d\u76843bit TC\u5b57\u6bb5\u6765\u8868\u793a\uff08TC 0-7\uff0c\u6570\u5b57\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff09\u3002\u56fe 7\u20112\u6240\u793a\u768432\u4f4dmemory\u8bf7\u6c42\u7684TLP Header\u4e2d\u6807\u8bc6\u51fa\u4e86TC\u5b57\u6bb5\u7684\u4f4d\u7f6e\u3002\u5728\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\uff0c\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u4e0e\u540c\u6b65\u7ba1\u7406\u8f6f\u4ef6\uff08Isochronous Management software\uff09\u6c9f\u901a\u670d\u52a1\u7684\u7ea7\u522b\uff0c\u540c\u6b65\u7ba1\u7406\u8f6f\u4ef6\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684TC\u503c\u6765\u4f7f\u7528\u5404\u79cd\u6d41\u91cf\u7c7b\u578b\u7684\u6570\u636e\u5305\u3002\u7136\u540e\u9a71\u52a8\u7a0b\u5e8f\u5c31\u4f1a\u7ed9\u6570\u636e\u5305\u5206\u914d\u6b63\u786e\u7684TC\u4f18\u5148\u7ea7\u3002TC\u503c\u9ed8\u8ba4\u4e3a0\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba9\u4e0d\u9700\u8981\u9ad8\u4f18\u5148\u7ea7\u670d\u52a1\u7684\u6570\u636e\u5305\u4e0d\u4f1a\u5e72\u6270\u5230\u90a3\u4e9b\u9700\u8981\u9ad8\u4f18\u5148\u7ea7\u670d\u52a1\u7684\u6570\u636e\u5305\u3002</p> <p></p> <p>\u56fe 7\u20112 TLP Header\u4e2d\u7684\u6d41\u91cf\u7c7b\u578b\uff08TC\uff09\u5b57\u6bb5</p> <p>\u4e0d\u8bc6\u522bPCIe\u7684\u914d\u7f6e\u8f6f\u4ef6\uff08\u6307\u4f20\u7edfPCI\u7684\u914d\u7f6e\u8f6f\u4ef6\uff09\u662f\u65e0\u6cd5\u8bc6\u522b\u51fa\u8fd9\u4e9b\u65b0\u7684\u5bc4\u5b58\u5668\u7684\uff0c\u5b83\u5c31\u4f1a\u4e3a\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u5206\u914d\u9ed8\u8ba4\u7684TC0/VC0\u3002\u53e6\u5916\uff0c\u4e5f\u6709\u4e00\u4e9b\u6570\u636e\u5305\u4e00\u76f4\u88ab\u8981\u6c42\u8981\u4f7f\u7528TC0/VC0\uff0c\u6bd4\u5982\u914d\u7f6e\uff08Configuration\uff09\u3001I/O\u4ee5\u53caMessage\u4e8b\u52a1\u3002\u5982\u679c\u8fd9\u4e9b\u6570\u636e\u5305\u88ab\u8ba4\u4e3a\u662f\u7ef4\u62a4\u5305\u6d41\u91cf\uff0c\u90a3\u4e48\u5c31\u6709\u5fc5\u8981\u5c06\u5b83\u4eec\u9650\u5236\u5728VC0\u4e2d\uff0c\u5e76\u4e14\u8981\u8ba9\u5b83\u4eec\u539f\u7406\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u7684\u4f20\u8f93\u8def\u5f84\uff0c\u907f\u514d\u5f71\u54cd\u5230\u9ad8\u4f18\u5148\u7ea7\u5305\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#722-vcvirtual-channels","title":"7.2.2     \u865a\u62df\u901a\u9053VC\uff08Virtual Channels\uff09","text":"<p>VC\uff08\u865a\u62df\u901a\u9053\uff09\u5b9e\u9645\u4e0a\u662f\u786c\u4ef6Buffer\uff0c\u5b83\u7528\u6765\u4f5c\u4e3a\u8f93\u51fa\u6570\u636e\u5305\u7684\u961f\u5217\u3002\u6bcf\u4e2a\u7aef\u53e3\u90fd\u5fc5\u987b\u8981\u5305\u542b\u9ed8\u8ba4\u7684VC0\uff0c\u5e76\u4e14\u6700\u591a\u53ef\u4ee5\u67098\u4e2aVC\uff08VC0-VC7\uff09\u3002\u6bcf\u4e2a\u901a\u9053\u90fd\u8868\u793a\u53ef\u4f9b\u8f93\u51fa\u6570\u636e\u5305\u4f7f\u7528\u7684\u4e0d\u540c\u4f20\u8f93\u8def\u5f84\u3002\u4f7f\u7528\u591a\u901a\u9053\u8def\u5f84\u7684\u60f3\u6cd5\u7c7b\u4f3c\u4e8e\u6536\u8d39\u516c\u8def\uff0c\u5982\u679c\u53f8\u673a\u8d2d\u4e70\u4e86\u67d0\u79cd\u65e0\u7ebf\u7535\u6807\u7b7e\uff0c\u90a3\u4e48\u6536\u8d39\u7ad9\u5c31\u5141\u8bb8\u4ed6\u4eec\u5728\u9ad8\u4f18\u5148\u7ea7\u8f66\u9053\u884c\u9a76\uff0c\u800c\u5bf9\u4e8e\u90a3\u4e9b\u6ca1\u6709\u8d2d\u4e70\u65e0\u7ebf\u7535\u6807\u7b7e\u7684\u53f8\u673a\u6765\u8bf4\uff0c\u867d\u7136\u4ed6\u4eec\u4ecd\u7136\u53ef\u4ee5\u5728\u8fd9\u6761\u6536\u8d39\u516c\u8def\u884c\u9a76\uff0c\u4f46\u662f\u4ed6\u4eec\u5fc5\u987b\u5728\u6bcf\u4e2a\u6536\u8d39\u7ad9\u90fd\u505c\u4e0b\u6765\uff0c\u4e14\u6bcf\u6b21\u901a\u8fc7\u90fd\u8981\u4ed8\u94b1\uff0c\u8fd9\u4f7f\u5f97\u8fd9\u4e9b\u53f8\u673a\u901a\u8fc7\u6536\u8d39\u7ad9\u9700\u8981\u66f4\u957f\u7684\u65f6\u95f4\u3002\u5982\u679c\u53ea\u6709\u4e00\u6761\u8def\u5f84\uff0c\u90a3\u4e48\u8981\u7ecf\u8fc7\u7684\u6bcf\u4e2a\u4eba\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u5c06\u53d7\u5230\u6700\u6162\u7684\u90a3\u4e2a\u53f8\u673a\u7684\u5f71\u54cd\u548c\u5ef6\u8bef\uff0c\u800c\u5982\u679c\u6709\u591a\u6761\u8def\u5f84\u7684\u8bdd\u5c31\u610f\u5473\u7740\u6709\u9ad8\u4f18\u5148\u7ea7\u7684\u53f8\u673a\u4e0d\u4f1a\u88ab\u5ef6\u8bef\uff08\u53ef\u4ee5\u4f7f\u7528\u9ad8\u4f18\u5148\u7ea7\u901a\u9053\uff09\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7221-vctcstcvc","title":"7.2.2.1   \u4e3a\u6bcf\u4e2aVC\u5206\u914dTCs\u2014\u2014TC/VC\u6620\u5c04","text":"<p>\u5206\u914d\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u7684TC\u503c\u5728\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u4f1a\u6539\u53d8\u7684\uff0c\u800c\u4e14\u5fc5\u987b\u5728\u6bcf\u4e2a\u670d\u52a1\u70b9\u90fd\u6709TC\u5bf9VC\u7684\u6620\u5c04\uff0c\u4e5f\u5c31\u662f\u67d0\u79cdTC\u7684\u6570\u636e\u5305\u8981\u4f7f\u7528\u54ea\u6761\u8def\u5f84\u4f20\u8f93\u5230\u76ee\u7684\u5730\u3002VC\u6620\u5c04\u662f\u94fe\u8def\u81ea\u5df1\u6307\u5b9a\u7684\uff0c\u4ece\u4e00\u4e2a\u94fe\u8def\u5230\u53e6\u4e00\u4e2a\u94fe\u8def\u540eVC\u6620\u5c04\u662f\u53ef\u4ee5\u6539\u53d8\u7684\u3002\u914d\u7f6e\u8f6f\u4ef6\u4f1a\u5728\u521d\u59cb\u5316\u65f6\u5efa\u7acb\u8fd9\u79cd\u6620\u5c04\u5173\u7cfb\uff0c\u5b83\u662f\u901a\u8fc7VC\u8d44\u6e90\u63a7\u5236\u5bc4\u5b58\u5668\uff08VC Resource Control Register\uff0c\u56fe 7\u20111\uff09\u4e2d\u7684TC/VC Map\u5b57\u6bb5\u6765\u5b9e\u73b0\u7684\u3002\u8fd9\u4e2a8bit\u7684\u5b57\u6bb5\u4f7f\u5f97\u591a\u4e2aTC\u503c\u53ef\u4ee5\u88ab\u6620\u5c04\u5230\u67d0\u4e00\u4e2aVC\uff0c\u56e0\u4e3a\u5b83\u7684\u6bcf\u4e2abit\u90fd\u4ee3\u8868\u4e86\u4e00\u4e2a\u5bf9\u5e94\u7684TC\u503c\uff08bit 0 = TC0\uff0cbit 1 = TC1\uff0cetc.\uff09\u3002\u5c06\u4e00\u4e2aVC\u76848bit TC/VC Map\u5b57\u6bb5\u4e2d\u7684\u67d0\u4e00\u4f4d\u7f6e\u4e3a1\uff0c\u5c31\u8868\u793a\u5c06\u76f8\u5e94\u7684TC\u5206\u914d\u7ed9\u4e86\u8fd9\u4e2aVC\u3002\u56fe 7\u20113\u5c55\u793a\u4e86\u4e00\u4e2aTC-VC\u7684\u6620\u5c04\u4f8b\u5b50\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2dTC0\u548cTC1\u88ab\u6620\u5c04\u5230\u4e86VC0\uff0c\u800cTC2\u3001TC3\u3001TC4\u5219\u662f\u6620\u5c04\u5230\u4e86VC3\u3002</p> <p>\u8f6f\u4ef6\u5728\u5206\u914dVC ID\u548c\u6620\u5c04TC\u7684\u65b9\u9762\u6709\u5f88\u5927\u7684\u7075\u6d3b\u6027\uff0c\u4f46\u662f\u5728\u8fdb\u884cTC/VC\u6620\u5c04\u65f6\u4e5f\u8981\u9075\u5faa\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>n \u5bf9\u4e8e\u76f8\u540c\u7684\u4e00\u6761\u94fe\u8def\u7684\u4e24\u7aef\u7684\u4e24\u4e2a\u7aef\u53e3\u6765\u8bf4\uff0c\u5b83\u4eec\u7684TC/VC\u6620\u5c04\u5fc5\u987b\u662f\u76f8\u540c\u7684\u3002</p> <p>n TC0\u81ea\u52a8\u6620\u5c04\u5230VC0\u3002</p> <p>n \u5176\u4ed6\u7684TC\uff08\u9664\u4e86TC0\uff09\u53ef\u4ee5\u6620\u5c04\u5230\u4efb\u4f55\u4e00\u4e2aVC\u3002</p> <p>n \u4e00\u4e2aTC\u53ea\u80fd\u6620\u5c04\u5230\u4e00\u4e2aVC\uff0c\u800c\u53ef\u4ee5\u6709\u591a\u4e2aTC\u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u3002</p> <p>\u6240\u4f7f\u7528\u7684\u865a\u62df\u901a\u9053\u7684\u6570\u91cf\u53d6\u51b3\u4e8e\u94fe\u8def\u4e24\u7aef\u8bbe\u5907\u6240\u80fd\u5171\u4eab\u7684\u6700\u5927\u865a\u62df\u901a\u9053\u8d44\u6e90\u5bb9\u91cf\u3002\u8f6f\u4ef6\u4f1a\u4e3a\u6bcf\u4e2aVC\u5206\u914dID\uff0c\u5e76\u4e14\u4f1a\u5c06TC\u6620\u5c04\u81f3VC\u3002</p> <p></p> <p>\u56fe 7\u20113 TC\u5230VC\u7684\u6620\u5c04\u4e3e\u4f8b</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7222-vc","title":"7.2.2.2   \u786e\u5b9a\u8981\u4f7f\u7528\u7684VC\u7684\u6570\u91cf","text":"<p>\u8f6f\u4ef6\u4f1a\u68c0\u67e5\u8fde\u63a5\u5728\u516c\u5171\u94fe\u8def\u4e0a\u7684\u8bbe\u5907\u6240\u80fd\u652f\u6301\u7684VC\u7684\u6570\u91cf\uff0c\u5e76\u4e14\u4e00\u822c\u4f1a\u9009\u62e9\u94fe\u8def\u4e24\u7aef\u8bbe\u5907\u6240\u80fd\u652f\u6301\u7684\u6700\u5927\u6570\u91cf\u4f5c\u4e3aVC\u7684\u5b9e\u9645\u4f7f\u7528\u6570\u91cf\u3002\u8003\u8651\u5982\u56fe 7\u20114\u6240\u793a\u7684\u62d3\u6251\u793a\u4f8b\uff0c\u5728\u8fd9\u91cc\uff0cSwitch\u4e0a\u7684\u6bcf\u4e2a\u7aef\u53e3\uff08port\uff09\u90fd\u652f\u6301\u5168\u90e8\u76848\u4e2aVC\uff0c\u800c\u8bbe\u5907A\u4ec5\u652f\u6301\u9ed8\u8ba4\u7684VC0\uff0c\u8bbe\u5907B\u652f\u63014\u4e2aVC\uff0c\u8bbe\u5907C\u652f\u63018\u4e2aVC\u3002\u9700\u8981\u6ce8\u610f\uff0c\u867d\u7136Switch\u7684\u7aef\u53e3A\u80fd\u591f\u652f\u63018\u4e2aVC\uff0c\u4f46\u662f\u7531\u4e8e\u8bbe\u5907A\u4ec5\u80fd\u652f\u6301VC0\uff0c\u56e0\u6b64\u7aef\u53e3A\u7684\u5176\u4f597\u4e2aVC\u662f\u65e0\u6cd5\u88ab\u4f7f\u7528\u7684\u3002\u76f8\u4f3c\u5730\uff0cSwitch\u7684\u7aef\u53e3B\u5b9e\u9645\u4e5f\u4ec5\u80fd\u4f7f\u75284\u4e2aVC\u3002</p> <p></p> <p>\u56fe 7\u20114\u4e00\u4e2a\u8bbe\u5907\u652f\u6301\u591a\u4e2a\u865a\u62df\u901a\u9053</p> <p>\u914d\u7f6e\u8f6f\u4ef6\u8981\u786e\u5b9a\u6bcf\u4e2a\u7aef\u53e3\u6240\u80fd\u652f\u6301\u7684\u6700\u5927VC\u6570\u91cf\uff0c\u5b83\u662f\u901a\u8fc7\u8bfb\u53d6\u865a\u62df\u901a\u9053\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\uff08Virtual Channel Capability register\uff0c\u56fe 7\u20111\uff09\u4e2d\u7684Extended VC Count\u5b57\u6bb5\u6765\u5b8c\u6210\u7684\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5982\u56fe 7\u20115\u6240\u793a\u3002</p> <p></p> <p>\u56fe 7\u20115\u6269\u5c55VC\u652f\u6301\u5b57\u6bb5</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7223-vc-id","title":"7.2.2.3   \u5206\u914dVC ID","text":"<p>\u914d\u7f6e\u8f6f\u4ef6\u9700\u8981\u7ed9\u6bcf\u4e2aVC\u90fd\u5206\u914d\u4e00\u4e2aID\u53f7\uff0c\u9664\u4e86VC0\uff08\u56e0\u4e3a\u5b83\u662f\u56fa\u5b9a\u5b58\u5728\u7684\uff09\u3002\u5982\u56fe 7\u20113\u6240\u793a\uff0cVC\u80fd\u529b\u5bc4\u5b58\u5668\u7a7a\u95f4\u4e2d\uff0c\u6bcf\u4e2aVC\u90fd\u6709\u81ea\u5df112Byte\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7ec4\u3002\u7b2c\u4e00\u7ec4\u5bc4\u5b58\u5668\u603b\u662f\u7531VC0\u4f7f\u7528\u3002\u6269\u5c55VC\u8ba1\u6570\uff08Extended VC Count\uff09\u5b57\u6bb5\u5b9a\u4e49\u4e86\u5f53\u524d\u7aef\u53e3\u5b9e\u73b0\u7684\u989d\u5916VC\u7684\u6570\u91cf\uff08\u9664VC0\u4e4b\u5916\uff09\uff0c\u6bcf\u4e2a\u5b9e\u73b0\u7684VC\u90fd\u6709\u4e00\u7ec4\u914d\u7f6e\u5bc4\u5b58\u5668\u3002\u6ce8\u610f\uff0c\u5b57\u6bb5\u7684\u503c\u201cn\u201d\u8868\u793a\u7684\u662f\u989d\u5916\u5b9e\u73b0\u7684VC\u7684\u6570\u91cf\uff0c\u4f8b\u5982\u6269\u5c55VC\u8ba1\u6570\u5b57\u6bb5\u4e3a3\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u9664\u4e86VC0\u4ee5\u5916\u8fd8\u67093\u4e2aVC\uff0c\u4ee5\u53ca\u5b83\u4eec\u6bcf\u4e2a\u90fd\u6709\u4e00\u7ec4\u81ea\u5df1\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u3002</p> <p>\u8f6f\u4ef6\u901a\u8fc7\u4f7f\u7528VC ID\u5b57\u6bb5\u4e3a\u6bcf\u4e2a\u989d\u5916\u7684VC\u5206\u914d\u4e00\u4e2a\u7f16\u53f7\uff08\u89c1\u56fe 7\u20113\uff09\u3002\u8fd9\u4e9bID\u53f7\u5e76\u4e0d\u4e00\u5b9a\u8981\u662f\u8fde\u7eed\u7684\uff0c\u4f46\u662f\u5fc5\u987b\u53ea\u80fd\u51fa\u73b0\u4e00\u6b21\u800c\u4e0d\u80fd\u91cd\u590d\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#73-vcvc-arbitration","title":"7.3 VC\u4ef2\u88c1\uff08VC Arbitration\uff09","text":""},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#731-general","title":"7.3.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5f53\u4e00\u4e2a\u8bbe\u5907\u6709\u591a\u4e2aVC\uff0c\u4e14\u6bcf\u4e2aVC\u90fd\u6709\u5f85\u53d1\u9001\u7684\u6570\u636e\u5305\uff0c\u90a3\u4e48\u5c31\u9700\u8981VC\u4ef2\u88c1\u673a\u5236\u6765\u51b3\u5b9a\u6570\u636e\u5305\u4f20\u8f93\u7684\u987a\u5e8f\u3002\u8f6f\u4ef6\u53ef\u4ee5\u4ece\u786c\u4ef6\u6240\u5b9e\u73b0\u7684\u51e0\u79cd\u9009\u62e9\u65b9\u6848\u4e2d\u9009\u62e9\u4efb\u610f\u7684\u4e00\u79cd\u3002\u8bbe\u8ba1\u7684\u76ee\u6807\u662f\u8981\u5b9e\u73b0\u6240\u9700\u7684\u670d\u52a1\u7b56\u7565\uff0c\u5e76\u4e14\u786e\u4fdd\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u5728\u5411\u524d\u63a8\u8fdb\uff0c\u4ee5\u9632\u6b62\u53d1\u751f\u610f\u5916\u8d85\u65f6\u3002\u53e6\u5916\uff0cVC\u4ef2\u88c1\u4e5f\u4f1a\u53d7\u5230\u6d41\u91cf\u63a7\u5236\uff08flow control\uff09\u548c\u4e8b\u52a1\u6392\u5e8f\uff08Transaction Ordering\uff09\u7684\u76f8\u5173\u9700\u6c42\u7684\u5f71\u54cd\u3002\u8fd9\u4e9b\u4e3b\u9898\u5185\u5bb9\u5c06\u5728\u5176\u4ed6\u7ae0\u8282\u4e2d\u8ba8\u8bba\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u5b83\u4eec\u4e5f\u4f1a\u5f71\u54cd\u4ef2\u88c1\uff0c\u56e0\u4e3a\uff1a</p> <p>n \u6bcf\u4e2a\u53d7\u652f\u6301\u7684VC\u90fd\u6709\u5b83\u81ea\u5df1\u7684Buffer\u548c\u6d41\u63a7\u5904\u7406</p> <p>n \u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u7684\u591a\u4e2a\u4e8b\u52a1\u4e00\u822c\u4f1a\u6309\u7167\u4e25\u683c\u7684\u987a\u5e8f\u8fdb\u884c\u4f20\u8f93\uff08\u5c3d\u7ba1\u4e5f\u6709\u4f8b\u5916\uff0c\u6bd4\u5982\u4e00\u4e2a\u6570\u636e\u5305\u7684\u201c\u5bbd\u677e\u6392\u5e8fRelaxed Ordering\u201d\u8fd9\u4e00\u5c5e\u6027\u6807\u5fd7\u4f4d\u88ab\u7f6e\u4e3a1\u65f6\u3002\uff09</p> <p>n \u4e8b\u52a1\u6392\u5e8f\uff08Transaction Ordering\uff09\u4ec5\u5e94\u7528\u5728\u4e00\u4e2aVC\u5185\uff0c\u56e0\u6b64\u5bf9\u4e8e\u5206\u914d\u7ed9\u4e0d\u540c\u7684VC\u7684\u51e0\u4e2a\u6570\u636e\u5305\u4e4b\u95f4\u662f\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u7684\u3002</p> <p>\u56fe 7\u20116\u4e2d\u7684\u4f8b\u5b50\u4e2d\u542b\u6709\u4e24\u4e2aVC\uff08VC0\u548cVC1\uff09\uff0cVC1\uff1aVC0\u7684\u4f20\u8f93\u4f18\u5148\u7ea7\u662f3:1\u7684\u6bd4\u7387\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4f20\u8f933\u4e2aVC1\u6570\u636e\u5305\u624d\u4f1a\u53d1\u90011\u4e2aVC0\u6570\u636e\u5305\u3002Device Core\u5411TC/VC\u6620\u5c04\u903b\u8f91\u53d1\u9001\u8bf7\u6c42\uff08\u8bf7\u6c42\u5305\u4e2d\u5305\u542bTC\u503c\uff09\u3002\u57fa\u4e8e\u5df2\u7ecf\u89c4\u5212\u597d\u7684\u6620\u5c04\uff0c\u6570\u636e\u5305\u88ab\u653e\u5165\u76f8\u5e94\u7684VC Buffer\u4e2d\u7b49\u5f85\u4f20\u8f93\u3002\u6700\u7ec8\uff0cVC\u4ef2\u88c1\u5668\u51b3\u5b9a\u8fd9\u4e2a\u7531VC\u4f18\u5148\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u4e2a\u4f8b\u5b50\u5c55\u793a\u4e86\u4e00\u4e2a\u5355\u5411\u7684\u6d41\u7a0b\uff0c\u4f46\u662f\u540c\u6837\u7684\u903b\u8f91\u4e5f\u9002\u7528\u4e8e\u540c\u65f6\u8fdb\u884c\u76f8\u53cd\u65b9\u5411\u7684\u4f20\u8f93\u3002</p> <p>VC\u80fd\u529b\u5bc4\u5b58\u5668\u63d0\u4f9b\u4e86\u4e09\u79cd\u57fa\u672c\u7684VC\u4ef2\u88c1\u65b9\u5f0f\uff1a</p> <p>\\1.    \u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff08Strict Priority Arbitration**\uff09**\uff1a\u5728\u6240\u6709\u542b\u6709\u6570\u636e\u5305\u7684VC\u4e2d\uff0c\u62e5\u6709\u6700\u5927\u7f16\u53f7\u7684VC\u6c38\u8fdc\u8d62\u5f97\u4ef2\u88c1\u3002</p> <p>\\2.    \u5206\u7ec4\u4ef2\u88c1\uff08Group Arbitration**\uff09**:VC\u4eec\u88ab\u786c\u4ef6\u5206\u62101\u4e2a\u4f4e\u4f18\u5148\u7ea7\u7ec4\u548c1\u4e2a\u9ad8\u4f18\u5148\u7ea7\u7ec4\u3002\u4f4e\u4f18\u5148\u7ea7\u7ec4\u4f7f\u7528\u7684\u4ef2\u88c1\u65b9\u6cd5\u662f\u7531\u8f6f\u4ef6\u4ece\u53ef\u9009\u65b9\u6cd5\u4e2d\u6765\u9009\u53d6\u7684\uff0c\u800c\u9ad8\u4f18\u5148\u7ea7\u7ec4\u5219\u662f\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff08Strict Priority Arbitration\uff09\u3002</p> <p>\\3.    \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\uff08Hardware Fixed arbitration**\uff09**\uff1a\u4ef2\u88c1\u65b9\u6848\u6784\u5efa\u5728\u786c\u4ef6\u4e2d\u3002</p> <p></p> <p>\u56fe 7\u20116 VC\u4ef2\u88c1\u793a\u4f8b</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#732-vcstrict-priority-vc-arbitration","title":"7.3.2     \u4e25\u683c\u4f18\u5148\u7ea7VC\u4ef2\u88c1\uff08Strict Priority VC Arbitration\uff09","text":"<p>\u9ed8\u8ba4\u7684\u4f18\u5148\u7ea7\u65b9\u6848\u662f\u57fa\u4e8eVC ID\u7684\u56fa\u6709\u4f18\u5148\u7ea7\uff08VC0=\u6700\u4f4e\u4f18\u5148\u7ea7\uff0cVC7=\u6700\u9ad8\u4f18\u5148\u7ea7\uff09\u3002\u8fd9\u79cd\u673a\u5236\u662f\u81ea\u52a8\u7684\uff0c\u5e76\u4e0d\u9700\u8981\u4efb\u4f55\u989d\u5916\u914d\u7f6e\u3002\u56fe 7\u20117\u5c55\u793a\u4e86\u4e00\u4e2a\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\u7684\u4f8b\u5b50\uff0c\u5b83\u5305\u542b\u4e86\u6240\u6709\u76848\u4e2aVC\uff0c\u8fd9\u5176\u4e2d\u4f7f\u7528VC ID\u53f7\u6765\u7ba1\u7406\u4e8b\u52a1\u7684\u53d1\u9001\u987a\u5e8f\u3002\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\u7684VC\u7684\u6700\u5927\u7f16\u53f7\u4e0d\u80fd\u5927\u4e8e\u6269\u5c55VC\u8ba1\u6570\uff08Extended VC Count\uff09\u5b57\u6bb5\uff08\u5982\u56fe 7\u20115\uff09\u3002\u6b64\u5916\uff0c\u5982\u679c\u8bbe\u8ba1\u8005\u9009\u62e9\u8ba9\u6240\u6709\u7684VC\u90fd\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff0c\u90a3\u4e48\u56fe 7\u20118\u4e2d\u7684Port VC Capability Register 1\uff08\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56681\uff09\u7684Low Priority Extended VC Count\u5b57\u6bb5\u9700\u8981\u56fa\u5b9a\u4e3a0\u3002</p> <p></p> <p>\u56fe 7\u20117\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1</p> <p>\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\u8981\u6c42\u9ad8\u7f16\u53f7\u7684VC\u6c38\u8fdc\u8981\u4f18\u5148\u4e8e\u4f4e\u7f16\u53f7\u7684VC\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u6240\u6709\u76848\u4e2aVC\u90fd\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\u6765\u7ba1\u7406\uff0c\u90a3\u4e48VC0\u5c31\u53ea\u80fd\u5728\u5176\u4ed6\u6240\u6709VC\u90fd\u4e0d\u9700\u8981\u53d1\u9001\u6570\u636e\u5305\u65f6\u624d\u80fd\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u6837\u7684\u65b9\u5f0f\u53ef\u4ee5\u4f7f\u5f97\u6700\u9ad8\u4f18\u5148\u7ea7\u7684\u6570\u636e\u5305\u5f97\u5230\u5f88\u9ad8\u7684\u5e26\u5bbd\u4ee5\u53ca\u6700\u4f4e\u7684\u5ef6\u65f6\u3002\u4f46\u662f\uff0c\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\u53ef\u80fd\u4f1a\u4f7f\u5f97\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u9053\u5206\u914d\u4e0d\u5230\u5e26\u5bbd\uff08\u4e00\u76f4\u6709\u9ad8\u4f18\u5148\u7ea7\u901a\u9053\u5360\u7528\u6240\u6709\u53ef\u7528\u5e26\u5bbd\uff09\uff0c\u6240\u4ee5\u5fc5\u987b\u8981\u5c0f\u5fc3\u5730\u786e\u4fdd\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u8981\u6c42\u8981\u5bf9\u9ad8\u4f18\u5148\u7ea7\u6d41\u91cf\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u514d\u51fa\u73b0\u4f4e\u4f18\u5148\u7ea7\u901a\u9053\u7684\u5e26\u5bbd\u9965\u997f\uff0c\u5e76\u7ed9\u51fa\u4e86\u4e24\u79cd\u5bf9\u9ad8\u4f18\u5148\u7ea7\u6d41\u91cf\u8fdb\u884c\u7ba1\u7406\u7684\u65b9\u6cd5\uff1a</p> <p>n \u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\u53ef\u4ee5\u9650\u5236\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u7684\u6ce8\u5165\u901f\u7387\uff0c\u4ece\u800c\u5c31\u53ef\u4ee5\u4e3a\u4f4e\u4f18\u5148\u7ea7\u4e8b\u52a1\u63d0\u4f9b\u66f4\u591a\u5e26\u5bbd\u3002</p> <p>n Switch\u53ef\u4ee5\u5728\u51fa\u53e3\u7aef\u53e3\uff08egress port\uff09\u8c03\u8282\u591a\u4e2a\u6d41\u91cf\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u4f1a\u9650\u5236\u67d0\u4e9b\u5e94\u7528\u548c\u8bbe\u5907\u7684\u541e\u5410\u91cf\uff0c\u901a\u5e38\u8fd9\u4e9b\u5e94\u7528\u8bbe\u5907\u662f\u4e00\u4e9b\u8bd5\u56fe\u8d85\u8fc7\u53ef\u7528\u5e26\u5bbd\u9650\u5236\u7684\u9ad8\u5e26\u5bbd\u5e94\u7528\u548c\u8bbe\u5907\u3002</p> <p>\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u53ef\u80fd\u4e5f\u9700\u8981\u9650\u5236\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u7684VC\u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06VC\u4eec\u5206\u4e3a1\u4e2a\u4f4e\u4f18\u5148\u7ea7\u7ec4\u54081\u4e2a\u9ad8\u4f18\u5148\u7ea7\u7ec4\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff0c\u5728\u4e0b\u4e00\u5c0f\u8282\u6211\u4eec\u5c06\u4f1a\u8ba8\u8bba\u8fd9\u79cd\u5206\u7ec4\u65b9\u6cd5\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#733-group-arbitration","title":"7.3.3     \u5206\u7ec4\u4ef2\u88c1\uff08Group Arbitration\uff09","text":"<p>\u56fe 7\u20118\u5c55\u793a\u4e86Port VC Capability Register 1\uff08\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56681 \uff09\u7684Low Priority Extended VC Count\u5b57\u6bb5\u3002\u8fd9\u4e2a\u53ea\u8bfb\uff08read-only\uff09\u5b57\u6bb5\u6307\u5b9a\u4e86\u8be5\u8bbe\u5907\u4f4e\u4f18\u5148\u7ea7\u4ef2\u88c1\u7ec4\u7684VC ID\u4e0a\u9650\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u662f4\uff0c\u90a3\u4e48\u5c31\u8bf4\u660eVC0-VC4\u90fd\u5c5e\u4e8e\u4f4e\u4f18\u5148\u7ea7\u7ec4\uff0c\u800c\u5269\u4e0b\u7684VC5-VC7\u5219\u662f\u9ad8\u4f18\u5148\u7ea7\u7ec4\u3002\u6ce8\u610f\uff0c\u82e5Low Priority Extended VC Count\u7684\u503c\u4e3a7\uff0c\u5219\u8bf4\u660e\u6ca1\u6709VC\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u3002</p> <p></p> <p>\u56fe 7\u20118\u4f4e\u4f18\u5148\u7ea7\u6269\u5c55VC\u8ba1\u6570</p> <p>\u5982\u56fe 7\u201110\u6240\u5c55\u793a\u7684\u90a3\u6837\uff0c\u9ad8\u4f18\u5148\u7ea7\u7ec4\u7684VC\u4f1a\u7ee7\u7eed\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff0c\u4f46\u662f\u4f4e\u4f18\u5148\u7ea7\u4ef2\u88c1\u7ec4\u5219\u4f1a\u4f7f\u7528\u8bbe\u5907\u652f\u6301\u7684\u5176\u4ed6\u7684\u4e00\u79cd\u4ef2\u88c1\u65b9\u6cd5\u3002\u5982\u56fe 7\u20119\u6240\u793a\uff0cPort VC Capability Register 2\uff08\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56682\uff09\u7528\u6765\u8868\u793a\u8bbe\u5907\u53ef\u4ee5\u652f\u6301\u4f4e\u4f18\u5148\u7ea7\u7ec4\u4f7f\u7528\u54ea\u4e9b\u66ff\u4ee3\u4ef2\u88c1\u65b9\u6cd5\uff0c\u800cVC Control Register\uff08VC\u63a7\u5236\u5bc4\u5b58\u5668\uff09\u4f1a\u5141\u8bb8\u5177\u4f53\u9009\u62e9\u4e86\u54ea\u79cd\u4ef2\u88c1\u65b9\u6cd5\u3002\u4f4e\u4f18\u5148\u7ea7\u4ef2\u88c1\u65b9\u6848\u5305\u62ec\uff1a</p> <p>n \u57fa\u4e8e\u786c\u4ef6\u7684\u56fa\u5b9a\u4ef2\u88c1\uff08Hardware Based Fixed Arbitration\uff09</p> <p>n \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1WRR\uff08Weighted Round Robin Arbitration\uff09</p> <p></p> <p>\u56fe 7\u20119 VC\u4ef2\u88c1\u80fd\u529b\u5b57\u6bb5</p> <p></p> <p>\u56fe 7\u201110 VC\u4ef2\u88c1\u4f18\u5148\u7ea7\uff08\u5206\u7ec4\u4ef2\u88c1\uff09</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7331-hardware-fixed-arbitration-scheme","title":"7.3.3.1   \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\u65b9\u6848\uff08Hardware Fixed Arbitration Scheme\uff09","text":"<p>\u8fd9\u4e2a\u65b9\u6848\u5b9a\u4e49\u4e86\u4e00\u79cd\u57fa\u4e8e\u7eaf\u786c\u4ef6\u7684\u4ef2\u88c1\u65b9\u6cd5\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u989d\u5916\u7684\u8f6f\u4ef6\u8bbe\u7f6e\u3002\u8fd9\u79cd\u7eaf\u786c\u4ef6\u7684\u4ef2\u88c1\u65b9\u6cd5\u53ef\u4ee5\u662f\u786c\u4ef6\u8bbe\u8ba1\u8005\u5b9e\u73b0\u7684\u4efb\u4f55\u4e00\u79cd\u65b9\u6cd5\uff0c\u800c\u4e14\u8fd9\u79cd\u65b9\u6cd5\u8fd8\u53ef\u4ee5\u57fa\u4e8e\u9884\u671f\u7684\u8bbe\u5907\u8d1f\u8f7d\u6216\u5e26\u5bbd\u6765\u8fdb\u884c\u8bbe\u8ba1\u3002\u4e3e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u4e00\u4e2a\u666e\u901a\u7684\u8f6e\u8be2\u8c03\u5ea6\u4e2d\uff0c\u6bcf\u4e2aVC\u90fd\u4f1a\u5f97\u5230\u76f8\u540c\u7684\u6b21\u6570\u6765\u5faa\u73af\u8f6e\u6d41\u53d1\u9001\u6570\u636e\u5305\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7332-weighted-round-robin-arbitration-scheme","title":"7.3.3.2   \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\u65b9\u6848\uff08Weighted Round Robin Arbitration Scheme\uff09","text":"<p>\u5728\u8fd9\u79cd\u65b9\u6cd5\u4e2d\uff0c\u67d0\u4e9bVC\u53ef\u4ee5\u88ab\u7ed9\u4e88\u6bd4\u5176\u4ed6VC\u66f4\u5927\u7684\u6743\u91cd\uff08\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\uff09\uff0c\u8fd9\u4e9b\u9ad8\u6743\u91cdVC\u4f1a\u6bd4\u5176\u4ed6VC\u5f97\u5230\u66f4\u591a\u7684entries\uff08\u6761\u76ee\uff09\uff0c\u4e5f\u5c31\u662f\u66f4\u591a\u7684\u53d1\u9001\u6570\u636e\u5305\u7684\u673a\u4f1a\u3002\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u4e09\u79cdWRR\u9009\u9879\uff0c\u6bcf\u79cd\u9009\u9879\u90fd\u5177\u6709\u4e0d\u540c\u6570\u91cf\u7684entries\uff08\u79f0\u4e3aphase\u201c\u9636\u6bb5\u201d\uff09\u3002\u8868\u9879\u7684\u5927\u5c0f\u901a\u8fc7\u5f80Port VC Control Register\uff08\u7aef\u53e3VC\u63a7\u5236\u5bc4\u5b58\u5668\uff0c\u56fe 7\u20119\uff09\u4e2d\u7684VC Arbitration Select\uff08VC\u4ef2\u88c1\u9009\u62e9\uff09\u5b57\u6bb5\u5199\u5165\u76f8\u5e94\u7684\u503c\u6765\u8fdb\u884c\u9009\u62e9\u3002\u8868\u9879\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u90fd\u4ee3\u8868\u4e00\u4e2a\u8f6f\u4ef6\u4f7f\u7528\u4f4e\u4f18\u5148\u7ea7VC\u7684\u9636\u6bb5\u3002VC\u4ef2\u88c1\u5668\u4f1a\u4ee5\u8fde\u7eed\u7684\u65b9\u5f0f\u53cd\u590d\u7684\u626b\u63cf\u8868\u9879\u7684\u6240\u6709\u6761\u76ee\uff0c\u7136\u540e\u4f1a\u901a\u8fc7\u8868\u9879\u6761\u76ee\u5185\u6307\u5b9a\u7684VC\u6765\u53d1\u9001\u6570\u636e\u5305\u3002\u4e00\u65e6\u4e00\u4e2a\u6570\u636e\u5305\u88ab\u53d1\u51fa\uff0c\u90a3\u4e48\u4ef2\u88c1\u5668\u5c31\u4f1a\u9a6c\u4e0a\u53bb\u626b\u63cf\u4e0b\u4e00\u4e2a\u6761\u76ee\uff08entry\uff09\uff0c\u4e5f\u5c31\u662f\u8fdb\u5165\u4e0b\u4e00\u4e2a\u9636\u6bb5\uff08phase\uff09\u3002\u56fe 7\u201111\u5c55\u793a\u4e86\u4e00\u4e2a\u62e5\u670964\u4e2a\u6761\u76ee\u7684WRR\u4ef2\u88c1\u8868\u3002</p> <p></p> <p>\u56fe 7\u201111 WRR VC\u4ef2\u88c1\u8868</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7333","title":"7.3.3.3   \u5efa\u7acb\u865a\u62df\u901a\u9053\u4ef2\u88c1\u8868","text":"<p>VC Arbitration Table\uff08VAT\uff0cVC\u4ef2\u88c1\u8868\uff09\u4f4d\u4e8e\u914d\u7f6e\u7a7a\u95f4\u4e2d\uff0c\u5b83\u7684\u5177\u4f53\u7684\u4f4d\u7f6e\u7684\u8868\u793a\u65b9\u6cd5\u662f\u4e00\u4e2a\u504f\u79fb\u91cf\uff0c\u5176\u57fa\u5740\u4e3aVC\u80fd\u529b\u7ed3\u6784\uff08VC Capability Structure\uff09\u7684\u5730\u5740\uff0c\u5982\u56fe 7\u201112\u6240\u793a\u3002 </p> <p>\u5982\u56fe 7\u201113\u6240\u793a\uff0cVAT\uff08VC Arbitration Table\uff09\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u90fd\u662f\u4e00\u4e2a4bit\u5b57\u6bb5\uff0c\u5b83\u7528\u6765\u6307\u793a\u8fd9\u4e2a\u9636\u6bb5\u4e2d\u9700\u8981\u53d1\u9001\u6570\u636e\u7684VC\u7684ID\u53f7\u3002\u6574\u4e2aVAT\u8868\u7684\u957f\u5ea6\uff08\u6709\u591a\u5c11\u6761\u76ee\uff09\u662f\u901a\u8fc7\u56fe 7\u20119\u4e2d\u7684\u4ef2\u88c1\u9009\u9879\u6765\u8fdb\u884c\u9009\u62e9\u7684\u3002</p> <p></p> <p>\u56fe 7\u201112 VC\u4ef2\u88c1\u8868\u504f\u79fb\u5b57\u6bb5\u4ee5\u53ca\u52a0\u8f7dVC\u4ef2\u88c1\u8868\u5b57\u6bb5</p> <p>\u8fd9\u4e2a\u8868\u7531\u914d\u7f6e\u8f6f\u4ef6\u52a0\u8f7d\uff0c\u4ee5\u5b9e\u73b0\u865a\u62df\u901a\u9053\u6240\u9700\u8981\u7684\u4f18\u5148\u7ea7\u987a\u5e8f\u3002\u5f53\u8868\u53d1\u751f\u4e86\u4efb\u4f55\u53d8\u5316\u65f6\uff0c\u786c\u4ef6\u4f1a\u8bbe\u7f6eVC Arbitration Table Statue bit\uff08VC\u4ef2\u88c1\u8868\u72b6\u6001\u4f4d\uff09\uff0c\u8fd9\u4e3a\u8f6f\u4ef6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9014\u5f84\u6765\u9a8c\u8bc1\u8868\u9879\u867d\u7136\u53d1\u751f\u7684\u6539\u53d8\u4f46\u662f\u8fd8\u6ca1\u6709\u771f\u6b63\u4f5c\u7528\u5728\u786c\u4ef6\u4e0a\u3002\u4e00\u65e6\u8868\u88ab\u52a0\u8f7d\u5b8c\u6210\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u8bbe\u7f6e\u7aef\u53e3VC\u63a7\u5236\u5bc4\u5b58\u5668\uff08\u56fe 7\u20119\uff09\u4e2d\u7684Load VC Arbitration Table bit\uff08\u52a0\u8f7dVC\u4ef2\u88c1\u8868\u4f4d\uff09\u3002\u8fd9\u4f1a\u4f7f\u5f97\u786c\u4ef6\u5bf9\u65b0\u7684\u8868\u9879\u8fdb\u884c\u52a0\u8f7d\uff0c\u5c06\u65b0\u7684\u503c\u5e94\u7528\u5728VC\u4ef2\u88c1\u5668\u4e2d\u3002\u5f53\u8868\u9879\u88ab\u52a0\u8f7d\u5b8c\u6210\u5e76\u5e94\u7528\u540e\uff0c\u786c\u4ef6\u5c31\u4f1a\u6e05\u9664VC Arbitration Table Statue bit\uff08VC\u4ef2\u88c1\u8868\u72b6\u6001\u4f4d\uff09\uff0c\u8fd9\u4e5f\u5c31\u901a\u77e5\u4e86\u8f6f\u4ef6\u5173\u4e8e\u8868\u9879\u52a0\u8f7d\u7684\u64cd\u4f5c\u5df2\u7ecf\u5b8c\u6210\u3002\u8fd9\u79cd\u8868\u9879\u52a0\u8f7d\u7684\u65b9\u5f0f\u7684\u52a8\u673a\u53ef\u80fd\u662f\u4e3a\u4e86\u5728\u7cfb\u7edf\u8fd0\u884c\u4e2d\u4e5f\u80fd\u66f4\u6539\u8868\u5185\u5bb9\u800c\u4e0d\u4e2d\u65ad\u7cfb\u7edf\u7684\u8fd0\u884c\u3002\u4f46\u662f\u95ee\u9898\u662f\u914d\u7f6e\u5199\u64cd\u4f5c\u4e00\u6b21\u4ec5\u80fd\u66f4\u65b01DW\u7684\u8868\u5185\u5bb9\uff0c\u5b83\u662f\u4e00\u79cd\u76f8\u5bf9\u6162\u901f\u7684\u4e8b\u52a1\uff0c\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u9700\u8981\u4e00\u6bb5\u6bd4\u8f83\u957f\u7684\u65f6\u95f4\u624d\u80fd\u5b8c\u6210\u6574\u4e2a\u8868\u5185\u5bb9\u7684\u66f4\u65b0\uff0c\u800c\u5728\u8fd9\u6bb5\u65f6\u95f4\u91cc\u8fd9\u4e2a\u8868\u4ec5\u4ec5\u8fdb\u884c\u4e86\u90e8\u5206\u66f4\u65b0\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u8fd9\u6709\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8bbe\u5907\u5728\u8fd9\u6bb5\u65f6\u95f4\u91cc\u7ee7\u7eed\u8fd0\u884c\u65f6\u51fa\u73b0\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u8fd9\u79cd\u673a\u5236\u5141\u8bb8\u8f6f\u4ef6\u5b8c\u6210\u5bf9\u6574\u4e2a\u8868\u7684\u66f4\u6539\u4e4b\u540e\uff0c\u5728\u7edf\u4e00\u7684\u4e00\u6b21\u5c06\u5b83\u4eec\u5168\u90e8\u5e94\u7528\u5728\u786c\u4ef6\u4ef2\u88c1\u5668\u4e2d\u3002</p> <p></p> <p>\u56fe 7\u201113\u52a0\u8f7dVC\u4ef2\u88c1\u8868\u6761\u76ee</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#74-port-arbitration","title":"7.4 \u7aef\u53e3\u4ef2\u88c1\uff08Port Arbitration\uff09","text":""},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#741-general","title":"7.4.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>Switch\u7aef\u53e3\u548cRoot\u7aef\u53e3\u7ecf\u5e38\u63a5\u6536\u5230\u4e00\u4e9b\u9700\u8981\u8f6c\u53d1\u81f3\u5176\u4ed6\u7aef\u53e3\u7684\u6570\u636e\u5305\u3002\u8fd9\u4e9b\u6570\u636e\u5305\u867d\u7136\u7531\u591a\u4e2a\u7aef\u53e3\u8fdb\u884c\u63a5\u6536\uff0c\u4f46\u662f\u5b83\u4eec\u53ef\u80fd\u4f1a\u90fd\u9700\u8981\u8f6c\u53d1\u81f3\u540c\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\u7684\u540c\u4e00\u4e2aVC\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u4ef2\u88c1\u673a\u5236\u6765\u51b3\u5b9a\u8fd9\u4e9b\u4e0d\u540c\u7aef\u53e3\u8f93\u5165\u7684\u6570\u636e\u5305\u5982\u4f55\u4f9d\u6b21\u7684\u653e\u5165\u540c\u4e00\u4e2a\u76ee\u6807VC\u3002\u7c7b\u4f3c\u4e8eVC\u4ef2\u88c1\uff0c\u7aef\u53e3\u4ef2\u88c1\u4e5f\u6709\u591a\u79cd\u53ef\u9009\u65b9\u6848\u4f9b\u914d\u7f6e\u8f6f\u4ef6\u9009\u62e9\u3002TC\u3001VC\u548c\u4ef2\u88c1\u65b9\u6cd5\u7684\u591a\u79cd\u7ec4\u5408\u53ef\u4ee5\u652f\u6301\u4e00\u7cfb\u5217\u7684\u670d\u52a1\u7ea7\u522b\uff0c\u8fd9\u4e9b\u670d\u52a1\u7ea7\u522b\u5206\u4e3a\u4e24\u4e2a\u5927\u7c7b\uff1a</p> <p>\\1.    \u5f02\u6b65\u7c7b\u578b\uff08Asynchronous**\uff09**\uff1a\u6570\u636e\u5305\u4f1a\u5f97\u5230\u201c\u5c3d\u529b\u800c\u4e3aBest Effort\u201d\u7684\u670d\u52a1\uff0c\u5e76\u4e14\u53ef\u80fd\u672c\u8eab\u4e5f\u6ca1\u6709\u6536\u5230\u4efb\u4f55\u7684\u504f\u597d\u9700\u8981\u8003\u8651\u3002\u8bb8\u591a\u8bbe\u5907\u548c\u5e94\u7528\uff0c\u4f8b\u5982\u5927\u5bb9\u91cf\u5b58\u50a8\u8bbe\u5907\uff0c\u5bf9\u5e26\u5bbd\u6216\u8005\u5ef6\u65f6\u5e76\u6ca1\u6709\u5f88\u4e25\u683c\u7684\u8981\u6c42\uff0c\u5e76\u4e0d\u9700\u8981\u7279\u6b8a\u7684\u5b9a\u65f6\u673a\u5236\u3002\u4ece\u53e6\u4e00\u65b9\u9762\u8bf4\uff0c\u901a\u8fc7\u4e3a\u4e0d\u540c\u7684\u6570\u636e\u5305\u5efa\u7acb\u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff09\u8fd9\u79cd\u5c42\u6b21\u7ed3\u6784\uff0c\u90a3\u4e9b\u9700\u6c42\u66f4\u591a\u7684\u5e94\u7528\u6240\u4ea7\u751f\u7684\u6570\u636e\u5305\u53ef\u4ee5\u4ecd\u7136\u5212\u5206\u4f18\u5148\u7ea7\u5e76\u4e14\u4fdd\u6301\u5176\u4f18\u5148\u7ea7\u5730\u4f4d\u3002\u5728\u670d\u52a1\u7684\u7ea7\u522b\u9700\u8981\u4fdd\u8bc1\u4e4b\u524d\uff0c\u5373\u4f7f\u662f\u5dee\u5f02\u5316\u670d\u52a1\u4e5f\u4f1a\u88ab\u8ba4\u4e3a\u662f\u5f02\u6b65\u7684\u3002\u5f53\u7136\uff0c\u5f02\u6b65\u670d\u52a1\u5c06\u603b\u662f\u53ef\u7528\u7684\uff0c\u800c\u4e0d\u9700\u8981\u4efb\u4f55\u7279\u522b\u7684\u8f6f\u4ef6\u6216\u8005\u786c\u4ef6\u9009\u9879\u3002</p> <p>\\2.    \u540c\u6b65\u7b49\u65f6\u7c7b\u578b\uff08Isochronous**\uff09**\uff1a\u5f53\u670d\u52a1\u9700\u8981\u4fdd\u8bc1\u5ef6\u65f6\u548c\u5e26\u5bbd\u65f6\uff0c\u6211\u4eec\u5c06\u5b83\u79fb\u52a8\u5230\u540c\u6b65\u7b49\u65f6\u7c7b\u578b\uff08Isochronous\uff09\u8fd9\u4e00\u5927\u7c7b\u4e2d\u3002\u5f53\u4e24\u4e2a\u8bbe\u5907\u4e4b\u95f4\u901a\u5e38\u9700\u8981\u540c\u6b65\u8fde\u63a5\uff08Synchronous connection\uff09\u65f6\uff0c\u8fd9\u5c06\u4f1a\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0c\u5f53\u8033\u673a\u76f4\u63a5\u63d2\u5165\u9a71\u52a8\u5668\u65f6\uff0c\u5b83\u4e0e\u4ece\u97f3\u4e50CD\u4e2d\u83b7\u53d6\u6570\u636e\u7684CD-ROM\u4e4b\u95f4\u4f7f\u7528\u7684\u662f\u540c\u6b65\u8fde\u63a5\u3002\u7136\u800c\uff0c\u5f53\u97f3\u9891\u6570\u636e\u5fc5\u987b\u8981\u901a\u8fc7\u4e00\u4e2a\u50cfPCIe\u4e00\u6837\u7684\u901a\u7528\u603b\u7ebf\u4e4b\u540e\u624d\u80fd\u5230\u8fbe\u5916\u90e8\u626c\u58f0\u5668\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u7684\u8fde\u63a5\u5c31\u4e0d\u662f\u540c\u6b65\u7684\u4e86\uff0c\u56e0\u4e3a\u5176\u4ed6\u7684\u6d41\u91cf\u4e5f\u6709\u53ef\u80fd\u8981\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u6d41\u8def\u5f84\u3002\u4e3a\u4e86\u8fbe\u5230\u76f8\u540c\u7684\u6548\u679c\uff0c\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u5fc5\u987b\u4fdd\u8bc1\u5728\u4e0d\u963b\u6b62\u5176\u4ed6\u6d41\u91cf\u4f7f\u7528\u94fe\u8def\u7684\u540c\u65f6\uff0c\u80fd\u591f\u53ca\u65f6\u6b63\u786e\u7684\u4f20\u8f93\u8fd9\u4e9b\u65f6\u95f4\u654f\u611f\uff08time-sensitive\uff09\u7684\u97f3\u9891\u6570\u636e\u4fe1\u606f\u3002\u6beb\u65e0\u7591\u95ee\uff0c\u8fd9\u5c31\u5fc5\u987b\u8981\u6709\u4e13\u95e8\u7684\u8f6f\u4ef6\u548c\u786c\u4ef6\u8bbe\u8ba1\u6765\u652f\u6301\u5b83\u3002</p> <p>\u5173\u4e8e\u7aef\u53e3\u4ef2\u88c1\u7684\u6982\u5ff5\u5982\u56fe 7\u201114\u6240\u793a\u3002\u9700\u8981\u6ce8\u610f\uff0c\u7aef\u53e3\u4ef2\u88c1\u5728\u7cfb\u7edf\u4e2d\u7684\u591a\u4e2a\u4f4d\u7f6e\u90fd\u4f1a\u51fa\u73b0\uff1a</p> <p>n Switch\u7684\u51fa\u53e3\u7aef\u53e3\uff08egress\uff09</p> <p>n \u652f\u6301Peer-to-Peer\u4e8b\u52a1\u65f6\u7684RC\u7aef\u53e3</p> <p>n \u67d0\u4e9bRC\u51fa\u53e3\u7aef\u53e3\uff0c\u5b83\u4eec\u901a\u5411\u7684\u76ee\u7684\u5730\u662f\u4e3b\u5b58</p> <p>\u7aef\u53e3\u4ef2\u88c1\u901a\u5e38\u9700\u8981\u5bf9Switch\u6216\u8005Root\u7684\u51fa\u53e3\u7aef\u53e3\u7684\u6bcf\u4e2a\u865a\u62df\u901a\u9053\u8fdb\u884c\u8f6f\u4ef6\u914d\u7f6e\u3002\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cRoot\u7aef\u53e32\u652f\u6301\u6765\u81eaRoot\u7aef\u53e31\u548c3\u7684Peer-to-Peer\u4f20\u8f93\uff0c\u56e0\u6b64\u8fd9\u91cc\u9700\u8981\u7aef\u53e3\u4ef2\u88c1\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u4e8eRoot\u7aef\u53e3\u95f4\u652f\u6301Peer-to-Peer\u7684\u4f20\u8f93\u662f\u53ef\u9009\u7684\uff0c\u56e0\u6b64\u5e76\u4e0d\u662f\u6bcf\u4e2aRoot\u51fa\u53e3\u7aef\u53e3\u90fd\u9700\u8981\u7aef\u53e3\u4ef2\u88c1\u3002</p> <p>\u4e0e\u7cfb\u7edf\u5185\u5b58\u76f8\u8fde\u63a5\u7684\u8def\u5f84\u662f\u4e00\u6761\u6709\u8da3\u7684\u8def\u5f84\u3002\u8fd9\u91cc\u53ef\u80fd\u4f1a\u6709\u6765\u81ea\u591a\u4e2a\u5165\u53e3\u7aef\u53e3\uff08ingress\uff09\u7684\u6570\u636e\u5305\u5728\u540c\u4e00\u65f6\u95f4\u90fd\u60f3\u8981\u8bbf\u95ee\u8fd9\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\uff0c\u56e0\u6b64\u5b83\u9700\u8981\u652f\u6301\u7aef\u53e3\u4ef2\u88c1\u3002\u7136\u800c\uff0c\u5b83\u6240\u4f7f\u7528\u7684\u5e76\u4e0d\u662f\u4e00\u4e2aPCIe\u7aef\u53e3\uff0c\u56e0\u6b64\u5b83\u5e76\u4e0d\u9700\u8981\u901a\u8fc7\u914d\u7f6e\u6211\u4eec\u63a5\u4e0b\u6765\u8981\u8ba8\u8bba\u7684PCIe\u5bc4\u5b58\u5668\u6765\u5bf9\u7aef\u53e3\u4ef2\u88c1\u8fdb\u884c\u652f\u6301\u3002\u76f8\u53cd\u5730\uff0cRC\u9700\u8981\u63d0\u4f9b\u4f9b\u5e94\u5546\u6307\u5b9a\u7684\uff08vendor-specific\uff09\u7684\u4e00\u7ec4\u5bc4\u5b58\u5668\u6765\u63d0\u4f9b\u8fd9\u65b9\u9762\u7684\u529f\u80fd\uff0c\u5b83\u88ab\u79f0\u4e3aRoot Complex Register Block\uff08RCRB\uff0cRC\u5bc4\u5b58\u5668\u5757\uff09</p> <p>\u56e0\u4e3a\u51fa\u53e3\u7aef\u53e3\u7684\u6bcf\u4e2aVC\u7684\u7aef\u53e3\u4ef2\u88c1\u90fd\u662f\u72ec\u7acb\u7ba1\u7406\u7684\uff0c\u6240\u4ee5\u6bcf\u4e2a\u652f\u6301\u53ef\u7f16\u7a0b\u7684\u7aef\u53e3\u4ef2\u88c1\u7684VC\u90fd\u9700\u8981\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u4ef2\u88c1\u8868\uff0c\u5982\u56fe 7\u201115\u6240\u793a\u3002\u53ea\u6709Switch\u548cRC\u7aef\u53e3\u624d\u652f\u6301\u7aef\u53e3\u4ef2\u88c1\u8868\uff0cEP\u5185\u662f\u4e0d\u5141\u8bb8\u4f7f\u7528\u7aef\u53e3\u4ef2\u88c1\u8868\u7684\u3002</p> <p></p> <p>\u56fe 7\u201114\u7aef\u53e3\u4ef2\u88c1\u6982\u5ff5</p> <p></p> <p>\u56fe 7\u201115\u6bcf\u4e2aVC\u7684\u7aef\u53e3\u4ef2\u88c1\u8868</p> <p>\u5c3d\u7ba1\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u8bf4\u660e\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u9488\u5bf9\u4e0d\u540c\u7684\u6570\u636e\u5305\u6d41\u4e4b\u95f4\u7684\u4ef2\u88c1\u9700\u8981\u5728\u51fa\u53e3\u7aef\u53e3\u4e2d\u4f7f\u7528\u989d\u5916\u7684Buffer\u6765\u79ef\u6512\u6765\u81ea\u591a\u4e2a\u7aef\u53e3\u7684\u6d41\u91cf\uff0c\u5982\u56fe 7\u201116\u6240\u793a\u3002\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u6709\u4e24\u4e2a\u5165\u53e3\u7aef\u53e3\uff08\u7aef\u53e31\u548c2\uff09\uff0c\u5b83\u4eec\u7684\u4e8b\u52a1\u90fd\u88ab\u8def\u7531\u81f3\u540c\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\uff08\u7aef\u53e33\uff09\u3002Switch\u6240\u8fdb\u884c\u7684\u64cd\u4f5c\u5305\u62ec\uff1a</p> <p>\\1.    \u5230\u8fbe\u5165\u53e3\u7aef\u53e3\u7684\u6570\u636e\u5305\u76f4\u63a5\u6839\u636eTC/VC\u6620\u5c04\u88ab\u653e\u5165\u76f8\u5e94\u7684\u6d41\u63a7Buffer\uff08VC\uff09\u3002</p> <p>\\2.    \u6570\u636e\u5305\u4ece\u6d41\u63a7Buffer\u4e2d\u88ab\u8f6c\u53d1\u81f3\u8def\u7531\u903b\u8f91\uff0c\u8def\u6709\u903b\u8f91\u5c06\u51b3\u5b9a\u6570\u636e\u5305\u88ab\u8def\u7531\u81f3\u54ea\u4e2a\u51fa\u53e3\u7aef\u53e3\uff0c\u5e76\u5b8c\u6210\u8def\u7531\u64cd\u4f5c\u3002</p> <p>\\3.    \u88ab\u8def\u7531\u81f3\u51fa\u53e3\u7aef\u53e3\uff08\u7aef\u53e33\uff09\u7684\u6570\u636e\u5305\u901a\u8fc7TC/VC\u6620\u5c04\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u4ed6\u4eec\u5e94\u8be5\u88ab\u653e\u5165\u51fa\u53e3\u7aef\u53e3\u7684\u54ea\u4e00\u4e2aVC\u3002</p> <p>\\4.    \u6bcf\u4e2a\u5165\u53e3\u7aef\u53e3\u90fd\u5b58\u5728\u4e00\u7ec4Buffer\u4e0e\u4e4b\u76f8\u5173\u8054\uff0c\u5141\u8bb8\u5728\u7aef\u53e3\u4ef2\u88c1\u5b8c\u6210\u524d\u90fd\u53ef\u4ee5\u8ffd\u8e2a\u5165\u53e3\u7aef\u53e3\u53f7\u3002</p> <p>\\5.    \u7aef\u53e3\u4ef2\u88c1\u903b\u8f91\u51b3\u5b9a\u6bcf\u7ec4\u5165\u53e3Buffer\u53d1\u9001\u4e8b\u52a1\u7684\u987a\u5e8f\u3002</p> <p></p> <p>\u56fe 7\u201116\u7aef\u53e3\u4ef2\u88c1\u7f13\u51b2</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#742-port-arbitration-mechanisms","title":"7.4.2     \u7aef\u53e3\u4ef2\u88c1\u673a\u5236\uff08Port Arbitration Mechanisms\uff09","text":"<p>\u5b9e\u9645\u4e0a\u7aef\u53e3\u4ef2\u88c1\u7684\u673a\u5236\u7684\u5b9a\u4e49\u4e0eVC\u4ef2\u88c1\u6240\u4f7f\u7528\u7684\u6a21\u578b\u6bd4\u8f83\u76f8\u4f3c\u3002\u914d\u7f6e\u8f6f\u4ef6\u901a\u8fc7\u8bfb\u53d6\u56fe 7\u201117\u6240\u793a\u7684\u5bc4\u5b58\u5668\u6765\u786e\u5b9a\u7aef\u53e3\u7684\u80fd\u529b\uff0c\u5e76\u4e3a\u6bcf\u4e2aVC\u9009\u62e9\u7aef\u53e3\u4ef2\u88c1\u65b9\u6848\u3002</p> <p></p> <p>\u56fe 7\u201117\u8f6f\u4ef6\u9009\u62e9\u7aef\u53e3\u4ef2\u88c1\u65b9\u6848</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7421-hardware-fixed-arbitration","title":"7.4.2.1   \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\uff08Hardware-Fixed Arbitration\uff09","text":"<p>\u8fd9\u79cd\u4ef2\u88c1\u673a\u5236\u4e0d\u9700\u8981\u8f6f\u4ef6\u8bbe\u7f6e\u3002\u4e00\u65e6\u5b83\u88ab\u9009\u62e9\u4f7f\u7528\uff0c\u90a3\u4e48\u5c31\u4ec5\u7531\u786c\u4ef6\u6765\u8fdb\u884c\u7ba1\u7406\u3002\u5b9e\u9645\u7684\u4ef2\u88c1\u65b9\u6848\u7531\u786c\u4ef6\u7684\u8bbe\u8ba1\u8005\u9009\u62e9\uff0c\u53ef\u80fd\u4f1a\u57fa\u4e8e\u8bbe\u5907\u7684\u9884\u671f\u9700\u6c42\u6765\u8fdb\u884c\u9009\u62e9\u3002\u5b83\u4e5f\u8bb8\u53ea\u662f\u7b80\u5355\u7684\u4fdd\u8bc1\u4e86\u4ef2\u88c1\u7684\u516c\u5e73\u6027\uff0c\u6216\u8005\u662f\u4f18\u5316\u4e86\u8bbe\u8ba1\u7684\u67d0\u4e9b\u65b9\u9762\uff0c\u4f46\u662f\u5b83\u65e0\u6cd5\u652f\u6301\u5dee\u5f02\u5316\u6216\u540c\u6b65\u670d\u52a1\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7422-wrr-arbitration","title":"7.4.2.2   \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\uff08WRR Arbitration\uff09","text":"<p>\u5c31\u50cfVC\u4ef2\u88c1\u4e2d\u7684\u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\u673a\u5236\u7c7b\u4f3c\uff0c\u8f6f\u4ef6\u53ef\u4ee5\u8bbe\u7f6e\u7aef\u53e3\u4ef2\u88c1\u8868\uff0c\u4ee5\u6b64\u6765\u8ba9\u4e00\u4e9b\u7aef\u53e3\u5728\u4ef2\u88c1\u4e2d\u6709\u66f4\u591a\u7684\u88ab\u9009\u4e2d\u7684\u673a\u4f1a\u3002\u8fd9\u79cd\u65b9\u6cd5\u4e3a\u6765\u81ea\u4e0d\u540c\u7aef\u53e3\u7684\u6d41\u91cf\u5206\u914d\u4e86\u4e0d\u540c\u7684\u4ef2\u88c1\u6743\u91cd\u3002</p> <p>\u5728\u626b\u63cf\u4ef2\u88c1\u8868\u65f6\uff0c\u5176\u4e2d\u7684\u6bcf\u4e2a\u9636\u6bb5\uff08Phase\uff09\u90fd\u4f1a\u6307\u5b9a\u4e0b\u4e00\u4e2a\u88ab\u63a5\u6536\u7684\u6570\u636e\u5305\u7684\u5165\u53e3\u7aef\u53e3\u53f7\u3002\u4e00\u65e6\u5f53\u524d\u9636\u6bb5\u7684\u6570\u636e\u5305\u88ab\u53d1\u9001\uff0c\u4ef2\u88c1\u903b\u8f91\u5c31\u4f1a\u7acb\u5373\u8df3\u8f6c\u81f3\u4e0b\u4e00\u4e2a\u9636\u6bb5\u3002\u5982\u679c\u5e76\u6ca1\u6709\u6570\u636e\u5305\u9700\u8981\u53d1\u9001\u7ed9\u88ab\u9009\u4e2d\u7684\u7aef\u53e3\uff0c\u4ef2\u88c1\u5668\u5c31\u5c06\u4f1a\u7acb\u5373\u63a8\u8fdb\u5230\u4e0b\u4e00\u4e2a\u9636\u6bb5\u53bb\u3002\u5bf9\u4e8e\u4ef2\u88c1\u8868\u4e2d\u7684\u8fd9\u4e9b\u6761\u76ee\u5e76\u6ca1\u6709\u4e0e\u5b83\u4eec\u76f8\u5173\u7684\u65f6\u95f4\u503c\u3002</p> <p>\u5bf9\u4e8eWRR\u7aef\u53e3\u4ef2\u88c1\uff0c\u6709\u56db\u79cd\u4ef2\u88c1\u8868\u957f\u5ea6\u53ef\u4ee5\u4f7f\u7528\uff0c\u4ef2\u88c1\u8868\u957f\u5ea6\u786e\u5b9a\u4e86\u5b83\u5305\u542b\u7684\u9636\u6bb5\u6570\u91cf\u3002\u82e5\u4ef2\u88c1\u8868\u4e2d\u7684\u6761\u76ee\u6570\u91cf\u8d8a\u591a\uff0c\u90a3\u4e48\u4e5f\u5c31\u53ef\u4ee5\u4f7f\u7528\u66f4\u590d\u6742\u66f4\u7279\u522b\u7684\u4ef2\u88c1\u9009\u62e9\u6bd4\u7387\u3002\u800c\u4ece\u53e6\u4e00\u65b9\u9762\u6765\u8bf4\uff0c\u4ef2\u88c1\u8868\u6761\u76ee\u6570\u91cf\u8d8a\u5c11\u5219\u4f1a\u4f7f\u7528\u66f4\u5c11\u7684\u5b58\u50a8\u7a7a\u95f4\u4ee5\u53ca\u66f4\u4f4e\u7684\u6210\u672c\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7423-time-based-wrr-arbitrationtbwrr","title":"7.4.2.3   \u57fa\u4e8e\u65f6\u95f4\u7684\u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\uff08Time-Based WRR Arbitration\uff0cTBWRR\uff09","text":"<p>\u8981\u5bf9\u540c\u6b65\u7c7b\u578b\u7684\u670d\u52a1\u8fdb\u884c\u652f\u6301\uff0c\u8fd9\u79cd\u673a\u5236\u662f\u5fc5\u9700\u7684\u3002\u50cf\u5b83\u540d\u5b57\u6240\u8ff0\u7684\u90a3\u6837\uff0c\u57fa\u4e8e\u65f6\u95f4\u7684\u52a0\u6743\u8f6e\u8be2\uff08TBWRR\uff09\u4e3a\u6bcf\u4e2a\u4ef2\u88c1\u9636\u6bb5\u90fd\u52a0\u5165\u4e86\u65f6\u95f4\u5143\u7d20\u3002\u5c31\u50cf\u5728WRR\u4e2d\uff0c\u7aef\u53e3\u4ef2\u88c1\u5668\u4ece\u4ef2\u88c1\u8868\u4e2d\u83b7\u5f97\u5f53\u524d\u9636\u6bb5\u6240\u6307\u793a\u7684\u7aef\u53e3\u53f7\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u7aef\u53e3\u53f7\u53bb\u4ece\u76f8\u5e94\u7684\u5165\u53e3\u7aef\u53e3VC Buffer\u4e2d\u53d6\u51fa\u6570\u636e\u5305\u7528\u4e8e\u4f20\u8f93\u3002\u800c\u5bf9\u4e8e\u73b0\u5728\u7684TBWRR\u6765\u8bf4\uff0c\u57fa\u4e8e\u65f6\u95f4\u7684\u4ef2\u88c1\u5668\u5e76\u4e0d\u4f1a\u7acb\u5373\u63a8\u8fdb\u5230\u4e0b\u4e00\u4e2a\u9636\u6bb5\uff0c\u800c\u662f\u8981\u7b49\u5230\u5f53\u524d\u7684\u865a\u62df\u65f6\u9699\uff08timeslot\uff09\u8fc7\u53bb\u4e4b\u540e\u624d\u63a8\u8fdb\u5230\u4e0b\u4e00\u4e2a\u9636\u6bb5\u3002\u8fd9\u786e\u4fdd\u4e86\u4ece\u5165\u53e3\u7aef\u53e3\u63a5\u6536\u4e8b\u52a1\u7684\u65f6\u95f4\u95f4\u9694\u662f\u786e\u5b9a\u7684\u3002\u5982\u679c\u88ab\u9009\u4e2d\u7684\u7aef\u53e3\u5e76\u6ca1\u6709\u9700\u8981\u53d1\u9001\u7684\u4e8b\u52a1\uff0c\u90a3\u4e48\u4e5f\u4f1a\u7b49\u5f85\u81f3\u4e0b\u4e00\u4e2a\u65f6\u9699\uff0c\u800c\u5728\u8fd9\u4e2d\u95f4\u7684\u8fd9\u6bb5\u7b49\u5f85\u65f6\u95f4\u4e0d\u4f1a\u6709\u4efb\u4f55\u4fe1\u606f\u88ab\u53d1\u9001\u3002\u6ce8\u610f\uff0c\u65f6\u9699\u7684\u5e76\u4e0d\u63a7\u5236\u6574\u4e2a\u4f20\u8f93\u6240\u6301\u7eed\u7684\u65f6\u95f4\uff0c\u800c\u662f\u63a7\u5236\u4e24\u6b21\u4f20\u8f93\u4e4b\u95f4\u7684\u95f4\u9694\u3002\u8fd9\u91cc\u7684\u4e8b\u52a1\u4f20\u8f93\u7684\u6700\u5927\u6301\u7eed\u65f6\u95f4\u662f\u5b8c\u6210\u8f6e\u8be2\u5e76\u4e14\u8fd4\u56de\u5230\u521d\u59cb\u65f6\u9699\u4e2d\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u3002\u65f6\u9699\u7684\u957f\u5ea6\u4e5f\u8bb8\u5728\u672a\u6765\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u4f46\u662f\u76ee\u524d\u5b83\u7684\u503c\u4e3a100ns\u3002</p> <p>\u57fa\u4e8e\u65f6\u95f4\u7684WRR\u4ef2\u88c1\u6240\u652f\u6301\u7684\u6700\u5927\u957f\u5ea6\u7684\u4ef2\u88c1\u8868\u542b\u6709128\u4e2a\u9636\u6bb5\uff0c\u4f46\u662f\u4e00\u4e2a\u5177\u4f53\u7684VC\u53ef\u7528\u7684\u4ef2\u88c1\u8868\u6761\u76ee\u5b9e\u9645\u6570\u91cf\u53ef\u80fd\u4f1a\u4f4e\u4e8e\u8fd9\u4e2a\u6570\u503c\u3002\u8fd9\u4e2a\u503c\u662f\u7531\u786c\u4ef6\u521d\u59cb\u5316\uff0c\u5e76\u901a\u8fc7\u6bcf\u4e2a\u652f\u6301TBWRR\u7684VC\u7684Maximum Time Slots\u5b57\u6bb5\u6765\u8fdb\u884c\u8868\u793a\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5982\u56fe 7\u201118\u6240\u793a\u3002</p> <p></p> <p>\u56fe 7\u201118\u6700\u5927\u65f6\u9699\u5bc4\u5b58\u5668</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#743-loading-the-port-arbitration-tables","title":"7.4.3     \u8f7d\u5165\u7aef\u53e3\u4ef2\u88c1\u8868\uff08Loading the Port Arbitration Tables\uff09","text":"<p>\u7aef\u53e3\u4ef2\u88c1\u8868\u7684\u5b9e\u9645\u5927\u5c0f\u548c\u683c\u5f0f\uff0c\u662f\u4e00\u4e2a\u548c\u9636\u6bb5\u6570\u91cf\u548c\u5165\u53e3\u7aef\u53e3\u6570\u91cf\u6709\u5173\u7684\u51fd\u6570\uff0c\u8fd9\u91cc\u7684\u5165\u53e3\u7aef\u53e3\u53ef\u4ee5\u662fSwitch\u7aef\u53e3\u3001RCRB\uff08Root Complex Register Block\uff09\u6216\u8005\u662f\u652f\u6301Peer-to-Peer\u4f20\u8f93\u7684RC\u7aef\u53e3\u3002\u7aef\u53e3\u4ef2\u88c1\u8868\u6240\u652f\u6301\u7684\u6700\u5927\u5165\u53e3\u7aef\u53e3\u6570\u91cf\u4e3a256\u4e2a\u3002\u5b9e\u9645\u7684\u4ef2\u88c1\u8868\u4e2d\u6bcf\u4e2a\u6761\u76ee\u7684bit\u6570\u91cf\uff0c\u5176\u8bbe\u8ba1\u8003\u8651\u548c\u7ba1\u7406\u90fd\u4f9d\u8d56\u4e8e\u53ef\u4ee5\u5c06\u4e8b\u52a1\u4f20\u8f93\u81f3\u6b64\u51fa\u53e3\u7aef\u53e3\u7684\u5165\u53e3\u7aef\u53e3\u6570\u91cf\u3002\u6bcf\u4e2a\u4ef2\u88c1\u8868\u6761\u76ee\u7684\u5927\u5c0f\u8868\u793a\u5728\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56681\uff08Port VC Capability Register 1\uff09\u4e2d\u7684Port Arbitration Table Entry Size\uff08\u7aef\u53e3\u4ef2\u88c1\u8868\u6761\u76ee\u5927\u5c0f\uff09\u5b57\u6bb5\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u957f\u5ea6\u4e3a2bit\u3002\u5176\u4e2d\u5404\u4e2a\u6570\u503c\u542b\u4e49\u4e3a\uff1a</p> <p>n 00b\uff1a1bit\uff08\u4e5f\u5c31\u662f\u5728\u4e24\u4e2a\u7aef\u53e3\u4e4b\u95f4\u8fdb\u884c\u9009\u62e9\uff09</p> <p>n 01b\uff1a2bits\uff084\u4e2a\u7aef\u53e3\uff09</p> <p>n 10b\uff1a4bits\uff0816\u4e2a\u7aef\u53e3\uff09</p> <p>n 11b\uff1a8bits\uff08256\u4e2a\u7aef\u53e3\uff09</p> <p>\u914d\u7f6e\u8f6f\u4ef6\u901a\u8fc7\u5c06\u5404\u7aef\u53e3\u53f7\u586b\u5165\u4ef2\u88c1\u8868\u6765\u5b8c\u6210\u4ef2\u88c1\u8868\u7684\u52a0\u8f7d\uff0c\u4ee5\u5b9e\u73b0\u652f\u6301\u7684\u6bcf\u4e2aVC\u6240\u9700\u7684\u7aef\u53e3\u4f18\u5148\u7ea7\u529f\u80fd\u3002\u5982\u56fe 7\u201119\u6240\u793a\uff0c\u4ef2\u88c1\u8868\u7684\u683c\u5f0f\u53d6\u51b3\u4e8e\u6bcf\u4e2a\u6761\u76ee\u7684\u5b9e\u9645\u5927\u5c0f\u4ee5\u53ca\u8be5\u8bbe\u8ba1\u4e2d\u6240\u652f\u6301\u7684\u9636\u6bb5\u7684\u6570\u91cf\u3002</p> <p></p> <p>\u56fe 7\u201119\u7aef\u53e3\u4ef2\u88c1\u8868\u683c\u5f0f</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#744-switchswitch-arbitration-example","title":"7.4.4     Switch\u4ef2\u88c1\u793a\u4f8b\uff08Switch Arbitration Example\uff09","text":"<p>\u73b0\u5728\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a3\u7aef\u53e3Switch\u7684\u4f8b\u5b50\uff0c\u4ee5\u6b64\u6765\u5bf9\u7aef\u53e3\u4ef2\u88c1\u548cVC\u4ef2\u88c1\u8fdb\u884c\u4e3e\u4f8b\u8bb2\u89e3\u3002\u6211\u4eec\u5728\u793a\u4f8b\u4e2d\u5047\u8bbe\uff0c\u7531\u5165\u53e3\u7aef\u53e30\u548c\u5165\u53e3\u7aef\u53e31\u63a5\u6536\u7684\u6570\u636e\u5305\u4f1a\u5411\u4e0a\u884c\u79fb\u52a8\uff0c\u800c\u7aef\u53e32\u5219\u662f\u9762\u5411\u4e0a\u884c\u7684\u51fa\u53e3\u7aef\u53e3\uff08\u4e5f\u5c31\u662f\u9762\u5411RC\uff09\u3002\u4e0b\u9762\u7684\u5173\u4e8e\u8fd9\u4e2a\u793a\u4f8b\u7684\u8ba8\u8bba\u53ef\u4ee5\u53c2\u7167\u56fe 7\u201120\u3002</p> <p></p> <p>\u56fe 7\u201120 Switch\u4e2d\u7684\u4ef2\u88c1\u793a\u4f8b</p> <p>\\1.    \u5230\u8fbe\u5165\u53e3\u7aef\u53e30\u7684\u6570\u636e\u5305\u6839\u636eTC/VC\u6620\u5c04\u5173\u7cfb\uff0c\u88ab\u7aef\u53e30\u653e\u5165\u76f8\u5e94\u7684\u63a5\u6536VC\u4e2d\u3002\u5982\u56fe\u4e2d\u5c55\u793a\u7684\u4e00\u6837\uff0c\u6d41\u91cf\u7c7b\u578b\u4e3aTC0\u6216\u662fTC1\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e30\u7684VC0 Buffer\uff1b\u6d41\u91cf\u7c7b\u578b\u4e3aTC3\u6216\u662fTC5\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e30\u7684VC1 Buffer\u3002\u5728\u8fd9\u4e2a\u7aef\u53e3\u7684\u94fe\u8def\u4e0a\uff0c\u5176\u4ed6\u7684TC\u90fd\u662f\u4e0d\u5141\u8bb8\u51fa\u73b0\u7684\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u4e00\u4e2a\u6570\u636e\u5305\u800c\u5b83\u7684TC\u65e0\u6cd5\u6b63\u786e\u7684\u6620\u5c04\u5230\u4efb\u4f55\u4e00\u4e2a\u5b58\u5728\u7684VC\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u89c6\u4f5c\u53d1\u751f\u4e86\u4e00\u4e2a\u9519\u8bef\u3002</p> <p>\\2.    \u5230\u8fbe\u5165\u53e3\u7aef\u53e31\u7684\u6570\u636e\u5305\u4e5f\u4f1a\u6839\u636eTC/VC\u6620\u5c04\u5173\u7cfb\u88ab\u653e\u5165\u76f8\u5e94\u7684VC\u4e2d\uff0c\u4f46\u662f\u7aef\u53e31\u7684TC/VC\u6620\u5c04\u5173\u7cfb\u548c\u7aef\u53e30\u7684\u4e0d\u540c\u3002\u5728\u7aef\u53e31\u4e2d\uff0c\u6d41\u91cf\u7c7b\u578b\u4e3aTC0\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e31\u7684VC0 Buffer\uff1b\u6d41\u91cf\u7c7b\u578b\u4e3aTC2-4\uff08TC2\u3001TC3\u3001TC4\uff09\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e31\u7684VC3 Buffer\u3002\u94fe\u8def\u4e0a\u4e0d\u5141\u8bb8\u51fa\u73b0\u5176\u4ed6TC\u7684\u6570\u636e\u5305\u3002</p> <p>\\3.    \u5bf9\u4e8e\u7aef\u53e30\u548c\u7aef\u53e31\u8fd9\u4e24\u4e2a\u7aef\u53e3\u6765\u8bf4\uff0c\u5b83\u4eec\u63a5\u6536\u7684\u6570\u636e\u5305\u7684\u76ee\u7684\u51fa\u53e3\u7aef\u53e3\u662f\u7531\u6bcf\u4e2a\u6570\u636e\u5305\u7684\u8def\u7531\u4fe1\u606f\u6765\u51b3\u5b9a\u7684\u3002\u4f8b\u5982\uff0cMemory\u6216\u662fIO\u8bf7\u6c42TLP\u4f1a\u4f7f\u7528\u5730\u5740\u8def\u7531\u65b9\u5f0f\u3002</p> <p>\\4.    \u6240\u6709\u76ee\u7684\u51fa\u53e3\u7aef\u53e3\u4e3a\u7aef\u53e32\u7684\u6570\u636e\u5305\uff0c\u90fd\u4f1a\u88ab\u5448\u4ea4\u7ed9\u7aef\u53e32\u7684TC/VC\u6620\u5c04\u903b\u8f91\u3002\u5982\u56fe\u4e2d\u6240\u793a\u7684\u90a3\u6837\uff0c\u6d41\u91cf\u7c7b\u578b\u4e3aTC0-2\uff08TC0\u3001TC1\u3001TC2\uff09\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e32\u4e2d\u88ab\u6807\u8bc6\u6709TLP\u5404\u81ea\u5165\u53e3\u7aef\u53e3\u53f7\u7684VC0 Buffer\uff1b\u6d41\u91cf\u7c7b\u578b\u4e3aTC3-7\uff08TC3\u3001TC4\u3001TC5\u3001TC6\u3001TC7\uff09\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e32\u4e2d\u88ab\u6807\u8bc6\u6709TLP\u5404\u81ea\u5165\u53e3\u7aef\u53e3\u53f7\u7684VC1 Buffer\u3002</p> <p>\\5.    \u7aef\u53e3\u4ef2\u88c1\u662f\u7aef\u53e32\u4e2d\u7684\u6bcf\u4e2aVC\u72ec\u7acb\u8fdb\u884c\u7684\uff0c\u5404\u4e2aVC\u4f1a\u5c06\u81ea\u5df1\u7684\u4e00\u7ec4\u5e26\u6709\u5404\u5165\u53e3\u7aef\u53e3\u53f7\u6807\u8bc6\u7684Buffer\u4e2d\u7684\u6570\u636e\u5305\u8fdb\u884c\u6392\u961f\uff0c\u4ee5\u6b64\u6765\u51b3\u5b9a\u54ea\u4e2a\u5165\u53e3\u7aef\u53e3\u4f20\u6765\u7684TLP\u5c06\u8981\u6210\u4e3a\u4e0b\u4e00\u4e2a\u771f\u6b63\u88ab\u653e\u5165\u771f\u5b9eVC\u7684\u6570\u636e\u5305\u3002</p> <p>\\6.    \u6700\u540e\uff0c\u7531VC\u4ef2\u88c1\u6765\u786e\u5b9a\u5728\u5404\u771f\u5b9e\u7684VC Buffer\u5b9e\u9645\u5728\u94fe\u8def\u4e0a\u4f20\u8f93\u4e8b\u52a1\u7684\u987a\u5e8f\u662f\u600e\u6837\u7684\u3002</p> <p>\\7.    \u6ce8\u610f\uff0cVC\u4ef2\u88c1\u4ec5\u4f1a\u5728\u6709\u8db3\u591f\u7684\u6d41\u63a7Credit\u65f6\uff0c\u624d\u56de\u53bb\u9009\u62e9\u6570\u636e\u5305\u7528\u4e8e\u4f20\u8f93\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#75-eparbitration-in-multi-function-endpoints","title":"7.5 \u591a\u529f\u80fd EP\u7684\u4ef2\u88c1\uff08Arbitration in Multi-Function Endpoints\uff09","text":"<p>\u6709\u4e00\u7ec4\u5bc4\u5b58\u5668\u79f0\u4e3aMulti-Function Virtual Channel\uff08MFVC\uff09Capability\uff08\u591a\u529f\u80fd\u865a\u62df\u901a\u9053\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\uff09\uff0c\u8fd9\u7ec4\u5bc4\u5b58\u5668\u662f\u4e3a\u4e86\u5728\u5177\u6709\u591a\u79cdFunction\u7684EP\u8bbe\u5907\u4e2d\u5b9e\u73b0QoS\u7684\u8fd9\u79cd\u7279\u5b9a\u60c5\u51b5\u800c\u5b9a\u4e49\u7684\u3002</p> <p>\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u63cf\u8ff0\u4e86\u8fd9\u79cd\u4ef2\u88c1\u7684\u4e24\u79cd\u60c5\u51b5\u3002\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u5982\u56fe 7\u201121\u6240\u793a\uff0cEP\u4e2d\u867d\u7136\u6709\u4e24\u4e2aFunction\uff0c\u4f46\u662f\u53ea\u6709Function 0\u4e2d\u542b\u6709VC\u80fd\u529b\u5bc4\u5b58\u5668\uff08VC Capability Registers\uff09\uff0c\u5e76\u4e14\u6240\u6709\u7684Function\u7684\u4efb\u52a1\u5206\u914d\u90fd\u662f\u76f8\u540c\u7684\u3002\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0cFunction\u4e4b\u95f4\u7684\u4ef2\u88c1\u65b9\u5f0f\u5c06\u6309\u7167\u4e00\u4e9b\u5382\u5546\u6307\u5b9a\uff08Vendor-Specific\uff09\u7684\u65b9\u6cd5\u53bb\u8fdb\u884c\u3002\u8fd9\u662f\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u8fd9\u65e0\u6cd5\u5728\u5185\u90e8\u5305\u542b\u4e00\u4e2a\u6807\u51c6\u7ed3\u6784\u7528\u4e8e\u5b9a\u4e49\u4e0d\u540cFunction\u7684\u8bf7\u6c42\u7684\u4f18\u5148\u7ea7\uff0c\u56e0\u6b64\u5b83\u65e0\u6cd5\u652f\u6301QoS\u3002</p> <p></p> <p>\u56fe 7\u201121\u7b80\u5355\u7684\u591aFunction\u4ef2\u88c1</p> <p>\u5982\u679c\u5e0c\u671b\u652f\u6301QoS\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5728VC0\u4e2d\u5b9e\u73b0\u4e00\u4e2aMFVC\uff08Multi-Function Virtual Channel\uff09\u5bc4\u5b58\u5668\u7ec4\uff0c\u5e76\u4e14\u6bcf\u4e2aFunction\u90fd\u8981\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u4e00\u7ec4VC\u80fd\u529b\u5bc4\u5b58\u5668\u3002\u4e3a\u4e86\u4fdd\u6301\u8f6f\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\uff0c\u534f\u8bae\u89c4\u8303\u4e2d\u58f0\u660e\uff0c\u6240\u6709\u4e0d\u9002\u7528MFVC\u7684\u8bbe\u5907\u7684VC Capability ID\uff08VC\u80fd\u529bID\uff09\u90fd\u5fc5\u987b\u4e3a0002h\uff0c\u800c\u6240\u6709\u5185\u90e8\u5b9e\u73b0\u4e86MFVC\u7684\u8bbe\u5907\u7684VC Capability ID\u90fd\u5fc5\u987b\u4e3a0009h\u3002</p> <p>\u56fe 7\u201122\u5c55\u793a\u4e86MFVC\u5bc4\u5b58\u5668\u7ec4\uff0c\u4ee5\u53ca\u4e00\u4e2a\u793a\u4f8b\u6846\u56fe\uff0c\u793a\u4f8b\u4e2d\u7684EP\u5185\u542b\u6709\u4e24\u4e2aFunction\uff0c\u8fd9\u4e2aEP\u7684\u7aef\u53e3\u652f\u63012\u4e2aVC\u3002\u6bcf\u4e2aFunction\u90fd\u6709\u81ea\u5df1\u7684\u4e8b\u52a1\u5c42\u4ee5\u53caVC\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u5b9e\u73b0\u66f4\u4f4e\u7684\u5c42\u7ea7\u3002\u76f8\u53cd\u5730\uff0c\u5b83\u4eec\u90fd\u8fde\u63a5\u5230\u4e86\u4e8c\u8005\u5171\u4eab\u7684\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\uff0c\u8fd9\u4e2a\u5171\u4eab\u7aef\u53e3\u5177\u6709\u6240\u6709\u7684\u5c42\u7ea7\u3002\u8fd9\u79cd\u5171\u4eab\u786c\u4ef6\u63a5\u53e3\u7684\u65b9\u5f0f\u53ef\u4ee5\u964d\u4f4e\u6210\u672c\u548c\u5f00\u9500\uff0c\u5e76\u4e14\u5404Function\u4e8b\u52a1\u5c42\u79cd\u6dfb\u52a0\u7684MFVC\u5bc4\u5b58\u5668\u7ec4\u4f7f\u5f97Function\u53ef\u4ee5\u5904\u7406\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff08Isochronous Traffic\uff09\u3002</p> <p>\u5728\u56fe 7\u201122\u4e2d\u53ef\u4ee5\u770b\u5230\uff0cMFVC\u5bc4\u5b58\u5668\u4ec5\u5b58\u5728\u4e8eFunction 0\u4e2d\uff0c\u5e76\u5b9a\u4e49\u4e86\u6b64\u63a5\u53e3\u4f7f\u7528\u7684VC\u4ee5\u53ca\u4ef2\u88c1\u65b9\u6cd5\u3002MFVC\u5bc4\u5b58\u5668\u7ec4\u770b\u8d77\u6765\u4e0eVC\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\u5341\u5206\u76f8\u4f3c\uff0c\u5b83\u53ef\u4ee5\u652f\u6301VC\u4ef2\u88c1\u4e0eFunction\u4ef2\u88c1\u3002\u7531\u4e8e\u6765\u81ea\u591a\u4e2a\u4e0d\u540cFunction\u7684\u6570\u636e\u5305\u6709\u53ef\u80fd\u5728\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u4e2aVC\uff0c\u56e0\u6b64\u5c31\u9700\u8981Function\u4ef2\u88c1\u6765\u51b3\u5b9a\u4e0d\u540cFunction\u6570\u636e\u5305\u4e4b\u95f4\u7684\u4f18\u5148\u7ea7\u3002\u8fd9\u79cd\u65b9\u5f0f\u5728\u73b0\u5728\u770b\u6765\u5e94\u8be5\u662f\u975e\u5e38\u719f\u6089\u7684\uff0c\u56e0\u4e3a\u5b83\u4e0e\u6b64\u524d\u7684\u7aef\u53e3\u4ef2\u88c1\u5176\u5b9e\u662f\u76f8\u540c\u7684\u6982\u5ff5\uff0c\u751a\u81f3\u8fde\u4ef2\u88c1\u65b9\u6cd5\u9009\u9879\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5305\u62ecTBWRR\u3002VC\u4ef2\u88c1\u9009\u9879\u4e5f\u4e0e\u5355Function VC\u5bc4\u5b58\u5668\u4e2d\u7684\u4ef2\u88c1\u9009\u9879\u76f8\u540c\u3002</p> <p></p> <p>\u56fe 7\u201122\u591aFunction\u4ef2\u88c1\u4e2d\u7684QoS\u652f\u6301</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#76-isochronous-support","title":"7.6 \u540c\u6b65\u7b49\u65f6\u670d\u52a1\u652f\u6301\uff08Isochronous Support\uff09","text":"<p>\u524d\u9762\u7684\u5185\u5bb9\u4e2d\u63d0\u5230\uff0c\u5e76\u4e0d\u662f\u6bcf\u4e2a\u8bbe\u5907\u6216\u8005\u5e94\u7528\u90fd\u9700\u8981\u652f\u6301\u540c\u6b65\u7b49\u65f6\u670d\u52a1\uff0c\u4f46\u662f\u4e5f\u6709\u4e00\u4e9b\u662f\u5fc5\u987b\u8981\u652f\u6301\u540c\u6b65\u670d\u52a1\u7684\u3002\u7531\u4e8ePCIe\u4ece\u8bbe\u8ba1\u4e4b\u521d\u5c31\u60f3\u8981\u652f\u6301\u540c\u6b65\u7b49\u65f6\u670d\u52a1\uff0c\u56e0\u6b64\u8ba9\u6211\u4eec\u6765\u8003\u8651\u4e00\u4e0b\u8981\u652f\u6301\u5b83\u7684\u8bdd\u4f1a\u6709\u4ec0\u4e48\u6837\u7684\u8981\u6c42\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#761-timing-is-everything","title":"7.6.1     \u65f6\u95f4\u89c4\u5212\u5c31\u662f\u4e00\u5207\uff08Timing is Everything\uff09","text":"<p>\u8003\u8651\u56fe 7\u201123\u4e2d\u5c55\u793a\u7684\u4f8b\u5b50\uff0c\u4f8b\u5b50\u4e2d\u7684\u540c\u6b65\u8fde\u63a5\uff08synchronous connection\uff09\u4f7f\u6211\u4eec\u6240\u671f\u671b\u7684\uff0c\u4f46\u662f\u8fd9\u662f\u65e0\u6cd5\u5b9e\u9645\u5b9e\u73b0\u7684\u3002\u76f8\u53cd\u5730\uff0c\u6211\u4eec\u901a\u8fc7\u901a\u8fc7\u540c\u6b65\u7b49\u65f6\u673a\u5236\u6765\u6a21\u62df\u4e00\u4e2a\u540c\u6b65\u8fde\u63a5\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u7b49\u65f6\u6027\uff08Isochrony\uff09\u5b9a\u4e49\u4e86\u5728\u670d\u52a1\u95f4\u9694\u5185\u9700\u8981\u88ab\u4f20\u8f93\u7684\u7528\u6765\u5b8c\u6210\u670d\u52a1\u9700\u6c42\u7684\u6570\u636e\u91cf\u3002\u4e0b\u9762\u5bf9\u64cd\u4f5c\u6d41\u7a0b\u8fdb\u884c\u4e86\u63cf\u8ff0\uff1a</p> <p>\\1.    \u540c\u6b65\u6e90\uff08\u6444\u50cf\u673a\u548cPCIe\u63a5\u53e3\uff09\u5728\u7b2c\u4e00\u4e2a\u7b49\u65f6\u670d\u52a1\u95f4\u9694\uff08Service Interval,SI 1\uff09\u4e2d\u5728Buffer A\u79ef\u7d2f\u6570\u636e\u3002</p> <p>\\2.    \u6444\u50cf\u673a\u5728\u4e0b\u4e00\u4e2a\u670d\u52a1\u95f4\u9694\uff08SI 2\uff09\u4e2d\u901a\u8fc7\u901a\u7528\u603b\u7ebf\u53d1\u9001\u5b8cBuffer A\u4e2d\u6240\u6709\u88ab\u7f13\u5b58\u79ef\u7d2f\u7684\u6570\u636e\uff0c\u540c\u65f6\u4e5f\u5c06\u4e0b\u4e00\u5757\u65b0\u6570\u636e\u79ef\u7d2f\u5728Buffer B\u4e2d\u3002</p> <p>\u660e\u663e\u5730\uff0c\u7cfb\u7edf\u5fc5\u987b\u8981\u80fd\u4fdd\u8bc1Buffer A\u4e2d\u7684\u5168\u90e8\u5185\u5bb9\u8981\u5728\u8fd9\u4e2a\u670d\u52a1\u95f4\u9694\u5185\u53d1\u9001\uff0c\u4e0d\u7ba1\u94fe\u8def\u4e0a\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u6d41\u91cf\u5728\u4f20\u8f93\u3002\u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u53ef\u4ee5\u7ed9\u8fd9\u4e9b\u65f6\u95f4\u654f\u611f\uff08time-sensitive\uff09\u6570\u636e\u5305\u5206\u914d\u9ad8\u4f18\u5148\u7ea7\uff0c\u5e76\u4e14\u6309\u7167\u9700\u8981\u89c4\u5212\u4ef2\u88c1\u65b9\u6848\u4f7f\u5f97\u8fd9\u4e9b\u6570\u636e\u5305\u5373\u4f7f\u5728\u6709\u5176\u4ed6\u6d41\u91cf\u7ade\u4e89\u7684\u60c5\u51b5\u4e0b\u4e5f\u80fd\u88ab\u4f18\u5148\u5904\u7406\u3002\u8fd8\u9700\u8981\u6ce8\u610f\uff0c\u53ea\u8981\u6240\u6709\u7684\u6570\u636e\u5728\u65f6\u95f4\u7a97\u53e3\u5185\u53d1\u9001\u51fa\u53bb\u5373\u53ef\uff0c\u800c\u81f3\u4e8e\u5b83\u4eec\u5177\u4f53\u4ec0\u4e48\u65f6\u95f4\u5230\u8fbe\u5728\u8fd9\u91cc\u5e76\u4e0d\u5173\u5fc3\uff0c\u5b83\u4eec\u53ef\u80fd\u4f1a\u5728\u670d\u52a1\u95f4\u9694\u4e2d\u5f88\u5206\u6563\u7684\u53d1\u9001\uff0c\u4e5f\u6709\u53ef\u80fd\u96c6\u4e2d\u5728\u670d\u52a1\u95f4\u9694\u7684\u67d0\u4e00\u65f6\u523b\u7d27\u5bc6\u7684\u53d1\u9001\u3002\u53ea\u8981\u5b83\u4eec\u90fd\u5728\u670d\u52a1\u95f4\u9694\u4e2d\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u90a3\u4e48\u5c31\u4f9d\u7136\u53ef\u4ee5\u505a\u5230\u9700\u8981\u7684\u4fdd\u8bc1\u3002</p> <p>\\3.    \u5728SI 2\u4e2d\uff0c\u5f55\u97f3\u673a\u63a5\u6536\u5230\u6570\u636e\uff0c\u5e76\u5c06\u8fd9\u4e9b\u8f93\u5165\u6570\u636e\u7f13\u5b58\u8d77\u6765\uff0c\u968f\u540e\u8fd9\u4e9b\u6570\u636e\u53ef\u4ee5\u5728SI 3\u88ab\u4f20\u9012\u5230\u5b58\u50a8\u4ecb\u8d28\u6765\u5b8c\u6210\u5f55\u5236\u3002\u6444\u50cf\u673a\u4e5f\u4f1a\u5728SI 3\u671f\u95f4\u5c06Buffer B\u4e2d\u7684\u6570\u636e\u5378\u5230\u94fe\u8def\u4e0a\uff0c\u540c\u65f6\u4e5f\u5728SI 3\u5185\u5728Buffer A\u4e2d\u79ef\u7d2f\u65b0\u7684\u6570\u636e\uff0c\u4ee5\u6b64\u5faa\u73af\u8fdb\u884c\u3002</p> <p></p> <p>\u56fe 7\u201123\u540c\u6b65\u4e8b\u52a1\u7684\u793a\u4f8b\u5e94\u7528</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7611-how-timing-defined","title":"7.6.1.1   \u5982\u4f55\u5b9a\u4e49\u65f6\u95f4\u89c4\u5212\uff08How Timing Defined\uff09","text":"<p>PCIe\u4f7f\u7528TBWRR\u7aef\u53e3\u4ef2\u88c1\u673a\u5236\u4e2d\u7684\u65f6\u9699\uff08time slot\uff09\u6765\u5b9a\u4e49\u540c\u6b65\u7b49\u65f6\u65f6\u957f\u3002\u76ee\u524d\uff0c\u6bcf\u4e2a\u65f6\u9699\u662f100ns\uff0c\u5b83\u4ee3\u8868TBWRR\u4ef2\u88c1\u8868\u7684128\u4e2a\u6761\u76ee\u4e2d\u76841\u4e2a\u3002\u4e00\u65e6\u8bbe\u7f6e\u5b8c\u6210\uff0c\u4ef2\u88c1\u5668\u5c31\u4f1a\u6bcf12.8us\u5faa\u73af\u91cd\u590d\u4e00\u6b21\u8fd9\u4e2a\u4ef2\u88c1\u8868\uff0c\u8fd9\u4e5f\u4ee3\u8868\u5168\u90e8\u7684\u670d\u52a1\u95f4\u9694\u3002</p> <p>\u8981\u60f3\u8ba9\u4e00\u4e2a\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u50cf\u9884\u671f\u7684\u4e00\u6837\u5de5\u4f5c\uff0c\u8fd9\u9700\u8981\u6709\u4e00\u5b9a\u7684\u8003\u8651\u3002\u9996\u5148\uff0c\u6570\u636e\u5305\u5fc5\u987b\u5728\u53ef\u4ee5\u6d4b\u7684\u65f6\u95f4\u70b9\u3001\u4ee5\u56fa\u5b9a\u7684\u95f4\u9694\u88ab\u53d1\u9001\u3002\u7b2c\u4e8c\uff0c\u540c\u6b65\u7b49\u65f6\u6570\u636e\u9700\u8981\u88ab\u4f20\u8f93\u7684\u6700\u5927\u6570\u636e\u91cf\u5fc5\u987b\u662f\u8981\u63d0\u524d\u53ef\u4ee5\u83b7\u77e5\u7684\uff0c\u5e76\u4e14\u6570\u636e\u5305\u4e0d\u5141\u8bb8\u8d85\u8fc7\u8fd9\u4e2a\u6700\u5927\u503c\u4e0a\u9650\u3002\u7b2c\u4e09\uff0c\u94fe\u8def\u5fc5\u987b\u8981\u6709\u8db3\u591f\u7684\u5e26\u5bbd\u6765\u652f\u6301\u4e00\u4e2a\u7ed9\u5b9a\u65f6\u9699\u5185\u6240\u8981\u4f20\u8f93\u7684\u6570\u636e\u91cf\u3002</p> <p>\u8003\u8651\u63a5\u4e0b\u6765\u8fd9\u4e2a\u4f8b\u5b50\u3002\u4e00\u4e2a\u5355\u901a\u9053\u94fe\u8def\u5de5\u4f5c\u57282.5Gbps\uff0c\u6bcf4ns\u53d1\u9001\u4e00\u4e2a\u7b26\u53f7\uff0810bit\u7b26\u53f7\uff09\u3002\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e2a100ns\u7684\u65f6\u9699\u53ef\u4ee5\u53d1\u900125\u4e2a\u7b26\u53f7\uff0c\u4f46\u662f\u8fd9\u8db3\u591f\u5417\uff1f\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u8fd9\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a1\u4e2aTLP\u9700\u898128byte\u7ec4\u6210 Header\u3001\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3001LCRC\u7b49\u7b49\u7684\u5e38\u89c4\u5f00\u9500\u3002\u8fd9\u610f\u5473\u7740100ns\u6839\u672c\u4e0d\u8db3\u4ee5\u5b8c\u6210\u8fd9\u4e9b\u5e38\u89c4\u5f00\u9500\u7684\u53d1\u9001\uff0c\u66f4\u4e0d\u7528\u8bf4\u53d1\u9001\u6570\u636e\u8377\u8f7d\u4e86\u3002\u5982\u679c\u6211\u4eec\u9700\u8981\u53d1\u9001128byte\u7684\u6570\u636e\uff0c\u90a3\u4e48\u9700\u8981\u7684\u5e26\u5bbd\u5c31\u5c06\u662f128+\u5e38\u89c4\u5f00\u9500=156bytes\u3002\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u4e2a\u9009\u9879\u662f\u5c06\u94fe\u8def\u5bbd\u5ea6\u589e\u52a0\u81f38\u901a\u9053\uff0c\u8fd9\u4f7f\u5f97\u4e00\u6b21\u53ef\u4ee5\u4f20\u8f93\u7684\u6570\u636e\u91cf\u53d8\u4e3a\u539f\u6765\u76848\u500d\u3002\u8fd9\u79cd\u6539\u53d8\u4f1a\u4f7f\u94fe\u8def\u5728100ns\u5185\u53ef\u4ee5\u4f20\u8f93200bytes\uff0c\u90a3\u4e48\u4e5f\u5c31\u53ef\u4ee5\u57281\u4e2a\u65f6\u9699\u4e2d\u53d1\u9001\u6240\u6709\u7684\u540c\u6b65\u7b49\u65f6\u6570\u636e\u3002\u53e6\u4e00\u79cd\u89e3\u51b3\u65b9\u6cd5\u662f\u4f9d\u7136\u4f7f\u7528\u5355\u901a\u9053\u94fe\u8def\uff0c\u4f46\u662f\u53ef\u4ee5\u7ed9\u4e88\u7aef\u53e3\u66f4\u591a\u7684\u65f6\u9699\u7528\u4e8e\u53d1\u9001\u6570\u636e\uff0c\u6bd4\u5982\u5c06\u670d\u52a1\u95f4\u9694\u75311\u4e2a\u65f6\u9699\u589e\u52a0\u52308\u4e2a\u65f6\u9699\uff0c\u90a3\u4e48\u5c31\u4e5f\u53ef\u4ee5\u57281\u4e2a\u670d\u52a1\u95f4\u9694\u4e2d\u4f20\u8f93200byte\u6570\u636e\u4e86\u3002\u5177\u4f53\u7684\u9009\u62e9\u54ea\u79cd\u89e3\u51b3\u65b9\u6cd5\u53d6\u51b3\u4e8e\u6210\u672c\u548c\u6027\u80fd\u7684\u6743\u8861\uff0c\u4f46\u662f\u7cfb\u7edf\u7684\u8bbe\u8ba1\u8005\u5fc5\u987b\u77e5\u9053\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u5bf9\u65f6\u95f4\u89c4\u5212\u548c\u5e26\u5bbd\u7684\u8981\u6c42\uff0c\u8fd9\u6837\u624d\u80fd\u6b63\u786e\u7684\u5efa\u7acb\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7612-how-timing-is-enforced","title":"7.6.1.2   \u5982\u4f55\u5b9e\u65bd\u65f6\u95f4\u89c4\u5212\uff08How Timing is Enforced\uff09","text":"<p>\u50cf\u524d\u9762\u7684\u4f8b\u5b50\u4e2d\u6240\u63cf\u8ff0\u7684\uff0c\u4e3a\u4e86\u8981\u4f7f\u4e00\u4e2a\u8bbe\u8ba1\u8fdb\u884c\u6b63\u786e\u7684\u64cd\u4f5c\uff0c\u65f6\u95f4\u89c4\u5212\u5df2\u7ecf\u6210\u4e86\u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u90e8\u5206\uff0c\u5b83\u662f\u7531\u5230\u76ee\u524d\u4e3a\u6b62\u6211\u4eec\u6240\u8ba8\u8bba\u7684\u591a\u79cd\u5143\u7d20\u7684\u7ec4\u5408\u6765\u5b8c\u6210\u6267\u884c\u7684\u3002\u9996\u5148\uff0c\u8f6f\u4ef6\u4e2d\u5fc5\u987b\u9009\u62e9\u9ad8\u4f18\u5148\u7ea7TC\uff0c\u5728\u786c\u4ef6\u4e2d\u914d\u7f6eVC\uff0c\u5e76\u5b9a\u4e49TC\u5230VC\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u4ee5\u6b64\u6765\u8ba9\u6b63\u786e\u7684\u6570\u636e\u5305\u653e\u5165\u9ad8\u4f18\u5148\u7ea7VC\u4e2d\u3002\u7136\u540e\uff0c\u671f\u671b\u7684\u7684\u65f6\u95f4\u89c4\u5212\u5176\u5b9e\u662f\u4e00\u4e2a\u4ef2\u88c1\u65b9\u6848\u89c4\u5212\u95ee\u9898\uff0c\u901a\u8fc7\u8fd9\u4e2a\u89c4\u5212\u6765\u9002\u914d\u7279\u5b9a\u65f6\u95f4\u5185\u6240\u9700\u8981\u7684\u5e26\u5bbd\u3002\u4f8b\u5982\uff0cVC\u4ef2\u88c1\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff0c\u56e0\u4e3a\u8fd9\u662f\u552f\u4e00\u53ef\u4ee5\u786e\u4fdd\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u4e0d\u4f1a\u88ab\u5176\u4ed6\u6570\u636e\u5305\u963b\u585e\u5ef6\u8fdf\u7684\u4ef2\u88c1\u65b9\u5f0f\u3002\u800c\u5bf9\u4e8e\u7aef\u53e3\u4ef2\u88c1\u5219\u5fc5\u987b\u662fTBWRR\uff0c\u8fd9\u6837\u624d\u80fd\u6267\u884c\u786e\u5b9a\u597d\u7684\u65f6\u95f4\u89c4\u5212\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#762-software-support","title":"7.6.2     \u8f6f\u4ef6\u652f\u6301\uff08Software Support\uff09","text":"<p>\u8981\u652f\u6301\u540c\u6b65\u7b49\u65f6\u670d\u52a1\uff0c\u8fd8\u9700\u8981\u7cfb\u7edf\u4e2d\u5404\u4e2a\u8f6f\u4ef6\u5143\u7d20\u4e4b\u95f4\u7684\u534f\u8c03\u5408\u4f5c\u3002\u5728\u4e00\u4e2aPC\u7cfb\u7edf\u4e2d\uff0c\u8bbe\u5907\u9a71\u52a8\u4f1a\u5411OS\uff08\u64cd\u4f5c\u7cfb\u7edf\uff09\u62a5\u544a\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u7684\u9700\u6c42\u548c\u80fd\u529b\uff08Capabilities\uff09\uff0cOS\u4f1a\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5bf9\u6574\u4e2a\u7cfb\u7edf\u7684\u9700\u6c42\u8fdb\u884c\u8bc4\u4f30\uff0c\u5e76\u4e3a\u7cfb\u7edf\u5206\u914d\u5408\u9002\u7684\u8d44\u6e90\u3002\u5d4c\u5165\u5f0f\u7cfb\u7edf\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u8fd9\u4e9b\u5404\u90e8\u5206\u7684\u4fe1\u606f\u5728\u4e00\u5f00\u59cb\u5c31\u662f\u5df2\u77e5\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684\u8f6f\u4ef6\u53ef\u4ee5\u66f4\u7b80\u5355\u4e00\u4e9b\u3002\u5728\u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u63cf\u8ff0PC\u7cfb\u7edf\u4e2d\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u5d4c\u5165\u5f0f\u7cfb\u7edf\u7684\u60c5\u51b5\u53ea\u662fPC\u60c5\u51b5\u4e2d\u66f4\u7b80\u5355\u7684\u4e00\u4e2a\u5b50\u96c6\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7621-device-drivers","title":"7.6.2.1   \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff08Device Drivers\uff09","text":"<p>\u4e00\u4e2a\u8bbe\u5907\u9a71\u52a8\u5fc5\u987b\u80fd\u591f\u5c06\u65f6\u95f4\u89c4\u5212\u7684\u9700\u6c42\u62a5\u544a\u7ed9\u7528\u4e8e\u76d1\u7763\u540c\u6b65\u7b49\u65f6\u64cd\u4f5c\u7684\u8f6f\u4ef6\uff0c\u5e76\u5728\u771f\u6b63\u5c1d\u8bd5\u53d1\u9001\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u6570\u636e\u5305\u4e4b\u524d\uff0c\u5148\u8981\u83b7\u5f97\u8fd9\u4e2a\u8f6f\u4ef6\u7684\u8bb8\u53ef\u3002\u9700\u8981\u6ce8\u610f\u7684\u91cd\u8981\u7684\u4e00\u70b9\u662f\uff0c\u9a71\u52a8\u7ea7\u8f6f\u4ef6\u4e0d\u5e94\u8be5\u81ea\u5df1\u76f4\u63a5\u6539\u53d8\u786c\u4ef6\u914d\u7f6e\u6216\u8005\u662f\u4ef2\u88c1\u7b56\u7565\uff0c\u5373\u4f7f\u5b83\u6709\u8fd9\u4e2a\u80fd\u529b\u4e5f\u4e0d\u884c\uff0c\u56e0\u4e3a\u8fd9\u5c06\u4f1a\u5f15\u8d77\u6df7\u4e71\u3002\u5982\u679c\u591a\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u90fd\u5404\u81ea\u72ec\u7acb\u7684\u5c1d\u8bd5\u66f4\u6539\u786c\u4ef6\u914d\u7f6e\u6216\u4ef2\u88c1\u7b56\u7565\uff0c\u90a3\u4e48\u6700\u540e\u8fdb\u884c\u66f4\u6539\u64cd\u4f5c\u7684\u9a71\u52a8\u7a0b\u5e8f\u5c06\u4f1a\u628a\u4e4b\u524d\u7684\u66f4\u6539\u90fd\u8986\u76d6\u6389\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e00\u79cd\u88ab\u79f0\u4e3a\u540c\u6b65\u7b49\u65f6\u4ee3\u7406\uff08Isochronous Broker\uff09\u7684OS\u7ea7\u7a0b\u5e8f\u5c06\u4f1a\u63a5\u6536\u6765\u81ea\u7cfb\u7edf\u8bbe\u5907\u7684\u65f6\u95f4\u89c4\u5212\u8bf7\u6c42\uff0c\u5e76\u4ee5\u4e00\u79cd\u534f\u8c03\u7684\u65b9\u5f0f\u6765\u5206\u914d\u7cfb\u7edf\u8d44\u6e90\uff0c\u4ee5\u6b64\u6765\u9002\u914d\u6240\u6709\u7684\u8fd9\u4e9b\u8bf7\u6c42\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7622-isochronous-broker","title":"7.6.2.2   \u540c\u6b65\u7b49\u65f6\u4ee3\u7406\uff08Isochronous Broker\uff09","text":"<p>\u8fd9\u79cd\u7a0b\u5e8f\u7528\u6765\u7ba1\u7406\u7aef\u5230\u7aef\u7684\u540c\u6b65\u7b49\u65f6\u6570\u636e\u5305\u6d41\u3002\u5b83\u4ece\u8bbe\u5907\u9a71\u52a8\u63a5\u6536\u5230\u540c\u6b65\u7b49\u65f6\u65f6\u95f4\u89c4\u5212\u8bf7\u6c42\uff0c\u7528\u4e00\u79cd\u80fd\u9002\u914d\u76ee\u6807\u8def\u5f84\u4e0a\u7684\u5404\u4e2a\u8bf7\u6c42\u7684\u65b9\u5f0f\uff0c\u6765\u534f\u8c03\u5206\u914d\u7cfb\u7edf\u8d44\u6e90\u3002\u5728\u534f\u8bae\u89c4\u8303\u4e2d\uff0c\u8fd9\u88ab\u79f0\u4e3a\u201c\u5728\u4e00\u5bf9Requester/Completer\uff08\u8bf7\u6c42\u8005/\u5b8c\u6210\u8005\uff09\u548cPCIe\u7ed3\u6784\u4e4b\u95f4\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u540c\u6b65\u7b49\u65f6\u5951\u7ea6\uff08Isochronous Contract\uff09\u201d\u3002\u8981\u505a\u5230\u8fd9\u4e9b\uff0c\u9700\u8981\u786e\u5b9a\u671f\u671b\u7684\u8def\u5f84\u4e0a\u786e\u5b9e\u53ef\u4ee5\u652f\u6301\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff0c\u7136\u540e\u5c31\u7f16\u7a0b\u5199\u5165\u5408\u9002\u7684\u4ef2\u88c1\u65b9\u6848\uff0c\u4ee5\u786e\u4fdd\u5b83\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u89c4\u5212\u8981\u6c42\u4e0b\u5de5\u4f5c\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#763-bringing-it-all-together","title":"7.6.3     \u5c06\u4e00\u5207\u7ed3\u5408\u8d77\u6765\uff08Bringing it all together\uff09","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5e94\u8be5\u5df2\u7ecf\u76f8\u5f53\u6e05\u695a\u9700\u8981\u505a\u4e9b\u4ec0\u4e48\u6765\u652f\u6301\u7cfb\u7edf\u4e2d\u7684\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff0c\u4f46\u662f\u8ba9\u6211\u4eec\u6765\u770b\u6700\u540e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u5c06\u4f1a\u628a\u4e4b\u524d\u7684\u5404\u4e2a\u5185\u5bb9\u90e8\u5206\u5168\u90fd\u7ed3\u5408\u8d77\u6765\u3002\u5982\u679c\u6211\u4eec\u7ee7\u7eed\u5bf9\u6b64\u524d\u7684\u89c6\u9891\u6355\u6349\u793a\u4f8b\u8fdb\u884c\u5c55\u5f00\u8be6\u8ff0\uff0c\u4ee5\u6b64\u6765\u5c55\u793a\u4e00\u4e2a\u66f4\u52a0\u590d\u6742\u7684\u7cfb\u7edf\uff0c\u5982\u56fe 7\u201124\u6240\u793a\u7684\u7cfb\u7edf\uff0c\u5f53\u6444\u50cf\u673a\u53ef\u4ee5\u628a\u6355\u6349\u5230\u7684\u89c6\u9891\u6570\u636e\u4f20\u9001\u81f3\u7cfb\u7edf\u5b58\u50a8\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u57fa\u4e8e\u5b83\u6765\u8ba8\u8bba\u8fd9\u4e2a\u7cfb\u7edf\u4e2d\u6240\u5fc5\u9700\u7684\u6bcf\u4e2a\u90e8\u5206\u3002\u8fd9\u5bf9\u4e8e\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u6765\u8bf4\u662f\u4e00\u4e2a\u6bd4\u8f83\u56f0\u96be\u7684\u7cfb\u7edf\u73af\u5883\uff0c\u56e0\u4e3a\u7cfb\u7edf\u4e2d\u5b58\u5728\u8bb8\u591a\u9700\u8981\u7ade\u4e89\u8def\u5f84\u4e0a\u7684\u5e26\u5bbd\u7684\u8bbe\u5907\uff0c\u4f46\u662f\u8fd9\u4e5f\u4f7f\u5f97\u8fd9\u4e2a\u4f8b\u5b50\u975e\u5e38\u9002\u5408\u7528\u6765\u8bb2\u89e3\u8fd9\u4e9b\u8fc7\u7a0b\u4e2d\u9700\u8981\u8003\u8651\u7684\u65b9\u65b9\u9762\u9762\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7631-endpoints","title":"7.6.3.1   Endpoints","text":"<p>\u8ba9\u6211\u4eec\u4ece\u7cfb\u7edf\u7684\u6700\u5e95\u90e8\u5f00\u59cb\uff0c\u5bf9\u4e8e\u5f55\u50cfEP\u8bbe\u5907\u672c\u8eab\uff0c\u5b83\u7684PCIe\u63a5\u53e3\u4e2d\u9700\u8981\u6709\u4ec0\u4e48\uff1f\u5728\u786c\u4ef6\u4e2d\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u533a\u522b\u4e0d\u540c\u7684\u6570\u636e\u5305\uff0c\u90a3\u4e48\u5c31\u9700\u89811\u4e2a\u4ee5\u4e0a\u7684VC\u3002\u4e3a\u4e86\u7b80\u5316\u4f8b\u5b50\uff0c\u6211\u4eec\u5047\u8bbe\u8fd9\u4e2a\u8bbe\u5907\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u9700\u8981\u5411OS\u7ea7\u7684\u540c\u6b65\u7b49\u65f6\u4ee3\u7406\u7a0b\u5e8f\u62a5\u544a\u8bbe\u5907\u7684\u80fd\u529b\uff08Capabilities\uff09\u548c\u540c\u6b65\u7b49\u65f6\u65f6\u95f4\u89c4\u5212\u9700\u6c42\uff0c\u540c\u6b65\u7b49\u65f6\u4ee3\u7406\u7a0b\u5e8f\u5c06\u4f1a\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5bf9\u7cfb\u7edf\u8fdb\u884c\u8bc4\u4f30\uff0c\u5e76\u5411\u8bbe\u5907\u9a71\u52a8\u62a5\u544a\u662f\u5426\u53ef\u80fd\u5efa\u7acb\u540c\u6b65\u7b49\u65f6\u5951\u7ea6\u4ee5\u53ca\u8f6f\u4ef6\u5e94\u8be5\u4f7f\u7528\u54ea\u4e9bTC\u3002</p> <p>\u9a71\u52a8\u7a0b\u5e8f\u5219\u5c06\u4f1a\u5c06\u5bf9VC\u7684\u7f16\u53f7\u548c\u6570\u91cf\u8fdb\u884c\u7f16\u7a0b\u5199\u5165\uff0c\u5e76\u5c06\u76f8\u5e94\u7684TC\u6620\u5c04\u81f3\u5404VC\u3002\u5b83\u4e5f\u5f88\u6709\u53ef\u80fd\u4f1a\u5c06\u9ad8\u4f18\u5148\u7ea7\u901a\u9053\u7684VC\u4ef2\u88c1\u7f16\u7a0b\u4e3a\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff08Strict Priority\uff09\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4ef2\u88c1\u5fc5\u987b\u8981\u662f\u201c\u516c\u5e73\u7684\u201d\uff0c\u610f\u601d\u662f\u90a3\u4e9b\u4f4e\u4f18\u5148\u7ea7\u901a\u9053\u4e0d\u80fd\u51fa\u73b0\u8bbf\u95ee\u673a\u4f1a\u532e\u4e4f\uff08Starve\uff09\u3002\u8fd9\u610f\u5473\u7740\u90a3\u4e9b\u9ad8\u4f18\u5148\u7ea7VC\u4e0d\u80fd\u4e00\u76f4\u5360\u7528\u4ef2\u88c1\u8ba9\u81ea\u5df1\u7684\u6d41\u91cf\u5904\u4e8e\u5f85\u53d1\u9001\u72b6\u6001\uff0c\u800c\u662f\u8981\u968f\u65f6\u95f4\u5206\u6279\u7684\u4f20\u8f93\u6570\u636e\u5305\u3002</p> <p>\u5728\u7ed3\u675f\u5bf9EP\u7684\u8ba8\u8bba\u4e4b\u524d\uff0c\u8fd8\u9700\u8981\u6ce8\u610f\u5173\u4e8e\u94fe\u8def\u64cd\u4f5c\u7684\u53e6\u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u6d41\u91cf\u63a7\u5236\u3002\u8bbe\u5907\u5728\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7684\u63a5\u6536Buffer\u5fc5\u987b\u8981\u8db3\u591f\u5927\uff0c\u53ea\u8981\u6570\u636e\u5305\u662f\u6309\u7167\u540c\u6b65\u7b49\u65f6\u5951\u7ea6\uff08Isochronous Contract\uff09\u5747\u5300\u7684\u8f93\u5165\uff0c\u90a3\u4e48\u8fd9\u4e2aBuffer\u5c31\u8981\u5927\u5230\u5728\u4e0d\u9700\u8981\u4efb\u4f55\u53cd\u538b\u7684\u60c5\u51b5\u4e0b\u80fd\u591f\u5904\u7406\u9884\u671f\u7684\u8f93\u5165\u6570\u636e\u5305\u6d41\u3002\u6b64\u5916\uff0c\u6d41\u63a7\u66f4\u65b0DLLP\uff08Flow Control Update\uff09\u7684\u8fd4\u56de\u901f\u5ea6\u5fc5\u987b\u8db3\u591f\u5feb\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u4f20\u8f93\u505c\u6ede\u3002</p> <p></p> <p>\u56fe 7\u201124\u540c\u6b65\u7b49\u65f6\u7cfb\u7edf\u793a\u4f8b</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7632-switches","title":"7.6.3.2   Switches","text":"<p>\u5728\u8ba8\u8bba\u4e86EP\u4e4b\u540e\uff0c\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u5728EP\u4e0eRC\u4e4b\u95f4\u7684Switch\u4e2d\u9700\u8981\u63d0\u4f9b\u4ec0\u4e48\u3002Switch\u901a\u5e38\u662f\u6ca1\u6709\u81ea\u5df1\u7684\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u7684\uff0c\u6240\u4ee5\u53ea\u80fd\u7531OS\u7ea7\u8f6f\u4ef6\uff08\u5982\u540c\u6b65\u7b49\u65f6\u4ee3\u7406Isochronous Broker\uff09\u6765\u8bfb\u53d6\u5b83\u4eec\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u8fd9\u4e9bSwitch\u80fd\u652f\u6301\u600e\u6837\u7684\u670d\u52a1\u3002\u9996\u5148\uff0c\u5728\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7684\u6240\u6709\u7aef\u53e3\u90fd\u5fc5\u987b\u8981\u652f\u6301\u81f3\u5c112\u4e2aVC\uff0c\u4e14\u94fe\u8def\u4e24\u7aef\u7684TC/VC\u6620\u5c04\u5173\u7cfb\u4e5f\u5fc5\u987b\u662f\u76f8\u5339\u914d\u7684\u3002\u8981\u8bb0\u4f4f\uff0c\u4e00\u65e6\u6570\u636e\u5305\u5230\u8fbe\u4e86Switch\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\uff0c\u90a3\u4e48\u6570\u636e\u5305\u91cc\u53ea\u6709TC\u4fe1\u606f\u800c\u6ca1\u6709VC\u4fe1\u606f\uff0cTC\u5177\u4f53\u5bf9\u5e94\u54ea\u4e2aVC\u662f\u6bcf\u4e2a\u7aef\u53e3\u81ea\u5df1\u6307\u5b9a\u7684\u800c\u4e0d\u4f1a\u5c06\u8fd9\u4e2a\u4fe1\u606f\u643a\u5e26\u5728TLP\u4e2d\u3002Switch 1\u7684\u4e0b\u884c\u7aef\u53e3\u4e0e\u5b83\u4e0b\u65b9\u8fde\u63a5\u7684EP\u7684\u5404\u81eaTC/VC\u6620\u5c04\u5173\u7cfb\u5fc5\u987b\u8981\u76f8\u5339\u914d\uff0c\u4f46\u662f\u81f3\u4e8e\u5176\u4ed6\u7684Switch\u7aef\u53e3\u53ef\u4ee5\u662f\u4e0d\u540c\u7684\u4ee5\u6b64\u6765\u5339\u914d\u5b83\u4eec\u5404\u81ea\u94fe\u8def\u4e0a\u7684EP\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#l-arbitration-issues","title":"l \u4ef2\u88c1\u95ee\u9898\uff08Arbitration Issues\uff09","text":"<p>\u4ef2\u88c1\u65b9\u6cd5\u7684\u9009\u62e9\u662f\u5f88\u76f4\u63a5\u7684\u3002\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u7684\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u627f\u8f7d\u7684\u6d41\u91cf\u662f\u5355\u5411\u7684\u3002\u5bf9\u4e8e\u5728\u5b58\u50a8\u5668\u8bfb\u53d6\u64cd\u4f5c\u4e2d\uff0c\u5176\u5b9e\u662f\u6709\u53ef\u80fd\u51fa\u73b0\u53cc\u5411\u7684\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\u7684\uff0c\u4f46\u662f\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u9009\u53d6\u7684\u662f\u7c7b\u4f3c\u89c6\u9891\u6d41\u7684\u60c5\u51b5\u3002</p> <p>\u540c\u6b65\u7b49\u65f6\u51fa\u53e3\u7aef\u53e3\u4f7f\u7528\u7684VC\u4ef2\u88c1\u901a\u5e38\u662f\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\uff0c\u539f\u56e0\u4e0eEP\u76f8\u540c\u3002\u7aef\u53e3\u4ef2\u88c1\u5219\u5c06\u4f1a\u4f7f\u7528TBWRR\u65b9\u6848\uff0c\u8fd9\u610f\u5473\u7740\u8f6f\u4ef6\u5fc5\u987b\u4e86\u89e3\u9002\u5f53\u7684\u8bbf\u95ee\u6bd4\u7387\uff0c\u5e76\u5c06\u7aef\u53e3\u4ef2\u88c1\u8868\uff08Port Arbitration Table\uff09\u7f16\u7a0b\u5199\u5165\uff0c\u4ee5\u6b64\u6765\u5b9e\u73b0\u8fd9\u79cd\u7aef\u53e3\u7684\u8bbf\u95ee\u6bd4\u7387\u3002\u5982\u679c\u8def\u5f84\u4e2d\u6709\u591a\u4e2aSwitch\uff0c\u90a3\u4e48\u8981\u505a\u5230\u8fd9\u4e00\u7cfb\u5217\u4e8b\u60c5\u53ef\u80fd\u5e76\u4e0d\u662f\u542c\u8d77\u6765\u7684\u90a3\u4e48\u7b80\u5355\uff0c\u56e0\u4e3a\u5373\u4f7f\u4ed6\u4eec\u4f7f\u7528\u7684\u90fd\u662f\u76f8\u540c\u7684TBWRR\u4ef2\u88c1\u65b9\u6848\uff0c\u4e5f\u65e0\u6cd5\u5f88\u6e05\u6670\u7684\u77e5\u9053\u5b83\u4eec\u5404\u81ea\u7684\u670d\u52a1\u95f4\u9694\uff08service interval\uff0cSI\uff09\u662f\u5982\u4f55\u534f\u540c\u5de5\u4f5c\u7684\u3002\u5982\u679c\u51e0\u4e2aSwitch\u7684SI\u4e4b\u95f4\u5e76\u672a\u5bf9\u9f50\uff0c\u90a3\u4e48\u5c31\u610f\u5473\u7740\u7b49\u65f6\u7684\u65f6\u95f4\u89c4\u5212\u66f4\u52a0\u96be\u4ee5\u5b9e\u73b0\uff0c\u8fd9\u5c06\u53d6\u51b3\u4e8e\u94fe\u8def\u7684\u7e41\u5fd9\u7a0b\u5ea6\u3002\u4f46\u662f\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u8003\u8651SI\u4e4b\u95f4\u7684\u534f\u8c03\u5408\u4f5c\uff0c\u56e0\u6b64\u8fd9\u91cc\u5c31\u5c06\u518d\u6b21\u6d89\u53ca\u5230\u4e00\u4e2a\u975e\u6807\u51c6\u65b9\u6cd5\u3002\u663e\u7136\uff0c\u5982\u679c\u5728\u4e00\u4e2a\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u5e76\u4e0d\u5b58\u5728\u591a\u4e2aSwitch\u800c\u53ea\u67091\u4e2a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u5c06\u4f1a\u88ab\u5927\u5927\u7b80\u5316\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#l-timing-issues","title":"l \u65f6\u95f4\u89c4\u5212\u95ee\u9898\uff08Timing Issues\uff09","text":"<p>\u56fe 7\u201125\u5c55\u793a\u4e86\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u6570\u636e\u5305\u5728\u4e24\u4e2aEP\u95f4\u4f20\u9001\u7684\u65f6\u95f4\u70b9\u3002\u7c97\u7ebf\u6761\u7684\u5927\u7bad\u5934\u662f\u6765\u81ea\u89c6\u9891\u8bbe\u5907\u7684\u6570\u636e\u5305\uff0c\u5b83\u5177\u6709\u5df2\u77e5\u786e\u5b9a\u7684\u5927\u5c0f\uff0c\u5e76\u6309\u7167\u5468\u671f\u6027\u7684\u3001\u786e\u5b9a\u6027\u95f4\u9694\u7684\u8fdb\u884c\u53d1\u9001\u3002\u7ec6\u7ebf\u6761\u7684\u5c0f\u7bad\u5934\u5219\u662f\u4ee3\u8868\u6765\u81eaSCSI\u9a71\u52a8\u5668\u7684\u6570\u636e\u5305\uff0c\u5b83\u5177\u6709\u8f83\u4f4e\u7684\u4f18\u5148\u7ea7\u4e14\u53d1\u9001\u65f6\u95f4\u70b9\u662f\u4e0d\u53ef\u9884\u77e5\u7684\u3002\u5728EP\u4e2d\uff0c\u6570\u636e\u5305\u53ea\u9700\u8981\u7b80\u5355\u7684\u542b\u6709TC\u5373\u53ef\uff0c\u4f46\u662fSwitch\u8fd8\u9700\u8981\u786e\u8ba4\u6267\u884c\u4e86\u5408\u9002\u7684\u65f6\u95f4\u89c4\u5212\u65b9\u6848\u3002\u8fd9\u662f\u901a\u8fc7\u4f7f\u7528TBWRR\u6765\u5b8c\u6210\u7684\uff0c\u5b83\u5c06\u4f1a\u6307\u5b9a\u5728\u4e00\u4e2a\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\u4e0a\uff0c\u54ea\u4e2a\u7aef\u53e3\u53ef\u4ee5\u8fdb\u884c\u8bbf\u95ee\uff0c\u4ee5\u53ca\u8bbf\u95ee\u65f6\u95f4\u6709\u591a\u957f\u3002\u7531\u4e8e\u77e5\u9053\u540c\u6b65\u7b49\u65f6\u6570\u636e\u5305\u7684\u5927\u5c0f\u4ee5\u53ca\u4f20\u9001\u9891\u7387\uff0c\u8fd9\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u6b63\u786e\u7684\u5b89\u6392\u65f6\u95f4\u89c4\u5212\uff0c\u4f46\u662f\u4ec0\u4e48\u6837\u7684\u65f6\u95f4\u89c4\u5212\u624d\u662f\u6211\u4eec\u9700\u8981\u7684\u5462\uff1f</p> <p></p> <p>\u56fe 7\u201125\u540c\u6b65\u7b49\u65f6\u6570\u636e\u5305\u7684\u6ce8\u5165</p> <p>\u9996\u5148\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u6765\u56de\u987e\u4e00\u4e0b\u9700\u8981\u6d89\u53ca\u5230\u7684\u53c2\u6570\u3002\u56de\u5fc6\u4e00\u4e0b\uff0cPCIe\u4e2d\u57fa\u4e8e\u53c2\u8003\u65f6\u949f\u5468\u671f\u5b9a\u4e49\u4e86\u65f6\u9699\uff08time slot\uff09\uff0c\u800c\u65f6\u9699\u7684\u957f\u5ea6\u662f\u7531\u7aef\u53e3\u80fd\u529b\u5bc4\u5b58\u56681\uff08Port Capability Register 1\uff09\u4e2d\u7684\u53c2\u8003\u65f6\u949f\u5b57\u6bb5\uff08Reference Clock\uff09\u6240\u7ed9\u5b9a\u7684\u3002\u76ee\u524d\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u53ea\u80fd\u662f100ns\uff0c\u5e76\u4e14TBWRR\u4ef2\u88c1\u8868\u53ea\u80fd\u662f128\u4e2a\u6761\u76ee\u7684\u5927\u5c0f\u3002\u670d\u52a1\u95f4\u9694\uff08Service Interval\uff0cSI\uff09\u7684\u957f\u5ea6\u5c31\u662f\u5b83\u4eec\u7684\u4e58\u79ef\uff0c\u4e5f\u5c31\u662f12.8us\u3002\u4e00\u4e2a\u7ed9\u5b9a\u8bbe\u5907\u7684\u5e26\u5bbd\u53ef\u4ee5\u7528\u4e0b\u9762\u7ed9\u51fa\u7684\u516c\u5f0f\u6765\u8868\u8fbe\uff0c\u5176\u4e2dY\u8868\u793a1\u4e2a\u65f6\u9699\u4e2d\u5c06\u8981\u53d1\u9001\u7684\u6570\u636e\u91cf\uff08\u534f\u8bae\u89c4\u8303\u4e2d\u58f0\u660e\uff0c\u5fc5\u987b\u8981\u5c06\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u7f16\u7a0b\u5199\u5165\u7684Max Payload Size\u503c\u7528\u4e8e\u8fd9\u4e2a\u5e26\u5bbd\u7684\u8ba1\u7b97\u4e2d\uff0c\u4e5f\u5c31\u662f\u5148\u5047\u8bbe1\u4e2a\u65f6\u9699\u5c31\u80fd\u4f20\u8f931\u4e2a\u6570\u636e\u5305\uff09\uff0cM\u8868\u793a\u7684\u662f\u65f6\u9699\u7684\u6570\u91cf\uff0cT\u8868\u793a\u6574\u4e2aSI\u957f\u5ea6\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u9009\u62e9Payload\u4e3a128Byte\uff0c\u53c8\u5df2\u77e5SI\u4e3a12.8us\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5206\u914d\u7684\u6bcf\u4e2a\u65f6\u9699\u6765\u8bf4\uff0cBW=10MB/s\u3002</p> <p></p> <p>\u73b0\u5728\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u66f4\u8d34\u8fd1\u5b9e\u9645\u7684\u4f8b\u5b50\u3002\u5047\u8bbe\u94fe\u8def\u5de5\u4f5c\u5728Gen2\u7684\u901f\u7387\uff0c\u89c6\u9891\u8bbe\u5907\u9700\u8981\u4fdd\u8bc1\u6709100MB/s\u7684\u5e26\u5bbd\uff0c\u4e14\u5b83\u5c06\u4f1a\u53d1\u9001\u6570\u636e\u8377\u8f7d\u4e3a512Byte\u7684\u6570\u636e\u5305\uff0c\u6211\u4eec\u5148\u5047\u8bbe1\u4e2a\u65f6\u9699\u5c31\u80fd\u53d1\u90011\u4e2a\u6570\u636e\u5305\uff0c\u4ee3\u5165\u516c\u5f0f\u4e2d\u5f97\u5230M=2.5\uff0c\u4e5f\u5c31\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8981\u57281\u4e2aSI\u4e2d\u53d1\u90012.5\u4e2a512Byte\u6570\u636e\u5305\u3002</p> <p></p> <p>\u4f46\u662f\u5b9e\u9645\u4e0a1\u4e2a\u65f6\u9699\u4e2d\u53ef\u4ee5\u4f20\u8f93\u591a\u5c11\u6570\u636e\u5462\uff1f\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u5f53\u7136\u4e0e\u94fe\u8def\u901f\u7387\u4ee5\u53ca\u94fe\u8def\u5bbd\u5ea6\u6709\u5173\u3002\u57285.0Gb/s\u7684\u901f\u7387\u4e0b\uff0c\u6bcf\u53d1\u90011\u4e2a10bit\u7b26\u53f7\u5c31\u9700\u89812ns\uff0c\u56e0\u6b64\u5728\u6bcf\u4e2a\u540c\u9053\u4e2d100ns\u5219\u53ef\u4ee5\u4f20\u8f9350\u4e2a\u7b26\u53f7\u3002\u5982\u679c\u6570\u636e\u5305\u7684\u5927\u5c0f\u662f512Byte\u518d\u52a0\u4e0a28Byte\u5de6\u53f3\u7684Header\uff0c\u90a3\u4e48\u4f7f\u7528x1\u94fe\u8def\u4f20\u8f93\u5927\u5c0f\u4e3a550\u4e2a\u7b26\u53f7\u7684\u6570\u636e\u5305\u5219\u9700\u898111\u4e2a\u65f6\u9699\u3002\u5728\u6709\u9700\u8981\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u8ba9\u540c\u4e00\u4e2a\u7aef\u53e3\u5f97\u5230\u8fde\u7eed\u7684\u591a\u4e2a\u65f6\u9699\uff0c\u8fd9\u662f\u4e00\u79cd\u89e3\u51b3\u529e\u6cd5\u3002\u7531\u4e8e\u5c06\u8981\u53d1\u9001\u7684\u6570\u636e\u5305\u7684\u5927\u5c0f\u662f\u786e\u5b9a\u4e00\u81f4\u7684\uff0c\u6211\u4eec\u4e0d\u80fd\u771f\u7684\u5c31\u5c06M\u5b9a\u4e3a2.5\u4e2a512Byte\uff0c\u800c\u662f\u5e94\u8be5\u5c06\u5176\u5b9a\u4e3a3\u3002\u5bf9\u4e8e\u6211\u4eec\u7684\u516c\u5f0f\u6765\u8bf4\uff0c\u57281\u4e2aSI\u4e2d\u53d1\u90013\u4e2a512Byte\u7684\u5e26\u5bbd\u5b9e\u9645\u4e0a\u662f120MB/s\u3002\u8fd9\u867d\u7136\u9ad8\u4e8e\u6211\u4eec\u7684\u9700\u6c42\u5e26\u5bbd\uff0c\u4f46\u662f\u786e\u5b9e\u89e3\u51b3\u4e86\u6211\u4eec\u7684\u95ee\u9898\u3002\u7531\u4e8e\u521a\u624d\u8ba1\u7b97\u8fc7\u4f20\u8f93550\u4e2a\u7b26\u53f7\u9700\u898111\u4e2a\u65f6\u9699\uff0c\u90a3\u4e48\u4f20\u8f933\u4e2a\u5c31\u9700\u898111\u00d73=33\u4e2a\u65f6\u9699\uff0c\u57281\u4e2aSI\u4e2d\u8fd8\u7559\u670995\u4e2a\u65f6\u9699\u7528\u4f5c\u5b83\u7528\u3002\u57281\u4e2aSI\u4e2d\u76843\u4e2a\u65f6\u9699\u7ec4\uff08\u6bcf\u7ec411\u4e2a\uff09\u4e2d\uff0c\u6bcf\u4e00\u7ec4\u5185\u768411\u4e2a\u65f6\u9699\u5fc5\u987b\u662f\u8fde\u7eed\u76f8\u90bb\u7684\uff0c\u4f46\u662f\u7ec4\u4e0e\u7ec4\u4e4b\u95f4\u53ef\u4ee5\u662f\u5206\u5f00\u7684\u3002</p> <p>\u53e6\u5916\u4e00\u4e2a\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u589e\u52a0\u94fe\u8def\u5bbd\u5ea6\u3002\u5c3d\u7ba1\u8fd9\u6837\u7684\u89e3\u51b3\u529e\u6cd5\u4f1a\u589e\u52a0\u786c\u4ef6\u5f00\u9500\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u752811\u901a\u9053\u7684\u94fe\u8def\u5219\u53ef\u4ee5\u771f\u6b63\u7684\u57281\u4e2a\u65f6\u9699\u5185\u5b8c\u6210\u9700\u8981\u7684\u6570\u636e\u7684\u53d1\u9001\u4f46\u662f\u5728CEM\u534f\u8bae\u89c4\u8303\u4e2d\uff08PCIe Card Electromechanical Spec \uff0cPCIe\u5361Spec\uff09\uff0c\u5e76\u6ca1\u6709x11\u7684\u9009\u9879\uff0c\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528\u5176\u4e2d\u7684x12\u9009\u9879\u6765\u5e94\u7528\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u3002\u4f7f\u7528\u66f4\u5bbd\u7684\u94fe\u8def\u610f\u5473\u7740\u8f6f\u4ef6\u53ea\u9700\u8981\u4e3a\u6bcf\u4e2a\u6570\u636e\u5305\u5206\u914d1\u4e2a\u65f6\u9699\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u57281\u4e2aSI\u4e2d\u5206\u914d3\u4e2a\u65f6\u9699\uff0c\u5373\u53ef\u6ee1\u8db3\u672c\u4f8b\u5b50\u4e2d\u8bbe\u5907\u7684\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\u5e26\u5bbd\u9700\u6c42\u3002\u4e0ex1\u7684\u60c5\u51b5\u4e0d\u540c\uff0c\u73b0\u5728\u6211\u4eec\u4e0d\u9700\u8981\u8ba9\u5206\u914d\u7684\u65f6\u9699\u8fde\u7eed\u76f8\u90bb\u3002\u76f8\u53cd\u5730\uff0c\u5b83\u4eec\u53ef\u4ee5\u4ee5\u67d0\u79cd\u66f4\u4f18\u7684\u65b9\u5f0f\u5206\u6563\u5728SI\u4e2d\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#l-bandwidth-allocation-problems","title":"l \u5e26\u5bbd\u5206\u914d\u95ee\u9898\uff08Bandwidth Allocation Problems\uff09","text":"<p>\u5bf9\u4e8e\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\u6765\u8bf4\uff0c\u5fc5\u987b\u8981\u8bbe\u8ba1\u597dTBWRR\u4ef2\u88c1\u8868\u6765\u4fdd\u8bc1\u6709\u8db3\u591f\u7684\u53ca\u65f6\u7684\u5e26\u5bbd\uff0c\u5e76\u4e14\u8fd9\u90e8\u5206\u5e26\u5bbd\u4e0d\u4f1a\u88ab\u5176\u4ed6\u6d41\u91cf\u6240\u5f71\u54cd\u3002\u5982\u56fe 7\u201125\u4e2d\u6240\u793a\uff0cSCSI\u63a7\u5236\u5668\u5728SI 1\u4e2d\u53d1\u9001\u4e861\u4e2a\u6570\u636e\u5305\uff0c\u5728SI 3\u4e2d\u53d1\u9001\u4e86\u53e6\u4e00\u4e2a\u6570\u636e\u5305\u3002\u5982\u679c\u65f6\u95f4\u89c4\u5212\u5c31\u6309\u7167\u8fd9\u6837\uff0c\u5141\u8bb8EP\u6bcf\u4e2aSI\u53d1\u90011\u4e2a\u6570\u636e\u5305\uff0c\u90a3\u4e48\u8fd9\u6837\u7684\u65b9\u5f0f\u662f\u53ef\u884c\u7684\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5047\u8bbeSCSI\u63a7\u5236\u5668\u5c1d\u8bd5\u53d1\u9001\u66f4\u591a\u7684\u6570\u636e\u5305\uff0c\u5176\u6570\u91cf\u5df2\u7ecf\u8d85\u8fc7\u4e86SI 1\u5bf9\u5b83\u7684\u8bb8\u53ef\u6570\u91cf\uff0c\u5982\u56fe 7\u201126\u6240\u793a\u3002\u8fd9\u662f\u534f\u8bae\u89c4\u8303\u4e2d\u63d0\u5230\u7684\u4e24\u4e2a\u5e26\u5bbd\u5206\u914d\u95ee\u9898\u4e2d\u7684\u7b2c\u4e00\u4e2a\uff0c\u5b83\u88ab\u79f0\u4e3a\u201c\u8fc7\u8f7d\uff08oversubscription\uff09\u201d\u3002\u8fd9\u5c06\u4f1a\u5f71\u54cd\u5230\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff0c\u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u5408\u7406\u7684\u89c4\u5212TBWRR\u4ef2\u88c1\u8868\u5c31\u80fd\u6bd4\u8f83\u5bb9\u6613\u7684\u907f\u514d\uff0c\u56e0\u4e3a\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u65f6\u95f4\u70b9\u4e0b\uff0c\u53ea\u6709\u88ab\u4ef2\u88c1\u9009\u4e2d\u7684\u7aef\u53e3\u53ef\u4ee5\u53d1\u9001\u6570\u636e\u5305\u3002\u5982\u679c\u8fd9\u4e2a\u7aef\u53e3\u5728\u53d1\u9001\u5b8c\u4ef2\u88c1\u8bb8\u53ef\u7684\u6570\u636e\u5305\u540e\u4f9d\u7136\u6709\u5f88\u591a\u6570\u636e\u5305\u5728\u961f\u5217\u4e2d\u7b49\u5f85\u53d1\u9001\uff0c\u90a3\u4e48\u5b83\u4e5f\u9700\u8981\u7b49\u5230\u4e0b\u4e00\u6b21\u88ab\u4ef2\u88c1\u9009\u4e2d\u624d\u80fd\u7ee7\u7eed\u53d1\u9001\u540e\u7eed\u7684\u90e8\u5206\u6570\u636e\u5305\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u4e5f\u5c31\u662fSCSI\u63a7\u5236\u5668\u60f3\u5728SI 1\u4e2d\u591a\u53d1\u9001\u7684\u90a3\u4e00\u4e2a\u6570\u636e\u5305\u5b9e\u9645\u4e0a\u53ef\u80fd\u4f1a\u653e\u5230SI 2\u4e2d\u53bb\u53d1\u9001\u3002\u6700\u7ec8\uff0c\u8fd9\u79cd\u201c\u8fc7\u8f7d\u201d\u4f1a\u5bfc\u81f4\u53d1\u9001\u5904\u7684\u6d41\u63a7\u53cd\u538b\u3002</p> <p></p> <p>\u56fe 7\u201126\u8d85\u989d\u4f7f\u7528\u5e26\u5bbd</p> <p>\u7b2c\u4e8c\u4e2a\u95ee\u9898\u88ab\u79f0\u4e3a\u201c\u62e5\u585e\uff08congestion\uff09\u201d\uff0c\u5f53\u5728\u4e00\u4e2a\u7ed9\u5b9a\u7684\u65f6\u95f4\u7a97\u53e3\u5185\u5b58\u5728\u4e86\u592a\u591a\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u8bf7\u6c42\u65f6\uff0c\u5c31\u6709\u53ef\u80fd\u4f1a\u53d1\u751f\u8fd9\u79cd\u95ee\u9898\uff0c\u5982\u56fe 7\u201127\u6240\u793a\u3002\u8fd9\u4e2a\u95ee\u9898\u548c\u7b2c\u4e00\u4e2a\u6709\u70b9\u76f8\u4f3c\uff0c\u4f46\u662f\u5b83\u662f\u65e0\u6cd5\u90a3\u4e48\u7b80\u5355\u5c31\u89e3\u51b3\u7684\u3002\u4e0e\u4e4b\u524d\u7684\u60c5\u51b5\u4e0d\u540c\uff0c\u8fd9\u91cc\u4e0d\u80fd\u5c06\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u63a8\u8fdf\u5230\u4e0b\u4e00\u4e2a\u65f6\u9699\u53d1\u9001\uff0c\u56e0\u6b64\u7cfb\u7edf\u5fc5\u987b\u8981\u6709\u529e\u6cd5\u6765\u5904\u7406\u5168\u90e8\u7684\u8fd9\u4e9b\u8bf7\u6c42\u3002\u8981\u7ea0\u6b63\u62e5\u585e\u7684\u95ee\u9898\uff0c\u8f6f\u4ef6\u9700\u8981\u6539\u53d8\u53d1\u9001\u6570\u636e\u5305\u65f6\u95f4\u70b9\u7684\u5206\u5e03\uff0c\u4ee5\u4fbf\u5b83\u4eec\u90fd\u80fd\u591f\u5f97\u5230\u53ef\u7528\u786c\u4ef6\u5e26\u5bbd\u7684\u652f\u6301\u3002</p> <p></p> <p>\u56fe 7\u201127\u5e26\u5bbd\u62e5\u585e</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#l-latency-issues","title":"l \u5ef6\u65f6\u95ee\u9898\uff08Latency Issues\uff09","text":"<p>\u7ba1\u7406\u6570\u636e\u5305\u53d1\u9001\u7684\u5ef6\u65f6\u4e5f\u662f\u7b49\u65f6\u6027\u5f88\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u4e2a\u5ef6\u65f6\u5305\u62ec\u7f51\u7edc\u7ed3\u6784\u4f20\u64ad\u5ef6\u65f6\u4e0eCompleter\u5ef6\u65f6\u3002\u7f51\u7edc\u7ed3\u6784\u4f20\u64ad\u5ef6\u65f6\u53d6\u51b3\u4e8e\u7cfb\u7edf\u4e2d\u5404\u79cd\u7ec4\u4ef6\u4e4b\u95f4\u7684\u94fe\u8def\u7684\u5168\u90e8\u7279\u6027\uff0c\u7279\u522b\u662f\u94fe\u8def\u5bbd\u5ea6\u548c\u64cd\u4f5c\u9891\u7387\u3002\u4e00\u79cd\u5c06\u8fd9\u4e2a\u7f51\u7edc\u7ed3\u6784\u4f20\u64ad\u5ef6\u65f6\u503c\u6700\u5c0f\u5316\u7684\u7b80\u5355\u65b9\u6cd5\uff0c\u5c31\u662f\u5bf9PCIe\u62d3\u6251\u7ed3\u6784\u7684\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7684\u590d\u6742\u5ea6\u8fdb\u884c\u7ea6\u675f\u3002Completer\u5ef6\u65f6\u53d6\u51b3\u4e8e\u76ee\u7684EP\u5185\u90e8\u7279\u6027\uff0c\u4f8b\u5982\u5b58\u50a8\u901f\u7387\u4ee5\u53ca\u5185\u90e8\u4ef2\u88c1\u65b9\u5f0f\u7b49\u7b49\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7633-root-complex","title":"7.6.3.3   Root Complex","text":"<p>RC\u7684\u4ef2\u88c1\u548c\u65f6\u95f4\u89c4\u5212\u9700\u6c42\u548cSwitch\u662f\u4e00\u6837\u7684\u3002\u5b83\u4f1a\u4ece\u591a\u4e2a\u4e0b\u884c\u7aef\u53e3\u63a5\u6536\u6570\u636e\u5305\uff0c\u5e76\u901a\u8fc7\u7b26\u5408\u524d\u9762\u6240\u63cf\u8ff0\u7684\u7b49\u65f6\u6027\u89c4\u5219\u7684\u65b9\u6cd5\u5c06\u5b83\u4eec\u8f6c\u53d1\u81f3\u76ee\u7684\u5730\u3002\u7136\u800c\uff0c\u8fd9\u4e9b\u4e8b\u60c5\u7684\u5b8c\u6210\u65b9\u6cd5\u5927\u90fd\u662fVendor\u7279\u5b9a\u7684\uff0c\u56e0\u4e3a\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u5b9a\u4e49\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u7684RC\u5de5\u4f5c\u65b9\u5f0f\u6216\u8005\u662f\u5b83\u5e94\u8be5\u5982\u4f55\u88ab\u7f16\u7a0b\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#l-problemsnooping","title":"l \u95ee\u9898\uff1a\u7aa5\u63a2\uff08Problem\uff1aSnooping\uff09","text":"<p>\u5728\u5f71\u54cdRC\u7684\u65f6\u95f4\u89c4\u5212\u548c\u5ef6\u65f6\u7684\u5404\u79cd\u56e0\u7d20\u91cc\uff0c\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u6ca1\u6709\u8fdb\u884c\u8ba8\u8bba\uff0c\u90a3\u5c31\u662f\u7aa5\u63a2\u8fc7\u7a0b\uff08process of snooping\uff09\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5bf9\u7cfb\u7edf\u5185\u5b58\u7684\u8bbf\u95ee\u4f1a\u53d1\u751f\u5728\u5904\u7406\u5668\u8ba4\u4e3a\u53ef\u7f13\u5b58\uff08cacheable\uff09\u7684\u4f4d\u7f6e\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u5185\u5b58\u53ef\u4ee5\u5728\u5b83\u7684\u672c\u5730Cache\u4e2d\u4fdd\u5b58\u4e00\u4e2a\u81ea\u5df1\u7684\u4e34\u65f6\u526f\u672c\u3002\u5982\u679c\u5916\u90e8\u8bbe\u5907\u5c1d\u8bd5\u8bbf\u95ee\u8fd9\u4e2a\u5185\u5b58\u533a\u57df\uff0c\u90a3\u4e48\u82af\u7247\u7ec4\u5fc5\u987b\u5148\u68c0\u67e5\u5904\u7406\u5668Cache\uff0c\u7136\u540e\u624d\u80fd\u5141\u8bb8\u6b64\u6b21\u5185\u5b58\u8bbf\u95ee\uff0c\u56e0\u4e3aCache\u4e2d\u7f13\u5b58\u7684\u526f\u672c\u53ef\u80fd\u5df2\u7ecf\u88ab\u66f4\u6539\u8fc7\uff0c\u4e0e\u539f\u5185\u5b58\u533a\u57df\u4e2d\u7684\u6570\u636e\u5df2\u7ecf\u4e0d\u76f8\u540c\u4e86\u3002\u5982\u679cCache\u4e2d\u7f13\u5b58\u7684\u526f\u672c\u786e\u5b9e\u88ab\u66f4\u6539\u8fc7\uff0c\u90a3\u4e48\u5728\u8bbe\u5907\u8bbf\u95ee\u8fd9\u4e2a\u5185\u5b58\u533a\u57df\u4e4b\u524d\uff0c\u5148\u8981\u8ba9Cache\u4e2d\u7684\u6570\u636e\u5199\u56de\u5185\u5b58\uff08Write Back\uff09\u3002\u867d\u7136\u5bf9\u5185\u5b58Cache\u4e00\u81f4\u6027\u7684\u786e\u8ba4\u5de5\u4f5c\u662f\u6709\u5fc5\u8981\u7684\uff0c\u4f46\u662f\u95ee\u9898\u5c31\u662f\u8fd9\u4e2a\u7aa5\u63a2\u8fc7\u7a0b\u662f\u9700\u8981\u82b1\u8d39\u65f6\u95f4\u7684\u3002\u5b83\u9700\u8981\u82b1\u8d39\u7684\u65f6\u95f4\u901a\u5e38\u662f\u5728\u4e00\u4e2a\u8303\u56f4\u5185\u6709\u9650\u7684\uff0c\u4f46\u662f\u662f\u4e0d\u53ef\u9884\u6d4b\u7684\uff0c\u56e0\u4e3a\u5b83\u53d6\u51b3\u4e8eCPU\u5728\u5f53\u65f6\u5177\u4f53\u6b63\u5728\u6267\u884c\u4ec0\u4e48\u5de5\u4f5c\u3002\u7ed3\u5408\u4e0a\u65f6\u95f4\u89c4\u5212\u7684\u65f6\u95f4\u786e\u5b9a\u6027\u9700\u6c42\uff0c\u7aa5\u63a2\u65f6\u95f4\u7684\u4e0d\u786e\u5b9a\u6027\u5f88\u6709\u53ef\u80fd\u4f1a\u7834\u574f\u540c\u6b65\u7b49\u65f6\u6570\u636e\u6d41\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#l-snooping-solution","title":"l \u7aa5\u63a2\u95ee\u9898\u89e3\u51b3\u65b9\u6cd5\uff08Snooping Solution\uff09","text":"<p>\u5bf9\u4e8e\u5916\u90e8\u8bbe\u5907\u6765\u8bf4\uff0c\u4e00\u79cd\u907f\u514d\u7aa5\u63a2\u7684\u65b9\u6cd5\u5c31\u662f\u4ec5\u8bbf\u95ee\u4e0d\u53ef\u7f13\u5b58\uff08Uncacheable\uff09\u7684\u5185\u5b58\u533a\u57df\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u7531\u8f6f\u4ef6\u8bbe\u7f6e\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305Header\u4e2d\u7684\u201cNo Snoop\uff08\u65e0\u7aa5\u63a2\uff09\u201d\u5c5e\u6027\u4f4d\u3002\u8fd9\u79cd\u65b9\u5f0f\u5c06\u4f1a\u5f3a\u5236\u82af\u7247\u7ec4\u8df3\u8fc7\u7aa5\u63a2\u6b65\u9aa4\uff0c\u4e0d\u7ba1\u5185\u5b58\u662f\u5426\u662funcacheable\u90fd\u76f4\u63a5\u53bb\u8bbf\u95ee\u5185\u5b58\uff0c\u8fd9\u9700\u8981\u8f6f\u4ef6\u7528\u4e00\u4e9b\u65b9\u6cd5\u6765\u4fdd\u8bc1\u8fd9\u6837\u505a\u4e0d\u4f1a\u5f15\u53d1\u95ee\u9898\u3002\u4e3a\u4e86\u5c06\u8fd9\u79cd\u65b9\u5f0f\u4f5c\u4e3a\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u7684\u4e00\u4e2a\u9700\u6c42\u6765\u6267\u884c\uff0c\u5bf9\u4e8e\u9ad8\u4f18\u5148\u7ea7VC\u6765\u8bf4\uff0c\u786c\u4ef6\u53ef\u4ee5\u5bf9RC\u7aef\u53e3\u4e2d\u7684\u53e6\u4e00\u4e2abit\u8fdb\u884c\u521d\u59cb\u5316\u914d\u7f6e\uff0c\u5b83\u53eb\u505a\u201c\u62d2\u7edd\u7aa5\u63a2\u4e8b\u52a1\uff08Reject Snoop Transaction\uff09\u201d\uff0c\u5982\u56fe 7\u201117\u4e2d\u6240\u793a\u7684VC\u8d44\u6e90\u80fd\u529b\u5bc4\u5b58\u5668\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\uff0c\u8ba9\u8fd9\u4e2aVC\u53ea\u5141\u8bb8\u4f20\u8f93No Snoop\u7684\u4e8b\u52a1\u3002\u4efb\u4f55\u8f93\u5165\u7684\u6ca1\u6709\u8bbe\u7f6eNo Snoop\u5c5e\u6027\u4f4d\u7684\u6570\u636e\u5305\u8c46\u6d46\u676f\u4e22\u5f03\uff0c\u4ee5\u6b64\u6765\u786e\u4fdd\u65f6\u95f4\u89c4\u5212\u7684\u65f6\u95f4\u786e\u5b9a\u6027\u4e0d\u4f1a\u88ab\u7aa5\u63a2\u8fc7\u7a0b\u82b1\u8d39\u7684\u4e0d\u786e\u5b9a\u65f6\u95f4\u6240\u7834\u574f\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7634-power-management","title":"7.6.3.4   \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09","text":"<p>\u7535\u6e90\u7ba1\u7406\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u76d1\u6d4b\u8fc7\u7a0b\uff0c\u4f46\u662f\u5f53PCIe\u4e2d\u7684\u4e00\u6bb5\u8def\u5f84\u662f\u65f6\u95f4\u654f\u611f\u8def\u5f84\u7684\u65f6\u5019\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8def\u5f84\u4e0a\u8bbe\u5907\u7684\u7535\u6e90\u7ba1\u7406\u673a\u5236PM\uff08Power Management\uff09\u5c31\u9700\u8981\u4ed4\u7ec6\u7684\u5904\u7406\u3002\u914d\u7f6e\u8f6f\u4ef6\u53ef\u4ee5\u8bfb\u53d6\u5230\u6bcf\u79cdPM\u6761\u4ef6\u4e0b\u9020\u6210\u7684\u5ef6\u65f6\uff0c\u5e76\u4ece\u4e2d\u9009\u62e9\u4e00\u79cdPM\u6761\u4ef6\u4f7f\u5f97\u5b83\u7684\u5ef6\u65f6\u53ef\u4ee5\u6ee1\u8db3\u65f6\u95f4\u89c4\u5212\u8981\u6c42\u3002\u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u5728\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7981\u7528PM\u3002\u8bbe\u5907\u53ef\u4ee5\u8fdb\u5165\u8bbe\u5907\u72b6\u6001D0\u7136\u540e\u5c31\u505c\u7559\u5728\u8fd9\u4e2a\u72b6\u6001\uff0c\u540c\u65f6\u7981\u7528\u786c\u4ef6\u63a7\u5236\u7684\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u673a\u5236\uff08\u66f4\u591a\u5173\u4e8ePM\u7684\u5185\u5bb9\u8bf7\u53c2\u9605Chapter 16\u201cPower Management\u201d\uff09\u3002</p>"},{"location":"pcie/07%20QoS%20%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F/#7635-error-handling","title":"7.6.3.5   \u9519\u8bef\u5904\u7406\uff08Error Handling\uff09","text":"<p>\u6700\u540e\uff0c\u8fd8\u5269\u4e0b\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff1a\u5f53\u94fe\u8def\u4e0a\u51fa\u73b0\u9519\u8bef\u65f6\u5e94\u8be5\u600e\u4e48\u529e\u3002ACK/NAK\u534f\u8bae\u63d0\u4f9b\u4e86\u4e00\u4e2a\u81ea\u52a8\u5730\u3001\u57fa\u4e8e\u786c\u4ef6\u7684\u91cd\u8bd5\u673a\u5236\uff08Retry\uff09\u6765\u7ea0\u6b63\u51fa\u73b0\u4f20\u8f93\u95ee\u9898\u7684\u6570\u636e\u5305\u3002\u8fd9\u4e2a\u539f\u672c\u8fd8\u4e0d\u9519\u7684\u7279\u6027\u4f1a\u7ed9\u7b49\u65f6\u6027\u5e26\u6765\u4e00\u4e2a\u95ee\u9898\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u82b1\u8d39\u65f6\u95f4\u6765\u5b8c\u6210\uff0c\u5e76\u4e14\u5b83\u7528\u6765\u89e3\u51b3\u51e0\u4e2a\u4f20\u8f93\u9519\u8bef\u82b1\u8d39\u7684\u65f6\u95f4\u4e5f\u4f1a\u6709\u8f83\u5927\u5dee\u5f02\uff0c\u8fd9\u53d6\u51b3\u4e8e\u5177\u4f53\u68c0\u6d4b\u5230\u4e86\u4ec0\u4e48\u6837\u7684\u9519\u8bef\u3002</p> <p>\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u7cfb\u7edf\u80fd\u5bb9\u5fcd\u591a\u5c11\u4e0d\u786e\u5b9a\u7684\u65f6\u95f4\uff0c\u4f7f\u5f97\u7cfb\u7edf\u4ecd\u80fd\u63d0\u4f9b\u540c\u6b65\u7b49\u65f6\u6570\u636e\u4f20\u8f93\u3002\u5982\u679c\u5ef6\u65f6\u65f6\u95f4\u9884\u7b97\u592a\u7d27\u5f20\uff0c\u90a3\u4e48\u663e\u7136\u5c31\u6ca1\u6709\u65f6\u95f4\u53ef\u4ee5\u7528\u6765\u91cd\u8bd5\u4f20\u8f93\u5931\u8d25\u7684\u6570\u636e\u5305\uff0c\u4e5f\u5c31\u9700\u8981\u7981\u7528ACK/NAK\u534f\u8bae\u3002\u6709\u8da3\u7684\u662f\uff0cPCIe\u7684\u534f\u8bae\u89c4\u8303\u5236\u5b9a\u8005\u663e\u7136\u6ca1\u6709\u8003\u8651\u5230\u8fd9\u4e00\u70b9\uff0c\u56e0\u4e3a\u5e76\u6ca1\u6709\u8bbe\u8ba1\u7528\u6765\u7981\u7528ACK/NAK\u534f\u8bae\u7684\u914d\u7f6ebit\uff0c\u4e5f\u6ca1\u6709\u8bbe\u8ba1\u914d\u7f6ebit\u7528\u6765\u51b3\u5b9a\u5982\u4f55\u5904\u7406\u90a3\u4e9b\u672c\u6765\u4f1a\u88ab\u91cd\u4f20\u800c\u73b0\u5728\u4e0d\u4f1a\u88ab\u91cd\u4f20\u7684\u6570\u636e\u5305\u3002\u56e0\u6b64\uff0c\u7981\u7528ACK/NAK\u534f\u8bae\u9700\u8981\u4f7f\u7528\u4e00\u4e9b\u975e\u6807\u51c6\u673a\u5236\uff0c\u4f8b\u5982Vendor-specific\u5bc4\u5b58\u5668\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u8db3\u591f\u7684\u65f6\u95f4\u7528\u4e8e\u91cd\u4f20\uff0c\u90a3\u4e48\u76ee\u7684\u65b9\u53ef\u80fd\u5c31\u4f1a\u7b80\u5355\u7684\u5c06\u635f\u574f\u7684\u6570\u636e\u5305\u4e22\u5f03\u3002\u53e6\u4e00\u4e2a\u9009\u62e9\u662f\u5c31\u76f4\u63a5\u4f7f\u7528\u635f\u574f\u3001\u9519\u8bef\u7684\u6240\u6709\u6570\u636e\u5305\u3002\u5bf9\u4e8e\u4e00\u4e9b\u4f7f\u7528\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u652f\u6301\u7684\u5e94\u7528\u6765\u8bf4\uff0c\u4f7f\u7528\u635f\u574f\u6570\u636e\u5305\u7684\u8fd9\u79cd\u64cd\u4f5c\u5e76\u6ca1\u6709\u542c\u8d77\u6765\u8fd9\u4e48\u4e0d\u53ef\u63a5\u53d7\u3002\u4f8b\u5982\uff0c\u89c6\u9891\u6d41\u4e2d\u7684\u9519\u8bef\u53ef\u80fd\u4f1a\u5bfc\u81f4\u663e\u793a\u5668\u5076\u5c14\u51fa\u73b0\u6545\u969c\u95ea\u70c1\uff0c\u4f46\u662f\u8fd9\u4e2a\u98ce\u9669\u88ab\u8ba4\u4e3a\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002</p> <p>\u4e0d\u540c\u4e8e\u4e0a\u9762\u7684\u60c5\u51b5\uff0c\u5982\u679c\u5728\u670d\u52a1\u95f4\u9694\uff08Service Interval\uff09\u4e2d\uff0c\u6709\u8db3\u591f\u7684\u65f6\u95f4\u7528\u4e8e\u91cd\u4f20\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u8ba1\u65f6\u5668\u7684\u65b9\u5f0f\u6765\u7ed9\u91cd\u8bd5\u5ef6\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u4e0a\u9650\uff0c\u8fd9\u4e2a\u8ba1\u65f6\u5668\u4f1a\u4e00\u76f4\u8bb0\u5f55\u65f6\u95f4\u76f4\u5230\u5f53\u524dSI\u7ed3\u675f\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u51b3\u5b9a\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u91cd\u8bd5\u64cd\u4f5c\u3002\u5f53\u7136\uff0c\u9519\u8bef\u60c5\u51b5\u4e0d\u5e94\u8be5\u5f88\u9891\u7e41\u7684\u51fa\u73b0\uff0c\u6240\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u4e8e\u5076\u5c14\u51fa\u73b0\u7684\u4f20\u8f93\u9519\u8bef\u6765\u8bf4\u662f\u8db3\u591f\u7684\uff0c\u5e76\u4e14\u540c\u65f6\u4e5f\u53ef\u4ee5\u4fdd\u6301\u540c\u6b65\u7b49\u65f6\u7684\u65f6\u95f4\u89c4\u5212\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/","title":"08 \u4e8b\u52a1\u6392\u5e8f","text":""},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#chapter-8-transaction-ordering","title":"Chapter 8      Transaction Ordering //\u4e8b\u52a1\u6392\u5e8f","text":""},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#_1","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u8282\u8ba8\u8bba\u4e86\u7528\u4e8e\u652f\u6301QoS\uff08Quality of Service\uff09\u7684\u673a\u5236\uff0c\u5e76\u63cf\u8ff0\u4e86\u5bf9\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u4e0d\u540c\u6570\u636e\u5305\u7684\u4f20\u8f93\u65f6\u95f4\u548c\u5e26\u5bbd\u8fdb\u884c\u63a7\u5236\u7684\u610f\u4e49\u3002\u8fd9\u4e9b\u673a\u5236\u5305\u62ec\uff0c\u7279\u5b9a\u5e94\u7528\u7684\u8f6f\u4ef6\u5c06\u4f1a\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u8bbe\u5907\u5185\u6784\u5efa\u53ef\u9009\u7684\u786c\u4ef6\u6765\u542f\u7528\u4e8b\u52a1\u4f18\u5148\u7ea7\u7ba1\u7406\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u4f1a\u8ba8\u8bbaPCIe\u62d3\u6251\u7ed3\u6784\u4e2d\u4e8b\u52a1\u5bf9\u6392\u5e8f\u7684\u8981\u6c42\u3002\u8fd9\u4e9b\u89c4\u5219\u662f\u7ee7\u627f\u81eaPCI\u7684\uff0c\u5b83\u4eec\u8bb8\u591a\u90fd\u53d7\u5230\u201c\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff08Producer/Consumer\uff09\u201d\u7a0b\u5e8f\u8bbe\u8ba1\u6a21\u578b\u7684\u63a8\u52a8\uff0c\u56e0\u6b64\u5728\u672c\u7ae0\u5185\u4f1a\u63cf\u8ff0\u8fd9\u4e2a\u6a21\u578b\u7684\u673a\u5236\u539f\u7406\u3002\u539f\u59cb\u7684\u89c4\u5219\u4e2d\u8fd8\u8003\u8651\u4e86\u5fc5\u987b\u8981\u907f\u514d\u7684\u90a3\u4e9b\u6b7b\u9501\u60c5\u51b5\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u5c06\u4f1a\u63cf\u8ff0Data Link Layer Packet\uff08DLLP\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u3002\u6211\u4eec\u5c06\u4f1a\u63cf\u8ff0\u5176\u7528\u9014\u3001\u683c\u5f0f\u4ee5\u53caDLLP\u6570\u636e\u5305\u7c7b\u578b\u7684\u5b9a\u4e49\uff0c\u4e5f\u5c06\u4f1a\u5bf9\u5176\u76f8\u5173\u5b57\u6bb5\u7684\u7ec6\u8282\u8fdb\u884c\u63cf\u8ff0\u4ecb\u7ecd\u3002DLLP\u53ef\u4ee5\u88ab\u7528\u6765\u652f\u6301Ack/Nak\u534f\u8bae\u3001\u7535\u6e90\u7ba1\u7406\u3001\u6d41\u63a7\u673a\u5236\uff0c\u8fd8\u53ef\u4ee5\u88ab\u7528\u6765\u505a\u4e00\u4e9bvendor\u81ea\u5b9a\u4e49\u7684\u4e8b\u60c5\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#81-introduction","title":"8.1 \u4ecb\u7ecd\uff08Introduction\uff09","text":"<p>\u548c\u5176\u4ed6\u534f\u8bae\u4e00\u6837\uff0c\u5bf9\u4e8e\u540c\u65f6\u8981\u5728\u7f51\u7edc\u7ed3\u6784\u4e2d\u8fdb\u884c\u4f20\u8f93\u7684\u3001\u62e5\u6709\u76f8\u540cTC\uff08Traffic Class\uff0c\u6d41\u91cf\u7c7b\u578b\uff09\u4e8b\u52a1\uff0cPCIe\u89c4\u5b9a\u4e86\u5b83\u4eec\u4e4b\u95f4\u7684\u6392\u5e8f\u89c4\u5219\u3002\u800c\u5bf9\u4e8e\u62e5\u6709\u4e0d\u540cTC\u7684\u4e8b\u52a1\u4e4b\u95f4\u5219\u5e76\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u3002\u5bf9\u76f8\u540cTC\u7684\u4e8b\u52a1\u6307\u5b9a\u6392\u5e8f\u89c4\u5219\u7684\u539f\u56e0\u6709\uff1a</p> <p>n \u7ef4\u6301\u4e0e\u4f20\u7edf\u9057\u7559\u603b\u7ebf\u7684\u517c\u5bb9\u6027\uff0c\u4f8b\u5982PCI\u3001PCI-X\u548cAGP\u3002</p> <p>n \u4fdd\u8bc1\u4e8b\u52a1\u7684\u5b8c\u6210\u662f\u786e\u5b9a\u7684\uff08deterministic\uff09\uff0c\u4e14\u662f\u6309\u7167\u7a0b\u5e8f\u5458\u60f3\u8981\u7684\u987a\u5e8f\u53f7\u8fdb\u884c\u7684\u3002</p> <p>n \u907f\u514d\u6b7b\u9501\u60c5\u51b5\u3002</p> <p>n \u901a\u8fc7\u5c06\u8bfb\u53d6\u5ef6\u65f6\u6700\u5c0f\u5316\u5e76\u7ba1\u7406\u8bfb\u5199\u7684\u987a\u5e8f\uff0c\u6765\u5c06\u6027\u80fd\u548c\u541e\u5410\u91cf\u6700\u5927\u5316\u3002</p> <p>\u5177\u4f53\u7684PCI/PCIe\u4e8b\u52a1\u6392\u5e8f\u7684\u5b9e\u73b0\u57fa\u4e8e\u4ee5\u4e0b\u7684\u7279\u6027\uff1a</p> <p>\\1.    \u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u7f16\u7a0b\u6a21\u578b\uff08Producer/Consumer\uff09\uff0c\u5b83\u662f\u57fa\u672c\u6392\u5e8f\u89c4\u5219\u7684\u57fa\u7840\u3002</p> <p>\\2.    \u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09\uff0c\u5f53\u8bf7\u6c42\u8005\u77e5\u9053\u67d0\u4e2a\u4e8b\u52a1\u4e0e\u5148\u524d\u7684\u4e8b\u52a1\u6ca1\u6709\u4efb\u4f55\u4f9d\u8d56\u5173\u7cfb\u65f6\uff0c\u5219\u5141\u8bb8\u51fa\u73b0\u5bbd\u677e\u6392\u5e8f\u3002</p> <p>\\3.    ID\u6392\u5e8f\uff08ID Ordering\uff09\uff0c\u5728ID\u6392\u5e8f\u89c4\u5219\u4e0b\uff0cSwitch\u53ef\u4ee5\u5141\u8bb8\u6765\u81ea\u67d0\u4e00\u4e2a\u8bbe\u5907\u7684\u8bf7\u6c42\u5148\u4e8e\u53e6\u4e00\u4e2a\u8bbe\u5907\u7684\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u8bbe\u5907\u6b63\u5728\u6267\u884c\u4e0d\u76f8\u5173\u7684\u7ebf\u7a0b\u3002</p> <p>\\4.    \u4e00\u4e9b\u907f\u514d\u6b7b\u9501\u60c5\u51b5\u7684\u65b9\u6cd5\u4ee5\u53ca\u652f\u6301PCI\u4f20\u7edf\u8bbe\u5907\u5b9e\u73b0\u7684\u65b9\u6cd5\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#82-definitions","title":"8.2 \u5b9a\u4e49\uff08Definitions\uff09","text":"<p>\u5728\u6570\u636e\u6d41\u4e2d\u6709\u4e09\u79cd\u901a\u7528\u6a21\u578b\u7528\u4e8e\u4e8b\u52a1\u6392\u5e8f\uff1a</p> <p>\\1.    \u5f3a\u6392\u5e8f\uff08Strong Ordering**\uff09**\uff1a\u5bf9\u4e8e\u5728PCIe\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u62e5\u6709\u76f8\u540cTC\u7684\u591a\u4e2a\u4e8b\u52a1\u6d41\uff0cPCIe\u8981\u6c42\u4f7f\u7528\u5f3a\u6392\u5e8f\u89c4\u5219\u3002\u62e5\u6709\u76f8\u540cTC\u7684\u4e8b\u52a1\u4eec\u4e5f\u4f1a\u88ab\u6620\u5c04\u5230\u540c\u4e00\u4e2a\u7ed9\u5b9aVC\uff0c\u56e0\u6b64\u6bcf\u4e2aVC\u4e2d\u4e5f\u8981\u5e94\u7528\u5f3a\u6392\u5e8f\u89c4\u5219\u3002\u56e0\u6b64\uff0c\u5f53\u591a\u4e2aTC\u90fd\u88ab\u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u65f6\uff0c\u8fd9\u4e9bTC\u7684\u6240\u6709\u4e8b\u52a1\u90fd\u4f1a\u88ab\u5f53\u505a\u540c\u4e00\u4e2aTC\u6765\u8fdb\u884c\u5904\u7406\uff0c\u5373\u4f7f\u4e0d\u540c\u7684TC\u4e4b\u95f4\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u3002</p> <p>\\2.    \u5f31\u6392\u5e8f\uff08Weak Ordering**\uff09**\uff1a\u9664\u975e\u4e8b\u52a1\u9700\u8981\u91cd\u65b0\u6392\u5e8f\uff0c\u5426\u5219\u5b83\u4eec\u5c06\u7ef4\u6301\u539f\u6765\u7684\u987a\u5e8f\u3002\u7531\u4e8e\u67d0\u4e9b\u7ed9\u5b9a\u7684\u4e8b\u52a1\u6a21\u578b\uff08\u4f8b\u5982Producer/Consumer\u6a21\u578b\uff09\u76f8\u5173\u7684\u4f9d\u8d56\u6027\uff0c\u7ef4\u6301\u4e8b\u7269\u95f4\u7684\u5f3a\u6392\u5e8f\u5173\u7cfb\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u88ab\u963b\u585e\u3002\u800c\u88ab\u963b\u585e\u7684\u4e8b\u52a1\u4e2d\uff0c\u6709\u4e9b\u4e0e\u4f9d\u8d56\u5173\u7cfb\u5e76\u4e0d\u76f8\u5173\u8054\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5b89\u5168\u5730\u88ab\u91cd\u65b0\u6392\u5728\u963b\u585e\u7684\u4e8b\u52a1\u4e4b\u524d\u3002</p> <p>\\3.    \u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering**\uff09**\uff1a\u5728\u4e14\u4ec5\u5728\u67d0\u4e9b\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u4e8b\u52a1\u53ef\u4ee5\u88ab\u91cd\u65b0\u6392\u5e8f\uff0c\u5b83\u7684\u597d\u5904\u662f\u53ef\u4ee5\u50cf\u5f31\u6392\u5e8f\u6a21\u578b\u4e00\u6837\u63d0\u5347\u6027\u80fd\uff0c\u4f46\u662f\u5b83\u4ec5\u5728\u8f6f\u4ef6\u6307\u5b9a\u662f\u624d\u4f1a\u8fd9\u6837\u505a\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u4f9d\u8d56\u95ee\u9898\u3002\u800c\u5b83\u7684\u7f3a\u70b9\u5219\u662f\u4ec5\u6709\u90e8\u5206\u4e8b\u52a1\u53ef\u4ee5\u5f97\u5230\u6027\u80fd\u4e0a\u7684\u4f18\u5316\u3002\u8f6f\u4ef6\u8981\u542f\u7528\u5bbd\u677e\u6392\u5e8f\uff08RO\uff0cRelaxed Ordering\uff09\u4e5f\u9700\u8981\u4e00\u4e9b\u989d\u5916\u5f00\u9500\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#83-simplified-ordering-rules","title":"8.3 \u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\uff08Simplified Ordering Rules\uff09","text":"<p>PCIe 2.1\u7248\u672c\u4e2d\u4ecb\u7ecd\u4e86\u4e00\u79cd\u7b80\u5316\u7248\u7684\u6392\u5e8f\u89c4\u5219\u8868\uff0c\u5982\u6240\u793a\u3002\u8fd9\u4e2a\u8868\u683c\u53ef\u4ee5\u6309\u4e3b\u9898\u5212\u5206\u5982\u4e0b\uff1a</p> <p>n \u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff08Producer/Consumer\uff09\u89c4\u5219</p> <p>n \u5bbd\u677e\u6392\u5e8f\uff08RO\uff09\u89c4\u5219</p> <p>n \u5f31\u6392\u5e8f\u89c4\u5219</p> <p>n ID\u6392\u5e8f\u89c4\u5219</p> <p>n \u6b7b\u9501\u7684\u907f\u514d</p> <p>\u8fd9\u4e9b\u5c0f\u8282\u4e2d\u4f1a\u7ed9\u51fa\u4e0e\u5404\u4e2a\u6392\u5e8f\u6a21\u578b\u3001\u64cd\u4f5c\u3001\u57fa\u672c\u539f\u7406\u3001\u60c5\u51b5\u4ee5\u53ca\u8981\u6c42\u76f8\u5173\u7684\u7ec6\u8282\u5185\u5bb9\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#831-ordering-rules-and-traffic-classes","title":"8.3.1     \u6392\u5e8f\u89c4\u5219\u4e0e\u6d41\u91cf\u7c7b\u578b\uff08Ordering Rules and Traffic Classes\uff09","text":"<p>PCIe\u4e2d\u7684\u6392\u5e8f\u89c4\u5219\u4f1a\u5e94\u7528\u4e8e\u62e5\u6709\u76f8\u540cTC\uff08\u6d41\u91cf\u7c7b\u578b\uff09\u7684\u4e8b\u52a1\u4e4b\u95f4\u3002\u5bf9\u4e8e\u90a3\u4e9b\u5728\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u5177\u6709\u4e0d\u540cTC\u7684\u4e8b\u52a1\u6765\u8bf4\uff0c\u5e76\u6ca1\u6709\u9488\u5bf9\u5b83\u4eec\u7684\u6392\u5e8f\u8981\u6c42\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u4eec\u5404\u81ea\u7684\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u662f\u6ca1\u6709\u5173\u8054\u7684\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e0d\u540cTC\u7684\u6570\u636e\u5305\u6765\u8bf4\uff0c\u4e5f\u5c31\u4e0d\u5b58\u5728\u7531\u4e8e\u4e8b\u52a1\u6392\u5e8f\u800c\u5e26\u6765\u7684\u6027\u80fd\u964d\u4f4e\u95ee\u9898\u3002</p> <p>\u5bf9\u4e8e\u62e5\u6709\u76f8\u540cTC\u7684\u6570\u636e\u5305\u6765\u8bf4\uff0c\u5f53\u5b83\u4eec\u5728PCIe\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u65f6\uff0c\u6709\u53ef\u80fd\u4f1a\u7ecf\u5386\u6027\u80fd\u964d\u4f4e\u3002\u8fd9\u662f\u56e0\u4e3aSwitch\u548c\u8bbe\u5907\u4eec\u5fc5\u987b\u8981\u652f\u6301\u4e00\u4e9b\u6392\u5e8f\u89c4\u5219\uff0c\u800c\u8fd9\u53ef\u80fd\u4f1a\u8981\u6c42\u5c06\u6570\u636e\u5305\u5ef6\u8fdf\uff0c\u6216\u8005\u5728\u5148\u53d1\u9001\u6765\u7684\u6570\u636e\u5305\u4e4b\u524d\u5c06\u540e\u53d1\u9001\u6765\u7684\u6570\u636e\u5305\u8f6c\u53d1\u51fa\u53bb\u3002</p> <p>\u50cfChapter 7\u201cQuality of Service\u670d\u52a1\u8d28\u91cf\u201d\u4e00\u7ae0\u4e2d\u8ba8\u8bba\u7684\u90a3\u6837\uff0c\u62e5\u6709\u4e0d\u540cTC\u7684\u4e8b\u52a1\u53ef\u80fd\u4f1a\u88ab\u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u3002TC-to-VC\u6620\u5c04\u5173\u7cfb\u7684\u914d\u7f6e\u51b3\u5b9a\u4e86\u4e00\u4e2a\u7ed9\u5b9a\u4e86TC\u7684\u6570\u636e\u5305\u5c06\u4f1a\u88ab\u6620\u5c04\u5230\u54ea\u4e00\u4e2a\u6307\u5b9a\u7684VC\u53bb\u3002\u5c3d\u7ba1\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u4ec5\u5e94\u7528\u4e8e\u76f8\u540cTC\u7684\u6570\u636e\u5305\u4e4b\u95f4\uff0c\u4f46\u662f\u53ef\u80fd\u4e5f\u53ef\u4ee5\u66f4\u7b80\u5355\u7684\u8bbe\u8ba1EP/Switch/RC\u4ee4\u5b83\u4eec\u5c06\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u5e94\u7528\u5728\u540c\u4e00\u4e2aVC\u4e2d\u7684\u6240\u6709\u6570\u636e\u5305\u4e4b\u95f4\uff0c\u5373\u4f7f\u5728\u4e00\u4e2aVC\u4e2d\u53ef\u80fd\u542b\u6709\u591a\u4e2aTC\u7684\u6570\u636e\u5305\u3002</p> <p>\u663e\u7136\uff0c\u6620\u5c04\u5230\u4e0d\u540cVC\u7684\u6570\u636e\u5305\u4e4b\u95f4\u6ca1\u6709\u6392\u5e8f\u5173\u7cfb\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#832-ordering-rules-based-on-packet-type","title":"8.3.2     \u57fa\u4e8e\u5305\u7c7b\u578b\u7684\u6392\u5e8f\u89c4\u5219\uff08Ordering Rules Based On Packet Type\uff09","text":"<p>PCIe\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684\u6392\u5e8f\u5173\u7cfb\u662f\u57fa\u4e8eTLP\u7c7b\u578b\u7684\u3002TLP\u88ab\u5206\u4e3a\u4e09\u4e2a\u79cd\u7c7b\uff1a</p> <p>\\1)   Posted</p> <p>\\2)   Completion</p> <p>\\3)   Non-Posted</p> <p>Posted\u79cd\u7c7b\u7684TLP\u5305\u62ecMWr\u8bf7\u6c42\uff08Memory Write request\uff09\u4e0eMessage\uff08Msg/MsgD\uff09\u3002Completion\u79cd\u7c7b\u7684TLP\u5305\u62ecCpl\u4e0eCplD\u3002Non-Posted\u79cd\u7c7b\u7684TLP\u5305\u62ecMRd\u3001IORd\u3001IOWr\u3001CfgRd0\u3001CfgRd1\u3001CfgWr0\u4ee5\u53caCFGWr1\u3002</p> <p>\u5728\u4e0b\u4e00\u5c0f\u8282\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e2a\u8868\u683c\uff08\u8868 8\u20111\uff09\u6765\u63cf\u8ff0\u4e8b\u52a1\u7684\u6392\u5e8f\u89c4\u5219\uff0c\u4f60\u5c06\u4f1a\u770b\u5230\u8fd9\u4e2a\u8868\u683c\u4e2d\u5217\u51fa\u4e86\u4e0a\u9762\u63d0\u5230\u7684\u4e09\u4e2a\u79cd\u7c7b\u7684TLP\u4ee5\u53ca\u5b83\u4eec\u6240\u5b9a\u4e49\u7684\u6392\u5e8f\u5173\u7cfb\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#833-the-simplified-ordering-rules-table","title":"8.3.3     \u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\u8868\uff08The Simplified Ordering Rules Table\uff09","text":"<p>\u8be5\u8868\u6309\u7167Row Pass Column\uff08\u884c\u4f20\u9012\u5217\uff09\u7684\u65b9\u5f0f\u5bf9\u5185\u5bb9\u8fdb\u884c\u7ec4\u7ec7\u3002\u6240\u6709\u7684\u6392\u5e8f\u89c4\u5219\u90fd\u5728\u7b80\u5316\u540e\u7684\u6392\u5e8f\u8868\uff08\u8868 8\u20111\uff09\u4e4b\u540e\u8fdb\u884c\u603b\u7ed3\u6982\u62ec\u3002\u6bcf\u79cd\u89c4\u5219\uff0c\u6216\u8005\u6bcf\u7ec4\u89c4\u5219\uff0c\u90fd\u5b9a\u4e49\u4e86\u5b83\u4eec\u8981\u6c42\u7684\u64cd\u4f5c\u5185\u5bb9\u3002</p> <p>\u5728\u8868 8\u20111\u4e2d\uff0c\u52172-5\u4ee3\u8868\u5148\u524d\u5df2\u7ecf\u88abPCIe\u8bbe\u5907\u53d1\u9001\u7684\u4e8b\u52a1\uff0c\u800c\u884cA-D\u5219\u4ee3\u88681\u4e2a\u521a\u521a\u5230\u8fbe\u7684\u65b0\u7684\u4e8b\u52a1\u3002\u5bf9\u4e8e\u51fa\u7ad9\u4e8b\u52a1\uff08outbound transaction\uff09\uff0c\u8be5\u8868\u6307\u5b9a\u4e86\u884c\uff08A-D\uff09\u6240\u4ee3\u8868\u7684\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u8d85\u8fc7\u4e00\u4e2a\u7531\u5217\uff082-5\uff09\u6240\u4ee3\u8868\u7684\u5148\u524d\u7684\u4e8b\u52a1\u3002\u8868\u4e2d\u7684\u201cNo\u201d\u8868\u793a\u884c\u4e8b\u52a1\u4e0d\u5141\u8bb8\u8d85\u8fc7\u5217\u4e8b\u52a1\uff0c\u201cYes\u201d\u8868\u793a\u5fc5\u987b\u5141\u8bb8\u884c\u4e8b\u52a1\u8d85\u8fc7\u5217\u4e8b\u52a1\u4ee5\u6b64\u6765\u907f\u514d\u6b7b\u9501\uff0c\u800c\u201cYes/No\u201d\u5219\u8868\u793a\u884c\u4e8b\u52a1\u53ef\u4ee5\u8d85\u8fc7\u5217\u4e8b\u52a1\u4f46\u662f\u5e76\u4e0d\u8981\u6c42\u4e00\u5b9a\u8981\u8fd9\u4e48\u505a\u3002\u8868\u4e2d\u5404\u4e2a\u6761\u76ee\u5747\u6709\u5176\u542b\u4e49\u3002</p> <p></p> <p>\u8868 8\u20111\u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\u8868</p> <p>n A2a,B2a,C2a,D2a\uff1a\u4e3a\u4e86\u6267\u884c\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\uff0c\u540e\u6765\u7684\u4e8b\u52a1\u4e0d\u5141\u8bb8\u8d85\u8fc7\u8d85\u8fc7\u4e00\u4e2a\u5148\u524d\u7684Posted\u8bf7\u6c42\u3002</p> <p>n D2b\uff1a\u5982\u679c\u8bbe\u7f6e\u4e86RO\uff08Relaxed Ordering\uff09\uff0c\u90a3\u4e48\u4e00\u4e2aRead Completion\u662f\u53ef\u4ee5\u8d85\u8fc7\u4e00\u4e2a\u5148\u524d\u5df2\u6392\u961f\u7684MWr\u6216\u662fMessage\u8bf7\u6c42\u7684\u3002</p> <p>n A2b,B2b,C2b,D2b\uff1a\u5982\u679c\u4f7f\u7528\u4e86\u53ef\u9009\u7684IDO\uff08ID Ordering\uff09\uff0c\u90a3\u4e48\u540e\u6765\u7684\u4e8b\u52a1\u662f\u5141\u8bb8\u8d85\u8fc7\u4e00\u4e2aPosted\u8bf7\u6c42\u7684\uff0c\u53ea\u8981\u5b83\u4eec\u4e24\u4e2a\u7684Requester ID\u4e0d\u540c\u3002</p> <p>n A3,A4\uff1a\u4e00\u4e2aMwr\u6216\u8005Message\u8bf7\u6c42\u5fc5\u987b\u8981\u53ef\u4ee5\u8d85\u8fc7Non-Posted\u8bf7\u6c42\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u6b7b\u9501\u3002</p> <p>n A5a\uff1aPosted\u8bf7\u6c42\u53ef\u4ee5\u4f46\u4e0d\u8981\u4e0d\u8d85\u8fc7Completion\u3002</p> <p>n A5b\uff1a\u907f\u514d\u6b7b\u9501\u7684\u60c5\u51b5\u3002\u5728\u4e00\u4e2aPCIe-to-PCI/PCI-X Bridge\u4e2d\uff0c\u4e3a\u4e86\u8ba9\u4e8b\u52a1\u4ecePCIe\u4f20\u5230PCI\u6216PCI-X\uff0cPosted\u8bf7\u6c42\u5fc5\u987b\u8981\u80fd\u8d85\u8fc7Completion\uff0c\u5426\u5219\u5c06\u6709\u53ef\u80fd\u53d1\u751f\u6b7b\u9501\u3002</p> <p>n B3,B4,B5,C3,C4,C5\uff1a\u8fd9\u4e9b\u60c5\u51b5\u5b9e\u73b0\u5f31\u6392\u5e8f\uff0c\u4e14\u4e0d\u4f1a\u6709\u4efb\u4f55\u4e0e\u6392\u5e8f\u76f8\u5173\u95ee\u9898\u7684\u98ce\u9669\u3002</p> <p>n D3,D4\uff1aCompletion\u5fc5\u987b\u8981\u80fd\u8d85\u8fc7Read\u3001IO\u6216\u8005\u662f\u914d\u7f6e\u5199\u8bf7\u6c42\uff08Non-Posted\u8bf7\u6c42\uff09\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u6b7b\u9501\u3002</p> <p>n D5a\uff1a\u62e5\u6709\u4e0d\u540c\u4e8b\u52a1ID\u7684\u4e24\u4e2aCompletion\u90fd\u53ef\u4ee5\u8d85\u8fc7\u5bf9\u65b9\u3002</p> <p>n D5b\uff1a\u62e5\u6709\u76f8\u540c\u4e8b\u52a1ID\u7684Completion\u4eec\u4e0d\u80fd\u8d85\u8fc7\u5bf9\u65b9\uff0c\u8981\u4fdd\u6301\u539f\u6392\u5e8f\u3002\u8fd9\u662f\u4e3a\u4e86\u4fdd\u8bc1\u5728\u7ed9\u5355\u4e2a\u8bf7\u6c42\u8fd4\u56de\u591a\u4e2aCompletion\u65f6\uff0c\u4ecd\u7136\u53ef\u4ee5\u4fdd\u6301\u5730\u5740\u7684\u9012\u589e\u987a\u5e8f\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#84-producerconsumer-model","title":"8.4 \u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\uff08Producer/Consumer Model\uff09","text":"<p>\u8fd9\u4e00\u8282\u5c06\u4f1a\u63cf\u8ff0Producer/Consumer\uff08\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff09\u6a21\u578b\u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u4ee5\u53ca\u4e3a\u4e86\u6b63\u786e\u6267\u884c\u8fd9\u4e2a\u6a21\u578b\u6240\u9700\u8981\u7684\u6392\u5e8f\u89c4\u5219\u3002\u56fe 8\u20111\u4e2d\u7b80\u5355\u7684\u5c55\u793a\u4e86\u4e00\u4e2a\u7528\u4e8e\u793a\u4f8b\u7684\u62d3\u6251\u7ed3\u6784\u3002\u5728\u63a5\u4e0b\u6765\u7684\u4f7f\u7528\u8fd9\u4e2a\u62d3\u6251\u7ed3\u6784\u7684\u7b2c\u4e00\u4e2a\u793a\u4f8b\u4e2d\u5c06\u4f1a\u63cf\u8ff0Producer/Consumer\u6a21\u578b\u5728\u4f7f\u7528\u5408\u9002\u7684\u6392\u5e8f\u89c4\u5219\u65f6\u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u7136\u540e\u4f1a\u518d\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50\u7528\u4e8e\u63cf\u8ff0Producer/Consumer\u6a21\u578b\u5728\u4f7f\u7528\u4e0d\u5408\u9002\u7684\u6392\u5e8f\u89c4\u5219\u65f6\u5bfc\u81f4\u64cd\u4f5c\u9519\u8bef\u7684\u5931\u8d25\u60c5\u51b5\u3002</p> <p>Producer/Consumer\u6a21\u578b\u662fPCI\u548cPCIe\u4e2d\u6570\u636e\u4f20\u8f93\u65f6\u7684\u5e38\u7528\u65b9\u6cd5\u3002\u8fd9\u4e2a\u6a21\u578b\u7531\u56fe 8\u20111\u4e2d\u6240\u5c55\u793a\u76845\u4e2a\u5143\u7d20\u6240\u7ec4\u6210\uff1a</p> <p>n \u6570\u636e\u7684Producer\uff08\u751f\u4ea7\u8005\uff09</p> <p>n \u5185\u5b58\u6570\u636eBuffer</p> <p>n \u7528\u4e8e\u6307\u793a\u6570\u636e\u5df2\u7ecf\u7531\u751f\u4ea7\u8005\u53d1\u9001\u7684Flag semaphore\uff08\u6807\u5fd7\u4fe1\u53f7\u91cf\uff09</p> <p>n \u6570\u636e\u7684Consumer\uff08\u6d88\u8d39\u8005\uff09</p> <p>n \u7528\u4e8e\u6307\u793a\u6d88\u8d39\u8005\u5df2\u7ecf\u8bfb\u53d6\u4e86\u6570\u636e\u7684Status semaphore\uff08\u72b6\u6001\u4fe1\u53f7\u91cf\uff09</p> <p>\u534f\u8bae\u89c4\u8303\u4e2d\u6307\u51fa\uff0c\u65e0\u8bba\u6240\u6709\u7684\u76f8\u5173\u7684\u5143\u7d20\u662f\u5982\u4f55\u6392\u5217\u653e\u7f6e\u7684\uff0cProducer/Consumer\u6a21\u578b\u90fd\u4f1a\u6267\u884c\u5de5\u4f5c\u3002\u5728\u672c\u4f8b\u4e2d\uff0cFlag\u548cStatus\u5143\u7d20\u90fd\u4f4d\u4e8e\u540c\u4e00\u4e2a\u7269\u7406\u5b9e\u4f53\u8bbe\u5907\uff0c\u4f46\u662f\u5176\u5b9e\u5b83\u4eec\u4e5f\u53ef\u4ee5\u4f4d\u4e8e\u4e0d\u540c\u7684\u8bbe\u5907\u4e2d\u3002</p> <p></p> <p>\u56fe 8\u20111\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u62d3\u6251\u793a\u4f8b</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#841-producerconsumer-sequence-no-errors","title":"8.4.1     \u6b63\u786e\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b\uff08Producer/Consumer Sequence-No Errors\uff09","text":"<p>\u4e0b\u5217\u7684\u8ba8\u8bba\u8bf7\u53c2\u7167\u56fe 8\u20112\u3002\u8be5\u793a\u4f8b\u4e2d\u5047\u8bbe\u4ece\u4e00\u5f00\u59cbFlag\u548cStatus\u5143\u7d20\u5c31\u5df2\u7ecf\u6e05\u9664\u590d\u4f4d\u4e86\u3002\u8fd9\u4e24\u79cd\u4fe1\u53f7\u91cf\u5728\u672c\u4f8b\u4e2d\u90fd\u4f4d\u4e8e\u540c\u4e00\u4e2a\u8bbe\u5907\u4e2d\u3002\u4e0b\u9762\u7684\u63cf\u8ff0\u4e2d\u5e26\u6709\u5e8f\u53f7\u7684\u4e8b\u4ef6\u6d41\u7a0b\uff0c\u4ee5\u53ca\u56fe 8\u20112\u6240\u793a\u7684\u6d41\u7a0b\uff0c\u90fd\u53cd\u6620\u4e86\u6b63\u786e\u6392\u5e8f\u89c4\u5219\u6d41\u7a0b\u7684\u7b2c\u4e00\u90e8\u5206\u3002</p> <p>\\1.    \u5728\u793a\u4f8b\u4e2d\uff0c\u4e00\u4e2a\u88ab\u79f0\u4e3a**Producer****\uff08\u751f\u4ea7\u8005\uff09\u7684\u8bbe\u5907\u5c06\u4f1a\u6267\u884c\u4e00\u4e2a\u6216\u591a\u4e2aMwr\u4e8b\u52a1\uff08Memory Write\uff0cPosted\u8bf7\u6c42\uff09\uff0c\u8981\u5199\u5165\u7684\u4f4d\u7f6e\u4e3a\u5185\u5b58\uff08Memory\uff09\u4e2d\u7684\u4e00\u4e2a**\u6570\u636e****Buffer\u3002\u5728\u6570\u636e\u6d41\u901a\u8fc7Posted Buffer\u65f6\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e00\u4e9b\u65f6\u95f4\u5ef6\u8fdf\u3002</p> <p>\\2.    Consumer\uff08\u6d88\u8d39\u8005\uff09\u4f1a\u5468\u671f\u6027\u7684\u901a\u8fc7\u53d1\u8d77MRd\u4e8b\u52a1\uff08Memory Read\uff0cNon-Posted\u8bf7\u6c42\uff09\u6765\u68c0\u67e5Flag\u4fe1\u53f7\u91cf\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u6570\u636e\u662f\u5426\u5df2\u7ecf\u88abProducer\u53d1\u51fa\u3002</p> <p>\\3.    Flag\u4fe1\u53f7\u91cf\u88abConsumer\u8bbe\u5907\u8bfb\u53d6\uff0c\u5e76\u4ee5MRd Completion\u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9Consumer\uff0c\u7528\u4e8e\u544a\u77e5Consumer\u6570\u636e\u8fd8\u6ca1\u6709\u88abProducer\u53d1\u9001\u51fa\uff08\u56e0\u4e3a\u6b64\u65f6Flag=0\uff09\u3002</p> <p>\\4.    Producer\u901a\u8fc7\u53d1\u9001\u4e00\u4e2aMWr\uff08Posted\u8bf7\u6c42\uff09\u6765\u5c06Flag\u7684\u503c\u66f4\u65b0\u4e3a1.</p> <p>\\5.    \u53c8\u4e00\u6b21\u5730\uff0cConsumer\u53d1\u8d77\u6b65\u9aa42\u4e2d\u76f8\u540c\u7684\u4e8b\u52a1\uff08MRd\uff0cNon-Posted\uff09\u6765\u8bfb\u53d6Flag\u7684\u503c\u3002</p> <p>\\6.    \u8fd9\u4e00\u6b21\uff0cConsumer\u8bfb\u53d6\u5230\u7684Flag\u7684\u503c\u4e3a1\uff0c\u8fd9\u4e5f\u5c31\u662f\u8bf4Consumer\u901a\u8fc7\u8fd9\u6b21MRd Completion\u5f97\u77e5\u4e86\u6240\u6709\u7684\u6570\u636e\u90fd\u5df2\u7ecf\u88abProducer\u53d1\u5f80\u5185\u5b58\uff08Memory\uff09\u4e86\u3002</p> <p>\\7.    \u7136\u540e\uff0cConsumer\u53d1\u8d77\u4e00\u4e2aMWr\u4e8b\u52a1\uff08Posted\u8bf7\u6c42\uff09\u6765\u5c06Flag\u4fe1\u53f7\u91cf\u6e05\u9664\u4e3a0\u3002</p> <p>\u56fe 8\u20113\u7ee7\u7eed\u5c55\u793a\u4e86\u793a\u4f8b\u7684\u7b2c\u4e8c\u90e8\u5206\u6d41\u7a0b\u3002</p> <p>\\8.    Producer\uff08\u751f\u4ea7\u8005\uff09\u73b0\u5728\u6709\u66f4\u591a\u7684\u6570\u636e\u9700\u8981\u53d1\u9001\uff0c\u5b83\u901a\u8fc7\u53d1\u8d77MRd\u4e8b\u52a1\uff08Non-Posted\u8bf7\u6c42\uff09\u7684\u65b9\u5f0f\u5468\u671f\u6027\u7684\u68c0\u67e5Status\u4fe1\u53f7\u91cf\u3002</p> <p>\\9.    Status\u4fe1\u53f7\u91cf\u88abProducer\u8bbe\u5907\u8bfb\u53d6\uff0c\u5e76\u4ee5MRd Completion\u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9Producer\uff0c\u7528\u4e8e\u544a\u77e5Consumer\u8fd8\u6ca1\u6709\u8bfb\u53d6\u5185\u5b58\u4e2d\u7684\u6570\u636eBuffer\u5e76\u4e14\u4e5f\u6ca1\u6709\u66f4\u65b0Status\u4fe1\u53f7\u91cf\uff0c\u56e0\u4e3aStatus=0\u3002</p> <p>\\10.  \u5bf9\u4e8eConsumer\uff0c\u5b83\u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86\u5185\u5b58Buffer\u4e2d\u6709\u53ef\u7528\u6570\u636e\uff0c\u6240\u4ee5\u5b83\u4f1a\u53d1\u8d77\u4e00\u4e2a\u6216\u591a\u4e2aMRd\uff08Non-Posted\u8bf7\u6c42\uff09\u6765\u4eceBuffer\u4e2d\u83b7\u53d6\u8fd9\u4e9b\u6570\u636e\u3002</p> <p>\\11.  \u5185\u5b58Buffer\u7684\u5185\u5bb9\u88ab\u8bfb\u53d6\u5e76\u8fd4\u56de\u7ed9Consumer\u3002</p> <p>\\12.  \u5728\u5b8c\u6210\u4e86\u5185\u5b58\u5230Consumer\u7684\u6570\u636e\u4f20\u8f93\u540e\uff0cConsumer\u53d1\u8d77\u4e00\u4e2aMWr\uff08Posted\u8bf7\u6c42\uff09\u5c06Status\u4fe1\u53f7\u91cf\u7f6e\u4e3a1\u3002</p> <p>\\13.  \u53c8\u4e00\u6b21\u5730\uff0cProducer\u901a\u8fc7\u53d1\u8d77MRd\uff08Non-Posted\u8bf7\u6c42\uff09\u6765\u68c0\u67e5Status\u4fe1\u53f7\u91cf\u3002</p> <p>\\14.  Producer\u8bbe\u5907\u8bfb\u53d6Status\uff0c\u800c\u6b64\u65f6Status=1\u3002MRd Completion\u8fd4\u56de\u7ed9Producer\uff0c\u4ece\u800cProducer\u4e5f\u5c31\u77e5\u9053\u4e86\u5185\u5b58Buffer\u4e2d\u7684\u6570\u636e\u5df2\u7ecf\u88abConsumer\u8bfb\u51fa\uff0c\u90a3\u4e48Producer\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5411\u5185\u5b58Buffer\u53d1\u9001\u6570\u636e\u4e86\u3002</p> <p>\\15.  Producer\u901a\u8fc7\u53d1\u8d77MWr\u6765\u5c06Status\u4fe1\u53f7\u91cf\u6e05\u9664\u4e3a0\u3002</p> <p>\\16.  Producer\u91cd\u590d\u4ee5\u4e0a\u6309\u987a\u5e8f\u4ece\u6b65\u9aa41\u5f00\u59cb\u7684\u4e00\u7cfb\u5217\u4e8b\u4ef6\u3002</p> <p></p> <p>\u56fe 8\u20112\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b\u793a\u4f8b\u2014\u2014\u7b2c\u4e00\u90e8\u5206</p> <p>\u200b                </p> <p></p> <p>\u56fe 8\u20113\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b\u793a\u4f8b\u2014\u2014\u7b2c\u4e8c\u90e8\u5206</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#842-producerconsumer-sequence-errors","title":"8.4.2     \u51fa\u9519\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6392\u5e8f\uff08Producer/Consumer Sequence-Errors\uff09","text":"<p>\u524d\u9762\u7684\u4f8b\u5b50\u5728\u6ca1\u6709\u8ba8\u8bba\u6392\u5e8f\u89c4\u5219\u7684\u60c5\u51b5\u4e0b\u6b63\u786e\u7684\u6267\u884c\u4e86Producer/Consumer\u6a21\u578b\uff0c\u4f46\u662f\u5b83\u6709\u53ef\u80fd\u4f1a\u53d7\u5230\u7ade\u4e89\u60c5\u51b5\u7684\u5f71\u54cd\u800c\u5bfc\u81f4Producer/Consumer\u6a21\u578b\u6267\u884c\u6d41\u7a0b\u5931\u8d25\u3002\u56fe 8\u20114\u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u6d41\u7a0b\u7528\u4e8e\u6f14\u793a\u5728\u6ca1\u6709\u6267\u884c\u6392\u5e8f\u89c4\u5219\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u51fa\u73b0\u7684\u591a\u79cd\u95ee\u9898\u4e2d\u7684\u4e00\u79cd\u3002\u5728\u8fdb\u884c\u4e0b\u5217\u8ba8\u8bba\u65f6\u8bf7\u53c2\u7167\u56fe 8\u20114\u3002</p> <p>\\1.    Producer\u5411\u5185\u5b58Buffer\u53d1\u8d77MWr\u4e8b\u52a1\uff08Posted\u8bf7\u6c42\uff09\u3002\u6211\u4eec\u5047\u8bbe\u8981\u5199\u5165\u7684\u6570\u636e\u88ab\u6682\u65f6\u5730\u963b\u585e\u5728\u4e86Switch\u4e0a\u884c\u7aef\u53e3\u7684Posted\u6d41\u63a7Buffer\u4e2d\u3002</p> <p>\\2.    Producer\u53d1\u9001\u4e00\u4e2aMWr\u4e8b\u52a1\uff08Posted\u8bf7\u6c42\uff09\u6765\u5c06Flag\u66f4\u65b0\u4e3a1\u3002</p> <p>\\3.    Consumer\u53d1\u8d77MRd\u8bf7\u6c42\uff08Non-Posted\u8bf7\u6c42\uff09\u6765\u68c0\u67e5Flag\u662f\u5426\u88ab\u7f6e\u4e3a1\u3002</p> <p>\\4.    Flag\u7684\u503c\u901a\u8fc7\u4e00\u4e2aCompletion\u8fd4\u56de\u7ed9Consumer\u3002</p> <p>\\5.    \u7531\u4e8eFlag=1\uff0cConsumer\u8ba4\u4e3a\u6570\u636e\u5df2\u7ecf\u4eceProducer\u53d1\u9001\u7ed9\u5185\u5b58Buffer\u4e86\uff0c\u56e0\u6b64\u5b83\u5c31\u53d1\u8d77MRd\u8bf7\u6c42\u6765\u83b7\u53d6\u5185\u5b58Buffer\u4e2d\u7684\u6570\u636e\u3002\u7136\u800cConsumer\u5e76\u4e0d\u77e5\u9053\uff0c\u7531\u4e8eSwitch\u4e0a\u884c\u7aef\u53e3\u548cRC\u4e4b\u95f4\u94fe\u8def\u7684\u6d41\u63a7Credit\u4e0d\u8db3\uff0c\u5bfc\u81f4\u6570\u636e\u88ab\u6682\u65f6\u5730\u963b\u585e\u5728Switch\u4e0a\u884c\u7aef\u53e3\u7684Posted\u6d41\u63a7Buffer\u4e2d\u3002\u7ed3\u679c\uff0cConsumer\u4ece\u8fd4\u56de\u7684MRd Completion\u4e2d\u6240\u83b7\u53d6\u5230\u7684\u6570\u636e\u662f\u5185\u5b58Buffer\u4e2d\u539f\u6709\u7684\u65e7\u6570\u636e\u800c\u4e0d\u662fProducer\u6b64\u6b21\u53d1\u51fa\u7684\u65b0\u6570\u636e\u3002</p> <p>\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u62d3\u6251\u7ed3\u6784\u4e2d\u7684Virtual PCI Bridge\u6240\u652f\u6301\u7684\u6392\u5e8f\u89c4\u5219\u6765\u907f\u514d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u5f53Consumer\u5728\u6267\u884c\u6b65\u9aa43\u30014\u7684MRd\u4e8b\u52a1\u65f6\uff0cSwitch\u4e0a\u884c\u7aef\u53e3\u7684Virtual PCI Bridge\u4e0d\u80fd\u8ba9\u542b\u6709Flag\u503c\u7684Completion\u8d85\u524d\u4e8e\u6b64\u524d\u7684Posted MWr\u7684\u6570\u636e\u88ab\u8f6c\u53d1\uff08\u8fd9\u4e2aCompletion\u548cMWr\u4e8b\u52a1\u90fd\u8981\u7ecf\u8fc7Switch\u7684\u4e0a\u884c\u7aef\u53e3\u8f6c\u53d1\uff09\u3002\u8fd9\u79cd\u60c5\u51b5\u5c31\u662f\u8868 8\u20111\u4e2d\u7684D2a\u3002</p> <p></p> <p>\u56fe 8\u20114\u51fa\u9519\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#85-relaxed-ordering","title":"8.5 \u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09","text":"<p>PCIe\u4e2d\u652f\u6301PCI-X\u5f15\u5165\u7684\u5bbd\u677e\u6392\u5e8f\u673a\u5236\uff08Relaxed Ordering\uff0cRO\uff09\u3002RO\u673a\u5236\u5141\u8bb8Requester\u548cCompleter\u4e4b\u95f4\u8def\u5f84\u4e0a\u7684Switch\u5bf9\u4e00\u4e9b\u4e8b\u52a1\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u6027\u80fd\u3002</p> <p>\u7528\u6765\u652f\u6301Producer/Consumer\u6a21\u578b\u7684\u6392\u5e8f\u89c4\u5219\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u88ab\u963b\u585e\uff0c\u5373\u4f7f\u8fd9\u4e9b\u88ab\u963b\u585e\u7684\u4e8b\u52a1\u4e0eProducer/Consumer\u6a21\u578b\u7684\u5de5\u4f5c\u6d41\u7a0b\u6beb\u65e0\u5173\u7cfb\u3002\u4e3a\u4e86\u51cf\u5c11\u8fd9\u79cd\u95ee\u9898\uff0c\u53ef\u4ee5\u5c06\u4e00\u4e2a\u4e8b\u52a1\u7684RO\u5c5e\u6027\u4f4d\u7f6e\u4e3a1\uff0c\u8fd9\u8868\u793a\u8f6f\u4ef6\u786e\u5b9a\u8fd9\u4e2a\u4e8b\u52a1\u4e0e\u5176\u4ed6\u4e8b\u52a1\u6ca1\u6709\u4efb\u4f55\u5173\u8054\uff0c\u5141\u8bb8\u5b83\u91cd\u65b0\u6392\u5e8f\u5728\u5176\u4ed6\u4e8b\u7269\u4e4b\u524d\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aPosted\u7684\u5199\u4e8b\u52a1\u56e0\u4e3a\u76ee\u7684Buffer\u7a7a\u95f4\u4e0d\u8db3\u800c\u88ab\u5ef6\u8fdf\u963b\u585e\uff0c\u90a3\u4e48\u5fc5\u987b\u8981\u7b49\u5230\u8fd9\u4e2a\u5199\u4e8b\u52a1\u7684\u963b\u585e\u95ee\u9898\u89e3\u51b3\u5e76\u4e14\u5199\u4e8b\u52a1\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u624d\u80fd\u53d1\u9001\u540e\u7eed\u7684\u4efb\u4f55\u4e8b\u52a1\u3002\u5982\u679c\u5728\u540e\u7eed\u5230\u6765\u7684\u4e8b\u52a1\u4e2d\uff0c\u6709\u4e00\u4e2a\u4e8b\u52a1\u662f\u8f6f\u4ef6\u786e\u5b9a\u5b83\u4e0e\u5176\u4ed6\u6b64\u524d\u7684\u4e8b\u52a1\u6ca1\u6709\u5173\u8054\uff0c\u4e14\u5b83\u7684RO bit\u4e5f\u88ab\u7f6e\u4e3a1\u4ee5\u6b64\u6765\u8868\u793a\u8fd9\u79cd\u65e0\u5173\u8054\u6027\uff0c\u90a3\u4e48\u5728Posted\u5199\u8bf7\u6c42\u89e3\u51b3\u963b\u585e\u95ee\u9898\u4e4b\u524d\u5c31\u53ef\u4ee5\u53d1\u9001\u8fd9\u4e2a\u4e8b\u52a1\uff0c\u800c\u4e0d\u7528\u8ba9\u5b83\u4e5f\u7b49\u5f85\u5199\u8bf7\u6c42\uff0c\u4e14\u8fd9\u6837\u505a\u5e76\u4e0d\u4f1a\u5f15\u53d1\u4efb\u4f55\u95ee\u9898\u3002</p> <p>\u5f53\u8bbe\u5907\u9a71\u52a8\u652f\u6301\u5e76\u542f\u7528RO bit\uff08\u5982\u56fe 8\u20115\u6240\u793a\uff0c\u5b83\u5728TLP Header\u4e2dDW0\u7684Byte2\u4e2d\u7684Bit5\uff09\uff0c\u8bbe\u5907\u624d\u6709\u53ef\u80fd\u4f1a\u4f7f\u7528\u5b83\u3002\u7136\u540e\uff0c\u5f53\u8f6f\u4ef6\u8bf7\u6c42\u53d1\u9001\u4e00\u4e2a\u6570\u636e\u5305\u65f6\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5305\u8981\u6839\u636e\u8f6f\u4ef6\u7684\u6307\u793a\u6765\u4f7f\u7528RO\u8fd9\u4e2a\u5c5e\u6027\u4f4d\u3002\u5f53Switch\u6216\u8005RC\u53d1\u73b0\u4e00\u4e2a\u6570\u636e\u5305\u7684RO bit\u662f\u7f6e\u4e3a1\u7684\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u91cd\u6392\u5e8f\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u5f3a\u5236\u8981\u6c42\u5b83\u4eec\u4e00\u5b9a\u8981\u8fd9\u6837\u505a\u3002</p> <p></p> <p>\u56fe 8\u20115\u5bbd\u677e\u6392\u5e8f\u6807\u5fd7\u4f4d\u572832bit Header\u4e2d\u7684\u4f4d\u7f6e</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#851-romwrmessagero-effects-on-mwr-and-message","title":"8.5.1     RO\u5bf9MWr\u548cMessage\u7684\u5f71\u54cd\uff08RO Effects on MWr and Message\uff09","text":"<p>Switch\u548cRC\u5fc5\u987b\u89c2\u5bdf\u4e8b\u52a1\u7684RO\u5c5e\u6027\u4f4d\u7684\u503c\u3002MWr\u548cMessage\u90fd\u662fPosted\u5199\u4e8b\u52a1\uff0c\u90fd\u7531\u540c\u4e00\u4e2aPosted Buffer\u6765\u63a5\u6536\uff0c\u4e5f\u90fd\u9075\u4ece\u540c\u4e00\u4e2a\u6392\u5e8f\u8981\u6c42\u3002\u5f53RO bit\u4e3a1\u65f6\uff0cSwitch\u5904\u7406\u8fd9\u4e9b\u4e8b\u52a1\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a</p> <p>n \u5141\u8bb8Switch\u5bf9\u521a\u4e0b\u53d1\u7684MWr\u4e8b\u52a1\uff08RO bit=1\uff09\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff0c\u4f7f\u5176\u53ef\u4ee5\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684Posted MWr\u6216\u662fMessage\u4e8b\u52a1\u4e4b\u524d\u3002\u7c7b\u4f3c\u5730\uff0c\u521a\u4e0b\u53d1\u7684Message\u4e8b\u52a1\uff08RO bit=1\uff09\u4e5f\u53ef\u4ee5\u53ef\u4ee5\u91cd\u65b0\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684Posted MWr\u6216\u662fMessage\u4e8b\u52a1\u4e4b\u524d\u3002Switch\u5728\u8f6c\u53d1\u4e8b\u52a1\u65f6\u4e5f\u5fc5\u987b\u4fdd\u6301RO bit\u4e0d\u6539\u53d8\u3002PCI-X Bridge\u4f1a\u5ffd\u7565RO bit\uff0c\u5b83\u603b\u662f\u6309\u7167\u539f\u987a\u5e8f\u8f6c\u53d1\u5199\u4e8b\u52a1\uff08PCI-X\u4e2d\u8ba9\u5199\u4e8b\u52a1\u6539\u53d8\u987a\u5e8f\u5e76\u6ca1\u6709\u592a\u5927\u4f5c\u7528\uff0c\u5982\u679c\u4e00\u4e2a\u5199\u4e8b\u52a1\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u88ab\u963b\u585e\u4e86\uff0c\u90a3\u4e48\u5373\u4f7f\u66f4\u6539\u4e86\u987a\u5e8f\uff0c\u88ab\u63d0\u524d\u7684\u90a3\u4e00\u4e2a\u5199\u4e8b\u52a1\u4e5f\u8fd8\u662f\u4f1a\u88ab\u963b\u585e\uff09\u3002\u53e6\u4e00\u4e2a\u4e0d\u540c\u5c31\u662fPCI-X\u4e2d\u5e76\u6ca1\u6709\u5b9a\u4e49Message\u4e8b\u52a1\u3002</p> <p>n \u5141\u8bb8RC\u5bf9Posted\u5199\u4e8b\u52a1\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff08PCI-X\u4e2d\u8fd9\u4e5f\u4f1a\u8d77\u5230\u4f5c\u7528\uff0c\u56e0\u4e3aRC\u53ef\u4ee5\u5411\u4e0d\u540c\u533a\u57df\u7684\u5185\u5b58\u8fdb\u884c\u5199\u5165\uff0c\u56e0\u6b64\u5373\u4f7f\u4e00\u4e2a\u533a\u57df\u6b63\u5fd9RC\u4e5f\u53ef\u4ee5\u5199\u5165\u53e6\u4e00\u4e2a\u4e0d\u540c\u7684\u5185\u5b58\u533a\u57df\uff09\u3002\u540c\u6837\u5730\uff0c\u5f53RC\u63a5\u6536\u5230\u7684\u5199\u4e8b\u52a1RO bit=1\u65f6\uff0c\u5b83\u53ef\u4ee5\u6309\u7167\u4efb\u4f55\u5730\u5740\u987a\u5e8f\u6765\u5199\u5165\u6bcf\u4e00\u4e2aByte\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#852-romrdro-effects-on-mrd-transactions","title":"8.5.2     RO\u5bf9MRd\u4e8b\u52a1\u7684\u5f71\u54cd\uff08RO Effects on MRd Transactions\uff09","text":"<p>PCIe\u4e2d\u6240\u6709\u7684\u8bfb\u4e8b\u52a1\u90fd\u91c7\u7528\u62c6\u5206\u4e8b\u52a1\uff08Split Transaction\uff09\u7684\u65b9\u5f0f\u6765\u5904\u7406\u3002\u5f53\u4e00\u4e2a\u8bbe\u5907\u53d1\u51fa\u4e00\u4e2aRO bit=1\u7684MRd\u8bf7\u6c42\uff0cCompleter\u5c06\u4f1a\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u4e00\u4e2a\u6216\u591a\u4e2aSplit Completion\u4e8b\u52a1\uff08\u62c6\u5206\u5b8c\u6210\u5305\uff09\u6765\u8fd4\u56deRequester\u8bbe\u5907\u6240\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u4e14\u5728\u5b8c\u6210\u5305\u4e2d\u4f7f\u7528\u548c\u5f53\u521d\u8bf7\u6c42\u5305\u76f8\u540c\u7684RO bit\u503c\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0bSwitch\u7684\u5de5\u4f5c\u884c\u4e3a\u5982\u4e0b\uff1a</p> <p>\\1.    \u5f53Switch\u63a5\u6536\u5230\u4e00\u4e2aRO bit=1\u7684MRd\u65f6\uff0c\u5b83\u4f1a\u5c06MRd\u8bf7\u6c42\u6309\u7167\u63a5\u6536\u65f6\u7684\u987a\u5e8f\u6765\u8fdb\u884c\u8f6c\u53d1\uff0c\u4e00\u5b9a\u4e0d\u80fd\u8ba9\u5176\u91cd\u65b0\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684MWr\u4e8b\u52a1\u4e4b\u524d\u3002\u8fd9\u4fdd\u8bc1\u4e86\u6240\u6709\u548c\u8bfb\u8bf7\u6c42\u540c\u65b9\u5411\u4f20\u8f93\u7684\u5199\u4e8b\u52a1\u90fd\u4f1a\u88ab\u63a8\u5230\u8bfb\u8bf7\u6c42\u4e4b\u524d\u3002\u8fd9\u662f\u4e4b\u524d\u7684Producer/Consumer\u4f8b\u5b50\u7684\u4e00\u90e8\u5206\uff0c\u8f6f\u4ef6\u53ef\u80fd\u8981\u4f9d\u8d56\u8fd9\u4e2a\u7c7b\u4f3c\u5237\u65b0\u7684\u4e3e\u52a8\u6765\u8fdb\u884c\u6b63\u786e\u7684\u64cd\u4f5c\u3002Switch\u4e00\u5b9a\u4e0d\u80fd\u66f4\u6539RO bit\u7684\u503c\u3002</p> <p>\\2.    \u5f53Completer\u63a5\u6536\u5230MRd\u8bf7\u6c42\uff0c\u5b83\u5c06\u6536\u96c6\u88ab\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u7136\u540e\u4ee5\u4e00\u4e2a\u6216\u591a\u4e2aCompletion\u5b8c\u6210\u5305\u7684\u5f62\u5f0f\u8fdb\u884c\u53d1\u9001\uff0c\u8fd9\u4e9bCompletion\u90fd\u5177\u6709\u8ddf\u8bf7\u6c42\u5305\u4e2d\u76f8\u540c\u7684RO\u5c5e\u6027\u3002</p> <p>\\3.    Switch\u63a5\u6536\u5230RO bit=1\u7684Completion\u5b8c\u6210\u5305\u65f6\uff0c\u53ef\u4ee5\u5c06\u5b83\u4eec\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff0c\u5c06\u8fd9\u4e9bCompletion\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684\u4e0eCompletion\u540c\u65b9\u5411\u4f20\u8f93\u7684MWr\u4e4b\u524d\u3002\u5982\u679c\u5199\u4e8b\u52a1\u88ab\u963b\u585e\u4e86\uff08\u4f8b\u5982\u88ab\u6d41\u63a7\u963b\u585e\uff09\uff0c\u90a3\u4e48Completion\u5c31\u53ef\u4ee5\u88ab\u6392\u5728\u5199\u4e8b\u52a1\u4e4b\u524d\u53d1\u9001\uff0c\u4e0d\u7528\u7b49\u5f85\u5199\u4e8b\u52a1\u963b\u585e\u7ed3\u675f\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u5bbd\u677e\u6392\u5e8f\uff08RO\uff09keyi \u6539\u8fdb\u8bfb\u64cd\u4f5c\u6027\u80fd\u3002\u4e2d\u603b\u7ed3\u4e86Switch\u5141\u8bb8\u7684\u5bbd\u677e\u6392\u5e8f\u884c\u4e3a\u3002</p> <p></p> <p>\u8868 8\u20112\u5bbd\u677e\u6392\u5e8f\u4e2d\u53ef\u4ee5\u88ab\u91cd\u65b0\u6392\u5e8f\u7684\u4e8b\u52a1</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#86-weak-ordering","title":"8.6 \u5f31\u6392\u5e8f\uff08Weak Ordering\uff09","text":"<p>\u5f53\u4e25\u683c\u6267\u884c\u5f3a\u6392\u5e8f\u89c4\u5219\u65f6\u53ef\u80fd\u4f1a\u51fa\u73b0\u6682\u65f6\u7684\u4e8b\u52a1\u963b\u585e\u95ee\u9898\u3002\u5728\u4e0d\u8fdd\u53cdProducer/Consumer\u7f16\u7a0b\u6a21\u578b\u7684\u524d\u63d0\u4e0b\u53ef\u4ee5\u5bf9\u5f3a\u6392\u5e8f\u6a21\u578b\u8fdb\u884c\u4e00\u5b9a\u7684\u4fee\u6539\uff0c\u4f7f\u5176\u53ef\u4ee5\u6d88\u9664\u4e00\u4e9b\u963b\u585e\u4e8b\u52a1\u7684\u60c5\u51b5\uff0c\u4ee5\u6b64\u6765\u63d0\u5347\u94fe\u8def\u6548\u7387\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b9e\u73b0\u5f31\u6392\u5e8f\u6a21\u578b\uff08Weakly-Ordered model\uff09\u662f\u53ef\u4ee5\u7f13\u89e3\u5f3a\u6392\u5e8f\u6a21\u578b\u4e2d\u963b\u585e\u4e8b\u52a1\u7684\u95ee\u9898\u7684\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#861-transaction-ordering-and-flow-control","title":"8.6.1     \u4e8b\u52a1\u7684\u6392\u5e8f\u4e0e\u6d41\u63a7\uff08Transaction Ordering and Flow Control\uff09","text":"<p>\u4e4b\u6240\u4ee5\u8981\u5c06\u7ed9\u5b9a\u6570\u91cf\u7684VC Buffer\u62c6\u5206\u6210\u6d41\u63a7\u5b50Buffer\uff08Posted\u3001Non-Posted\u548cCpl\uff09\uff0c\u662f\u56e0\u4e3a\u5c06TLP\u88ab\u89e3\u6790\u6216\u5f52\u5165\u5404\u81ea\u7684Buffer\u540e\u53ef\u4ee5\u7b80\u5316\u5bf9\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u7684\u5904\u7406\u8fc7\u7a0b\u3002\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u5904\u7406\u903b\u8f91\u4e4b\u540e\u5c31\u53ea\u9700\u8981\u5728\u8fd9\u4e09\u4e2a\u5b50Buffer\u4e4b\u95f4\u6216\u662f\u6bcf\u4e2a\u5b50Buffer\u53bb\u5e94\u7528\u6392\u5e8f\u89c4\u5219\u5373\u53ef\u3002</p> <p>\u56e0\u4e3aTLP\u88ab\u5f52\u5165\u5404\u81ea\u7c7b\u522b\u7684\u4e09\u4e2a\u5b50Buffer\u6765\u5e94\u7528\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\uff0c\u90a3\u4e48\u5c31\u5fc5\u987b\u8981\u5b9a\u4e49\u94fe\u8def\u4e24\u7aef\u7aef\u53e3\u4e4b\u95f4\u6bcf\u79cdVC\u5b50Buffer\uff08P\u3001NP\u3001Cpl\uff09\u7684\u6d41\u63a7\u673a\u5236\u3002\u5b9e\u9645\u4e0a\uff0c\u4f60\u53ef\u80fd\u4f1a\u56de\u60f3\u8d77\u6765\u5bf9\u4e8e\u6bcf\u79cdVC\u5b50Buffer\u5927\u7c7b\uff08P\u3001NP\u3001Cpl\uff09\u6765\u8bf4\uff0c\u5b83\u4eec\u5404\u81ea\u7684\u66f4\u7b2c\u4e00\u5c42\u7ea7\u7684Header\uff08Hdr\uff09\u548cData\uff08D\uff09\u8fd9\u4e24\u79cd\u5b50Buffer\u4e4b\u95f4\u62e5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u6d41\u63a7\u673a\u5236\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#862-transaction-stalls","title":"8.6.2     \u4e8b\u52a1\u6682\u505c\uff08Transaction Stalls\uff09","text":"<p>\u5f3a\u6392\u5e8f\u89c4\u5219\u53ef\u80fd\u4f1a\u51fa\u73b0\u7531\u4e8e\u5355\u4e2a\u63a5\u6536Buffer\u6ee1\u800c\u963b\u585e\u6240\u6709\u4e8b\u52a1\u7684\u60c5\u51b5\u3002\u4f8b\u5982\uff0cProducer/Consumer\u6a21\u578b\u76f8\u5173\u4e8b\u52a1\u7684\u6392\u5e8f\u8981\u6c42\u4e0d\u80fd\u53d8\uff0c\u4f46\u662f\u4e0e\u6a21\u578b\u4e0d\u76f8\u5173\u7684\u4e8b\u52a1\u7684\u6392\u5e8f\u89c4\u5219\u662f\u53ef\u4ee5\u6539\u53d8\u7684\uff0c\u82e5\u90fd\u5b8c\u5168\u4f7f\u7528\u5f3a\u6392\u5e8f\u89c4\u5219\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u51fa\u73b0\u963b\u585e\u5176\u4ed6\u4e0d\u76f8\u5173\u4e8b\u52a1\u7684\u60c5\u51b5\u3002\u4e3a\u4e86\u6539\u5584\u6027\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e00\u79cd\u5f31\u6392\u5e8f\u65b9\u6848\uff0c\u8fd9\u662f\u4e00\u79cd\u5bf9\u4e8b\u52a1\u6392\u5e8f\u65bd\u52a0\u6700\u4f4e\u8981\u6c42\u7684\u65b9\u6848\u3002</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff08\u56fe 8\u20116\uff09\u5c55\u793a\u4e86\u5728\u4e00\u4e2aVC\u4e2d\u5355\u5411\u4f20\u8f93\u7684\u4e8b\u52a1\u76f8\u5173\u7684\u53d1\u9001\u548c\u63a5\u6536Buffer\u3002\u56de\u5fc6\u4e00\u4e0b\uff0c\u5728\u540c\u4e00VC\u4e2d\u6bcf\u79cd\u4e8b\u52a1\u7c7b\u578b\uff08P\u3001NP\u3001Cpl\uff09\u90fd\u6709\u72ec\u7acb\u7684\u6d41\u63a7\u673a\u5236\u3002\u53d1\u9001Buffer\u5185\u7684\u6570\u5b57\u8868\u793a\u8fd9\u4e9b\u4e8b\u52a1\u88ab\u5206\u914d\u7684\u53d1\u9001\u987a\u5e8f\uff0c\u5e76\u4e14\u6b64\u65f6Non-Posted\u63a5\u6536Buffer\u5df2\u7ecf\u6ee1\u4e86\u3002</p> <p></p> <p>\u56fe 8\u20116\u5f3a\u6392\u5e8f\u89c4\u5219\u5bfc\u81f4\u7684\u4e8b\u52a1\u4e34\u65f6\u6682\u505c</p> <p>\u8003\u8651\u4e0b\u9762\u7684\u6d41\u7a0b\uff1a</p> <p>\\1.    \u4e8b\u52a11\uff08MRd\uff09\u662f\u4e0b\u4e00\u4e2a\u8981\u88ab\u53d1\u9001\u7684\u4e8b\u52a1\uff0c\u4f46\u662f\u6b64\u65f6\u5e76\u6ca1\u6709\u8db3\u591f\u7684Non-Posted\u6d41\u63a7Credit\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u8981\u7b49\u5f85\u3002</p> <p>\\2.    \u4e8b\u52a12\uff08Posted MWr\uff09\u662f\u7d27\u8ddf\u4e8b\u52a11\u4e4b\u540e\u7684\u5f85\u53d1\u9001\u4e8b\u52a1\u3002\u5982\u679c\u6267\u884c\u7684\u662f\u5f3a\u6392\u5e8f\u89c4\u5219\uff0c\u90a3\u4e48\u8fd9\u4e2aMWr\u4e00\u5b9a\u4e0d\u80fd\u91cd\u6392\u5728\u4e8b\u52a11\u4e4b\u524d\u3002</p> <p>\\3.    \u8fd9\u79cd\u5f3a\u6392\u5e8f\u7684\u7ea6\u675f\u4e5f\u4f1a\u5e94\u7528\u5728\u540e\u9762\u7684\u6240\u6709\u4e8b\u52a1\u4e0a\uff0c\u6240\u4ee5\u5c31\u4f1a\u5bfc\u81f4\u4ed6\u4eec\u90fd\u6682\u505c\u4e86\u4e0b\u6765\uff0c\u8981\u7b49\u5f85\u4e8b\u52a11\u4f20\u8f93\u5b8c\u6210\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#863-vc-buffervc-buffers-offer-an-advantage","title":"8.6.3     VC Buffer\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4f18\u70b9\uff08VC Buffers Offer an Advantage\uff09","text":"<p>\u4e8b\u52a1\u7684\u987a\u5e8f\u662f\u5728VC Buffer\u5185\u8fdb\u884c\u7ba1\u7406\u7684\u3002\u8fd9\u4e9bBuffer\u88ab\u6309\u7167\u4e8b\u52a1\u7c7b\u578bPosted\u3001Non-Posted\u548cCompletion\u8fdb\u884c\u5206\u7c7b\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7c7b\u578b\u7684Buffer\u6765\u8bf4\uff0c\u5b83\u7684\u6d41\u63a7\u662f\u4e0e\u5176\u4ed6\u7c7b\u578b\u76f8\u72ec\u7acb\u7684\u3002\u8fd9\u4f7f\u5f97\u5f31\u6392\u5e8f\u89c4\u5219\u66f4\u52a0\u6709\u7528\uff0c\u6bd4\u5982\u5728\u6211\u4eec\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5373\u4f7f\u4e00\u4e2aBuffer\u6ee1\u4e86\uff0c\u4f46\u662f\u5176\u4ed6\u7684Buffer\u8fd8\u6709\u7a7a\u95f4\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728\u89c4\u5219\u5185\u8ba9\u5176\u4ed6\u4e8b\u52a1\u5148\u4f20\u8f93\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#87-idid-based-orderingido","title":"8.7 \u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID Based Ordering\uff0cIDO\uff09","text":"<p>\u53e6\u4e00\u79cd\u4f18\u5316\u6392\u5e8f\u5e76\u63d0\u5347\u6027\u80fd\u7684\u65b9\u6cd5\u4e0e\u6d41\u7684\u6027\u8d28\u6709\u5173\u3002\u6765\u81ea\u4e0d\u540cRequester\u7684\u6570\u636e\u5305\u901a\u5e38\u5e76\u6ca1\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u6bd5\u7adf\u4e00\u4e2a\u8bbe\u5907\u5f88\u96be\u6839\u636e\u4f20\u8f93\u987a\u5e8f\u5c31\u77e5\u9053\u53e6\u4e00\u4e2a\u8bbe\u5907\u5728\u4ec0\u4e48\u65f6\u5019\u5b8c\u6210\u4e86\u67d0\u4e9b\u6b65\u9aa4\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u80fd\u6709\u5404\u81ea\u4e0d\u540c\u7684\u8def\u5f84\u6765\u53bb\u5f80\u5b83\u4eec\u5171\u4eab\u7684\u8d44\u6e90\u3002\u8003\u8651\u5230\u8fd9\u4e00\u70b9\uff0cPCIe\u76842.1\u7248\u672c\u534f\u8bae\u89c4\u8303\u4e2d\u5f15\u5165\u4e86\u4e00\u79cd\u88ab\u79f0\u4e3a\u57fa\u4e8eID\u7684\u6392\u5e8f\u89c4\u5219\uff08ID-Based Ordering\uff09\u6765\u63d0\u5347\u6027\u80fd\u3002</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#871-the-solution","title":"8.7.1     \u89e3\u51b3\u65b9\u6848\uff08The Solution\uff09","text":"<p>\u5982\u679c\u6570\u636e\u5305\u7684\u6765\u6e90\u5e76\u6ca1\u6709\u8003\u8651\u4e8b\u52a1\u987a\u5e8f\uff0c\u90a3\u4e48\u6027\u80fd\u5c31\u4f1a\u53d7\u5230\u5f71\u54cd\uff0c\u5982\u56fe 8\u20117\u6240\u793a\u3002\u5728\u56fe\u4e2d\uff0c\u4e8b\u52a11\u4ece\u81ea\u5df1\u7684\u4e8b\u52a1\u6e90\u88ab\u4f20\u8f93\u5230Switch\u7684\u4e0a\u884c\u7aef\u53e3\uff0c\u4f46\u662f\u5728\u5b83\u60f3\u7ee7\u7eed\u4f20\u8f93\u81f3RC\u65f6\u5374\u88ab\u963b\u585e\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3aRC\u7aef\u53e3\u4e2d\u4e0e\u4e4b\u5bf9\u5e94\u7684Buffer\u6ee1\u4e86\uff08\u53ef\u4ee5\u901a\u8fc7\u6d41\u63a7Buffer\u4e0d\u8db3\u6765\u8868\u793a\u8fd9\u4e00\u70b9\uff09\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u534f\u8bae\u89c4\u8303\u4e2d\u7684\u672f\u8bed\uff0c\u6765\u81ea\u540c\u4e00\u4e2aRequester\u7684\u591a\u4e2a\u6570\u636e\u5305\u79f0\u4e3a\u4e00\u4e2aTLP\u6d41\uff08TLP Stream\uff09\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u4e8b\u52a11\u6240\u793a\u7684\u4f20\u8f93\u8def\u5f84\u53ef\u80fd\u4f1a\u8981\u4f20\u8f93TLP\u6d41\u4e2d\u7684\u4e00\u7cfb\u5217TLP\u3002\u4e8b\u52a12\u5bf9\u543c\u4e5f\u5230\u8fbe\u4e86\u540c\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\uff08Switch\u7684\u4e0a\u884c\u7aef\u53e3\uff09\uff0c\u5e76\u4e14\u5b83\u4e5f\u88ab\u963b\u585e\u4e86\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4fdd\u6301\u4e0e\u4e8b\u52a11\u7684\u76f8\u5bf9\u987a\u5e8f\u3002\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u6570\u636e\u5305\u6765\u81ea\u4e0d\u540c\u7684\u4e8b\u52a1\u6e90\uff08\u5c5e\u4e8e\u4e0d\u540c\u7684TLP\u6d41\uff09\uff0c\u56e0\u6b64\u8fd9\u79cd\u5ef6\u8fdf\u7b49\u5f85\u57fa\u672c\u4e0a\u662f\u6ca1\u5fc5\u8981\u7684\uff0c\u5f88\u5927\u6982\u7387\u8fd9\u4e8c\u8005\u5e76\u6ca1\u6709\u76f8\u4e92\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f46\u662f\u5728\u4e00\u822c\u7684\u6392\u5e8f\u89c4\u5219\u4e2d\u5e76\u6ca1\u6709\u8fdb\u884c\u8fd9\u6837\u7684\u8003\u8651\u3002\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u4e0d\u540c\u7684\u89e3\u51b3\u65b9\u6cd5\u3002</p> <p>\u8fd9\u79cd\u89e3\u51b3\u529e\u6cd5\u5f88\u7b80\u5355\uff1a\u5982\u679c\u6570\u636e\u5305\u5404\u81ea\u7684Requester ID\u4e0d\u540c\uff08\u5bf9\u4e8eCompletion\u6765\u8bf4\u662fCompleter ID\uff09\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u5b83\u4eec\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\u3002\u8fd9\u79cd\u53ef\u9009\u80fd\u529b\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u8bbe\u5907\u4f7f\u7528IDO\uff0c\u8fd9\u6837Switch\u7aef\u53e3\u5c31\u53ef\u4ee5\u8bc6\u522b\u51fa\u4e00\u4e9b\u6570\u636e\u5305\u5c5e\u4e8e\u4e0d\u540c\u7684TLP\u6d41\u3002\u8fd9\u662f\u901a\u8fc7\u7f6e\u4f4d\u8bbe\u5907\u63a7\u52362\u5bc4\u5b58\u5668\uff08Device Control 2 Register\uff09\u7684\u4f7f\u80fd\u4f4d\u6765\u5b9e\u73b0\u7684\u3002</p> <p></p> <p>\u56fe 8\u20117\u4e0d\u540c\u6570\u636e\u6e90\u4e4b\u95f4\u4e00\u822c\u6ca1\u6709\u76f8\u4e92\u4f9d\u8d56\u5173\u7cfb</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#872-idowhen-to-use-ido","title":"8.7.2     \u4f55\u65f6\u4f7f\u7528IDO\uff08When to use IDO\uff09","text":"<p>\u8f6f\u4ef6\u53ef\u4ee5\u8ba9\u6765\u81ea\u4e00\u4e2a\u7ed9\u5b9a\u7aef\u53e3\u7684\u8bf7\u6c42\u6216\u5b8c\u6210\u5305\u5e94\u7528IDO\uff0c\u8fd9\u662f\u901a\u8fc7\u8bbe\u7f6eDevice Control 2 Register\u4e2d\u76f8\u5e94\u7684\u4f4d\u6765\u5b9e\u73b0\u7684\u3002\u8ddfRO\u7684\u60c5\u51b5\u4e00\u6837\uff0c\u8bbe\u5907\u4e2d\u5e76\u6ca1\u6709\u80fd\u529b\u4f4d\uff08Capability bit\uff09\u6765\u544a\u8bc9\u8f6f\u4ef6\u8fd9\u4e2a\u8bbe\u5907\u652f\u6301\u4ec0\u4e48\uff0c\u800c\u662f\u53ea\u5b58\u5728\u4f7f\u80fd\u4f4d\uff0c\u56e0\u6b64\u8f6f\u4ef6\u9700\u8981\u901a\u8fc7\u5176\u4ed6\u7684\u4e00\u4e9b\u65b9\u6cd5\u6765\u77e5\u9053\u8fd9\u4e2a\u8bbe\u5907\u53ef\u4ee5\u652f\u6301IDO\uff08\u5426\u5219\u5373\u4f7f\u7f6e\u4f4d\u4e86\u4f7f\u80fd\u4f4d\uff0c\u4f46\u662f\u8bbe\u5907\u5e76\u4e0d\u652f\u6301IDO\uff0c\u90a3\u4e48\u4e5f\u65e0\u6cd5\u4f7f\u7528IDO\uff09\u3002\u8fd9\u4e9bbit\u4f7f\u5f97\u8fd9\u4e9b\u7c7b\u578b\u7684\u6570\u636e\u5305\u53ef\u4ee5\u4f7f\u7528IDO\uff0c\u4f46\u662f\u8f6f\u4ef6\u8fd8\u9700\u8981\u51b3\u5b9a\u662f\u5426\u6bcf\u4e2a\u5355\u72ec\u7684\u6570\u636e\u5305\u90fd\u8981\u5c06\u5b83\u7684IDO bit\u7f6e\u4f4d\u3002TLP Header\u4e2d\u7684\u4e00\u4e2a\u65b0\u7684\u5c5e\u6027\u4f4d\u53ef\u4ee5\u7528\u6765\u6307\u793a\u8fd9\u4e2aTLP\u662f\u5426\u4f7f\u7528IDO\uff0c\u5982\u56fe 8\u20118\u6240\u793a\u3002\u8005\u5e26\u6765\u4e86\u53e6\u4e00\u4e2a\u76f8\u5173\u7684\u70b9\uff1aCompletion\u4e00\u822c\u4f1a\u76f4\u63a5\u7ee7\u627f\u5bf9\u5e94\u8bf7\u6c42\u5305\u4e2d\u6240\u6709\u7684\u5c5e\u6027\u4f4d\uff0c\u4f46\u662f\u5bf9\u4e8eIDO\u6765\u8bf4\u53ef\u80fd\u5c31\u4e0d\u662f\u8fd9\u6837\u4e86\uff0c\u56e0\u4e3aCompleter\u53ef\u4ee5\u72ec\u7acb\u5730\u542f\u7528IDO\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5373\u4f7f\u8bf7\u6c42\u5305\u4e2d\u6ca1\u6709\u4f7f\u7528IDO\uff0c\u5bf9\u5e94\u7684Completion\u4e5f\u662f\u53ef\u4ee5\u4f7f\u7528IDO\u7684\u3002</p> <p></p> <p>\u56fe 8\u20118 64bit Header\u4e2d\u7684IDO\u5c5e\u6027\u4f4d</p>"},{"location":"pcie/08%20%E4%BA%8B%E5%8A%A1%E6%8E%92%E5%BA%8F/#88-deadlock-avoidance","title":"8.8 \u6b7b\u9501\u7684\u907f\u514d\uff08Deadlock Avoidance\uff09","text":"<p>\u56e0\u4e3aPCI\u603b\u7ebf\u91c7\u7528\u5ef6\u8fdf\u4e8b\u52a1\uff0c\u4e5f\u56e0\u4e3aPCIe\u7684MRd\u8bf7\u6c42\u53ef\u80fd\u4f1a\u56e0\u4e3a\u7f3a\u5c11\u6d41\u63a7Credit\u800c\u88ab\u963b\u585e\uff0c\u5728\u8fd9\u4e9b\u539f\u56e0\u4e0b\u4ea7\u751f\u51fa\u4e86\u4e00\u7cfb\u5217\u7684\u4f1a\u51fa\u73b0\u6b7b\u9501\u7684\u573a\u666f\u3002\u8fd9\u4e9b\u907f\u514d\u6b7b\u9501\u7684\u89c4\u5219\u88ab\u5305\u542b\u5728\u4e86PCIe\u7684\u6392\u5e8f\u89c4\u5219\u4e2d\uff0c\u4ee5\u6b64\u6765\u786e\u4fdd\u4e0d\u7ba1\u62d3\u6251\u7ed3\u6784\u5982\u4f55\u90fd\u4e0d\u4f1a\u53d1\u751f\u6b7b\u9501\u3002\u9075\u5b88\u6392\u5e8f\u89c4\u5219\u53ef\u4ee5\u9632\u6b62\u7531\u4e8e\u51fa\u73b0\u4e86\u610f\u6599\u4e4b\u5916\u7684\u62d3\u6251\u7ed3\u6784\u800c\u4ea7\u751f\u8fb9\u754c\u6761\u4ef6\u65f6\u51fa\u73b0\u7684\u95ee\u9898\uff08\u4f8b\u5982\uff0c\u4e24\u4e2aPCIe-to-PCI Bridge\u8de8PCIe\u7f51\u7edc\u7ed3\u6784\u76f8\u8fde\uff09\u3002\u53c2\u8003MindShare\u7684\u540d\u4e3a\u300aPCI System Architecture\uff0cFourth Edition\u300b\u7684\u4e66\u7c4d\uff0c\u91cc\u9762\u6709\u5bf9\u5404\u79cd\u573a\u666f\u7684\u8be6\u7ec6\u89e3\u91ca\uff0c\u5b83\u4eec\u662fPCIe\u4e2d\u4e0e\u907f\u514d\u6b7b\u9501\u76f8\u5173\u7684\u6392\u5e8f\u89c4\u5219\u7684\u57fa\u7840\u3002\u8868 8\u20111\u4e2d\u5217\u51fa\u4e86\u7528\u6765\u907f\u514d\u6b7b\u9501\u7684\u6392\u5e8f\u89c4\u5219\uff0c\u5b83\u4eec\u4e3aA3\u3001A4\u3001D3\u3001D4\u548cA5b\u3002\u6ce8\u610f\uff0c\u8868\u4e2d\u8fd9\u4e94\u79cd\u4e3a\u201cYes\u201d\u7684\u6761\u76ee\u90fd\u662f\u7528\u6765\u907f\u514d\u6b7b\u9501\u7684\u3002\u5982\u679c\u8868\u4e2d\u52173\u62164\u76f8\u5173\u7684Non-Posted Buffer\u7531\u4e8e\u7f3a\u5c11\u6d41\u63a7Credit\u800c\u51fa\u73b0\u4e86\u963b\u585e\u73b0\u8c61\uff0c\u90a3\u4e48\u884cA\u76f8\u5173\u8054\u7684Posted\u8bf7\u6c42\u6216\u662f\u884cD\u76f8\u5173\u8054\u7684Completion\u5fc5\u987b\u8981\u79fb\u52a8\u5230Non-Posted\u8bf7\u6c42\u4e4b\u524d\uff0c\u4e0d\u96be\u53d1\u73b0\u5b83\u4eec\u5728\u8868\u4e2d\u7684\u9879\u90fd\u662f\u201cYes\u201d\u3002\u8fd8\u9700\u8981\u6ce8\u610f\uff0cA5b\u4e2d\u7684\u201cYes\u201d\u9879\u4ec5\u5f15\u7528\u4e8ePCIe-to-PCI/PCI-X Bridge\u4e2d\u3002</p> <p>\u672c\u8d28\u4e0a\u6765\u8bf4\uff0c\u8fd9\u4e9b\u7528\u6765\u907f\u514d\u6b7b\u9501\u7684\u89c4\u5219\u53ef\u4ee5\u88ab\u603b\u7ed3\u4e3a\u201c\u5fc5\u987b\u8981\u5141\u8bb8\u540e\u5230\u6765\u7684MWr\u8bf7\u6c42\u6216\u662fCompletion\u5728\u987a\u5e8f\u4e0a\u8d85\u8fc7\u5148\u524d\u5230\u6765\u7684\u4f46\u88ab\u963b\u585e\u7684Non-Posted\u8bf7\u6c42\uff0c\u5426\u5219\u5c31\u6709\u53ef\u80fd\u4f1a\u53d1\u751f\u6b7b\u9501\u3002\u201d</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/","title":"Chpater 9 DLLP Element// DLLP \u5143\u7d20","text":""},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#_1","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u8282\u8ba8\u8bba\u4e86PCIe\u62d3\u6251\u7ed3\u6784\u4e2d\u4e8b\u52a1\u5bf9\u6392\u5e8f\u7684\u8981\u6c42\u3002\u8fd9\u4e9b\u89c4\u5219\u662f\u7ee7\u627f\u81ea PCI \u7684\uff0c\u5b83\u4eec\u8bb8\u591a\u90fd\u53d7\u5230\u201c\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff08Producer/Consumer\uff09\u201d\u7a0b\u5e8f\u8bbe\u8ba1\u6a21\u578b\u7684\u63a8\u52a8\uff0c\u56e0\u6b64\u5728\u4e0a\u4e00\u7ae0\u63cf\u8ff0\u4e86\u8fd9\u4e2a\u6a21\u578b\u7684\u673a\u5236\u539f\u7406\u3002\u539f\u59cb\u7684\u89c4\u5219\u4e2d\u8fd8\u8003\u8651\u4e86\u90a3\u4e9b\u5fc5\u987b\u8981\u907f\u514d\u7684\u6b7b\u9501\u60c5\u51b5\u3002</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u5c06\u4f1a\u63cf\u8ff0 Data Link Layer Packet\uff08DLLP\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u3002\u6211\u4eec\u5c06\u4f1a\u63cf\u8ff0\u5176\u7528\u9014\u3001\u683c\u5f0f\u4ee5\u53caDLLP\u6570\u636e\u5305\u7c7b\u578b\u7684\u5b9a\u4e49\uff0c\u4e5f\u5c06\u4f1a\u5bf9\u5176\u76f8\u5173\u5b57\u6bb5\u7684\u7ec6\u8282\u8fdb\u884c\u63cf\u8ff0\u4ecb\u7ecd\u3002DLLP\u53ef\u4ee5\u88ab\u7528\u6765\u652f\u6301 Ack/Nak \u534f\u8bae\u3001\u7535\u6e90\u7ba1\u7406\u3001\u6d41\u63a7\u673a\u5236\uff0c\u8fd8\u53ef\u7528\u6765\u5b9e\u73b0\u4e00\u4e9b\u5382\u5546\u81ea\u5b9a\u4e49\u7684\u7528\u9014\u3002</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u5c06\u63cf\u8ff0\u6570\u636e\u94fe\u8def\u5c42\u7684\u5173\u952e\u7279\u6027\u4e4b\u4e00\uff1a\u57fa\u4e8e\u786c\u4ef6\u7684\u94fe\u8def\u95f4 TLP \u81ea\u52a8\u53ef\u9760\u4f20\u8f93\u673a\u5236\u3002Ack DLLP \u7528\u4e8e\u786e\u8ba4\u4e00\u6b21\u6b63\u5e38 TLP \u7684\u63a5\u6536\uff0c\u800c Nak DLLP \u5219\u8868\u793a\u4e00\u6b21 TLP \u4f20\u8f93\u9519\u8bef\u3002\u6211\u4eec\u5c06\u8ba8\u8bba\u6ca1\u6709\u4fa6\u6d4b\u5230 TLP \u548c DLLP \u9519\u8bef\u65f6\u7684\u6b63\u5e38\u4f20\u8f93\u884c\u4e3a\u7684\u89c4\u5219\uff0c\u4e5f\u4f1a\u8ba8\u8bba TLP \u6216\u8005 DLLP \u9519\u8bef\u53d1\u751f\u65f6\u7684\u9519\u8bef\u6062\u590d\u673a\u5236\u3002</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#91-general","title":"9.1 \u6982\u8ff0\uff08General\uff09","text":"<p>\u6570\u636e\u94fe\u8def\u5c42\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662f\u66f4\u4f4e\u903b\u8f91\u5c42\u6b21\u4e0a\u7684\u94fe\u8def\u534f\u8bae\u7ba1\u7406\u8005\u3002\u6570\u636e\u94fe\u8def\u5c42\u7684\u4e3b\u8981\u804c\u8d23\u662f\u786e\u4fdd TLP \u5728\u8bbe\u5907\u4e4b\u95f4\u7684\u5b8c\u6574\u4f20\u8f93\uff0c\u5e76\u4e14\u4e5f\u53c2\u4e0e\u5230 TLP \u6d41\u91cf\u63a7\u5236\u3001\u94fe\u8def\u521d\u59cb\u5316\u3001\u529f\u8017\u7ba1\u7406\u4ee5\u53ca\u4e3a\u5176\u4e0a\u5c42\u7684\u4e8b\u52a1\u5c42\u548c\u4e0b\u5c42\u7684\u7269\u7406\u5c42\u4e4b\u95f4\u4f20\u9012\u4fe1\u606f\u7b49\u529f\u80fd\u3002\u6570\u636e\u94fe\u8def\u5c42\u901a\u8fc7\u4e0e\u5176\u4ed6\u8bbe\u5907\u4e4b\u95f4\u4ea4\u6362 DLLP\uff08Data Link Layer Packet\uff09\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff0c\u6765\u5b8c\u6210\u4e0a\u8ff0\u529f\u80fd\u3002DLLP \u4f1a\u5728\u5404\u4e2a\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e4b\u95f4\u4f20\u8f93\u901a\u4fe1\uff0c\u56fe 9-1 \u5c55\u793a\u4e86 DLLP \u5728\u8bbe\u5907\u95f4\u7684\u4f20\u8f93\u8def\u5f84\u3002</p> <p></p> <p>\u56fe 9-1 \u6570\u636e\u94fe\u8def\u5c42\u53d1\u9001 DLLP \u793a\u610f\u56fe</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#92-dllp-dllps-are-local-traffic","title":"9.2 DLLP \u662f\u672c\u5730\u6d41\u91cf\uff08DLLPs Are Local Traffic\uff09","text":"<p>DLLP \u7684\u6570\u636e\u5305\u683c\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u7b97\u4e0a\u7ec4\u5e27\u5b57\u8282\uff0c\u6574\u4e2a DLLP \u7684\u957f\u5ea6\u56fa\u5b9a\u4e3a 8 \u5b57\u8282\u3002\u4e0e TLP \u4e0d\u540c\uff0cDLLP \u4e0d\u643a\u5e26\u4efb\u4f55\u76ee\u7684\u5730\u5740\u6216\u8005\u8def\u7531\u4fe1\u606f\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53ea\u7528\u4e8e\u672c\u5730\u76f8\u90bb\u8bbe\u5907\u4e4b\u95f4\u7684\u76f4\u63a5\u901a\u4fe1\uff0c\u65e0\u9700\u8fdb\u884c\u8def\u7531\u3002\u540c\u65f6\uff0cDLLP \u5bf9\u4e8e\u4e0a\u5c42\u7684\u4e8b\u52a1\u5c42\u4e5f\u662f\u4e0d\u53ef\u89c1\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u4e0d\u4f1a\u53c2\u4e0e\u8bbe\u5907\u4e8b\u52a1\u5c42\u95f4\u7684\u4fe1\u606f\u4ea4\u6362\u3002</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#93-dllp-receiver-handling-of-dllps","title":"9.3 DLLP \u63a5\u6536\u4e0e\u5904\u7406\uff08Receiver handling of DLLPs\uff09","text":"<p>\u5f53\u63a5\u6536\u65b9\u6536\u5230 DLLP \u4e4b\u540e\uff0c\u4f1a\u6839\u636e\u4ee5\u4e0b\u89c4\u5219\u8fdb\u884c\u5904\u7406\uff1a</p> <ol> <li>DLLP \u4f1a\u5728\u6536\u5230\u540e\u88ab\u7acb\u5373\u5904\u7406\uff0c\u65e0\u9700\u53d7\u5230 TLP \u7684\u6d41\u91cf\u63a7\u5236\u673a\u5236\u7684\u7ba1\u7406</li> <li>DLLP \u4f1a\u53d7\u5230\u7269\u7406\u5c42\u548c\u6570\u636e\u94fe\u8def\u5c42\u7684\u4e24\u6b21\u9519\u8bef\u68c0\u6d4b\u3002\u94fe\u8def\u5c42\u4f1a\u91cd\u65b0\u8ba1\u7b97\u5305\u7684 CRC \u6821\u9a8c\u7ed3\u679c\uff0c\u5e76\u5c06\u5176\u548c\u5305\u81ea\u8eab\u643a\u5e26\u7684 16 \u6bd4\u7279 CRC \u7ed3\u679c\u8fdb\u884c\u6bd4\u8f83\u3002\u6821\u9a8c\u5931\u8d25\u7684 DLLP \u4f1a\u88ab\u4e22\u5f03\u3002\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff1a\u94fe\u8def\u5982\u4f55\u4ece DLLP \u6821\u9a8c\u9519\u8bef\u4e2d\u6062\u590d\uff1f\u7b54\u6848\u662f\u540e\u7eed\u7684 DLLP \u4ecd\u7136\u4f1a\u5468\u671f\u6027\u5730\u5230\u8fbe\uff0c\u63a5\u4e0b\u6765\u63a5\u6536\u7684\u540c\u7c7b DLLP \u4f1a\u66f4\u65b0\u7f3a\u5931\u7684\u4fe1\u606f\u3002</li> <li>DLLP \u4e0e TLP \u4e0d\u540c\uff0c\u6ca1\u6709\u63a5\u6536\u786e\u8ba4 Ack \u673a\u5236\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u534f\u8bae\u5b9a\u4e49\u7684\u8d85\u65f6\u673a\u5236\u3002\u8d85\u65f6\u673a\u5236\u8d1f\u8d23\u4ece DLLP \u63a5\u6536\u9519\u8bef\u4e2d\u6062\u590d\u3002</li> <li>\u6821\u9a8c\u901a\u8fc7\u7684 DLLP \u5c06\u6839\u636e\u5176\u7c7b\u578b\uff0c\u4f20\u8f93\u7ed9\u76f8\u5e94\u7684\u5185\u90e8\u903b\u8f91\uff0c\u5b8c\u6210\u5982\u4e0b\u529f\u80fd</li> <li>\u901a\u77e5 TLP  Ack/Nak \u72b6\u6001\u7684\u66f4\u65b0</li> <li>\u901a\u77e5\u6d41\u91cf\u63a7\u5236\u673a\u5236\u4e2d\u7684\u53ef\u7528\u7f13\u5b58\u5927\u5c0f\u4fe1\u606f\u7684\u66f4\u65b0</li> <li>\u7535\u6e90\u7ba1\u7406\u8bbe\u7f6e</li> <li>\u5382\u5546\u81ea\u5b9a\u4e49\u4fe1\u606f\u7ba1\u7406</li> </ol>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#94-dllpsending-dllps","title":"9.4 \u53d1\u9001 DLLP\uff08Sending DLLPs\uff09","text":""},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#941-general","title":"9.4.1 \u6982\u8ff0\uff08General\uff09","text":"<p>\u53d1\u9001\u65b9\u5728\u6570\u636e\u94fe\u8def\u5c42\u751f\u6210 DLLP \u5305\uff0c\u7136\u540e\u5c06\u5176\u4f20\u8f93\u7ed9\u7269\u7406\u5c42\u3002\u5982\u679c\u662f Gen1/Gen2 \u6a21\u5f0f\uff0c\u4f7f\u7528 8b/10b \u7f16\u7801\uff0c\u90a3\u4e48\u4f1a\u5728 DLLP \u7684\u5f00\u5934\u548c\u7ed3\u5c3e\u90fd\u52a0\u4e0a\u7ec4\u5e27\u7b26\u53f7\u3002\u5728 Gen3 \u6a21\u5f0f\u4e2d\uff0c2\u5b57\u8282\u7684 SDP \u4ee4\u724c\u4f1a\u88ab\u6dfb\u52a0\u5230 DLLP \u524d\u90e8\uff0c\u4f46\u662f\u4e0d\u4f1a\u5728\u7ed3\u5c3e\u5904\u6dfb\u52a0 END \u7b26\u53f7\u3002\u56fe 9-2 \u63cf\u8ff0\u4e86\u4e00\u4e2a Gen1/Gen2 \u6a21\u5f0f\u7684 DLLP \u53d1\u9001\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u770b\u5230\u5728 DLLP \u7684\u5185\u5bb9\u524d\u540e\u52a0\u4e0a\u4e86\u7ec4\u5e27\u7b26\u53f7\u3002 </p> <p></p> <p>\u56fe 9-2 \u539f\u751f\u6570\u636e\u94fe\u8def\u5c42\u6570\u636e\u5305\u683c\u5f0f</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#942-dllp-8-dllp-packet-size-is-fixed-at-8-bytes","title":"9.4.2 DLLP \u5305\u5927\u5c0f\u56fa\u5b9a\u4e3a 8 \u5b57\u8282\uff08DLLP Packet Size is Fixed at 8 Bytes\uff09","text":"<p>DLLP \u5305\u56fa\u5b9a\u4e3a 8 \u5b57\u8282\u5927\u5c0f\uff0c\u65e0\u8bba\u662f\u5728 8b/10b \u6216\u8005128b/130b \u7f16\u7801\u65b9\u5f0f\u4e0b\uff0c\u5176\u5305\u62ec\u4ee5\u4e0b\u7ec4\u6210\u90e8\u5206\uff1a</p> <ol> <li>1DW\uff084byte\uff09\u7684 DLLP \u6838\u5fc3\u5b57\u6bb5\uff0c\u5305\u62ec 1 \u5b57\u8282\u7684 DLLP \u7c7b\u578b\u4e0e\u53e6\u5916 3 \u5b57\u8282\u5c5e\u6027\u5b57\u6bb5\u3002\u5c5e\u6027\u5b57\u6bb5\u542b\u4e49\u968f DLLP \u7c7b\u578b\u800c\u53d8\u5316</li> <li>2 \u5b57\u8282 CRC \u5b57\u6bb5\uff0c\u57fa\u4e8e DLLP \u6838\u5fc3\u5b57\u6bb5\u5185\u5bb9\u8ba1\u7b97\u3002\u91cd\u8981\u7684\u4e00\u70b9\u662f\uff0c\u6b64\u5904\u7684 CRC \u548c TLP \u7684 LCRC \u5b57\u6bb5\u4e0d\u540c\u3002DLLP CRC \u4ec5\u6709 16 \u6bd4\u7279\uff0c\u5e76\u4e14\u5176\u8ba1\u7b97\u65b9\u5f0f\u4e5f\u4e0e 32 \u6bd4\u7279\u7684 LCRC \u4e0d\u540c\u30022 \u5b57\u8282 CRC \u5b57\u6bb5\u9644\u4e8e 4 \u5b57\u8282\u6838\u5fc3\u5b57\u6bb5\u4e4b\u540e\uff0c\u5171\u8ba1 6 \u5b57\u8282\u5185\u5bb9\u4f1a\u88ab\u4f20\u9012\u7ed9\u7269\u7406\u5c42\u3002</li> <li>\u4f7f\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u4e00\u4e2a SDP \uff08Start of DLLP\uff09\u548c END (End Good) \u63a7\u5236\u7b26\u53f7\u4f1a\u88ab\u6dfb\u52a0\u5230\u5305\u7684\u5f00\u5934\u4e0e\u7ed3\u5c3e\u3002\u81ea\u7136\u5730\uff0c\u8fd9\u4e9b\u5b57\u8282\u4f1a\u5728\u53d1\u9001\u524d\u7f16\u7801\u4e3a 10-bit \u7b26\u53f7\u3002</li> <li>Gen3 \u4f7f\u7528 128b/130b \u7f16\u7801\u65f6, 2 \u5b57\u8282 SDP \u4ee4\u724c\u4f1a\u88ab\u6dfb\u52a0\u5230 DLLP \u5305\u4e4b\u524d\u6784\u6210 8 \u5b57\u8282\u7684\u6570\u636e\u5305\uff0c\u6b64\u65f6\u4e0d\u4f1a\u6dfb\u52a0 END \u7b26\u53f7\u6216\u8005\u4ee4\u724c\u3002</li> </ol> <p>\u6ce8\u610f\uff0cDLLP \u6c38\u8fdc\u4e0d\u4f1a\u643a\u5e26\u6570\u636e\u8f7d\u8377\uff0c\u4fe1\u606f\u5168\u90e8\u4f4d\u4e8e 4 \u5b57\u8282\u6838\u5fc3\u5b57\u6bb5\u5185\u3002</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#95-dllp-dllp-packet-types","title":"9.5 DLLP \u5305\u7c7b\u578b\uff08DLLP Packet Types\uff09","text":"<p>DLLP \u5305\u5171\u6709 4 \u79cd\u7c7b\u578b\uff0c\u5206\u522b\u7528\u4e8e Ack/Nak\u3001\u7535\u6e90\u7ba1\u7406\u3001\u6d41\u63a7\u4ee5\u53ca\u5382\u5546\u81ea\u5b9a\u4e49\u529f\u80fd\u3002\u5176\u4e2d\u90e8\u5206\u7c7b\u578b\u8fd8\u6709\u4e00\u4e9b\u53d8\u4f53\u3002\u8868 9-1 \u603b\u7ed3\u4e86\u8fd9\u4e9b DLLP \u7c7b\u578b\u53ca\u5176\u53d8\u4f53\u7684\u7f16\u7801\u65b9\u5f0f\u3002</p> <p>\u8868 9-1 DLLP \u7c7b\u578b</p> <p></p> <p></p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#951-acknak-dllp-format","title":"9.5.1 Ack/Nak DLLP Format","text":"<p>\u7528\u4e8e\u901a\u77e5\u5bf9\u7aef\u8bbe\u5907\uff0c\u786e\u8ba4\u63a5\u6536\uff08Ack\uff09\u6216\u8005\u63a5\u6536\u9519\u8bef\uff08Nak\uff09\u7684 DLLP \u62a5\u6587\u683c\u5f0f\u5982\u56fe 9-3 \u6240\u793a\u3002 Ack/Nak DLLP \u5b57\u6bb5\u7528\u4e8e\u8868\u793a\u5bf9\u4e8e TLP \u62a5\u6587\u7684 Ack \u6216\u8005 Nak\u3002\u5173\u4e8e Ack/Nak \u534f\u8bae\u7684\u66f4\u591a\u7ec6\u8282\uff0c\u53ef\u4ee5\u53c2\u7167 Chapter 10, \u02baAck/Nak Protocol\u02ba \uff0c\u6b64\u5904\u4e0d\u518d\u5c55\u5f00\u63cf\u8ff0\u76f8\u5173\u7684\u5b57\u6bb5\u542b\u4e49\u3002</p> <p>\u8868 9-2 Ack/Nak DLLP \u5b57\u6bb5</p> <p></p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#952-power-management-dllp-format","title":"9.5.2 Power Management DLLP Format","text":"<p>\u56fe 9-4 \u662f\u7535\u6e90\u7ba1\u7406\u76f8\u5173\u7684 DLLP \u5305\u683c\u5f0f\u4fe1\u606f\uff0c\u8868 9-3 \u662f\u5b83\u7684\u5b57\u6bb5\u63cf\u8ff0\u4fe1\u606f\u3002\u5173\u4e8e \u7535\u6e90\u7ba1\u7406\u7684\u66f4\u591a\u7ec6\u8282\uff0c\u53ef\u4ee5\u53c2\u7167 Chapter 16, \u02baPower Management\u02ba \uff0c\u6b64\u5904\u4e0d\u518d\u5c55\u5f00\u63cf\u8ff0\u76f8\u5173\u7684\u5b57\u6bb5\u542b\u4e49\u3002</p> <p></p> <p>\u56fe 9-4 \u7535\u6e90\u7ba1\u7406\u76f8\u5173\u7684 DLLP \u5305\u683c\u5f0f\u4fe1\u606f\uff0c\u8868 9-3 \u5b57\u6bb5\u63cf\u8ff0\u4fe1\u606f</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#953-flow-control-dllp-format","title":"9.5.3 Flow Control DLLP Format","text":"<p>\u548c\u5176\u4ed6\u8bb8\u591a\u4e32\u884c\u4f20\u8f93\u534f\u8bae\u7c7b\u4f3c\uff0c PCIe \u901a\u8fc7\u57fa\u4e8e credit \u7684\u6d41\u91cf\u63a7\u5236\u673a\u5236\u63d0\u9ad8\u4e86\u4f20\u8f93\u7684\u6548\u7387\u3002\u76f8\u5173\u7684\u8bdd\u9898\u5728 Chapter 6, \u02baFlow Control\u02ba \u4e2d\u8fdb\u884c\u4e86\u8ba8\u8bba\u3002DLLP \u5728\u6d41\u91cf\u63a7\u5236\u673a\u5236\u4e2d\u7528\u4e8e\u901a\u4fe1\u53cc\u65b9 credit \u4fe1\u606f\u7684\u4ea4\u6362\u3002\u6709\u591a\u79cd\u4e0d\u540c\u7684 DLLP \u5305\u7528\u4e8e\u6d41\u91cf\u63a7\u5236\u673a\u5236\u7684 credit \u4fe1\u606f\u521d\u59cb\u5316\uff0c\u4ee5\u53ca\u53e6\u4e00\u7c7b\u7528\u4e8e\u4f20\u8f93\u8fc7\u7a0b\u4e2d credit \u66f4\u65b0\u7684 DLLP\uff0c\u5f53\u63a5\u6536\u65b9\u7f13\u5b58\u6062\u590d\u65f6\uff0c\u5c06\u7528\u8fd9\u7c7b DLLP \u901a\u77e5\u5bf9\u7aef credit \u4fe1\u606f\u7684\u66f4\u65b0\u3002\u5171\u6709\u4e24\u79cd\u6d41\u63a7\u521d\u59cb\u5316 DLLP\uff0c\u5206\u522b\u4e3a InitFC1 \u548c InitFC2\uff0c\u4ee5\u53ca\u4e00\u79cd\u6d41\u63a7\u66f4\u65b0 DLLP\uff0c\u79f0\u4e3a UpdateFC\u3002</p> <p>\u56fe 9-5 \u662f\u6d41\u63a7\u76f8\u5173\u7684 DLLP \u5305\u683c\u5f0f\u4fe1\u606f\uff0c\u8868 9-4 \u662f\u5b83\u7684\u5b57\u6bb5\u63cf\u8ff0\u4fe1\u606f\u3002</p> <p></p> <p></p> <p></p> <p>\u56fe 9-5 \u6d41\u63a7\u76f8\u5173\u7684 DLLP \u5305\u683c\u5f0f\u4fe1\u606f\uff0c\u8868 9-4 \u5b57\u6bb5\u63cf\u8ff0\u4fe1\u606f\u3002</p>"},{"location":"pcie/09%20DLLP%20%E5%85%83%E7%B4%A0/#954-vendor-specific-dllp-format","title":"9.5.4 Vendor-Specific DLLP Format","text":"<p>\u6700\u540e\u4e00\u7c7b DLLP \u7528\u4e8e\u5382\u5546\u5b9a\u5236\u5316\u7528\u9014\u3002\u56e0\u6b64\uff0c\u534f\u8bae\u53ea\u5b9a\u4e49\u4e86\u6b64\u7c7b DLLP \u7684\u7c7b\u578b\u5b57\u6bb5\u503c\uff080011 0000b\uff09\uff0c\u5269\u4e0b\u7684\u5c5e\u6027\u5b57\u6bb5\u7684\u542b\u4e49\u7559\u7ed9\u5382\u5546\u81ea\u884c\u5b9a\u4e49\u3002</p> <p></p> <p>\u56fe 9-5 \u5382\u5546\u81ea\u5b9a\u4e49 DLLP \u5305\u683c\u5f0f\u4fe1\u606f</p> <p>\u539f\u6587\uff1a Mindshare</p> <p>\u8bd1\u8005\uff1a LJGibbs</p> <p>\u6821\u5bf9: </p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/","title":"Chpater 12 Physical Layer - Logical(Gen3)//\u7269\u7406\u5c42\u903b\u8f91\uff08Gen3\uff09","text":""},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#_1","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u4ecb\u7ecd\u4e86\u7269\u7406\u5c42\u7684 Gen1/Gen2 \u903b\u8f91\u5b50\u6a21\u5757\u3002\u8be5\u5c42\u4e3a\u4e32\u884c\u4f20\u8f93\u548c\u6062\u590d\u51c6\u5907\u6570\u636e\u5305\uff0c\u5e76\u8be6\u7ec6\u63cf\u8ff0\u4e86\u5b8c\u6210\u8fd9\u4e00\u4efb\u52a1\u6240\u9700\u7684\u51e0\u4e2a\u6b65\u9aa4\u3002\u672c\u7ae0\u6db5\u76d6\u4e86\u4e0e\u4f7f\u7528 8b/10b \u7f16\u7801/\u89e3\u7801\u7684 Gen1 \u548c Gen2 \u534f\u8bae\u76f8\u5173\u7684\u903b\u8f91\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u63cf\u8ff0\u4e86\u7b2c\u4e09\u4ee3\uff08Gen3\uff09PCIe \u7684\u903b\u8f91\u7269\u7406\u5c42\u7279\u6027\u3002\u4e3b\u8981\u7684\u53d8\u5316\u5305\u62ec\u76f8\u5bf9\u4e8e Gen2 \uff0cGen3 \u5728\u6ca1\u6709\u500d\u589e\u9891\u7387\uff08\u94fe\u8def\u901f\u5ea6\u53ea\u662f\u4ece 5 GT/s \u63d0\u9ad8\u5230 8 GT/s\uff09\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u5e26\u5bbd\u63d0\u9ad8\u4e24\u500d\u3002\u8fd9\u662f\u901a\u8fc7\u5728 Gen3 \u6a21\u5f0f\u4e0b\u53d6\u6d88 8b/10b \u7f16\u7801\u800c\u5b9e\u73b0\u7684\u3002\u53e6\u5916\uff0c\u5728 Gen3 \u901f\u5ea6\u4e0b\uff0c\u5fc5\u987b\u91c7\u7528\u66f4\u5177\u9c81\u68d2\u6027\u7684\u4fe1\u53f7\u8865\u507f\u673a\u5236\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u5c06\u4ecb\u7ecd\u7269\u7406\u5c42\u4e0e\u94fe\u8def\u7684\u7535\u6c14\u63a5\u53e3\uff0c\u5e76\u8ba8\u8bba\u4e86\u4fe1\u53f7\u5747\u8861\u7684\u5fc5\u8981\u6027\u548c\u5b9e\u73b0\u4fe1\u53f7\u5747\u8861\u7684\u6a21\u578b\u3002\u8be5\u7ae0\u540c\u65f6\u5305\u62ec\u4e86 Gen1\u3001Gen2 \u548c Gen3 \u901f\u7387\u4e0b\u7684\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u7535\u6c14\u7279\u6027\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#121-gen3","title":"12.1 Gen3 \u7b80\u4ecb","text":"<p>\u56de\u987e\u4e00\u4e0b\uff0c\u5f53 PCIe \u94fe\u8def\u8fdb\u5165\u8bad\u7ec3\u72b6\u6001\u65f6\uff08\u5373\u590d\u4f4d\u540e\uff09\uff0c\u5b83\u603b\u662f\u4f7f\u7528 Gen1 \u901f\u5ea6\uff0c\u4ee5\u5b9e\u73b0\u5411\u540e\u517c\u5bb9\u3002\u5982\u679c\u8bbe\u5907\u5728\u8bad\u7ec3\u671f\u95f4\u5ba3\u79f0\uff08advertise\uff09\u4e86\u66f4\u9ad8\u7684\u901f\u5ea6\uff0c\u94fe\u8def\u5c06\u7acb\u5373\u8f6c\u6362\u5230 Recovery \u72b6\u6001\uff0c\u5e76\u5c1d\u8bd5\u5c06\u901f\u7387\u6539\u4e3a\u94fe\u8def\u53cc\u65b9\u5171\u540c\u652f\u6301\u7684\u6700\u9ad8\u901f\u5ea6\u3002</p> <p>\u5c06 PCIe \u534f\u8bae\u5347\u7ea7\u5230 Gen3 \u7684\u4e3b\u8981\u52a8\u673a\u662f\u4e3a\u4e86\u5c06\u5e26\u5bbd\u63d0\u9ad8\u4e00\u500d\uff0c\u5982\u7b2c 408 \u9875\u7684\u8868 12-1 \u6240\u793a\u3002\u5b9e\u73b0\u8fd9\u4e00\u70b9\u7684\u76f4\u63a5\u65b9\u6cd5\u662f\u7b80\u5355\u5730\u5c06\u4fe1\u53f7\u901f\u7387\u4ece 5GT/s \u589e\u52a0\u5230 10Gb/s\uff0c\u4f46\u8fd9\u6837\u505a\u6709\u51e0\u4e2a\u95ee\u9898\uff1a</p> <p>\u2022 \u66f4\u9ad8\u7684\u9891\u7387\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u529f\u7387\uff0c\u7531\u4e8e\u9700\u8981\u590d\u6742\u7684\u8c03\u8282\u903b\u8f91\uff08\u5747\u8861\uff0c equalization\uff09\u6765\u7ef4\u6301\u66f4\u9ad8\u901f\u5ea6\u4e0b\u7684\u4fe1\u53f7\u5b8c\u6574\u6027\uff0c\u8fd9\u4e00\u95ee\u9898\u53d8\u5f97\u66f4\u52a0\u4e25\u91cd\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5728 PCISIG \u7684\u6587\u732e\u4e2d\u63d0\u5230\uff0c\u5747\u8861\u903b\u8f91\u7684\u9ad8\u529f\u7387\u9700\u6c42\u662f\u4fdd\u6301\u5c3d\u53ef\u80fd\u4f4e\u7684\u9891\u7387\u7684\u4e00\u4e2a\u91cd\u8981\u52a8\u673a\u3002</p> <p>\u2022 \u4e00\u4e9b\u7535\u8def\u677f\u6750\u6599\u5728\u8f83\u9ad8\u9891\u7387\u4e0b\u4f1a\u51fa\u73b0\u660e\u663e\u7684\u4fe1\u53f7\u8870\u51cf\u3002\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u91c7\u7528\u66f4\u597d\u7684\u6750\u6599\u548c\u6295\u5165\u66f4\u591a\u8bbe\u8ba1\u7cbe\u529b\u6765\u514b\u670d\uff0c\u4f46\u4f1a\u589e\u52a0\u6210\u672c\u548c\u5f00\u53d1\u65f6\u95f4\u3002\u7531\u4e8e PCIe \u7684\u8bbe\u8ba1\u76ee\u7684\u662f\u4e3a\u5404\u7c7b\u7cfb\u7edf\u6240\u91c7\u7528\uff0c\u6240\u4ee5\u76ee\u6807\u662f PCIe \u5728\u4f4e\u6210\u672c\u8bbe\u8ba1\u4e2d\u4e5f\u80fd\u591f\u826f\u597d\u8fd0\u884c\u3002</p> <p>\u2022 \u540c\u6837\uff0c\u5141\u8bb8\u65b0\u8bbe\u8ba1\u4f7f\u7528\u73b0\u6709\u7684\u57fa\u7840\u8bbe\u65bd\uff08\u4f8b\u5982\u7535\u8def\u677f\u548c\u8fde\u63a5\u5668\uff09\uff0c\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u7535\u8def\u677f\u8bbe\u8ba1\u5de5\u4f5c\u548c\u6210\u672c\u3002\u4f7f\u7528\u66f4\u9ad8\u7684\u9891\u7387\u4f1a\u4f7f\u5176\u53d8\u5f97\u66f4\u52a0\u56f0\u96be\uff0c\u56e0\u4e3a\u5fc5\u987b\u8c03\u6574\u8d70\u7ebf\u957f\u5ea6\u548c\u5176\u4ed6\u53c2\u6570\u4ee5\u652f\u6301\u65b0\u7684\u65f6\u5e8f\u9700\u6c42\uff0c\u8fd9\u4f7f\u5f97\u9ad8\u9891\u7387\u65b9\u6848\u53d8\u5f97\u4e0d\u90a3\u4e48\u7406\u60f3\u3002</p> <p>\u8868 12-1 \u4e0d\u540c\u94fe\u8def\u4f4d\u5bbd\u4e0b\u7684 PCIe \u5e26\u5bbd\u4e00\u89c8</p> <p> </p> <p>\u8fd9\u4e9b\u8003\u8651\u5bfc\u81f4 Gen3 spec \u4e0e\u524d\u51e0\u4ee3\u76f8\u6bd4\u6709\u4e24\u4e2a\u91cd\u5927\u53d8\u5316\uff1a\u65b0\u7684\u7f16\u7801\u6a21\u578b\u548c\u66f4\u590d\u6742\u7684\u4fe1\u53f7\u5747\u8861\u6a21\u578b\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1211","title":"12.1.1 \u65b0\u7684\u7f16\u7801\u6a21\u578b","text":"<p>\u7269\u7406\u5c42\u7684\u903b\u8f91\u90e8\u5206\u7528\u65b0\u7684 128b/130b \u7f16\u7801\u65b9\u6848\u53d6\u4ee3\u4e86 8b/10b \u7f16\u7801\u3002\u5f53\u7136\uff0c\u8fd9\u610f\u5473\u7740\u504f\u79bb\u4e86\u8bb8\u591a\u4e32\u884c\u8bbe\u8ba1\u4e2d\u6210\u719f\u4f7f\u7528\u7684 8b/10b \u6a21\u5f0f\uff0c\u4f46\u662f PCIe \u8bbe\u8ba1\u8005\u5e0c\u671b\u65b0\u7684\u7f16\u7801\u6a21\u5f0f\u6765\u633d\u56de 8b/10b \u7f16\u7801\u6240\u4ea7\u751f\u7684 20% \u7684\u4f20\u8f93\u5f00\u9500\u3002\u4f7f\u7528 128b/130b \u7f16\u7801\u6a21\u5f0f\u610f\u5473\u7740\u901a\u9053\uff08Lanes\uff09\u73b0\u5728\u4f20\u8f93\u7684\u662f 8 bits/byte\uff0c\u800c\u4e0d\u662f 10 bits/byte\uff0c\u8fd9\u610f\u5473\u7740 Gen3 \u53ea\u9700\u8981 8.0GT/s \u7684\u6570\u636e\u901f\u7387\uff0c\u5c31\u80fd\u591f\u76f8\u6bd4 Gen2 \u589e\u52a0\u4e00\u500d\u5e26\u5bbd\uff0c\u76f8\u5f53\u4e8e\u94fe\u8def\u6536\u53d1\u53cc\u5411\u4e0a\u7684\u5e26\u5bbd\u4e3a 1GB/s\u3002</p> <p>\u4e3a\u4e86\u8bf4\u660e\u8fd9\u4e24\u79cd\u7f16\u7801\u7684\u533a\u522b\uff0c\u9996\u5148\u8003\u8651\u56fe 12-1\uff0c\u5b83\u5c55\u793a\u4e86 8b/10b \u7f16\u7801\u6a21\u5f0f\u4e0b\u6570\u636e\u5305\u7684\u4e00\u822c\u7ed3\u6784\u3002\u56fe\u4e2d\u7684\u7bad\u5934\u5f3a\u8c03\u4e86\u4ee3\u8868 8b/10b \u6570\u636e\u5305\u5e27\u7b26\u53f7\u7684\u63a7\u5236\uff08K\uff09\u5b57\u7b26\u3002\u63a5\u6536\u7aef\u901a\u8fc7\u8bc6\u522b\u8fd9\u4e9b\u63a7\u5236\u5b57\u7b26\uff0c\u77e5\u9053\u9884\u671f\u63a5\u6536\u7684\u6570\u636e\u5305\u7c7b\u578b\u3002\u8bf7\u53c2\u9605\u7b2c 380 \u9875\u7684\u201c8b/10b \u7f16\u7801\u201d \u8282\uff0c\u4e86\u89e3\u8fd9\u79cd\u7f16\u7801\u65b9\u6848\u7684\u4f18\u52bf\u3002</p> <p></p> <p>\u56fe 12-1 8b/10b \u901a\u9053\u7f16\u7801\u65b9\u5f0f</p> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u7b2c 410 \u9875\u7684\u56fe 12-2 \u5c55\u793a\u4e86 128b/130b \u7684\u7f16\u7801\u65b9\u5f0f\u3002\u8fd9\u79cd\u7f16\u7801\u4e0d\u5f71\u54cd\u6b63\u5728\u4f20\u8f93\u7684\u5b57\u8282\uff0c\u800c\u662f\u5c06\u5b57\u7b26\u5206\u7ec4\u4e3a 16 \u4e2a\u5b57\u8282\u7684\u5757\uff0c\u6bcf\u4e2a\u5757\u7684\u5f00\u5934\u6709\u4e00\u4e2a 2 \u6bd4\u7279\u7684\u540c\u6b65\u5b57\u6bb5\u30022 \u6bd4\u7279\u540c\u6b65\u5b57\u6bb5\u8868\u793a\u8be5\u5757\u662f\u5426\u5305\u62ec\u6570\u636e\uff0810b\uff09\u6216\u6709\u5e8f\u96c6\uff0801b\uff09\u3002\u56e0\u6b64\uff0c\u540c\u6b65\u5b57\u6bb5\u7528\u4e8e\u5411\u63a5\u6536\u7aef\u8868\u660e\u6570\u636e\u6d41\u7684\u5f00\u7aef\u4ee5\u53ca\u9884\u671f\u7684\u6570\u636e\u6d41\u7c7b\u578b\u3002\u4e0e 8b/10b \u7248\u672c\u7c7b\u4f3c\uff0c\u6709\u5e8f\u96c6\u5fc5\u987b\u5728\u6240\u6709\u901a\u9053\u4e0a\u88ab\u540c\u65f6\u4f20\u8f93\u3002\u8fd9\u8981\u6c42\u6240\u6709\u901a\u9053\u4e4b\u95f4\u80fd\u591f\u6b63\u786e\u5730\u540c\u6b65\uff0c\u8fd9\u4e5f\u662f\u8bad\u7ec3\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff08\u89c1\u7b2c 438 \u9875\u201c\u5b9e\u73b0\u5757\u5bf9\u9f50\u201d\uff09\u3002</p> <p></p> <p>\u56fe 12-2 128b/130b \u5757\u7f16\u7801\u65b9\u5f0f</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1212","title":"12.1.2 \u66f4\u590d\u6742\u7684\u4fe1\u53f7\u5747\u8861\u6a21\u578b","text":"<p>PCIe Gen3 \u7684\u7b2c\u4e8c\u9879\u53d8\u5316\u662f\u5728\u4e8e\u7269\u7406\u5c42\u7684\u7535\u6c14\u5b50\u6a21\u5757\uff0c\u5305\u62ec\u5728\u94fe\u8def\u7684\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\uff08\u53ef\u9009\u7684\uff09\u8fdb\u884c\u66f4\u590d\u6742\u7684\u4fe1\u53f7\u5747\u8861\u3002Gen1 \u548c Gen2 \u91c7\u7528\u9884\u5148\u56fa\u5b9a\u7684 Tx \u53bb\u52a0\u91cd\uff08de-emphasis\uff09\u6570\u503c\uff0c\u4ee5\u8fbe\u5230\u826f\u597d\u7684\u4fe1\u53f7\u8d28\u91cf\u3002\u7136\u800c\uff0c\u5c06\u4f20\u8f93\u9891\u7387\u63d0\u5347\u5230 5GT/s \u4ee5\u4e0a\u4f1a\u5bfc\u81f4\u66f4\u4e25\u91cd\u7684\u4fe1\u53f7\u5b8c\u6574\u6027\u95ee\u9898\uff0c\u9700\u8981\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u91c7\u53d6\u66f4\u8fdb\u4e00\u6b65\u7684\u8865\u507f\u63aa\u65bd\u3002\u4fe1\u53f7\u5b8c\u6574\u6027\u95ee\u9898\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u53ef\u4ee5\u901a\u8fc7\u7535\u8def\u677f\u677f\u7ea7\u7684\u624b\u6bb5\u89e3\u51b3\uff0c\u4f46\u8bbe\u8ba1\u8005\u5e0c\u671b\u8ba9 PCIe Gen3 \u7684\u5916\u90e8\u57fa\u7840\u8bbe\u65bd\u5c3d\u53ef\u80fd\u5730\u4fdd\u6301\u4e0d\u53d8\uff0c\u6240\u4ee5\u5c06\u989d\u5916\u7684\u5747\u8861\u5f00\u9500\u8bbe\u8ba1\u5728 PHY \u7684\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u7535\u8def\u4e0a\u3002\u5173\u4e8e\u4fe1\u53f7\u8c03\u8282\u7684\u66f4\u591a\u7ec6\u8282\uff0c\u8bf7\u53c2\u9605\u7b2c 474 \u9875\u7684 \u201c8.0GT/s \u7684\u89e3\u51b3\u65b9\u6848 \u2013 \u53d1\u9001\u7aef\u5747\u8861\uff08Transmitter Equalization\uff09\u201d\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#122-80-gts","title":"12.2 8.0 GT/s \u7f16\u7801","text":"<p>\u5982\u524d\u6240\u8ff0\uff0cGen3 128b/130b \u7f16\u7801\u65b9\u6cd5\u5728\u6574\u4e2a\u94fe\u8def\u8303\u7574\u5185\u5c01\u88c5\u6570\u636e\u62a5\u6587\uff0c\u5728\u5355\u4e2a\u94fe\u8def\u4e0a\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u5757\u7f16\u7801\u3002\u672c\u8282\u5c06\u8fdb\u4e00\u6b65\u8ba8\u8bba\u7f16\u7801\u7684\u7ec6\u8282\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1221","title":"12.2.1 \u901a\u9053\u5c42\u9762\u7684\u7f16\u7801","text":"<p>\u4e3a\u4e86\u8bf4\u660e\u5757\uff08Blocks\uff09\u7684\u5e94\u7528\u65b9\u5f0f\uff0c\u8bf7\u770b\u7b2c 411 \u9875\u7684\u56fe 12-3\uff0c\u5176\u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u5355\u901a\u9053\u6570\u636e\u5757\u3002\u9996\u5148\u662f\u4e24\u4e2a\u540c\u6b65\u5934\uff08Sync Header\uff09\u4f4d\uff0c\u540e\u9762\u662f 16 \u4e2a\u5b57\u8282\uff08128 \u4f4d\uff09\u7684\u4fe1\u606f\uff0c\u5171 130 \u4e2a\u4f20\u8f93\u4f4d\u3002\u540c\u6b65\u5934\u7b80\u5355\u5730\u5b9a\u4e49\u4e86\u6b63\u5728\u53d1\u9001\u7684\u662f\u4e00\u4e2a\u6570\u636e\u5757 (10b) \u8fd8\u662f\u4e00\u4e2a\u6709\u5e8f\u96c6 (01b)\u3002\u4f60\u53ef\u80fd\u5df2\u7ecf\u6ce8\u610f\u5230\u56fe 12-3 \u4e2d\u7684\u6570\u636e\u5757\u7684\u540c\u6b65\u5934\u503c\u662f 01b\uff0c\u800c\u4e0d\u662f\u4e0a\u9762\u63d0\u5230\u7684 10b \u503c\u3002\u8fd9\u662f\u56e0\u4e3a\u5728\u94fe\u8def\u4e0a\u4f20\u8f93\u6570\u636e\u5757\u65f6\uff0c\u9996\u5148\u53d1\u9001\u540c\u6b65\u5934\u7684\u6700\u4f4e\u6709\u6548\u4f4d\uff08LSB\uff09\u3002\u8bf7\u6ce8\u610f\uff0c\u540c\u6b65\u5934\u540e\u9762\u7684\u7b26\u53f7\u4e5f\u4f1a\u5148\u4ee5\u6700\u4f4e\u6709\u6548\u4f4d\u53d1\u9001\u3002</p> <p></p> <p>\u56fe 12-3 \u540c\u6b65\u5934\u4e0e\u6570\u636e\u5757\u793a\u4f8b</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1222","title":"12.2.2 \u5757\u5bf9\u9f50","text":"<p>\u4e0e\u5148\u524d\u7248\u672c\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e00\u6837\uff0cGen3 \u9996\u5148\u8fdb\u884c\u4f4d\u9501\u5b9a\uff08Bit Lock\uff09\uff0c\u7136\u540e\u5c1d\u8bd5\u5efa\u7acb\u5757\u5bf9\u9f50\u9501\u5b9a\uff08Block Alignment Lock\uff09\u3002\u8fd9\u9700\u8981\u63a5\u6536\u7aef\u627e\u5230\u5212\u5206\u5757\u8fb9\u754c\u7684\u540c\u6b65\u5934\u3002\u53d1\u9001\u7aef\u901a\u8fc7\u53d1\u9001\u7531 00h \u548c FFh \u5b57\u8282\u4ea4\u66ff\u7ec4\u6210\u7684\uff0cRX \u53ef\u8bc6\u522b\u7684 EIEOS \u7b26\u53f7\u96c6\uff08pattern\uff09\u5efa\u7acb\u5757\u8fb9\u754c\uff0c\u5982\u56fe 12-4 \u6240\u793a\u3002\u56e0\u6b64\uff0cEIEOS \u5df2\u7ecf\u4e0d\u53ea\u662f\u7528\u4e8e\u8868\u793a\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\uff0c\u8fd8\u6269\u5c55\u5e94\u7528\u4e8e\u5efa\u7acb\u5757\u5bf9\u9f50\u7684\u540c\u6b65\u673a\u5236\u3002\u8bf7\u6ce8\u610f\uff0c\u540c\u6b65\u5934\u4f4d\u7d27\u63a5\u5728 EIEOS \u4e4b\u524d\u548c\u4e4b\u540e\uff08\u56fe 12-4 \u4e2d\u672a\u663e\u793a\uff09\u3002\u5173\u4e8e\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u7ec6\u8282\uff0c\u8bf7\u53c2\u89c1\u7b2c 438 \u9875\u7684\u201c\u5b9e\u73b0\u5757\u5bf9\u9f50\u201d\u3002</p> <p></p> <p>\u56fe 12-4 Gen3 EIEOS \u7b26\u53f7\u96c6</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1223","title":"12.2.3 \u6709\u5e8f\u96c6\u5757","text":"<p>\u6709\u5e8f\u96c6\u7684\u542b\u4e49\u4e0e Gen1 \u548c Gen2 \u4e2d\u7684\u542b\u4e49\u57fa\u672c\u76f8\u540c\u3002\u5b83\u4eec\u7528\u4e8e\u7ba1\u7406\u901a\u9053\u534f\u8bae\uff08Lane protocol\uff09\u3002\u5f53\u53d1\u9001\u6709\u5e8f\u96c6\u5757\u65f6\uff0c\u5b83\u5fc5\u987b\u540c\u65f6\u51fa\u73b0\u5728\u6240\u6709\u901a\u9053\u4e0a\uff0c\u5e76\u4e14\u51e0\u4e4e\u603b\u662f\u7531 16 \u4e2a\u5b57\u8282\u7ec4\u6210\uff0c\u53ea\u6709\u4e00\u4e2a\u4f8b\u5916\u3002\u8fd9\u4e2a\u4f8b\u5916\u662f SOS\uff08SKP \u6709\u5e8f\u96c6\uff09\uff0c\u5b83\u7531\u65f6\u949f\u8865\u507f\u903b\u8f91\uff08\u4f8b\u5982\u4e0e\u94fe\u8def\u4e2d\u7ee7\u5668\uff08Link Repeater\uff09\u76f8\u5173\uff09\u4ee5\u56db\u4e2a\u4e3a\u4e00\u7ec4\u7684\u5f62\u5f0f\u6dfb\u52a0\u6216\u5220\u9664 SKP \u7b26\u53f7\uff0c\u56e0\u6b64 8\u300112\u300116\u300120 \u6216 24 \u5b57\u8282\u957f\u5ea6\u90fd\u662f\u5408\u6cd5\u7684\u3002</p> <p>\u6709\u5e8f\u96c6\u5757\u7684\u57fa\u672c\u683c\u5f0f\u4e0e\u6570\u636e\u5757\u7c7b\u4f3c\uff0c\u53ea\u662f\u540c\u6b65\u5934\u4f4d\u6570\u503c\u662f\u76f8\u53cd\u7684\uff0c\u5982\u7b2c 412 \u9875\u56fe 12-5 \u6240\u793a\u3002</p> <p></p> <p>\u56fe 12-5 Gen3x1 \u6709\u5e8f\u96c6\u5757\u793a\u4f8b</p> <p>PCIe \u89c4\u8303\u4e3a Gen3 \u5b9a\u4e49\u4e86\u4e03\u4e2a\u6709\u5e8f\u96c6\uff08\u6bd4 Gen1 \u548c Gen2 PCIe \u591a\u4e00\u4e2a\u6709\u5e8f\u96c6\uff09\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u7684\u529f\u80fd\u4e0e\u524d\u51e0\u4ee3\u76f8\u540c\u3002</p> <ol> <li> <p>SOS - Skip Ordered Set\uff1a\u7528\u4e8e\u65f6\u949f\u8865\u507f\u3002\u66f4\u591a\u7ec6\u8282\u89c1\u7b2c 426 \u9875 \u201c\u6709\u5e8f\u96c6\u793a\u4f8b-SOS\u201d\u3002</p> </li> <li> <p>EIOS - \u7535\u6c14\u7a7a\u95f2\u6709\u5e8f\u96c6\uff08Electrical Idle Ordered Set\uff09\uff1a\u7528\u4e8e\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001</p> </li> <li> <p>EIEOS - \u7535\u6c14\u7a7a\u95f2\u9000\u51fa\u6709\u5e8f\u96c6\uff08Electrical Idle Exit Ordered Set\uff09\uff1a\u73b0\u5728\u7528\u4e8e\u4e24\u4e2a\u76ee\u7684\uff1a</p> <p>\u2014 \u7535\u6c14\u7a7a\u95f2\u9000\u51fa\uff0c\u8fd9\u4e0e\u524d\u51e0\u4ee3\u76f8\u540c</p> <p>\u2014 \u7528\u4e8e\u6307\u793a 8.0GT/s \u901f\u7387\u4e0b\u7684\u5757\u5bf9\u9f50\u8fb9\u754c</p> </li> <li> <p>TS1 - \u8bad\u7ec3\u5e8f\u5217 1 \u6709\u5e8f\u96c6\uff08Training Sequence 1 Ordered Set\uff09</p> </li> <li> <p>TS2 - \u8bad\u7ec3\u5e8f\u5217 2 \u6709\u5e8f\u96c6\uff08Training Sequence 2 Ordered Set\uff09</p> </li> <li> <p>FTS - \u5feb\u901f\u8bad\u7ec3\u5e8f\u5217\u6709\u5e8f\u96c6\uff08Fast Training Sequence Ordered Set\uff09</p> </li> <li> <p>SDS - \u6570\u636e\u6d41\u5f00\u7aef\u6709\u5e8f\u96c6\uff08Start of Data Stream Ordered Set\uff09\uff1a\u5728 Gen3 \u4e2d\u65b0\u589e - \u8be6\u89c1\u7b2c 413 \u9875 \u201c\u6570\u636e\u6d41\u548c\u6570\u636e\u5757\u201d\u3002</p> </li> </ol> <p>\u4e3a\u4e86\u7ed9\u8bfb\u8005\u4e00\u4e2a\u6709\u5e8f\u96c6\u7ed3\u6784\u7684\u793a\u4f8b\uff0c\u56fe 12-6 \u5c55\u793a\u4e86 8.0GT/s \u901f\u7387\u4e0b FTS \u6709\u5e8f\u96c6\u7684\u7ec4\u6210\uff0c\u53ea\u80fd\u901a\u8fc7\u540c\u6b65\u5934\u624d\u80fd\u628a\u5b83\u8bc6\u522b\u4e3a\u6709\u5e8f\u96c6\uff0c\u5e76\u901a\u8fc7\u8be5\u5757\u4e2d\u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\uff08Symbol\uff09\u8bc6\u522b\u4e3a FTS \u7c7b\u578b\u3002\u56fe\u7684\u53f3\u4fa7\u5217\u51fa\u4e86\u6709\u5e8f\u96c6\u6807\u8bc6\u7b26\uff08\u6bcf\u4e2a\u6709\u5e8f\u96c6\u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\uff09\uff0c\u7528\u4e8e\u8bc6\u522b\u5f53\u524d\u6b63\u5728\u4f20\u8f93\u7684\u6709\u5e8f\u96c6\u7684\u7c7b\u578b\u3002</p> <p></p> <p>\u56fe 12-6 Gen3 FTS \u6709\u5e8f\u96c6\u793a\u4f8b</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1224","title":"12.2.4 \u6570\u636e\u6d41\u548c\u6570\u636e\u5757","text":"<p>\u94fe\u8def\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a SDS \u6709\u5e8f\u96c6\uff0c\u8f6c\u6362\u5230 L0 \u94fe\u8def\u72b6\u6001\u6765\u5f00\u59cb\u6570\u636e\u6d41\u4f20\u8f93\uff08Enter a Data Stream\uff09\u3002\u5728\u6570\u636e\u6d41\u4e2d\u4f20\u8f93\u591a\u4e2a\u6570\u636e\u5757\uff0c\u76f4\u5230\u6570\u636e\u6d41\u4ee5 EDS \u6807\u8bb0\uff08Token\uff09\u7ed3\u675f\uff08\u9664\u975e\u6709\u9519\u8bef\u63d0\u524d\u7ed3\u675f\uff09\u3002 EDS \u6807\u8bb0\u603b\u662f\u5360\u636e\u6709\u5e8f\u96c6\u4e4b\u524d\u7684\u6570\u636e\u5757\u7684\u6700\u540e\u56db\u4e2a\u7b26\u53f7\u3002Skip \u6709\u5e8f\u96c6\u662f\u4e00\u4e2a\u4f8b\u5916\uff0c\u56e0\u4e3a\u53ea\u8981\u7b26\u5408\u67d0\u4e9b\u6761\u4ef6\uff0c\u5b83\u4eec\u5c31\u4e0d\u4f1a\u4e2d\u65ad\u6570\u636e\u6d41\u3002\u8fd9\u79cd\u4f8b\u5916\u60c5\u51b5\u5c06\u5728\u540e\u6587\u8ba8\u8bba\u3002\u5f53\u94fe\u8def\u72b6\u6001\u4ece L0 \u72b6\u6001\u8f6c\u6362\u5230\u4efb\u4f55\u5176\u4ed6\u94fe\u8def\u72b6\u6001\uff0c\u5982\u6062\u590d\u72b6\u6001\uff08Recovery\uff09\uff0c\u6570\u636e\u6d41\u5c31\u4e0d\u518d\u6709\u6548\u3002\u5173\u4e8e\u94fe\u8def\u72b6\u6001\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2c 518 \u9875\u7684\u201c\u94fe\u8def\u8bad\u7ec3\u548c\u72b6\u6001\u673a\uff08LTSSM\uff09\u201d\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1225","title":"12.2.5 \u6570\u636e\u5757\u5e27\u7ed3\u6784","text":"<p>\u6570\u636e\u5757\u7531\u7528\u4e8e\u4f20\u9012\u4fe1\u606f\u7684 TLPs\u3001DLLP \u548c Token \u7ec4\u6210\u3002\u5728\u4e00\u4e2a\u6570\u636e\u5757\u4e2d\u8fd8\u4f1a\u7528\u5230\u4e94\u79cd\u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\uff08\u79f0\u4e3a\u6807\u8bb0\uff0cToken \uff09\u3002\u6bcf\u4e00\u79cd\u90fd\u6709\u4fbf\u4e8e\u63a5\u6536\u7aef\u68c0\u6d4b\u7684\u6570\u636e\u56fe\u6837\uff08Pattern\uff09\u3002\u5176\u4e2d\u4e09\u79cd\u6807\u8bb0\u53ef\u80fd\u5728\u4e00\u4e2a\u6570\u636e\u5757\u7684\u5f00\u5934\u53d1\u9001\uff08\u5373\uff0c\u7d27\u8ddf\u5728\u540c\u6b65\u6570\u636e\u5757\u4e4b\u540e\uff09\u3002\u5176\u4e2d\u5305\u62ec\uff1a</p> <p>\u2022 \u5f00\u59cb TLP\uff08STP\uff09 - \u8868\u793a\u968f\u540e\u662f TLP \u62a5\u6587 </p> <p>\u2022 \u5f00\u59cb DLLP\uff08SDP\uff09 - \u8868\u793a\u968f\u540e\u662f DLLP \u62a5\u6587</p> <p>\u2022 \u903b\u8f91\u7a7a\u95f2\uff08IDLA\uff09 - \u5728\u6ca1\u6709\u6570\u636e\u5305\u6d3b\u52a8\u65f6\u53d1\u9001</p> <p>\u5269\u4f59\u7684\u4e24\u79cd\u6807\u8bb0\uff08Tokens\uff09\u5728\u6570\u636e\u5757\u7684\u672b\u5c3e\u4f20\u9012\u3002</p> <p>\u2022 \u6570\u636e\u6d41\u7ed3\u675f\uff08EDS\uff09 - \u8868\u793a\u4e4b\u540e\u5c06\u4ece\u6570\u636e\u8f6c\u6362\u5230\u6709\u5e8f\u96c6</p> <p>\u2022 End Bad (EDB) - \u62a5\u544a\u68c0\u6d4b\u5230\u65e0\u6548\u7684\u6570\u636e\u5305</p> <p>\u56fe 12-7 \u63d0\u4f9b\u4e86\u4e00\u4e2a\u7531\u5355\u901a\u9053 TLP \u4f20\u8f93\u7ec4\u6210\u7684\u6570\u636e\u5757\u7684\u793a\u4f8b\u3002</p> <p></p> <p>\u56fe 12-7 Gen3x1 \u5e27\u7ed3\u6784\u793a\u610f\u56fe</p> <p>\u603b\u4e4b\uff0c\u6570\u636e\u5757\u7684\u5185\u5bb9\u56e0\u94fe\u8def\u5f53\u524d\u7684\u6d3b\u52a8\uff08activity\uff09\u800c\u5f02\uff1a</p> <p>\u2022 IDLs - \u5f53\u6ca1\u6709\u6570\u636e\u5305\u88ab\u4f20\u9001\u65f6\uff0c\u6570\u636e\u5757\u53ea\u7531 IDL \u7ec4\u6210\u3002(\u89c4\u8303\u5c06 IDL \u6307\u5b9a\u4e3a\u6807\u8bb0\u4e4b\u4e00\uff09\u3002</p> <p>\u2022 TLPs - \u5728\u4e00\u4e2a\u7ed9\u5b9a\u7684\u6570\u636e\u5757\u4e2d\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2a\u6216\u591a\u4e2a TLPs\uff0c\u53d6\u51b3\u4e8e\u94fe\u8def\u5bbd\u5ea6\u3002</p> <p>\u2022 DLLPs - \u5728\u4e00\u4e2a\u7ed9\u5b9a\u7684\u6570\u636e\u5757\u4e2d\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2a\u6216\u591a\u4e2a DLLPs\u3002</p> <p>\u2022 \u4e0a\u8ff0\u6d3b\u52a8\u7684\u7ec4\u5408\u53ef\u5728\u4e00\u4e2a\u6570\u636e\u5757\u4e2d\u4f20\u9001\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12251","title":"12.2.5.1 \u5e27\u6807\u8bb0","text":"<p>\u8be5\u89c4\u8303\u5b9a\u4e49\u4e86\u4e94\u4e2a\u5141\u8bb8\u51fa\u73b0\u5728\u6570\u636e\u5757\u4e2d\u7684\u5e27\u6807\u8bb0\uff08\u6216\u7b80\u79f0\u4e3a\u201c\u6807\u8bb0\u201d Token\uff09\uff0c\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u5728\u7b2c 417 \u9875\u7684\u56fe 12-8 \u4e2d\u518d\u6b21\u7f57\u5217\u4e86\u8fd9\u4e9b\u6807\u8bb0\u3002\u8fd9\u4e94\u4e2a\u6807\u8bb0\u662f\uff1a</p> <ol> <li> <p>STP - \u5f00\u59cb TLP\uff1a\u4e0e\u65e9\u671f\u7248\u672c\u5f88\u76f8\u4f3c\uff0c\u4f46\u65b0\u589e\u4e86\u5b57\u6bb5\uff1a\u6570\u636e\u5305\u53cc\u5b57\uff08dword\uff09\u6570\u91cf\u3002</p> </li> <li> <p>SDP - \u5f00\u59cb DLLP</p> </li> <li> <p>EDB - End Bad\u3002\u7528\u4e8e\u4f7f TLP \u65e0\u6548\uff0c\u5c31\u50cf\u5728\u65e9\u671f\u7684 Gen1 \u548c Gen2 \u8bbe\u8ba1\u4e2d\u90a3\u6837\uff0c\u4f46\u73b0\u5728\u4f1a\u8fde\u7eed\u53d1\u9001\u56db\u4e2a EDB \u7b26\u53f7\u3002\u53e6\u5916\uff0c\u73b0\u5728\u5df2\u7ecf\u53d6\u6d88\u4e86 END\uff08\u7ed3\u675f\u826f\u597d\uff09\u7b26\u53f7\uff1b\u5982\u679c\u6ca1\u6709\u660e\u786e\u6807\u8bb0\u4e3a\u574f\uff0cTLP \u5c06\u88ab\u5047\u5b9a\u4e3a\u826f\u597d\u3002</p> </li> <li> <p>EDS - \u6570\u636e\u6d41\u7684\u7ed3\u675f\u3002\u6570\u636e\u6d41\u7684\u6700\u540e\u4e00\u4e2a\u53cc\u5b57\uff08dword\uff09\uff0c\u8868\u793a\u81f3\u5c11\u6709\u4e00\u4e2a\u6709\u5e8f\u96c6\u5c06\u4f1a\u51fa\u73b0\u3002\u8010\u4eba\u5bfb\u5473\u7684\u662f\uff0c\u6570\u636e\u6d41\u53ef\u80fd\u5e76\u6ca1\u6709\u56e0\u4e3a\u8fd9\u4e2a\u4e8b\u4ef6\u800c\u771f\u6b63\u7ed3\u675f\u3002\u5982\u679c\u7d27\u968f\u5176\u540e\u7684\u6709\u5e8f\u96c6\u662f SOS\uff0c\u5e76\u4e14\u7d27\u968f\u5176\u540e\u7684\u662f\u53e6\u4e00\u4e2a\u6570\u636e\u5757\uff0c\u5219\u6570\u636e\u6d41\u7ee7\u7eed\u3002\u5982\u679c\u8ddf\u968f\u7684\u662f EDS \u800c\u4e0d\u662f SOS\uff0c\u6216\u8005\u5982\u679c SOS \u540e\u9762\u6ca1\u6709\u6570\u636e\u5757\uff0c\u90a3\u4e48\u6570\u636e\u6d41\u5c31\u4f1a\u7ed3\u675f\u3002</p> </li> <li> <p>IDL - \u903b\u8f91\u7a7a\u95f2\u3002\u7a7a\u95f2\u6807\u8bb0\u53ea\u662f\u5728\u94fe\u8def\u903b\u8f91\u7a7a\u95f2\u72b6\u6001\u4e0b\uff0c\u6ca1\u6709 TLPs \u6216 DLLPs \u51c6\u5907\u4f20\u8f93\u65f6\u53d1\u9001\u7684\u6570\u636e\u96f6\u5b57\u8282\uff08data zero bytes\uff09\u3002</p> </li> </ol> <p>\u89c4\u8303\u4e2d\u663e\u793a\u6807\u8bb0\u7684\u65b9\u5f0f\u4e0e\u7b2c 417 \u9875\u56fe 12-8 \u4e2d\u663e\u793a\u7684\u65b9\u5f0f\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u8fd9\u5e45\u56fe\u4ee5\u5c0f\u7aef\uff08little-endian\uff09\u987a\u5e8f\u663e\u793a\u5b57\u8282\u548c\u4f4d\uff0c\u800c\u4e0d\u662f\u89c4\u8303\u4e2d\u4f7f\u7528\u7684\u5927\u7aef\uff08big-endian\uff09\u4f4d\u8868\u793a\u3002\u4e4b\u6240\u4ee5\u8fd9\u6837\u663e\u793a\uff0c\u662f\u4e3a\u4e86\u8bf4\u660e\u5404\u6bd4\u7279\u5728\u901a\u9053\u4e0a\u5b9e\u9645\u51fa\u73b0\u7684\u987a\u5e8f\u3002</p> <p></p> <p>\u56fe 12-8 Gen3 \u5e27\u6807\u8bb0\u793a\u610f\u56fe</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12252","title":"12.2.5.2 \u6570\u636e\u5305","text":"<p>STP \u548c SDP\uff0c\u8868\u793a\u4e00\u4e2a\u6570\u636e\u5305\u7684\u5f00\u59cb\uff0c\u5982\u56fe 12-7 \u6240\u793a</p> <p>\u2022 TLPs\u3002\u4e00\u4e2a STP \u6807\u8bb0\u5f00\u7aef\u662f\u4e00\u4e2a\u5168 1 \u7684\u534a\u5b57\u8282\uff084\u2018b1111\uff09\uff0c\u968f\u540e\u662f 11 \u6bd4\u7279\u4f4d\u5bbd\u7684\u6570\u636e\u5305\u53cc\u5b57\u957f\u5ea6\u5b57\u6bb5\u3002\u53cc\u5b57\u957f\u5ea6\u5b57\u6bb5\u7edf\u8ba1 TLP \u6240\u6709\u7684\u53cc\u5b57\uff0c\u8986\u76d6\u6807\u8bb0\u3001\u9996\u90e8\u3001\u53ef\u9009\u7684\u6570\u636e\u6709\u6548\u8f7d\u8377\u3001\u53ef\u9009\u7684\u6458\u8981\uff08digest\uff09\u548c LCRC\u3002\u8fd9\u4f7f\u63a5\u6536\u7aef\u80fd\u591f\u901a\u8fc7\u8ba1\u7b97\u53cc\u5b57\u6570\uff0c\u4ee5\u8bc6\u522b TLP \u7684\u7ed3\u675f\u4f4d\u7f6e\u3002\u56e0\u6b64\uff0c\u6b63\u786e\u7684 Length \u5b57\u6bb5\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u56e0\u6b64\u5b83\u6709\u4e00\u4e2a 4 \u4f4d\u7684\u5e27 CRC\uff08Frame CRC\uff09\uff0c\u4ee5\u53ca\u4e00\u4e2a\u4fdd\u62a4 Length \u548c\u5e27 CRC \u5b57\u6bb5\u7684\u5076\u6570\u5947\u5076\u6821\u9a8c\u4f4d\u3002\u8fd9\u4e9b\u6821\u9a8c\u5b57\u6bb5\u7684\u7ec4\u5408\u4e3a\u6807\u8bb0\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u4e09\u6bd4\u7279\u7ffb\u8f6c\uff08triple-bit-flip\uff09\u68c0\u6d4b\u80fd\u529b\uff08\u80fd\u591f\u68c0\u6d4b\u51fa\u5305\u542b\u591a\u8fbe 3 \u6bd4\u7279\u4e0d\u6b63\u786e\u7684\u62a5\u6587\uff09\u300211 \u4f4d\u7684\u957f\u5ea6\u5b57\u6bb5\u6700\u591a\u5141\u8bb8\u6574\u4e2a TLP \u4e3a 2K \u4e2a\u53cc\u5b57\uff088KB\uff09\u3002</p> <p>\u2022 DLLPs\u3002SDP \u6807\u8bb0\u8868\u793a DLLP \u7684\u5f00\u59cb\uff0c\u6ca1\u6709\u8868\u793a DLLP \u7684\u957f\u5ea6\u5b57\u6bb5\uff0c\u56e0\u4e3a DLLP \u603b\u662f 8 \u4e2a\u5b57\u8282\u957f\uff1a2 \u4e2a\u5b57\u8282\u7684\u6807\u8bb0\u540e\u9762\u662f 4 \u4e2a\u5b57\u8282\u7684 DLLP \u6709\u6548\u8f7d\u8377\u548c 2 \u4e2a\u5b57\u8282\u7684 DLLP LCRC\u3002\u4e5f\u8bb8\u662f\u5de7\u5408\uff0c\u8fd9\u4e2a DLLP \u957f\u5ea6\u4e0e\u524d\u51e0\u4ee3 PCIe \u76f8\u540c\uff0c\u4f46\u4e0d\u518d\u5305\u62ec\u4e00\u4e2a\u8868\u793a\u7ed3\u675f\u826f\u597d\u7684\u7b26\u53f7\u3002</p> <p>EDB \u6807\u8bb0\u88ab\u6dfb\u52a0\u5230\u65e0\u6548\u7684 TLPs \u7684\u672b\u5c3e\u3002\u5bf9\u4e8e\u4e00\u4e2a\u6b63\u5e38\u7684 TLP\uff0c\u6ca1\u6709 \u201c\u7ed3\u675f\u826f\u597d\u201d \u7684\u6307\u793a\uff0c\u9664\u975e\u660e\u786e\u6807\u8bb0\u4e3a\u574f\uff0c\u5426\u5219\u5b83\u88ab\u8ba4\u4e3a\u662f\u826f\u597d\u7684\u3002\u5982\u679c TLP \u6700\u7ec8\u88ab\u6807\u8bb0\u4e3a\u65e0\u6548\uff0cLCRC \u6570\u503c\u5c06\u88ab\u53cd\u8f6c\uff0c\u5e76\u5728\u672b\u5c3e\u9644\u52a0\u4e00\u4e2a EDB \u6807\u8bb0\u4f5c\u4e3a TLP \u7684\u6269\u5c55\uff0c\u5b83\u4e0d\u4f1a\u88ab\u53cd\u6620\u5728\u957f\u5ea6\u5b57\u6bb5\u4e2d\u3002\u7269\u7406\u5c42\u7684\u63a5\u6536\u7aef\u5fc5\u987b\u5728\u6bcf\u4e2a TLP \u7ed3\u675f\u65f6\u68c0\u67e5 EDB\uff0c\u5982\u679c\u770b\u5230 EDB \u5c31\u901a\u77e5\u94fe\u8def\u5c42\u3002\u81ea\u7136\u800c\u7136\u5730\uff0c\u9664\u4e86\u5728 TLP \u7ed3\u675f\u540e\u7684\u7b26\u53f7\u63a5\u6536\u5230 EDB \u4e4b\u5916\uff0c\u5176\u4ed6\u4efb\u4f55\u65f6\u5019\u63a5\u6536 EDB \u90fd\u5c06\u88ab\u63a5\u6536\u7aef\u89c6\u4e3a\u5e27\u9519\u8bef\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12253","title":"12.2.5.3 \u53d1\u9001\u7aef\u5e27\u8981\u6c42","text":"<p>\u5f00\u59cb\u8fd9\u4e2a\u8bdd\u9898\u7684\u8ba8\u8bba\u524d\uff0c\u6211\u4eec\u6700\u597d\u9884\u5148\u5b9a\u4e49\u4e00\u4e9b\u4e8b\u7269\u3002\u9996\u5148\uff0c\u56de\u987e\u4e00\u4e0b\uff0c\u6570\u636e\u6d41\u4ece SDS \u4e4b\u540e\u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\u5f00\u59cb\uff0c\u5b83\u53ef\u80fd\u5305\u542b\u7531\u6807\u8bb0\u3001TLP \u548c DLLP \u7ec4\u6210\u7684\u6570\u636e\u5757\u3002\u6570\u636e\u6d41\u4ee5\u6709\u5e8f\u96c6\uff08\u9664\u4e86 SOS\uff09\u4e4b\u524d\u7684\u6700\u540e\u4e00\u4e2a\u7b26\u53f7\u7ed3\u675f\uff0c\u6216\u8005\u5f53\u68c0\u6d4b\u5230\u5e27\u9519\u8bef\u65f6\u7ed3\u675f\u3002\u5728\u6570\u636e\u6d41\u671f\u95f4\uff0c\u9664\u4e86 SOS \u5916\uff0c\u4e0d\u80fd\u53d1\u9001\u4efb\u4f55\u6709\u5e8f\u96c6\u3002</p> <p>\u5176\u6b21\uff0c\u7531\u4e8e\u5e27\u95ee\u9898\u901a\u5e38\u4f1a\u5bfc\u81f4\u5e27\u9519\u8bef\uff0c\u89e3\u91ca\u4e0b\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f\u4ec0\u4e48\u662f\u5f88\u6709\u7528\u7684\u80cc\u666f\u77e5\u8bc6\u3002\u5f53\u5e27\u9519\u8bef\u53d1\u751f\u65f6\uff0c\u5b83\u4eec\u88ab\u63a5\u6536\u65b9\u89c6\u4e3a\u63a5\u6536\u7aef\u9519\u8bef\uff0c\u5e76\u5411\u4e0a\u5c42\u62a5\u544a\u3002\u63a5\u6536\u7aef\u505c\u6b62\u5904\u7406\u6b63\u5728\u8fdb\u884c\u7684\u6570\u636e\u6d41\uff0c\u53ea\u6709\u5f53\u5b83\u770b\u5230\u4e00\u4e2a SDS \u6709\u5e8f\u96c6\u65f6\uff0c\u624d\u4f1a\u5f00\u59cb\u5904\u7406\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u6d41\u3002\u4e3a\u4e86\u54cd\u5e94\u5e27\u9519\u8bef\uff0c\u5e27\u6062\u590d\u903b\u8f91\u901a\u8fc7\u5c06 LTSSM \u4ece L0 \u72b6\u6001\u5f15\u5bfc\u5230\u6062\u590d\uff08Recovery\uff09\u72b6\u6001\u6765\u542f\u52a8\u3002\u9884\u671f\u4e2d\uff0c\u5e27\u9519\u8bef\u53ca\u5176\u6062\u590d\u8fc7\u7a0b\u5c06\u5728\u7269\u7406\u5c42\u5f97\u5230\u89e3\u51b3\uff0c\u4e0d\u9700\u8981\u4e0a\u5c42\u91c7\u53d6\u4efb\u4f55\u884c\u52a8\u3002\u6b64\u5916\uff0c\u89c4\u8303\u6307\u51fa\uff0c\u4ece\u4e24\u4e2a\u7aef\u53e3\u90fd\u8fdb\u5165\u6062\u590d\u72b6\u6001\u5f00\u59cb\u7b97\u8d77\uff0c\u5b8c\u6210\u8fd9\u4e00\u8fc7\u7a0b\u7684\u5f80\u8fd4\u65f6\u95f4\u9884\u671f\u5c0f\u4e8e 1us\u3002</p> <p>\u73b0\u5728\uff0c\u6709\u4e86\u4e0a\u8ff0\u7684\u80cc\u666f\u77e5\u8bc6\uff0c\u8ba9\u6211\u4eec\u7ee7\u7eed\u8ba8\u8bba\u5e27\u8981\u6c42\u3002\u5728\u6570\u636e\u6d41\u4e2d\uff0c\u53d1\u9001\u7aef\u5fc5\u987b\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <p>\u2022 \u5f53\u53d1\u9001 TLP \u65f6\uff1a</p> <p>\u2014 STP \u6807\u8bb0\u540e\u5fc5\u987b\u7d27\u8ddf\u7740\u4ece\u94fe\u8def\u5c42\u4f20\u9012\u7684 TLP \u7684\u5168\u90e8\u5185\u5bb9\uff0c\u5373\u4f7f\u5b83\u662f\u65e0\u6548\u7684\u3002</p> <p>\u2014 \u5982\u679c TLP \u662f\u65e0\u6548\u7684\uff0cEDB Token \u5fc5\u987b\u7d27\u8ddf\u5728 TLP \u7684\u6700\u540e\u4e00\u4e2a dword \u4e4b\u540e\uff0c\u4f46\u5176\u4e0d\u80fd\u5305\u542b\u5728 TLP \u7684\u957f\u5ea6\u503c\u4e2d\u3002</p> <p>\u2014 STP \u5728\u94fe\u8def\u4e0a\u7684\u6bcf\u4e2a\u7b26\u53f7\u65f6\u95f4\u5185\u4e0d\u80fd\u88ab\u53d1\u9001\u591a\u6b21\u3002</p> <p>\u2022 \u5f53\u53d1\u9001 DLLP \u65f6\uff1a</p> <p>\u2014 SDP \u6807\u8bb0\u540e\u9762\u5fc5\u987b\u7d27\u8ddf\u7740\u4ece\u6570\u636e\u94fe\u8def\u5c42\u4f20\u9012\u7684 DLLP \u7684\u5168\u90e8\u5185\u5bb9\u3002</p> <p>\u2014 SDP \u5728\u94fe\u8def\u4e0a\u7684\u6bcf\u4e2a\u7b26\u53f7\u65f6\u95f4\u5185\u4e0d\u80fd\u88ab\u53d1\u9001\u591a\u6b21\u3002</p> <p>\u2022 \u5f53\u5728\u6570\u636e\u6d41\u4e2d\u53d1\u9001\u4e00\u4e2a SOS\uff08SKP \u6709\u5e8f\u96c6\uff09\u65f6\uff1a</p> <p>\u2014 \u5728\u5f53\u524d\u6570\u636e\u5757\u7684\u6700\u540e\u4e00\u4e2a\u53cc\u5b57\u4e2d\u53d1\u9001\u4e00\u4e2a EDS \u6807\u8bb0\u3002</p> <p>\u2014 \u5c06 SOS \u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u6709\u5e8f\u96c6\u5757\u53d1\u9001\u3002</p> <p>\u2014 \u5728 SOS \u4e4b\u540e\u7acb\u5373\u53d1\u9001\u53e6\u4e00\u4e2a\u6570\u636e\u5757\u3002\u6570\u636e\u6d41\u4ee5\u8be5\u540e\u7eed\u6570\u636e\u5757\u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\u6062\u590d\u3002</p> <p>\u2014 \u5982\u679c\u5b89\u6392\u4e86\u591a\u4e2a SOS\uff0c\u5b83\u4eec\u4e0d\u80fd\u50cf\u524d\u51e0\u4ee3\u90a3\u6837\u80cc\u5bf9\u80cc\uff08back-to-back\uff09\u5730\u8fdb\u884c\u3002\u76f8\u53cd\uff0c\u6bcf\u4e2a\u6807\u8bb0\u524d\u9762\u5fc5\u987b\u6709\u4e00\u4e2a\u4ee5 EDS \u6807\u8bb0\u7ed3\u675f\u7684\u6570\u636e\u5757\u3002\u5728\u6b64\u671f\u95f4\uff0c\u6570\u636e\u5757\u53ef\u4ee5\u7528 TLPs\u3001DLLPs \u6216 IDLs \u586b\u5145\u3002</p> <p>\u2022 \u53d1\u9001\u7aef\u8981\u7ed3\u675f\u4e00\u4e2a\u6570\u636e\u6d41\u65f6\uff0c\u5728\u5f53\u524d\u6570\u636e\u5757\u7684\u6700\u540e\u4e00\u4e2a\u53cc\u5b57\u4e2d\u53d1\u9001 EDS \u6807\u8bb0\uff0c\u7136\u540e\u4f7f\u7528 EIOS \u8fdb\u5165\u4f4e\u529f\u7387\u94fe\u8def\u72b6\u6001\uff0c\u6216\u8005\u7528 EIEOS \u5904\u7406\u6240\u6709\u5176\u4ed6\u60c5\u51b5\u3002</p> <p>\u2022 \u5982\u679c\u94fe\u8def\u4e0a\u6ca1\u6709\u53d1\u9001 TLP\u3001DLLP \u6216\u5176\u4ed6\u5e27\u6807\u8bb0\uff0c\u5219\u5fc5\u987b\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001 IDL \u6807\u8bb0\u3002</p> <p>\u2022 \u5bf9\u4e8e\u591a\u901a\u9053\u94fe\u8def\uff1a</p> <p>\u2014 \u5728\u53d1\u9001\u4e00\u4e2a IDL \u6807\u8bb0\u540e\uff0c\u4e0b\u4e00\u4e2a TLP \u6216 DLLP \u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\u5728\u5f00\u59cb\u65f6\u5fc5\u987b\u4f4d\u4e8e\u901a\u9053 0 \u4e2d\u3002EDS \u6807\u8bb0\u5fc5\u987b\u59cb\u7ec8\u662f\u6570\u636e\u5757\u7684\u6700\u540e\u4e00\u4e2a\u53cc\u5b57\uff0c\u56e0\u6b64\u53ef\u80fd\u4e0d\u603b\u662f\u9075\u5faa\u8fd9\u4e00\u89c4\u5219\u3002</p> <p>\u2014 IDL \u6807\u8bb0\u5fc5\u987b\u88ab\u7528\u6765\u5728\u7b26\u53f7\u65f6\u95f4\u5185\u586b\u5145\u672c\u6765\u662f\u7a7a\u7684\u53cc\u5b57\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a x8 \u94fe\u8def\u7684 TLP \u5728\u901a\u9053 3 \u7ed3\u675f\uff0c\u4f46\u53d1\u9001\u7aef\u6ca1\u6709\u53e6\u4e00\u4e2a TLP \u6216 DLLP \u51c6\u5907\u5728\u901a\u9053 4 \u5f00\u59cb\uff0c\u90a3\u4e48 IDL \u5fc5\u987b\u586b\u5145\u5269\u4f59\u7684\u5b57\u8282\uff0c\u76f4\u5230\u8be5\u7b26\u53f7\u65f6\u95f4\u7684\u7ed3\u675f\u3002</p> <p>\u2014 \u7531\u4e8e\u6570\u636e\u5305\u957f\u5ea6\u4ecd\u7136\u662f 4 \u5b57\u8282\u7684\u500d\u6570\uff0c\u5c31\u50cf\u5b83\u4eec\u5728\u65e9\u671f\u51e0\u4ee3\u4e2d\u4e00\u6837\uff0c\u5b83\u4eec\u5c06\u5728 4 \u7684\u500d\u6570\u901a\u9053\u8fb9\u754c\u5f00\u59cb\u548c\u7ed3\u675f\u3002\u4f8b\u5982\uff0c\u5728 x8 \u94fe\u8def\u4e2d\uff0c\u67d0\u4e2a DLLP \u5728\u901a\u9053 3 \u7ed3\u675f \uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06\u5176 STP \u6807\u8bb0\u653e\u5728\u901a\u9053 4 \u6765\u5f00\u59cb\u4e0b\u4e00\u4e2a TLP\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12254","title":"12.2.5.4 \u63a5\u6536\u7aef\u5e27\u8981\u6c42","text":"<p>\u5f53\u5728\u63a5\u6536\u7aef\u770b\u5230\u6570\u636e\u6d41\u65f6\uff0c\u4ee5\u4e0b\u89c4\u5219\u9002\u7528\uff1a</p> <p>\u2022 \u5f53\u9700\u8981\u5e27\u6807\u8bb0\u65f6\uff0c\u63a5\u6536\u5230\u50cf\u5176\u4ed6\u4e1c\u897f\u7684\u7b26\u53f7\u5c06\u88ab\u89c6\u4f5c\u5e27\u9519\u8bef\u3002</p> <p>\u2022 \u4e0b\u9762\u5217\u8868\u4e2d\u663e\u793a\u7684\u4e00\u4e9b\u9519\u8bef\u68c0\u67e5\u548c\u62a5\u544a\u662f\u53ef\u9009\u7684\uff0c\u89c4\u8303\u4e2d\u6307\u51fa\u8fd9\u4e9b\u53ef\u9009\u9879\u4e4b\u95f4\u662f\u4e92\u76f8\u72ec\u7acb\u7684\u3002</p> <p>\u2022 \u5f53\u6536\u5230 STP \u65f6\uff1a</p> <p>\u2014 \u63a5\u6536\u7aef\u5fc5\u987b\u68c0\u67e5\u5e27 CRC \u548c\u5e27\u5947\u5076\u6821\u9a8c\u5b57\u6bb5\uff0c\u4efb\u4f55\u4e0d\u5339\u914d\u90fd\u5c06\u662f\u4e00\u4e2a\u5e27\u9519\u8bef\u3002(\u6ce8\u610f\uff0c\u5728\u62a5\u544a\u8fd9\u4e2a\u9519\u8bef\u65f6\uff0c\u9519\u8bef\u5e27\u7684 STP \u6807\u8bb0\u4e0d\u88ab\u8ba4\u4e3a\u662f TLP \u7684\u4e00\u90e8\u5206\u3002)\u3002</p> <p>\u2014 \u7d27\u63a5 TLP \u6700\u540e\u4e00\u4e2a DW \u7684\u7b26\u53f7\u662f\u4e0b\u4e00\u4e2a\u8981\u5904\u7406\u7684\u6807\u8bb0\uff0c\u63a5\u6536\u7aef\u5fc5\u987b\u68c0\u67e5\u5b83\u662f\u5426\u662f EDB \u6807\u8bb0\u7684\u5f00\u59cb\uff0c\u8868\u660e TLP \u5df2\u7ecf\u65e0\u6548\u3002</p> <p>\u2014 \u53ef\u9009\u62e9\u68c0\u67e5\u957f\u5ea6\u503c\u662f\u5426\u4e3a\u96f6\uff1b\u5982\u679c\u68c0\u6d4b\u5230\uff0c\u5219\u4e3a\u5e27\u9519\u8bef\u3002</p> <p>\u2014 \u53ef\u9009\u62e9\u68c0\u67e5\u5728\u540c\u4e00\u7b26\u53f7\u65f6\u95f4\u5185\u662f\u5426\u6709\u591a\u4e2a STP \u6807\u8bb0\u5230\u8fbe\u3002\u5982\u679c\u68c0\u67e5\u5e76\u68c0\u6d4b\u5230\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u5e27\u9519\u8bef\u3002</p> <p>\u2022 \u5f53\u6536\u5230 EDB \u65f6\uff1a</p> <p>\u2014 \u4e00\u65e6\u68c0\u6d4b\u5230\u7b2c\u4e00\u4e2a EDB \u7b26\u53f7\uff0c\u6216\u8005\u5728\u63a5\u6536\u5230\u5b83\u7684\u4efb\u4f55\u5269\u4f59\u5b57\u8282\u4e4b\u540e\uff0c\u63a5\u6536\u7aef\u5fc5\u987b\u7acb\u5373\u901a\u77e5\u94fe\u8def\u5c42\u3002</p> <p>\u2014 \u5982\u679c\u6807\u8bb0\u4e2d\u7684\u4efb\u4f55\u7b26\u53f7\u4e0d\u5c5e\u4e8e EDB\uff0c\u5219\u7ed3\u679c\u662f\u4e00\u4e2a\u5e27\u9519\u8bef\u3002</p> <p>\u2014 EDB \u6807\u8bb0\u7684\u552f\u4e00\u5408\u6cd5\u65f6\u95f4\u662f\u5728 TLP \u4e4b\u540e\uff1b\u4efb\u4f55\u5176\u4ed6\u7528\u9014\u90fd\u5c06\u662f\u5e27\u9519\u8bef\u3002</p> <p>\u2014 \u7d27\u8ddf\u5728 EDB \u6807\u8bb0\u4e4b\u540e\u7684\u7b26\u53f7\u5c06\u662f\u8981\u5904\u7406\u7684\u4e0b\u4e00\u4e2a\u6807\u8bb0\u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\u3002</p> <p>\u2022 \u5f53 EDS \u6807\u8bb0\u4f5c\u4e3a\u6570\u636e\u5757\u7684\u6700\u540e\u4e00\u4e2a DW \u88ab\u63a5\u6536\u65f6\uff1a</p> <p>\u2014 \u63a5\u6536\u7aef\u5fc5\u987b\u505c\u6b62\u5904\u7406\u6570\u636e\u6d41\u3002</p> <p>\u2014 \u63a5\u4e0b\u6765\uff0c\u53ea\u6709\u63a5\u6536\u5230 SKP\u3001EIOS \u6216 EIEOS \u6709\u5e8f\u96c6\u662f\u5408\u6cd5\u7684\uff1b\u63a5\u6536\u5230\u4efb\u4f55\u5176\u4ed6\u6709\u5e8f\u96c6\u90fd\u5c06\u662f\u4e00\u4e2a\u5e27\u9519\u8bef\u3002</p> <p>\u2014 \u5982\u679c\u5728 EDS \u4e4b\u540e\u6536\u5230 SKP \u6709\u5e8f\u96c6\uff0c\u5219\u9664\u975e\u68c0\u6d4b\u5230\u5e27\u9519\u8bef\uff0c\u5426\u5219\u63a5\u6536\u7aef\u5fc5\u987b\u4f7f\u7528\u968f\u540e\u7684\u6570\u636e\u5757\u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\uff08Symbol\uff09\u6062\u590d\u6570\u636e\u6d41\u5904\u7406\u3002</p> <p>\u2022 \u5f53\u6536\u5230 SDP \u6807\u8bb0\u65f6\uff1a</p> <p>\u2014 \u7d27\u968f DLLP \u4e4b\u540e\u7684\u7b26\u53f7\u662f\u4e0b\u4e00\u4e2a\u8981\u5904\u7406\u7684\u7b26\u53f7\u3002</p> <p>\u2014 \u53ef\u9009\u62e9\u5728\u540c\u4e00\u7b26\u53f7\u65f6\u95f4\u5185\u68c0\u67e5\u591a\u4e2a SDP \u6807\u8bb0\u3002\u5982\u679c\u68c0\u67e5\u5e76\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff0c\u5219\u4e3a\u5e27\u9519\u8bef\u3002</p> <p>\u2022 \u5f53\u6536\u5230 IDL \u6807\u8bb0\u65f6\uff1a</p> <p>\u2014 \u5141\u8bb8\u4e0b\u4e00\u4e2a\u6807\u8bb0\u5728 IDL \u6807\u8bb0\u4e4b\u540e\u7684\u4efb\u4f55 DW \u5bf9\u9f50\u7684\u901a\u9053\u4e0a\u5f00\u59cb\u3002\u5bf9\u4e8e x4 \u6216\u66f4\u7a84\u7684\u94fe\u8def\uff0c\u8fd9\u610f\u5473\u7740\u4e0b\u4e00\u4e2a\u6807\u8bb0\u53ea\u80fd\u5728\u4e0b\u4e00\u4e2a\u7b26\u53f7\u65f6\u95f4\u7684\u901a\u9053 0 \u5f00\u59cb\u3002\u5bf9\u4e8e\u66f4\u5bbd\u7684\u94fe\u8def\uff0c\u6709\u66f4\u591a\u7684\u9009\u62e9\u3002\u4f8b\u5982\uff0cx16 \u94fe\u8def\u53ef\u4ee5\u5728\u5f53\u524d\u7b26\u53f7\u65f6\u95f4\u7684 0\u30014\u30018 \u6216 12 \u901a\u9053\u5f00\u59cb\u4e0b\u4e00\u4e2a\u6807\u8bb0\u3002</p> <p>\u2014 \u552f\u4e00\u4e0e IDL \u5728\u540c\u4e00\u7b26\u53f7\u65f6\u95f4\u5185\u53ef\u63a5\u6536\u7684\u6807\u8bb0\u662f\u53e6\u4e00\u4e2a IDL \u6216 EDS\u3002</p> <p>\u2022 \u5728\u5904\u7406\u6570\u636e\u6d41\u65f6\uff0c\u63a5\u6536\u7aef\u5c06\u4ee5\u4e0b\u60c5\u51b5\u89c6\u4e3a\u5e27\u9519\u8bef\uff1a</p> <p>\u2014 \u7d27\u8ddf\u7740 SDS \u4e4b\u540e\u7684\u6709\u5e8f\u96c6\u3002</p> <p>\u2014 \u5177\u6709\u975e\u6cd5\u540c\u6b65\u5934\uff0811b \u6216 00b\uff09\u7684\u5757\u3002\u53ef\u9009\u5730\uff0c\u5728\u901a\u9053\u9519\u8bef\u72b6\u6001\uff08Lane Error Status\uff09\u5bc4\u5b58\u5668\u4e2d\u62a5\u544a\u8fd9\u4e2a\u9519\u8bef\u3002</p> <p>\u2014 \u4efb\u4f55\u901a\u9053\u4e0a\u63a5\u6536\u7684\u6709\u5e8f\u96c6\u5757\uff0c\u672a\u5728\u524d\u4e00\u4e2a\u6570\u636e\u5757\u4e2d\u6536\u5230 EDS \u6807\u8bb0\u3002</p> <p>\u2014 \u7d27\u8ddf\u5728\u524d\u4e00\u4e2a\u5757\u4e2d\u7684 EDS \u6807\u8bb0\u4e4b\u540e\uff0c\u63a5\u6536\u5230\u6570\u636e\u5757\u3002</p> <p>\u2014 \u53ef\u4ee5\u9009\u62e9\u9a8c\u8bc1\u6240\u6709\u901a\u9053\u662f\u5426\u6536\u5230\u76f8\u540c\u7684\u6709\u5e8f\u96c6\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12255","title":"12.2.5.5 \u4ece\u5e27\u9519\u8bef\u4e2d\u6062\u590d","text":"<p>\u5982\u679c\u5728\u5904\u7406\u6570\u636e\u6d41\u65f6\u53d1\u73b0\u5e27\u9519\u8bef\uff0c\u63a5\u6536\u7aef\u5fc5\u987b\uff1a</p> <p>\u2022 \u62a5\u544a\u63a5\u6536\u7aef\u9519\u8bef\uff08\u5982\u679c\u53ef\u9009\u7684\u9ad8\u7ea7\u9519\u8bef\u62a5\u544a\uff08Advanced Error Reporting\uff09\u5bc4\u5b58\u5668\u53ef\u7528\uff0c\u5219\u7f6e\u4f4d\u7b2c 421 \u9875\u56fe 12-9 \u6240\u793a\u7684\u76f8\u5e94\u72b6\u6001\u4f4d\uff09\u3002</p> <p>\u2022 \u505c\u6b62\u5904\u7406\u6570\u636e\u6d41\u3002\u5f53\u770b\u5230\u4e0b\u4e00\u4e2a SDS \u6709\u5e8f\u96c6\u65f6\uff0c\u53ef\u4ee5\u5f00\u59cb\u5904\u7406\u65b0\u7684\u6570\u636e\u6d41\u3002</p> <p>\u2022 \u542f\u52a8\u9519\u8bef\u6062\u590d\u8fc7\u7a0b\u3002\u5982\u679c\u94fe\u8def\u5904\u4e8e L0 \u72b6\u6001\uff0c\u5219\u9700\u8981\u8f6c\u6362\u5230\u6062\u590d\u72b6\u6001\u3002\u8be5\u89c4\u8303\u89c4\u5b9a\uff0c\u6062\u590d\u72b6\u6001\u7684\u65f6\u95f4\u201c\u9884\u671f\u201d\u5c0f\u4e8e 1us\u3002</p> <p>\u2022 \u8bf7\u6ce8\u610f\uff0c\u4ece\u5e27\u9519\u8bef\u4e2d\u6062\u590d\u4e0d\u4e00\u5b9a\u4f1a\u901a\u8fc7 Ack/Nak \u673a\u5236\uff0c\u76f4\u63a5\u5bfc\u81f4\u6570\u636e\u94fe\u8def\u5c42\u53d1\u8d77\u7684\u6062\u590d\u6d3b\u52a8\u3002\uff08\u8bd1\u6ce8\uff1a\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u4ece\u5e27\u9519\u8bef\u4e2d\u6062\u590d\u5c06\u4f1a\u5728\u7269\u7406\u5c42\u89e3\u51b3\uff09\u5f53\u7136\uff0c\u5982\u679c TLP \u7531\u4e8e\u9519\u8bef\u800c\u4e22\u5931\u6216\u635f\u574f\uff0c\u90a3\u4e48\u5c06\u9700\u8981\u89e6\u53d1\u91cd\u653e\u4e8b\u4ef6\uff08replay event\uff09\u3002</p> <p></p> <p>\u56fe 12-9 AER \u53ef\u6062\u590d\u9519\u8bef\u5bc4\u5b58\u5668</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#123-gen3","title":"12.3 Gen3 \u7269\u7406\u5c42\u53d1\u9001\u903b\u8f91","text":"<p>\u7b2c 422 \u9875\u7684\u56fe 12-10 \u5c55\u793a\u4e86\u652f\u6301 Gen3 \u901f\u7387\u7684\u7269\u7406\u5c42\u4f20\u8f93\u903b\u8f91\u7684\u6982\u5ff5\u6846\u56fe\u3002\u6574\u4f53\u8bbe\u8ba1\u4e0e Gen2 \u975e\u5e38\u76f8\u4f3c\uff0c\u6240\u4ee5\u6ca1\u6709\u5fc5\u8981\u518d\u53bb\u91cd\u590d\u8ba8\u8bba\u6240\u6709\u7ec6\u8282\uff0c\u4f46\u4e5f\u5b58\u5728\u4e00\u4e9b\u533a\u522b\u3002PCIe \u65b0\u624b\u5efa\u8bae\u56de\u987e\u7b2c 361 \u9875\u7684 \u201c\u7269\u7406\u5c42-\u903b\u8f91\uff08Gen1 \u548c Gen2\uff09\u201d \u4e00\u7ae0\uff0c\u4ee5\u4e86\u89e3\u7269\u7406\u5c42\u8bbe\u8ba1\u7684\u57fa\u7840\u77e5\u8bc6\u3002\u8ba9\u6211\u4eec\u4ece\u56fe\u7684\u9876\u90e8\u5f00\u59cb\uff0c\u89e3\u91ca Gen3 \u5b9e\u73b0\u5728\u6574\u4e2a\u8fc7\u7a0b\u4e2d\u6240\u505a\u7684\u66f4\u6539\u3002\u4e0e\u4e4b\u524d\u4e00\u6837\uff0c\u9700\u8981\u6307\u51fa\u7684\u662f\uff0c\u4e0b\u8ff0\u7684\u7269\u7406\u5c42\u5b9e\u73b0\u8ba8\u8bba\u4ec5\u4ece\u6559\u5b66\u76ee\u7684\u51fa\u53d1\uff0c\u4e0d\u662f\u4e3a\u4e86\u5c55\u793a\u5b9e\u9645\u7684 Gen3 \u7269\u7406\u5c42\u5b9e\u73b0\u3002</p> <p></p> <p>\u56fe 12-10 Gen3 \u7269\u7406\u5c42\u53d1\u9001\u903b\u8f91\u7ec6\u8282</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1231","title":"12.3.1 \u591a\u8def\u590d\u7528\u5668","text":"<p>TLP \u548c DLLP \u6765\u81ea\u9876\u90e8\u7684\u6570\u636e\u94fe\u8def\u5c42\u3002\u591a\u8def\u590d\u7528\u5668\u4f1a\u5728\u6570\u636e\u8f93\u5165\u4e2d\u6dfb\u52a0\u6784\u5efa\u5b8c\u6574 TLP \u6216 DLLP \u6240\u9700\u7684 STP \u6216 SDP \u6807\u8bb0\u3002\u4e0a\u4e00\u8282\u63cf\u8ff0\u4e86\u6807\u8bb0\u683c\u5f0f\u3002</p> <p>Gen3 TLP \u7684\u8fb9\u754c\u7531 TLP \u6570\u636e\u5305\u4e4b\u524d\u7684 STP \u6807\u8bb0\u957f\u5ea6\u5b57\u6bb5\u4e2d\u7684\u53cc\u5b57\u8ba1\u6570\u5b9a\u4e49\uff0c\u56e0\u6b64\uff0c\u4e0d\u9700\u8981 END \u5e27\u5b57\u7b26\u3002</p> <p>\u5f53\u7ed3\u675f\u6570\u636e\u6d41\u65f6\u6216\u5728\u53d1\u9001 SOS \u4e4b\u524d\uff0cEDS \u6807\u8bb0\u88ab\u52a0\u5165\u6570\u636e\u6d41\u3002\u591a\u8def\u590d\u7528\u5668\u6839\u636e\u8df3\u8f6c\u8ba1\u65f6\u5668\uff0c\u5b9a\u671f\u5c06 SOS \u63d2\u5165\u6570\u636e\u6d41\u4e2d\u3002\u5176\u4ed6\u6570\u636e\u6d41\u4e4b\u5916\u7684\u6709\u5e8f\u96c6\uff0c\u5982 TS1\u3001TS2\u3001FTS\u3001EIEOS\u3001EIOS\u3001SDS \u4e5f\u53ef\u4ee5\u6839\u636e\u94fe\u8def\u8981\u6c42\u52a0\u5165\u5230\u6570\u636e\u6d41\u4e2d\u3002</p> <p>\u6570\u636e\u5305\u5728\u7531 2 \u4f4d\u540c\u6b65\u5934\u6807\u8bc6\u7684\u5757\u4e2d\u4f20\u8f93\uff0c\u540c\u6b65\u5934\u4e5f\u662f\u7531\u591a\u8def\u590d\u7528\u5668\u6dfb\u52a0\u7684\u3002\u4e0d\u8fc7\uff0c\u5728\u591a\u901a\u9053\u94fe\u8def\u7684\u6240\u6709\u901a\u9053\u4e0a\u590d\u5236\u540c\u6b65\u5934\uff0c\u662f\u901a\u8fc7\u5b57\u8282\u6761\u5e26\u5316\uff08Byte Striping\uff09\u903b\u8f91\u5b9e\u73b0\u7684\u3002</p> <p>\u5f53\u6ca1\u6709\u8981\u53d1\u9001\u7684\u6570\u636e\u5305\u6216\u6709\u5e8f\u96c6\uff0c\u4f46\u94fe\u8def\u5728 L0 \u72b6\u6001\u4e0b\u4fdd\u6301\u6d3b\u52a8\u65f6\uff0cIDL\uff08\u903b\u8f91\u7a7a\u95f2\uff0c\u6216\u6570\u636e\u96f6\uff09\u6807\u8bb0\u88ab\u7528\u4f5c\u586b\u5145\u7b26\u3002\u8fd9\u4e9b\u6807\u8bb0\u5c31\u50cf\u5176\u4ed6\u6570\u636e\u5b57\u8282\u4e00\u6837\u88ab\u52a0\u6270\uff0c\u5e76\u5728\u63a5\u6536\u7aef\u89e3\u7801\u5e76\u8bc6\u522b\u4e3a\u586b\u5145\u7b26\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1232-byte-striping","title":"12.3.2 \u5b57\u8282\u6761\u5e26\u5316\uff08Byte Striping\uff09","text":"<p>\u8fd9\u79cd\u903b\u8f91\u5c06\u8981\u4f20\u9001\u7684\u5b57\u8282\u5206\u5e03\u5728\u6240\u6709\u53ef\u7528\u7684\u901a\u9053\u4e0a\u3002\u5e27\u89c4\u5219\u5df2\u5728\u7b2c 417 \u9875 \u201c\u53d1\u9001\u7aef\u5e27\u8981\u6c42\u201d \u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u4e00\u4e9b\u793a\u4f8b\u5e76\u8ba8\u8bba\u5982\u4f55\u5e94\u7528\u8fd9\u4e9b\u89c4\u5219\u3002</p> <p>\u9996\u5148\u8003\u8651\u7b2c 424 \u9875\u56fe 12-11 \u6240\u793a\u7684\u793a\u4f8b\uff0c\u5176\u4e2d\u8bf4\u660e\u4e86 4 \u901a\u9053\u94fe\u8def\u3002\u6ce8\u610f\uff0c\u5f53\u4e00\u4e2a\u65b0\u7684\u5757\u5f00\u59cb\u65f6\uff0c\u540c\u6b65\u5934\u4f4d\u540c\u65f6\u51fa\u73b0\u5728\u6240\u6709\u901a\u9053\u4e0a\uff0c\u5e76\u5b9a\u4e49\u4e86\u5757\u7684\u7c7b\u578b\uff08\u672c\u4f8b\u4e2d\u662f\u6570\u636e\u5757\uff09\u3002\u5757\u7f16\u7801\u5bf9\u4e8e\u6bcf\u4e2a\u901a\u9053\u90fd\u662f\u72ec\u7acb\u5904\u7406\u7684\uff0c\u4f46\u5b57\u8282\uff08\u6216\u7b26\u53f7\uff09\u5728\u6240\u6709\u901a\u9053\u4e0a\u90fd\u662f\u6761\u5e26\u5316\uff08striped\uff09\u7684\uff0c\u5c31\u50cf\u65e9\u671f\u51e0\u4ee3 PCIe \u4e00\u6837\u3002</p> <p></p> <p>\u56fe 12-11 Gen3 x4 \u6bd4\u7279\u6761\u5e26\u5316\u793a\u4f8b</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12321-x8","title":"12.3.2.1 \u5b57\u8282\u6761\u5e26\u5316 x8 \u793a\u4f8b","text":"<p>\u63a5\u4e0b\u6765\uff0c\u8003\u8651\u7b2c 425 \u9875\u56fe 12-12 \u6240\u793a\u7684 x8 \u94fe\u8def\uff0c\u8fd9\u662f\u57fa\u4e8e\u7684\u89c4\u8303\u4e2d\u7684\u4e00\u4e2a\u793a\u4f8b\u91cd\u65b0\u7ed8\u5236\u7684\uff0c\u4ee5\u4fbf\u4e8e\u9605\u8bfb\u3002\u6ce8\u610f\u8fd9\u91cc\u7684\u6bd4\u7279\u6d41\u662f\u5782\u76f4\u7ed8\u5236\u7684\uff0c\u800c\u4e0d\u662f\u50cf\u4e4b\u524d\u7684\u56fe 12-11 \u90a3\u6837\u662f\u6c34\u5e73\u7684\u3002\u5728\u56fe 12-12 \u9876\u90e8\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6309\u8981\u6c42\u4ee5\u5c0f\u7aef\u987a\u5e8f\u663e\u793a\u7684\u540c\u6b65\u4f4d\uff0c\u540c\u65f6\u51fa\u73b0\u5728\u6240\u6709\u901a\u9053\u4e0a\uff0c\u6307\u793a\u6570\u636e\u5757\u4f20\u8f93\u7684\u5f00\u59cb\u3002</p> <p>\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u9996\u5148\u53d1\u9001 TLP\uff0c\u6240\u4ee5\u7b26\u53f7 0-4 \u5305\u542b STP \u5e27\u6807\u8bb0\uff0c\u5305\u62ec\u6807\u8bb0\u5728\u5185\u7684\u6574\u4e2a TLP \u957f\u5ea6\u4e3a 7DW\u3002\u63a5\u6536\u7aef\u9700\u8981\u77e5\u9053 TLP \u7684\u957f\u5ea6\uff0c\u56e0\u4e3a\u5bf9\u4e8e 8GT/s \u901f\u5ea6\uff0c\u6ca1\u6709 END \u63a7\u5236\u5b57\u7b26\uff08\u6807\u8bc6 TLP \u7684\u7ed3\u675f\u8fb9\u754c\uff09 \u3002\u76f8\u53cd\uff0c\u63a5\u6536\u7aef\u7edf\u8ba1\u53cc\u5b57\uff08\u6765\u627e\u5230 TLP \u7684\u7ed3\u675f\u8fb9\u754c\uff09\uff0c\u5982\u679c\u6ca1\u6709\u89c2\u5bdf\u5230 EDB\uff08End Bad\uff09\uff0c\u5219\u8ba4\u4e3a TLP \u662f\u6b63\u5e38\u7684\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cTLP \u5728\u7b26\u53f7 3 \u7684\u901a\u9053 3 \u5904\u7ed3\u675f\u3002</p> <p></p> <p>\u56fe 12-12 Gen x8 \u793a\u4f8b\uff1aTLP \u5206\u8de8\u5757\u8fb9\u754c</p> <p>\u63a5\u4e0b\u6765\uff0c\u4ece\u901a\u9053 4 \u548c 5 \u4e0a\u7684 SDP \u6807\u8bb0\u5f00\u59cb\u53d1\u9001 DLLP\u3002\u7531\u4e8e DLLP \u7684\u957f\u5ea6\u59cb\u7ec8\u4e3a 8 \u4e2a\u7b26\u53f7\uff0c\u56e0\u6b64\u5b83\u5c06\u5728\u7b26\u53f7 4 \u7684\u901a\u9053 3 \u7ed3\u675f\u3002\u6682\u65f6\uff0c\u6ca1\u6709\u5176\u4ed6\u6570\u636e\u5305\u8981\u53d1\u9001\uff0c\u56e0\u6b64 IDL \u7b26\u53f7\u5c06\u88ab\u4f20\u8f93\uff0c\u76f4\u5230\u53e6\u4e00\u4e2a\u6570\u636e\u5305\u51c6\u5907\u5c31\u7eea\u3002\u53d1\u9001 IDL \u65f6\uff0c\u4e0b\u4e00\u4e2a STP \u6807\u8bb0\u53ea\u80fd\u5728\u901a\u9053 0 \u4e2d\u542f\u52a8\u3002\u5728\u672c\u4f8b\u4e2d\uff0cTLP \u4ece\u7b26\u53f7 6 \u7684\u901a\u9053 0 \u5f00\u59cb\u3002</p> <p>\u4e0b\u4e00\u4e2a TLP \u7684\u6570\u636e\u5305\u957f\u5ea6\u4e3a 23 DW\uff0c\u8fd9\u662f\u4e00\u4e2a\u6709\u8da3\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u5728\u4e0b\u4e00\u4e2a\u5757\u8fb9\u754c\u4e4b\u524d\u53ea\u6709 20 \u4e2a\u53cc\u5b57\uff08dwords\uff09\u53ef\u7528\u3002\u5f53\u6570\u636e\u5757\u7ed3\u675f\u65f6\uff0c\u53d1\u9001\u7aef\u53d1\u9001\u540c\u6b65\u5934\uff0c\u5e76\u5728\u4e0b\u4e00\u4e2a\u6570\u636e\u5757\u7684\u7b26\u53f7 0 \u671f\u95f4\u7ee7\u7eed TLP \u4f20\u8f93\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6570\u636e\u5305\u53ea\u662f\u5728\u5fc5\u8981\u65f6\u8de8\u8d8a\u5757\u8fb9\u754c\u3002\u6700\u540e\uff0cTLP \u5728\u7b26\u53f7 1 \u7684\u901a\u9053 3 \u5b8c\u6210\u3002\u518d\u4e00\u6b21\uff0c\u6ca1\u6709\u9700\u8981\u53d1\u9001\u7684\u6570\u636e\u5305\u4e86\uff0c\u56e0\u6b64\u53d1\u9001 IDL\uff08\u4f5c\u4e3a\u586b\u5145\uff09\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12322-x8","title":"12.3.2.2 \u65e0\u6548\u7684\u6570\u636e\u5305 x8 \u793a\u4f8b","text":"<p>\u5f53\u8de8\u4ea4\u6362\u673a\u76f4\u901a TLP \u4ee5\u51cf\u5c11\u5ef6\u8fdf\u65f6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u65e0\u6548\u7684 TLP\u3002\u8fd9\u79f0\u4e3a\u4ea4\u6362\u673a\u76f4\u901a\uff08Switch Cut-Through\uff09\u64cd\u4f5c\u3002\u5728\u7ee7\u7eed\u8ba8\u8bba\u4e4b\u524d\uff0c\u8bfb\u8005\u53ef\u4ee5\u9009\u62e9\u9605\u8bfb\u7b2c 354 \u9875\u6807\u9898\u4e3a \u201c\u4ea4\u6362\u673a\u76f4\u901a\u6a21\u5f0f\uff08Switch Cut-Through Mode\uff09\u201d \u7684\u90e8\u5206\u3002</p> <p>\u65e0\u6548\u7684 TLP \u53ea\u53ef\u80fd\u51fa\u73b0\u5728\u4ea4\u6362\u673a\u7684\u51fa\u7aef\u53e3\uff0c\u5728\u63a5\u6536\u65b9\u5728\u5165\u7aef\u53e3\u63a5\u6536\u5230\u6570\u636e\u5305\uff0c\u5373\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\u4e4b\u524d\u3002\u6b64\u4f8b\u4e2d\uff0c\u56e0\u4e3a\u4f1a\u68c0\u6d4b\u5230\u4e00\u4e2a\u9519\u8bef\uff0c\u6240\u4ee5 TLP \u80af\u5b9a\u662f\u65e0\u6548\u7684\u3002</p> <p>\u56fe 12-13 \u8bf4\u660e\u4e86\u4f7f TLP \u65e0\u6548\u7684\u6b65\u9aa4\u3002\u51fa\u7aef\u53e3\u53d1\u9001\u7684 TLP \u4ece\u7b2c\u4e00\u5757\u5f00\u59cb\uff08\u7b26\u53f7 6 \u7684\u901a\u9053 0\uff09\u3002\u5f53\u68c0\u6d4b\u5230\u9519\u8bef\u65f6\uff0c\u51fa\u7aef\u53e3\u53cd\u8f6c CRC\uff08\u7b26\u53f7 1 \u7684\u901a\u9053 0-3\uff09\uff0c\u5e76\u5728 TLP\uff08\u7b26\u53f7 1 \u7684\u901a\u9053 4-7\uff09\u4e4b\u540e\u7acb\u5373\u6dfb\u52a0\u4e00\u4e2a EDB \u6807\u8bb0\u3002\u8fd9\u4e24\u4e2a\u66f4\u6539\u4e00\u8d77\u5411\u63a5\u6536\u7aef\u8868\u660e\uff0c\u8fd9\u4e2a TLP \u5df2\u7ecf\u65e0\u6548\uff0c\u5e94\u8be5\u88ab\u4e22\u5f03\u3002\u8bf7\u6ce8\u610f\uff0cEDB \u5b57\u8282\u4e0d\u5305\u62ec\u5728\u6570\u636e\u5305\u957f\u5ea6\u5b57\u6bb5\u4e2d\uff0c\u56e0\u4e3a\u5f53\u53d1\u751f\u9519\u8bef\u65f6\uff0c\u5b83\u4eec\u4f1a\u52a8\u6001\u5730\u6dfb\u52a0\u5230\u4f20\u8f93\u4e2d\u7684\u6570\u636e\u5305\u4e2d\uff08\u8bd1\u6ce8\uff1a\u6b64\u65f6\u539f TLP \u7684\u957f\u5ea6\u5df2\u7ecf\u5728 STP \u4e2d\u4f20\u8f93\u7ed9\u4e86\u5bf9\u7aef\uff0c\u60f3\u6539\u4e5f\u4e0d\u80fd\u6539\u4e86\uff09\u3002</p> <p></p> <p>\u56fe 12-13 Gen3 x8 \u65e0\u6548\u62a5\u6587 </p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12323-sos","title":"12.3.2.3 \u6709\u5e8f\u96c6\u793a\u4f8b \u2013 SOS","text":"<p>\u73b0\u5728\u6211\u4eec\u6765\u8003\u8651\u4e00\u4e2a\u6709\u5e8f\u96c6\u4f20\u8f93\u7684\u793a\u4f8b\u3002\u5982\u7b2c 427 \u9875\u56fe 12-14 \u6240\u793a\uff0c\u4e00\u4e2a\u6709\u5e8f\u96c6\u7684\u7279\u5f81\u662f\u5176 2 \u4f4d\u540c\u6b65\u9996\u90e8\u503c\u4e3a 01b\u3002\u540c\u6b65\u5934\u4e4b\u540e\u7684\u5b57\u8282\u5c06\u88ab\u63a5\u6536\u7aef\u7406\u89e3\u4e3a\u6784\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3a 16 \u5b57\u8282\uff08128 \u6bd4\u7279\uff09\u7684\u6709\u5e8f\u96c6\u3002\u552f\u4e00\u7684\u4f8b\u5916\u662f SOS\uff08Skip Ordered Set\uff09\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u88ab\u4e2d\u95f4\u63a5\u6536\u65b9\u4ee5\u6bcf\u6b21\u589e\u52a0 4 \u4e2a\u5b57\u8282\u589e\u91cf\u6539\u53d8\uff0c\u7528\u4e8e\u65f6\u949f\u8865\u507f\u3002\u56e0\u6b64\uff0c\u5141\u8bb8\u4e00\u4e2a SOS \u7684\u957f\u5ea6\u4e3a 8\u300112\u300116\u300120 \u6216 24 \u4e2a\u7b26\u53f7\u3002\u5982\u679c\u5b58\u5728\u4e0d\u4f1a\u5728 SOS \u4e2d\u6dfb\u52a0\u6216\u5220\u9664 SKP \u7684\u94fe\u8def\u4e2d\u7ee7\u5668\u8bbe\u5907\uff0cSOS \u5c06\u7531 16 \u4e2a\u5b57\u8282\u7ec4\u6210\u3002\uff08\u8bd1\u6ce8\uff1a\u539f\u6587\u5982\u6b64 In the absence of a Link repart device that does not add or delete SKP\uff09</p> <p></p> <p>\u56fe 12-14 Gen3 x1 \u6709\u5e8f\u96c6\u7ed3\u6784</p> <p>\u8ba9\u6211\u4eec\u4ee5\u4e00\u4e2a SOS \u4e3a\u4f8b\u6765\uff0c\u8bf4\u660e\u6709\u5e8f\u96c6\u5404\u79cd\u7279\u6027\u4ee5\u53ca\u5b83\u4eec\u662f\u5982\u4f55\u4e00\u8d77\u5de5\u4f5c\u7684\u3002\u6ce8\u610f\u7b2c 428 \u9875\u7684\u56fe 12-15\uff0c\u56fe\u4e2d\u6570\u636e\u5757\u540e\u9762\u8ddf\u7740\u7684\u662f SOS\u3002\u5e27\u89c4\u5219\u89c4\u5b9a\uff0c\u524d\u4e00\u4e2a\u6570\u636e\u5757\u5fc5\u987b\u4ee5\u6700\u540e\u4e00\u4e2a\u53cc\u5b57\u4e2d\u7684 EDS \u6807\u8bb0\u7ed3\u675f\uff0c\u4ee5\u4fbf\u8ba9\u63a5\u6536\u7aef\u77e5\u9053\u4e00\u4e2a\u6709\u5e8f\u96c6\u5373\u5c06\u5230\u6765\u3002\u5982\u679c\u5f53\u524d\u7684\u6570\u636e\u6d41\u8981\u7ee7\u7eed\u4e0b\u53bb\uff0c\u5219\u540e\u9762\u7684\u6709\u5e8f\u96c6\u5fc5\u987b\u662f SOS\uff0c\u800c\u4e14 SOS \u4e4b\u540e\u5fc5\u987b\u4f9d\u6b21\u662f\u53e6\u4e00\u4e2a\u6570\u636e\u5757\u3002\u6709\u4e00\u79cd\u573a\u666f\u5e76\u6ca1\u6709\u5728\u672c\u4f8b\u4e2d\u4f53\u73b0\uff1a \u6b64\u65f6 TLP \u6709\u53ef\u80fd\u8fd8\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u5728\u5fc5\u987b\u7d27\u8ddf SOS \u4e4b\u540e\u7684\u6570\u636e\u5757\u4e2d\u6062\u590d\u4f20\u8f93\uff0c\u6765\u8de8\u8d8a SOS \u4f20\u8f93\u4e00\u4e2a TLP\u3002</p> <p>\u6536\u5230 EDS \u6807\u8bb0\u610f\u5473\u7740\u6570\u636e\u6d41\u8981\u4e48\u7ed3\u675f\uff0c\u8981\u4e48\u6682\u505c\u5e76\u63d2\u5165\u4e00\u4e2a SOS\u3002EDS \u662f\u552f\u4e00\u53ef\u4ee5\u5728\u4e0e IDL \u76f8\u540c\u7684\u7b26\u53f7\u65f6\u95f4\uff0c\u5728\u53cc\u5b57\u5bf9\u9f50\u7684\u901a\u9053\u4e0a\u5f00\u59cb\u7684\u6807\u8bb0\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u662f\u8fd9\u6837\uff0c\u4ece\u7b26\u53f7\u65f6\u95f4 15 \u7684\u7b2c 4 \u901a\u9053\u5f00\u59cb\u4f20\u8f93 EDS\u3002\u56de\u987e\u4e00\u4e0b\u80cc\u666f\u77e5\u8bc6\uff0cEDS \u4e5f\u5fc5\u987b\u4f4d\u4e8e\u6570\u636e\u5757\u7684\u6700\u540e\u4e00\u4e2a\u53cc\u5b57\u91cc\u3002\u6839\u636e\u63a5\u6536\u7aef\u7684\u5e27\u8981\u6c42\uff0c\u5728 EDS \u4e4b\u540e\u53ea\u5141\u8bb8\u6709\u4e00\u4e2a\u6709\u5e8f\u96c6\u5757\uff0c\u800c\u4e14\u5fc5\u987b\u662f SOS\u3001EIOS \u6216 EIEOS\uff0c\u5426\u5219\u5c06\u88ab\u89c6\u4e3a\u6210\u5e27\u9519\u8bef\u3002\u4e0e\u65e9\u671f\u89c4\u683c\u7248\u672c\u4e00\u6837\uff0c\u6709\u5e8f\u96c6\u5fc5\u987b\u540c\u65f6\u51fa\u73b0\u5728\u6240\u6709\u901a\u9053\u4e0a\u3002\u63a5\u6536\u7aef\u53ef\u4ee5\u9009\u62e9\u68c0\u67e5\u4ee5\u786e\u4fdd\u6bcf\u4e2a\u901a\u9053\u90fd\u6536\u5230\u4e86\u76f8\u540c\u7684\u6709\u5e8f\u96c6\u3002</p> <p>\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u63a5\u4e0b\u6765\u770b\u5230\u7684\u662f\u4e00\u4e2a 16 \u5b57\u8282\u7684 SOS\uff0c\u5b83\u5728\u63a5\u6536\u7aef\u7531\u6709\u5e8f\u96c6\u7684\u540c\u6b65\u5934\u4ee5\u53ca SKP \u5b57\u8282\u6a21\u5f0f\u8bc6\u522b\u3002\u5728 SOS \u7684\u672b\u5c3e\u59cb\u7ec8\u6709 4 \u4e2a\u7b26\u53f7\uff0c\u5305\u542b\u4e86\u5f53\u524d 24 \u4f4d\u52a0\u6270\u5668 LFSR \u72b6\u6001\u3002\u5728\u7b26\u53f7 12 \u4e2d\uff0c\u63a5\u6536\u7aef\u77e5\u9053 SKP \u5b57\u7b26\u5df2\u7ecf\u7ed3\u675f\uff0c\u540c\u65f6\u4e5f\u77e5\u9053\u8be5\u5757\u8fd8\u6709\u4e09\u4e2a\u5b57\u8282\u8981\u5728\u6bcf\u6761\u901a\u9053\u4e0a\u4f20\u8f93\u3002\u8fd9\u4e9b\u662f\u52a0\u6270\u903b\u8f91 LFSR \u7684\u8f93\u51fa\uff0c\u5982\u7b2c 428 \u9875\u7684\u8868 12-2 \u6240\u793a\u3002 </p> <p>\u56fe 12-15 Gen3 x8 SOS \u793a\u4f8b</p> <p>\u8868 12-2 Gen3 16 \u4f4d Skip Ordered Set \u7f16\u7801</p> \u7b26\u53f7\u7f16\u53f7 \u503c \u63cf\u8ff0 0-11 AAh SKP \u7b26\u53f7\u3002\u7b26\u53f7 0 \u662f\u6709\u5e8f\u96c6\u7684\u6807\u8bc6\u7b26\uff0c\u56e0\u6b64\u5b83\u88ab\u89c6\u4e3a SOS\u3002 12 E1h SKP_END \u7b26\u53f7\uff0c\u8868\u793a\u518d\u8fc7 3 \u4e2a\u7b26\u53f7\u540e\uff0cSOS \u5c06\u5b8c\u6210\u3002 13 00-FFh a) \u5982\u679c LTSSM \u72b6\u6001\u4e3a Polling.Compliance\uff1aAAh  b) \u5426\u5219\uff0c\u5982\u679c\u524d\u4e00\u4e2a\u5757\u662f\u6570\u636e\u5757\uff1a   \u4f4d[7]=\u6570\u636e\u5947\u5076\u6821\u9a8c   \u4f4d[6:0]=LFSR[22:16]   c) \u5176\u4ed6\u60c5\u51b5 \u4f4d[7]=~LFSR[22]   \u4f4d[6:0]=LFSR[22:16] 14 00-FFh a) \u5982\u679c LTSSM \u7684\u72b6\u6001\u662f Polling.Compliance\uff1aError_Status[7:0]   b) \u5426\u5219 LFSR[15:8] 15 00-FFh a) \u5982\u679c LTSSM \u7684\u72b6\u6001\u662f Polling.Compliance\uff1aError_Status [7:0]   b) \u5426\u5219 LFSR[7:0] <p>\u8868\u4e2d\u63d0\u5230\u7684\u6570\u636e\u5947\u5076\u6821\u9a8c\u4f4d\u662f\u81ea\u6700\u8fd1\u7684 SDS \u6216 SOS \u4ee5\u6765\uff0c\u53d1\u9001\u7684\u6240\u6709\u6570\u636e\u5757\u52a0\u6270\u5b57\u8282\u7684\u5076\u6821\u9a8c\uff0c\u5e76\u4e14\u4e3a\u6bcf\u4e2a\u901a\u9053\u72ec\u7acb\u521b\u5efa\u3002\u63a5\u6536\u7aef\u9700\u8981\u8ba1\u7b97\u548c\u68c0\u67e5\u5947\u5076\u6821\u9a8c\u3002\u5982\u679c\u6821\u9a8c\u4f4d\u4e0e\u6570\u636e\u4e0d\u5339\u914d\uff0c\u5219\u5fc5\u987b\u8bbe\u7f6e\u4e0e\u51fa\u73b0\u9519\u8bef\u7684\u901a\u9053\u5bf9\u5e94\u7684\u901a\u9053\u9519\u8bef\u72b6\u6001\uff08Lane Error Status\uff09\u5bc4\u5b58\u5668\u4f4d\uff0c\u4f46\u8fd9\u4e0d\u4f1a\u88ab\u89c6\u4e3a\u63a5\u6536\u7aef\u9519\u8bef\uff0c\u4e5f\u4e0d\u4f1a\u542f\u52a8\u94fe\u8def\u91cd\u65b0\u8bad\u7ec3\u3002</p> <p>8 \u4f4d\u7684 Error_Status \u5b57\u6bb5\u53ea\u6709\u5728 LTSSM \u5904\u4e8e Polling.Compliance \u72b6\u6001\u65f6\u624d\u6709\u610f\u4e49\uff08\u8be6\u60c5\u89c1\u7b2c 529 \u9875\u7684 \u201cPolling.Compliance\u201d\uff09\u3002\u5bf9\u4e8e\u6211\u4eec\u7684\u6570\u636e\u5757\u4e4b\u540e\u7684 SOS \u4f8b\u5b50\uff0c\u7b2c 13 \u5b57\u8282\u662f\u6570\u636e\u5947\u5076\u6821\u9a8c\u4f4d\u548c LFSR[22:16]\uff0c\u800c\u6700\u540e\u4e24\u4e2a\u5b57\u8282\u662f LFSR \u4f4d[15:0]\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12324-sos","title":"12.3.2.4 \u53d1\u9001\u7aef SOS \u89c4\u5219","text":"<p>\u4f7f\u7528 128b/130b \u65f6\uff0c\u53d1\u9001\u7aef\u7684 SOS \u89c4\u5219\u5305\u62ec\u3002</p> <p>\u2022 \u4e00\u4e2a SOS \u5fc5\u987b\u88ab\u5b89\u6392\u5728 370 \u81f3 375 \u4e2a\u5757\u5185\u53d1\u51fa\u3002\u7136\u800c\uff0c\u5728 Loopback \u6a21\u5f0f\u4e0b\uff0cLoopback Master \u5fc5\u987b\u5728\u8fd9\u4e2a\u65f6\u95f4\u6bb5\u5185\u5b89\u6392\u4e24\u4e2a SOS\uff0c\u800c\u4e14\u5b83\u4eec\u4e4b\u95f4\u7684\u8ddd\u79bb\u4e0d\u5f97\u8d85\u8fc7\u4e24\u4e2a\u5757\u3002</p> <p>\u2022 SOS \u4ecd\u7136\u53ea\u80fd\u5728\u6570\u636e\u5305\u8fb9\u754c\u53d1\u9001\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u7d2f\u79ef\u591a\u4e2a\u5f85\u53d1\u9001\u7684 SOS\uff0c\u4f46\u662f\uff0c\u8fde\u7eed\u7684 SOS \u662f\u4e0d\u5141\u8bb8\u7684\uff1b\u5b83\u4eec\u4e4b\u95f4\u5fc5\u987b\u95f4\u9694\u6570\u636e\u5757\u3002</p> <p>\u2022 \u5efa\u8bae\u6bcf\u5f53\u53d1\u9001\u7aef\u5904\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u590d\u4f4d SOS \u8ba1\u65f6\u5668\u548c\u8ba1\u6570\u5668\u3002</p> <p>\u2022 \u4f7f\u7528 128b/130b \u65f6\uff0c\u94fe\u63a5\u63a7\u5236\u5bc4\u5b58\u5668 2 \uff08 Link Control Register 2\uff09\u4e2d\u7684\u4e00\u81f4\u6027\uff08Compliance\uff09SOS \u4f4d\u65e0\u6548\u3002(\u5b83\u7528\u6765\u5728 8b/10b \u7f16\u7801\u6a21\u5f0f\u7684\u4e00\u81f4\u6027\u6d4b\u8bd5\u4e2d\u7981\u7528 SOS\uff0c\u4f46\u662f 128b/130b \u7f16\u7801\u6a21\u5f0f\u4e0d\u652f\u6301\u8fd9\u4e00\u9009\u9879\uff09\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12325-sos","title":"12.3.2.5 \u63a5\u6536\u7aef SOS \u89c4\u5219","text":"<p>\u4f7f\u7528 128b/130b \u7f16\u7801\u6a21\u5f0f\u65f6\uff0c\u63a5\u6536\u7aef\u63a5\u6536 SOS\uff08Skip Ordered Set\uff09\u7684\u89c4\u5219\u5305\u62ec\uff1a</p> <p>\u2022 \u4ed6\u4eec\u5fc5\u987b\u5bb9\u5fcd\u4ee5 370-375 \u4e2a\u5757\u7684\u5e73\u5747\u95f4\u9694\u63a5\u6536 SOS\u3002\u8bf7\u6ce8\u610f\uff0c\u7535\u6c14\u7a7a\u95f2\u540e\u7684\u7b2c\u4e00\u4e2a SOS \u53ef\u80fd\u4f1a\u63d0\u524d\u5230\u8fbe\uff0c\u56e0\u4e3a\u53d1\u9001\u7aef\u4e0d\u9700\u8981\u5728\u7535\u6c14\u7a7a\u95f2\u65f6\u95f4\u5185\u590d\u4f4d SOS \u8ba1\u65f6\u5668\uff08\u8bd1\u6ce8\uff1a\u867d\u7136\u5efa\u8bae\u53d1\u9001\u65b9\u8fd9\u4e48\u505a\uff09\u3002</p> <p>\u2022 \u63a5\u6536\u7aef\u5fc5\u987b\u68c0\u67e5\u6570\u636e\u6d41\u4e2d\u7684\u6bcf\u4e2a SOS \u4e4b\u524d\u90fd\u6709\u4e00\u4e2a\u4ee5 EDS \u7ed3\u5c3e\u7684\u6570\u636e\u5757\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1233","title":"12.3.3 \u52a0\u6270","text":"<p>128b/130b \u7684\u52a0\u6270\u903b\u8f91\u662f\u4ece\u524d\u51e0\u4ee3 PCIe \u4fee\u6539\u800c\u6765\u7684\uff0c\u4ee5\u89e3\u51b3 8b/10b \u7f16\u7801\u65f6\u4ee3\u65e0\u9700\u8003\u8651\uff088b/10b \u7f16\u7801\u672c\u8eab\u7279\u6027\u4f1a\u89e3\u51b3\u8fd9\u4e24\u4e2a\u95ee\u9898\uff09\u7684\u4e24\u4e2a\u95ee\u9898\uff1a\u4fdd\u6301 DC \u5e73\u8861\u548c\u63d0\u4f9b\u8db3\u591f\u7684\u8f6c\u6362\u5bc6\u5ea6\uff08transition density\uff09\u3002\u56de\u987e\u4e00\u4e0b\uff0cDC \u5e73\u8861\u610f\u5473\u7740\u6bd4\u7279\u6d41\u4e2d\u7684 1 \u548c 0 \u7684\u6570\u91cf\u76f8\u7b49\u3002\u8fd9\u662f\u4e3a\u4e86\u907f\u514d \u201cDC wonder\u201d \u7684\u95ee\u9898\uff0c\u5373\u4f20\u8f93\u4ecb\u8d28\u6301\u7eed\u5145\u7535/\u653e\u7535\uff0c\u4ee5\u81f3\u4e8e\u59cb\u7ec8\u4fdd\u6301\u5728\u67d0\u4e2a\u7535\u538b\u503c\uff0c\u901a\u5e38\u4e3a 1 \u6216 0\uff0c\u4ee5\u81f3\u4e8e\u96be\u4ee5\u5728\u5fc5\u8981\u77ed\u7684\u65f6\u95f4\u5185\u5207\u6362\u5230\u53e6\u4e00\u4fe1\u53f7\u7535\u5e73\u503c\u4e0a\u3002\u53e6\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u63a5\u6536\u7aef\u7684\u65f6\u949f\u6062\u590d\u903b\u8f91\u9700\u8981\u5728\u8f93\u5165\u4fe1\u53f7\u4e2d\u770b\u5230\u8db3\u591f\u7684\u8df3\u53d8\u8fb9\u7f18\uff08edge\uff09\uff0c\u4ee5\u4fbf\u80fd\u591f\u5c06\u5b83\u4eec\u4e0e\u6062\u590d\u7684\u65f6\u949f\u8fdb\u884c\u6bd4\u8f83\uff0c\u5e76\u6839\u636e\u9700\u8981\u8c03\u6574\u65f6\u5e8f\u548c\u76f8\u4f4d\u3002</p> <p>\u5728\u6ca1\u6709 8b/10b \u7f16\u7801\u6765\u5904\u7406\u8fd9\u4e9b\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\uff0c\u91c7\u53d6\u4e86\u4e09\u4e2a\u6b65\u9aa4\uff1a\u7b2c\u4e00\uff0c\u65b0\u7684\u52a0\u6270\u65b9\u6cd5\u5728\u8f83\u957f\u7684\u65f6\u95f4\u6bb5\u5185\u6539\u5584\u4e86\u8f6c\u6362\u5bc6\u5ea6\u548c DC \u5e73\u8861\uff0c\u4f46\u4e0d\u80fd\u50cf 8b/10b \u7f16\u7801\u90a3\u6837\u5728\u77ed\u671f\u5185\u4fdd\u8bc1\u5b83\u4eec\u3002\u7b2c\u4e8c\uff0c\u8bad\u7ec3\u671f\u95f4\u4f7f\u7528\u7684 TS1 \u548c TS2 \u6709\u5e8f\u96c6\u6a21\u5f0f\u5305\u62ec\u6839\u636e\u9700\u8981\u8c03\u6574\u7684\u5b57\u6bb5\uff0c\u4ee5\u6539\u5584 DC \u5e73\u8861\u3002\u7b2c\u4e09\uff0c\u63a5\u6536\u7aef\u5fc5\u987b\u6bd4\u524d\u51e0\u4ee3\u66f4\u52a0\u9c81\u68d2\uff0c\u80fd\u5bb9\u5fcd\u8fd9\u4e9b\u95ee\u9898\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12331-lfsr","title":"12.3.3.1 LFSR \u7684\u6570\u91cf","text":"<p>\u5728\u8f83\u4f4e\u7684\u6570\u636e\u901f\u7387\u4e0b\uff0c\u6bcf\u6761\u901a\u9053\u90fd\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u8fdb\u884c\u52a0\u6270\uff0c\u56e0\u6b64\u4e00\u4e2a\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\uff08LFSR\uff09\u53ef\u4ee5\u4e3a\u6240\u6709\u7684\u901a\u9053\u63d0\u4f9b\u52a0\u6270\u8f93\u5165\u3002\u7136\u800c\uff0c\u5bf9\u4e8e Gen3\uff0c\u8bbe\u8ba1\u8005\u5e0c\u671b\u4e3a\u76f8\u90bb\u7684\u901a\u9053\u63d0\u4f9b\u4e0d\u540c\u7684\u52a0\u6270\u503c\u3002\u5176\u539f\u56e0\u53ef\u80fd\u5305\u62ec\u5e0c\u671b\u901a\u8fc7\u52a0\u6270\u5f7c\u6b64\u7684\u8f93\u51fa\u6765\u51cf\u5c11\u901a\u9053\u4e4b\u95f4\u4e32\u6270\uff08cross-talk\uff09\u7684\u53ef\u80fd\u6027\uff0c\u5e76\u907f\u514d\u5728\u6bcf\u4e2a\u901a\u9053\u4e0a\u6709\u76f8\u540c\u7684\u503c\uff0c\u6bd4\u5982\u53d1\u9001 IDL \u65f6\u3002\u8be5\u89c4\u8303\u63cf\u8ff0\u4e86\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u7684\u4e24\u79cd\u65b9\u6cd5\uff0c\u4e00\u79cd\u662f\u5f3a\u8c03\u66f4\u4f4e\u7684\u5ef6\u8fdf\uff0c\u53e6\u4e00\u79cd\u662f\u5f3a\u8c03\u66f4\u4f4e\u7684\u6210\u672c\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#123311-lfsr","title":"12.3.3.1.1 \u7b2c\u4e00\u79cd\u9009\u62e9\uff1a\u591a\u4e2a LFSR","text":"<p>\u7b2c\u4e00\u79cd\u9009\u62e9\uff1a\u591a\u4e2aLFSR\u3002\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u662f\u4e3a\u6bcf\u4e2a\u901a\u9053\u5b9e\u73b0\u4e00\u4e2a\u5355\u72ec\u7684 LFSR\uff0c\u5e76\u7528\u4e0d\u540c\u7684\u8d77\u59cb\u503c\u6216 \u201c\u79cd\u5b50\u201d \u6765\u521d\u59cb\u5316\u6bcf\u4e2a\u901a\u9053\u3002\u8fd9\u5177\u6709\u7b80\u5355\u548c\u5feb\u901f\u7684\u4f18\u70b9\uff0c\u4f46\u4ee3\u4ef7\u662f\u589e\u52a0\u4e86\u903b\u8f91\u6570\u91cf\u3002\u5982\u56fe 12-16 \u6240\u793a\uff0c\u6bcf\u4e2a LFSR \u6839\u636e\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u591a\u9879\u5f0f G(X)=X<sup>23+X</sup>21+X<sup>16+X</sup>8+X<sup>5+X</sup>2+1 \u521b\u5efa\u4e00\u4e2a\u4f2a\u968f\u673a\u8f93\u51fa\u3002\u8fd9\u4e2a\u591a\u9879\u5f0f\u6bd4\u4ee5\u524d\u7684\u7248\u672c\u8981\u957f\uff0c\u800c\u4e14\u7531\u4e8e\u79cd\u5b50\u503c\u7684\u4e0d\u540c\uff0c\u901a\u9053\u4e4b\u95f4\u7684\u8f93\u51fa\u503c\u4e5f\u6709\u4e00\u4e9b\u4e0d\u540c\u3002\u4ee5 x8 \u901a\u9053\u4e3a\u4f8b\uff0c\u4e3a\u6bcf\u4e2a\u901a\u9053\u5206\u914d\u7684\uff0c\u5171\u8ba1\u516b\u4e2a\u4e0d\u540c\u7684\u79cd\u5b50\u503c\u9700\u8981\u516b\u4e2a\u4e0d\u540c\u7684 LFSR\uff0c\u901a\u9053 0 \u5230 7 \u5404\u4e00\u4e2a\u3002</p> <p></p> <p>\u56fe 12-16 Gen3 \u5404\u901a\u9053\u72ec\u7acb LFSR \u7684\u52a0\u6270\u903b\u8f91</p> <p>\u7b2c 432 \u9875\u7684\u8868 12-3 \u5217\u51fa\u4e86\u6bcf\u4e2a\u901a\u9053\u7684 24 \u4f4d\u79cd\u5b50\u503c\u3002\u540e\u7eed\u5e8f\u5217\u5c06\u91cd\u590d\u5148\u524d\u7684\u6570\u503c\uff0c\u8fd9\u610f\u5473\u7740\u901a\u9053 8 \u7684\u79cd\u5b50\u503c\u5c06\u4e0e\u901a\u9053 0 \u76f8\u540c\uff0c\u56e0\u6b64\u8fd9\u91cc\u4ec5\u5217\u51fa\u524d 8 \u4e2a\u503c\u3002\u6bcf\u4e2a\u901a\u9053\u4f7f\u7528\u76f8\u540c\u7684 LFSR \u548c\u76f8\u540c\u7684\u62bd\u5934\uff08tap point\uff09\u6765\u521b\u5efa\u52a0\u6270\u8f93\u51fa\uff0c\u4f7f\u7528\u4e0d\u540c\u7684\u79cd\u5b50\u503c\u6765\u4ea7\u751f\u6240\u9700\u7684\u5dee\u5f02\u3002</p> <p>\u8868 12-3 Gen3 \u52a0\u6270\u79cd\u5b50\u503c</p> <p></p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#123312-lfsr","title":"12.3.3.1.2 \u7b2c\u4e8c\u79cd\u9009\u62e9\uff1a\u5355\u4e2a LFSR","text":"<p>\u7b2c\u4e8c\u79cd\u9009\u62e9\uff1a\u5355 LFSR\uff1a\u53e6\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u53ea\u4f7f\u7528\u5355\u4e2a LFSR\uff0c\u5982\u7b2c 433 \u9875\u56fe 12-17 \u6240\u793a\uff0c\u56fe\u4e2d\u5c55\u793a\u7684\u901a\u9053 2\u300110\u300118 \u548c 26 \u5171\u4eab\u7684\u52a0\u6270\u903b\u8f91\uff0c\u5e76\u901a\u8fc7\u5c06\u4e0d\u540c\u7684\u62bd\u5934\u5f02\u6216\u4e3a\u5404\u4e2a\u901a\u9053\u521b\u5efa\u52a0\u6270\u8f93\u5165\u3002\u7531\u4e8e\u53ea\u6709\u4e00\u4e2a LFSR\uff0c\u6240\u6709\u901a\u9053\u7684\u79cd\u5b50\u503c\u662f\u76f8\u540c\u7684\uff08\u5168 1\uff0c all ones\uff09\uff0c\u4f46\u6bcf\u4e2a\u901a\u9053\u7684\u52a0\u6270 \u201c\u62bd\u5934\u8868\u8fbe\u5f0f\uff08Tap Equation\uff09\u201d \u662f\u7531\u4e0d\u540c\u7684\u62bd\u5934\u7ec4\u5408\u800c\u6210\u7684\uff0c\u5982\u7b2c 433 \u9875\u7684\u8868 12-4 \u6240\u793a\u3002\u8be5\u89c4\u8303\u8fd8\u6307\u51fa\uff0c4 \u4e2a\u901a\u9053\u7684\u62bd\u5934\u8868\u8fbe\u5f0f\u53ef\u4ee5\u901a\u8fc7 XOR \u5b83\u4eec\u7684\u4f4d\u90bb\u7684\u62bd\u5934\u503c\u800c\u5f97\u5230\u3002</p> <p>\u2022 Lane 0 = Lane 7 XOR Lane 1\uff08\u6ce8\u610f\uff0c\u9700\u8981\u6bd4\u901a\u9053 0 \u66f4\u4f4e\u7684\u901a\u9053\u65f6\uff0c\u62bd\u5934\u89c4\u5f8b\u662f\u7ed5\u56de\u7684\uff0c\u56e0\u6b64 Lane 7 \u88ab\u8ba4\u4e3a\u662f Lane 0 \u76f8\u90bb\u7684\u4f4e\u901a\u9053\uff09\u3002</p> <p>\u2022 Lane 2 = Lane 1 XOR Lane 3</p> <p>\u2022 Lane 4 = Lane 3 XOR Lane 5</p> <p>\u2022 Lane 6 = Lane 5 XOR Lane 7</p> <p>\u5355 LFSR \u89e3\u51b3\u65b9\u6848\u4f7f\u7528\u7684\u903b\u8f91\u95e8\u6570\u6bd4\u591a LFSR \u7248\u672c\u5c11\uff0c\u4f46 XOR \u8fc7\u7a0b\u4ea7\u751f\u4e86\u989d\u5916\u7684\u5ef6\u8fdf\uff0c\u76f8\u8f83\u4e8e\u591a LFSR \u65b9\u6848\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e0d\u540c\u7684\u6210\u672c/\u6027\u80fd\u9009\u62e9\u3002</p> <p></p> <p>\u56fe 12-17 Gen3 \u4f7f\u7528\u5355\u4e2a LFSR \u7684\u52a0\u6270\u903b\u8f91</p> <p>\u8868 12-4 \u5355 LFSR \u65b9\u6848\u62bd\u5934\u8868\u8fbe\u5f0f</p> <p></p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12332","title":"12.3.3.2 \u52a0\u6270\u89c4\u5219","text":"<p>Gen3 \u52a0\u6270\u5668 LFSR\uff08\u65e0\u8bba\u662f\u5728\u4e00\u4e2a\u8fd8\u662f\u591a\u4e2a LFSR \u65b9\u6848\u4e2d\uff09\u5e76\u4e0d\u4f1a\u4e0d\u65ad\u79fb\u4f4d\u79fb\u4f4d\u5bc4\u5b58\u5668\uff08advance\uff09\uff0c\u800c\u53ea\u662f\u6839\u636e\u6b63\u5728\u53d1\u9001\u7684\u5185\u5bb9\u79fb\u4f4d\u3002\u52a0\u6270\u5668\u5fc5\u987b\u5b9a\u671f\u91cd\u65b0\u521d\u59cb\u5316\uff0c\u6bcf\u5f53\u68c0\u6d4b\u5230 EIEOS \u6216 FTSOS \u65f6\u90fd\u4f1a\u8fdb\u884c\u521d\u59cb\u5316\u3002\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u5728\u672c\u8282\u603b\u7ed3\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u4ee5\u4e0b\u51e0\u79cd\u52a0\u6270\u89c4\u5219\uff1a </p> <p>\u2022 \u540c\u6b65\u5934\u4f4d\u4e0d\u4f1a\u88ab\u52a0\u6270\uff0c\u4e5f\u4e0d\u4f1a\u4f7f LFSR \u4e2d\u7684\u7801\u6d41\u3002</p> <p>\u2022 \u5f53\u6700\u540e\u4e00\u4e2a EIEOS \u7b26\u53f7\u88ab\u53d1\u9001\u65f6\uff0c\u53d1\u9001\u7aef LFSR \u88ab\u590d\u4f4d\uff0c\u5f53\u6700\u540e\u4e00\u4e2a EIEOS \u7b26\u53f7\u88ab\u63a5\u6536\u65f6\uff0c\u63a5\u6536\u7aef LFSR \u88ab\u590d\u4f4d\u3002</p> <p>\u2022 TS1 \u548c TS2 \u6709\u5e8f\u96c6\uff1a</p> <p>\u2014 \u7b26\u53f7 0 \u4e0d\u4f1a\u88ab\u52a0\u6270</p> <p>\u2014 \u7b26\u53f7 1 \u81f3 13 \u88ab\u52a0\u6270</p> <p>\u2014 \u7b26\u53f7 14 \u548c 15 \u53ef\u80fd\u4f1a\u4e5f\u53ef\u80fd\u4e0d\u4f1a\u88ab\u52a0\u6270\u3002\u89c4\u8303\u89c4\u5b9a\uff0c\u5982\u679c\u6709\u5fc5\u8981\u6539\u5584 DC \u5e73\u8861\uff0c\u5b83\u4eec\u5c06\u7ed5\u8fc7\u52a0\u6270\uff0c\u5426\u5219\u5c06\u52a0\u6270\uff08\u5173\u4e8e\u5982\u4f55\u4fdd\u6301 DC \u5e73\u8861\u7684\u66f4\u591a\u7ec6\u8282\uff0c\u89c1\u7b2c 510 \u9875\u7684\u201cTS1 \u548c TS2 \u6709\u5e8f\u96c6\u201d\uff09\u3002</p> <p>\u2022 \u6709\u5e8f\u96c6 FTS\u3001SDS\u3001EIEOS\u3001EIOS \u548c SOS \u7684\u6240\u6709\u7b26\u53f7\u90fd\u4e0d\u4f1a\u88ab\u52a0\u6270\u3002\u5c3d\u7ba1\u5982\u6b64\uff0c\u8f93\u51fa\u7684\u6570\u636e\u6d41\u5c06\u6709\u8db3\u591f\u7684\u8f6c\u6362\u5bc6\u5ea6\u4ee5\u5141\u8bb8\u65f6\u949f\u6062\u590d\uff0c\u800c\u4e14\u5b9e\u73b0 DC \u5e73\u8861\uff0c\u56e0\u4e3a\u6709\u5e8f\u96c6\u672c\u8eab\u7684\u7b26\u53f7\u9009\u62e9\u4f1a\u5b9e\u73b0\u4e0a\u8ff0\u4e24\u70b9\u3002</p> <p>\u2022 \u5373\u4f7f\u65c1\u8def\uff08bypassed\uff09\u65f6\uff0c\u53d1\u9001\u7aef\u4e5f\u4f1a\u5c06\u6240\u6709\u6709\u5e8f\u96c6\u7b26\u53f7\u79fb\u4f4d\u81f3\u4ed6\u4eec LFSR \u7684\u7801\u6d41\u4e2d\uff0c\u9664\u4e86 SOS \u4e2d\u7684\u7b26\u53f7\u3002</p> <p>\u2022 \u63a5\u6536\u7aef\u4e5f\u662f\u8fd9\u6837\u505a\u7684\uff0c\u68c0\u67e5\u4f20\u5165\u7684\u6709\u5e8f\u96c6\u7684\u7b26\u53f7 0\uff0c\u770b\u5b83\u662f\u5426\u662f SOS\u3002\u5982\u679c\u662f\u7684\u8bdd\uff0cLFSRs \u5c31\u4e0d\u4f1a\u79fb\u5165\u8be5\u5757\u4e2d\u7684\u4efb\u4f55\u7b26\u53f7\u3002\u5426\u5219\uff0cLFSR \u5c06\u79fb\u5165\u8be5\u5757\u4e2d\u7684\u6240\u6709\u7b26\u53f7\u3002</p> <p>\u2022 \u6240\u6709\u7684\u6570\u636e\u5757\u7b26\u53f7\u88ab\u52a0\u6270\u5e76\u88ab\u79fb\u5165 LFSRs\u3002</p> <p>\u2022 \u7b26\u53f7\u662f\u6309\u5c0f\u7aef\u987a\u5e8f\u8fdb\u884c\u52a0\u6270\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u610f\u5473\u7740\u6700\u4f4e\u6709\u6548\u4f4d\u9996\u5148\u52a0\u6270\uff0c\u6700\u9ad8\u6709\u6548\u4f4d\u6700\u540e\u52a0\u6270\u3002</p> <p>\u2022 \u6bcf\u4e2a\u901a\u9053 LFSR \u7684\u79cd\u5b50\u503c\u53d6\u51b3\u4e8e LTSSM \u7b2c\u4e00\u6b21\u8fdb\u5165 Configuration.Idle\uff08\u5df2\u5b8c\u6210\u8f6e\u8be2\u72b6\u6001\uff09\u65f6\u5206\u914d\u7ed9\u8be5\u901a\u9053\u7684\u901a\u9053\u6570\u3002\u7b2c 432 \u9875\u7684\u8868 12-3 \u4e2d\u663e\u793a\u4e86\u6a21\u6570\u4e3a 8 \u7684\u79cd\u5b50\u503c\uff0c\u4e00\u65e6\u5206\u914d\uff0c\u53ea\u8981 LinkUp=1\uff0c\u5c31\u4e0d\u4f1a\u6539\u53d8\uff0c\u5373\u4f7f\u901a\u9053\u7f16\u53f7\u56e0\u4e3a\u56de\u5230\u914d\u7f6e\u72b6\u6001\u800c\u5df2\u7ecf\u88ab\u91cd\u65b0\u5206\u914d\u4e86\u3002</p> <p>\u2022 \u4e0e 8b/10b \u4e0d\u540c\uff0c\u5728\u4f7f\u7528 128b/130b \u7f16\u7801\u65f6\uff0c\u4e0d\u80fd\u7981\u7528\u52a0\u6270\u5668\uff0c\u56e0\u4e3a\u9700\u8981\u5b83\u6765\u5e2e\u52a9\u5b9e\u73b0\u4fe1\u53f7\u5b8c\u6574\u6027\u3002\u5982\u679c\u6ca1\u6709\u52a0\u6270\uff0c\u9884\u8ba1\u94fe\u8def\u5c06\u65e0\u6cd5\u53ef\u9760\u8fd0\u884c\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u59cb\u7ec8\u5904\u4e8e\u4f7f\u80fd\u72b6\u6001\u3002</p> <p>\u2022 Loopback Slave \u4e0d\u5f97\u5bf9\u56de\u73af\uff08loope-back\uff09\u4f4d\u8fdb\u884c\u52a0\u6270\u6216\u89e3\u6270\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1234","title":"12.3.4 \u4e32\u884c\u5668","text":"<p>\u8fd9\u4e2a\u79fb\u4f4d\u5bc4\u5b58\u5668\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0e Gen1/Gen2 \u6570\u636e\u901f\u7387\u7684\u5de5\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u53ea\u662f\u5b83\u73b0\u5728\u4e00\u6b21\u63a5\u6536 8 \u4f4d\uff0c\u800c\u4e0d\u662f 10 \u4f4d\uff08\u5373\uff0c\u4e32\u884c\u5668\u662f\u4e00\u4e2a 8 \u4f4d\u5e76\u884c\u5230\u4e32\u884c\u79fb\u4f4d\u5bc4\u5b58\u5668\uff09\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1235","title":"12.3.5 \u7528\u4e8e\u540c\u6b65\u5934\u4f4d\u7684\u591a\u8def\u590d\u7528\u5668","text":"<p>\u6700\u540e\uff0c\u6bcf\u4e2a\u5757\u4e2d\u5fc5\u987b\u52a0\u5165\u4e24\u4e2a\u540c\u6b65\u5934\u4f4d\uff0c\u4f7f\u63a5\u6536\u7aef\u80fd\u591f\u533a\u5206\u4e0b\u4e00\u4e2a\u5b57\u7b26\u5757\u662f\u6570\u636e\u5757\u8fd8\u662f\u6709\u5e8f\u96c6\u5757\u3002\u4f4d\u4e8e\u6bcf\u4e00\u4e2a 130 \u4f4d\u5757\u7684\u524d\u4e24\u4f4d\uff0c\u540c\u6b65\u5934\u6bd4\u7279\u7684\u76f8\u5173\u903b\u8f91\u53ef\u4ee5\u6dfb\u52a0\u5230\u53d1\u9001\u7aef\u4e2d\u6709\u8bbe\u8ba1\u610f\u4e49\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002\u5728\u8fd9\u672c\u4f8b\u4e2d\uff0c\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u8fd9\u4e9b\u6bd4\u7279\u662f\u5728\u53d1\u9001\u8fc7\u7a0b\u7684\u6700\u540e\u6ce8\u5165\u7684\u3002\u65e0\u8bba\u4ed6\u4eec\u5305\u542b\u5728\u4f55\u5904\uff0c\u4e0a\u9762\u7684\u5b57\u8282\u6d41\u5fc5\u987b\u505c\u987f\u4e0b\u6765\uff0c\u4ee5\u4fbf\u4e3a\u6dfb\u52a0\u5b83\u4eec\u7559\u51fa\u65f6\u95f4\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u9700\u8981\u6709\u4e00\u79cd\u65b9\u6cd5\u6765\u901a\u77e5\u4e0a\u8ff0\u7684\u903b\u8f91\u6682\u505c\u4e24\u4e2a\u6bd4\u7279\u7684\u65f6\u95f4\u3002\u5728\u53d1\u9001\u540c\u6b65\u4f4d\u671f\u95f4\uff0c\u4f20\u5165\u7684\u6570\u636e\u5305\u6d41\u5c06\u5728 Tx \u7f13\u51b2\u533a\u4e2d\u6392\u961f\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#124-gen3","title":"12.4 Gen3 \u7269\u7406\u5c42\u63a5\u6536\u903b\u8f91","text":"<p>\u4e0e\u524d\u51e0\u4ee3\u4e00\u6837\uff0c\u5982\u7b2c 436 \u9875\u56fe 12-18 \u6240\u793a\uff0c\u63a5\u6536\u7aef\u7684\u903b\u8f91\u4ece CDR\uff08\u65f6\u949f\u548c\u6570\u636e\u6062\u590d\uff0cClock and Data Recovery\uff09\u7535\u8def\u5f00\u59cb\u3002\u903b\u8f91\u4e2d\u53ef\u80fd\u5305\u62ec PLL\uff0c\u8be5 PLL \u6839\u636e\u9884\u671f\u9891\u7387\u548c\u6bd4\u7279\u6d41\u4e2d\u7684\u7535\u5e73\u8df3\u53d8\u9501\u5b9a\u53d1\u9001\u7aef\u65f6\u949f\u7684\u9891\u7387\uff0c\u4ee5\u4ea7\u751f\u6062\u590d\u7684\u65f6\u949f\uff08RX \u65f6\u949f\uff09\u3002\u8fd9\u4e2a\u6062\u590d\u65f6\u949f\u5c06\u9501\u5b58\u8f93\u5165\u6570\u636e\u5230\u4e32\u5e76\u8f6c\u6362\u7f13\u51b2\u5668\u4e2d\uff0c\u5728\u5efa\u7acb\u4e86\u5757\u5bf9\u9f50\u540e\uff08\u5728 LTSSM \u7684\u6062\u590d\u72b6\u6001\u4e0b\u5b9e\u73b0\uff09\uff0c\u53e6\u4e00\u4e2a\u662f RX \u65f6\u949f 8.125 \u5206\u9891\u7684\u6062\u590d\u65f6\u949f\uff08RX Clock/8.125\uff09\u5c06 8 \u4f4d\u7b26\u53f7\u9501\u5b58\u5230\u5f39\u6027\u7f13\u51b2\u5668\uff08Elastic Buffer\uff09\u4e2d\u3002\u4e4b\u540e\uff0c\u89e3\u6270\u5668\u4ece\u52a0\u6270\u7684\u5b57\u7b26\u4e2d\u91cd\u65b0\u6062\u590d\u51fa\u539f\u59cb\u6570\u636e\u3002\u8fd9\u4e9b\u5b57\u8282\u7ed5\u8fc7 8b/10b \u89e3\u7801\u5668\uff0c\u76f4\u63a5\u88ab\u9001\u5230\u5b57\u8282\u62c6\u5206\uff08Byte Un-striping\uff09\u903b\u8f91\u3002\u6700\u540e\uff0c\u6709\u5e8f\u96c6\u88ab\u8fc7\u6ee4\u51fa\u6765\uff0c\u5728\u7269\u7406\u5c42\u5904\u7406\uff0c\u5269\u4e0b\u7684 TLPs \u548c DLLPs \u5b57\u8282\u6d41\u88ab\u8f6c\u53d1\u5230\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u5728\u4e0b\u9762\u7684\u8ba8\u8bba\u4e2d\uff0c\u5c06\u4ece\u56fe 12-18 \u5e95\u90e8\u5411\u4e0a\u63cf\u8ff0\u6bcf\u4e2a\u90e8\u5206\u3002\u91cd\u70b9\u662f\u63cf\u8ff0\u4e3a 8.0GT/s \u6539\u53d8\u7684\u7269\u7406\u5c42\u7684\u5404\u4e2a\u65b9\u9762\u3002\u672c\u8282\u5c06\u4e0d\u4f1a\u63cf\u8ff0\u90a3\u4e9b\u76f8\u6bd4 Gen1/Gen2 \u534f\u8bae\u6ca1\u6709\u53d8\u5316\u7684\u5b50\u5757\u3002</p> <p></p> <p>\u56fe 12-18 Gen3 \u7269\u7406\u5c42\u63a5\u6536\u903b\u8f91\u8be6\u7ec6\u6846\u56fe</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1241","title":"12.4.1 \u5dee\u5206\u63a5\u6536","text":"<p>\u5dee\u5206\u63a5\u6536\u7aef\u7684\u903b\u8f91\u6ca1\u6709\u53d8\u5316\uff0c\u4f46\u6709\u7528\u4e8e\u6539\u5584\u4fe1\u53f7\u5b8c\u6574\u6027\u7684\u7535\u6c14\u53d8\u5316\uff08\u53c2\u89c1\u7b2c 468 \u9875\u7684 \u201c\u4fe1\u53f7\u8865\u507f\u201d\uff09\uff0c\u4ee5\u53ca\u5efa\u7acb\u4fe1\u53f7\u5747\u8861\u7684\u8bad\u7ec3\u53d8\u5316\uff0c\u8fd9\u5728\u7b2c 577 \u9875\u7684 \u201c\u94fe\u8def\u5747\u8861\u6982\u8ff0\u201d \u4e2d\u6709\u6240\u4ecb\u7ecd\u3002</p> <p></p> <p>\u56fe 12-19 Gen3 CDR \u903b\u8f91</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1242-cdr","title":"12.4.2 CDR\uff08\u65f6\u949f\u548c\u6570\u636e\u6062\u590d\uff09\u903b\u8f91","text":""},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12421-rx","title":"12.4.2.1 RX \u65f6\u949f\u6062\u590d","text":"<p>\u5c3d\u7ba1\u65b0\u7684\u52a0\u6270\u65b9\u6848\u6709\u52a9\u4e8e\u65f6\u949f\u6062\u590d\uff0c\u4f46\u5b83\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u5728\u77ed\u95f4\u9694\u5185\u6709\u826f\u597d\u7684\u8f6c\u6362\u5bc6\u5ea6\u3002\u56e0\u6b64\uff0cCDR \u903b\u8f91\u73b0\u5728\u5fc5\u987b\u80fd\u591f\u5728\u6ca1\u6709\u90a3\u4e48\u591a\u7535\u5e73\u8df3\u53d8\u8fb9\u6cbf\u7684\u60c5\u51b5\u4e0b\u4fdd\u6301\u8f83\u957f\u65f6\u95f4\u7684\u540c\u6b65\u3002\u89c4\u8303\u4e2d\u6ca1\u6709\u7ed9\u51fa\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u7684\u5177\u4f53\u65b9\u6cd5\uff0c\u4f46\u53ef\u80fd\u9700\u8981\u4e00\u4e2a\u66f4\u9c81\u68d2\u7684 PLL\uff08\u9501\u76f8\u73af\uff0cPhas-Locked Loop\uff09\u6216 DLL\uff08\u5ef6\u8fdf\u9501\u76f8\u73af\uff0cDelay-Locked Loop\uff09\u7535\u8def\u3002</p> <p>CDR \u903b\u8f91\u7684\u53e6\u4e00\u4e2a\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0cGen3 \u5f39\u6027\u7f13\u51b2\u5668\u4f7f\u7528\u7684\u5185\u90e8\u65f6\u949f\u5e76\u4e0d\u50cf\u4eba\u4eec\u60f3\u8c61\u7684\u90a3\u6837\uff0c\u7b80\u5355\u5730\u5c06 RX \u65f6\u949f 8 \u5206\u9891\u3002\u663e\u800c\u6613\u89c1\u7684\u539f\u56e0\u662f Gen3 \u8f93\u5165\u6570\u636e\u4e0d\u53ea\u662f 8 \u5b57\u8282\u7684\u500d\u6570\u3002\u76f8\u53cd\uff0c\u5b83\u662f\u4e00\u4e2a 2 \u4f4d\u7684\u540c\u6b65\u5934\uff0c\u5176\u540e\u662f 16 \u4e2a\u5b57\u8282\u3002\u8fd9\u989d\u5916\u7684\u4e24\u6bd4\u7279\u5fc5\u987b\u5728\u4e00\u4e9b\u903b\u8f91\u4e2d\u8fdb\u884c\u5904\u7406\u3002\u89c4\u8303\u6ca1\u6709\u8981\u6c42\u4efb\u4f55\u7279\u5b9a\u7684\u5b9e\u73b0\uff0c\u4f46\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\u662f\u4ecd\u7136\u5c06\u65f6\u949f\u9664\u4ee5 8.125\uff0c\u5982\u7b2c 437 \u9875\u7684\u56fe 12-19 \u6240\u793a\uff0c\u5728 130 \u4f4d\u65f6\u95f4\u5185\u4ea7\u751f 16 \u4e2a\u65f6\u949f\u8fb9\u7f18\u3002</p> <p>\u8003\u8651\u5230\u5757\u7c7b\u578b\u68c0\u6d4b\u903b\u8f91\u59cb\u7ec8\u9700\u8981\u63d0\u53d6\u51fa\u4e24\u6bd4\u7279\u540c\u6b65\u5934\uff0c\u5bf9\u5176\u8fdb\u884c\u68c0\u67e5\uff0c\u6240\u4ee5\uff0c\u53ef\u4ee5\u5728\u8fbe\u5230\u5757\u8fb9\u754c\u65f6\uff0c\u4f7f\u7528\u5757\u7c7b\u578b\u68c0\u6d4b\u903b\u8f91\u4ece\u4e32\u5e76\u8f6c\u6362\u5668\u4e2d\u53d6\u51fa\u989d\u5916\u7684\u4e24\u4f4d\uff0c\u4ee5\u786e\u4fdd\u53ea\u6709 8 \u4f4d\u6570\u636e\u5b57\u8282\u88ab\u4f20\u9012\u5230\u5f39\u6027\u7f13\u51b2\u533a\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c8.0 GT/s \u6570\u636e\u901f\u7387\u7684\u5185\u90e8\u65f6\u949f\u5b9e\u9645\u4e0a\u662f 8.0 GHz/8.125 = 0.985GHz\u3002\u8fd9\u5bfc\u81f4\u6bd4\u901a\u5e38\u7528\u6765\u63cf\u8ff0 Gen3 \u5e26\u5bbd\u7684 1.0GB/s \u6570\u636e\u901f\u7387\u7565\u4f4e\uff0c\u4f46\u5dee\u5f02\u5f88\u5c0f\uff08\u6bd4 1GB/s \u4f4e 1.5%\uff09\uff0c\u6240\u4ee5\u901a\u5e38\u4e0d\u88ab\u63d0\u53ca\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12422","title":"12.4.2.2 \u4e32\u5e76\u8f6c\u6362\u5668","text":"<p>\u5982\u7b2c 437 \u9875\u56fe 12-19 \u6240\u793a\uff0c\u901a\u8fc7\u6062\u590d\u7684 RX \u65f6\u949f\u5c06\u4f20\u5165\u7684\u6570\u636e\u91c7\u6837\u5230\u6bcf\u4e2a\u901a\u9053\u7684\u4e32\u884c-\u5e76\u884c\u8f6c\u6362\u5668\u4e2d\u30028 \u4f4d\u7b26\u53f7\u88ab\u53d1\u9001\u5230\u5f39\u6027\u7f13\u51b2\u5668\uff0c\u5e76\u7531 RX \u65f6\u949f\u7684\u53e6\u4e00\u4e2a\u5206\u9891\u65f6\u949f\u9501\u5b58\u8fdb\u5f39\u6027\u7f13\u51b2\u5668\uff0c\u8be5\u65f6\u949f\u5df2\u7ecf\u662f RX \u65f6\u949f\u7684 8.125 \u5206\u9891\uff0c\u4ee5\u9002\u5e94 130 \u6bd4\u7279\u5757\u4e2d\u7684 16 \u5b57\u8282\u6570\u636e\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12423","title":"12.4.2.3 \u5b9e\u73b0\u5757\u5bf9\u9f50","text":"<p>\u8bad\u7ec3\u671f\u95f4\u53d1\u9001\u7684 EIEOS \u7528\u4e8e\u8bc6\u522b 130 \u4f4d\u5757\u7684\u8fb9\u754c\u3002\u5982\u7b2c 438 \u9875\u56fe 12-20 \u6240\u793a\uff0c\u8fd9\u4e2a\u6709\u5e8f\u96c6\u53ef\u4ee5\u5728\u6bd4\u7279\u6d41\u4e2d\u88ab\u8bc6\u522b\u51fa\u6765\uff0c\u56e0\u4e3a\u5b83\u662f\u7531 00h \u548c FFh \u7684\u5b57\u8282\u4ea4\u66ff\u51fa\u73b0\u7684\u6570\u636e\u6a21\u5f0f\u7ec4\u6210\u3002\u5f53\u8bc6\u522b\u8fd9\u79cd\u6570\u636e\u6a21\u5f0f\u65f6\uff0cEIEOS \u7684\u6700\u540e\u4e00\u4e2a\u7b26\u53f7\u88ab\u8ba4\u5b9a\u4e3a\u5757\u7684\u8fb9\u754c\uff0c\u901a\u8fc7\u6d4b\u8bd5\u63a5\u4e0b\u6765\u7684 130 \u6bd4\u7279\u6570\u636e\u6d41\uff0c\u5c06\u663e\u793a\u5f53\u524d\u63d0\u53d6\u7684\u8fb9\u754c\u662f\u5426\u6b63\u786e\u3002\u5982\u679c\u4e0d\u6b63\u786e\uff0c\u903b\u8f91\u5c31\u7ee7\u7eed\u641c\u7d22 EIEOS \u7684\u7279\u5b9a\u6570\u636e\u6a21\u5f0f\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u5728\u89c4\u8303\u4e2d\u88ab\u63cf\u8ff0\u4e3a\u4e09\u4e2a\u9636\u6bb5\uff1a\u672a\u5bf9\u9f50\u3001\u5bf9\u9f50\u548c\u9501\u5b9a\u3002</p> <p>**\u672a\u5bf9\u9f50\u9636\u6bb5\u3002**\u63a5\u6536\u7aef\u5728\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u7535\u6c14\u7a7a\u95f2\u540e\u8fdb\u5165\u8fd9\u4e2a\u9636\u6bb5\uff0c\u4f8b\u5982\u6539\u53d8\u901f\u7387\u81f3 8.0GT/s \u6216\u4ece\u4f4e\u529f\u7387\u94fe\u8def\u72b6\u6001\u9000\u51fa\u65f6\u3002\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u5757\u5bf9\u9f50\u903b\u8f91\u89c2\u5bdf EIEOS \u7684\u5230\u6765\uff0c\u56e0\u4e3a\u4ea4\u66ff\u5b57\u8282\u7684\u7ed3\u5c3e\u5fc5\u987b\u4e0e\u5757\u7684\u7ed3\u5c3e\u76f8\u5bf9\u5e94\u3002\u5f53\u770b\u5230 EIEOS \u65f6\uff0c\u8c03\u6574\u5757\u8fb9\u754c\u4ee5\u5bf9\u9f50\uff0c\u5757\u5bf9\u9f50\u72b6\u6001\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\uff1a\u5bf9\u9f50\u9636\u6bb5\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u63a5\u6536\u7aef\u8fd8\u5fc5\u987b\u5728\u63a5\u6536\u5230 SOS \u540e\uff0c\u6839\u636e SOS \u7684\u5185\u5bb9\uff0c\u8c03\u6574\u5757\u5bf9\u9f50\u7684\u8fb9\u754c\u3002</p> <p>**\u5bf9\u9f50\u9636\u6bb5\u3002**\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u63a5\u6536\u7aef\u7ee7\u7eed\u76d1\u6d4b EIEOS\uff0c\u5e76\u5728\u770b\u5230 EIEOS \u65f6\u5bf9\u5176\u4f4d\u548c\u5757\u5bf9\u9f50\u8fb9\u754c\u8fdb\u884c\u4efb\u4f55\u5fc5\u8981\u7684\u8c03\u6574\u3002\u7136\u800c\uff0c\u7531\u4e8e\u4ed6\u4eec\u5df2\u7ecf\u521d\u6b65\u786e\u5b9a\u4e86\u5757\u8fb9\u754c\uff0c\u4ed6\u4eec\u73b0\u5728\u4e5f\u53ef\u4ee5\u641c\u7d22 SDS\uff08\u6570\u636e\u6d41\u7684\u5f00\u59cb\uff09\u6709\u5e8f\u96c6\uff0c\u4f5c\u4e3a\u6570\u636e\u6d41\u7684\u5f00\u7aef\u3002\u5f53\u770b\u5230 SDS \u65f6\uff0c\u63a5\u6536\u7aef\u5c31\u8fdb\u5165\u4e86\u9501\u5b9a\u9636\u6bb5\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u5b83\u8fd8\u5fc5\u987b\u7ee7\u7eed\u5728 SOS \u5230\u6765\u65f6\uff0c\u8c03\u6574\u5176\u5757\u5bf9\u9f50\u8fb9\u754c\u3002\u5982\u679c\u68c0\u6d4b\u5230\u672a\u5b9a\u4e49\u7684\u540c\u6b65\u5934\uff08\u503c\u4e3a 00b \u6216 11b\uff09\uff0c\u63a5\u6536\u7aef\u5c06\u88ab\u5141\u8bb8\u8fd4\u56de\u5230\u672a\u5bf9\u9f50\u9636\u6bb5\u3002\u89c4\u8303\u6307\u51fa\uff0c\u8fd9\u5c06\u5728\u94fe\u8def\u8bad\u7ec3\u671f\u95f4\u53d1\u751f\uff0c\u5f53 EIEOS \u540e\u9762\u662f\u4e00\u4e2a\u8bad\u7ec3\u6709\u5e8f\u96c6\u65f6\uff08TS1/TS2\uff09\u3002</p> <p>**\u9501\u5b9a\u9636\u6bb5\u3002**\u4e00\u65e6\u63a5\u6536\u7aef\u8fbe\u5230\u8fd9\u4e2a\u9636\u6bb5\uff0c\u5b83\u5c31\u4e0d\u518d\u8c03\u6574\u5176\u5757\u5bf9\u9f50 \u8fb9\u754c\u3002\u76f8\u53cd\uff0c\u5b83\u73b0\u5728\u671f\u671b\u5728 SDS \u4e4b\u540e\u770b\u5230\u4e00\u4e2a\u6570\u636e\u5757\uff0c\u5982\u679c\u6b64\u65f6\u53d1\u73b0\u5fc5\u987b\u91cd\u65b0\u8c03\u6574\u5bf9\u9f50\uff0c\u4e00\u4e9b\u672a\u5bf9\u9f50\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u4e22\u5931\u3002\u5982\u679c\u68c0\u6d4b\u5230\u672a\u5b9a\u4e49\u7684\u540c\u6b65\u5934\uff0c\u5219\u63a5\u6536\u7aef\u5c06\u88ab\u5141\u8bb8\u8fd4\u56de\u5230\u672a\u5bf9\u9f50\u9636\u6bb5\u3002\u4e00\u65e6\u6570\u636e\u6d41\u5904\u7406\u505c\u6b62\uff0c\u63a5\u6536\u7aef\u53ef\u4ee5\u88ab\u6307\u793a\u4ece\u9501\u5b9a\u9636\u6bb5\u8f6c\u6362\u5230\u5176\u4ed6\u9636\u6bb5\u4e4b\u4e00\uff08\u5173\u4e8e\u6570\u636e\u6d41\u7684\u89c4\u5219\uff0c\u8bf7\u53c2\u89c1\u7b2c 413 \u9875 \u201c\u6570\u636e\u6d41\u548c\u6570\u636e\u5757\u201d\uff09\u3002</p> <p>**\u7279\u6b8a\u60c5\u51b5\uff1a\u73af\u56de\u3002**\u5728\u8ba8\u8bba\u5757\u5bf9\u9f50\u65f6\uff0c\u89c4\u8303\u63cf\u8ff0\u4e86\u5f53\u94fe\u8def\u5904\u4e8e\u73af\u56de\u6a21\u5f0f\u65f6\u7684\u60c5\u51b5\u3002\u73af\u56de\u4e3b\u673a\uff08Loopback Master\uff09\u5fc5\u987b\u80fd\u591f\u5728\u73af\u56de\u671f\u95f4\u8c03\u6574\u5bf9\u9f50\uff0c\u5e76\u5141\u8bb8\u53d1\u9001 EIEOS\uff0c\u5e76\u5728 Loopback.Active \u72b6\u6001\u671f\u95f4\uff0c\u56de\u4f20\u68c0\u6d4b\u5230\u7684 EIEOS \uff0c\u5728\u5176\u57fa\u7840\u4e0a\u8c03\u6574\u5176\u63a5\u6536\u7aef\u3002\u73af\u56de\u4ece\u673a\uff08Loopback Slave\uff09\u5fc5\u987b\u80fd\u591f\u5728 Loopback.Entry \u72b6\u6001\u671f\u95f4\u8c03\u6574\u5bf9\u9f50\uff0c\u4f46\u4e0d\u80fd\u5728 Loopback.Active \u72b6\u6001\u671f\u95f4\u8c03\u6574\u5bf9\u9f50\u3002\u5f53\u4ece\u673a\u5f00\u59cb\u56de\u73af\u6bd4\u7279\u6d41\u65f6\uff0c\u4ece\u673a\u7684\u63a5\u6536\u7aef\u88ab\u8ba4\u4e3a\u5904\u4e8e\u9501\u5b9a\u9636\u6bb5\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12424","title":"12.4.2.4 \u533a\u5757\u7c7b\u578b\u68c0\u6d4b","text":"<p>\u4e00\u65e6\u5b9e\u73b0\u4e86\u5757\u5bf9\u9f50\uff0c\u63a5\u6536\u7aef\u5c31\u53ef\u4ee5\u8bc6\u522b\u8fdb\u5165\u7684\u5757\u7684\u8d77\u59cb\u65f6\u523b\uff0c\u5e76\u68c0\u67e5\u524d\u4e24\u4f4d\uff0c\u4ee5\u786e\u5b9a\u5f53\u524d\u5757\u5c5e\u4e8e\u4e24\u79cd\u53ef\u80fd\u7684\u7c7b\u578b\u4e2d\u7684\u54ea\u4e00\u79cd\u3002\u6709\u5e8f\u96c6\u5757\u53ea\u5bf9\u7269\u7406\u5c42\u6709\u610f\u4e49\uff0c\u6240\u4ee5\u5b83\u4eec\u4e0d\u4f1a\u88ab\u8f6c\u53d1\u5230\u66f4\u9ad8\u7684\u5c42\uff0c\u4f46\u6570\u636e\u5757\u4f1a\u88ab\u8f6c\u53d1\u3002\u5f53\u68c0\u6d4b\u5230\u540c\u6b65\u5934\u65f6\uff0c\u5757\u7c7b\u578b\u4fe1\u606f\u88ab\u4f20\u9012\u7ed9\u7269\u7406\u5c42\u7684\u5176\u4ed6\u90e8\u5206\uff0c\u4ee5\u786e\u5b9a\u662f\u5426\u5e94\u4ece\u8f6c\u53d1\u7ed9\u66f4\u9ad8\u5c42\u7684\u5b57\u8282\u6d41\u4e2d\u5220\u9664\u5f53\u524d\u5757\u3002\u65f6\u949f\u6062\u590d\u673a\u5236\u548c\u540c\u6b65\u5934\u68c0\u6d4b\u6709\u6548\u5730\u5b8c\u6210\u4e86\u5fc5\u987b\u5728\u7269\u7406\u5c42\u8fdb\u884c\u7684\uff0c\u4ece 130 \u4f4d\u5230 128 \u4f4d\u7684\u8f6c\u6362\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c\u7531\u4e8e\u6bcf\u4e2a\u901a\u9053\u7684\u5757\u4fe1\u606f\u662f\u76f8\u540c\u7684\uff0c\u8fd9\u4e2a\u903b\u8f91\u53ea\u9700\u8981\u5728\u5176\u4e2d\u4e00\u4e2a\u901a\u9053\u4e2d\u5b9e\u73b0\uff0c\u4f8b\u5982\u7b2c 436 \u9875\u56fe 12-18 \u4e2d\u6240\u793a\u7684\u901a\u9053 0\u3002\u4f46\u662f\uff0c\u5982\u679c\u652f\u6301\u4e0d\u540c\u7684\u94fe\u8def\u5bbd\u5ea6\u548c\u901a\u9053\u53cd\u8f6c\u7279\u6027\uff0c\u90a3\u4e48\u66f4\u591a\u7684\u901a\u9053\u5c06\u9700\u8981\u5305\u542b\u8be5\u903b\u8f91\uff0c\u4ee5\u786e\u4fdd\u6d3b\u52a8\u7684\u901a\u9053\u59cb\u7ec8\u6709\u8be5\u903b\u8f91\u53ef\u7528\u3002\u4f8b\u5982\uff0c\u80fd\u591f\u4f5c\u4e3a\u901a\u9053 0 \u8fd0\u884c\u7684\u6bcf\u6761\u901a\u9053\u90fd\u9700\u8981\u5b9e\u73b0\u8be5\u903b\u8f91\uff0c\u4f46\u53ea\u6709\u5f53\u524d\u4f5c\u4e3a\u901a\u9053 0 \u7684\u901a\u9053\u9700\u8981\u4f7f\u7528\u5b83\u3002\u8fd8\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e\u89c4\u8303\u6ca1\u6709\u7ed9\u51fa\u8fd9\u65b9\u9762\u7684\u7ec6\u8282\uff0c\u8fd9\u91cc\u8ba8\u8bba\u548c\u8bf4\u660e\u7684\u793a\u4f8b\u53ea\u662f\u5bf9\u53ef\u884c\u5b9e\u73b0\u7684\u731c\u6d4b\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1243","title":"12.4.3 \u63a5\u6536\u7aef\u65f6\u949f\u8865\u507f\u903b\u8f91","text":""},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12431","title":"12.4.3.1 \u80cc\u666f","text":"<p>PCIe 8.0 GT/s \u7684\u65f6\u949f\u8981\u6c42\u4e0e\u65e9\u671f\u89c4\u8303\u7248\u672c\u76f8\u540c\uff1a\u4e24\u4e2a\u94fe\u8def\u4f19\u4f34\u7684\u65f6\u949f\u9891\u7387\u5fc5\u987b\u5728\u4e2d\u5fc3\u9891\u7387\u7684\u00b1300 ppm\uff08\u767e\u4e07\u5206\u4e4b\u4e00\uff09\u8303\u56f4\u5185\uff0c\u8fd9\u5bfc\u81f4\uff08\u5728\u6700\u574f\u7684\u60c5\u51b5\u4e0b\uff09\u6bcf 1666 \u4e2a\u65f6\u949f\u5c31\u4f1a\u83b7\u5f97\u6216\u5931\u53bb\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12432","title":"12.4.3.2 \u5f39\u6027\u7f13\u51b2\u533a\u7684\u4f5c\u7528","text":"<p>\u5982\u7b2c 441 \u9875\u56fe 12-21 \u6240\u793a\uff0c\u4f7f\u7528\u6062\u590d\u7684\u65f6\u949f\u5c06\u63a5\u6536\u5230\u7684\u7b26\u53f7\u91c7\u6837\u5230\u5f39\u6027\u7f13\u51b2\u5668\u4e2d\uff0c\u5e76\u4f7f\u7528\u63a5\u6536\u7aef\u7684\u672c\u5730\u65f6\u949f\u6253\u62cd\u8f93\u51fa\u3002\u5f39\u6027\u7f13\u51b2\u5668\u548c\u65e9\u5148\u534f\u8bae\u7248\u672c\u4e00\u6837\uff0c\u901a\u8fc7\u6dfb\u52a0\u6216\u5220\u9664 SKP \u7b26\u53f7\u6765\u8865\u507f\u9891\u7387\u5dee\uff0c\u4f46\u73b0\u5728\u5b83\u4e00\u6b21\u6dfb\u52a0\u56db\u4e2a\u7b26\u53f7\uff0c\u800c\u4e0d\u662f\u4e00\u6b21\u4ec5\u6dfb\u52a0\u4e00\u4e2a\u7b26\u53f7\u3002\u5f53 SKP \u6709\u5e8f\u96c6\u5230\u8fbe\u65f6\uff0c\u76d1\u63a7\u7f13\u51b2\u5668\u72b6\u6001\u7684\u63a7\u5236\u903b\u8f91\u4f1a\u8fdb\u884c\u8bc4\u4f30\u3002\u5982\u679c\u672c\u5730\u65f6\u949f\u8fd0\u884c\u901f\u5ea6\u8f83\u5feb\uff0c\u7f13\u51b2\u533a\u5c06\u63a5\u8fd1\u4e0b\u6ea2\u72b6\u6001\uff0c\u903b\u8f91\u53ef\u4ee5\u901a\u8fc7\u5728 SOS \u5230\u8fbe\u65f6\u8ffd\u52a0\u56db\u4e2a\u989d\u5916\u7684 SKP \u6765\u8865\u507f\uff0c\u4ee5\u5feb\u901f\u91cd\u65b0\u586b\u5145\u7f13\u51b2\u533a\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u6062\u590d\u7684\u65f6\u949f\u8fd0\u884c\u5f97\u66f4\u5feb\uff0c\u7f13\u51b2\u533a\u5c06\u63a5\u8fd1\u6ea2\u51fa\u72b6\u6001\uff0c\u903b\u8f91\u5c06\u901a\u8fc7\u5220\u9664\u56db\u4e2a SKP \u6765\u8865\u507f\u6ea2\u51fa\u60c5\u51b5\uff0c\u4ee5\u4fbf\u5728\u770b\u5230 SOS \u65f6\u5feb\u901f\u6392\u7a7a\u7f13\u51b2\u533a\u3002</p> <p></p> <p>\u56fe 12-21 Gen3 \u5f39\u6027\u7f13\u5b58\u903b\u8f91</p> <p>Gen3 \u53d1\u9001\u7aef\u6bcf 370 \u81f3 375 \u4e2a\u5757\u5b89\u6392\u4e00\u6b21 SOS\uff0c\u4f46\u548c\u65e9\u5148\u534f\u8bae\u7248\u672c\u4e00\u6837\uff0c\u53ea\u80fd\u5728\u5757\u8fb9\u754c\u53d1\u9001 SOS\u3002\u5982\u679c\u5728\u5b89\u6392 SOS \u65f6\uff0c\u6709\u4e00\u4e2a\u6570\u636e\u5305\u6b63\u5728\u4f20\u8f93\uff0c\u5b83\u4eec\u4f1a\u88ab\u7d2f\u79ef\u5e76\u5728\u4e0b\u4e00\u4e2a\u6570\u636e\u5305\u8fb9\u754c\u63d2\u5165\u3002\u7136\u800c\uff0c\u4e0e\u8f83\u4f4e\u7684\u6570\u636e\u901f\u7387\u534f\u8bae\u7248\u672c\u4e0d\u540c\u7684\u662f\uff0c\u5728 8.0GT/s \u4e0b\u4e0d\u5141\u8bb8\u6709\u4e24\u4e2a\u8fde\u7eed\u7684 SOS\u3002\u5b83\u4eec\u5fc5\u987b\u7531\u7528\u6570\u636e\u5757\u9694\u5f00\u3002\u63a5\u6536\u7aef\u5fc5\u987b\u80fd\u591f\u5bb9\u5fcd\u7531\u8bbe\u5907\u652f\u6301\u7684\u6700\u5927\u6570\u636e\u5305\u6709\u6548\u8f7d\u8377\u5927\u5c0f\u5206\u9694\u7684 SOS\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u4ec5\u4ee5 4 \u4e2a\u7b26\u53f7\u4e3a\u589e\u91cf\u8fdb\u884c\u8c03\u6574\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u5230\u5f39\u6027\u7f13\u51b2\u533a\u7684\u6df1\u5ea6\u9700\u6c42\uff0c\u56e0\u4e3a\u9700\u8981\u770b\u5230\u4e24\u4e2a\u65f6\u949f\u4e4b\u95f4\u5dee\u503c\u5927\u4e8e 4\uff0c\u624d\u4f1a\u5e94\u7528\u8865\u507f\uff0c\u800c\u4e00\u4e2a\u5927\u7684\u6570\u636e\u5305\u53ef\u80fd\u6b63\u5728\u8fdb\u884c\u4f20\u8f93\uff0c\u5360\u7528\u4e86\u672c\u6765\u662f\u9002\u5f53\u8fdb\u884c\u8865\u507f\u7684\u65f6\u95f4\u3002\u7531\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0c\u9700\u8981\u8c28\u614e\u786e\u5b9a\u8fd9\u4e2a\u7f13\u51b2\u533a\u7684\u6700\u4f73\u5c3a\u5bf8\u3002\u6240\u4ee5\uff0c\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u4f8b\u5b50\u3002\u5728\u6bcf\u5757 16 \u4e2a\u7b26\u53f7\u7684\u60c5\u51b5\u4e0b\uff0c375 \u5757\u7684 SOS \u4e4b\u95f4\u5141\u8bb8\u7684\u65f6\u95f4\u7b49\u4e8e 6000 \u4e2a\u7b26\u53f7\u65f6\u95f4\u3002\u5c06\u5176\u9664\u4ee5\u6700\u574f\u60c5\u51b5\u4e0b\u83b7\u5f97\u6216\u5931\u53bb\u4e00\u4e2a\u65f6\u949f\u7684\u65f6\u95f4 1666\uff0c\u610f\u5473\u7740\u5728\u6b64\u671f\u95f4\u6700\u591a\u53ef\u4ee5\u83b7\u5f97\u6216\u5931\u53bb 3.6 \u4e2a\u65f6\u949f\u3002\u5982\u679c\u4e00\u4e2a\u957f\u5ea6\u6700\u5927\u7684 TLP\uff084KB\uff09\u4f20\u8f93\u6b63\u597d\u662f\u5728\u4e0b\u4e00\u4e2a SOS \u53d1\u9001\u4e4b\u524d\u5f00\u59cb\u7684\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a x1 \u94fe\u8def\u6765\u8bf4\uff0c\u5b83\u7684\u6574\u4f53\u5ef6\u8fdf\u5927\u7ea6\u662f 6000+4096=10096 \u7b26\u53f7\u65f6\u95f4\uff0c\u8fd9\u610f\u5473\u7740\u5c06\u83b7\u5f97\u6216\u5931\u53bb 10096/1666=6.06 \u65f6\u949f\u3002\u56e0\u6b64\uff0c\u5982\u679c\u652f\u6301 4KB \u5927\u5c0f\u7684 TLP\uff0c\u7f13\u51b2\u5668\u53ef\u80fd\u88ab\u8bbe\u8ba1\u6210\u5728\u4fdd\u8bc1 SOS \u5230\u8fbe\u4e4b\u524d\uff0c\u80fd\u591f\u5904\u7406 7 \u4e2a\u8fc7\u591a\u6216\u8fc7\u5c11\u7684\u7b26\u53f7\u3002\u53ef\u80fd\u53d1\u751f\u7684\u60c5\u51b5\u662f\uff0c\u5728\u7b2c\u4e00\u4e2a SOS \u88ab\u53d1\u9001\u4e4b\u524d\uff0c\u5df2\u7ecf\u5b89\u6392\u4e86\u4e24\u4e2a SOS\u3002\u5728\u8f83\u4f4e\u7684\u6570\u636e\u901f\u7387\u4e0b\uff0c\u6392\u961f\u7684 SOS \u662f\u80cc\u5bf9\u80cc\u53d1\u9001\u7684\uff0c\u4f46\u5bf9\u4e8e 8.0GT/s \u6765\u8bf4\uff0c\u5b83\u4eec\u4e0d\u4f1a\u88ab\u8fde\u7eed\u53d1\u9001\uff0c\u5fc5\u987b\u7528\u4e00\u4e2a\u6570\u636e\u5757\u9694\u5f00\u3002\u6bcf\u5f53 SOS \u5230\u8fbe\u63a5\u6536\u7aef\u65f6\uff0c\u5b83\u53ef\u4ee5\u6dfb\u52a0\u6216\u5220\u9664 4 \u4e2a SKP \u7b26\u53f7\uff0c\u4ee5\u5feb\u901f\u586b\u5145\u6216\u8017\u5c3d\u7f13\u51b2\u533a\uff0c\u907f\u514d\u51fa\u73b0\u95ee\u9898\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1244","title":"12.4.4 \u901a\u9053\u4e0e\u901a\u9053\u4e4b\u95f4\u7684\u504f\u659c","text":""},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12441","title":"12.4.4.1 \u901a\u9053\u95f4\u7684\u98de\u884c\u65f6\u95f4\u5dee\u5f02","text":"<p>\u5bf9\u4e8e\u591a\u901a\u9053\u94fe\u8def\uff0c\u901a\u9053\u4e4b\u95f4\u6570\u636e\u7684\u5230\u8fbe\u65f6\u95f4\u5dee\u5f02\uff0c\u5c06\u5728\u63a5\u6536\u7aef\u88ab\u81ea\u52a8\u7ea0\u6b63\uff0c\u5ef6\u8fdf\u8f83\u65e9\u5230\u8fbe\u7684\u901a\u9053\u4e0a\u7684\u6570\u636e\uff0c\u76f4\u5230\u6700\u665a\u901a\u9053\u4e0a\u7684\u6570\u636e\u5230\u8fbe\uff0c\u4ee5\u4f7f\u6240\u6709\u901a\u9053\u7684\u6570\u636e\u5230\u8fbe\u65f6\u95f4\u76f8\u540c\u3002\u8be5\u89c4\u8303\u5141\u8bb8\u8bbe\u8ba1\u8005\u4ee5\u4ed6\u559c\u6b22\u7684\u4efb\u4f55\u65b9\u5f0f\u6765\u5b9e\u73b0\u53bb\u504f\u659c\u3002\u4f46\u662f\u5982\u679c\u5728\u5f39\u6027\u7f13\u51b2\u5668\u4e4b\u540e\uff0c\u4f7f\u7528\u6570\u5b57\u5ef6\u8fdf\u903b\u8f91\u6765\u5b9e\u73b0\u53bb\u504f\u659c\u6709\u4e00\u4e2a\u597d\u5904\uff0c\u5373\u5230\u8fbe\u65f6\u95f4\u5dee\u5f02\u6b64\u65f6\u5df2\u7ecf\u88ab\u91c7\u6837\u4e3a\u63a5\u6536\u7aef\u7684\u672c\u5730\u7b26\u53f7\u65f6\u949f\u3002\u5982\u679c\u5728\u67d0\u4e2a\u65f6\u949f\u8fb9\u6cbf\uff0c\u4e00\u4e2a\u901a\u9053\u7684\u8f93\u5165\u6570\u636e\u5230\u8fbe\uff0c\u800c\u53e6\u4e00\u4e2a\u901a\u9053\u7684\u8f93\u5165\u6570\u636e\u5219\u6ca1\u6709\uff0c\u90a3\u4e48\u5b83\u4eec\u4e4b\u95f4\u7684\u5dee\u5f02\u5c06\u53ef\u4ee5\u7528\u82e5\u5e72\u4e2a\u65f6\u949f\u5468\u671f\u6765\u8861\u91cf\uff0c\u6240\u4ee5\u65e9\u5230\u7684\u901a\u9053\u53ef\u4ee5\u7b80\u5355\u5730\u5ef6\u8fdf\u9002\u5f53\u6570\u91cf\u7684\u65f6\u949f\u5468\u671f\uff0c\u4f7f\u5176\u4e0e\u665a\u5230\u7684\u901a\u9053\u4fdd\u6301\u4e00\u81f4\uff08\u89c1\u7b2c 444 \u9875\u7684\u56fe 12-22\uff09\u3002\u4e8b\u5b9e\u4e0a\uff0c\u63a5\u6536\u7aef\u7684\u6700\u5927\u5141\u8bb8\u504f\u659c\u91cf\u662f\u4ee5\u65f6\u949f\u5468\u671f\u7684\u500d\u6570\u6765\u8861\u91cf\u7684\uff0c\u91c7\u7528\u8fd9\u4e00\u65b9\u6848\u4f7f\u8861\u91cf\u6700\u5927\u5141\u8bb8\u504f\u659c\u91cf\u6307\u6807\u53d8\u5f97\u5bb9\u6613\uff0c\u5e76\u63a8\u65ad\u51fa\u89c4\u8303\u7f16\u5199\u8005\u53ef\u80fd\u503e\u5411\u4e8e\u8fd9\u79cd\u5b9e\u73b0\u65b9\u5f0f\u3002\u6b63\u5982\u89c4\u8303\u4e2d\u6240\u5b9a\u4e49\u7684\u90a3\u6837\uff0c\u5bf9\u4e8e Gen1\uff085 \u4e2a\u7b26\u53f7\u65f6\u95f4\u7684\u65f6\u949f\uff0c\u6bcf\u4e2a\u7b26\u53f7 4ns\uff09\u548c Gen2\uff084 \u4e2a\u7b26\u53f7\u65f6\u95f4\u7684\u65f6\u949f\uff0c\u6bcf\u4e2a\u7b26\u53f7 2ns\uff09\uff0c\u63a5\u6536\u7aef\u53bb\u504f\u659c\uff08de-skewing\uff09\u80fd\u529b\u5fc5\u987b\u652f\u6301 20ns \u504f\u659c\uff0c Gen3\uff086 \u4e2a\u7b26\u53f7\u65f6\u95f4\u7684\u65f6\u949f\uff0c\u6bcf\u4e2a\u7b26\u53f7 1ns\uff09\u5219\u662f 6ns\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12442","title":"12.4.4.2 \u53bb\u504f\u659c\u7684\u5951\u673a","text":"<p>\u5fc5\u987b\u5728\u6240\u6709\u901a\u9053\u4e0a\u540c\u65f6\u770b\u5230\u76f8\u540c\u7684\u7b26\u53f7\u624d\u80fd\u6267\u884c\u53bb\u504f\u659c\uff0c\u4efb\u4f55\u6709\u5e8f\u96c6\u90fd\u53ef\u4ee5\u3002\u7136\u800c\uff0c\u53bb\u504f\u659c\u53ea\u5728 L0s\u3001\u6062\u590d\uff08Recovery\uff09\u548c\u914d\u7f6e\uff08Configuration\uff09LTSSM \u72b6\u6001\u4e0b\u6267\u884c\u3002\u7279\u522b\u662f\uff0c\u5b83\u5fc5\u987b\u662f\u4ee5\u4e0b\u72b6\u6001\u8f6c\u79fb\u7684\u5fc5\u8981\u6761\u4ef6\uff1a</p> <p>\u2022 \u79bb\u5f00 Configuration.Complete</p> <p>\u2022 \u79bb\u5f00 Configuration.Idle \u6216 Recovery.Idle \u540e\u5f00\u59cb\u5904\u7406\u6570\u636e\u6d41</p> <p>\u2022 \u79bb\u5f00 Recovery .RcvrCfg</p> <p>\u2022 \u79bb\u5f00 RX_L0s.FTS</p> <p>\u5982\u679c\u504f\u659c\u503c\u5728 L0 \u72b6\u6001\u4e0b\u53d1\u751f\u53d8\u5316\uff08\u4f8b\u5982\uff0c\u57fa\u4e8e\u6e29\u5ea6\u6216\u7535\u538b\u53d8\u5316\uff09\uff0c\u5219\u53ef\u80fd\u4f1a\u53d1\u751f\u63a5\u6536\u7aef\u9519\u8bef\u5e76\u5bfc\u81f4\u91cd\u653e TLP\u3002\u5982\u679c\u95ee\u9898\u6301\u7eed\u5b58\u5728\uff0c\u94fe\u8def\u6700\u7ec8\u5c06\u8f6c\u6362\u5230\u6062\u590d\u72b6\u6001\uff0c\u5e76\u5728\u90a3\u91cc\u8fdb\u884c\u53bb\u504f\u659c\u5904\u7406\u3002\u89c4\u8303\u6307\u51fa\uff0c\u867d\u7136\u8bbe\u5907\u5728 L0 \u72b6\u6001\u4e0b\u4e0d\u5141\u8bb8\u5bf9\u5176\u94fe\u8def\u8fdb\u884c\u53bb\u504f\u659c\uff0c\u4f46\u5728\u6b64\u72b6\u6001\u4e0b\u5fc5\u987b\u5b9a\u671f\u53d1\u9001\u7684 SOS \u5305\u542b LFSR \u503c\uff0c\u76ee\u7684\u662f\u5e2e\u52a9\u5916\u90e8\u5de5\u5177\u5b8c\u6210\u8fd9\u4e00\u5de5\u4f5c\u3002\u8fd9\u4e9b\u5de5\u5177\u4e0d\u53d7\u6570\u636e\u6d41\u89c4\u5219\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u641c\u7d22 SOS\uff0c\u5e76\u4f7f\u7528\u5176\u6570\u636e\u6a21\u5f0f\u6765\u5b9e\u73b0\u6570\u636e\u6d41\u4e2d\u7684\u4f4d\u9501\u5b9a\u3001\u5757\u5bf9\u9f50\u548c\u901a\u9053\u95f4\u7684\u53bb\u504f\u659c\u3002</p> <p>\u89c4\u8303\u6307\u51fa\uff0c\u5f53\u79bb\u5f00 L0s \u65f6\uff0c\u53d1\u9001\u7aef\u5c06\u53d1\u9001\u4e00\u4e2a EIEOS\uff0c\u7136\u540e\u662f\u6b63\u786e\u6570\u91cf\u7684 FTS\uff0c\u5e76\u5728\u6bcf 32 \u4e2a FTS \u540e\u63d2\u5165\u53e6\u4e00\u4e2a EIEOS\uff0c\u7136\u540e\u662f\u6700\u540e\u4e00\u4e2a EIEOS\uff0c\u4ee5\u534f\u52a9\u5757\u5bf9\u9f50\uff0c\u6700\u540e\u662f\u4e00\u4e2a SDS \u6709\u5e8f\u96c6\uff0c\u76ee\u7684\u662f\u542f\u52a8\u6570\u636e\u6d41\u5916\uff0c\u4ee5\u53ca\u7528\u4e8e\u53bb\u504f\u659c\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#14443","title":"14.4.4.3 \u63a5\u6536\u7aef\u901a\u9053\u95f4\u7684\u53bb\u504f\u659c\u80fd\u529b","text":"<p>\u53ef\u4ee5\u7406\u89e3\u7684\u662f\uff0c\u53d1\u9001\u7aef\u53ea\u5141\u8bb8\u5f15\u5165\u6700\u5c0f\u7684\u504f\u659c\u91cf\uff0c\u4ee5\u4fbf\u5c06\u5269\u4f59\u7684\u504f\u659c\u9884\u7b97\u7528\u4e8e\u8986\u76d6\u8d70\u7ebf\u5dee\u5f02\u548c\u5176\u4ed6\u53d8\u5316\u3002\u63a5\u6536\u7aef\u53ef\u6821\u6b63\u7684\u5141\u8bb8\u504f\u5dee\u91cf\u5982\u7b2c 443 \u9875\u7684\u8868 12-5 \u6240\u793a\uff0c\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u79cd\u504f\u5dee\u5f88\u5bb9\u6613\u4e0e Gen3 \u7684\u7b26\u53f7\u6b21\u6570\u76f8\u5bf9\u5e94\uff0c\u5c31\u50cf\u65e9\u671f\u6570\u636e\u901f\u7387\u4e00\u6837\u3002\u8fd9\u4f7f\u5f97\u53ef\u4ee5\u9009\u62e9\u5728\u5f39\u6027\u7f13\u51b2\u5668\u4e4b\u540e\u4f7f\u7528\u5ef6\u8fdf\u5bc4\u5b58\u5668\u6765\u5b8c\u6210\u53bb\u504f\u659c\uff0c\u4e0e\u5148\u524d\u7ae0\u8282\u4e2d\u7684 Gen1/Gen2 \u7269\u7406\u5c42\u5b9e\u73b0\u4e00\u81f4\u3002</p> <p>\u8868 12-5 \u4fe1\u53f7\u504f\u659c\u53c2\u6570</p> <p></p> <p>\u5f53\u4f7f\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u4e00\u79cd\u660e\u786e\u7684\u53bb\u504f\u659c\u673a\u5236\u662f\u76d1\u89c6 COM \u63a7\u5236\u5b57\u7b26\uff0c\u5b83\u5fc5\u987b\u540c\u65f6\u51fa\u73b0\u5728\u6240\u6709\u901a\u9053\u4e0a\u3002128b/130b \u6ca1\u6709\u8fd9\u4e2a\u9009\u9879\uff0c\u4f46\u6709\u5e8f\u96c6\u4ecd\u7136\u9700\u8981\u540c\u65f6\u51fa\u73b0\u5728\u6240\u6709\u901a\u9053\u4e0a\uff0c\u5982 SOS\u3001SDS \u548c EIEOS\u3002\u56e0\u6b64\uff0c\u5c3d\u7ba1\u5728\u5bf9\u901a\u9053\u8fdb\u884c\u53bb\u504f\u659c\u65f6\u8981\u5bfb\u627e\u7684\u6570\u636e\u56fe\u6837\u4e0d\u540c\uff0c\u4f46\u8fc7\u7a0b\u53ef\u4ee5\u662f\u76f8\u540c\u7684\u3002</p> <p></p> <p>\u56fe 12-22 \u63a5\u6536\u7aef\u53bb\u504f\u659c\u903b\u8f91</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1245","title":"12.4.5 \u89e3\u6270\u5668","text":""},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12451","title":"12.4.5.1 \u7efc\u8ff0","text":"<p>\u63a5\u6536\u7aef\u9075\u5faa\u4e0e\u53d1\u9001\u7aef\u5b8c\u5168\u76f8\u540c\u7684\u52a0\u6270\u591a\u9879\u5f0f\u751f\u6210\u89c4\u5219\uff0c\u5e76\u7b80\u5355\u5730\u5c06\u76f8\u540c\u7684\u503c\u518d\u6b21\u4e0e\u8f93\u5165\u6570\u636e\u8fdb\u884c XOR \u4ee5\u6062\u590d\u539f\u59cb\u4fe1\u606f\u3002\u4e0e\u53d1\u9001\u7aef\u4e00\u6837\uff0c\u4ed6\u4eec\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u901a\u9053\u5b9e\u73b0\u4e00\u4e2a\u5355\u72ec\u7684 LFSR\uff0c\u6216\u8005\u53ea\u5b9e\u73b0\u4e00\u4e2a\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#12452","title":"12.4.5.2 \u7981\u7528\u89e3\u6270","text":"<p>\u4e0e Gen1/Gen2 \u6570\u636e\u901f\u7387\u4e0d\u540c\uff0c\u5728 Gen3 \u6a21\u5f0f\u4e0b\uff0c\u4e0d\u80fd\u7981\u7528\u89e3\u6270\uff0c\u56e0\u4e3a\u5b83\u5728\u4fc3\u8fdb\u65f6\u949f\u6062\u590d\u548c\u4fe1\u53f7\u5b8c\u6574\u6027\u65b9\u9762\u8d77\u7740\u91cd\u8981\u4f5c\u7528\u3002\u5728\u8f83\u4f4e\u7684\u901f\u7387\u4e0b\uff0cTS1 \u548c TS2 \u63a7\u5236\u5b57\u8282\u4e2d\u7684\u201c\u7981\u7528\u52a0\u6270\u201d \u4f4d\u88ab\u7528\u6765\u901a\u77e5\u94fe\u8def\u90bb\u5c45\u52a0\u6270\u7279\u6027\u88ab\u5173\u95ed\u3002\u5728 8.0GT/s \u4ee5\u53ca\u66f4\u9ad8\u7684\u901f\u7387\u8be5\u4f4d\u662f\u4fdd\u7559\u4e0d\u4f7f\u7528\u7684\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1246-byte-un-striping","title":"12.4.6 \u5b57\u8282\u62c6\u5206(Byte Un-Striping)","text":"<p>\u8fd9\u4e2a\u903b\u8f91\u4e0e Gen1 \u6216 Gen2 \u7684\u5b9e\u73b0\u57fa\u672c\u76f8\u540c\u3002\u5728\u67d0\u4e9b\u65f6\u5019\uff0cGen3 \u7684\u5b57\u8282\u6d41\u548c\u8f83\u4f4e\u6570\u636e\u901f\u7387\u7684\u5b57\u8282\u6d41\u5fc5\u987b\u6df7\u5408\u5728\u4e00\u8d77\uff0c\u7b2c 445 \u9875\u56fe 12-23 \u4e2d\u7684\u793a\u4f8b\u663e\u793a\u4e86\u5728\u62c6\u5206\uff08un-striping\uff09\u903b\u8f91\u4e4b\u524d\u53d1\u751f\u7684\u60c5\u51b5\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1247","title":"12.4.7 \u6570\u636e\u5305\u8fc7\u6ee4","text":"<p>\u7531\u5b57\u8282\u62c6\u5206\uff08un-striping\uff09\u903b\u8f91\u63d0\u4f9b\u7684\u4e32\u884c\u5b57\u8282\u6d41\u5305\u542b TLPs\u3001DLLPs\u3001\u903b\u8f91\u7a7a\u95f2\uff08IDLs\uff09\u548c\u6709\u5e8f\u96c6\u3002\u903b\u8f91\u7a7a\u95f2\u5b57\u8282\u548c\u6709\u5e8f\u96c6\u5728\u8fd9\u91cc\u88ab\u6d88\u9664\uff0c\u4e0d\u88ab\u8f6c\u53d1\u5230\u6570\u636e\u94fe\u8def\u5c42\u3002\u5269\u4e0b\u7684\u662f TLPs \u548c DLLPs\uff0c\u5b83\u4eec\u4e0e\u6570\u636e\u5305\u7c7b\u578b\u7684\u6307\u793a\u7b26\u4e00\u8d77\u88ab\u8f6c\u53d1\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#1248-rx-buffer","title":"12.4.8 \u63a5\u6536\u7f13\u51b2\u533a(RX Buffer)","text":"<p>RX \u7f13\u51b2\u533a\u4fdd\u5b58\u6536\u5230\u7684 TLPs \u548c DLLPs\uff0c\u76f4\u5230\u6570\u636e\u94fe\u8def\u5c42\u80fd\u591f\u63a5\u6536\u5b83\u4eec\u3002\u89c4\u8303\u4e2d\u6ca1\u6709\u63cf\u8ff0\u6570\u636e\u94fe\u8def\u5c42\u7684\u63a5\u53e3\uff0c\u56e0\u6b64\u8bbe\u8ba1\u8005\u53ef\u4ee5\u81ea\u7531\u9009\u62e9\u603b\u7ebf\u5bbd\u5ea6\u7b49\u7ec6\u8282\u3002\u901a\u9053\u8d8a\u5bbd\uff0c\u65f6\u949f\u9891\u7387\u5c31\u8d8a\u4f4e\uff0c\u4f46\u9700\u8981\u66f4\u591a\u7684\u4fe1\u53f7\u548c\u903b\u8f91\u6765\u652f\u6301\u5b83\u3002</p>"},{"location":"pcie/12%20%E7%89%A9%E7%90%86%E5%B1%82%E9%80%BB%E8%BE%91%28gen3%29/#125-128b130b-loopback","title":"12.5 \u5173\u4e8e 128b/130b Loopback \u7684\u6ce8\u610f\u4e8b\u9879","text":"<p>\u89c4\u8303\u7279\u522b\u8bf4\u660e\u4e86\u73af\u56de\u6a21\u5f0f\u5728\u66f4\u9ad8\u901f\u7387\u4e0b\u7684\u64cd\u4f5c\u3002\u57fa\u672c\u89c4\u5219\u53ef\u4ee5\u5f52\u7eb3\u5982\u4e0b\uff1a</p> <p>\u2022 \u73af\u56de\u4e3b\u673a\uff08Loopback master\uff09\u5fc5\u987b\u53d1\u9001\u5b9e\u9645\u7684\u6709\u5e8f\u96c6\u6216\u6570\u636e\u5757\uff0c\u4f46\u5728\u4ece\u6570\u636e\u5757\u53d8\u4e3a\u6709\u5e8f\u96c6\u65f6\uff0c\u4ed6\u4eec\u4e0d\u9700\u8981\u9075\u5faa\u6b63\u5e38\u7684\u534f\u8bae\u89c4\u5219\uff0c\u5728\u6709\u5e8f\u96c6\u53d8\u6210\u6570\u636e\u5757\u65f6\u53cd\u4e4b\u4ea6\u7136\u65f6\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cSDS \u6709\u5e8f\u96c6\u548c EDS \u6807\u8bb0\u4e0d\u662f\u5fc5\u9700\u7684\u3002\u4ece\u673a\u5fc5\u987b\u4e0d\u671f\u671b\u6216\u68c0\u67e5\u5b83\u4eec\u7684\u5b58\u5728\u3002</p> <p>\u2022 \u4e3b\u673a\u5fc5\u987b\u50cf\u5f80\u5e38\u4e00\u6837\u53d1\u9001 SOS\uff0c\u5e76\u4e14\u5fc5\u987b\u5141\u8bb8\u73af\u56de\u6d41\u4e2d\u7684 SKP \u7b26\u53f7\u6570\u91cf\u4e0d\u540c\uff0c\u56e0\u4e3a\u63a5\u6536\u7aef\u5c06\u8fdb\u884c\u65f6\u949f\u8865\u507f\u3002</p> <p>\u2022 \u5141\u8bb8\u73af\u56de\u4ece\u673a\u901a\u8fc7\u4e00\u6b21\u6dfb\u52a0\u6216\u5220\u9664 4 \u4e2a SKP \u7b26\u53f7\u6765\u4fee\u6539 SOS\uff0c\u5c31\u50cf\u4ed6\u4eec\u901a\u5e38\u4e3a\u65f6\u949f\u8865\u507f\u6240\u505a\u7684\u90a3\u6837\uff0c\u4f46\u4ea7\u751f\u7684 SOS \u4ecd\u5fc5\u987b\u9075\u5faa\u6b63\u786e\u7684\u683c\u5f0f\u89c4\u5219\u3002</p> <p>\u2022 \u9664\u4e86 SOS \u548c EIEOS \u4e4b\u5916\uff0c\u6240\u6709\u5185\u5bb9\u90fd\u5e94\u8be5\u5b8c\u5168\u6309\u7167\u53d1\u9001\u65f6\u7684\u60c5\u51b5\u73af\u56de\uff0c\u56e0\u4e3a SOS \u53ef\u4ee5\u50cf\u521a\u624d\u63cf\u8ff0\u7684\u90a3\u6837\u53d1\u751f\u53d8\u5316\uff0c\u800c EIEOS \u548c EIOS \u5728\u73af\u56de\u4e2d\u90fd\u6709\u660e\u786e\u7684\u7528\u9014\uff0c\u5e94\u8be5\u907f\u514d\u4f7f\u7528\u3002</p> <p>\u2022 \u5982\u679c\u4ece\u673a\u65e0\u6cd5\u83b7\u53d6\u5757\u5bf9\u9f50\uff0c\u5b83\u5c06\u65e0\u6cd5\u6309\u7167\u6536\u5230\u7684\u6240\u6709\u4f4d\u8fdb\u884c\u73af\u56de\uff0c\u5e76\u5141\u8bb8\u6839\u636e\u9700\u8981\u6dfb\u52a0\u6216\u5220\u9664\u7b26\u53f7\u4ee5\u7ee7\u7eed\u64cd\u4f5c\u3002</p> <p>\u539f\u6587\uff1a Mindshare</p> <p>\u8bd1\u8005\uff1a Brook</p> <p>\u6821\u5bf9: LJGibbs</p> <p>\u6b22\u8fce\u53c2\u4e0e \u300aMindshare PCI Express Technology 3.0 \u4e00\u4e66\u7684\u4e2d\u6587\u7ffb\u8bd1\u8ba1\u5212\u300b</p> <p>Gitee\uff1a</p> <p>https://gitee.com/ljgibbs/chinese-translation-of-pci-express-technology</p> <p>Github\uff1a</p> <p>https://github.com/ljgibbslf/Chinese-Translation-of-PCI-Express-Technology-</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/","title":"Chpater 14 Link Initialization &amp; Training//\u94fe\u8def\u521d\u59cb\u5316\u4e0e\u8bad\u7ec3","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#_1","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u63cf\u8ff0\u4e86\u7269\u7406\u5c42\u4e0e\u94fe\u8def\u4e4b\u95f4\u7684\u7535\u6c14\u63a5\u53e3\uff0c\u5305\u62ec\u5dee\u5206\u53d1\u9001\u7aef\u4e0e\u63a5\u6536\u7aef\u7684\u4e00\u4e9b\u7279\u6027\u7684\u7ec6\u8282\u3002\u540c\u65f6\u4e5f\u8ba8\u8bba\u4e86\u4fe1\u53f7\u5747\u8861\u7684\u9700\u6c42\u4ee5\u53ca\u5747\u8861\u7684\u65b9\u6cd5\u3002\u4e0a\u4e00\u7ae0\u7684\u8ba8\u8bba\u5305\u62ec\u4e86 Gen1, Gen2 \u548c Gen3 \u901f\u7387\u4e0b\u7684\u5dee\u5206\u53d1\u9001\u4e0e\u63a5\u6536\u7aef\u7684\u7279\u6027\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#_2","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8ba8\u8bba\u7269\u7406\u5c42\u94fe\u8def\u8bad\u7ec3\u4e0e\u72b6\u6001\u72b6\u6001\u673a\uff08LTSSM, Link Traning and Status State Machine\uff09\u7684\u884c\u4e3a\uff0c\u5305\u62ec\u4ece\u4e0a\u7535\u6216\u8005\u590d\u4f4d\u5f00\u59cb\uff0c\u5230\u94fe\u8def\u8fdb\u5165\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001\uff08L0\uff09\uff0c\u62a5\u6587\u6d41\u91cf\u5f00\u59cb\u7684\u6574\u4e2a\u521d\u59cb\u5316\u8fc7\u7a0b\u3002\u6b64\u5916\uff0c\u672c\u7ae0\u8fd8\u5c06\u8ba8\u8bba\u94fe\u8def\u7535\u6e90\u72b6\u6001 L0s,L1,L2,L3 \u4ee5\u53ca\u8fd9\u4e9b\u72b6\u6001\u4e4b\u95f4\u7684\u8f6c\u6362\u3002\u672c\u7ae0\u4e5f\u4f1a\u8ba8\u8bba\u94fe\u8def\u6062\u590d\u72b6\u6001\uff08Recovery\uff09\u4e2d\uff0c\u91cd\u65b0\u5b8c\u6210\u4f4d\u9501\u5b9a\uff08Bit Lock\uff09\u3001\u7b26\u53f7\u9501\u5b9a\uff08Symbol Lock\uff09\u6216\u8005\u5757\u9501\u5b9a\uff08Block Lock\uff09\u7684\u8fc7\u7a0b\u3002\u6700\u540e\uff0c\u8fd8\u8ba8\u8bba\u4e86\u7528\u4e8e\u94fe\u8def\u5e26\u5bbd\u7ba1\u7406\u7684\u94fe\u8def\u901f\u7387\u4ee5\u53ca\u4f4d\u5bbd\u8f6c\u6362\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#_3","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u5c06\u8ba8\u8bba PCIe \u7aef\u53e3\u6216\u8005\u94fe\u8def\u4e2d\u5b58\u5728\u7684\u9519\u8bef\u7c7b\u578b\uff0c\u5982\u4f55\u68c0\u6d4b\u3001\u62a5\u544a\u8fd9\u4e9b\u9519\u8bef\uff0c\u4ee5\u53ca\u8fd9\u4e9b\u9519\u8bef\u7684\u5904\u7406\u9009\u9879\u3002\u56e0\u4e3a PCIe \u8bbe\u8ba1\u4e2d\u540e\u5411\u517c\u5bb9\u4e86 PCI \u7684\u9519\u8bef\u62a5\u544a\u673a\u5236\uff0c\u6240\u4ee5\u5c06\u9996\u5148\u4ecb\u7ecd PCI \u7684\u9519\u8bef\u5904\u7406\u673a\u5236\u4f5c\u4e3a\u80cc\u666f\u77e5\u8bc6\u3002\u7136\u540e\u6211\u4eec\u5c06\u5173\u6ce8\u4e8ePCIe \u5bf9\u4e8e\u53ef\u7ea0\u6b63\u3001\u975e\u81f4\u547d\u4ee5\u53ca\u81f4\u547d\u9519\u8bef\u7684\u5904\u7406\u673a\u5236\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#141","title":"14.1 \u603b\u89c8","text":"<p>\u94fe\u8def\u521d\u59cb\u5316\u548c\u8bad\u7ec3\u662f\u7531\u7269\u7406\u5c42\u63a7\u5236\u7684\uff0c\u57fa\u4e8e\u786c\u4ef6 (\u800c\u975e\u8f6f\u4ef6) \u7684\u8fc7\u7a0b\u3002\u8be5\u8fc7\u7a0b\u914d\u7f6e\u548c\u521d\u59cb\u5316\u8bbe\u5907\u7684\u94fe\u8def\u548c\u7aef\u53e3\uff0c\u4f7f\u94fe\u8def\u4e0a\u80fd\u591f\u8fdb\u884c\u6b63\u5e38\u7684\u6570\u636e\u62a5\u6587\u901a\u4fe1\u3002</p> <p></p> <p>\u56fe 14-1 LTSSM \u5728 PCIe \u67b6\u6784\u4e2d\u6240\u5904\u7684\u4f4d\u7f6e</p> <p>\u5b8c\u6574\u7684\u8bad\u7ec3\u8fc7\u7a0b\u5728\u590d\u4f4d\u540e\u7531\u786c\u4ef6\u81ea\u52a8\u542f\u52a8\uff0c\u5e76\u7531 LTSSM \u7ba1\u7406\uff0c\u5982 506 \u9875\u56fe14-1 \u6240\u793a\u3002</p> <p>\u5728\u94fe\u8def\u521d\u59cb\u5316\u548c\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u5305\u62ec\u4e86\u51e0\u9879\u6b65\u9aa4\u3002\u8ba9\u6211\u4eec\u601d\u8003\u4e0b\u5b83\u4eec\u90fd\u6709\u54ea\u4e9b\u4f5c\u7528\uff0c\u5e76\u63d0\u524d\u5f15\u5165\u4e00\u4e9b\u672f\u8bed\u3002</p> <ul> <li> <p>\u4f4d\u9501\u5b9a\uff0cBit Lock\uff1a\u5f53\u94fe\u8def\u8bad\u7ec3\u5f00\u59cb\u65f6\uff0c\u63a5\u6536\u7aef\u7684\u65f6\u949f\u5c1a\u672a\u4e0e\u63a5\u6536\u4fe1\u53f7\u7684\u53d1\u9001\u65f6\u949f\u540c\u6b65\uff0c\u65e0\u6cd5\u53ef\u9760\u5730\u91c7\u6837\u8f93\u5165\u4fe1\u53f7\u7684\u6570\u636e\u6bd4\u7279\u3002\u5728\u94fe\u8def\u8bad\u7ec3\u671f\u95f4\uff0c\u63a5\u6536\u7aef\u7684**\u65f6\u949f\u548c\u6570\u636e\u6062\u590d**\uff08CDR\uff0cClock and Data Recovery\uff09\u903b\u8f91\u901a\u8fc7\u4f7f\u7528\u6570\u636e\u6bd4\u7279\u6d41\u4f5c\u4e3a\u65f6\u949f\u7684\u53c2\u8003\u4fe1\u53f7\uff0c\u6765\u91cd\u5efa\u53d1\u9001\u7aef\u7684\u65f6\u949f\u3002\u4e00\u65e6\u4ece\u6570\u636e\u6d41\u4e2d\u6062\u590d\u4e86\u65f6\u949f\uff0c\u5c31\u53ef\u4ee5\u8bf4\u63a5\u6536\u7aef\u5df2\u7ecf\u5b8c\u6210\u4e86\u4f4d\u9501\u5b9a\uff0c\u7136\u540e\u80fd\u591f\u6b63\u786e\u5730\u91c7\u6837\u8f93\u5165\u6570\u636e\u6bd4\u7279\u3002\u6709\u5173\u4f4d\u9501\u5b9a\u673a\u5236\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u53c2\u9605\u7b2c 395 \u9875\u7684 \u201c\u5b9e\u73b0\u4f4d\u9501\u5b9a\u201d\u3002</p> </li> <li> <p>\u7b26\u53f7\u9501\u5b9a\uff0cSymbol Lock\uff1a\u5bf9\u4e8e8b/10b\u7f16\u7801 (Gen1/Gen2) \u800c\u8a00\uff0c\u8bad\u7ec3\u7684\u4e0b\u4e00\u6b65\u662f\u8fdb\u884c\u7b26\u53f7\u9501\u5b9a\u3002\u540c\u4f4d\u9501\u5b9a\u7c7b\u4f3c\uff0c\u867d\u7136\u63a5\u6536\u7aef\u76ee\u524d\u53ef\u4ee5\u8bc6\u522b\u5355\u4e2a\u6bd4\u7279\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u7531 10 \u4e2a\u6bd4\u7279\u7ec4\u6210\u7684\u7b26\u53f7\u7684\u8fb9\u754c\u5728\u54ea\u91cc\u3002\u5f53\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u4ea4\u6362\u8bad\u7ec3\u6709\u5e8f\u96c6 TS1 \u548c TS2 \u65f6\uff0c\u63a5\u6536\u7aef\u5728\u6bd4\u7279\u6d41\u4e2d\u641c\u7d22\u53ef\u8bc6\u522b\u7684\u6570\u636e\u56fe\u6837\uff08pattern\uff09\u3002\u901a\u8fc7\u67e5\u627e COM \u7b26\u53f7\u7684\u4f4d\u7f6e\u53ef\u4ee5\u8f83\u4e3a\u7b80\u5355\u5730\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002COM \u7b26\u53f7\u72ec\u7279\u7684\u7f16\u7801\u4f7f\u5f97\u5b83\u5f88\u5bb9\u6613\u8bc6\u522b\uff0c\u8bc6\u522b COM \u5b57\u7b26\u540e\uff0c\u63a5\u6536\u65b9\u4e0d\u4f46\u5b9a\u4f4d\u5230\u4e86\u4e24\u4e2a\u7b26\u53f7\u4e4b\u95f4\u7684\u8fb9\u754c\uff0c\u800c\u4e14\u4e5f\u80fd\u5b9a\u4f4d\u5230\u4e24\u4e2a\u6709\u5e8f\u96c6\u4e4b\u95f4\u7684\u8fb9\u754c\uff08\u8bd1\u6ce8\uff1a\u56e0\u4e3a\u6709\u5e8f\u96c6 TS1/TS2 \u4ee5 COM \u5b57\u7b26\u4f5c\u4e3a\u5f00\u7aef\uff09\u3002\u6709\u5173\u8fd9\u65b9\u9762\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53c2\u89c1\u7b2c 396 \u9875\u7684 \u201c\u5b9e\u73b0\u7b26\u53f7\u9501\u5b9a\u201d\u3002</p> </li> <li> <p>\u5757\u9501\u5b9a\uff0cBlock Lock\uff1a\u5bf9\u4e8e8.0 GT/s(Gen3) \u6240\u4f7f\u7528\u7684\u5757\u9501\u5b9a\uff0c\u5904\u7406\u8fc7\u7a0b\u4e0e\u7b26\u53f7\u9501\u5b9a\u7565\u6709\u4e0d\u540c\uff0c\u56e0\u4e3a\u6ca1\u6709\u4f7f\u75288b/10b \u7f16\u7801\u65b9\u6848\uff0c\u6240\u4ee5\u4e5f\u5c31\u4e0d\u5b58\u5728 COM \u5b57\u7b26\u3002\u7136\u800c\uff0c\u63a5\u6536\u7aef\u4ecd\u7136\u9700\u8981\u5728\u63a5\u6536\u6bd4\u7279\u6d41\u4e2d\u627e\u5230\u53ef\u8bc6\u522b\u7684\u62a5\u6587\u8fb9\u754c\u3002\u89e3\u51b3\u65b9\u6848\u662f\u5728\u8bad\u7ec3\u6709\u5e8f\u96c6\u4e2d\u5305\u542b\u66f4\u591a\u7684\u7535\u6c14\u7a7a\u95f2\u9000\u51fa\u6709\u5e8f\u96c6\uff08 EIEOS,Electrical Idle Exit Ordered Set)\uff0c\u7528\u4e8e\u5b9a\u4f4d\u8fb9\u754c\u3002\u53ef\u4ee5\u901a\u8fc7\u67e5\u627e 00h \u548c FFh \u5b57\u8282\u4ea4\u66ff\u7684\u6570\u636e\u56fe\u6837\u6765\u627e\u5230 EIEOS \uff0c\u5e76\u4e14 EIEOS  \u7684\u4f4d\u7f6e\u5b9a\u4e49\u4e86\u5757\u4e4b\u95f4\u7684\u8fb9\u754c\uff0c\u56e0\u4e3a\u6839\u636e\u534f\u8bae\uff0c\u5f53\u8be5\u6709\u5e8f\u96c6\u7ed3\u675f\u540e\uff0c\u4e0b\u4e00\u4e2a\u5757\u5fc5\u987b\u7d27\u968f\u5176\u540e\u5f00\u59cb\u3002</p> </li> <li> <p>\u94fe\u8def\u5bbd\u5ea6\uff0cLink Width\uff1a\u5177\u6709\u591a\u4e2a\u901a\u9053\u7684 PCIe \u8bbe\u5907\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u94fe\u8def\u5bbd\u5ea6\u3002\u4f8b\u5982\uff0c\u5177\u6709 x2 \u7aef\u53e3\u7684\u8bbe\u5907\u53ef\u4ee5\u4e0e x4 \u7aef\u53e3\u7684\u8bbe\u5907\u8fde\u63a5\u3002\u5728\u94fe\u8def\u8bad\u7ec3\u671f\u95f4\uff0c\u4e24\u53f0\u8bbe\u5907\u7684\u7269\u7406\u5c42\u4f1a\u6d4b\u8bd5\u94fe\u8def\uff0c\u5e76\u5c06\u94fe\u8def\u5bbd\u5ea6\u8bbe\u7f6e\u4e3a\u4e24\u8005\u80fd\u63a5\u53d7\u7684\u6700\u5927\u503c\u3002</p> </li> <li> <p>\u901a\u9053\u7ffb\u8f6c\uff0c Lane Reversal\uff1a\u8bbe\u5907\u7aef\u53e3\u4e0a\u7684\u591a\u4e2a\u901a\u9053\u4ece 0 \u5f00\u59cb\uff0c\u6309\u9012\u589e\u987a\u5e8f\u7f16\u53f7\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u7aef\u53e3\u7684\u901a\u9053 0 \u540c\u6837\u8fde\u63a5\u5230\u5bf9\u7aef\u7684\u901a\u9053 0\uff0c\u901a\u9053 1 \u8fde\u63a5\u5230\u901a\u9053 1 \uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002</p> </li> </ul> <p>\u7136\u800c\uff0c\u6709\u65f6\u6211\u4eec\u5e0c\u671b\u80fd\u591f\u5728\u903b\u8f91\u4e0a\uff0c\u98a0\u5012\u5404\u4e2a\u901a\u9053\u95f4\u7684\u7f16\u53f7\uff0c\u4ee5\u7b80\u5316 PCB \u5e03\u7ebf\u3002\u5e76\u4e14\u80fd\u591f\u5141\u8bb8\u5404\u4e2a\u901a\u9053\u95f4\u7684\u8fde\u63a5\u8d70\u7ebf\u4e0d\u5fc5\u4ea4\u53c9(\u53c2\u89c1\u7b2c 508 \u9875\u7684\u56fe 14-2)\u3002\u53ea\u8981\u5176\u4e2d\u4e00\u4e2a PCIe \u8bbe\u5907\u652f\u6301\u901a\u9053\u7f16\u53f7\u53cd\u8f6c\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u98a0\u5012\u901a\u9053\u7684\u8fde\u63a5\u5173\u7cfb\uff0c\u8fd9\u662f\u4e00\u9879\u53ef\u9009\u529f\u80fd\u3002</p> <p>\u901a\u9053\u8fde\u63a5\u98a0\u5012\u7684\u60c5\u51b5\u662f\u5728\u94fe\u8def\u8bad\u7ec3\u671f\u95f4\u68c0\u6d4b\u5230\u7684\uff0c\u5176\u540e\uff0c\u5176\u4e2d\u4e00\u53f0\u8bbe\u5907\u5fc5\u987b\u5728\u5185\u90e8\u98a0\u5012\u5176\u901a\u9053\u7f16\u53f7\u624d\u80fd\u4f7f\u94fe\u8def\u6b63\u5e38\u5de5\u4f5c\u3002\u7531\u4e8e\u89c4\u8303\u6ca1\u6709\u5f3a\u5236\u8981\u6c42\u652f\u6301\u6b64\u529f\u80fd\uff0c\u7535\u8def\u677f\u8bbe\u8ba1\u4eba\u5458\u9700\u8981\u4fdd\u8bc1\u7cfb\u7edf\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u8bbe\u5907\u652f\u6301\u6b64\u529f\u80fd\uff0c\u624d\u80fd\u98a0\u5012\u901a\u9053\u987a\u5e8f\u5e03\u7ebf\u3002</p> <p></p> <p>\u56fe 14-2 \u901a\u9053\u7ffb\u8f6c\u793a\u4f8b\uff08\u53ef\u9009\u652f\u6301\u7279\u6027\uff09</p> <ul> <li>\u6781\u6027\u53cd\u8f6c\uff0cPolarity Inversion\uff1a\u4e24\u7aef\u8bbe\u5907\u95f4\u7684 D+ \u548c D- \u8fd9\u4e00\u5bf9\u5dee\u5206\u4fe1\u53f7\u4e92\u76f8\u4e4b\u95f4\u662f\u652f\u6301\u53cd\u63a5\u7684\uff08\u8bd1\u6ce8\uff1a\u5373\u5c06 D+ \u4e0e\u5bf9\u7aef D- \u8fde\u63a5\uff0c\u800c\u4e0d\u662f D+\uff09\uff0c\u4e3a\u4e86\u5728\u6709\u5fc5\u8981\u7684\u65f6\u5019\u7b80\u5316 PCB \u7684\u5e03\u5c40\u548c\u8fde\u7ebf\u3002\u4efb\u4f55\u63a5\u6536\u7aef\u90fd\u9700\u8981\u5355\u72ec\u5730\u68c0\u67e5\u5dee\u5206\u4fe1\u53f7\u7684\u8fde\u63a5\u60c5\u51b5\uff0c\u5e76\u5728\u6781\u6027\u7ffb\u8f6c\u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u8bad\u7ec3\u671f\u95f4\u81ea\u52a8\u7ea0\u6b63\uff0c\u5982\u56fe 14-3 \u6240\u793a\u3002\u63a5\u6536\u7aef\u901a\u8fc7\u68c0\u6d4b\u8f93\u5165 TS1 \u548c TS2 \u7684\u7b26\u53f7 6-15 \u6765\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002\u5982\u679c\u63a5\u6536\u7aef\u5728 TS1 \u4e2d\u6536\u5230\u4e86 D21.5 \u800c\u4e0d\u662f\u9884\u671f\u7684 D10.2\uff08\u8bd1\u6ce8\uff1a\uff09\uff0c\u6216\u8005\u5728 TS2 \u4e2d\u6536\u5230\u4e86 D26.5 \u800c\u4e0d\u662f\u9884\u671f\u7684 D5.2\uff0c\u8fd9\u4ee3\u8868\u5f53\u524d\u901a\u9053\u5dee\u5206\u5bf9\u6781\u6027\u53cd\u8f6c\uff0c\u9700\u8981\u8fdb\u884c\u7ea0\u6b63\u3002\u4e0e\u901a\u9053\u7ffb\u8f6c\u4e0d\u540c\u7684\u662f\uff0c\u6781\u6027\u53cd\u8f6c\u7ea0\u6b63\u662f\u4e00\u9879\u5fc5\u987b\u7684\u7279\u6027\uff0c\u800c\u4e0d\u662f\u53ef\u9009\u7684\u3002</li> </ul> <p></p> <p>\u56fe 14-3 \u6781\u6027\u53cd\u8f6c\u793a\u4f8b\uff08\u53ef\u9009\u652f\u6301\u7279\u6027\uff09</p> <ul> <li> <p>\u94fe\u8def\u6570\u636e\u901f\u7387\uff0cLink Data Rate: \u5728\u590d\u4f4d\u540e\uff0c\u94fe\u8def\u521d\u59cb\u5316\u4e0e\u8bad\u7ec3\u72b6\u6001\u673a\u603b\u662f\u4f1a\u5148\u5c06\u6570\u636e\u901f\u7387\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u7684 2.5Gbit/s\uff0c\u4ee5\u5b9e\u73b0\u5bf9\u7b2c\u4e00\u4ee3\u534f\u8bae\u7684\u540e\u5411\u517c\u5bb9\uff08\u7b2c\u4e00\u4ee3\u534f\u8bae\u901f\u7387\u4e3a  2.5Gbit/s\uff09\u3002\u5982\u679c\u94fe\u8def\u5ba3\u79f0\u53ef\u4ee5\u5b9e\u73b0\u66f4\u9ad8\u7684\u901f\u7387\uff0c\u90a3\u4e48\u5728\u8bad\u7ec3\u65f6\u53cc\u65b9\u4f1a\u901a\u544a\u81ea\u5df1\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\uff0c\u5b8c\u6210\u8bad\u7ec3\u540e\uff0cLSTTM \u4f1a\u81ea\u52a8\u91cd\u65b0\u8fdb\u884c\u4e00\u6b21\u8fc7\u7a0b\u66f4\u77ed\u7684\u8bad\u7ec3\uff0c\u5c06\u94fe\u8def\u901f\u7387\u6539\u53d8\u4e3a\u53cc\u65b9\u90fd\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u3002</p> </li> <li> <p>\u591a lane \u95f4\u4fe1\u53f7\u53bb\u504f\u79fb\uff0cLane\u2010to\u2010Lane De\u2010skew: \u5404\u4e2a\u901a\u9053\u4e4b\u95f4\u7684\u4f20\u8f93\u7ebf\u957f\u5ea6\u5dee\u5f02\u6216\u8005\u5176\u4ed6\u56e0\u7d20\uff0c\u4f1a\u5bfc\u81f4\u591a\u901a\u9053\u94fe\u8def\u4e2d\u539f\u672c\u540c\u65f6\u4f20\u8f93\u7684\u591a\u4e2a\u5e76\u884c\u6bd4\u7279\uff0c\u5230\u8fbe\u63a5\u6536\u65b9\u7684\u65f6\u95f4\u6709\u6240\u5dee\u5f02\uff0c\u8fd9\u88ab\u79f0\u4e4b\u4e3a\u4fe1\u53f7\u504f\u659c\uff08signal skew\uff09\u73b0\u8c61\u3002\u63a5\u6536\u65b9\u9700\u8981\u901a\u8fc7\u5ef6\u8fdf\u8f83\u65e9\u5230\u8fbe\u7684\u901a\u9053\uff0c\u4ee5\u5bf9\u9f50\u6240\u6709\u901a\u9053\u4e0a\u7684\u4fe1\u53f7\u7684\u5230\u8fbe\u65f6\u95f4\uff0c\u8865\u507f\u901a\u9053\u4e4b\u95f4\u4fe1\u53f7\u4f20\u8f93\u5feb\u6162\u5dee\u5f02\u3002\u5728\u534f\u8bae\u89c4\u5b9a\u7684\u53ef\u5141\u8bb8\u7684\u4fe1\u53f7\u504f\u79fb\u8303\u56f4\u5185\uff0c\uff08\u5bf9\u4e8e 2.5Gbps \u901f\u7387\u6765\u8bf4\uff0c\u6700\u5927\u4fe1\u53f7\u504f\u659c\u662f 20ns)\uff0c\u63a5\u6536\u65b9\u9700\u8981\u80fd\u591f\u81ea\u52a8\u5bf9\u504f\u79fb\u8fdb\u884c\u8865\u507f\u3002\u591a\u901a\u9053\u95f4\u4fe1\u53f7\u504f\u79fb\u8865\u507f\u673a\u5236\u80fd\u591f\u5e2e\u4e0a PCB \u8bbe\u8ba1\u8005\u4e00\u4e2a\u5927\u5fd9\uff0c\u56e0\u4e3a\u4ed6\u4eec\u4e0d\u518d\u9700\u8981\u8bbe\u7f6e\u590d\u6742\u7cbe\u7ec6\u7684\u7ea6\u675f\uff0c\u8d70\u51fa\u975e\u5e38\u7cbe\u786e\u7684\u7b49\u957f\u4fe1\u53f7\u4f20\u8f93\u7ebf\uff0c\u6709\u65f6\u5019\u8fd9\u662f\u5f88\u96be\u7684\u3002\u4fe1\u53f7\u504f\u79fb\u8865\u507f\u673a\u5236\u548c\u6781\u6027\u7ffb\u8f6c\u4ee5\u53ca\u901a\u9053\u7ffb\u8f6c\u673a\u5236\u4e00\u8d77\uff0c\u53ef\u4ee5\u5f88\u5927\u7a0b\u5ea6\u4e0a\u7b80\u5316\u9ad8\u53ef\u9760\u7684\u9ad8\u901f PCIe PCB \u8bbe\u8ba1\u3002</p> </li> </ul>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#142","title":"14.2 \u94fe\u8def\u8bad\u7ec3\u4e2d\u7684\u6709\u5e8f\u96c6","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1421","title":"14.2.1 \u6982\u8981","text":"<p>\u6211\u4eec\u5df2\u7ecf\u5728\u672c\u4e66 11 \u7ae0\u7684 \u201c\u6709\u5e8f\u96c6\u201d \u8fd9\u4e00\u8282\u8ba8\u8bba\u8fc7\u7269\u7406\u5c42\u6240\u6709\u4e0d\u540c\u7c7b\u578b\u7684\u6709\u5e8f\u96c6\u3002\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u5230\u7684\u7269\u7406\u5c42\u6709\u5e8f\u96c6\u5305\u62ec\u8bad\u7ec3\u6709\u5e8f\u96c6 TS1 \u4ee5\u53ca TS2 \u3002\u56fe 14-4 \u4e2d\u662f Gen1 \u4ee5\u53ca Gen2 \u6a21\u5f0f\u4e0b\u7684\u6709\u5e8f\u96c6\u683c\u5f0f\u3002\u56fe 14-5 \u662f Gen3 \u6a21\u5f0f\u4e2d\u6240\u4f7f\u7528\u6709\u5e8f\u96c6\u7684\u683c\u5f0f\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u8fdb\u4e00\u6b65\u8be6\u7ec6\u8ba8\u8bba\u4ed6\u4eec\u3002</p> <p></p> <p>\u56fe 14-4 Gen1/Gen2 \u4e2d\u7684 TS1/TS2 \u683c\u5f0f</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1422-ts1-ts2","title":"14.2.2 TS1 \u4ee5\u53ca TS2 \u6709\u5e8f\u96c6","text":"<p>\u4ece\u56fe\u4e2d 14-4 \u4e2d\u53ef\u4ee5\u770b\u5230\uff0cTS\u00bd \u7531 16 \u4e2a\u7b26\u53f7\uff08\u8bd1\u6ce8\uff1a\u5b57\u8282\uff09\u7ec4\u6210\u3002\u5728 LTSSM \u7684\u8f6e\u8be2\u3001\u914d\u7f6e\u4ee5\u53ca\u6062\u590d\u72b6\u6001\u4e2d\uff0c\u901a\u4fe1\u53cc\u65b9\u4f1a\u4ea4\u6362 TS\u00bd \u6709\u5e8f\u96c6\uff0c\u672c\u6587\u4f1a\u5728\u540e\u7eed\u7684 LTSSM \u7ae0\u8282\u8be6\u7ec6\u8ba8\u8bba\uff0c\u540e\u6587\u5206\u522b\u5728\u8868 14-1/14-2\u4e2d\uff0c\u7528\u8868\u683c\u7684\u5f62\u5f0f\u63cf\u8ff0\u4e86 TS\u00bd 16 \u4e2a\u7b26\u53f7\u7684\u5177\u4f53\u542b\u4e49\u3002 </p> <p>\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\u548c\u884c\u6587\uff0c\u4ee5\u4e0b\u7528 Gen1 \u8868\u793a\u901f\u7387\u4e3a 2.5GT/s \u7684\u60c5\u51b5\uff0cGen2 \u8868\u793a\u901f\u7387\u4e3a 5GT/s \u7684\u60c5\u51b5\uff0cGen3 \u8868\u793a\u901f\u7387\u4e3a 8GT/s \u7684\u60c5\u51b5\u3002\u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728\u4f4e\u901f\u7387\u4e2d\uff0cLink \u4ee5\u53ca Lane \u5b57\u6bb5\u4e2d\u7684\u586b\u5145\u5b57\u7b26\uff08PAD character\uff09\u4f7f\u7528 K23.7 \uff0c\u800c\u5728 Gen3 \u4e2d\u4f7f\u7528\u7684\u662f F7h\u3002\u6211\u4eec\u540e\u7eed\u7684\u8ba8\u8bba\u4e2d\u4e0d\u4f1a\u7279\u522b\u63d0\u53ca\u4e24\u8005\u7684\u5dee\u5f02\uff0c\u800c\u7edf\u4e00\u8868\u793a\u4e3a\u586b\u5145\u5b57\u7b26\uff0c\u56e0\u4e3a\u8fd9\u4e0d\u91cd\u8981\u3002 </p> <p></p> <p>\u56fe 14-5 Gen3 \u4e2d\u7684 TS1/TS2 \u683c\u5f0f</p> <p>\u8868 14-1 TS1 \u6709\u5e8f\u96c6\u5185\u5bb9\u6c47\u603b</p> Symbol Number Description 0 \u2022 Gen1/Gen2, COM (K28.5) \u7b26\u53f7\u2022 Gen3, 1Eh \u8868\u793a\u8fd9\u662f\u4e00\u4e2a TS1 \u6709\u5e8f\u96c6 Link Number \u94fe\u8def\u7f16\u53f7 \u2022 \u4e0d\u652f\u6301 Gen3 \u7684\u7aef\u53e3: 0\u2010255, PAD \u2022\u652f\u6301 Gen3 \u7684\u4e0b\u6e38\u7aef\u53e3: 0\u201031, PAD \u2022\u652f\u6301 Gen3 \u7684\u4e0a\u6e38\u7aef\u53e3: 0\u2010255, PAD 2 Lane Number \u901a\u9053\u7f16\u53f7 \u2022 0\u201031, PAD 3 N_FTS \u2022 \u4ece L0s \u8fd4\u56de L0 \u65f6\uff0c\u63a5\u6536\u65b9\u9700\u8981\u6536\u5230\u7684\u5feb\u901f\u8bad\u7ec3 FTS \u6709\u5e8f\u96c6\u6570\u91cf L0s: 0 \u2010 255 4 Data Rate Identifier \u6570\u636e\u901f\u7387\u6807\u8bc6\u7b26: \u2022 Bit 0 \u2014 \u4fdd\u7559\u5b57\u6bb5. \u2022 Bit 1 \u2014 \u652f\u6301 2.5 GT/s (\u5fc5\u987b\u7f6e\u4e3a 1b) \u2022 Bit 2 \u2014 \u652f\u6301 5.0 GT/s (\u5982\u679c Bit3 \u4e3a 1b\uff0c\u5219\u5fc5\u987b\u4e3a 1b) \u2022 Bit 3 \u2014 \u652f\u6301 8.0 GT/s \u2022 Bits 5:4 \u2014 \u4fdd\u7559\u5b57\u6bb5 \u2022 Bit 6 \u2014 Autonomous Change/Selectable De\u2010emphasis \u2013 \u4e0b\u6e38\u7aef\u53e3: \u5728 Polling.Active, Configuration.Linkwidth.Start, \u4ee5\u53ca Loopback.Entry \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 \u2013 \u4e0a\u6e38\u7aef\u53e3:  \u5728 Polling.Active, Configuration,Recovery, \u4ee5\u53ca Loopback.Entry \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 \u2022 Bit 7 \u2014 Speed change. \u53ea\u5728  Recovery.RcvrLock LTSSM \u72b6\u6001\u4e2d\u7f6e\u4e3a, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 5 Training Control (0=De\u2010assert, 1 = Assert) \u8bad\u7ec3\u63a7\u5236\u5b57\u6bb5\uff081 \u8868\u793a\u4f7f\u80fd\uff09 \u2022 Bit 0 \u2014 Hot Reset \u2022 Bit 1 \u2014 Disable Link \u2022 Bit 2 \u2014 Loopback \u2022 Bit 3 \u2014 Disable Scrambling (2.5 or 5.0 GT/s; Gen3 \u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5) \u2022 Bit 4 \u2014 Compliance Receive (2.5 GT/s \u901f\u7387\u53ef\u9009\u652f\u6301, \u5176\u4ed6\u901f\u7387\u5fc5\u987b\u652f\u6301) \u2022 Bits 7:5 \u2014 \u4fdd\u7559\u5b57\u6bb5, \u8bbe\u7f6e\u4e3a 0 6 Gen1/Gen2: \u2022 TS1 \u6807\u8bc6\u7b26(4Ah) \uff0c\u5373 D10.2 \u2022 \u4ec5\u5728 EQ TS1 \u4e2d\u4f7f\u7528\uff0c\u666e\u901a TS1 \u4e0d\u9002\u7528 Bits 2:0 \u2014 Receiver preset hint Bits 6:3 \u2014 Transmitter Preset Bit 7 \u2014 \u8bbe\u7f6e\u4e3a 1 Gen3: \u2022 Bits 1:0 \u2014 Equalization Control (EC). \u4ec5\u5728 Recovery.Equalization  \u4ee5\u53ca Loopback \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u5fc5\u987b\u4e3a 00b \u2022 Bit 2 \u2014 Reset EIEOS Interval Count. \u4ec5\u5728 Recovery.Equalization  \u4ee5\u53ca Loopback \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 \u2022 Bits 6:3 \u2014 Transmitter Preset \u2022 Bit 7 \u2014 Use Preset. (\u5982\u679c\u8be5\u6bd4\u7279\u4e3a 1\uff0c\u5219\u4f7f\u7528 preset \u503c\uff0c\u5426\u5219\u4f7f\u7528 coefficients \u503c) \u4ec5\u5728 Recovery.Equalization  \u4ee5\u53ca Loopback \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 7 Gen1/Gen2\uff1a \u2022 TS1 \u6807\u8bc6\u7b26(4Ah) \uff0c\u5373 D10.2 Gen3: \u2022 Bits 5:0 \u2014 FS (Full Swing value) \uff0c\u5982\u679c\u7b26\u53f7 6 \u4e2d\u7684 EC \u57df\u4e3a 01b\uff0c \u5426\u5219\u4e3a Precursor Coefficient. \u2022 Bits 7:6 \u2014 \u4fdd\u7559\u5b57\u6bb5. 8 Gen1/Gen2\uff1a \u2022 TS1 \u6807\u8bc6\u7b26(4Ah) \uff0c\u5373 D10.2Gen3: \u2022 Bits 5:0 \u2014 LF (Low Frequency value) \uff0c\u5982\u679c\u7b26\u53f7 6 \u4e2d\u7684 EC \u57df\u4e3a 01b,  \u5426\u5219\u4e3a Cursor Coefficient. \u2022 Bits 7:6 \u2014 \u4fdd\u7559\u5b57\u6bb5. 9 Gen1/Gen2\uff1a \u2022 TS1 \u6807\u8bc6\u7b26(4Ah) \uff0c\u5373 D10.2Gen3: \u2022 Bits 5:0 \u2014 Post\u2010cursor Coefficient. \u2022 Bit 6 \u2014 Reject Coefficient Values. \u4ec5\u5728 Recovery.Equalization  LTSSM \u72b6\u6001\u7684\u7279\u5b9a\u9636\u6bb5\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u5fc5\u987b\u4e3a 0 \u2022 Bit 7 \u2014 Parity (P) \u8fd9\u662f\u8986\u76d6\u7b26\u53f7 6\uff0c7\uff0c8 \u4ee5\u53ca \u7b26\u53f7 9[6:0] \u7684\u6821\u9a8c\u7801\u63a5\u6536\u65b9\u5fc5\u987b\u91cd\u65b0\u8ba1\u7b97\u6821\u9a8c\u7801\u5e76\u4e0e\u6821\u9a8c\u7801\u57df\u6bd4\u8f83\u53ea\u6709\u6bd4\u8f83\u7ed3\u679c\u901a\u8fc7\u7684 TS1 \u624d\u662f\u6709\u6548\u7684 10\u201013 Gen1/Gen2\uff1a \u2022 TS1 \u6807\u8bc6\u7b26(4Ah) \uff0c\u5373 D10.2Gen3: \u2022 TS1 \u6807\u8bc6\u7b26(4Ah) 14\u201015 Gen1/Gen2\uff1a \u2022 TS1 \u6807\u8bc6\u7b26(4Ah) \uff0c\u5373 D10.2Gen3: \u2022 TS1 \u6807\u8bc6\u7b26(4Ah)\uff0c\u6216\u8005 DC-balance \u7b26\u53f7 <p>\u8bfb\u8005\u53ef\u80fd\u4f1a\u5bf9\u7b26\u53f7 6 \u4e2d\u7684 EQ TS1 \u90e8\u5206\u611f\u5230\u7591\u60d1\uff1a\u65e2\u7136\u53ea\u6709 8GT/s \u901f\u7387\u652f\u6301\u5747\u8861\uff0c\u4e3a\u4ec0\u4e48\u8f83\u4f4e\u7684\u901f\u7387\u4e5f\u4f1a\u7528\u5230 EQ TS1\uff1f \u4ed6\u4eec\u5176\u5b9e\u662f\u7ed9\u90a3\u4e9b\u652f\u6301 Gen3 \u4f46\u662f\u5f53\u524d\u5de5\u4f5c\u5728\u8f83\u4f4e\u901f\u7387\uff0c\u5e76\u4e14\u60f3\u5207\u6362\u5230 8GT/s \u7684\u901a\u9053\u4f20\u9012 EQ \u503c\u7528\u7684\u3002\u5173\u4e8e\u8fd9\u90e8\u5206\u7684\u66f4\u591a\u7ec6\u8282\uff0c\u4ee5\u53ca Gen3 \u5747\u8861\u8fc7\u7a0b\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u53c2\u9605\u672c\u7ae0 \u201c\u94fe\u8def\u5747\u8861\u6982\u89c8\u201d \u4e00\u8282\uff0c\u539f\u6587 577 \u9875\u3002</p> <p>\u8868 14-2 TS2 \u6709\u5e8f\u96c6\u5185\u5bb9\u6c47\u603b</p> Symbol Number Description 0 \u2022 Gen1/Gen2, COM (K28.5) \u7b26\u53f7\u2022 Gen3, 2Dh \u8868\u793a\u8fd9\u662f\u4e00\u4e2a TS2 \u6709\u5e8f\u96c6. Link Number \u94fe\u8def\u7f16\u53f7 \u2022 \u4e0d\u652f\u6301 Gen3 \u7684\u7aef\u53e3: 0\u2010255, PAD \u2022\u652f\u6301 Gen3 \u7684\u4e0b\u6e38\u7aef\u53e3: 0\u201031, PAD \u2022\u652f\u6301 Gen3 \u7684\u4e0a\u6e38\u7aef\u53e3: 0\u2010255, PAD 2 Lane Number \u901a\u9053\u7f16\u53f7 \u2022 0\u201031, PAD 3 N_FTS \u2022 \u4ece L0s \u8fd4\u56de L0 \u65f6\uff0c\u63a5\u6536\u65b9\u9700\u8981\u6536\u5230\u7684\u5feb\u901f\u8bad\u7ec3 FTS \u6709\u5e8f\u96c6\u6570\u91cf L0s: 0 \u2010 255 4 Data Rate Identifier \u6570\u636e\u901f\u7387\u6807\u8bc6\u7b26: \u2022 Bit 0 \u2014 \u4fdd\u7559\u5b57\u6bb5. \u2022 Bit 1 \u2014 \u652f\u6301 2.5 GT/s (\u5fc5\u987b\u7f6e\u4e3a 1b) \u2022 Bit 2 \u2014 \u652f\u6301 5.0 GT/s (\u5982\u679c Bit3 \u4e3a 1b\uff0c\u5219\u5fc5\u987b\u4e3a 1b) \u2022 Bit 3 \u2014 \u652f\u6301 8.0 GT/s \u2022 Bits 5:4 \u2014 \u4fdd\u7559\u5b57\u6bb5 \u2022 Bit 6 \u2014 Autonomous Change/Selectable De\u2010emphasis/Link Upconfigure Capability. \u5728 Polling.Configuration, Configuration.Complete, \u4ee5\u53ca Recovery \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 \u2022 Bit 7 \u2014 Speed change. \u53ea\u5728  Recovery.RcvrLock LTSSM \u72b6\u6001\u4e2d\u7f6e\u4e3a, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 5 Training Control (0=De\u2010assert, 1 = Assert) \u8bad\u7ec3\u63a7\u5236\u5b57\u6bb5\uff081 \u8868\u793a\u4f7f\u80fd\uff09 \u2022 Bit 0 \u2014 Hot Reset \u2022 Bit 1 \u2014 Disable Link \u2022 Bit 2 \u2014 Loopback \u2022 Bit 3 \u2014 Disable Scrambling (2.5 or 5.0 GT/s; Gen3 \u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5) \u2022 Bits 7:4 \u2014 \u4fdd\u7559\u5b57\u6bb5, \u8bbe\u7f6e\u4e3a 0 6 Gen1/Gen2: \u2022 TS2 \u6807\u8bc6\u7b26(4Ah) \uff0c\u5373 D10.2\uff08\u8bd1\u6ce8\uff1a\u539f\u6587\u5982\u6b64\uff0c\u5e94\u4e3a 45h \u4ee5\u53ca D5.2\uff09 \u2022 \u4ec5\u5728 EQ TS2 \u4e2d\u4f7f\u7528\uff0c\u666e\u901a TS2 \u4e0d\u9002\u7528 Bits 2:0 \u2014 Receiver preset hint Bits 6:3 \u2014 Transmitter Preset Bit 7 \u2014 Equalization Command Gen3: \u2022 Bits 5:0 \u2014 \u4fdd\u7559\u5b57\u6bb5 \u4ec5\u5728 Recovery.Equalization  \u4ee5\u53ca Loopback \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u5fc5\u987b\u4e3a 0 \u2022 Bit 6 \u2014  Quiesce Guarantee. \u4ec5\u5728 Recovery.RcvrCfg \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 \u2022 Bit 7 \u2014  Request Equalization. \u4ec5\u5728 Recovery.RcvrCfg \u7b49 LTSSM \u72b6\u6001\u4e2d\u4f7f\u7528, \u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u4fdd\u7559\u5b57\u6bb5 7-13 Gen1/Gen2\uff1a \u2022 TS2 \u6807\u8bc6\u7b26(45h) \uff0c\u5373 D5.2 Gen3: \u2022 TS2 \u6807\u8bc6\u7b26(45h)  14\u201015 Gen1/Gen2\uff1a \u2022 TS2 \u6807\u8bc6\u7b26(45h) \uff0c\u5373 D5.2 Gen3: \u2022 TS2 \u6807\u8bc6\u7b26(45h) \u6216\u8005 DC-balance \u7b26\u53f7 <p>\u8868 14-1/14-2\u662f TS1 \u548c TS2 \u683c\u5f0f\u7684\u5927\u81f4\u63cf\u8ff0\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u4ed4\u7ec6\u8ba8\u8bba\u4e0b\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\u3002</p> <ul> <li>Symbol 0\uff1a</li> <li>Gen\u00bd\uff0c\u6240\u6709\u6709\u5e8f\u96c6\u7684\u9996\u4e2a\u7b26\u53f7\u90fd\u662f K28.5(COM) \u5b57\u7b26\u3002\u63a5\u6536\u65b9\u901a\u8fc7 COM \u5b57\u7b26\u5b9e\u73b0\u7b26\u53f7\u9501\u5b9a\uff08\u8bd1\u6ce8\uff1a\u5373\u63a5\u6536\u65b9\u901a\u8fc7\u6b63\u786e\u63a5\u6536\u7684 COM\uff0c\u786e\u8ba4\u7b26\u53f7\u7684\u8fb9\u754c\uff09\u3002\u56e0\u4e3a COM \u5b57\u7b26\u9700\u8981\u540c\u65f6\u51fa\u73b0\u5728\u6240\u6709\u901a\u9053\u4e0a\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u4e8e\u591a\u901a\u9053\u95f4\u4fe1\u53f7\u53bb\u504f\u659c\u3002</li> <li>Gen3\uff0c\u6709\u5e8f\u96c6\u6240\u5728\u7684 Block \u4e4b\u524d\u662f 2 \u6bd4\u7279\u540c\u6b65\u5934\uff0c\u540c\u6b65\u5934\u4e4b\u540e\u7684\u9996\u4e2a\u7b26\u53f7\u7528\u4e8e\u8868\u793a\u6709\u5e8f\u96c6\u7684\u7c7b\u578b\u3002TS1 \u7684\u9996\u4e2a\u7b26\u53f7\u662f 1Eh, TS2 \u9996\u4e2a\u7b26\u53f7\u662f 2Dh\u3002</li> <li>Symbol 1\uff08Link #\uff09\uff1a\u94fe\u8def\u7f16\u53f7\uff0c\u5728\u8f6e\u8be2\u72b6\u6001\u4e2d\u4f7f\u7528\u586b\u5145\u5b57\u7b26\u586b\u5145\uff0c\u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u94fe\u8def\u88ab\u5206\u914d\u7684\u7f16\u53f7</li> <li>Symbol 2\uff08Lane #\uff09\uff1a\u901a\u9053\u7f16\u53f7\uff0c\u5728\u8f6e\u8be2\u72b6\u6001\u4e2d\u4f7f\u7528\u586b\u5145\u5b57\u7b26\u586b\u5145\uff0c\u5176\u4ed6\u72b6\u6001\u4e2d\u4e3a\u901a\u9053\u88ab\u5206\u914d\u7684\u7f16\u53f7</li> <li>Symbol 3 (N_FTS)\uff1a \u8868\u793a\u5f53\u524d\u94fe\u8def\u901f\u7387\u4e0b\uff0c\u63a5\u6536\u65b9\u4ece L0s \u7535\u6e90\u72b6\u6001\u9000\u51fa\u8fd4\u56de L0 \u72b6\u6001\u6240\u9700\u8981\u63a5\u6536\u7684\u5feb\u901f\u8bad\u7ec3\u5e8f\u5217\uff08FTS\uff09\u6570\u91cf\u3002\u5728\u9000\u51fa L0s \u72b6\u6001\u65f6\uff0c\u53d1\u9001\u65b9\u81f3\u5c11\u4f1a\u53d1\u9001 N_FTS \u4e2a FTS\u3002\u8fd9\u4e00\u8fc7\u7a0b\u6240\u9700\u7684\u65f6\u95f4\u53d6\u51b3\u4e8e\u6240\u9700 FTS \u7684\u6570\u91cf\u4ee5\u53ca\u5f53\u524d\u7684\u94fe\u8def\u901f\u7387\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c2.5GT/s \u901f\u7387\u4e0b\uff0c\u6bcf\u4e2a\u7b26\u53f7\u7684\u53d1\u9001\u65f6\u95f4\u4e3a 4ns\uff0c\u6240\u4ee5\u5982\u679c\u9700\u8981 200 \u4e2a FTS\uff0c\u90a3\u4e48\u5c31\u662f 200 FTS * \u6bcf\u4e2a FTS 4 \u4e2a\u7b26\u53f7 * 4ns = 3200 ns\u3002\u5982\u679c\u53d1\u9001\u65b9\u7f6e\u4f4d\u4e86\u6269\u5c55\u540c\u6b65\u6bd4\u7279\uff0c\u90a3\u4e48\u5c06\u53d1\u9001 4096 \u4e2a FTS\uff0c\u53d1\u9001\u8fd9\u4e48\u591a FTS \u662f\u4e3a\u4e86\u7ed9\u5916\u90e8\u94fe\u8def\u89c2\u6d4b\u5de5\u5177\u5efa\u7acb\u6bd4\u7279\u540c\u6b65\u548c\u7b26\u53f7\u540c\u6b65\u7559\u51fa\u8db3\u591f\u7684\u65f6\u95f4\uff0c\u56e0\u4e3a\u6709\u4e9b\u5916\u90e8\u5de5\u5177\u540c\u6b65\u6240\u9700\u7684\u65f6\u95f4\u6bd4\u8f83\u957f\u3002</li> <li>Symbol 4 (Rate ID): \u8bbe\u5907\u62a5\u544a\u5176\u6240\u652f\u6301\u7684\u6570\u636e\u901f\u7387\uff0c\u4ee5\u53ca\u4e00\u4e9b\u63d0\u4f9b\u7ed9\u7531\u786c\u4ef6\u53d1\u8d77\u7684\u5e26\u5bbd\u6539\u53d8\u529f\u80fd\u7684\u4fe1\u606f\u3002\u6240\u6709\u8bbe\u5907\u5fc5\u987b\u652f\u6301 2.5GT/s \u901f\u7387\uff0c\u5e76\u4e14\u94fe\u8def\u5728\u590d\u4f4d\u540e\u59cb\u7ec8\u4f1a\u81ea\u52a8\u88ab\u8bad\u7ec3\u4e3a 2.5GT/s \u901f\u7387\uff0c\u6240\u4ee5\u4efb\u4f55\u65b0\u7684\u8bbe\u5907\u90fd\u9700\u8981\u540e\u5411\u517c\u5bb9\u8fd9\u4e2a\u901f\u7387\u3002\u5982\u679c\u8bbe\u5907\u652f\u6301 8GT/s \u901f\u7387\uff0c\u90a3\u4e48\u5b83\u4e5f\u9700\u8981\u652f\u6301 5GT/s \u901f\u7387\u3002\u6b64\u5916\uff0c\u8fd9\u4e2a\u7b26\u53f7\u4e2d\u8fd8\u5305\u62ec\u7684\u5176\u4ed6\u4fe1\u606f\u6709\uff1a</li> <li>Autonomous Change\uff1a\u5f53\u8be5\u6bd4\u7279\u7f6e\u4e3a 1 \u65f6\uff0c\u4efb\u4f55\u5e26\u5bbd\u6539\u53d8\u7684\u8bf7\u6c42\u90fd\u662f\u57fa\u4e8e\u7535\u6e90\u7ba1\u7406\u65b9\u9762\u7684\u539f\u56e0\u800c\u53d1\u8d77\u7684\u3002\u5982\u679c\u5728\u53d1\u51fa\u5e26\u5bbd\u6539\u53d8\u8bf7\u6c42\u65f6\uff0c\u8be5\u6bd4\u7279\u672a\u7f6e\u4e3a 1\uff0c\u90a3\u4e48\u4ee3\u8868\u8bbe\u5907\u5728\u8f83\u9ad8\u7684\u901f\u7387\u6216\u8005\u8f83\u5bbd\u7684\u94fe\u8def\u4e0a\u68c0\u6d4b\u5230\u5de5\u4f5c\u4e0d\u7a33\u5b9a\u7684\u60c5\u51b5\uff0c\u9700\u8981\u6539\u53d8\u5e26\u5bbd\u914d\u7f6e\uff08\u964d\u4f4e\u901f\u7387\u6216\u8005\u51cf\u5c0f\u94fe\u8def\u5bbd\u5ea6\uff09\u6765\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002</li> <li> <p>Selectable De\u2010emphasis</p> <ul> <li>**\u4e0a\u6e38\u7aef\u53e3\uff08Upstream Ports\uff09**\u8bbe\u7f6e\u8be5\u57df\u8868\u793a\u4ed6\u4eec\u5728 5GT/s \u901f\u7387\u4e0b\u671f\u671b\u7684\u53bb\u52a0\u91cd\u6c34\u5e73\u8bbe\u7f6e\uff0c\u5177\u4f53\u7684\u9884\u671f\u8bbe\u7f6e\u53d6\u51b3\u4e8e\u5b9e\u73b0\u3002\u5728 Recovery.RcvrCfg \u72b6\u6001\u4e2d\uff0c\u8bbe\u5907\u9501\u5b58\u63a5\u6536\u5230\u7684\u8be5\u57df\u7684\u503c\uff0c\u5b58\u653e\u5728\u8bbe\u5907\u5185\u90e8\u3002\uff08\u534f\u8bae\u63cf\u8ff0\u4e2d\uff0c\u8fd9\u4e2a\u503c\u4f1a\u88ab\u4fdd\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a select_deemphasis \u7684\u53d8\u91cf\u4e2d\uff09</li> <li>\u4e0b\u6e38\u7aef\u53e3\uff08Downstream Ports\uff09**\u548c**\u6839\u8282\u70b9\u7aef\u53e3\uff08Root Ports\uff09\uff1a\u5728 Polling.Compliance \u72b6\u6001\u4e2d\uff0c\u57fa\u4e8e\u63a5\u6536\u5230\u7684\u8be5\u6bd4\u7279\u6570\u503c\uff0c\u8bbe\u7f6e select_deemphasis \u53d8\u91cf\u3002\u5728 Recovery.RcvrCfg \u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u7aef\u8bbe\u7f6e\u53d1\u9001\u7684 TS2 \u4e2d\u7684\u8be5\u6bd4\u7279\u4fe1\u606f\uff0c\u6570\u503c\u57fa\u4e8e  Link Control 2 \u5bc4\u5b58\u5668\u76f8\u5173\u6bd4\u7279\u3002\u7531\u4e8e\u8be5\u5bc4\u5b58\u5668\u7684\u521d\u59cb\u503c\u662f\u7531\u786c\u4ef6\u521d\u59cb\u5316\u7684\uff0c\u6240\u4ee5\u9884\u671f\u9700\u8981\u5728\u4e0a\u7535\u9636\u6bb5\u540e\u901a\u8fc7\u56fa\u4ef6\u914d\u7f6e\u6070\u5f53\u7684\u6570\u503c\uff0c\u6216\u8005\u5c06\u5176\u786c\u4ef6\u521d\u59cb\u5316\u503c\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u4fdd\u5b88\u4f46\u662f\u5b89\u5168\uff08Strapping\uff09\u7684\u6570\u503c\u3002</li> <li>\u5728 5.0 GT/s \u56de\u73af\u6a21\u5f0f\u4e2d\uff0c\u4ece\u673a\u53bb\u52a0\u91cd\u6c34\u5e73\u6570\u503c\u7531\u4e3b\u673a\u53d1\u9001\u7684 TS1 \u4e2d\u7684\u5bf9\u5e94\u6bd4\u7279\u8bbe\u7f6e\u3002</li> </ul> </li> <li> <p>Link Upconfigure Capability\uff1a\u8be5\u57df\u8868\u793a\u4e86\u4e00\u4e2a\u8f83\u5bbd\u7684\u94fe\u8def\u5728\u51cf\u5c11\u94fe\u8def\u5bbd\u5ea6\u540e\uff0c\u662f\u5426\u6709\u80fd\u529b\u91cd\u65b0\u6062\u590d\u539f\u5148\u8f83\u5bbd\u7684\u94fe\u8def\u5bbd\u5ea6\u3002\u5982\u679c\u5728 Configuration.Complete \u72b6\u6001\u4e2d\uff0c\u53cc\u65b9\u8bbe\u5907\u90fd\u62a5\u544a\u81ea\u5df1\u5177\u6709\u8fd9\u4e2a\u80fd\u529b\uff0c\u90a3\u4e48\u5c31\u505a\u4e3a\u4e00\u9879\u5171\u8bc6\u8bb0\u5f55\u4e0b\u6765\u3002\uff08\u6bd4\u5982\u5c06\u5185\u90e8\u7684\u4e00 upconfigure_capable \u6bd4\u7279\u7f6e\u4f4d\uff09</p> </li> <li> <p>Symbol 5 (Training Control): \u4ea4\u6d41\u94fe\u8def\u53cc\u65b9\u7684\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0c\u6bd4\u5982\u8fdb\u884c\u4e00\u6b21\u70ed\u590d\u4f4d\uff08Hot Reset\uff09\uff0c\u4f7f\u80fd\u56de\u73af\u6a21\u5f0f\uff0c\u5173\u95ed\u94fe\u8def\u6216\u8005\u5173\u95ed\u52a0\u6270\u3002</p> </li> <li>Symbols 6\u20109 (Equalization Control): </li> <li>Gen1/Gen2\uff0c\u7b26\u53f7 7-9 \u4ec5\u4ec5\u662f TS1 \u6216\u8005 TS2 \u7684\u6807\u8bc6\u7b26\uff0c\u7b26\u53f7 6 \u901a\u5e38\u4e5f\u53ea\u662f\u6807\u8bc6\u7b26\uff0c\u6b64\u65f6\u7b26\u53f7 6 \u6bd4\u7279 7\uff08Use Preset \u57df\uff09 \u4e3a 0 \u3002\u4f46\u662f\uff0c\u5982\u679c\u8fd9\u4e00\u6bd4\u7279\u4e3a 1\uff0c\u90a3\u4e48\u4ee3\u8868\u5f53\u524d\u7684\u6709\u5e8f\u7b26\u53f7\u96c6\u662f\u4e00\u4e2a\u4e0b\u6e38\u7aef\u53e3\uff08DSP\uff0c\u9762\u5411\u4e0b\u6e38\u7684\u7aef\u53e3\uff0c\u6bd4\u5982 RC \u7684\u7aef\u53e3\uff09\u53d1\u9001\u7684 EQ TS1 \u6216\u8005 EQ TS2\u3002\u5176\u4e2d \u201dEQ\u201c \u4ee3\u8868\u5747\u8861\uff08Equalization\uff09\uff0c\u53d1\u9001 EQ TS1/TS2 \u610f\u5473\u7740\u94fe\u8def\u901f\u7387\u5c06\u88ab\u63d0\u9ad8\u4e3a 8GT/s\uff0c\u6b64\u65f6\u4e0a\u6e38\u7aef\u53e3\uff08USP\uff0c\u9762\u5411\u4e0a\u6e38\u7684\u7aef\u53e3\uff0c\u6bd4\u5982 EP \u7684\u7aef\u53e3\uff09\u9700\u8981\u77e5\u9053\u5f53\u524d\u4f7f\u7528\u7684\u5747\u8861\u53c2\u6570\u3002\u5728 EQ TS1 \u548c TS2 \u4e2d\uff0c\u7b26\u53f7 6 \u63d0\u4f9b\u7ed9 USP \u7684\u4fe1\u606f\u5305\u62ec\u53d1\u9001\u7aef\u9884\u8bbe\u96c6\u9009\u62e9\uff08Preset\uff09\u4ee5\u53ca\u63a5\u6536\u7aef\u9884\u8bbe\u96c6\u9009\u62e9\u63d0\u793a\uff08Preset Hint\uff09\u3002\u652f\u6301 8GT/s \u901f\u7387\u7684\u7aef\u53e3\u9700\u8981\u80fd\u591f\u63a5\u6536\u4efb\u610f\u7684 TS \u7c7b\u578b\uff08\u5305\u62ec\u666e\u901a TS \u4ee5\u53ca EQ TS\uff09\uff0c\u4f46\u662f\u5982\u679c\u7aef\u53e3\u4e0d\u652f\u6301 8GT/s \u901f\u7387\uff0c\u5219\u4e0d\u9700\u8981\u63a5\u6536 EQ TS \u7684\u80fd\u529b\u3002\u53ef\u80fd\u7684\u9884\u8bbe\u96c6\u6570\u503c\u5217\u5728\u539f\u6587 579 \u548c 580 \u9875\u7684\u8868 14-8 \u548c\u8868 14-9 \u4e2d\u3002</li> <li>Gen3\uff0c\u7b26\u53f7 6-9 \u63d0\u4f9b\u5747\u8861\u8fc7\u7a0b\u6240\u9700\u7684\u9884\u8bbe\u96c6\u9009\u62e9\u6570\u503c\u4ee5\u53ca\u53c2\u6570\u3002TS2 \u7684\u7b26\u53f7 6 \u7684\u6bd4\u7279 7 \uff08Request Equalization \u57df\uff09\u73b0\u5728\u88ab USP \u7528\u4e8e\u7533\u8bf7\u91cd\u65b0\u8fdb\u884c\u5747\u8861\u3002\u6b64\u65f6\uff0c\u7b26\u53f7 6 \u7684\u6bd4\u7279 6 \uff08 Quiesce Guarantee \u57df\uff09\u53ef\u80fd\u4e5f\u9700\u8981\u88ab\u7f6e\u8d77\uff0c\u8868\u793a\u53ea\u8981\u91cd\u65b0\u5747\u8861\u7684\u901f\u5ea6\u591f\u5feb\uff0c\u90a3\u4e48\u6240\u8017\u8d39\u7684\u65f6\u95f4\u4e0d\u4f1a\u5bfc\u81f4\u8bf8\u5982\u5b8c\u6210\u5305\u8d85\u65f6\u7b49\u95ee\u9898\uff08\u8fd4\u56de L0 \u7684\u65f6\u95f4\u5728 1ms \u4ee5\u5185\uff09\u3002\u5728\u6709\u4e9b\u573a\u666f\u4f1a\u4f7f\u7528\u5230\u8fd9\u4e2a\u529f\u80fd\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u5728\u4f7f\u7528\u5747\u8861\u5f97\u5230\u7684\u8bbe\u7f6e\u65f6\u68c0\u6d4b\u5230\u4e86\u95ee\u9898\u3002 DSP \u53ef\u4ee5\u4f7f\u7528\u6bd4\u7279 6 \u548c 7\uff0c\u8981\u6c42 USP \u6765\u53d1\u8d77\u91cd\u65b0\u5747\u8861\u7684\u8bf7\u6c42\uff0c\u5e76\u4fdd\u8bc1\u91cd\u65b0\u5747\u8861\u4e0d\u4f1a\u5e26\u6765\u526f\u4f5c\u7528\uff0c\u5c3d\u7ba1 USP \u4e0d\u9700\u8981\u5bf9\u6b64\u505a\u51fa\u56de\u590d\u3002\uff08\u8bd1\u8005\uff1a\u6ca1\u6709\u592a\u660e\u767d\u8fd9\u4e2a\u4f8b\u5b50\uff09\u5982\u679c\u60f3\u4e86\u89e3\u66f4\u591a\u5747\u8861\u8fc7\u7a0b\uff0c\u8bf7\u53c2\u9605\u539f\u6587 577 \u9875\u7684 \u201c\u94fe\u8def\u5747\u8861\u6982\u89c8\u201d \u4e00\u8282\u3002</li> <li>Symbols 10\u201013 : TS1 \u6216\u8005 TS2 \u6807\u8bc6\u7b26</li> <li>Symbols 14-15 \uff08DC Balance\uff09: </li> <li>Gen1/Gen2\uff0c\u4ec5\u4ec5\u662f TS1 \u6216\u8005 TS2 \u7684\u6807\u8bc6\u7b26\uff0c\u56e0\u4e3a DC \u5747\u8861\u5df2\u7ecf\u7531 8b/10b \u7f16\u7801\u5b8c\u6210\u3002</li> <li>Gen3\uff0c\u8fd9\u4e24\u4e2a\u7b26\u53f7\u7684\u6570\u503c\u57fa\u4e8e\u672c\u901a\u9053\u4e0a DC \u5747\u8861\u7684\u9700\u8981\u3002\u53d1\u9001\u65b9\u5fc5\u987b\u5728\u6bcf\u4e2a\u901a\u9053\u4e0a\u72ec\u7acb\u5730\u8ffd\u8e2a\u5f53\u524d\u6240\u6709\u6b63\u5728\u88ab\u53d1\u9001\u7684\u52a0\u6270\u540e\u7684 TS1 \u6216\u8005 TS2 \u7684\u5b9e\u65f6 DC \u5747\u8861\uff08Running DC Balance\uff09\u60c5\u51b5\u3002\u5b9e\u65f6 DC \u5747\u8861\uff08Running DC Balance\uff09\u662f\u6307\u76ee\u524d\u53d1\u9001\u7684 1 \u548c 0 \u4e4b\u95f4\u7684\u6570\u91cf\u5dee\uff0c\u5404\u4e2a\u901a\u9053\u5fc5\u987b\u80fd\u591f\u5728\u6536\u53d1\u4e24\u4e2a\u65b9\u5411\u4e0a\u8ffd\u8e2a 0 \u548c 1 \u7684\u6570\u91cf\u5dee\u503c\uff0c\u6700\u5927\u652f\u6301\u7684\u5dee\u503c\u4e3a 511\u3002\u8fd9\u4e9b\u8ba1\u6570\u5668\u5728\u8bb0\u6ee1\u540e\u4fdd\u6301\u4e0d\u53d8\uff0c\u4f46\u662f\u4f1a\u66f4\u65b0\u5dee\u503c\u51cf\u5c0f\u7684\u53d8\u5316\u3002\u4e3e\u4f8b\u800c\u8a00\uff0c\u5982\u679c\u8ba1\u6570\u5668\u8bb0\u5f55\u5230\u53d1\u9001\u7684 1 \u6570\u91cf\u6bd4 0 \u591a 511 \u4e2a\uff0c\u6b64\u540e\u65e0\u8bba\u53d1\u9001\u591a\u5c11\u4e2a 1\uff0c\u8ba1\u6570\u503c\u4ecd\u7136\u505c\u7559\u5728 511\u3002\u7136\u800c\uff0c\u5982\u679c\u53d1\u9001\u4e86 2 \u4e2a 0\uff0c\u90a3\u4e48\u8ba1\u6570\u5668\u4f1a\u51cf\u5c11\u5230 509\u3002\u5728\u53d1\u9001 TS1 \u6216\u8005 TS2 \u65f6\uff0c\u7b26\u53f7 14 \u548c 15 \u7684\u6570\u503c\u7531\u4ee5\u4e0b\u7b97\u6cd5\u51b3\u5b9a\uff1a<ul> <li>\u5982\u679c\u5728\u7b26\u53f7 11 \u7ed3\u675f\u65f6\uff0c DC \u5747\u8861\u5dee\u503c &gt; 31\uff0c\u5982\u679c\u53d1\u9001\u7684 1 \u6570\u91cf\u66f4\u591a\uff0c\u90a3\u4e48\u7b26\u53f7 14 = 20h\uff0c\u7b26\u53f7 15 = 08h\u3002\u5982\u679c\u53d1\u9001\u7684 0 \u6570\u91cf\u66f4\u591a\uff0c\u90a3\u4e48\u7b26\u53f7 14 = DFh\uff0c\u7b26\u53f7 15 = F7h\u3002</li> <li>\u5982\u679c DC \u5747\u8861\u5dee\u503c &gt; 15\uff0c\u90a3\u4e48\u7b26\u53f7 14 = \u6b63\u5e38\u7684 TS1 \u6216\u8005 TS2 \u6807\u8bc6\u7b26\uff0c\u7b26\u53f7 15 = 08h \u4ee5\u51cf\u5c11 1 \u7684\u6570\u91cf\uff0c\u6216\u8005\u7b26\u53f7 15 = F7h \u4ee5\u51cf\u5c11 0 \u7684\u6570\u91cf\u3002</li> <li>\u5176\u4ed6\u5173\u4e8e Gen3 DC \u5747\u8861\u7684\u6ce8\u610f\u4e8b\u9879\uff1a</li> <li>DC \u5747\u8861\u8ba1\u6570\u5668\u5c06\u5728\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u6216\u8005\u5728\u4e00\u4e2a\u6570\u636e\u5757\u4e4b\u540e\u6536\u5230 EIEOS \u65f6\u590d\u4f4d\u3002</li> <li>DC \u5747\u8861\u7b26\u53f7\u5c06\u7ed5\u8fc7\u52a0\u6270\uff0c\u6765\u4fdd\u8bc1\u53d1\u9001\u7684\u662f\u9884\u671f\u7684\u7b26\u53f7\u3002</li> </ul> </li> </ul>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#143-ltssm","title":"14.3 \u94fe\u8def\u8bad\u7ec3\u4e0e\u72b6\u6001\u63a7\u5236\u72b6\u6001\u673a\uff08LTSSM\uff09","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1431","title":"14.3.1 \u6982\u8981","text":"<p>\u539f\u6587 519 \u9875\u56fe 14-6 \u5c55\u793a\u4e86 LTSSM \u548c\u94fe\u8def\u8bad\u7ec3\u7684\u9ad8\u5c42\u6b21\u62bd\u8c61\u7ed3\u6784\u3002\u6bcf\u4e2a LTSSM \u7684\u72b6\u6001\u4e2d\u53c8\u5212\u5206\u4e3a\u82e5\u5e72\u6b21\u72b6\u6001\u3002\u5728\u57fa\u7840\u590d\u4f4d\uff08Fundmental Reset\uff09\uff0c\u5373\u51b7\u590d\u4f4d\uff08Cold Reset\uff09\u548c\u6696\u590d\u4f4d\uff08Warm Reset\uff09\uff0c\u6216\u8005\u70ed\u590d\u4f4d\uff08Hot Reset\uff09\u91ca\u653e\u540e\uff0c\u8fdb\u5165\u7684\u7b2c\u4e00\u4e2a\u72b6\u6001\u662f Detect \u72b6\u6001\u3002</p> <p>LTSSM \u603b\u5171\u6709 11 \u4e2a\u9876\u5c42\u72b6\u6001\uff0c\uff08\u6240\u8c13\u7684\u9876\u5c42\u72b6\u6001\uff0c\u5373\u4e0e\u9876\u5c42\u72b6\u6001\u4e0b\u7684\u6b21\u72b6\u6001\u533a\u5206\uff09\uff0c\u4ed6\u4eec\u5206\u522b\u662f\uff1a</p> <ul> <li>Detect</li> <li>Polling</li> <li>Configuration</li> <li>Recovery</li> <li>L0\u3001L0s\u3001L1\u3001L2</li> <li>Hot Reset</li> <li>Loopback</li> <li>Disable</li> </ul> <p>\u4ed6\u4eec\u53ef\u4ee5\u5212\u5206\u4e3a\u4e94\u5927\u7c7b\uff1a</p> <ul> <li>\u94fe\u8def\u8bad\u7ec3\u72b6\u6001</li> <li>\u91cd\u8bad\u7ec3\u72b6\u6001\uff0c\u5373 Recovery</li> <li>\u8f6f\u4ef6\u9a71\u52a8\u7684\u7535\u6e90\u7ba1\u7406\u72b6\u6001</li> <li>\u4e3b\u52a8\u7535\u6e90\u7ba1\u7406\uff08ASPM\uff0cActive-State Power Management\uff09\u72b6\u6001\uff08\u5373\u786c\u4ef6\u9a71\u52a8\u7684\u7535\u6e90\u7ba1\u7406\u72b6\u6001\uff09</li> <li>\u5176\u4ed6\u72b6\u6001</li> </ul> <p>\u5728\u4efb\u610f\u590d\u4f4d\u91ca\u653e\u540e\uff0cLTSSM \u5373\u8fdb\u5165\u4e86**\u8bad\u7ec3\u7c7b\u72b6\u6001**\uff08Link Training states\uff09\uff0c\u4e00\u5207\u6b63\u5e38\u7684\u8bdd\uff0c\u4f1a\u6309\u7167 Detect =&gt; Polling =&gt; Configuration =&gt; L0 \u7684\u987a\u5e8f\u8df3\u8f6c\u72b6\u6001\u3002\u5f85\u8fdb\u5165 L0 \u72b6\u6001\u540e\uff0c\u5373\u53ef\u4ee5\u8fdb\u884c\u6b63\u5e38\u7684\u6570\u636e\u62a5\u6587\u6536\u53d1\u64cd\u4f5c\u3002</p> <p>\u8fdb\u5165**\u94fe\u8def\u91cd\u8bad\u7ec3\u72b6\u6001**\uff0c\u4e5f\u5373\u662f\u94fe\u8def\u6062\u590d\uff08Recovery\uff09 \u72b6\u6001\u7684\u539f\u56e0\u5f88\u591a\uff0c\u6bd4\u5982\u4ece\u50cf L1 \u8fd9\u6837\u7684**\u4f4e\u529f\u8017\u94fe\u8def\u72b6\u6001\uff08low-power Link state\uff09**\u4e2d\u6062\u590d\uff0c\u6216\u8005\u6b63\u51c6\u5907\u8fdb\u884c\u94fe\u8def\u5e26\u5bbd\u5207\u6362\uff08\u901f\u7387\u6216\u8005\u94fe\u8def\u5bbd\u5ea6\u5207\u6362\uff09\u3002\u5728\u94fe\u8def\u91cd\u8bad\u7ec3\u72b6\u6001\u4e2d\uff0c\u94fe\u8def\u4f1a\u91cd\u590d\u7c7b\u4f3c\u4e8e\u8bad\u7ec3\u72b6\u6001\u7684\u64cd\u4f5c\uff0c\u6765\u89e3\u51b3\u94fe\u8def\u4e2d\u7684\u95ee\u9898\uff0c\u5e76\u6700\u7ec8\u56de\u5230 L0\uff0c\u8fd9\u4e00\u6b63\u5e38\u5de5\u4f5c\u7684\u72b6\u6001\u3002</p> <p>\u8bbe\u5907\u4e2d\u7684\u529f\u8017\u7ba1\u7406\u8f6f\u4ef6\u5728\u8fdb\u5165**\u4f4e\u529f\u8017\u8bbe\u5907\u72b6\u6001\uff08low-power device state\uff09\u540e\uff0c\u6bd4\u5982 D1\u3001D2\u3001D3Hot \u6216\u8005 D3Cold \u4e4b\u540e\uff0c\u4f1a\u5f3a\u5236\u94fe\u8def\u8fdb\u5165**\u4f4e\u529f\u8017\u8f6f\u4ef6\u7ba1\u7406\u94fe\u8def\u72b6\u6001\uff08low-power Management Link state\uff09\uff0c\u6bd4\u5982 L1 \u6216\u8005 L2 \u3002</p> <p>\u8bd1\u6ce8\uff1a\u6ce8\u610f\u533a\u5206\u8fd9\u91cc\u7684**\u4f4e\u529f\u8017\u8bbe\u5907\u72b6\u6001\uff08low-power device state\uff09\u4e0e**\u4f4e\u529f\u8017\u94fe\u8def\u72b6\u6001\uff08low-power Link state\uff09</p> <p>\u5982\u679c\u94fe\u8def\u4e0a\u5f88\u957f\u65f6\u95f4\u90fd\u6ca1\u6709\u62a5\u6587\u9700\u8981\u53d1\u9001\uff0cASPM \u786c\u4ef6\u903b\u8f91\u4f1a\u4f7f\u94fe\u8def\u81ea\u52a8\u8fdb\u5165\u4f4e\u529f\u8017 ASPM \u72b6\u6001\uff08low-power ASPM Link state\uff09\uff0c\u6bd4\u5982 L0s \u6216\u8005 ASPM L1\u3002</p> <p>\u6b64\u5916\uff0c\u8f6f\u4ef6\u53ef\u4ee5\u76f4\u63a5\u4f7f\u94fe\u8def\u8fdb\u5165\u4e00\u4e9b\u5176\u4ed6\u72b6\u6001\uff0c\u6bd4\u5982\u7981\u7528\u72b6\u6001\uff08Disabled\uff09\uff0c\u56de\u73af\u72b6\u6001\uff08Loopback\uff09\u6216\u8005\u70ed\u590d\u4f4d\uff08Hot Reset\uff09\u72b6\u6001\u3002\u8fd9\u91cc\uff0c\u8fd9\u4e9b\u72b6\u6001\u88ab\u5f52\u7eb3\u4e3a**\u5176\u4ed6\u72b6\u6001**\u3002</p> <p></p> <p>\u56fe 14-6 LTSSM \u72b6\u6001\u8df3\u8f6c\u56fe</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1432-ltssm","title":"14.3.2 LTSSM \u72b6\u6001\u6982\u8981\uff08\u94fe\u8def\u8bad\u7ec3\u4e0e\u72b6\u6001\u72b6\u6001\u673a\u72b6\u6001\u6982\u8981\uff09","text":"<p>\u4ee5\u4e0b\u662f\u5bf9 11 \u4e2a LTSSM \u72b6\u6001\u7684\u9ad8\u5c42\u6b21\u6982\u8981\u4ecb\u7ecd\u3002</p> <ul> <li> <p>\u68c0\u6d4b\u72b6\u6001 Detect\uff1a \u590d\u4f4d\u91ca\u653e\u540e\u8fdb\u5165\u7684\u521d\u59cb\u72b6\u6001\u3002\u5728\u8fd9\u4e2a\u72b6\u6001\u4e2d\uff0c\u672c\u65b9\u8bbe\u5907\u4ece\u7535\u6c14\u7279\u6027\u7684\u89d2\u5ea6\uff0c\u68c0\u6d4b\u94fe\u8def\u5bf9\u7aef\u8bbe\u5907\u662f\u5426\u5b58\u5728\u3002\u5728\u7a7f\u884c\u4f20\u8f93\u7684\u9886\u57df\u4e2d\uff0c\u4e00\u822c\u65e0\u9700\u68c0\u6d4b\u5bf9\u7aef\u8bbe\u5907\u662f\u5426\u5b58\u5728\uff0c\u4f46\u662f\u8bbe\u7f6e Detect \u72b6\u6001\u7684\u76ee\u7684\u5728\u4e8e\u589e\u52a0\u6d4b\u8bd5\u7684\u4fbf\u5229\u6027\uff08It's done to facilitate testing\uff09\uff0c\u6211\u4eec\u5c06\u5728 Detect \u4e4b\u540e\u7684 Polling \u9636\u6bb5\u9a8c\u8bc1\u8fd9\u4e00\u89c2\u70b9\u3002\u9664\u4e86\u590d\u4f4d\u91ca\u653e\u4e4b\u5916\uff0c\u8fd8\u53ef\u80fd\u4ece\u522b\u7684 LTSSM \u72b6\u6001\u8fdb\u5165 Detect\u3002</p> </li> <li> <p>\u8f6e\u8be2\u72b6\u6001 Polling\uff1a\u5728\u8f6e\u8be2\u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u65b9\u5c06\u4ee5 2.5Gbps \u7684\u901f\u7387\u5411\u5bf9\u7aef\u53d1\u9001 TS1 \u4ee5\u53ca TS2 \u5e8f\u5217\uff0c\u4f7f\u7528\u534f\u8bae\u6700\u4f4e\u901f\u7387\u4ee5\u5b9e\u73b0\u5bf9\u65e9\u671f\u534f\u8bae\u7684\u540e\u5411\u517c\u5bb9\u3002\u63a5\u6536\u7aef\u53ef\u4ee5\u4f7f\u7528\u63a5\u6536\u7684 TS\u00bd \u5e8f\u5217\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a</p> </li> <li> <p>\u5b8c\u6210\u4f4d\u9501\u5b9a</p> </li> <li>\u5b8c\u6210\u7b26\u53f7\u9501\u5b9a\u6216\u8005\u5757\u9501\u5b9a\uff08Gen3\uff09</li> <li>\u5982\u6709\u5fc5\u8981\uff0c\u6821\u6b63\u901a\u9053\u6781\u6027\u7ffb\u8f6c</li> <li>\u5f97\u77e5\u901a\u9053\u652f\u6301\u7684\u94fe\u8def\u6570\u636e\u901f\u7387</li> <li> <p>\u5728\u6d4b\u8bd5\u6761\u4ef6\u4e0b\uff0c\u53d1\u8d77\u517c\u5bb9\u6027\u6d4b\u8bd5\u5e8f\u5217\uff1a\u4e4b\u6240\u4ee5\u80fd\u591f\u8fdb\u5165\u517c\u5bb9\u6027\u6d4b\u8bd5\u6a21\u5f0f\uff0c\u662f\u56e0\u4e3a\u5982\u679c\u4e00\u4e2a\u63a5\u6536\u65b9\u5728 Detect \u9636\u6bb5\u80fd\u591f\u88ab\u8bc6\u522b\uff0c\u4f46\u662f\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u6d41\u91cf\uff0c\u94fe\u8def\u80fd\u591f\u51ed\u501f\u8fd9\u4e2a\u73b0\u8c61\u5c06\u5bf9\u7aef\u8bc6\u522b\u4e3a\u4e00\u4e2a\u6d4b\u8bd5\u8d1f\u8f7d\uff08Test load\uff09\u3002\u5728\u8bc6\u522b\u5bf9\u7aef\u4e3a\u6d4b\u8bd5\u8d1f\u8f7d\u540e\uff0c\u53d1\u9001\u65b9\u4f1a\u53d1\u9001\u7279\u5b9a\u7684\u517c\u5bb9\u6d4b\u8bd5\u56fe\u6837\uff08Pattern\uff09\uff0c\u4ee5\u65b9\u4fbf\u6d4b\u8bd5\u3002\u8fd9\u9879\u7279\u6027\u80fd\u591f\u4f7f\u6d4b\u8bd5\u8bbe\u5907\u5feb\u901f\u5730\u9a8c\u8bc1\u94fe\u8def\u7684\u7535\u538b\u3001BER\uff08Bit Error Ratio\uff09\u3001\u65f6\u5e8f\u4ee5\u53ca\u5176\u4ed6\u6307\u6807\u5728\u94fe\u8def\u5bb9\u5fcd\u8303\u56f4\u4e4b\u5185\u3002</p> </li> <li> <p>\u914d\u7f6e\u72b6\u6001 Configuration\uff1a\u4e0a\u6e38\uff08Upstream\uff09\u548c\u4e0b\u6e38\uff08Downstream\uff09\u5668\u4ef6\u5c06\u5206\u522b\u6309\u7167\u4ed6\u4eec\u4e0a\u4e0b\u6e38\u7684\u89d2\u8272\uff0c\u4ee5 2.5Gbps \u901f\u7387\uff0c\u4ea4\u6362 TS1 \u548c TS2 \u5e8f\u5217\uff0c\u6765\u5b9e\u73b0\u4ee5\u4e0b\u7684\u76ee\u6807\uff1a</p> </li> <li> <p>\u534f\u5546\u51b3\u5b9a\u94fe\u8def\u7684\u5bbd\u5ea6</p> </li> <li>\u4e3a\u5404\u901a\u9053\u6307\u6d3e\u7f16\u53f7</li> <li>\u68c0\u6d4b\u901a\u9053\u662f\u5426\u9700\u8981\u987a\u5e8f\u6216\u8005\u6781\u6027\u4ea4\u6362\uff0c\u5728\u672c\u5730\u6062\u590d\u8fd9\u4e9b\u4ea4\u6362</li> <li>\u8865\u507f\u5404\u4e2a\u901a\u9053\u4e4b\u95f4\u7684\u65f6\u5e8f\u504f\u659c</li> </ul> <p>\u4ece\u8fd9\u4e2a\u72b6\u6001\u5f00\u59cb\uff0c\u53ef\u4ee5\u5173\u95ed\u52a0\u6270\uff0c\u5e76\u53ef\u8fdb\u5165 Disable \u6216\u8005 Loopback \u72b6\u6001\u3002\u6b64\u5916\uff0c\u4f1a\u8bb0\u5f55\u5728 TS1 \u548c TS2 \u5e8f\u5217\u4ea4\u6362\u65f6\u8fbe\u6210\u5171\u8bc6\u7684 N_FTS\uff0c\u4e5f\u5c31\u662f\u4ece L0s \u72b6\u6001\u8fdb\u5165 L0 \u72b6\u6001\u6240\u9700\u7684 FTS \u5e8f\u5217\u6570\u91cf\u3002</p> <ul> <li> <p>L0 \u72b6\u6001\uff1aL0 \u662f\u4e00\u4e2a\u94fe\u8def\u5168\u529f\u80fd\u6b63\u5e38\u8fd0\u884c\u7684\u72b6\u6001\uff0c\u6b64\u65f6\u94fe\u8def\u4e0a\u4f1a\u8fdb\u884c\u6b63\u5e38\u7684 TLP\u3001DLLP \u62a5\u6587\u548c\u6709\u5e8f\u96c6\u7684\u4ea4\u6362\u3002L0 \u72b6\u6001\u4e0b\uff0c\u94fe\u8def\u7684\u901f\u7387\u53ef\u4ee5\u6bd4 2.5GT/s \u66f4\u9ad8\uff0c\u4f46\u53ea\u80fd\u5728\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u7ecf\u5386\u4e00\u6b21\u94fe\u8def\u901f\u7387\u53d8\u5316\u7a0b\u5e8f\u4e4b\u540e\uff0c\u624d\u80fd\u5207\u6362\u5230\u66f4\u9ad8\u7684\u901f\u7387\u3002</p> </li> <li> <p>\u6062\u590d\u72b6\u6001 Recovery\uff1a\u5f53\u94fe\u8def\u9700\u8981\u91cd\u8bad\u7ec3\u65f6\uff0c\u4f1a\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u8fd9\u53ef\u80fd\u662f\u4ee5\u4e0b\u539f\u56e0\u5bfc\u81f4\u7684\uff1aL0 \u72b6\u6001\u4e2d\u53d1\u751f\u4e86\u9519\u8bef\u3001\u4ece L1 \u4f4e\u529f\u8017\u72b6\u6001\u4e2d\u6062\u590d\u5230 L0 \u5168\u529f\u80fd\u6b63\u5e38\u72b6\u6001\u3001\u4ece L0s \u72b6\u6001\u6062\u590d\u5230 L0 \u65f6\uff0c\u65e0\u6cd5\u901a\u8fc7 FTS \u5e8f\u5217\u91cd\u65b0\u5b8c\u6210\u8bad\u7ec3\u3002\u5728 Recovery \u72b6\u6001\u4e2d\uff0c\u4f1a\u91cd\u65b0\u8fdb\u884c\u6bd4\u7279\u9501\u5b9a\u548c\u5b57\u7b26/\u5757\u9501\u5b9a\uff0c\u9501\u5b9a\u7684\u8fc7\u7a0b\u548c Polling \u72b6\u6001\u4e2d\u7684\u90a3\u6b21\u76f8\u540c\uff0c\u4f46\u662f\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u6b21\u9501\u5b9a\u7684\u8fc7\u7a0b\u4f1a\u66f4\u5feb\u3002</p> </li> <li> <p>L0s \u72b6\u6001\uff1aL0s \u662f\u4e00\u4e2a\u7531\u786c\u4ef6\u63a7\u5236\u7684 ASPM \u4f4e\u529f\u8017\u72b6\u6001\uff0cL0s \u72b6\u6001\u7684\u76ee\u6807\u662f\u5728\u8282\u7ea6\u4e00\u5b9a\u529f\u8017\u7684\u540c\u65f6\uff0c\u80fd\u591f\u5feb\u901f\u5730\u6062\u590d\u5230 L0 \u72b6\u6001\u3002\u8fdb\u5165 L0s \u7684\u6761\u4ef6\u662f\uff0c\u5728 L0 \u72b6\u6001\u4e0b\uff0c\u94fe\u8def\u5176\u4e2d\u4e00\u65b9\u53d1\u9001 EIOS \u5e8f\u5217\u3002\u9000\u51fa L0s \u72b6\u6001\u65f6\uff0c\u4f1a\u901a\u8fc7 FTS \u5e8f\u5217\u91cd\u65b0\u5b8c\u6210\u6bd4\u7279\u548c\u5b57\u7b26/\u5757\u9501\u5b9a\u3002</p> </li> <li> <p>L1 \u72b6\u6001\uff1aL1 \u72b6\u6001\u80fd\u591f\u6bd4 L0s \u72b6\u6001\u964d\u4f4e\u66f4\u591a\u7684\u529f\u8017\uff0c\u4ee3\u4ef7\u5728\u4e8e\u9700\u8981\u66f4\u957f\u7684\u65f6\u95f4\u6062\u590d\u81f3 L0 \u72b6\u6001\uff08\u8be6\u89c1\u539f\u6587 735 \u9875\u7684  \u201cActive State Power Management (ASPM)\u201d \u8282 \uff09\u3002\u8fdb\u5165 L1 \u72b6\u6001\u9700\u8981\u94fe\u8def\u53cc\u65b9\u8fdb\u884c\u534f\u5546\uff0c\u5e76\u4e00\u8d77\u8fdb\u5165 L1 \u72b6\u6001\u3002\u5c1d\u8bd5\u8fdb\u5165 L1 \u72b6\u6001\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> </li> <li> <p>\u4e00\u79cd\u60c5\u51b5\u662f\u5728 ASPM \u7684\u63a7\u5236\u4e0b\uff0c\u81ea\u52a8\u8fdb\u5165 L1\u3002\u5f53\u4e0a\u6e38\u7aef\u53e3\u6ca1\u6709\u7b49\u5f85\u8c03\u5ea6\u53d1\u9001\u7684 TLP \u6216\u8005 DLLP \u62a5\u6587\u65f6\uff0c\u786c\u4ef6\u903b\u8f91\u5c06\u81ea\u52a8\u4e0e\u4e0b\u6e38\u7aef\u53e3\u534f\u5546\uff0c\u4e00\u8d77\u5c06\u94fe\u8def\u8f6c\u4e3a L1 \u72b6\u6001\u3002\u5982\u679c\u4e0b\u6e38\u7aef\u53e3\u540c\u610f\uff0c\u90a3\u4e48\u94fe\u8def\u8fdb\u5165 L1 \u72b6\u6001\u3002\u5426\u5219\uff0c\u4e0a\u6e38\u7aef\u53e3\u5c06\u5355\u65b9\u9762\u8fdb\u5165 L0s \u72b6\u6001\uff08\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\uff09\u3002</p> </li> <li> <p>\u53e6\u4e00\u79cd\u60c5\u51b5\u662f\u529f\u8017\u7ba1\u7406\u8f6f\u4ef6\u547d\u4ee4\u8bbe\u5907\u8fdb\u5165\u4f4e\u529f\u8017\u72b6\u6001\uff08D1\uff0cD2 \u6216\u8005 D3Hot\uff09\uff0c\u56e0\u6b64\uff0c\u4e0a\u6e38\u7aef\u53e3\u901a\u77e5\u4e0b\u6e38\u7aef\u53e3\u4ed6\u4eec\u5fc5\u987b\u4e00\u8d77\u8fdb\u5165 L1 \u72b6\u6001\uff0c\u4e0b\u6e38\u7aef\u53e3\u4f1a\u54cd\u5e94\u8be5\u901a\u77e5\uff0c\u94fe\u8def\u8fdb\u5165 L1 \u72b6\u6001\u3002</p> </li> <li> <p>L2 \u72b6\u6001\uff1aL2 \u72b6\u6001\u662f\u66f4\u663e\u8457\u7684\u529f\u8017\u8282\u7ea6\u72b6\u6001\uff0c\u56e0\u4e3a\u6b64\u65f6\u8bbe\u5907\u7684\u4e3b\u7535\u6e90\u90fd\u5c06\u88ab\u5207\u65ad\u3002L2 \u4e2d\uff0c\u5927\u90e8\u5206\u7684\u903b\u8f91\u90fd\u4f1a\u56e0\u4e3a\u6ca1\u6709\u7535\u6e90\u4f9b\u5e94\u800c\u5173\u95ed\uff0c\u53ea\u662f\u5c11\u90e8\u5206\u54cd\u5e94\u5524\u9192\u4e8b\u4ef6\u7684\u903b\u8f91\u4f1a\u4f9d\u9760\u8f85\u52a9\u7535\u6e90 Vaux \u7ee7\u7eed\u5de5\u4f5c\u3002\u62e5\u6709\u5524\u9192\u80fd\u529b\u7684\u4e0a\u6e38\u7aef\u53e3\u4f1a\u53d1\u9001\u4f4e\u9891\u7684 Beacon \u4fe1\u53f7\uff0c\u4e0b\u6e38\u7aef\u53e3\u80fd\u591f\u5c06\u5176\u8f6c\u53d1\u7ed9 RC\uff0c\u544a\u77e5\u4e0a\u5c42\u7cfb\u7edf\u3002\uff08\u8be6\u60c5\u53ef\u89c1\u539f\u6587 483 \u9875\u7684 \"Beacon Signaling\" \u8282\uff09\u901a\u8fc7 Beacon \u4fe1\u53f7\u6216\u8005\u8fb9\u5e26\u4fe1\u53f7 WAKE#\uff0c\u8bbe\u5907\u80fd\u591f\u89e6\u53d1\u7cfb\u7edf\u5524\u9192\u4e8b\u4ef6\uff0c\u4f7f\u4e3b\u7535\u6e90\u6062\u590d\u3002[\u53e6\u5916\u8fd8\u5b58\u5728\u6709 L3 \u72b6\u6001\uff0c\u4e0d\u8fc7 L3 \u72b6\u6001\u548c LTSSM \u5c31\u6ca1\u6709\u5173\u7cfb\u4e86\u3002 L3 \u72b6\u6001\u4e0b\u6240\u6709\u7535\u6e90\u90fd\u4f1a\u88ab\u5207\u65ad \uff0c\u5305\u62ec\u4e3b\u7535\u6e90\u548c\u8f85\u52a9\u7535\u6e90\uff0c\u56e0\u6b64 L3 \u72b6\u6001\u4e0b\u4e0d\u4f1a\u54cd\u5e94\u5524\u9192\u4e8b\u4ef6\u3002]</p> </li> <li> <p>\u56de\u73af\u72b6\u6001 Loopback\uff1a\u56de\u73af\u72b6\u6001\u5b9a\u4e49\u4e3a\u4e00\u79cd\u6d4b\u8bd5\u72b6\u6001\uff0c\u4f46\u662f\u534f\u8bae\u4e2d\u6ca1\u6709\u8be6\u7ec6\u5b9a\u4e49\u63a5\u6536\u65b9\u7684\u884c\u4e3a\uff08\u6bd4\u5982\u63a5\u6536\u65b9\u54ea\u4e9b\u903b\u8f91\u4f1a\u53c2\u4e0e\u56de\u73af\u6d4b\u8bd5\uff09\u3002\u56de\u73af\u72b6\u6001\u4e2d\u57fa\u672c\u7684\u884c\u4e3a\u5f88\u7b80\u5355\uff1a\u56de\u73af\u53d1\u8d77\u65b9\uff08Loopback Master\uff09\u53d1\u9001 TS1 \u6709\u5e8f\u96c6\u7ed9\u56de\u73af\u63a5\u6536\u65b9\uff08Slave\uff09\uff0c\u5e76\u7f6e\u4f4d TS1 \u8bad\u7ec3\u63a7\u5236\u5b57\u6bb5\uff08Training Control\uff09\u4e2d\u7684\u56de\u73af\uff08Loopback\uff09\u6bd4\u7279\u3002\u5f53\u63a5\u6536\u65b9\u8fde\u7eed\u63a5\u6536 2 \u4e2a \u56de\u73af\u6bd4\u7279\u7f6e\u8d77\u7684 TS1 \u5e8f\u5217\u540e\uff0c\u8fdb\u5165\u56de\u73af\u72b6\u6001\uff0c\u5c06\u63a5\u6536\u5230\u7684\u4efb\u4f55\u5185\u5bb9\u90fd\u91cd\u65b0\u53d1\u9001\u7ed9\u53d1\u8d77\u65b9\u3002\u53d1\u8d77\u65b9\u4f1a\u68c0\u67e5\u63a5\u6536\u5230\u7684\u5185\u5bb9\uff0c\u548c\u5148\u524d\u53d1\u9001\u7684\u5185\u5bb9\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u5185\u5bb9\u7ecf\u8fc7\u53cc\u65b9\u7684 8b/10b \u7f16\u7801\uff08\u89e3\u7801\uff09\u540e\u6821\u9a8c\u4e00\u81f4\uff0c\u8bf4\u660e\u94fe\u8def\u53ef\u4ee5\u901a\u8fc7\u73af\u8def\u9a8c\u8bc1\uff0c\u5b8c\u6574\u6027\u6ca1\u6709\u95ee\u9898\u3002</p> </li> <li> <p>\u7981\u7528\u72b6\u6001 Disable\uff1aDisable \u72b6\u6001\u5141\u8bb8\u5c06\u94fe\u8def\u914d\u7f6e\u4e3a\u7981\u7528\u72b6\u6001\uff0c\u8be5\u72b6\u6001\u4e0b\u53d1\u9001\u903b\u8f91\u4e3a\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u63a5\u6536\u903b\u8f91\u4e3a\u4f4e\u963b\u72b6\u6001\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6bd4\u5982\u94fe\u8def\u72b6\u6001\u53d8\u5f97\u4e0d\u53ef\u9760\uff0c\u6216\u8005\u5bf9\u7aef\u8bbe\u5907\u88ab\u610f\u5916\u79fb\u9664\uff0c\u6b64\u65f6 Disable \u662f\u8868\u793a\u8fd9\u4e9b\u610f\u5916\u60c5\u51b5\u7684\u5fc5\u8981\u72b6\u6001\u3002\u53e6\u5916\uff0c\u8f6f\u4ef6\u4e5f\u53ef\u4ee5\u901a\u8fc7\u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668\uff08Link Control Register\uff09\u4e2d\u7684\u7981\u7528\u6bd4\u7279\uff08Disable bit\uff09\uff0c\u5c06\u8bbe\u5907\u914d\u7f6e\u4e3a\u7981\u7528\u72b6\u6001\u3002\u8bbe\u5907\u88ab\u7981\u7528\u540e\uff0c\u4f1a\u8fde\u7eed\u53d1\u9001 16 \u4e2a\u94fe\u8def\u7981\u7528\u6bd4\u7279\uff08Disable Link bit\uff09\u7f6e\u4f4d\u7684 TS1 \u5e8f\u5217\uff0c\u4f4d\u4e8e TS1 \u7684\u8bad\u7ec3\u63a7\u5236\u57df\uff08Traning Control Field\uff09\uff0c\u901a\u77e5\u63a5\u6536\u65b9\u8fdb\u5165\u7981\u7528\u72b6\u6001\u3002</p> </li> <li> <p>\u70ed\u590d\u4f4d\u72b6\u6001 Hot Reset\uff1a\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u7f6e\u4f4d\u6865\u63a7\u5236\uff08Bridge Control\uff09\u5bc4\u5b58\u5668\u7684\u914d\u7f6e\u6b21\u7ea7\u603b\u7ebf\u590d\u4f4d\uff08Secondary Bus Reset\uff09\u6bd4\u7279\uff0c\u590d\u4f4d\u94fe\u8def\u3002\u8f6f\u4ef6\u914d\u7f6e\u540e\uff0c\u6865\u7684\u4e0b\u6e38\u7aef\u53e3\u4f1a\u53d1\u9001\u8bad\u7ec3\u63a7\u5236\u57df\uff08Traning Control Field\uff09\u70ed\u590d\u4f4d\uff08Hot Reset\uff09\u6bd4\u7279\u7f6e\u4f4d\u7684 TS1 \u5e8f\u5217\u3002\uff08\u8be6\u60c5\u53ef\u89c1\u539f\u6587 837 \u9875\u7684 \u201cHot Reset (In-band Reset)\u201d \u8282\uff09\u5f53\u63a5\u6536\u65b9\u63a5\u6536\u5230\u4e24\u4e2a TS1 \u5e8f\u5217\u540e\uff0c\u5fc5\u987b\u590d\u4f4d\u81ea\u8eab\u8bbe\u5907\u3002</p> </li> </ul>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1433","title":"14.3.3 \u4ecb\u7ecd\uff0c\u793a\u4f8b\u4e0e\u72b6\u6001/\u6b21\u72b6\u6001","text":"<p>\u672c\u7ae0\u5269\u4f59\u7684\u5185\u5bb9\u4f1a\u5bf9\u6bcf\u4e2a LTSSM \u72b6\u6001\u8fdb\u884c\u4ecb\u7ecd\u548c\u8ba8\u8bba\u3002\u57fa\u4e8e\u6bcf\u79cd\u72b6\u6001\u4e0d\u540c\u7684\u590d\u6742\u5ea6\uff0c\u8ba8\u8bba\u4f1a\u5305\u62ec\u4e00\u4e9b\u4ecb\u7ecd\uff0c\u901a\u7528\u7684\u80cc\u666f\u77e5\u8bc6\uff0c\u90e8\u5206\u72b6\u6001/\u6b21\u72b6\u6001\u8fd8\u4f1a\u6709\u5bf9\u5e94\u7684\u793a\u4f8b\u3002\u57fa\u4e8e\u5177\u4f53\u7684\u9700\u6c42\uff0c\u8bfb\u8005\u53ef\u4ee5\u53ea\u6d4f\u89c8\u67d0\u4e2a\u72b6\u6001\u7b80\u4ecb\u7684\u90e8\u5206\uff0c\u800c\u8df3\u8fc7\u8be6\u7ec6\u8ba8\u8bba\u7684\u90e8\u5206\uff0c\u672c\u7ae0\u7684\u7ec4\u7ec7\u7ed3\u6784\u662f\u5b8c\u5168\u652f\u6301\u8bfb\u8005\u8fd9\u4e48\u505a\u7684\u3002</p> <p>\u6bcf\u4e2a\u8bbe\u5907\u90fd\u5fc5\u987b\u4ee5\u57fa\u7840\u7684 2.5GT/S \u901f\u7387\uff0c\u8fdb\u884c\u521d\u59cb\u94fe\u8def\u8bad\u7ec3\u3002\u56fe 14-7 \u9ad8\u4eae\u4e86\u521d\u59cb\u94fe\u8def\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u6d89\u53ca\u7684\u72b6\u6001\u3002\u652f\u6301\u66f4\u9ad8\u901f\u7387 5.0 \u6216\u8005 8.0 GT/s \u7684\u8bbe\u5907\uff0c\u5fc5\u987b\u8fdb\u884c Recovery \u72b6\u6001\uff0c\u624d\u80fd\u591f\u8fdb\u884c\u901f\u7387\u5207\u6362\u3002</p> <p></p> <p>\u56fe 14-7 2.5Gb/s \u901f\u7387\u4e0b\uff0c\u521d\u59cb\u94fe\u8def\u8bad\u7ec3\u6d89\u53ca\u7684\u72b6\u6001</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#144-detect-state","title":"14.4 Detect State // \u68c0\u6d4b\u72b6\u6001","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1441","title":"14.4.1 \u7b80\u4ecb","text":"<p>\u56fe 14-8 \u5c55\u793a\u4e86\u4e0e Detect \u72b6\u6001\u76f8\u5173\u7684\u72b6\u6001\u8df3\u53d8\uff0c\u4ee5\u53ca Detect \u72b6\u6001\u7684 2 \u4e2a\u6b21\u72b6\u6001\u3002 Detect \u72b6\u6001\u4e0b\u7684\u94fe\u8def\u884c\u4e3a\u662f\u53d1\u9001\u65b9\u4e0d\u65ad\u68c0\u6d4b\u94fe\u8def\u5bf9\u7aef\u662f\u5426\u6709\u63a5\u6536\u65b9\u5b58\u5728\u3002\u56e0\u4e3a Detect \u53ea\u6709 2 \u4e2a\u6b21\u72b6\u6001\uff0c\u6240\u4ee5\u884c\u4e3a\u6bd4\u8f83\u7b80\u5355\uff0c\u672c\u8282\u5c31\u76f4\u63a5\u8ba8\u8bba\u4e24\u4e2a\u6b21\u72b6\u6001\u7684\u7ec6\u8282\uff0c\u4e0d\u518d\u8ba8\u8bba Detect \u72b6\u6001\u672c\u8eab\u4e86\u3002</p> <p></p> <p>\u56fe 14-8 \u68c0\u6d4b\u72b6\u6001\u673a</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1441-detect","title":"14.4.1 Detect \u6b21\u72b6\u6001\u7ec6\u8282\u8ba8\u8bba","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14411-detectquiet","title":"14.4.1.1 Detect.Quiet","text":"<p>Quiet \u6b21\u72b6\u6001\u662f\u9664\u4e86\u529f\u80fd\u7ea7\u590d\u4f4d\uff08FLR\uff0cFunction Level Reset\uff09\u4e4b\u5916\u6240\u6709\u590d\u4f4d\u4e4b\u540e\u7684\u521d\u59cb\u72b6\u6001\uff0c\u4ee5\u53ca\u4e0a\u7535\u4e8b\u4ef6\uff08Power-up\uff09\u4e4b\u540e\u7684\u521d\u59cb\u72b6\u6001\u3002\u5e76\u4e14\uff0c\u534f\u8bae\u89c4\u5b9a\u5fc5\u987b\u5728\u590d\u4f4d\u4e4b\u540e\u7684 20ms \u5185\u8fdb\u5165\u8be5\u72b6\u6001\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u80fd\u4ece\u5176\u4ed6\u72b6\u6001\u8fdb\u5165 Detect \u72b6\u6001\uff0c\u5f80\u5f80\u662f\u56e0\u4e3a\u5728\u8fd9\u4e9b\u72b6\u6001\u4e2d\u9047\u5230\u4e86\u963b\u788d\uff0c\u65e0\u6cd5\u6b63\u5e38\u8fdb\u5165\u4e0b\u4e00\u4e2a\u72b6\u6001\uff0c\u53ea\u80fd\u8fdb\u5165 Quiet \u6b21\u72b6\u6001\u3002\uff08\u56fe 14-8 \u4e2d\u63cf\u8ff0\u4e86\u8fd9\u4e9b\u72b6\u6001\uff0c\u4ed6\u4eec\u5305\u62ec\uff1aDisabled\uff0cLoopback\uff0cL2\uff0cPolling\uff0cConfiguration \u6216\u8005 Recovery\uff09Quiet \u6b21\u72b6\u6001\u7684\u5c5e\u6027\u6709\u4ee5\u4e0b\u8fd9\u4e9b\uff1a</p> <ul> <li>\u53d1\u9001\u673a\u4ee5\u7535\u6c14\u7a7a\u95f2\uff08Electrical Idle\uff09\u7684\u72b6\u6001\u542f\u52a8\uff08\u4f46\u662f\u6b64\u65f6\u76f4\u6d41\u5171\u6a21\u7535\u538b\u4e0d\u9700\u8981\u5728\u901a\u5e38\u89c4\u5b9a\u7684\u8303\u56f4\u5185\uff09\u3002</li> <li>\u76ee\u6807\u6570\u636e\u901f\u7387\u4e3a Gen1 \u7684 2.5GT/s\u3002\u5982\u679c\u8fdb\u5165\u8be5\u72b6\u6001\u65f6\u7684\u901f\u7387\u4e0d\u662f  2.5GT/s\uff0cLTSSM \u5fc5\u987b\u8981\u5728\u8be5\u6b21\u72b6\u6001\u5185\u7b49\u5f85 1ms\uff0c\u7136\u540e\u518d\u5c06\u901f\u7387\u5207\u6362\u81f3 Gen1\u3002</li> <li>\u7269\u7406\u5c42\u7684\u72b6\u6001\u6bd4\u7279 LinkUp \u4e3a 0 \u65f6\uff0c\u5411\u6570\u636e\u94fe\u8def\u5c42\u8868\u793a\u94fe\u8def\u5c1a\u672a\u5c31\u7eea\u3002LinkUp \u72b6\u6001\u6bd4\u7279\u662f\u4e00\u4e2a\u5185\u90e8\u4fe1\u53f7\uff08\u6ca1\u6709\u89c1\u8bf8\u6807\u51c6\u914d\u7f6e\u7a7a\u95f4\uff09\uff0c\u540c\u6837\u5730\uff0c\u5728\u94fe\u8def\u8bad\u7ec3\u5b8c\u6210\u540e\uff0cLinkUp \u8f6c\u53d8\u4e3a 1 \uff0c\u901a\u77e5\u6570\u636e\u94fe\u8def\u5c42\u4ee5\u53ca\u6d41\u63a7\u903b\u8f91\u5f00\u59cb\u521d\u59cb\u5316\u3002\uff08\u8be6\u60c5\u53ef\u89c1\u539f\u6587 223 \u9875\u7684 \u201c\u6d41\u63a7\u521d\u59cb\u5316\u6d41\u7a0b\u201d\u8282\uff09</li> <li>\u4efb\u4f55\u5148\u524d\u7684\u5747\u8861\uff08Eq., Equalization\uff09\u72b6\u6001\u4f1a\u5728\u7f6e\u4f4d 4 \u4e2a 2-bit \u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\u540e\u6e05\u9664\uff0c\u4ed6\u4eec\u5206\u522b\u662f Eq.Phase \u00bd/3 Successful \u4ee5\u53ca Eq.Complete </li> <li>\u53d8\u91cf</li> <li>\u51e0\u4e2a\u53d8\u91cf\u4f1a\u5728 Quiet \u72b6\u6001\u6e05\u9664\uff1a<ul> <li>directed_speed_change = 0b</li> <li>upconfigure_capable = 0b</li> <li>equalization_done_8GT_data_rate=0b</li> <li>idle_to_rlock_transitioned=00h</li> <li>select_deemphasis \u53d8\u91cf\u7684\u5904\u7406\u65b9\u5f0f\u53d6\u51b3\u4e8e\u7aef\u53e3\u7684\u7c7b\u578b</li> <li>\u5bf9\u4e8e Upstream \u7aef\u53e3\uff0c\u53d8\u91cf\u7684\u503c\u7531\u786c\u4ef6\u6307\u5b9a</li> <li>\u5bf9\u4e8e Downstream \u7aef\u53e3\uff0c\u53d8\u91cf\u7684\u503c\u4f7f\u7528\u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668\u4e2d\u4fdd\u5b58\u7684 selectable Preset/Deemphasis \u7684\u503c</li> </ul> </li> <li>\u7531\u4e8e\u4e0a\u8ff0\u7684\u53d8\u91cf\u662f\u5728 PCIe 2.0 \u534f\u8bae\u4e4b\u540e\u5f15\u5165\u7684\uff0c\u4ec5\u652f\u6301\u66f4\u65e9\u671f\u534f\u8bae\u7684\u8bbe\u5907\u4e0d\u5b58\u5728\u8fd9\u4e9b\u503c\u3002\u5bf9\u4e8e\u8fd9\u4e9b\u8bbe\u5907\u6765\u8bf4\uff0c\u4ed6\u4eec\u7684\u884c\u4e3a\u76f8\u5f53\u4e8e <ul> <li>directed_speed_change = 0b</li> <li>upconfigure_capable = 0b</li> <li>idle_to_rlock_transitioned=FFh</li> </ul> </li> </ul> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 \"Detect.Active\"</p> <p>\u4e0b\u4e00\u4e2a\u6b21\u72b6\u6001\u662f Detect.Active\uff0c LTSSM \u4f1a\u5728 12ms \u8d85\u65f6\u6216\u8005\u4efb\u610f\u4e00\u4e2a\u901a\u9053\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u540e\uff0c\u8f6c\u5165\u4e0b\u4e00\u4e2a\u6b21\u72b6\u6001\u3002 </p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14412-detectactive","title":"14.4.1.2 Detect.Active","text":"<p>Active \u72b6\u6001\u7531 Quiet \u72b6\u6001\u8fdb\u5165\u3002\u5728 Active \u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u673a\u4f1a\u901a\u8fc7\u5c06\u76f4\u6d41\u5171\u6a21\u7535\u538b\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u5408\u7406\u8303\u56f4\u5185\u7684\u4efb\u610f\u7535\u538b\u503c\uff0c\u63a5\u7740\u518d\u7ee7\u7eed\u53d8\u5316\u8fd9\u4e2a\u7535\u538b\u503c\uff0c\u6765\u6d4b\u8bd5\u5404\u4e2a\u901a\u9053\u4e0a\u662f\u5426\u6709\u63a5\u6536\u7aef\u8fde\u63a5\u3002\u63a5\u6536\u7aef\u68c0\u6d4b\u903b\u8f91\u4f1a\u89c2\u6d4b\u7535\u538b\u53d8\u5316\u7684\u901f\u7387\uff0c\u4e5f\u5c31\u7535\u538b\u5145\u7535\u7684\u5355\u4f4d\u65f6\u95f4\uff0c\u5e76\u5c06\u5176\u4e8e\u5bf9\u7167\u503c\u6bd4\u8f83\u3002\u8fd9\u4e2a\u5bf9\u7167\u503c\u4e00\u822c\u662f\u6ca1\u6709\u63a5\u6536\u7aef\u8fde\u63a5\u7684\u60c5\u51b5\u3002\u5982\u679c\u6709\u63a5\u6536\u7aef\u8fde\u63a5\uff0c\u90a3\u4e48\u5145\u7535\u7684\u901f\u7387\u4f1a\u5927\u5927\u964d\u4f4e\uff0c\u4e24\u8005\u4e4b\u95f4\u5de8\u5927\u7684\u5dee\u8ddd\u4f7f\u68c0\u6d4b\u7684\u7ed3\u679c\u5341\u5206\u5bb9\u6613\u89c2\u5bdf\u5230\u3002\uff08\u5173\u4e8e\u8fd9\u90e8\u5206\u5185\u5bb9\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u53c2\u8003\u63a5\u6536\u7aef\u68c0\u6d4b\u7684\u7ae0\u8282\uff1aReceiver Detection\uff0c\u539f\u6587 460 \u9875\uff09\u3002\u4e3a\u4e86\u4fbf\u4e8e\u8868\u793a\uff0c\u4e0b\u6587\u4e2d\u5c06\u672c\u72b6\u6001\u4e2d\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\u7684\u901a\u9053\u79f0\u4e4b\u4e3a\uff1a\u68c0\u6d4b\u5b8c\u6210\u7684\u901a\u9053\uff08Detected lanes\uff09\u3002</p> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 \"Detect.Quiet\"</p> <p>\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u4e00\u4e2a\u901a\u9053\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\u5b58\u5728\uff0c\u90a3\u4e48\u4f1a\u8fd4\u56de Detect.Quiet \u72b6\u6001\u3002\u53ea\u8981\u6ca1\u6709\u68c0\u6d4b\u673a\uff0c\u72b6\u6001\u673a\u4f1a\u4e00\u76f4\u6bcf\u9694 12ms \u5728\u8fd9\u4e24\u4e2a\u6b21\u72b6\u6001\u4e4b\u95f4\u8fdb\u884c\u4e00\u4e2a\u5faa\u73af\u3002</p> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 \"Polling\"</p> <p>\u5982\u679c\u6240\u6709\u901a\u9053\u4e0a\u90fd\u6b63\u5e38\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\uff0c\u90a3\u4e48\u4f1a\u8fdb\u5165\u4e0b\u4e00\u4e2a\u72b6\u6001\uff1a\u8f6e\u8be2\u3002\u6b64\u65f6\u901a\u9053\u4e0a\u7684\u76f4\u6d41\u5171\u6a21\u7535\u538b\u5fc5\u987b\u5728 0-3.6V \uff08V TX-CM-DC\uff09</p> <p>\u7279\u6b8a\u60c5\u51b5</p> <p>\u5982\u679c\u53ea\u6709\u5176\u4e2d\u4e00\u4e9b\u901a\u9053\u68c0\u6d4b\u5230\u4e86\u63a5\u6536\u7aef\uff0c\u800c\u6709\u4e9b\u901a\u9053\u6ca1\u6709\uff08\u6bd4\u5982 x4 \u8bbe\u5907\u8fde\u63a5\u5230\u4e00\u4e2a x2 \u8bbe\u5907\u7684\u60c5\u51b5\uff09\uff0c\u90a3\u4e48\u5c06\u7b49\u5f85 12ms \u518d\u8fdb\u884c\u4e00\u6b21\u68c0\u6d4b\u3002\u5982\u679c\u68c0\u6d4b\u7684\u7ed3\u679c\u4ecd\u7136\u76f8\u540c\uff0c\u90a3\u4e48\u8fdb\u5165 Polling \u72b6\u6001\uff0c\u5426\u5219\u8fd4\u56de Detect.Quiet \u72b6\u6001\u3002\u5728 Polling \u72b6\u6001\u4e2d\uff0c\u5bf9\u4e8e\u90a3\u4e48\u6ca1\u6709\u63a5\u6536\u7aef\u7684\u901a\u9053\uff0c\u6709\u4e24\u79cd\u53ef\u80fd\u7684\u5904\u7406\u65b9\u5f0f\uff1a</p> <ol> <li>\u5982\u679c\u8fd9\u4e9b\u901a\u9053\u80fd\u591f\u4ee5\u72ec\u7acb\u7684\u901a\u9053\u8fd0\u4f5c\uff08\u89c1\u539f\u6587 541 \u9875\u7684 \u201c\u8bbe\u8ba1\u652f\u6301\u94fe\u8def\u805a\u5408\u8bbe\u5907\u201d \u8282\uff09\uff0c\u4f1a\u4f7f\u7528\u53e6\u4e00\u4e2a LTSSM \u5bf9\u8fd9\u4e9b\u901a\u9053\u91cd\u590d\u68c0\u6d4b\u8fc7\u7a0b\u3002</li> <li>\u5982\u679c\u4e0d\u5b58\u5728\u53e6\u4e00\u4e2a LTSSM\uff0c\u90a3\u4e48\u8fd9\u4e9b\u901a\u9053\u5c06\u4e0d\u4f1a\u662f\u94fe\u8def\u7684\u4e00\u90e8\u5206\uff0c\u9700\u8981\u8bbe\u7f6e\u4e3a\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</li> </ol>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#145-polling-state","title":"14.5 Polling State // \u8f6e\u8be2\u72b6\u6001","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1451","title":"14.5.1 \u7b80\u4ecb","text":"<p>LTSSM \u8fdb\u5165\u8f6e\u8be2\u72b6\u6001\u65f6\uff0c\u94fe\u8def\u5904\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u4e0d\u8fc7\uff0c\u8f6e\u8be2\u72b6\u6001\u671f\u95f4\u4f1a\u5728\u94fe\u8def\u4e24\u7aef\u4e4b\u95f4\u4ea4\u6362 TS1 \u548c TS2 \u6709\u5e8f\u96c6\u3002\u8f6e\u8be2\u72b6\u6001\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4f7f\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u80fd\u591f\u542c\u61c2\u5bf9\u65b9\u5728\u8bf4\u4e9b\u4ec0\u4e48\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u4ed6\u4eec\u9700\u8981\u5404\u81ea\u5728\u5bf9\u65b9\u7684\u53d1\u9001\u6bd4\u7279\u6d41\u4e0a\uff0c\u5efa\u7acb\u6bd4\u7279\u548c\u7b26\u53f7\u9501\u5b9a\u72b6\u6001\uff0c\u5e76\u4e14\u89e3\u51b3\u6781\u6027\u7ffb\u8f6c\uff08polarity inversion\uff09\u6062\u590d\u4e4b\u7c7b\u7684\u4e8b\u5b9c\u3002\u5728\u8fd9\u4e9b\u5de5\u4f5c\u5b8c\u6210\u540e\uff0c\u8bbe\u5907\u4eec\u80fd\u591f\u6b63\u786e\u5730\u63a5\u6536\u5bf9\u65b9\u53d1\u51fa\u7684 TS1 \u548c TS2 \u6709\u5e8f\u96c6\u3002\u56fe 14-9 \u5c55\u793a\u4e86\u8f6e\u8be2\u72b6\u6001\u7684\u5404\u4e2a\u6b21\u72b6\u6001\u3002</p> <p></p> <p>\u56fe 14-9 \u8f6e\u8be2\u72b6\u6001\u673a</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1451-polling","title":"14.5.1 Polling\u6b21\u72b6\u6001\u7ec6\u8282\u8ba8\u8bba","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14511-pollingactive","title":"14.5.1.1 Polling.Active","text":"<p>Polling.Active \u671f\u95f4</p> <p>\u4e00\u65e6\u94fe\u8def\u53cc\u65b9\u7684\u5171\u6a21\u7535\u538b\u7a33\u5b9a\u5728\u53d1\u9001\u4f59\u91cf\uff08Transmit Margin\uff09\u57df\u4e2d\u5141\u8bb8\u7684\u8303\u56f4\u5185\u4e4b\u540e\uff0c\u53d1\u9001\u65b9\u4f1a\u53d1\u9001\u81f3\u5c11 1024 \u4e2a\u8fde\u7eed\u7684 TS1 \u6709\u5e8f\u96c6\u3002\u56e0\u4e3a\u94fe\u8def\u53cc\u65b9\u9000\u51fa\u68c0\u6d4b\u72b6\u6001\u7684\u65f6\u523b\u53ef\u80fd\u4e0d\u540c\uff0c\u6240\u4ee5 TS1 \u547d\u4ee4\u5e8f\u5217\u7684\u4ea4\u6362\u4e0d\u662f\u540c\u6b65\u7684\u3002\u5728 Gen1\uff082.5GT/s\uff09 \u901f\u7387\u4e0b\uff0c\u53d1\u9001 1024 \u4e2a TS1 \u5e8f\u5217\u82b1\u8d39 64us \u3002</p> <p>Active \u6b21\u72b6\u6001\u4e0b\uff0c\u6709\u4e00\u4e9b\u503c\u5f97\u6ce8\u610f\u7684\u7ec6\u8282\uff1a</p> <ul> <li>\u5fc5\u987b\u5728 TS1 \u5e8f\u5217\u7684\u901a\u9053\uff08Lane\uff09\u548c\u94fe\u8def\u7f16\u53f7\uff08Link number\uff09\u5b57\u6bb5\u4e2d\u4f7f\u7528\u586b\u5145\u5b57\u7b26</li> <li>\u8bbe\u5907\u9700\u8981\u901a\u544a\uff08advertise\uff09\u81ea\u5df1\u652f\u6301\u7684\u6240\u6709\u901f\u7387\uff0c\u54ea\u6015\u8bbe\u5907\u5e76\u4e0d\u6253\u7b97\u4f7f\u7528\u8fd9\u4e9b\u901f\u7387</li> <li>\u63a5\u6536\u65b9\u4f7f\u7528\u63a5\u6536\u5230\u7684 TS1 \u5e8f\u5217\u5b9e\u73b0\u6bd4\u7279\u9501\u5b9a\u548c\u7b26\u53f7\u9501\u5b9a\uff08\u4f4e\u4e8e 8GT/s \u7684\u901f\u7387\uff09\u6216\u8005\u5757\u9501\u5b9a\uff088GT/s \u901f\u7387\uff09</li> </ul> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 Polling.Configuration</p> <p>\u5728\u53d1\u9001\u65b9\u53d1\u9001\u5b8c 1024 \u4e2a TS1 \u91cc\u6700\u540e\u4e00\u4e2a TS1 \u5e8f\u5217\u4e4b\u540e\uff0c\u5982\u679c**\u6240\u6709\u68c0\u6d4b\u5230\u7684\u901a\u9053**\u90fd\u6536\u5230\u4e86 8 \u4e2a\u8fde\u7eed\u7684\u8bad\u7ec3\u5e8f\u5217\uff08\u5982\u679c\u5b58\u5728\u6781\u6027\u7ffb\u8f6c\u7684\u8bdd\uff0c\u90a3\u4e48\u6536\u5230\u7684\u5c31\u662f\u8bad\u7ec3\u5e8f\u5217\u7684\u8865\u96c6\uff09\uff0c\u5e76\u4e14\u8fd9\u4e9b\u8bad\u7ec3\u5e8f\u5217\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u4e4b\u4e00\u7684\u8bdd\uff0c\u72b6\u6001\u673a\u8fdb\u5165 Polling.Configuration \u72b6\u6001\uff1a</p> <ul> <li>\u63a5\u6536\u5230\u7684 TS1 \u7684\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u5168\u90e8\u88ab\u8bbe\u7f6e\u4e3a\u5168\u586b\u5145\u5b57\u7b26\uff08PAD\uff09\uff0c\u5e76\u4e14 Compliance Receive \u6bd4\u7279\u8bbe\u7f6e\u4e3a 0b (\u7b26\u53f7 5 \u7684 \u6bd4\u7279 4)</li> <li>\u63a5\u6536\u5230\u7684 TS1 \u7684\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u90fd\u88ab\u8bbe\u7f6e\u4e3a\u5168\u586b\u5145\u5b57\u7b26\uff0c\u5e76\u4e14 Loopback \u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b (\u7b26\u53f7 5 \u7684 \u6bd4\u7279 2)</li> <li>\u63a5\u6536\u5230\u7684 TS2 \u7684\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u90fd\u88ab\u8bbe\u7f6e\u4e3a\u5168\u586b\u5145\u5b57\u7b26</li> </ul> <p>\u5982\u679c\u4e0a\u8ff0\u6761\u4ef6\u90fd\u6ca1\u80fd\u6ee1\u8db3\uff0c\u90a3\u4e48\u5728 24ms \u7684\u8d85\u65f6\u4e4b\u540e\uff0c\u5728\u63a5\u6536\u5230\u67d0\u4e2a TS1 \u4e4b\u540e\uff0c\u5df2\u7ecf\u53d1\u9001\u4e86 1024 \u4e2a TS1 \u5e8f\u5217\uff0c\u53ea\u9700\u8981**\u4efb\u610f\u68c0\u6d4b\u5230\u7684\u901a\u9053**\u63a5\u6536\u5230\u4e86 8 \u4e2a\u8fde\u7eed\u7684TS1 \u5e8f\u5217\u6216\u8005 TS2 \u5e8f\u5217\uff0c\u901a\u9053\u4ee5\u53ca\u94fe\u8def\u7f16\u53f7\u662f\u586b\u5145\u7b26\u53f7\uff0c\u5e76\u4e14\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u4e4b\u4e00\uff08\u8bd1\u6ce8\uff1a\u5176\u5b9e\u4ee5\u4e0b\u6761\u4ef6\u548c\u8d85\u65f6\u524d\u7684\u5224\u65ad\u6761\u4ef6\u4e00\u81f4\uff09\uff0c\u90a3\u4e48\u72b6\u6001\u673a\u8fdb\u5165 Polling.Configuration \u72b6\u6001\u3002</p> <ul> <li>\u63a5\u6536\u5230\u7684 TS1 \u7684\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u5168\u90e8\u88ab\u8bbe\u7f6e\u4e3a\u5168\u586b\u5145\u5b57\u7b26\uff08PAD\uff09\uff0cCompliance Receive \u6bd4\u7279\u8bbe\u7f6e\u4e3a 0b (\u7b26\u53f7 5 \u7684 \u6bd4\u7279 4)</li> <li>\u63a5\u6536\u5230\u7684 TS1 \u7684\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u90fd\u88ab\u8bbe\u7f6e\u4e3a\u5168\u586b\u5145\u5b57\u7b26\uff0cLoopback \u6bd4\u7279\u8bbe\u7f6e\u4e3a 0b (\u7b26\u53f7 5 \u7684 \u6bd4\u7279 2)</li> <li>\u63a5\u6536\u5230\u7684 TS2 \u7684\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u90fd\u88ab\u8bbe\u7f6e\u4e3a\u5168\u586b\u5145\u5b57\u7b26</li> </ul> <p>\u5982\u679c\u5728\u4efb\u610f\u901a\u9053\u4e0a\u90fd\u6ca1\u6709\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\u7684\u60c5\u51b5\u51fa\u73b0\uff0c\u90a3\u4e48\u5982\u679c\u81ea\u8fdb\u5165 Polling.Active \u72b6\u6001\u4ee5\u6765\uff0c\u6709\u8d85\u8fc7\u9884\u5b9a\u6570\u91cf\u7684\u901a\u9053\u4e0a\u68c0\u6d4b\u5230\u81f3\u5c11\u4e00\u6b21\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u7684\u73b0\u8c61\uff08\u8fd9\u662f\u4e3a\u4e86\u9632\u6b62\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5931\u6548\u7684\u53d1\u9001\u7aef\u6216\u8005\u63a5\u6536\u7aef\u5bfc\u81f4\u94fe\u8def\u4e0d\u80fd\u80fd\u8fdb\u884c\u914d\u7f6e\uff09\uff0c\u90a3\u4e48\u4e5f\u80fd\u8fdb\u5165  Polling.Configuration \u72b6\u6001\u3002\uff08\u8bd1\u6ce8\uff1a\u539f\u6587\u6b64\u5904\u540e\u534a\u53e5\u7f3a\u5931\uff0c\u8bd1\u6587\u4e3a\u8bd1\u8005\u6240\u52a0\uff09\u6b64\u5904\u63d0\u5230\u7684\u9884\u5b9a\u6570\u91cf\u7531\u5177\u4f53\u5b9e\u73b0\u51b3\u5b9a\uff0c\u6b64\u5904\u76f8\u8f83\u4e8e 1.1 \u7248\u672c\u7684\u534f\u8bae\u505a\u4e86\u6539\u52a8\uff0c\u539f\u5148\u5fc5\u987b\u68c0\u6d4b\u5230\u6240\u6709\u901a\u9053\u90fd\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u3002</p> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 Polling.Compliance</p> <p>\u5982\u679c Link Control 2 \u5bc4\u5b58\u5668\u4e2d\u7684 \u201cEnter Compliance\u201d \u6bd4\u7279\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c\u90a3\u4e48\u8fdb\u5165 Polling.Compliance\u3002\u6216\u8005\u5982\u679c\u5728\u8fdb\u5165 Polling.Active \u72b6\u6001\u4e4b\u524d\uff0c\u8be5\u6bd4\u7279\u5df2\u7ecf\u88ab\u7f6e\u4f4d\uff0c\u90a3\u4e48\u5c06\u76f4\u63a5\u4ece Active \u72b6\u6001\u8fdb\u5165 Compliance \u72b6\u6001\uff0c\u4e0d\u4f1a\u5728 Active \u72b6\u6001\u4e2d\u53d1\u9001\u4efb\u4f55 TS1 \u5e8f\u5217\u3002</p> <p>\u5426\u5219\uff0c\u7b49\u5f85 24ms \u540e\uff0c\u518d\u6b21\u5224\u65ad\u8fdb\u5165 Compliance \u72b6\u6001\u7684\u6761\u4ef6\uff1a</p> <ul> <li>\u6240\u6709\u7684\u901a\u9053\u5728\u8fdb\u5165 Active \u72b6\u6001\u540e\uff0c\u90fd\u6ca1\u6709\u68c0\u6d4b\u5230\u5bf9\u7aef\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\uff08\u8fd9\u610f\u5473\u7740\u5bf9\u7aef\u662f\u4e00\u4e2a\u88ab\u52a8\u6d4b\u8bd5\u8d1f\u8f7d\uff0c\u6bd4\u5982\u5728\u81f3\u5c11\u4e00\u4e2a\u901a\u9053\u4e0a\u6302\u8f7d\u4e86\u4e00\u4e2a\u6d4b\u8bd5\u7535\u963b\uff0c\u5c06\u5f3a\u5236\u4f7f\u6240\u6709\u901a\u9053\u8fdb\u5165 Compliance \u72b6\u6001\u3002\uff09 </li> <li>\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS1 \uff0c\u5176\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u5168\u90e8\u88ab\u8bbe\u7f6e\u4e3a\u5168\u586b\u5145\u5b57\u7b26\uff08PAD\uff09\uff0c\u5e76\u4e14 Compliance Receive \u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b (\u7b26\u53f7 5 \u7684 \u6bd4\u7279 4)\uff0c\u5e76\u4e14 Loopback \u6bd4\u7279\u8bbe\u7f6e\u4e3a 0b (\u7b26\u53f7 5 \u7684 \u6bd4\u7279 2)\u3002</li> </ul> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 Detect State</p> <p>\u5982\u679c\u5728 24ms \u4e4b\u540e\uff0c\u6ca1\u6709\u6ee1\u8db3\u8fdb\u5165 Polling.Configuration \u72b6\u6001\u6216\u8005 Polling.Compliance \u72b6\u6001\u7684\u6761\u4ef6\uff0c\u90a3\u4e48\u8fd4\u56de Detect \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14512-pollingconfiguration","title":"14.5.1.2 Polling.Configuration","text":"<p>\u5728 Configuration \u6b21\u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u65b9\u505c\u6b62\u53d1\u9001 TS1 \u5e8f\u5217\uff0c\u8f6c\u800c\u53d1\u9001 TS2 \u5e8f\u5217\uff0cTS2 \u5e8f\u5217\u4e2d\u7684\u94fe\u8def\u548c\u901a\u9053\uff08lane\uff09\u5b57\u6bb5\u4ecd\u7136\u4f7f\u7528\u586b\u5145\u5b57\u6bb5\u586b\u5145\u3002\u8be5\u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u65b9\u8f6c\u800c\u53d1\u9001 TS2 \u7684\u76ee\u7684\u662f\u901a\u77e5\u94fe\u8def\u5bf9\u7aef\u7684\u8bbe\u5907\uff1a\u672c\u65b9\u5df2\u7ecf\u505a\u597d\u51c6\u5907\u8fdb\u5165\u72b6\u6001\u673a\u4e2d\u7684\u4e0b\u4e00\u4e2a\u72b6\u6001\u3002\u8f6c\u800c\u53d1\u9001 TS2 \u662f\u4e3a\u4e86\u4f7f\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907 LTSSM \u540c\u6b65\u800c\u8bbe\u8ba1\u7684\u63e1\u624b\u673a\u5236\u3002\u53cc\u65b9\u8bbe\u5907\u90fd\u65e0\u6cd5\u72ec\u81ea\u8fdb\u5165\u4e0b\u4e00\u72b6\u6001,\u9664\u975e\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u90fd\u51c6\u5907\u5c31\u7eea\u3002\u5f00\u59cb\u53d1\u9001 TS2 \u5e8f\u5217\u662f\u901a\u77e5\u5bf9\u7aef\u672c\u65b9\u51c6\u5907\u5c31\u7eea\u7684\u65b9\u5f0f\u3002\u6240\u4ee5\u4e00\u65e6\u8bbe\u5907\u540c\u65f6\u53d1\u9001\u5e76\u4e14\u63a5\u6536\u5230 TS2 \u5e8f\u5217\uff0c\u5c31\u4ee3\u8868\u672c\u65b9\u548c\u5bf9\u7aef\u8bbe\u5907\u90fd\u5df2\u7ecf\u5c31\u7eea\uff0c \u8bbe\u5907\u53ef\u4ee5\u8fdb\u5165\u4e0b\u4e00\u72b6\u6001\u3002</p> <p>Polling.Configuration \u671f\u95f4</p> <p>\u53d1\u9001\u65b9\u5728\u6240\u6709\u8bc6\u522b\u7684\u901a\u9053\u4e0a\u53d1\u9001 TS2 \u5e8f\u5217\uff0c\u5176\u94fe\u8def\u548c\u901a\u9053\u5b57\u6bb5\u4f7f\u7528\u586b\u5145\u5b57\u6bb5\u586b\u5145\u3002\u5e76\u4e14\u53d1\u9001\u65b9\u5fc5\u987b\u901a\u77e5\u5bf9\u7aef\u81ea\u5df1\u6240\u652f\u6301\u7684\u6240\u6709\u6570\u636e\u901f\u7387\uff0c\u5373\u4f7f\u662f\u90a3\u4e9b\u4e0d\u6253\u7b97\u4f7f\u7528\u7684\u6570\u636e\u901f\u7387\u3002\u6b64\u5916\uff0c\u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff0c\u6bcf\u4e2a\u901a\u9053\u7684\u63a5\u6536\u65b9\u5fc5\u987b\u72ec\u7acb\u5730\u6062\u590d\u5dee\u5206\u8f93\u5165\u4fe1\u53f7\u7684\u6781\u6027\u3002\u5173\u4e8e\u6781\u6027\u6062\u590d\u7684\u5177\u4f53\u5185\u5bb9\uff0c\u53ef\u4ee5\u53c2\u89c1\u539f\u6587 506 \u7684\u6982\u89c8\u7ae0\u3002\u53e6\u5916\uff0cTransmit Margin \u5b57\u6bb5\u5fc5\u987b\u91cd\u7f6e\u4e3a 000b\u3002</p> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 Configuration \u72b6\u6001</p> <p>\u5728\u4efb\u610f\u901a\u9053\u4e0a\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684\u94fe\u8def\u548c\u901a\u9053\uff08lane\uff09\u5b57\u6bb5\u586b\u5145\u7684 TS2 \u5e8f\u5217\u540e\uff0c\u5e76\u4e14\u4ece\u63a5\u6536\u5230\u7b2c\u4e00\u4e2a TS2 \u5e8f\u5217\u5f00\u59cb\uff0c\u5df2\u7ecf\u53d1\u9001\u4e86\u81f3\u5c11 16 \u4e2a TS2 \u5e8f\u5217\u540e\uff0c\u9000\u51fa Polling.Configuration \u72b6\u6001\u8fdb\u5165 Configuration \u72b6\u6001\u3002</p> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 Detect \u72b6\u6001</p> <p>\u5982\u679c\u4e0a\u8ff0\u6761\u4ef6\u5728 48 ms \u7684\u8d85\u65f6\u540e\u4ecd\u672a\u6ee1\u8db3\uff0c\u9000\u51fa Polling.Configuration \u72b6\u6001\u8fd4\u56de Detect \u72b6\u6001\u3002</p> <p>\u9000\u51fa\u72b6\u6001\u8fdb\u5165 Polling.Speed \u6b21\u72b6\u6001\uff08\u73b0\u5df2\u4e0d\u5b58\u5728\uff09</p> <p>\u6b64\u5904\u8ba8\u8bba\u7684\u60c5\u51b5\u662f\u4e00\u9879 1.0 \u534f\u8bae\u5386\u53f2\u4e2d\u7684\u9884\u7559\u8bbe\u8ba1\uff0cPolling \u72b6\u6001\u4e0b\u5c5e\u7684\u6b21\u72b6\u6001\u5728\u534f\u8bae 1.0 \u7248\u672c\u53d1\u5e03\u4e4b\u540e\u5df2\u7ecf\u53d1\u751f\u4e86\u6539\u53d8\u3002\u5728\u5f53\u65f6\uff0c\u8bbe\u8ba1\u8005\u89c9\u5f97\u5728\u672a\u6765\u65b0\u7684\uff0c\u66f4\u5feb\u901f\u7387\u51fa\u73b0\u4e4b\u540e\uff0c\u6709\u5fc5\u8981\u5728 Polling \u72b6\u6001\u4e2d\u5c3d\u53ef\u80fd\u5feb\u901f\u5730\u5207\u6362\u5230\u6700\u9ad8\u901f\u7387\u3002\u7136\u540e\uff0c\u66f4\u9ad8\u7684\u901f\u7387\u51fa\u73b0\u4e4b\u540e\uff0c\u8bbe\u8ba1\u8005\u610f\u8bc6\u5230\u76f8\u6bd4\u5728\u7b2c\u4e00\u6b21\u9759\u6001\u914d\u7f6e\u72b6\u6001\u4e2d\u628a\u901f\u7387\u914d\u7f6e\u5230\u6700\u9ad8\u901f\u7387\uff0c\u4e0d\u5982\u52a8\u6001\u5730\u6839\u636e\u7535\u6e90\u7ba1\u7406\u9700\u6c42\uff0c\u52a8\u6001\u5730\u63d0\u9ad8\u6216\u8005\u964d\u4f4e\u901f\u7387\u3002\u7531\u4e8e\u5728 Polling \u9636\u6bb5\u9700\u8981\u6e05\u9664\u5927\u91cf\u94fe\u8def\u7684\u76f8\u5173\u914d\u7f6e\uff0c\u6240\u4ee5\u91cd\u65b0\u8fdb\u5165 Polling \u72b6\u6001\u8fdb\u884c\u52a8\u6001\u901f\u7387\u8c03\u8282\u662f\u4e0d\u9002\u5408\u7684\uff0c\u56e0\u6b64\u52a8\u6001\u901f\u7387\u8c03\u8282\u7684\u529f\u80fd\u88ab\u79fb\u51fa\u4e86 Polling \u9636\u6bb5\uff0c\u800c\u8bbe\u7f6e\u4e8e Recovery \u9636\u6bb5\u4e2d\u3002\u5177\u4f53\u53ef\u89c1\u539f\u6587 528 \u9875\u7684\u56fe 14-10\u3002</p> <p></p> <p>\u56fe 14-10  Polling \u72b6\u6001\u673a\uff0c\u5305\u542b\u5386\u53f2\u4e0a\u7684 Polling.speed \u6b21\u72b6\u6001</p> <p>\u73b0\u4eca\uff0cLTSSM \u5728\u590d\u4f4d\u4e4b\u540e\u4f1a\u603b\u662f\u4f1a\u5c06\u901f\u7387\u8bad\u7ec3\u4e3a 2.5GT/s\uff0c\u54ea\u6015\u652f\u6301\u66f4\u9ad8\u7684\u901f\u7387\u3002\u5728 LTSSM \u72b6\u6001\u673a\u8fdb\u5165 L0 \u72b6\u6001\u4e4b\u540e\uff0c\u4e00\u65e6\u6709\u66f4\u9ad8\u7684\u53ef\u7528\u901f\u7387\uff0c\u72b6\u6001\u673a\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u5e76\u4e14\u5c1d\u8bd5\u5c06\u901f\u7387\u8bad\u7ec3\u4e3a\u53cc\u65b9\u90fd\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u3002\u53cc\u65b9\u53ef\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u4f1a\u5728\u53cc\u65b9\u4ea4\u6362\u7684 TS1 \u548c TS2 \u5e8f\u5217\u4e2d\u4f53\u73b0\uff0c\u6240\u4ee5\u4efb\u610f\u4e00\u65b9\u90fd\u53ef\u4ee5\u901a\u8fc7\u4f7f\u81ea\u8eab\u7684\u72b6\u6001\u673a\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u53d1\u8d77\u4e00\u6b21\u901f\u7387\u6539\u53d8\u884c\u4e3a\u3002\u534f\u8bae\u4e2d\u4ecd\u7136\u4f1a\u7f57\u5217 Polling.Speed \u6b21\u72b6\u6001\uff0c\u4f46\u4f1a\u5c06\u5176\u6807\u6ce8\u4e3a\u4e0d\u4f1a\u8fdb\u5165\uff08unreachable\uff09\u7684\u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14513-pollingcompliance","title":"14.5.1.3 Polling.Compliance","text":"<p>Compliance \u6b21\u72b6\u6001\u7528\u4e8e\u6d4b\u8bd5\u3002\u53d1\u9001\u65b9\u4f1a\u53d1\u9001\u7279\u5b9a\u7684\u7801\u5b57\u7ec4\u5408\uff08pattern\uff09\uff0c\u6784\u5efa\u4e00\u79cd\u7801\u95f4\u5e72\u6270\u548c\u4e32\u6270\u63a5\u8fd1\u6700\u4e25\u91cd\u7684\u573a\u666f\uff0c\u7528\u4e8e\u94fe\u8def\u4fe1\u53f7\u8d28\u91cf\u5206\u6790\u3002\u5728\u8be5\u6b21\u72b6\u6001\u4e2d\uff0c\u53ef\u4ee5\u53d1\u9001\u4e24\u7c7b\u7801\u5b57\uff0c\u5206\u522b\u662f Compliance pattern \u548c modified compliance pattern\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#8b10b-compliance-pattern","title":"\u7528\u4e8e 8b/10b \u7f16\u7801\u7684  Compliance pattern","text":"<p>\u8be5\u7801\u5b57\u5305\u62ec 4 \u4e2a\u7b26\u53f7\uff08Symbol\uff09\uff0c\u7801\u5b57\u4e2d\u8fd9\u56db\u4e2a\u7b26\u53f7\u5c06\u6309\u7167\u987a\u5e8f\u4e0d\u505c\u91cd\u590d\uff0c\u4ed6\u4eec\u5206\u522b\u662f\uff1aK28.5-\uff0cD21.5+\uff0cK28.5+ \u4ee5\u53ca D10.2\uff0c\u4ed6\u4eec\u540d\u5b57\u4e2d\u7684 (-) \u8868\u793a\u8d1f\u6781\u6027\u7684\u6821\u9a8c\u7ed3\u679c\u4ee5\u53ca RCD\uff08 //TODO\uff0cnegative current running disparity or CRD\uff0cCRD means???\uff09\uff0c\u800c (+) \u8868\u793a\u6b63\u6781\u6027\u7684 CRD\uff08\u7531\u4e8e CRD \u662f\u5f3a\u5236\u7684\uff0c\u5728\u7801\u5b57\u7ec4\u5408\u5f00\u59cb\u65f6\uff0c\u5141\u8bb8\u51fa\u73b0\u6821\u9a8c\u9519\u8bef\uff09\u3002\u5982\u679c\u94fe\u8def\u7531\u591a\u6761\u901a\u9053\u7ec4\u6210\uff0c\u90a3\u4e48\u56db\u4e2a\u5ef6\u8fdf\u7b26\u53f7\uff08Delay symbol\uff0c\u770b\u4e0a\u53bb Delay \u53ea\u6807\u8bc6\u4e86\u90a3\u4e9b\u540d\u5b57\u4ee5 D \u5f00\u5934\u7684\u7b26\u53f7\uff0c\u4f46\u5176\u5b9e\u4e5f\u5305\u62ec\u4e86 K28.5 \u7b26\u53f7\uff09\u9996\u5148\u5728\u901a\u9053 0 \u4e0a\u6ce8\u5165\uff0c\u4e0e\u524d\u540e\u4e24\u4e2a compliance pattern \u4fdd\u6301 2 \u4e2a\u7b26\u53f7\u7684\u95f4\u9694\uff08//TODO two before the next compliance pattern and two after the compliance pattern\uff09\u3002\u5728\u901a\u9053 0 \u4e0a\u53d1\u9001\u4e86\u6700\u540e\u4e00\u4e2a\u5ef6\u8fdf\u7b26\u53f7\u4e4b\u540e\uff0c\u8f6c\u81f3\u901a\u9053 1 \u53d1\u9001\uff08\u540c\u6837\u5730\uff0c\u4e0e\u524d\u540e\u4e24\u4e2a compliance pattern \u4fdd\u6301 2 \u4e2a\u7b26\u53f7\u7684\u95f4\u9694\uff09\u3002\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\u76f4\u5230\u6240\u6709 8 \u4e2a\u901a\u9053\u53d1\u9001\u5b8c\u6bd5\uff0c\u518d\u56de\u5230\u901a\u9053 0 \u91cd\u65b0\u5f00\u59cb\uff0c\u6574\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u53c2\u89c1\u539f\u6587 529 \u9875\u4e0a\u7684 \u886814-3\uff0cCompliance pattern \u7528\u7070\u8272\u80cc\u666f\u6807\u8bc6\u3002\u6bcf 8 \u4e2a\u901a\u9053\u4e3a 1 \u7ec4\uff0c\u91cd\u590d\u4e0a\u8ff0\u7684\u7801\u5b57\u7ec4\u5408\u53d1\u9001\u65b9\u5f0f\u3002\u901a\u8fc7\u4ee5\u4e0a\u8ff0\u89c4\u5219\u5faa\u73af\u91cd\u590d\u53d1\u9001\u5ef6\u8fdf\u7b26\u53f7\u53ef\u4ee5\u786e\u4fdd\u76f8\u90bb\u901a\u9053\u4e4b\u95f4\u5b58\u5728\u4fe1\u53f7\u4e32\u6270\uff0c\u63d0\u4f9b\u4e00\u4e2a\u6700\u63a5\u8fd1\u6700\u5dee\u60c5\u51b5\u7684\u6d4b\u8bd5\u73af\u5883\u3002</p> <p>\u8868 14-3\u53ca\u5176\u7eed\u8868 8b/10b \u7f16\u7801\u7684 compliance pattern</p> <p></p> <p></p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#128b130b-compliance-pattern","title":"\u7528\u4e8e 128b/130b \u7f16\u7801\u7684  Compliance pattern","text":"<p>TODO</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#8b10b-modified-compliance-pattern","title":"\u7528\u4e8e 8b/10b \u7f16\u7801\u7684  Modified Compliance pattern","text":"<p>TODO</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#128b130b-modified-compliance-pattern","title":"\u7528\u4e8e 128b/130b \u7f16\u7801\u7684  Modified Compliance pattern","text":"<p>TODO</p> <p>\u8fdb\u5165 Polling.Compliance \u72b6\u6001</p> <p>\u5728\u8fdb\u5165 Polling.Active \u72b6\u6001\u540e\uff0c\u7528\u4e8e\u8bbe\u7f6e\u53d1\u9001\u65b9\u7684\u7535\u538b\u8303\u56f4\u7684\u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u56682 \uff08Link Control 2 register\uff09\u7684\u53d1\u9001\u4f59\u91cf\uff08Transmit Margin\uff09\u5b57\u6bb5\u751f\u6548\u3002</p> <p>\u53bb\u52a0\u91cd\u7b49\u7ea7\uff08De-emphasis level\uff09\u548c\u901f\u7387\u7684\u5173\u7cfb\u5982\u4e0b\u6587\u4e2d\u7684\u8868 14-7 \u6240\u793a\u3002\u56e0\u4e3a\u76f8\u5173\u8bbe\u7f6e\u90fd\u53d6\u51b3\u4e8e\u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u56682 \u7684\u5b57\u6bb5\uff0c\u56fe 14-11 \u7f57\u5217\u51fa\u4e86\u8be5\u5bc4\u5b58\u5668\u7684\u5404\u9879\u5b57\u6bb5\uff0c\u7528\u4e8e\u53c2\u8003\u3002</p> <ul> <li>\u5982\u679c\u8be5\u7aef\u53e3\u53ea\u652f\u6301 2.5GT/s \u901f\u7387\uff0c\u90a3\u4e48\u6570\u636e\u901f\u7387\u4f1a\u56fa\u5b9a\u4e3a 2.5GT/s,\u53bb\u52a0\u91cd\u7b49\u7ea7\u4f1a\u56fa\u5b9a\u4e3a -3.5dB\u3002</li> <li>\u5426\u5219\uff0c\u5982\u679c\u8fdb\u5165\u8be5\u6b21\u72b6\u6001\u662f\u56e0\u4e3a\u6536\u5230\u4e86\u8fde\u7eed 8 \u4e2a TS1 \u5e8f\u5217\uff0c\u5176 Compliance Receive \u6bd4\u7279\u4e3a 1b\uff0c\u5e76\u4e14 Loopback \u6bd4\u7279\u4e3a 0b (\u5206\u522b\u4e3a TS1 \u7b26\u53f7 5 \u7684\u6bd4\u7279 2 \u548c 4)\uff0c\u90a3\u4e48\u901f\u7387\u4f1a\u8bbe\u7f6e\u4e3a\u94fe\u8def\u4efb\u610f\u4e00\u65b9\u6240\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u3002select_deemphasis \u53d8\u91cf\u8bbe\u7f6e\u5fc5\u987b\u4e0e TS1 \u7b26\u53f7 4 \u4e2d\u7684\u53bb\u52a0\u91cd\u6bd4\u7279\u76f8\u5339\u914d\u3002\u5982\u679c\u9009\u62e9\u7684\u901f\u7387\u662f 8GT/s\uff0c\u6bcf\u6761\u901a\u9053\u4e0a\u7684 select_preset \u53d8\u91cf\u6765\u81ea\u63a5\u4e0b\u6765\u4e00\u4e2a TS1 \u5e8f\u5217\u7684\u7b26\u53f7 6 \u7684\u5bf9\u5e94\u6bd4\u7279\u3002\u5728 Gen3 \u901f\u7387\u4e0b\uff0c\u90a3\u4e9b\u6ca1\u6709\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed TS1 \u5e8f\u5217\u7684\u901a\u9053\uff0c\u8fd9\u4e9b TS1 \u5305\u542b\u4e86 Preset \u4fe1\u606f\uff0c\u53ef\u4ee5\u81ea\u7531\u5730\u9009\u62e9\u4efb\u610f\u652f\u6301\u7684 Preset\u3002</li> <li>\u518d\u5426\u5219\uff0c\u5982\u679c</li> </ul> <p></p> <p></p> <p></p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#146-configuration-state","title":"14.6 Configuration State // \u914d\u7f6e\u72b6\u6001","text":"<p>\u8bbe\u5907\u521d\u59cb\u5316\u65f6\uff0cConfiguration \u72b6\u6001\u5728 2.5GT/s \u901f\u7387\u4e0b\u914d\u7f6e\u94fe\u8def\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\u30025GT/s \u548c 8GT/s \u901f\u7387\u65f6\uff0c\u8bbe\u5907\u4e5f\u53ef\u80fd\u4ece Recovery \u72b6\u6001\u8fdb\u5165 Configuration \u72b6\u6001\u3002\u6b64\u65f6\u72b6\u6001\u8f6c\u6362\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u8fdb\u884c\u591a\u901a\u9053\u8bbe\u5907\u7684\u94fe\u8def\u4f4d\u5bbd\u52a8\u6001\u8f6c\u6362\u3002\u52a8\u6001\u8f6c\u6362\u4ec5\u652f\u6301  5GT/s \u548c 8GT/s \u901f\u7387\u7684\u8bbe\u5907\u3002\u8fd9\u4e9b\u9ad8\u901f\u7387\u8bbe\u5907\u8be6\u7ec6\u7684\u72b6\u6001\u8f6c\u6362\u8fc7\u7a0b\u5c06\u5728\u539f\u6587 552 \u9875\u5f00\u59cb\u7684 \u201c\u8be6\u7ec6 Configuration \u6b21\u72b6\u6001\u201d \u4e00\u8282\u4e2d\u8ba8\u8bba\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1461-configuration","title":"14.6.1 Configuration \u72b6\u6001\u7efc\u8ff0","text":"<p>\u672c\u72b6\u6001\u7684\u4e3b\u8981\u76ee\u6807\u662f\u5f04\u6e05\u695a\u8bbe\u5907\u7aef\u53e3\uff08Port\uff09\u548c\u5404\u4e2a\u901a\u9053\uff08Lane\uff09\u7684\u8fde\u63a5\u60c5\u51b5\uff0c\u4ee5\u53ca\u4e3a\u8fde\u63a5\u7684\u901a\u9053\u5206\u914d\u901a\u9053\u7f16\u53f7\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5bf9\u4e00\u4e2a\u8fde\u63a5\u4e86 8 \u4e2a\u901a\u9053\u7684\u7aef\u53e3\u6765\u8bf4\uff0c\u53ef\u80fd\u53ea\u6709\u5176\u4e2d\u7684 2 \u4e2a\u901a\u9053\u662f\u53ef\u7528\u7684\uff0c\u518d\u6bd4\u5982\u8fd9\u4e9b\u901a\u9053\u53ef\u4ee5\u88ab\u7ec4\u5408\u4e3a\u591a\u6761\u94fe\u8def\uff0c\u6bd4\u5982\u7ec4\u5408\u6210\u4e24\u4e2a x4 \u7684\u94fe\u8def\uff08\u6bcf\u4e2a\u94fe\u8def\u6709 4 \u4e2a\u901a\u9053\uff09\uff0cConfiguration \u72b6\u6001\u7684\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u641e\u6e05\u695a\u8fd9\u65b9\u9762\u7684\u4fe1\u606f\u3002\u53e6\u5916\uff0c\u548c\u5176\u4ed6\u72b6\u6001\u4e0d\u540c\u7684\u662f\uff0c\u7aef\u53e3\u5728\u6b64\u72b6\u6001\u7684\u884c\u4e3a\u533a\u5206\u4e3a**\u9762\u5411\u4e0a\u6e38\u7aef\u53e3**\u6216\u8005**\u9762\u5411\u4e0b\u6e38\u7aef\u53e3**\u4e24\u79cd\u60c5\u51b5\uff0c\u4e24\u7c7b\u7aef\u53e3\u5728 Configuration \u72b6\u6001\u4e2d\u88ab\u5b9a\u4e49\u4e3a\u4e0d\u540c\u7684\u89d2\u8272\u3002\u56e0\u6b64\uff0c\u5728\u672c\u72b6\u6001\u4e2d\u4f1a\u5206\u522b\u8ba8\u8bba\u9762\u5411\u4e0a\u6e38\u548c\u4e0b\u6e38\u901a\u9053\u7684\u884c\u4e3a\u3002</p> <p>DSP \uff08Downstream Port\uff0c\u5411\u4e0b\u6e38\u53d1\u9001\u6570\u636e\uff09\u7aef\u53e3\u5728\u5269\u4f59\u7684\u94fe\u8def\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u626e\u6f14 \u201c\u9886\u5bfc\u8005\u201d\uff0c\u800c USP \uff08Upstream Port\uff0c\u5411\u4e0a\u6e38\u53d1\u9001\u6570\u636e\uff09\u7aef\u53e3\u7684\u89d2\u8272\u662f \u201c\u8ddf\u968f\u8005\u201d\u3002\"\u9886\u5bfc\u8005\"\uff0c\u4e5f\u5c31\u662f DSP\uff0c\u4f1a\u4e3a USP \u786e\u5b9a\u94fe\u8def\u4ee5\u53ca\u901a\u9053\u7684\u7f16\u53f7\uff0cUSP \u5219\u53ea\u662f\u7b80\u5355\u5730\u91cd\u590d\u4ed6\u63a5\u6536\u5230\u7684\u503c\u7ed9 DSP\uff0c\u9664\u975e\u51fa\u73b0\u4e86\u7f16\u53f7\u51b2\u7a81\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u4f1a\u5728\u672c\u8282\u540e\u7eed\u5185\u5bb9\u4e2d\u8ba8\u8bba\u8fd9\u79cd\u610f\u5916\u60c5\u51b5\u3002Configuration \u72b6\u6001\u4e2d\uff0c\u53cc\u65b9\u8bbe\u5907\u4ea4\u6362\u7684 TS1 \u5e8f\u5217\u4e2d\u4f1a\u53cd\u6620\u5206\u914d\u7684\u94fe\u8def\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\uff0c\u5982\u539f\u6587 540 \u9875\u7684\u56fe 14-13 \u7ea2\u5708\u90e8\u5206\u6240\u793a\uff0c\u8fd9\u4e24\u4e2a\u6570\u503c\u57df\u5728\u88ab\u5206\u914d\u5177\u4f53\u7684\u6570\u503c\u524d\uff0c\u4f7f\u7528\u586b\u5145\u7b26\u53f7\uff08PAD symbol\uff09\u4f5c\u4e3a\u5360\u4f4d\u7b26\u3002</p> <p></p> <p>\u56fe 14-13 TS1/TS2 \u4e2d\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u7684\u7f16\u7801\u793a\u610f\u56fe</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1462","title":"14.6.2 \u8bbe\u8ba1\u652f\u6301\u94fe\u8def\u5408\u5e76\u7684\u8bbe\u5907","text":"<p>\u8bbe\u8ba1\u8005\u4e00\u822c\u6839\u636e\u6027\u80fd\u4e0e\u6210\u672c\u7684\u8003\u8651\uff0c\u51b3\u5b9a\u5728\u4e00\u6761\u94fe\u8def\u4e0a\u5b9e\u73b0\u591a\u5c11\u4e2a\u901a\u9053\u3002PCIe \u94fe\u8def\u652f\u6301\u591a\u4e2a\u7a84\u94fe\u8def\u805a\u5408\u6210\u4e00\u4e2a\u66f4\u5bbd\u7684\u94fe\u8def\uff0c\u540c\u6837\u7684\uff0c\u8f83\u5bbd\u7684\u94fe\u8def\u4e5f\u53ef\u4ee5\u5206\u62c6\u6210\u591a\u4e2a\u7a84\u94fe\u8def\u3002\u539f\u6587 541 \u9875\u7684\u56fe 14-14 \u4e2d\u662f\u4e00\u4e2a\u6709\u4e00\u4e2a\u4e0a\u6e38\u7aef\u53e3\u548c\u56db\u4e2a x2 \u4e0b\u6e38\u7aef\u53e3\u7684\u4ea4\u6362\u673a\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u8fd9\u4e9b\u901a\u9053\u4e5f\u53ef\u4ee5\u7ec4\u6210\u4e24\u4e2a x4 \u7684\u94fe\u8def\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cPCIe \u534f\u8bae\u8981\u6c42\u6bcf\u4e2a\u7aef\u53e3\u5fc5\u987b\u6709\u4f5c\u4e3a\u4e00\u4e2a x1 \u94fe\u8def\u5de5\u4f5c\u7684\u80fd\u529b\u3002</p> <p>\u5982\u56fe\u5de6\u4fa7\u53ef\u89c1\uff0c\u4ea4\u6362\u673a\u5185\u90e8\u5305\u542b 1 \u4e2a\u9762\u5411\u4e0a\u6e38\u7684\u903b\u8f91\u6865\u4ee5\u53ca 4 \u4e2a\u9762\u5411\u4e0b\u6e38\u7684\u903b\u8f91\u6865\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6bcf\u4e2a\u7aef\u53e3\u90fd\u9700\u8981\u4e00\u4e2a\u903b\u8f91\u6865\uff0c\u56e0\u6b64\uff0c\u4ea4\u6362\u673a\u9700\u8981\u5305\u542b 4 \u4e2a\u9762\u5411\u4e0b\u6e38\u7684\u903b\u8f91\u6865\uff0c\u4ee5\u652f\u6301 4 \u4e2a\u9762\u5411\u4e0b\u6e38\u7684\u7aef\u53e3\u3002\u7136\u800c\uff0c\u5982\u679c\u8fd9\u4e2a\u4ea4\u6362\u673a\u5982\u56fe\u53f3\u65b9\u5f0f\u8fde\u63a5\u7684\u8bdd\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u4e24\u4e2a\u903b\u8f91\u6865\u5c31\u5c06\u4e0d\u5de5\u4f5c\u3002\u5728\u94fe\u8def\u8bad\u7ec3\u671f\u95f4\uff0c\u6bcf\u4e2a DSP \u4e2d\u7684 LTSSM \u5c06\u51b3\u5b9a\u5177\u4f53\u5b9e\u73b0\u54ea\u4e9b\u5176\u6240\u652f\u6301\u7684\u8fde\u63a5\u9009\u9879\u3002</p> <p></p> <p>\u56fe 14-14 \u94fe\u8def\u805a\u5408\uff08Link Merging\uff09\uff0c\u5c06\u901a\u9053\u805a\u5408\u6210\u66f4\u5bbd\u7684\u94fe\u8def</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1463-configuration","title":"14.6.3  Configuration \u72b6\u6001\u8bad\u7ec3\u793a\u4f8b","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14631","title":"14.6.3.1 \u5f15\u8a00","text":"<p>\u5728 Configuration \u72b6\u6001\u4e2d\uff0c\u94fe\u8def\u4ee5\u53ca\u901a\u9053\u7684\u7f16\u53f7\u5de5\u4f5c\u7531 DSP \u4f5c\u4e3a \u201c\u9886\u5bfc\u8005\u201d \u53d1\u8d77\uff08\u6bd4\u5982\u6839\u8282\u70b9\u7aef\u53e3\u6216\u8005\u4ea4\u6362\u673a\u7684\u9762\u5411\u4e0b\u6e38\u7aef\u53e3\uff09\u3002\u800c\u7ec8\u7aef\uff08Endpoint\uff09\u4ee5\u53ca\u4ea4\u6362\u673a\u9762\u5411\u4e0a\u6e38\u7aef\u53e3\u65e0\u6cd5\u53d1\u8d77\u8fd9\u4e00\u8fc7\u7a0b\uff0c\u53ea\u80fd\u4f5c\u4e3a \u201c\u8ddf\u968f\u8005\u201d \u54cd\u5e94\u3002\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e9b\u793a\u4f8b\uff0c\u6765\u4f7f\u76f8\u5173\u7684\u6982\u5ff5\u66f4\u5bb9\u6613\u7406\u89e3\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14632-1","title":"14.6.3.2 \u94fe\u8def\u914d\u7f6e\u793a\u4f8b 1","text":"<p>\u5982\u539f\u6587 543 \u9875\u7684\u56fe 14-15 \u6240\u793a\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u5047\u5b9a\u53cc\u65b9\u8bbe\u5907\u90fd\u53ea\u652f\u6301\u5355\u4e2a\u94fe\u8def\uff0c\u4f46\u901a\u9053\u5bbd\u5ea6\u53ef\u4ee5\u662f x4,x2 \u6216\u8005 x1\u3002\u901a\u9053\u7f16\u53f7\u5206\u914d\u5728\u8bbe\u5907\u5185\u90e8\u5b8c\u6210\uff0c\u5fc5\u987b\u4ece 0 \u5f00\u59cb\u8fde\u7eed\u7f16\u53f7\u3002\u7269\u7406\u4e0a\u7684\u901a\u9053\u7f16\u53f7\u663e\u793a\u5728\u56fe\u4e2d\u6240\u753b\u7684\u8bbe\u5907\u6846\u5185\uff0c\u800c\u903b\u8f91\u4e0a\u7684\uff0c\u6216\u8005\u8bf4\u901a\u544a\u7684\uff08reported\uff09\u901a\u9053\u7f16\u53f7\uff0c\u5728 TS \u6709\u5e8f\u96c6\u4e2d\u53cd\u6620\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u903b\u8f91\u548c\u7269\u7406\u7f16\u53f7\u662f\u4e00\u81f4\u7684\uff0c\u4f46\u662f\u4e5f\u4e0d\u5c3d\u7136\u3002</p> <p>\u94fe\u8def\u7f16\u53f7\u534f\u5546</p> <ol> <li>\u8003\u8651\u5230\u672c\u4f8b\u4e2d\u53ea\u652f\u6301\u4e00\u6761\u94fe\u8def\uff0cDSP\uff08Downstream Port\uff0c\u5411\u4e0b\u6e38\u53d1\u9001\u6570\u636e\u7684\u7aef\u53e3\uff09\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u90fd\u4e3a 'N' \u7684 TS1 \u6709\u5e8f\u96c6\uff0c\u8fd9\u4e9b TS1 \u7684\u901a\u9053\u7f16\u53f7\u90fd\u7528 PAD \u7b26\u53f7\u586b\u5145\u3002 </li> <li>\u5728\u914d\u7f6e\u72b6\u6001\u4e2d\uff0cUSP\uff08Upstream Port\uff09\u8d77\u521d\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u57df\u90fd\u7528 PAD \u7b26\u53f7\u586b\u5145\u7684 TS1\uff0c\u4f46\u662f\u5728\u63a5\u6536\u5230 DSP \u53d1\u9001\u7684\u94fe\u8def\u7f16\u53f7\u4e0d\u4e3a PAD \u7b26\u53f7\u7684 TS1 \u540e\uff0cUSP \u5728\u6240\u6709\u5df2\u8fde\u63a5\u7684\u901a\u9053\u4e0a\u56de\u590d\u94fe\u8def\u7f16\u53f7\u540c\u6837\u662f 'N'\uff0c\u901a\u9053\u7f16\u53f7\u7528 PAD \u7b26\u53f7\u586b\u5145\u7684 TS1\u3002\u57fa\u4e8e USP \u7684\u54cd\u5e94\uff0cDSP \u7684 LTSSM \u8bc6\u522b\u5230\u6240\u6709\u56db\u4e2a\u901a\u9053\u90fd\u53d1\u51fa\u4e86\u54cd\u5e94\uff0c\u5e76\u4f7f\u7528\u76f8\u540c\u7684\u94fe\u8def\u7f16\u53f7 \u2018N\u2019 \uff0c\u6240\u4ee5\u56db\u4e2a\u901a\u9053\u88ab\u914d\u7f6e\u4e3a\u540c\u4e00\u4e2a\u94fe\u8def\u3002\u901a\u9053\u7f16\u53f7\u7684\u503c 'N' \u662f\u4e00\u4e2a\u7531\u5177\u4f53\u5b9e\u73b0\u51b3\u5b9a\u7684\u503c\uff0c\u8fd9\u4e2a\u503c\u4e0d\u4f1a\u4fdd\u5b58\u5728\u4efb\u4f55\u534f\u8bae\u5b9a\u4e49\u7684\u5bc4\u5b58\u5668\u4e2d\uff0c\u5e76\u4e14\u4e0e\u901a\u9053\u7f16\u53f7\u7b49\u5176\u4ed6\u503c\u65e0\u5173\u3002 </li> </ol> <p></p> <p>\u56fe 14-15 \u793a\u4f8b 1 \u4e2d\u7684 step1 \u4e0e step2</p> <p>\u901a\u9053\u7f16\u53f7\u534f\u5546</p> <ol> <li>DSP \u5f00\u59cb\u5728\u5404\u4e2a\u901a\u9053\u4e0a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u76f8\u540c\uff0c\u4f46\u662f\u4e3a\u5404\u901a\u9053\u5404\u81ea\u5206\u914d\u4e86 0\uff0c1\uff0c2\uff0c3 \u901a\u9053\u7f16\u53f7\u7684 TS1\uff0c\u5982\u539f\u6587 544 \u9875\u56fe 14-16 \u6240\u793a\u3002</li> <li>\u63a5\u6536\u5230\u901a\u9053\u7f16\u53f7\u4e0d\u4e3a PAD \u586b\u5145\u7b26\u53f7\u7684 TS1 \u540e\uff0cUSP \u5728\u56de\u590d\u4e4b\u524d\u9996\u5148\u9a8c\u8bc1\u63a5\u6536\u5230\u7684\u901a\u9053\u7f16\u53f7\u548c\u81ea\u8eab\u7269\u7406\u7f16\u53f7\u4e00\u81f4\u3002\uff08\u8bd1\u6ce8\uff1a\u6b64\u5904\u539f\u6587\u4e3a the Upstream Port will verify that the incoming Lane numbers match the Lane numbers they are received on.\uff09\u5728\u672c\u4f8b\u4e2d\uff0cDSP \u548c USP \u7684\u5404\u4e2a\u901a\u9053\u662f\u6b63\u786e\u8fde\u63a5\u7684\uff0c\u7f16\u53f7\u9a8c\u8bc1\u65e0\u8bef\uff0c\u6240\u4ee5 USP \u5728\u5404\u901a\u9053\u56de\u590d DSP \u7684 TS1 \u4e2d\u901a\u544a\u4e86\u81ea\u8eab\u7684\u901a\u9053\u7f16\u53f7\u3002\u5f53 DSP \u63a5\u6536\u5230\u7f16\u53f7\u4e0d\u4e3a PAD \u7b26\u53f7\u7684 TS1 \u540e\uff0c\u5c06\u63a5\u6536\u5230\u7684\u901a\u9053\u7f16\u53f7\u4e0e\u53d1\u9001\u7684\u6570\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u4ed6\u4eec\u5339\u914d\uff0c\u5219\u8fd9\u4e00\u8fc7\u7a0b\u987a\u5229\u5b8c\u6210\u3002\u5982\u679c\u4e0d\u5339\u914d\uff0c\u90a3\u4e48\u9700\u8981\u91c7\u53d6\u540e\u7eed\u63aa\u65bd\uff0c\u6bd4\u5982\u90e8\u5206\u901a\u9053\u4e0d\u5339\u914d\uff0c\u800c\u5269\u4f59\u901a\u9053\u5339\u914d\uff0c\u90a3\u4e48\u94fe\u8def\u5bbd\u5ea6\u9700\u8981\u5bf9\u5e94\u8c03\u6574\u3002\u5982\u679c\u901a\u9053\u95f4\u7684\u8fde\u63a5\u987a\u5e8f\u88ab\u98a0\u5012\u4e86\uff0c\u90a3\u4e48\u9700\u8981 DSP \u652f\u6301\u53ef\u9009\u7684\u901a\u9053\u987a\u5e8f\u98a0\u5012\u7279\u6027\uff0c\u56e0\u4e3a\u8fd9\u9879\u7279\u6027\u662f\u53ef\u9009\u7684\uff0c\u90a3\u4e48\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u8fd9\u4e48\u4e00\u79cd\u60c5\u51b5\uff0c\u901a\u9053\u8fde\u63a5\u987a\u5e8f\u88ab\u98a0\u5012\uff0c\u5374\u6ca1\u6709\u4efb\u4f55\u4e00\u65b9\u7684\u8bbe\u5907\u6709\u80fd\u529b\u5c06\u5176\u7ea0\u6b63\u3002\u8fd9\u662f\u4e00\u9879\u91cd\u5927\u7684\u7535\u8def\u677f\u8bbe\u8ba1\u5931\u8bef\uff0c\u6b64\u65f6\u94fe\u8def\u914d\u7f6e\u53ef\u80fd\u5c06\u65e0\u6cd5\u5b8c\u6210\u3002</li> </ol> <p></p> <p>\u56fe 14-16 \u793a\u4f8b 1 \u4e2d\u7684 step3 \u4e0e step4</p> <p>\u786e\u8ba4\u94fe\u8def\u4e0e\u901a\u9053\u7f16\u53f7</p> <ol> <li>\u56e0\u4e3a DSP \u5728\u6240\u6709\u901a\u9053\u4e0a\u63a5\u6536\u5230\u7684\u94fe\u8def\u7f16\u53f7\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\u548c\u53d1\u9001\u6570\u503c\u4e00\u81f4\uff0c\u6240\u4ee5 DSP \u5f00\u59cb\u53d1\u9001 TS2 \u5e8f\u5217\u8868\u793a\u81ea\u5df1\u5df2\u7ecf\u51c6\u5907\u597d\u786e\u8ba4\u534f\u5546\u7ed3\u679c\uff0c\u5e76\u4e14\u8f6c\u79fb\u5230\u4e0b\u4e00\u4e2a\u72b6\u6001 L0\uff0cTS2 \u4e2d\u7684\u94fe\u8def\u7f16\u53f7\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\u548c\u534f\u5546\u7ed3\u679c\u4e00\u81f4\u3002</li> <li>USP \u5728\u63a5\u6536\u94fe\u8def\u7f16\u53f7\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\u548c\u534f\u5546\u7ed3\u679c\u4e00\u81f4\u7684 TS2 \u540e\uff0c\u4e5f\u5f00\u59cb\u53d1\u9001 TS2 \u5e8f\u5217\u8868\u793a\u81ea\u5df1\u540c\u6837\u505a\u597d\u79bb\u5f00 Configuration \u72b6\u6001\uff0c\u8f6c\u79fb\u5230\u4e0b\u4e00\u4e2a\u72b6\u6001 L0\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5982\u539f\u6587 545 \u56fe 14-17 \u6240\u793a\u3002</li> <li>\u53cc\u65b9\u7aef\u53e3\u5728\u6536\u5230\u81f3\u5c11 8 \u4e2a TS2 \u4ee5\u53ca\u81f3\u5c11\u53d1\u9001 16 \u4e2a TS2 \u540e\uff0c\u53d1\u9001\u4e00\u4e9b\u903b\u8f91\u7a7a\u95f2\u6570\u636e\u540e\uff0c\u8f6c\u79fb\u72b6\u6001\u5230 L0\u3002</li> </ol> <p></p> <p>\u56fe 14-17 \u793a\u4f8b 1 \u4e2d\u7684 step5 \u4e0e step6</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14633-2","title":"14.6.3.3 \u94fe\u8def\u914d\u7f6e\u793a\u4f8b 2","text":"<p>\u7b2c\u4e8c\u4e2a\u9700\u8981\u638c\u63e1\u7684\u4f8b\u5b50\uff0c\u9996\u5148\u8fd8\u662f\u90a3\u4e2a\u6709 4 \u4e2a\u9762\u5411\u4e0b\u6e38\u901a\u9053\u7684\u8bbe\u5907\uff0c\u4e0d\u8fc7\u4e0d\u540c\u7684\u662f\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u8fd9\u4e2a\u8bbe\u5907\u53ef\u4ee5\u914d\u7f6e\u4e3a\u5355\u4e2a x4 \u94fe\u8def\uff0c\u6216\u8005\u914d\u7f6e\u4e3a\u4e24\u4e2a x2 \u94fe\u8def\u7684\u7ec4\u5408\uff0c\u6216\u8005\u914d\u7f6e\u4e3a\u56db\u4e2a x1 \u94fe\u8def\u7684\u7ec4\u5408\uff0c\u751a\u81f3\u8fd8\u6709\u4e00\u4e2a x2 \u94fe\u8def\u548c\u4e24\u4e2a x1 \u94fe\u8def\u7684\u7ec4\u5408\uff0c\u5982\u539f\u6587 546 \u9875\u56fe 14-18 \u6240\u793a\u3002</p> <p>\u5982\u679c\u56db\u4e2a\u901a\u9053\u5168\u90e8\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\u5b58\u5728\uff0c\u5e76\u5168\u90e8\u8fdb\u5165 Configuration\uff0c\u90a3\u4e48\u5c31\u4f1a\u6709\u8fd9\u4e48\u51e0\u79cd\u53ef\u80fd\u7684\u8fde\u63a5\uff1a</p> <ul> <li>\u4e00\u4e2a x4 \u94fe\u8def</li> <li>\u4e24\u4e2a x2 \u94fe\u8def</li> <li>\u4e00\u4e2a x2 \u94fe\u8def\u548c\u4e24\u4e2a x1 \u94fe\u8def</li> <li>\u56db\u4e2a x1 \u94fe\u8def</li> </ul> <p>\u63a5\u4e0b\u6765\u63cf\u8ff0\u7684\u662f\u534f\u8bae\u4e2d\u51b3\u5b9a\u5b9e\u65bd\u4f55\u79cd\u914d\u7f6e\u7684\u4e00\u4e2a\u793a\u4f8b\u65b9\u6cd5\u3002</p> <p>\u94fe\u8def\u7f16\u53f7\u534f\u5546</p> <ol> <li>\u5728\u672c\u793a\u4f8b\u65b9\u6cd5\u4e2d\uff0cDSP \u9996\u5148\u5728\u6bcf\u4e2a\u901a\u9053\u4e0a\u5206\u914d\u5e76\u901a\u544a\uff08advertise\uff09\u5355\u72ec\u7684\u94fe\u8def\u7f16\u53f7\u3002\u901a\u9053 0 \u4e0a\u7684\u94fe\u8def\u7f16\u53f7\u662f N\uff0c\u901a\u9053 1 \u4e0a\u5c31\u662f N+1\uff0c\u5e76\u4ee5\u6b64\u7c7b\u63a8\u3002\u5982\u539f\u6587 546 \u9875\u56fe 14-18 \u6240\u793a\uff0c\u56fe\u4e2d\u7684\u94fe\u8def\u7f16\u53f7\u53ea\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5b9e\u9645\u4e0a\u4ed6\u4eec\u53ef\u4ee5\u662f\u4e0d\u8fde\u7eed\u7684\u6570\u5b57\u3002\u53e6\u5916\uff0c\u4e00\u4ef6\u91cd\u8981\u7684\u4e8b\u60c5\u662f DSP \u6b64\u65f6\u5e76\u4e0d\u77e5\u9053\u548c\u5b83\u8fde\u63a5\u7684\u5bf9\u7aef\u8bbe\u5907\u60c5\u51b5\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d DSP \u5c06\u5c3d\u529b\u53bb\u641e\u6e05\u695a\u6bcf\u4e2a\u901a\u9053\u53ef\u5b9e\u73b0\u7684\u8fde\u63a5\u65b9\u5f0f\u3002</li> </ol> <p></p> <p>\u56fe 14-18 \u793a\u4f8b 2 \u4e2d\u7684 step 1</p> <ol> <li>\u5728\u6536\u5230 USP \u8fd4\u56de\u7684 TS1 \u5e8f\u5217\u540e\uff08\u8bd1\u6ce8\uff1a\u5982\u56fe 14-19 \u6240\u793a\uff0c\u56db\u4e2a\u901a\u9053\u5206\u6210\u4e86\u4e24\u7ec4\uff0c\u5206\u522b\u6709\u4e0d\u540c\u7684\u7684\u94fe\u8def\u7f16\u53f7\uff09\uff0cDSP \u5f97\u5230\u4e24\u4e2a\u4fe1\u606f\uff1a\u6240\u6709\u56db\u4e2a\u901a\u9053\u90fd\u5904\u4e8e\u5de5\u4f5c\u72b6\u6001\uff0c\u5e76\u4e14\u5b83\u4eec\u5206\u522b\u8fde\u63a5\u5230\u4e86\u4e24\u4e2a USP\uff0c\u4e5f\u5c31\u610f\u5473\u5f53\u524d\u7684 DSP \u5c06\u9700\u8981\u5206\u4e3a\u4e24\u4e2a DSP\u3002\u6bcf\u4e2a DSP \u62e5\u6709 0 \u548c 1 \u4e24\u4e2a\u901a\u9053\uff0c\u5982\u539f\u6587 548 \u56fe 14-20 \u6240\u793a\u3002</li> </ol> <p></p> <p>\u56fe 14-19 \u793a\u4f8b 2 \u4e2d\u7684 step 2</p> <p>\u901a\u9053\u7f16\u53f7\u534f\u5546</p> <ol> <li>\u5404\u4e2a\u901a\u9053\u4e0a\u7684\u901a\u9053\u7f16\u53f7\u534f\u5546\u4f1a\u72ec\u7acb\u8fdb\u884c\uff0c\u4e0d\u8fc7\u4ed6\u4eec\u7684\u8fc7\u7a0b\u662f\u76f8\u540c\uff1a DSP \u4f1a\u5728\u53d1\u9001\u7684 TS1 \u4e2d\u901a\u544a\u5176\u5206\u914d\u7ed9\u63a5\u6536\u901a\u9053\u7684\u901a\u9053\u7f16\u53f7\u3002\u5176\u4e2d\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u6b64\u65f6 DSP \u5728 TS1 \u7684\u94fe\u8def\u7f16\u53f7\u57df\u4e2d\uff0c\u5bf9\u4e8e\u94fe\u8def\u6240\u6709\u901a\u9053\uff0c\u53ea\u662f\u7b80\u5355\u5730\u8fd4\u56de USP \u53d1\u9001\u7684\u94fe\u8def\u7f16\u53f7\u503c\u3002\u5de6\u4fa7\u94fe\u8def\u4e24\u4e2a\u901a\u9053\u63a5\u6536\u5230\u7684\u90fd\u662f N\uff0c\u800c\u53f3\u8fb9\u94fe\u8def\u4e24\u4e2a\u901a\u9053\u63a5\u6536\u5230\u7684\u90fd\u662f N+2\u3002</li> <li>\u5728\u672c\u4f8b\u4e2d\uff0c\u5de6\u4fa7\u94fe\u8def\u7684 DSP \u548c USP \u4e4b\u95f4\u7684\u901a\u9053\u7f16\u53f7\u662f\u5bf9\u5e94\u7684\u3002\u4f46\u662f\u53f3\u4fa7\u94fe\u8def\u7684\u901a\u9053\u8fde\u63a5\u5219\u662f\u76f8\u53cd\u7684\uff0cDSP \u7684\u901a\u9053 0 \u8fde\u63a5\u5230\u4e86 USP \u7684\u901a\u9053 1\uff0c\u53e6\u4e00\u6761\u901a\u9053\u4e5f\u662f\u98a0\u5012\u8fde\u63a5\u7684\u3002USP \u5728\u63a5\u6536\u5230 TS1 \u540e\u610f\u8bc6\u5230\u4e86\u901a\u9053\u8fde\u63a5\u98a0\u5012\u7684\u73b0\u8c61\uff0c\u5982\u679c USP \u652f\u6301\u94fe\u8def\u7f16\u53f7\u98a0\u5012\u529f\u80fd\u7684\u8bdd\uff0c\u5b83\u4f1a\u5728\u5185\u90e8\u4ea4\u6362\u901a\u9053 0 \u548c 1 \u7684\u7f16\u53f7\uff0c\u4ece\u800c\u5728\u8fd4\u56de\u7ed9 DSP \u7684 TS1 \u4e2d\u4fdd\u6301\u539f\u672c DSP \u63d0\u8bae\u7684\u901a\u9053\u7f16\u53f7\u4e0d\u53d8\uff0c\u5982\u56fe 14-20 \u6240\u793a\u3002\u5982\u679c USP \u5e76\u4e0d\u652f\u6301\u8fd9\u9879\u7279\u6027\uff0c\u90a3\u4e48\u5b83\u4f1a\u5728\u8fd4\u56de\u7684 TS1 \u4e2d\u901a\u544a\u81ea\u5df1\u7684\u7269\u7406\u901a\u9053\u7f16\u53f7\u60c5\u51b5\uff08\u548c DSP \u63d0\u8bae\u7684\u901a\u9053\u7f16\u53f7\u987a\u5e8f\u76f8\u53cd\uff09\uff0c\u8fd9\u6837\u4e00\u6765 DSP \u4e5f\u80fd\u610f\u8bc6\u5230\u8fd9\u4e2a\u95ee\u9898\uff0c\u5e76\u6709\u673a\u4f1a\u5728 DSP \u5185\u90e8\u98a0\u5012\u901a\u9053\u7684\u903b\u8f91\u7f16\u53f7\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</li> <li>\u901a\u9053\u987a\u5e8f\u98a0\u5012\u662f\u4e00\u9879\u53cc\u65b9\u7aef\u53e3\u53ef\u9009\u7684\u7279\u6027\u3002\u5982\u679c USP \u68c0\u6d4b\u5230\u901a\u9053\u7f16\u53f7\u98a0\u5012\uff0c\u5e76\u6709\u80fd\u529b\u98a0\u5012\u81ea\u5df1\u901a\u9053\u7684\u903b\u8f91\u7f16\u53f7\uff0c\u90a3\u4e48 USP \u4f1a\u5728\u5185\u90e8\u98a0\u5012\u81ea\u5df1\u901a\u9053\u7684\u903b\u8f91\u7f16\u53f7\uff0c\u5e76\u8fd4\u56de\u901a\u9053\u7f16\u53f7\u4e0d\u53d8\u7684 TS1\u3002\u8fd9\u6837\u4e00\u6765\uff0cDSP \u90fd\u4e0d\u4f1a\u610f\u8bc6\u5230\u8fd9\u4e2a\u95ee\u9898\u7684\u5b58\u5728\u3002\u5982\u679c USP \u4e0d\u652f\u6301\u8fd9\u9879\u529f\u80fd\uff0c\u90a3\u4e48 DSP \u4f1a\u53d1\u73b0\u5176\u63a5\u6536\u5230\u7684 TS1 \u7684\u901a\u9053\u7f16\u53f7\u76f8\u6bd4\u5b83\u53d1\u9001\u7684 TS1 \u662f\u98a0\u5012\u7684\u3002\u5982\u679c DSP \u652f\u6301\u8fd9\u9879\u7279\u6027\uff0c\u90a3\u4e48\u5b83\u4f1a\u7ea0\u6b63\u81ea\u8eab\u901a\u9053\u903b\u8f91\u7f16\u53f7\u7684\u987a\u5e8f\uff0c\u5e76\u5728 TS2 \u4e2d\u53d1\u9001\u7ea0\u6b63\u540e\u7684\u901a\u9053\u7f16\u53f7\u505a\u4e3a\u786e\u8ba4\u3002</li> </ol> <p></p> <p>\u56fe 14-20 \u793a\u4f8b 2 \u4e2d\u7684 step 3\u30014\u30015</p> <p>\u786e\u8ba4\u94fe\u8def\u4e0e\u901a\u9053\u7f16\u53f7</p> <ol> <li>DSP \u5728\u63a5\u6536\u5230\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u4e0e\u6240\u901a\u544a\u7f16\u53f7\u4e00\u81f4\u7684 TS1 \u540e\uff0c\u5404\u4e2a DSP \u7aef\u53e3\u72ec\u7acb\u5730\u5f00\u59cb\u53d1\u9001 TS2\uff0c\u4f5c\u4e3a\u5b83\u4eec\u5df2\u7ecf\u51c6\u5907\u597d\u4f7f\u7528\u534f\u5546\u503c\uff0c\u5e76\u8fdb\u5165 L0 \u72b6\u6001\u7684\u901a\u77e5\u3002</li> <li>USP \u5728\u6536\u5230\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u6ca1\u6709\u53d8\u5316\u7684 TS2 \u540e\uff0c\u4e5f\u53ef\u4ee5\u53d1\u9001\u76f8\u540c\u7684 TS2 \u5e8f\u5217\u3002</li> <li>\u53cc\u65b9\u7aef\u53e3\u5728\u6536\u5230\u81f3\u5c11 8 \u4e2a TS2 \u4ee5\u53ca\u81f3\u5c11\u53d1\u9001 16 \u4e2a TS2 \u540e\uff0c\u53d1\u9001\u4e00\u4e9b\u903b\u8f91\u7a7a\u95f2\u6570\u636e\u540e\uff0c\u8f6c\u79fb\u72b6\u6001\u5230 L0\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u53f3\u4fa7\u94fe\u8def\u7684 USP \u8fdb\u884c\u4e86\u5185\u90e8\u901a\u9053\u7f16\u53f7\u98a0\u5012\u3002</li> </ol>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14634-3","title":"14.6.3.4 \u94fe\u8def\u914d\u7f6e\u793a\u4f8b 3\uff1a\u5982\u679c\u901a\u9053\u914d\u7f6e\u5931\u8d25","text":"<p>\u6700\u540e\u6211\u4eec\u6765\u518d\u770b\u770b\u518d\u914d\u7f6e\u8fc7\u7a0b\u4e2d\uff0c\u67d0\u4e2a\u901a\u9053\u5982\u679c\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u8fd9\u4e2a\u4f8b\u5b50\u57fa\u4e8e USP \u7684\u901a\u9053 2 \u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u5982\u539f\u6587 550 \u9875\u56fe 14-21 \u6240\u793a\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\u8fd9\u4e2a\u901a\u9053\u7684\u95ee\u9898\u5e76\u6ca1\u6709\u4e25\u91cd\u5230\u65ad\u5f00\u7269\u7406\u8fde\u63a5\uff0c\u56e0\u4e3a\u5982\u679c\u90a3\u6837\uff0cDSP \u5c06\u4e0d\u4f1a\u628a\u5b83\u8bc6\u522b\u4e3a\u63a5\u6536\u7aef\uff0c\u5e76\u4e0d\u4f1a\u628a\u5b83\u7eb3\u5165\u94fe\u8def\u3002\u7136\u800c\uff0c\u5373\u4f7f\u901a\u9053\u7684\u7269\u7406\u8fde\u63a5\u6027\u6ca1\u6709\u95ee\u9898\uff0c\u901a\u9053 2 \u7684\u63a5\u6536\u7aef\u6216\u8005\u53d1\u9001\u7aef\u5c06\u65e0\u6cd5\u5b8c\u6210\u914d\u7f6e\u5de5\u4f5c\u3002\uff08\u6216\u8005\u4e24\u8005\u90fd\u662f\uff09</p> <p>\u5728\u672c\u4f8b\u4e2d\uff0c\u94fe\u8def\u8bad\u7ec3\u8fc7\u7a0b\u53ef\u80fd\u4f1a\u663e\u8457\u53d8\u957f\uff0c\u56e0\u4e3a\u5728\u5927\u591a\u6570\u72b6\u6001\u8df3\u8f6c\u8fc7\u7a0b\u4e2d\uff0c\u90fd\u9700\u8981\u7b49\u5f85\u6240\u6709\u901a\u9053\u5c31\u7eea\uff0c\u5982\u679c\u53ea\u6709\u4e00\u90e8\u5206\u901a\u9053\u5c31\u7eea\uff0c\u5269\u4e0b\u4e00\u4e9b\u6ca1\u6709\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7b49\u5f85\u8d85\u65f6\u6761\u4ef6\u6ee1\u8db3\u624d\u80fd\u8df3\u8f6c\u72b6\u6001\u3002</p> <p>\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u63cf\u8ff0\u4e86\u901a\u8fc7 Configuration \u72b6\u6001\u673a\u5404\u6b21\u72b6\u6001\u8df3\u8f6c\uff0c\u5904\u7406\u8fd9\u79cd\u5f02\u5e38\u60c5\u51b5\u7684\u8fc7\u7a0b\u3002</p> <p>\u94fe\u8def\u7f16\u53f7\u534f\u5546</p> <ol> <li>\u867d\u7136 USP \u901a\u9053 2 \u63a5\u6536\u7aef\u5b58\u5728\u95ee\u9898\uff0c\u4f46\u662f DSP \u5728\u8fdb\u5165 Configuration \u72b6\u6001\u540e\u8fd8\u662f\u6309\u7167\u6d41\u7a0b\u884c\u4e8b\u3002DSP \u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u57df\u4e3a 'N'\uff0c\u901a\u9053\u7f16\u53f7\u57df\u586b\u5145\u7684 TS1 \u5e8f\u5217\u3002</li> <li>\u901a\u9053 0\u30011\u30013 \u6536\u5230\u4e86 DSP \u53d1\u9001\u94fe\u8def\u7f16\u53f7\u57df\u4e3a\u975e\u586b\u5145\u503c\u7684 TS1\uff0c\u6240\u4ee5\u6309\u7167\u534f\u8bae\u56de\u590d DSP \u76f8\u540c\u7684 TS1\u3002\u7136\u800c\uff0c\u901a\u9053 2 \u56e0\u4e3a\u63a5\u6536\u6545\u969c\uff0c\u6ca1\u80fd\u6536\u5230 DSP \u53d1\u9001\u7684 TS1\uff0c\u6240\u4ee5\u901a\u9053 2 \u53d1\u9001\u7aef\u7ee7\u7eed\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u5b57\u7b26\u7684 TS1\uff0c\u5982\u539f\u6587 550 \u9875\u56fe 14-21 \u6240\u793a\u3002</li> </ol> <p></p> <p>\u56fe 14-21 \u793a\u4f8b 3 \u7684 step 1 \u548c 2</p> <p>\u901a\u9053\u7f16\u53f7\u534f\u5546</p> <ol> <li>DSP \u5728\u6536\u5230\u901a\u9053 0\u30011\u30013 \u53d1\u9001\u7684\u5e26\u6709\u76f8\u540c\u94fe\u8def\u7f16\u53f7\u7684 TS1 \u540e\uff0c\u5f00\u59cb\u7b49\u5f85\u901a\u9053 2 \u4e5f\u5b8c\u6210\u540c\u6837\u7684\u5de5\u4f5c\uff0c\u76f4\u81f3\u8d85\u51fa\u534f\u8bae\u89c4\u5b9a\u7684\u6700\u5927\u8d85\u65f6\u65f6\u95f4\u3002\u5982\u679c\u6b64\u65f6\u901a\u9053 2 \u8fd8\u662f\u6ca1\u6709\u52a8\u4f5c\uff0c\u90a3\u4e48 DSP \u5c31\u4f1a\u610f\u8bc6\u5230\u8fd9\u4e2a\u94fe\u8def\u53ea\u80fd\u88ab\u8bad\u7ec3\u4e3a x2 \u5bbd\u5ea6\u7684\u94fe\u8def\u3002\u5728\u63a5\u53d7\u8fd9\u4e2a\u73b0\u5b9e\u60c5\u51b5\u540e\uff0cDSP \u4f1a\u5411\u901a\u9053 0 \u548c 1 \u901a\u544a\u4e3a\u4ed6\u4eec\u5206\u914d\u7684\u901a\u9053\u7f16\u53f7\uff0c\u4f46\u5728\u901a\u9053 2 \u548c 3 \u4e0a\u53ea\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4f7f\u7528\u586b\u5145\u5b57\u7b26\u7684 TS1\u3002</li> <li>\u5f53 USP \u5728\u901a\u9053 0 \u548c 1 \u4e0a\u6536\u5230\u643a\u5e26\u6709\u6548\u901a\u9053\u7f16\u53f7\u7684 TS1\uff0c\u800c\u901a\u9053 3 \u4e0a\u7684\u94fe\u8def\u7f16\u53f7\u53c8\u53d8\u56de\u586b\u5145\u7b26\u53f7\u65f6\uff0cUSP \u56de\u590d\u76f8\u540c\u7684\u901a\u9053\u7f16\u53f7\uff0c\u800c\u5176\u4ed6\u901a\u9053\u5f00\u59cb\uff08\u6307\u901a\u90533\uff0c\u5bf9\u4e8e\u901a\u9053 2 \u5219\u662f\u7ee7\u7eed\uff09\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4f7f\u7528\u586b\u5145\u5b57\u7b26\u7684 TS1\uff0c\u5982\u539f\u6587 551 \u9875\u56fe 14-22 \u6240\u793a\u3002</li> </ol> <p></p> <p>\u56fe 14-22 \u793a\u4f8b 3 \u7684 step 3 \u548c 4</p> <p>\u786e\u8ba4\u94fe\u8def\u4e0e\u901a\u9053\u7f16\u53f7</p> <ol> <li>\u56e0\u4e3a\u5728\u901a\u9053 0 \u548c 1 \u4e0a\u6536\u5230\u7684 TS1 \u901a\u9053\u548c\u94fe\u8def\u7f16\u53f7\u548c\u9884\u671f\u5339\u914d\uff0c\u6240\u4ee5 DSP \u5f00\u59cb\u53d1\u9001 TS2\uff0c\u4f5c\u4e3a\u5b83\u4eec\u5df2\u7ecf\u51c6\u5907\u597d\u4f7f\u7528\u534f\u5546\u503c\uff0c\u5e76\u8fdb\u5165 L0 \u72b6\u6001\u7684\u901a\u77e5\uff0c\u901a\u9053\u548c\u94fe\u8def\u7f16\u53f7\u4fdd\u6301\u4e0d\u53d8\u3002\u800c\u5728\u5176\u4ed6\u901a\u9053\u4e0a\uff0c\u5219\u7ee7\u7eed\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4f7f\u7528\u586b\u5145\u5b57\u7b26\u7684 TS1\u3002</li> <li>USP \u5728\u901a\u9053 0 \u548c 1 \u4e0a\u6536\u5230\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u6ca1\u6709\u53d8\u5316\u7684 TS2 \u540e\uff0c\u4e5f\u53d1\u9001\u76f8\u540c\u7684 TS2 \u5e8f\u5217\u7ed9 DSP\uff0c\u8868\u793a\u613f\u610f\u7ed3\u675f\u534f\u5546\uff0c\u8fdb\u5165 L0 \u72b6\u6001\u3002\u800c\u5728\u5176\u4ed6\u901a\u9053\u4e0a\u7ee7\u7eed\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4f7f\u7528\u586b\u5145\u5b57\u7b26\u7684 TS1\uff0c\u5982\u539f\u6587 552 \u9875\u56fe 14-23 \u6240\u793a\u3002</li> </ol> <p></p> <p>\u56fe 14-23 \u56fe 14-22 \u793a\u4f8b 3 \u7684 step 5 \u548c 6</p> <p>\u5728\u53cc\u65b9\u7aef\u53e3\u5728\u6536\u5230\u81f3\u5c11 8 \u4e2a TS2 \u4ee5\u53ca\u81f3\u5c11\u53d1\u9001 16 \u4e2a TS2 \u540e\uff0c\u53d1\u9001\u4e00\u4e9b\u903b\u8f91\u7a7a\u95f2\u6570\u636e\u540e\uff0c\u8f6c\u79fb\u72b6\u6001\u5230 L0\u3002\u5176\u4ed6\u672a\u5b8c\u6210\u914d\u7f6e\u7684\u901a\u9053\uff0c\u5982\u672c\u4f8b\u4e2d\u7684\u901a\u9053 2 \u548c 3\uff0c\u8f6c\u4e3a\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u76f4\u5230\u4e0b\u4e00\u6b21 DSP \u53d1\u8d77\u94fe\u8def\u8bad\u7ec3\u64cd\u4f5c\uff0c\u90a3\u4e2a\u65f6\u5019\u4f1a\u7ee7\u7eed\u5c1d\u8bd5\u6b63\u5e38\u7684\u8bad\u7ec3\u8fc7\u7a0b\uff0c\u4ee5\u671f\u6545\u969c\u6392\u9664\u5e76\u5b8c\u6210\u914d\u7f6e\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1464-configuration","title":"14.6.4  Configuration \u72b6\u6001\u5404\u6b21\u72b6\u6001\u8be6\u7ec6\u8ba8\u8bba","text":"<p>\u672c\u5c0f\u8282\u5c06\u8be6\u7ec6\u8ba8\u8bba Configuration \u5404\u6b21\u72b6\u6001\uff0c\u5176\u5982\u539f\u6587 553 \u9875\u56fe 14-24 \u6240\u793a\u3002\u5728\u524d\u4e00\u5c0f\u8282\u8ba8\u8bba\u8fc7\u94fe\u8def\u8bad\u7ec3\u7684\u4f8b\u5b50\u4e4b\u540e\uff0c\u8fd9\u4e9b\u6b21\u72b6\u6001\u5e94\u8be5\u5f88\u5bb9\u6613\u7406\u89e3\u3002</p> <p></p> <p>\u56fe 14-24 Configuration \u72b6\u6001\u673a</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14641-configurationlinkwidthstart","title":"14.6.4.1 Configuration.Linkwidth.Start","text":"<p>\u6709\u4e24\u79cd\u60c5\u51b5\u4f1a\u8fdb\u5165\u8be5\u72b6\u6001\uff0c\u4e00\u79cd\u662f Polling \u72b6\u6001\u6b63\u5e38\u7ed3\u675f\u8df3\u8f6c\uff08\u5728\u539f\u6587 527 \u9875 \u201cPolling.Configuration\u201d \u8be6\u8ff0\uff09\uff0c\u53e6\u4e00\u79cd\u5219\u662f\u5728 Recovery \u72b6\u6001\u4e2d\u53d1\u73b0\u94fe\u8def\u6216\u8005\u901a\u9053\u7f16\u53f7\u76f8\u8f83\u4e8e\u524d\u6b21\u6307\u5b9a\u65f6\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u56e0\u6b64\u65e0\u6cd5\u6b63\u5e38\u5b8c\u6210 Recovery \u72b6\u6001\u65f6\u8df3\u8f6c\uff08\u5728\u539f\u6587 571 \u9875 \u201cRecovery State\u201d \u8be6\u7ec6\u63cf\u8ff0\u4e86\u8fd9\u79cd\u72b6\u6001\uff09\u3002</p> <p>A. Downstream \u901a\u9053</p> <p>Configuration.Linkwidth.Start \u671f\u95f4</p> <p>DSP \uff08Downstream Port\uff09\u5c06\u4f5c\u4e3a\u94fe\u8def\u7684\u53d1\u8d77\u8005\uff08Leader\uff09\uff0c\u5728\u6240\u6709\u5de5\u4f5c\u7684\u901a\u9053\u4e0a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u4e0d\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1 \u5e8f\u5217\uff08\u4ec5\u5728 LinkUp \u6807\u5fd7\u5c1a\u672a\u7f6e\u8d77\uff0c\u4ee5\u53ca\u94fe\u8def\u5bbd\u5ea6\u7684\u914d\u7f6e\u5c1a\u672a\u8fdb\u884c\u65f6\uff09\u3002TS1 \u4e2d\u7684\u94fe\u8def\u7f16\u53f7\u867d\u7136\u4ece\u586b\u5145\u7b26\u53f7\u53d8\u6210\u4e86\u6709\u6548\u7f16\u53f7\uff0c\u4f46\u662f\u901a\u9053\u7f16\u53f7\u4ecd\u7136\u5c1a\u4e3a\u586b\u5145\u7b26\u53f7\u3002\u534f\u8bae\u4e2d\u5bf9\u94fe\u8def\u7f16\u53f7\u5177\u4f53\u6570\u503c\u7684\u552f\u4e00\u89c4\u5b9a\u662f\uff1a\u5982\u679c\u8bbe\u5907\u652f\u6301\u591a\u901a\u9053\uff0c\u90a3\u4e48\u5206\u914d\u7ed9\u4e0d\u540c\u94fe\u8def\u7684\u7f16\u53f7\u4e0d\u80fd\u76f8\u540c\u3002\u4e3e\u4f8b\u800c\u8a00\uff0c\u4e00\u4e2a x8 \u5bbd\u5ea6\u94fe\u8def\u5728\u6240\u6709 8 \u4e2a\u901a\u9053\u4e0a\u7684\u94fe\u8def\u7f16\u53f7\u4e00\u81f4\uff0c\u4f46\u662f\u5982\u679c\u5176\u80fd\u591f\u88ab\u914d\u7f6e\u4e3a\u4e24\u4e2a x4 \u94fe\u8def\uff0c 4 \u4e2a\u901a\u9053\u4e00\u7ec4\uff0c\u4e24\u7ec4\u901a\u9053\u95f4\u7684\u94fe\u8def\u7f16\u53f7\u9700\u8981\u4e0d\u540c\uff0c\u6bd4\u5982\u4e00\u7ec4\u7684\u7f16\u53f7\u662f 5\uff0c\u53e6\u4e00\u7ec4\u7684\u7f16\u53f7\u662f 6\u3002\u94fe\u8def\u7f16\u53f7\u7684\u6570\u503c\u662f\u4e24\u4e2a\u94fe\u8def\u4f19\u4f34\u4e4b\u95f4\u7684\u672c\u5730\u503c\uff0c\u8f6f\u4ef6\u65e0\u9700\u8ffd\u8e2a\u6240\u6709\u94fe\u8def\u7684\u7f16\u53f7\u6570\u503c\uff0c\u4e5f\u6ca1\u6709\u5fc5\u8981\u4f7f\u6574\u4e2a\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u94fe\u8def\u7f16\u53f7\u503c\u4fdd\u6301\u4e0d\u540c\u3002</p> <p>\u5982\u679c upconfigure_capable \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1b, \u90a3\u4e48\u4e5f\u4f1a\u5728\u4e0d\u5de5\u4f5c\u7684\u901a\u9053\u4e0a\u53d1\u9001 TS1\uff0c\u53ea\u8981\u5728\u8fd9\u4e9b\u901a\u9053\u4e0a\u66fe\u7ecf\u6536\u5230\u8fc7\u4e24\u4e2a\u8fde\u7eed\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p> <ul> <li>\u4ece Polling \u72b6\u6001\u8fdb\u5165\u6b64\u6b21\u72b6\u6001\u65f6\uff0c\u6240\u6709\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\u7684\u901a\u9053\u4f1a\u88ab\u89c6\u4f5c\u5de5\u4f5c\u901a\u9053\uff08Active Lane\uff09\u3002</li> <li>\u4ece Recovery \u72b6\u6001\u8fdb\u5165\u6b64\u6b21\u72b6\u6001\u65f6\uff0c\u6240\u6709\u5386\u7ecf Configuration.Complete \u72b6\u6001\u7684\u94fe\u8def\u4e0a\u7684\u901a\u9053\uff0c\u90fd\u4f1a\u88ab\u89c6\u4f5c\u5de5\u4f5c\u901a\u9053\uff08Active Lane\uff09\u3002</li> <li>DSP \u5fc5\u987b\u5728\u53d1\u9001\u7684 TS1 \u4e2d\u901a\u544a\u81ea\u8eab\u6240\u6709\u652f\u6301\u7684\u901f\u7387\uff0c\u5176\u4e2d\u4e5f\u9700\u8981\u5305\u62ec\u7aef\u53e3\u4e0d\u6253\u7b97\u4f7f\u7528\u7684\u901f\u7387\u3002</li> </ul> <p>Crosslinks \u4ea4\u53c9\u94fe\u8def. \u5bf9\u4e8e\u652f\u6301\u4ea4\u53c9\u94fe\u8def\u7279\u6027\u7684 DSP \u6765\u8bf4\uff0c\u5f53 LinkUp = 0b \u65f6\uff0c\u9700\u8981\u5728\u6240\u6709\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\u7684\u901a\u9053\u4e0a\u81f3\u5c11\u53d1\u9001 16-32 \u4e2a TS1\uff0c\u5176\u4e2d\u94fe\u8def\u7f16\u53f7\u975e\u586b\u5145\u7b26\u53f7\uff0c\u800c\u901a\u9053\u7f16\u53f7\u662f\u586b\u5145\u7b26\u53f7\u3002\u4e4b\u540e\uff0cDSP \u5c06\u6839\u636e\u63a5\u6536\u5230\u7684\u5185\u5bb9\u5224\u65ad\u5bf9\u7aef\u662f\u5426\u5b58\u5728\u4ea4\u53c9\u94fe\u8def\u3002</p> <p>Upconfiguring the Link Width \u6062\u590d\u94fe\u8def\u5bbd\u5ea6. \u5728 LinkUp = 1b \u65f6\uff0c\u5982\u679c LTSSM \u60f3\u8981\u6062\u590d\u8f83\u5927\u7684\u94fe\u8def\u5bbd\u5ea6\uff0c\u90a3\u4e48\u4f1a\u5728\u6240\u6709\u5f53\u524d\u5de5\u4f5c\u7684\u901a\u9053\u4e0a\u3001\u60f3\u8981\u6fc0\u6d3b\u7684\u975e\u5de5\u4f5c\u901a\u9053\u4ee5\u53ca\u63a5\u6536\u5230 TS1 \u7684\u901a\u9053\u4e0a\uff0c\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u4f7f\u7528\u586b\u5145\u7b26\u53f7\u586b\u5145\u7684 TS1\u3002\u5f53 DSP \u5728\u67d0\u4e2a\u901a\u9053\u4e0a\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1 \u56de\u590d\u540e\uff0c\u5ef6\u65f6 1ms\uff0c\u7136\u540e\u53d1\u9001\u6307\u5b9a\u94fe\u8def\u7f16\u53f7\u7684 TS1\u3002</p> <ul> <li>\u5728\u6fc0\u6d3b\u4e0d\u5de5\u4f5c\u7684\u901a\u9053\u65f6\uff0c\u53d1\u9001\u7aef\u5fc5\u987b\u7b49\u5f85\u53d1\u9001\u5171\u6a21\u7535\u538b\uff08Tx common mode voltage\uff09\u7a33\u5b9a\uff0c\u624d\u80fd\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u5e76\u5f00\u59cb\u53d1\u9001 TS1\u3002</li> <li>\u5bf9\u4e8e\u7ec4\u5408\u4e3a\u540c\u4e00\u94fe\u8def\u7684\u901a\u9053\uff0c\u4ed6\u4eec\u7684\u94fe\u8def\u7f16\u53f7\u5fc5\u987b\u76f8\u540c\u3002\u53ea\u80fd\u5728\u652f\u6301\u591a\u94fe\u8def\u914d\u7f6e\u7684\u4e0d\u540c\u94fe\u8def\u4e4b\u95f4\u5206\u914d\u4e0d\u540c\u7684\u94fe\u8def\u7f16\u53f7\u3002</li> </ul> <p>\u8fdb\u5165*\u201c\u5728\u672a\u6ee1\u8db3\u4ee5\u4e0b\u4efb\u4f55\u6709\u6548\u8df3\u8f6c\u6761\u4ef6\u65f6\uff0c\u5219\u89e6\u53d1 24ms \u8d85\u65f6\u201d \u72b6\u6001* </p> <p>\u4efb\u4f55\u6536\u5230\u8fc7\u81f3\u5c11\u4e00\u4e2a\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u5747\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1 \u5e8f\u5217\u7684\u901a\u9053\uff0c\u5982\u679c\u73b0\u5728\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684\u94fe\u8def\u7f16\u53f7\u6709\u6548\uff0c\u800c\u901a\u9053\u7f16\u53f7\u4ecd\u7136\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1\uff0c\u90a3\u4e48 LTSSM \u5c06\u8f6c\u79fb\u81f3 Configuration.Linkwidth.Accept \u6b21\u72b6\u6001\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Linkwidth.Start\u201c \u72b6\u6001</p> <p>\u5982\u679c DSP \u63a5\u6536\u5230\u7684\u7b2c\u4e00\u6279 TS1 \u4e2d\uff0c\u94fe\u8def\u7f16\u53f7\u5c31\u5df2\u7ecf\u4e0d\u662f\u586b\u5145\u7b26\u53f7\u4e86\uff0c\u90a3\u4e48 DSP \u901a\u8fc7\u8fd9\u79cd\u73b0\u8c61\u5c31\u610f\u8bc6\u5230\u5b58\u5728\u4ea4\u53c9\u94fe\u8def\uff08Crosslink\uff09\uff0c\u94fe\u8def\u5bf9\u7aef\u8bbe\u5907\u6b64\u65f6\u4e5f\u662f DSP\u3002\u9488\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u9762\u5411\u4e0b\u6e38\u7684\u901a\u9053\u5c06\u8f6c\u6362\u4e3a\u9762\u5411\u4e0a\u6e38\u901a\u9053\uff0cDSP \u7b49\u5f85\u957f\u5ea6\u968f\u673a\u7684\u8d85\u65f6\u65f6\u95f4\u540e\uff0c\u91cd\u65b0\u8fdb\u5165 Configuration.Linkwidth.Start \u72b6\u6001\uff0c\u53ea\u4e0d\u8fc7\u6b64\u65f6\u8be5\u901a\u9053\u5c06\u53d8\u6210\u9762\u5411\u4e0a\u6e38\u7684\u901a\u9053\u3002</p> <p>\u8fd9\u9879\u7279\u6027\u652f\u6301\u94fe\u8def\u53cc\u65b9\u90fd\u662f DSP \u7684\u60c5\u51b5\uff0c\u662f\u4e00\u79cd\u53ef\u9009\u914d\u7684\u7279\u6027\u3002\u89e3\u51b3\u529e\u6cd5\u662f\u5c06\u53cc\u65b9\u90fd\u4ece DSP \u8f6c\u6362\u6210 USP\uff0c\u5e76\u4e3a\u53cc\u65b9\u6307\u5b9a\u4e00\u4e2a\u957f\u5ea6\u968f\u673a\u7684\u8d85\u65f6\u3002\u5728\u8d85\u65f6\u7ed3\u675f\u540e\uff0c\u5c06\u8d85\u65f6\u7aef\u53e3\u8f6c\u6362\u4e3a DSP\u3002\u56e0\u4e3a\u53cc\u65b9\u7684\u8d85\u65f6\u65f6\u95f4\u957f\u5ea6\u662f\u4e0d\u540c\u7684\uff0c\u6700\u7ec8\u5c06\u6709\u4e00\u4e2a\u7aef\u53e3\u6210\u4e3a DSP \uff0c\u800c\u53e6\u4e00\u4e2a\u7aef\u53e3\u4ecd\u7136\u662f USP\uff0c\u8fd9\u6837\u4e00\u6765\u8bad\u7ec3\u5c31\u53ef\u4ee5\u7ee7\u7eed\u8fdb\u884c\u3002\u8d85\u65f6\u65f6\u95f4\u957f\u5ea6\u5fc5\u987b\u662f\u968f\u673a\uff0c\u8fd9\u6837\u5373\u4f7f\u94fe\u8def\u53cc\u65b9\u7684\u7aef\u53e3\u5b9e\u73b0\u5b8c\u5168\u76f8\u540c\uff0c\u4e5f\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\u7684\u60c5\u51b5\u3002</p> <p>\u5982\u679c\u652f\u6301\u4ea4\u53c9\u94fe\u8def\u7279\u6027\uff0c\u90a3\u4e48\u5728\u63a5\u6536\u7684 TS1 \u7684\u94fe\u8def\u7f16\u53f7\u4ece PAD \u8f6c\u6362\u5230\u975e PAD \u7b26\u53f7\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u5141\u8bb8\u51fa\u73b0 TS2 \u6253\u65ad\u8fd9\u4e2a\u8fc7\u7a0b\u3002  </p> <p>\u8f6c\u79fb\u81f3 Disable \u72b6\u6001</p> <p>\u5982\u679c\u7aef\u53e3\u53d7\u5230\u66f4\u9ad8\u5c42\u903b\u8f91\u7684\u6307\u793a\uff0c\u53d1\u9001 Disable Link \u6bd4\u7279\u7f6e\u4f4d\u7684 TS1 \u6216\u8005 TS2\uff0c\u90a3\u4e48\u5c06\u8f6c\u79fb\u81f3 Disable \u72b6\u6001\u3002\u4e00\u822c\u6765\u8bf4\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u7531 DSP \u53d1\u8d77\u7684\uff0c\u4f46\u662f\u5728\u53ef\u9009\u652f\u6301 Crosslink \u7684\u573a\u666f\u4e2d\uff0c\u8fd9\u53ef\u80fd\u662f\u7531 USP \u53d1\u8d77\u7684\u3002DSP \u5728\u6536\u5230\u8fde\u7eed\u4e24\u4e2a Loopback \u6bd4\u7279\u7f6e\u4f4d\uff08\u8bd1\u6ce8\uff1a\u539f\u6587\u5982\u6b64\uff0c\u5e94\u8be5\u662f Disable \u6bd4\u7279\u7f6e\u4f4d\uff09\u7684 TS1 \u540e\uff0c\u4e0b\u4e00\u4e2a\u72b6\u6001\u5c06\u8df3\u8f6c\u4e3a Disable \u72b6\u6001\u3002</p> <p>\u8f6c\u79fb\u81f3 Loopback \u72b6\u6001</p> <p>\u5982\u679c\u652f\u6301 Loopback \u7684\u53d1\u9001\u7aef\u53d7\u5230\u66f4\u9ad8\u5c42\u903b\u8f91\u7684\u6307\u793a\uff0c\u53d1\u9001 Loopback \u6bd4\u7279\u7f6e\u4f4d\u7684 TS1 \u6216\u8005 TS2\uff0c\u6216\u8005\u6b63\u5728\u53d1\u9001 TS1 \u7684\u901a\u9053\u6536\u5230\u8fde\u7eed\u4e24\u4e2a Loopback \u6bd4\u7279\u7f6e\u4f4d\u7684 TS1 \u540e\uff0c\u5c06\u8f6c\u79fb\u81f3 Loopback \u72b6\u6001\u3002\u4efb\u610f\u53d1\u9001 Loopback \u6bd4\u7279\u7f6e\u4f4d\u7684\u7aef\u53e3\u5c06\u53d8\u6210 Loopback master\uff0c\u800c\u6536\u5230\u4ed6\u4eec\u7684\u7aef\u53e3\u5c06\u53d8\u6210 Loopback slave\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c\u5728 24ms \u8d85\u65f6\u5230\u671f\u540e\uff0c\u4ecd\u7136\u6ca1\u6709\u4efb\u4f55\u6ee1\u8db3\u6709\u6548\u8df3\u8f6c\u6761\u4ef6\uff0c\u90a3\u4e48\u8f6c\u79fb\u81f3 Detect \u72b6\u6001\u3002</p> <p>B. Upstream \u901a\u9053</p> <p>Configuration.Linkwidth.Start \u671f\u95f4</p> <p>USP (Upstream Port) \u5728\u8be5\u72b6\u6001\u662f\u94fe\u8def\u8bad\u7ec3\u7684\u54cd\u5e94\u8005\uff08follower\uff09\uff0c\u5f00\u59cb\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u586b\u5145\u5b57\u7b26\u7684 TS1\u3002USP \u6301\u7eed\u53d1\u9001 TS1 \u76f4\u81f3\u63a5\u6536\u5230 DSP\uff08\u94fe\u8def\u8bad\u7ec3\u53d1\u8d77\u8005\uff0cleader\uff09\u94fe\u8def\u7f16\u53f7\u4e0d\u4e3a\u586b\u5145\u5b57\u7b26\u7684 TS1\u3002</p> <p>USP \u4f1a\u5728\u4e09\u7c7b\u901a\u9053\u4e0a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u586b\u5145\u5b57\u7b26\u7684 TS1\uff0c\u5206\u522b\u662f\uff1a</p> <ol> <li> <p>\u6240\u6709\u5de5\u4f5c\u901a\u9053\uff08active lane\uff09</p> </li> <li> <p>USP \u60f3\u8981\u6062\u590d\u94fe\u8def\u5bbd\u5ea6\uff08upconfigure\uff09\u800c\u914d\u7f6e\u7684\u901a\u9053 </p> </li> <li> <p>\u6240\u6709\u66fe\u7ecf\u63a5\u6536\u5230\u8fc7\u8fde\u7eed\u4e24\u4e2a\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u586b\u5145\u5b57\u7b26\u7684 TS1 \u7684\u975e\u5de5\u4f5c\u72b6\u6001\uff08inactive\uff09\u901a\u9053\uff0c\u5f53\u53d8\u91cf upconfigure_capable \u4e3a 1 \u65f6\u3002</p> </li> </ol> <p>\u53e6\u5916\u6ce8\u610f\uff1a</p> <ul> <li>\u4ece Polling \u72b6\u6001\u8fdb\u5165\u6b64\u6b21\u72b6\u6001\u65f6\uff0c\u6240\u6709\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\u7684\u901a\u9053\u4f1a\u88ab\u89c6\u4f5c\u5de5\u4f5c\u901a\u9053\uff08Active Lane\uff09\u3002</li> <li>\u4ece Recovery \u72b6\u6001\u8fdb\u5165\u6b64\u6b21\u72b6\u6001\u65f6\uff0c\u6240\u6709\u5386\u7ecf Configuration.Complete \u72b6\u6001\u7684\u94fe\u8def\u4e0a\u7684\u901a\u9053\uff0c\u90fd\u4f1a\u88ab\u89c6\u4f5c\u5de5\u4f5c\u901a\u9053\uff08Active Lane\uff09\u3002\u5982\u679c\u6b64\u65f6\u7684\u72b6\u6001\u8df3\u8f6c\u4e0d\u662f\u7531 LTSSM \u8d85\u65f6\u89e6\u53d1\u7684\uff0c\u90a3\u4e48\u6b64\u65f6\u53d1\u9001\u65b9\u5e94\u8be5\u5728 Configuration \u72b6\u6001\u4e2d\u53d1\u9001\u7684 TS1 \u4e2d\u7f6e\u4f4d  Autonomous Change \u6bd4\u7279 (Symbol 4, bit 6) \uff0c\u8868\u793a\u53d1\u9001\u65b9\u51fa\u4e8e\u81ea\u8eab\uff08Autonomous \uff09\u539f\u56e0\u60f3\u8981\u6539\u53d8\u94fe\u8def\u5bbd\u5ea6\uff0c\u4ece\u800c\u8fdb\u5165 Configuration \u72b6\u6001\u3002</li> <li>DSP \u5fc5\u987b\u5728\u53d1\u9001\u7684 TS1 \u4e2d\u901a\u544a\u81ea\u8eab\u6240\u6709\u652f\u6301\u7684\u901f\u7387\uff0c\u5176\u4e2d\u9700\u8981\u5305\u62ec\u7aef\u53e3\u4e0d\u6253\u7b97\u4f7f\u7528\u7684\u901f\u7387\u3002</li> </ul> <p>Crosslinks \u4ea4\u53c9\u94fe\u8def. \u5bf9\u4e8e\u652f\u6301\u4ea4\u53c9\u94fe\u8def\u7279\u6027\u7684 USP \u6765\u8bf4\uff0c\u5f53 LinkUp = 0b \u65f6\uff0c\u9700\u8981\u5728\u6240\u6709\u68c0\u6d4b\u5230\u63a5\u6536\u7aef\u7684\u901a\u9053\u4e0a\u81f3\u5c11\u53d1\u9001 16-32 \u4e2a TS1\uff0c\u5176\u4e2d\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u91c7\u7528\u586b\u5145\u7b26\u53f7\u3002\u4e4b\u540e\uff0cUSP \u5c06\u6839\u636e\u63a5\u6536\u5230\u7684\u5185\u5bb9\u5224\u65ad\u5bf9\u7aef\u662f\u5426\u5b58\u5728\u4ea4\u53c9\u94fe\u8def\u3002</p> <p>\u8fdb\u5165*\u201c\u5728\u672a\u6ee1\u8db3\u4ee5\u4e0b\u4efb\u4f55\u6709\u6548\u8df3\u8f6c\u6761\u4ef6\u65f6\uff0c\u5219\u89e6\u53d1 24ms \u8d85\u65f6\u201d \u72b6\u6001* </p> <p>\u5982\u679c\u4e00\u4e9b\u901a\u9053\u63a5\u6536\u5230\u4e86\u4e24\u4e2a\u8fde\u7eed\u7684\u94fe\u8def\u7f16\u53f7\u6709\u6548\uff0c\u901a\u9053\u7f16\u53f7\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7aef\u53e3\u5c31\u4f1a\u8fdb\u5165 Configuration.Linkwidth.Accept \u6b21\u72b6\u6001\uff0cUSP \u9009\u53d6\u5176\u4e2d\u4e00\u4e2a\u63a5\u6536\u5230\u7684\u94fe\u8def\u7f16\u53f7\u4f5c\u4e3a\u8fd9\u4e9b\u901a\u9053\u7684\u94fe\u8def\u7f16\u53f7\uff0c\u5e76\u5728\u6240\u6709\u6536\u5230\u94fe\u8def\u7f16\u53f7\u975e\u7a7a\u7684 TS1 \u7684\u901a\u9053\u4e0a\uff0c\u56de\u590d\u91c7\u7528\u8be5\u94fe\u8def\u7f16\u53f7\u7684 TS1\uff0c\u901a\u9053\u7f16\u53f7\u7ee7\u7eed\u4f7f\u7528\u586b\u5145\u5b57\u7b26\u3002\u5bf9\u4e8e\u5269\u4e0b\u7684\u901a\u9053\uff0c\u5982\u679c\u4ed6\u4eec\u68c0\u6d4b\u5230\u4e86\u63a5\u6536\u65b9\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u6536\u5230\u94fe\u8def\u7f16\u53f7\uff0c\u90a3\u4e48\u5219\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u90fd\u91c7\u7528\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p> <ul> <li> <p>\u5982\u679c USP \u6253\u7b97\u6062\u590d\u94fe\u8def\u5bbd\u5ea6\uff0cLTSSM \u9996\u5148\u7b49\u5f85\u4e0b\u8ff0\u4e24\u4e2a\u6761\u4ef6\u4efb\u610f\u6ee1\u8db3\u4e00\u4e2a\uff1a</p> </li> <li> <p>\u6240\u6709\u5f85\u6fc0\u6d3b\u7684\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684\u94fe\u8def\u7f16\u53f7\u6709\u6548\uff0c\u901a\u9053\u7f16\u53f7\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1</p> </li> <li>\u4efb\u610f\u4e00\u4e2a\u5f85\u6fc0\u6d3b\u901a\u9053\u8fdb\u5165\u672c\u72b6\u6001\u8d85\u8fc7 1ms</li> </ul> <p>\u63a5\u7740\uff0cUSP \u5f00\u59cb\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u4e3a\u9009\u5b9a\u7684\u6709\u6548\u7f16\u53f7\uff0c\u901a\u9053\u7f16\u53f7\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p> <ul> <li> <p>\u4e3a\u4e86\u907f\u514d\u5c06\u94fe\u8def\u7684\u5bbd\u5ea6\u914d\u7f6e\u5c0f\u4e8e\u6b63\u5e38\u5bbd\u5ea6\uff0c\u534f\u8bae\u5efa\u8bae\u5982\u679c\u5728\u591a\u901a\u9053\u94fe\u8def\u4e0a\u53d1\u73b0\u67d0\u4e9b\u901a\u9053\u51fa\u73b0\u9519\u8bef\u6216\u8005\u5931\u53bb Block Alignment \u72b6\u6001\uff0c\u90a3\u4e48\u5ef6\u8fdf\u4e00\u6bb5\u65f6\u95f4\u540e\u518d\u8fdb\u884c\u672c\u8fc7\u7a0b\u30028b/10b \u7f16\u7801\u65f6\u7b49\u5f85\u81f3\u5c11 2 \u4e2a TS1\uff0c128b/130b \u7f16\u7801\u65f6\u81f3\u5c11\u7b49\u5f85 34 \u4e2a TS1\uff0c\u4f46\u4efb\u4f55\u60c5\u51b5\u4e0b\u4e0d\u8981\u7b49\u5f85\u8d85\u8fc7 1ms\u3002</p> </li> <li> <p>\u5728\u6fc0\u6d3b\u4e0d\u5de5\u4f5c\u7684\u901a\u9053\u540e\uff0c\u53d1\u9001\u7aef\u5fc5\u987b\u7b49\u5f85\u53d1\u9001\u5171\u6a21\u7535\u538b\uff08Tx common mode voltage\uff09\u7a33\u5b9a\uff0c\u624d\u80fd\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u5e76\u5f00\u59cb\u53d1\u9001 TS1\u3002</p> </li> </ul> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Linkwidth.Start\u201c \u72b6\u6001</p> <p>\u5728\u7b49\u5f85 Crosslink \u89c4\u5b9a\u7684\u8d85\u65f6\u65f6\u95f4\u540e\uff0c\u53d1\u9001 16 \u5230 32 \u4e2a TS2\uff0c\u5176\u4e2d\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u91c7\u7528\u586b\u5145\u7b26\u53f7\u3002\u4e4b\u540e\uff0cUpstream \u94fe\u8def\u8f6c\u6362\u4e3a Downstream \u94fe\u8def\uff0c\u4e0b\u4e00\u4e2a\u72b6\u6001\u4ecd\u7136\u662f  Configuration.Linkwidth.Start \u72b6\u6001\uff0c\u4f46\u94fe\u8def\u53cc\u65b9\u7684\u89d2\u8272\u5df2\u7ecf\u53cd\u8f6c\u4e86\u3002\u6b64\u60c5\u5f62\u7528\u4e8e\u652f\u6301 Crosslink \u7684\u60c5\u51b5\u4e0b\uff0c\u4e24\u4e2a USP \u76f8\u8fde\u7684\u60c5\u51b5\uff0c\u8be5\u8fc7\u7a0b\u5141\u8bb8\u5176\u4e2d\u4e00\u4e2a USP \u8f6c\u800c\u6210\u4e3a DSP\u3002</p> <p>\u8f6c\u79fb\u81f3 Disable \u72b6\u6001</p> <p>\u5982\u679c\u4e0b\u5217\u6761\u4ef6\u4e2d\u4efb\u610f\u4e00\u9879\u6ee1\u8db3\uff0c\u90a3\u4e48\u8f6c\u79fb\u81f3 Disable \u72b6\u6001\uff1a</p> <ul> <li>\u4efb\u610f\u6b63\u5728\u53d1\u9001 TS1 \u7684\u901a\u9053\u6536\u5230\u4e86 Disable link \u6bd4\u7279\u4e3a 1 \u7684 TS1\u3002</li> <li>\u652f\u6301\u9009\u914d\u7279\u6027 crosslink \u65f6\uff0c\u6240\u6709\u901a\u9053\u8fde\u7eed\u6536\u5230\u4e24\u4e2a Disable link \u6bd4\u7279\u4e3a 1 \u7684 TS1\uff0c\u6216\u8005\u94fe\u8def\u5176\u4e2d\u4e00\u65b9\u88ab\u9ad8\u5c42\u8f6f\u4ef6\u5173\u95ed\u94fe\u8def\uff0c\u4f7f\u5176\u5728\u6240\u6709\u68c0\u6d4b\u5230\u63a5\u6536\u65b9\u7684\u901a\u9053\u4e0a\u53d1\u9001\u7684 TS1 \u548c TS2 \u4e2d\uff0c\u7f6e\u4f4d  Disable link \u6bd4\u7279\u3002</li> </ul> <p>\u8f6c\u79fb\u81f3 Loopback \u72b6\u6001</p> <p>\u8bd1\u6ce8\uff1a\u52a0\u7c97\u90e8\u5206\u4e3a USP \u548c DSP \u4e0d\u540c\u4e4b\u5904</p> <p>\u5982\u679c\u652f\u6301 loopback \u7684\u53d1\u9001\u7aef\u53d7\u5230\u66f4\u9ad8\u5c42\u903b\u8f91\u7684\u6307\u793a\uff0c\u53d1\u9001 Loopback \u6bd4\u7279\u7f6e\u4f4d\u7684 TS1 \u6216\u8005 TS2\uff0c\u6216\u8005**\u6240\u6709**\u6b63\u5728\u53d1\u9001**\u4ee5\u53ca\u63a5\u6536** TS1 \u7684\u901a\u9053\u6536\u5230\u8fde\u7eed\u4e24\u4e2a Loopback \u6bd4\u7279\u7f6e\u4f4d\u7684 TS1 \u540e\uff0c\u5c06\u8f6c\u79fb\u81f3 Loopback \u72b6\u6001\u3002\u4efb\u610f\u53d1\u9001 Loopback \u6bd4\u7279\u7f6e\u4f4d\u7684\u7aef\u53e3\u5c06\u53d8\u6210 Loopback master\uff0c\u800c\u6536\u5230\u4ed6\u4eec\u7684\u7aef\u53e3\u5c06\u53d8\u6210 Loopback slave\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c\u5728 24ms \u8d85\u65f6\u5230\u671f\u540e\uff0c\u4ecd\u7136\u6ca1\u6709\u4efb\u4f55\u6ee1\u8db3\u6709\u6548\u8df3\u8f6c\u6761\u4ef6\uff0c\u90a3\u4e48\u8f6c\u79fb\u81f3 Detect \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14642-configurationlinkwidthaccept","title":"14.6.4.2 Configuration.Linkwidth.Accept","text":"<p>\u6b64\u65f6\uff0cUSP \u6b63\u5728\u5176\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001 TS1 \u8fdb\u884c\u56de\u5e94\uff0c\u6240\u6709\u901a\u9053\u4e0a\u7684 TS1 \u4e2d\u7684\u94fe\u8def\u7f16\u53f7\u90fd\u4fdd\u6301\u4e00\u81f4\u3002\u94fe\u8def\u7f16\u53f7\u6765\u81ea\u4e8e DSP \u7684\u5021\u8bae\uff0cUSP \u76f4\u63a5\u5728\u6240\u6709\u901a\u9053\u7684 TS1 \u4e2d\u53cd\u5e94\u4e86\u8be5\u94fe\u8def\u7f16\u53f7\u503c\u3002\u8fd9\u6837\u4e00\u6765 DSP \u901a\u8fc7\u8ba1\u7b97\u6709\u591a\u5c11\u901a\u9053\u54cd\u5e94\u8be5\u94fe\u8def\u7f16\u53f7\u503c\uff0c\u660e\u786e\u4e86\u94fe\u8def\u5bbd\u5ea6\u3002\u63a5\u4e0b\u6765 DSP \u9700\u8981\u53d1\u8d77\u63d0\u8bae\uff0c\u4e3a\u8fd9\u4e9b\u901a\u9053\u6307\u5b9a\u5404\u81ea\u7684\u901a\u9053\u7f16\u53f7\u3002\u6240\u4ee5 DSP \u4f5c\u4e3a\u8bad\u7ec3\u7684\u4e3b\u5bfc\u8005\uff08leader\uff09\uff0c\u7ee7\u7eed\u53d1\u9001 TS1 \u5e8f\u5217\uff0c\u4e0d\u8fc7\u6b64\u65f6\u5404\u901a\u9053\u7684 TS1 \u5404\u81ea\u643a\u5e26\u6709\u4e3a\u5176\u6307\u5b9a\u7684\u901a\u9053\u7f16\u53f7\u503c\uff0c\u800c\u4e0d\u518d\u662f\u586b\u5145\u7b26\u53f7\u3002\u5f53\u7136\uff0c\u8fd9\u4e9b TS1 \u7684\u94fe\u8def\u7f16\u53f7\u4ecd\u7136\u662f\u76f8\u540c\u7684\u3002\u63a5\u4e0b\u6765\u672c\u8282\u8be6\u7ec6\u8ba8\u8bba DSP \u548c USP \u5728\u8be5\u72b6\u6001\u7684\u884c\u4e3a\u3002 </p> <p>A. Downstream \u901a\u9053</p> <p>Configuration.Linkwidth.Accept\u671f\u95f4</p> <p>DSP \u63d0\u8bae\u901a\u9053\u7f16\u53f7\u503c\u3002\u5982\u679c\u4e00\u6761\u94fe\u8def\u53ef\u4ee5\u7531\u591a\u4e2a\u901a\u9053\u5408\u5e76\u7ec4\u6210\uff0c\u8fd9\u4e9b\u901a\u9053\u90fd\u53ef\u4ee5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684\uff0c\u94fe\u8def\u7f16\u53f7\u503c\u76f8\u540c\u7684 TS1\uff0c\u90a3\u4e48 DSP \u4f1a\u4e3a\u4ed6\u4eec\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u4e00\u81f4\uff0c\u4f46\u662f\u901a\u9053\u7f16\u53f7\u5404\u4e0d\u76f8\u540c\u7684 TS1\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Lanenum.Wait\u201c \u72b6\u6001</p> <p>DSP \u4e0d\u4f1a\u5728 Configuration.Linkwidth.Accept \u6b21\u72b6\u6001\u957f\u65f6\u95f4\u505c\u7559\u3002\u4e00\u65e6 DSP \u6536\u5230\u4e86 USP \u53d1\u9001\u7684\u5fc5\u987b\u6570\u91cf\u7684 TS1\uff0c\u660e\u786e\u4e86\u94fe\u8def\u5bbd\u5ea6\u4e4b\u540e\uff0cDSP \u4f1a\u66f4\u65b0\u4e00\u4e9b\u5fc5\u987b\u7684\u5185\u90e8\u72b6\u6001\uff0c\u5f00\u59cb\u5982\u4e0a\u4e00\u6bb5\u6240\u8ff0\uff0c\u53d1\u9001\u901a\u9053\u7f16\u53f7\u4e0d\u4e3a\u586b\u5145\u5b57\u7b26\u7684 TS1\uff0c\u5e76\u7acb\u523b\u8f6c\u4e3a Configuration.Linkwidth.Wait \u72b6\u6001\uff0c\u7b49\u5f85 USP \u786e\u8ba4\u901a\u9053\u7f16\u53f7\u5206\u914d\u3002</p> <p>B. Upstream \u901a\u9053</p> <p>Configuration.Linkwidth.Accept\u671f\u95f4</p> <p>USP \u5728\u4ece DSP \u63d0\u4f9b\u7684\u94fe\u8def\u7f16\u53f7\u4e2d\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\uff0c\u586b\u5145\u81f3\u6240\u6709\u901a\u9053\u7684 TS1 \u4e2d\uff0c\u53cd\u9988\u53d1\u9001\u7ed9 DSP\u3002\u8fd9\u91cc\u6240\u6709\u901a\u9053\u6307\u7684\u662f\u90a3\u4e9b\u6240\u6709\u63a5\u6536\u94fe\u8def\u7f16\u53f7\u4e0d\u4e3a\u586b\u5145\u5b57\u7b26 TS1 \u7684\u901a\u9053\u3002\u5728\u6240\u6709\u5269\u4f59\u7684\u901a\u9053\u4e2d\uff0c\u5982\u679c\u68c0\u6d4b\u5230\u5bf9\u7aef\u63a5\u6536\u65b9\uff0c\u4f46\u662f\u6ca1\u6709\u63a5\u6536\u5230\u6709\u6548\u94fe\u8def\u7f16\u53f7\u7684\u901a\u9053\uff0c\u5c06\u7ee7\u7eed\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\u91c7\u7528\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Lanenum.Wait\u201c \u72b6\u6001</p> <p>USP \u5fc5\u987b\u5bf9 DSP \u63d0\u51fa\u7684\u901a\u9053\u7f16\u53f7\u5206\u914d\u505a\u51fa\u54cd\u5e94\u3002\u5982\u679c\u4e00\u4e2a\u94fe\u8def\u53ef\u4ee5\u7531\u591a\u4e2a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u975e\u586b\u5145\u5b57\u7b26 TS1 \u7684\u901a\u9053\u5408\u5e76\u7ec4\u6210\uff0c\u5e76\u4e14\u5b83\u4eec\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed TS1\uff0c\u5176\u4e2d\u94fe\u8def\u7f16\u53f7\u76f8\u7b49\uff0c\u901a\u9053\u7f16\u53f7\u4e0d\u4e3a\u586b\u5145\u5b57\u7b26\uff0c\u90a3\u4e48 USP \u5e94\u8be5\u5728\u53ef\u884c\u7684\u60c5\u51b5\u4e0b\uff0c\u53d1\u9001\u901a\u9053\u7f16\u53f7\u76f8\u540c\u7684 TS1 \u8868\u793a\u63a5\u53d7\u5206\u914d\uff0c\u6216\u8005\u5728\u5fc5\u8981\u7684\u65f6\u5019\u56de\u5e94\u4e0d\u540c\u7684\u7f16\u53f7\u503c\u63d0\u8bae\u3002\uff08\u6bd4\u5982\u5e94\u7528\u4e86\u9009\u914d\u7684\u901a\u9053\u987a\u5e8f\u7ffb\u8f6c\u7279\u6027\u65f6\uff09</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14643-configurationlanenumwait","title":"14.6.4.3 Configuration.Lanenum.Wait","text":"<p>\u5728\u8ba8\u8bba Configuration.Lanenum.Wait \u72b6\u6001\u4e4b\u524d\uff0c\u672c\u8282\u5c06\u9996\u5148\u63d0\u4f9b\u4e00\u4e9b\u5e2e\u52a9\u6027\u7684\u80cc\u666f\u77e5\u8bc6\u3002\u94fe\u8def\u901a\u9053\u7684\u7f16\u53f7\u65b9\u5f0f\uff0c\u662f\u4ece 0 \u5230\u8fd9\u6761\u94fe\u8def\u6240\u652f\u6301\u7684\u6700\u5927\u7f16\u53f7\u3002\u6bd4\u5982\u8bf4\u4e00\u4e2a x8 \u94fe\u8def\uff0c\u5c06\u4f1a\u628a\u5b83\u7684\u901a\u9053\u7f16\u53f7\u4e3a 0-7\u3002\u7aef\u53e3\u9700\u8981\u652f\u6301\u94fe\u8def\u5bb9\u7eb3\u5176\u6240\u62e5\u6709\u7684\u6700\u5927\u901a\u9053\u6570\uff0c\u4e5f\u9700\u8981\u652f\u6301\u94fe\u8def\u5bb9\u7eb3\u6700\u5c11\u81f3\u4e00\u4e2a\u901a\u9053\u3002\u901a\u9053\u603b\u662f\u4ece 0 \u5f00\u59cb\u7f16\u53f7\uff0c\u5e76\u4e14\u9700\u8981\u662f\u8fde\u7eed\u7f16\u53f7\u4e0d\u4e2d\u65ad\u7684\u3002\u6bd4\u5982\uff0c\u5982\u679c\u4e00\u4e2a x8 \u94fe\u8def\u4e0a\u6709\u4e9b\u901a\u9053\u4e0d\u5de5\u4f5c\uff0c\u5b83\u53ef\u80fd\u53ef\u4ee5\u8f6c\u800c\u914d\u7f6e\u6210\u4e00\u4e2a x4 \u94fe\u8def\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5b83\u5fc5\u987b\u4f7f\u7528\u901a\u9053 0-3\u3002\u518d\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u662f\u94fe\u8def\u7684\u901a\u9053 2 \u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\uff0c\u65e0\u6cd5\u4f7f\u7528\u901a\u9053 0\uff0c1\uff0c3\uff0c4 \u7ec4\u6210\u4e00\u4e2a x4 \u94fe\u8def\uff0c\u56e0\u4e3a\u5b83\u4eec\u7684\u7f16\u53f7\u662f\u4e0d\u8fde\u7eed\u7684\u3002\u94fe\u8def\u4e0a\u4efb\u4f55\u5269\u4f59\u7684\u901a\u9053\u5fc5\u987b\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4f7f\u7528\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p> <p>\u534f\u8bae\u5728 Configuration \u72b6\u6001\u90e8\u5206\u591a\u6b21\u5f3a\u8c03\u4e86\u4e00\u9879\u65f6\u5e8f\u8981\u6c42\uff0c\u672c\u8282\u4e0d\u518d\u591a\u6b21\u91cd\u590d\u8fd9\u4e00\u90e8\u5206\uff0c\u4f46\u9700\u8981\u610f\u8bc6\u5230\u8fd9\u9879\u9650\u5236\u5bf9 DSP \u548c USP \u90fd\u6709\u6548\uff1a</p> <p>\u4e3a\u4e86\u907f\u514d\u5c06\u94fe\u8def\u7684\u5bbd\u5ea6\u914d\u7f6e\u5c0f\u4e8e\u6b63\u5e38\u5bbd\u5ea6\uff0c\u534f\u8bae\u5efa\u8bae\u5982\u679c\u5728\u591a\u901a\u9053\u94fe\u8def\u4e0a\u53d1\u73b0\u67d0\u4e9b\u901a\u9053\u51fa\u73b0\u9519\u8bef\u6216\u8005\u5931\u53bb Block Alignment \u72b6\u6001\uff0c\u90a3\u4e48\u5ef6\u8fdf\u4e00\u6bb5\u65f6\u95f4\u540e\u518d\u8fdb\u884c\u672c\u8fc7\u7a0b\u30028b/10b \u7f16\u7801\u65f6\u7b49\u5f85\u81f3\u5c11 2 \u4e2a TS1\uff0c128b/130b \u7f16\u7801\u65f6\u81f3\u5c11\u7b49\u5f85 34 \u4e2a TS1\uff0c\u4f46\u4efb\u4f55\u60c5\u51b5\u4e0b\u4e0d\u8981\u7b49\u5f85\u8d85\u8fc7 1ms\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c\u6ca1\u6709\u94fe\u8def\u80fd\u591f\u88ab\u914d\u7f6e\uff08\u6bd4\u5982 lane0 \u4e0d\u5de5\u4f5c\uff0c\u4e14\u901a\u9053\u7ffb\u8f6c\u6ca1\u6709\u542f\u7528\u65f6\uff09\uff0c\u6216\u8005\u6240\u6709\u901a\u9053\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1\uff0c\u5176\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u7b26\u53f7\uff0c\u90a3\u4e48\u5728 2ms \u4e4b\u540e\u89e6\u53d1\u8d85\u65f6\uff0c\u94fe\u8def\u8fd4\u56de Detect \u72b6\u6001\u3002</p> <p>A. Downstream \u901a\u9053</p> <p>Configuration.Lanenum.Wait\u671f\u95f4</p> <p>\u5728 Configuration.Lanenum.Wait \u72b6\u6001\u671f\u95f4\uff0cDSP \u4f1a\u7ee7\u7eed\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u975e\u586b\u5145\u503c\u7684 TS1\uff0c\u76f4\u81f3\u6ee1\u8db3\u67d0\u4e2a\u8df3\u8f6c\u5230\u5176\u4ed6\u72b6\u6001\u7684\u6761\u4ef6\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Lanenum.Accept\u201c \u72b6\u6001</p> <p>\u5982\u679c\u4e0b\u8ff0\u4e24\u4e2a\u6761\u4ef6\u4e4b\u4e00\u6ee1\u8db3\uff0c\u90a3\u4e48\u8df3\u8f6c\u5230 Configuration.Lanenum.Accept \u72b6\u6001\uff1a</p> <ul> <li>\u5982\u679c\u5728\u6240\u6709\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS1\uff0c\u5b83\u4eec\u643a\u5e26\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u548c DSP \u5728\u8fd9\u4e9b\u901a\u9053\u4e0a\u53d1\u9001\u7684\u4e00\u81f4\u3002</li> <li>\u5982\u679c\u5728\u4efb\u610f\u4e00\u4e2a\u68c0\u6d4b\u5230\u63a5\u6536\u65b9\u7684\u901a\u9053\u4e0a\uff0c\u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS1\uff0c\u5b83\u4eec\u7684\u901a\u9053\u7f16\u53f7\u548c\u521a\u8fdb\u5165\u672c\u72b6\u6001\u65f6\u63a5\u6536\u5230\u7684 TS1 \u4e2d\u7684\u6570\u503c\u4e0d\u4e00\u81f4\uff0c\u5e76\u4e14\u81f3\u5c11\u6709\u4e00\u4e9b\u901a\u9053\u63a5\u6536\u5230\u4e86\u6709\u6548\u7684\u94fe\u8def\u7f16\u53f7\u3002\u534f\u8bae\u6307\u51fa\u8fd9\u79cd\u60c5\u51b5\u662f\u901a\u4fe1\u53cc\u65b9\u8fbe\u6210\u4e86\u4e00\u81f4\uff0c\u786e\u5b9a\u4e86\u53cc\u65b9\u90fd\u80fd\u591f\u63a5\u6536\u7684\u94fe\u8def\u5bbd\u5ea6\u3002</li> </ul> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u89e6\u53d1\u4e86\u4e0a\u8ff0\u7684 2ms \u8d85\u65f6\u4e8b\u4ef6\uff0c\u6216\u8005\u6240\u6709\u901a\u9053\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1\uff0c\u5176\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u7b26\u53f7\u3002</p> <p>B. Upstream \u901a\u9053</p> <p>Configuration.Lanenum.Wait\u671f\u95f4</p> <p>\u5728 Configuration.Lanenum.Wait \u72b6\u6001\u671f\u95f4\uff0cUSP \u4f1a\u7ee7\u7eed\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u975e\u586b\u5145\u503c\u7684 TS1\uff0c\u76f4\u81f3\u6ee1\u8db3\u67d0\u4e2a\u8df3\u8f6c\u5230\u5176\u4ed6\u72b6\u6001\u7684\u6761\u4ef6\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Lanenum.Accept\u201c \u72b6\u6001</p> <p>\u5982\u679c\u4e0b\u8ff0\u4e24\u4e2a\u6761\u4ef6\u4e4b\u4e00\u6ee1\u8db3\uff0c\u90a3\u4e48\u8df3\u8f6c\u5230 Configuration.Lanenum.Accept \u72b6\u6001\uff1a</p> <ul> <li>\u5982\u679c\u5728\u6240\u6709\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS2\u3002</li> <li>\u5982\u679c\u5728\u4efb\u610f\u4e00\u4e2a\u68c0\u6d4b\u5230\u63a5\u6536\u65b9\u7684\u901a\u9053\u4e0a\uff0c\u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS1\uff0c\u5b83\u4eec\u7684\u901a\u9053\u7f16\u53f7\u548c\u521a\u8fdb\u5165\u672c\u72b6\u6001\u65f6\u63a5\u6536\u5230\u7684 TS1 \u4e2d\u7684\u6570\u503c\u4e0d\u4e00\u81f4\uff0c\u5e76\u4e14\u81f3\u5c11\u6709\u4e00\u4e9b\u901a\u9053\u63a5\u6536\u5230\u4e86\u6709\u6548\u7684\u94fe\u8def\u7f16\u53f7\u3002\u534f\u8bae\u6307\u51fa\u8fd9\u79cd\u60c5\u51b5\u662f\u901a\u4fe1\u53cc\u65b9\u8fbe\u6210\u4e86\u4e00\u81f4\uff0c\u786e\u5b9a\u4e86\u53cc\u65b9\u90fd\u80fd\u591f\u63a5\u6536\u7684\u94fe\u8def\u5bbd\u5ea6\u3002</li> </ul> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u89e6\u53d1\u4e86\u4e0a\u8ff0\u7684 2ms \u8d85\u65f6\u4e8b\u4ef6\uff0c\u6216\u8005\u6240\u6709\u901a\u9053\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1\uff0c\u5176\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u7b26\u53f7\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14644-configurationlanenumaccept","title":"14.6.4.4 Configuration.Lanenum.Accept","text":"<p>A. Downstream \u901a\u9053</p> <p>Configuration.Lanenum.Accept\u671f\u95f4</p> <p>DSP \u5df2\u7ecf\u5728\u4e0a\u4e00\u4e2a\u72b6\u6001\u4e2d\u63a5\u6536\u5230\u4e86\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u975e\u586b\u5145\u503c\u7684 TS1\u3002\u5728\u672c\u72b6\u6001\u4e2d\uff0cDSP \u5fc5\u987b\u51b3\u5b9a\u662f\u5426\u80fd\u591f\u6309\u7167 USP \u8fd4\u56de\u7684\u901a\u9053\u7f16\u53f7\u987a\u5e8f\u5efa\u7acb\u4e00\u6761\u94fe\u8def\u3002\u4e0b\u9762\u5217\u51fa\u4e86\u4e09\u79cd\u53ef\u80fd\u7684\u72b6\u6001\u8df3\u53d8\u65b9\u5f0f\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Complete\u201c \u72b6\u6001</p> <p>\u5982\u679c DSP \u5728\u6240\u6709\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS1\uff0c\u5b83\u4eec\u643a\u5e26\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u548c DSP \u5728\u8fd9\u4e9b\u901a\u9053\u4e0a\u53d1\u9001\u7684\u6570\u503c\u4e00\u81f4\uff0c\u90a3\u4e48\u4ee3\u8868 USP \u540c\u610f\u4e86 DSP \u901a\u544a\u7684\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\uff0cDSP \u968f\u4e4b\u8fdb\u5165 Configuration.Complete \u72b6\u6001\u3002\u5982\u679c DSP \u63a5\u6536\u5230\u7684\u901a\u9053\u7f16\u53f7\u987a\u5e8f\u4e0e\u901a\u544a\u7684\u987a\u5e8f\u76f8\u98a0\u5012\uff0c\u5982\u679c DSP \u652f\u6301\u901a\u9053\u987a\u5e8f\u98a0\u5012\uff0c\u90a3\u4e48 DSP \u540c\u6837\u8fdb\u5165 Configuration.Complete \u72b6\u6001\uff0c\u5e76\u91c7\u7528\u63a5\u6536\u5230\u7684\uff0c\u98a0\u5012\u7684\u901a\u9053\u7f16\u53f7\u987a\u5e8f\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u534f\u8bae\u6307\u51fa\u901a\u9053\u7f16\u53f7\u987a\u5e8f\u98a0\u5012\u7684\u6761\u4ef6\u662f\u9650\u5b9a\u7684\uff0c\u53ea\u80fd\u662f\u901a\u9053 0 \u63a5\u6536\u5230\u6700\u5927\u7684\u901a\u9053\u7f16\u53f7 \uff08\u5047\u8bbe\u901a\u9053\u6570\u76ee\u4e3a N\uff0c\u90a3\u4e48\u6536\u5230\u7684\u5373\u4e3a N-1\uff09\uff0c\u901a\u9053 N-1 \u63a5\u6536\u5230\u901a\u9053\u7f16\u53f7\u4e3a 0\u3002\u8fd9\u9879\u534f\u8bae\u89c4\u5b9a\u53ef\u4ee5\u56de\u7b54\u4e00\u4e2a\u5728\u8bfe\u5802\u4e0a\u7ecf\u5e38\u88ab\u5b66\u751f\u95ee\u5230\u7684\u4e00\u4e2a\u95ee\u9898\uff1a\u901a\u9053\u7f16\u53f7\u662f\u5426\u80fd\u591f\u6df7\u7f16\uff0c\u4e0d\u6309\u987a\u5e8f\uff1f\u7b54\u6848\u662f\u4e0d\u884c\uff0c\u5b83\u4eec\u7684\u987a\u5e8f\u5fc5\u987b\u662f 0 \u5230 n-1\uff0c\u6216\u8005\u662f n-1 \u5230 0\uff0c\u4e0d\u652f\u6301\u5176\u4ed6\u9009\u9879\u3002</p> <p>\u5982\u679c\u662f\u4ece Recovery \u72b6\u6001\u8fdb\u5165\u7684 Configuration \u72b6\u6001\uff0c\u90a3\u4e48\u5728\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u88ab\u8981\u6c42\u6539\u53d8\u5e26\u5bbd\u3002\u5982\u679c\u8fd9\u6837\uff0c\u90a3\u4e48\u9700\u8981\u7f6e\u4f4d\u76f8\u5e94\u7684\u72b6\u6001\u6807\u5fd7\u4f4d\u6765\u6807\u8bc6\u9700\u8981\u6539\u53d8\u5e26\u5bbd\u7684\u539f\u56e0\u3002\u4e3b\u8981\u662f\u7cfb\u7edf\u9700\u8981\u62a5\u544a\u5e26\u5bbd\u6539\u53d8\u662f\u56e0\u4e3a\u94fe\u8def\u53ef\u9760\u6027\u95ee\u9898\u5bfc\u81f4\u7684\uff0c\u8fd8\u662f\u56e0\u4e3a\u786c\u4ef6\u6b63\u5728\u7ba1\u7406\u94fe\u8def\u7684\u7535\u6e90\u72b6\u6001\u5bfc\u81f4\u7684\u3002\u72b6\u6001\u6807\u8bc6\u4f4d\u7684\u51e0\u79cd\u60c5\u5f62\u5982\u4e0b\u6240\u8ff0\uff1a</p> <ul> <li>\u5982\u679c\u5e26\u5bbd\u6539\u53d8\u7531 DSP \u56e0\u4e3a\u94fe\u8def\u7684\u53ef\u9760\u6027\u95ee\u9898\u53d1\u8d77\uff0c\u90a3\u4e48\u94fe\u8def\u5e26\u5bbd\u7ba1\u7406\u72b6\u6001\u6bd4\u7279\uff08Link Bandwidth Management Status bit\uff09\u8bbe\u7f6e\u4e3a 1'b1\u3002</li> <li>\u5982\u679c\u5e26\u5bbd\u6539\u53d8\u4e0d\u662f\u7531 DSP \u53d1\u8d77\uff0c\u800c\u662f\u56e0\u4e3a DSP \u8fde\u7eed\u6536\u5230\u4e24\u4e2a\u81ea\u4e3b\u6539\u53d8\uff08Autonomous Change \uff09\u6bd4\u7279\u4e3a 1'b0 \u7684 TS1\uff0c\u90a3\u4e48\u94fe\u8def\u5e26\u5bbd\u7ba1\u7406\u72b6\u6001\u6bd4\u7279\uff08Link Bandwidth Management Status bit\uff09\u8bbe\u7f6e\u4e3a 1'b1\u3002</li> <li>\u9664\u6b64\u4e4b\u5916\u7684\u94fe\u8def\u5e26\u5bbd\u6539\u53d8\uff0c\u94fe\u8def\u81ea\u4e3b\u5e26\u5bbd\u72b6\u6001\u6bd4\u7279\uff08Link Autonomous Bandwidth Status bit\uff09\u7f6e\u4f4d\u4e3a 1'b1\u3002</li> </ul> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Lanenum.Wait\u201c \u72b6\u6001</p> <p>\u5982\u679c\u4e00\u6761\u6b63\u5728\u88ab\u914d\u7f6e\u7684\u94fe\u8def\u53ef\u4ee5\u7531\u4e00\u90e8\u5206\u800c\u4e0d\u662f\u5168\u90e8\u7684\u53ef\u7528\u901a\u9053\u7ec4\u6210\uff0c\u8fd9\u4e9b\u901a\u9053\u90fd\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS1 \uff0c\u94fe\u8def\u7f16\u53f7\u4e3a\u76f8\u540c\u6709\u6548\u7684\u6570\u503c\uff0c\u5e76\u4e14\u901a\u9053\u7f16\u53f7\u4e5f\u4e0d\u4e3a\u586b\u5145\u7b26\u53f7\u3002\u90a3\u4e48\u5728\u8fd9\u90e8\u5206\u901a\u9053\u4e0a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u76f8\u540c\uff0c\u901a\u9053\u7f16\u53f7\u91cd\u65b0\u7f16\u5236\u7684 TS1\uff0c\u65e8\u5728\u7528\u66f4\u5c11\u6570\u91cf\u7684\u901a\u9053\u6765\u7f16\u6210\u4e00\u6761\u94fe\u8def\u3002</p> <p>\u65b0\u7684\u901a\u9053\u7f16\u53f7\u5fc5\u987b\u4ece 0 \u5f00\u59cb\u987a\u5e8f\u9012\u589e\uff0c\u6307\u6d3e\u7ed9\u94fe\u8def\u6240\u4f7f\u7528\u7684\u901a\u9053\u3002\u4efb\u4f55\u6ca1\u6709\u63a5\u6536\u5230 TS1 \u7684\u901a\u9053\u4e0d\u80fd\u6210\u4e3a\u94fe\u8def\u7684\u4e00\u90e8\u5206\uff0c\u5e76\u4e14\u4e2d\u65ad\u901a\u9053\u7f16\u53f7\u9012\u589e\u3002\u4e3e\u4f8b\u800c\u8a00\uff0c\u5982\u679c\u5171\u6709 8 \u6761\u901a\u9053\uff0c\u4f46\u662f\u901a\u9053 2 \u6ca1\u6709\u63a5\u6536\u5230 TS1\uff0c\u90a3\u4e48\u8fd9\u7ec4\u901a\u9053\u5c06\u4e0d\u80fd\u7ec4\u6210\u5305\u62ec\u901a\u9053 2 \u7684\u94fe\u8def\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u4e0d\u80fd\u7ec4\u6210 x8 \u6216\u8005 x4 \u7684\u94fe\u8def\uff0c\u53ea\u80fd\u7ec4\u6210 x2 \u6216\u8005 x1 \u7684\u94fe\u8def\u3002\u5269\u4e0b\u4e0d\u4f7f\u7528\u7684\u901a\u9053\uff0c\u5fc5\u987b\u5728\u5176\u4e0a\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c\u6ca1\u6709\u94fe\u8def\u53ef\u4ee5\u88ab\u914d\u7f6e\uff0c\u6216\u8005\u6240\u6709\u901a\u9053\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1\uff0c\u5176\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u7b26\u53f7\u3002</p> <p>B. Upstream \u901a\u9053</p> <p>Configuration.Lanenum.Accept\u671f\u95f4</p> <p>USP \u5df2\u7ecf\u5728\u4e0a\u4e00\u4e2a\u72b6\u6001\u4e2d\u63a5\u6536\u5230\u4e86\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4e3a\u975e\u586b\u5145\u503c\u7684 TS1 \u6216\u8005 TS2\u3002\u5728\u672c\u72b6\u6001\u4e2d\uff0cUSP \u5fc5\u987b\u51b3\u5b9a\u662f\u5426\u80fd\u591f\u6309\u7167 DSP \u63d0\u8bae\u7684\u901a\u9053\u7f16\u53f7\u987a\u5e8f\u5efa\u7acb\u4e00\u6761\u94fe\u8def\u3002\u4e0b\u9762\u5217\u51fa\u4e86\u4e09\u79cd\u53ef\u80fd\u7684\u72b6\u6001\u8df3\u53d8\u65b9\u5f0f\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Complete\u201c \u72b6\u6001</p> <p>\u5982\u679c USP \u5728\u6240\u6709\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS2\uff0c\u5b83\u4eec\u643a\u5e26\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u548c USP \u5728\u8fd9\u4e9b\u901a\u9053\u4e0a\u53d1\u9001\u7684 TS1 \u4e2d\u7684\u6570\u503c\u4e00\u81f4\uff0c\u90a3\u4e48USP \u8fdb\u5165 Configuration.Complete \u72b6\u6001\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Lanenum.Wait\u201c \u72b6\u6001</p> <p>\u5982\u679c\u4e00\u6761\u6b63\u88ab\u914d\u7f6e\u7684\u94fe\u8def\u53ef\u4ee5\u7531\u4e00\u90e8\u5206\u53ef\u7528\u901a\u9053\u7684\u5b50\u96c6\u7ec4\u6210\uff0c\u8fd9\u4e9b\u901a\u9053\u90fd\u6536\u5230\u8fde\u7eed\u4e24\u4e2a TS1 \uff0c\u94fe\u8def\u7f16\u53f7\u4e3a\u76f8\u540c\u6709\u6548\u7684\u6570\u503c\uff0c\u5e76\u4e14\u901a\u9053\u7f16\u53f7\u4e5f\u4e0d\u4e3a\u586b\u5145\u7b26\u53f7\u3002\u90a3\u4e48\u5728\u8fd9\u90e8\u5206\u901a\u9053\u4e0a\u53d1\u9001\u94fe\u8def\u7f16\u53f7\u76f8\u540c\uff0c\u901a\u9053\u7f16\u53f7\u91cd\u65b0\u7f16\u5236\u7684 TS1\uff0c\u65e8\u5728\u7528\u66f4\u5c11\u6570\u91cf\u7684\u901a\u9053\u6765\u7f16\u6210\u4e00\u6761\u94fe\u8def\uff0c\u5e76\u8df3\u8f6c\u81f3 Configuration.Lanenum.Wait \u72b6\u6001\u3002</p> <p>\u548c DSP \u65f6\u7684\u60c5\u5f62\u4e00\u6837\uff0c\u65b0\u7684\u901a\u9053\u7f16\u53f7\u5fc5\u987b\u4ece 0 \u5f00\u59cb\u987a\u5e8f\u9012\u589e\uff0c\u6307\u6d3e\u7ed9\u94fe\u8def\u6240\u4f7f\u7528\u7684\u901a\u9053\u3002\u4efb\u4f55\u6ca1\u6709\u63a5\u6536\u5230 TS1 \u7684\u901a\u9053\u4e0d\u80fd\u6210\u4e3a\u94fe\u8def\u7684\u4e00\u90e8\u5206\uff0c\u5e76\u4e14\u4e2d\u65ad\u901a\u9053\u7f16\u53f7\u9012\u589e\u3002\u5269\u4e0b\u4e0d\u4f7f\u7528\u7684\u901a\u9053\uff0c\u5fc5\u987b\u5728\u5176\u4e0a\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c\u6ca1\u6709\u94fe\u8def\u53ef\u4ee5\u88ab\u914d\u7f6e\uff0c\u6216\u8005\u6240\u6709\u901a\u9053\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u4e3a\u586b\u5145\u7b26\u53f7\u7684 TS1\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14645-configurationcomplete","title":"14.6.4.5 Configuration.Complete","text":"<p>Configuration.Complete \u662f\u552f\u4e00\u7684 TS2 \u5e8f\u5217\u4ea4\u6362\u7684\u72b6\u6001\u3002\u6b63\u5982\u524d\u6587\u8ba8\u8bba\u7684\u90a3\u6837\uff0cTS2 \u4ea4\u6362\u662f\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u95f4\uff0c\u4e92\u76f8\u786e\u8ba4\u5df2\u7ecf\u51c6\u5907\u597d\u72b6\u6001\u8df3\u8f6c\u7684\u63e1\u624b\u786e\u8ba4\u673a\u5236\u3002\u8fd9\u662f\u5bf9\u5148\u524d\u72b6\u6001\u4e2d TS1 \u5e8f\u5217\u4ea4\u6362\u7684\u94fe\u8def\u7f16\u53f7\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\u7684\u6700\u7ec8\u786e\u8ba4\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\u534f\u8bae\u5141\u8bb8\u53cc\u65b9\u8bbe\u5907\u5728\u8fdb\u5165\u672c\u72b6\u6001\u65f6\uff0c\u6539\u53d8\u5b83\u4eec\u7684\u652f\u6301\u901f\u7387\u5217\u8868\u548c\u94fe\u8def\u5bbd\u5ea6\u6062\u590d\u80fd\u529b\uff08upconfigure capability\uff09\uff0c\u4f46\u4e00\u65e6\u8fdb\u5165\u672c\u72b6\u6001\u540e\uff0c\u8fd9\u4e9b\u8bbe\u7f6e\u5c31\u4e0d\u518d\u5141\u8bb8\u4fee\u6539\u3002\u56e0\u4e3a\u8bbe\u5907\u8fdb\u5165\u672c\u72b6\u6001\u540e\u5c06\u8bb0\u5f55\u5bf9\u65b9\u5728 TS2 \u4e2d\u901a\u544a\u7684\u8fd9\u4e9b\u80fd\u529b\u548c\u8bbe\u7f6e\uff0c\u5177\u4f53\u5185\u5bb9\u5c06\u5728\u672c\u8282\u8fdb\u884c\u8ba8\u8bba\u3002</p> <p>A. Downstream \u901a\u9053</p> <p>Configuration.Complete\u671f\u95f4</p> <p>\u5728 Configuration.Complete \u72b6\u6001\u671f\u95f4\uff0cDSP \u5c06\u53d1\u9001 TS2 \u5e8f\u5217\uff0c\u5176\u4e2d\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4e0e\u63a5\u6536\u5230\u7684 TS1 \u4e2d\u7684\u5185\u5bb9\u3002\u5982\u679c\u5f53\u524d\u7aef\u53e3\u6709\u4e00\u6761\u4f7f\u7528 lane 0 \u7684 x1 \u94fe\u8def\uff0c\u5e76\u652f\u6301\u589e\u52a0\u94fe\u8def\u5bbd\u5ea6\u6062\u590d\uff08upconfigure\uff09\uff0c\u90a3\u4e48 DSP \u5c06\u7f6e\u4f4d TS2 \u5e8f\u5217\u4e2d\u7684 Upconfigure Capability \u6bd4\u7279\u3002</p> <p>\u4f7f\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u5fc5\u987b\u5728\u79bb\u5f00\u5f53\u524d\u72b6\u6001\u524d\u5b8c\u6210\u901a\u9053\u95f4\u53bb\u504f\u79fb\u3002\u53e6\u5916\uff0c\u5982\u679c\u6240\u6709\u914d\u7f6e\u4e2d\u7684\u901a\u9053\u90fd\u6536\u5230\u4e86\u4e24\u4e2a\u8fde\u7eed\u7684 TS2\uff0c\u5176\u4e2d\u5173\u95ed\u52a0\u6270\uff08Disable Scrambling\uff09\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1'b1\uff0c\u90a3\u4e48\u505c\u6b62\u5bf9\u7f16\u7801\u8fdb\u884c\u52a0\u6270\uff08scrambling\uff09 \u3002\u53d1\u9001\u8fd9\u4e9b TS2 \u7684\u7aef\u53e3\u4e5f\u5fc5\u987b\u505c\u6b62\u52a0\u6270\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728 128b/130b \u7f16\u7801\u6a21\u5f0f\u65f6\uff0c\u65e0\u6cd5\u5173\u95ed\u52a0\u6270\uff0c\u56e0\u4e3a\u6dfb\u52a0\u7684\u6270\u7801\u5bf9\u4fe1\u53f7\u5b8c\u6574\u6027\u7684\u5e2e\u52a9\u4e0d\u53ef\u6216\u7f3a\u3002</p> <p>DSP \u5728\u672c\u72b6\u6001\u4e2d\u53d1\u9001 TS2 \u5e8f\u5217\uff0c\u5e76\u63a5\u6536\u89c2\u5bdf\u5bf9\u7aef\u8fd4\u56de\u7684 TS2 \u5e8f\u5217\u3002DSP \u4f1a\u8bb0\u5f55\u63a5\u6536\u5230\u7684 TS2 \u4e2d\u7684 N_FTS \u57df\u6570\u503c\uff0c\u5176\u8868\u793a\uff08\u8bd1\u8005\u6dfb\u52a0\uff1a\u5bf9\u7aef\uff09\u9000\u51fa L0s \u72b6\u6001\u5fc5\u9700\u7684 FTS \u6570\u91cf\uff0c\u4ee5\u5907\u540e\u7eed\u4f7f\u7528\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Idle\u201c \u72b6\u6001</p> <p>\u5f53\u6240\u6709\u53d1\u9001 TS2 \u7684\u901a\u9053\u90fd\u63a5\u6536\u5230 8 \u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684 TS2 \u65f6\uff0c\u5e76\u4e14\u5728\u63a5\u6536\u5230\u4e00\u4e2a TS2 \u540e\u8be5\u901a\u9053\u5df2\u7ecf\u53d1\u9001\u81f3\u5c11 16 \u4e2a TS2 \u540e\uff0c\u72b6\u6001\u673a\u5c06\u8df3\u8f6c\u81f3\u4e0b\u4e00\u4e2a\u72b6\u6001\uff1aConfiguration.Idle\u3002\u8fd9\u4e9b\u6761\u4ef6\u6307\u7684\u662f\u6240\u6709\u63a5\u6536\u7684 TS2 \u4e2d\u90fd\u643a\u5e26\u6709\u5339\u914d\u7684\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\uff08\u975e\u586b\u5145\u7b26\u53f7\uff09\uff0c\u5339\u914d\u7684\u901f\u7387\u6807\u8bc6\u7b26\uff08 rate identifier\uff09\uff0c\u4ee5\u53ca\u5339\u914d\u7684\u94fe\u8def Upconfig Capability \u6bd4\u7279\u3002</p> <p>\u5982\u679c\u8bbe\u5907\u652f\u6301 2.5 GT/s \u4ee5\u4e0a\u7684\u901f\u7387\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u8bb0\u5f55\u5728\u4efb\u4f55\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u7684\u901f\u7387\u6807\u8bc6\u7b26\uff0c\u5e76\u8986\u76d6\u6240\u6709\u6b64\u524d\u8bb0\u5f55\u7684\u6570\u503c\u3002\u201cchanged_speed_recovery\u201d \u7528\u4e8e\u5728 Recivery \u72b6\u6001\u4e2d\u8ffd\u8e2a\u901f\u7387\u7f16\u53f7\u7684\u53d8\u91cf\uff0c\u6b64\u65f6\u6e05\u9664\u4e3a 0\u3002</p> <p>\u53d8\u91cf \u201cupconfigure_capable\u201d \u5c06\u88ab\u8bbe\u7f6e\u4e3a 1b\uff0c\u5982\u679c\u8bbe\u5907\u53d1\u51fa\u7684 TS2 \u4e2d\u7684 Link Upconfigure Capability \u57df\u8bbe\u7f6e\u4e3a 1b\uff0c\u5e76\u4e14\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS2 \u5e8f\u5217\u5728\u8be5\u6bd4\u7279\u4e0a\u7684\u8bbe\u7f6e\u540c\u6837\u4e3a 1\u3002\u5426\u5219\uff0c\u8be5\u53d8\u91cf\u6e05\u9664\u4e3a 0\u3002</p> <p>\u4efb\u4f55\u6ca1\u6709\u914d\u7f6e\u4e3a\u94fe\u8def\u4e00\u90e8\u5206\u7684\u901a\u9053\u5c06\u4e0e\u5f53\u524d\u7684 LTSSM \u4e0d\u518d\u6709\u5173\u8054\uff0c\u5e76\u4e14\u5fc5\u987b\u8bbe\u7f6e\u4e3a\u4e0b\u8ff0\u5404\u79cd\u72b6\u6001\u4e2d\u7684\u4e00\u79cd\uff1a</p> <ul> <li>\u4e0e\u65b0\u7684 LTSSM \u76f8\u5173\u8054\uff0c\u6216\u8005</li> <li>\u8f6c\u4e3a\u7535\u6c14\u7a7a\u95f2\u72b6\u6001</li> <li>\u8fd9\u91cc\u6d89\u53ca\u4e00\u79cd\u7279\u6b8a\u7684\u72b6\u6001\uff0c\u5373\u8fd9\u4e9b\u672a\u88ab\u914d\u7f6e\u8fdb\u94fe\u8def\u7684\u901a\u9053\u66fe\u7ecf\u5728 L0 \u72b6\u6001\u4e2d\u88ab\u914d\u7f6e\u4e3a\u94fe\u8def\u7684\u4e00\u90e8\u5206\uff0c\u5e76\u4e14 \u4ece\u90a3\u4e4b\u540e LinkUp \u72b6\u6001\u4f4d\u4e00\u76f4\u88ab\u8bbe\u7f6e\u4e3a 1b\u3002\u5982\u679c\u94fe\u8def\u652f\u6301 upconfigure\uff0c\u90a3\u4e48\u5b83\u4eec\u9700\u8981\u4ecd\u7136\u548c\u539f\u6765\u7684 LTSSM \u76f8\u5173\u8054\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u534f\u8bae\u5efa\u8bae\u8fd9\u4e9b\u901a\u9053\u4ecd\u7136\u4fdd\u6301\u6253\u5f00\u5bf9\u63a5\u6536\u7aef\u7684\u7ec8\u7ed3\uff08termination\uff09\u7279\u6027\uff0c\u56e0\u4e3a\u5728 upconfigured \u4e4b\u540e\uff0c\u5b83\u4eec\u53c8\u4f1a\u91cd\u65b0\u53d8\u6210\u94fe\u8def\u7684\u4e00\u4efd\u5b50\u3002\u5982\u679c\u4e0d\u4fdd\u6301\u7ec8\u7ed3\u7279\u6027\u6253\u5f00\uff0c\u90a3\u4e48\u5728 LTSSM \u4ece Configuration.Complete \u72b6\u6001\u8f6c\u4e3a Recovery.RcvrCfg \u72b6\u6001\u65f6\uff0c\u4e5f\u9700\u8981\u518d\u6b21\u6253\u5f00\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u8fd9\u4e9b\u901a\u9053\u5e76\u975e\u66fe\u7ecf\u662f\u94fe\u8def\u7684\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u5b83\u4eec\u65e0\u6cd5\u901a\u8fc7\u8be5\u8fc7\u7a0b\u6210\u4e3a\u94fe\u8def\u7684\u4e00\u90e8\u5206\u3002</li> <li>\u5bf9\u4e8e\u53ef\u9009\u914d\u7684 crosslink \u7279\u6027\uff0c\u63a5\u6536\u963b\u6297\u5fc5\u987b\u4fdd\u6301\u5728 Z RX\u2010HIGH\u2010IMP\u2010DC\u2010POS \u548c Z RX\u2010HIGH\u2010IMP\u2010DC\u2010NEG \u4e4b\u95f4\u3002</li> <li>\u5728 LTSSM \u8fd4\u56de Detect \u72b6\u6001\u540e\uff0c\u8fd9\u4e9b\u901a\u9053\u4f1a\u91cd\u65b0\u548c\u5176\u5173\u8054\u3002</li> <li>\u8fd9\u4e9b\u901a\u9053\u8fdb\u5165\u7535\u5668\u7a7a\u95f2\u72b6\u6001\u4e4b\u524d\u65e0\u9700\u53d1\u9001 EIOS \u5e8f\u5217\uff0c\u5e76\u4e14\u72b6\u6001\u8f6c\u53d8\u4e5f\u5e76\u4e0d\u4e00\u5b9a\u9700\u8981\u53d1\u751f\u5728\u7b26\u53f7\u6216\u8005\u547d\u4ee4\u96c6\u7684\u8fb9\u754c\u4e0a\u3002</li> </ul> <p>\u5728 2ms \u7684\u8d85\u65f6\u53d1\u751f\u540e\uff1a</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Idle\u201c \u72b6\u6001</p> <p>\u5982\u679c idle_to_rlock_transitioned \u53d8\u91cf\u5c0f\u4e8e FFh\uff0c\u5e76\u4e14\u5f53\u524d\u6570\u636e\u901f\u7387\u4e3a 8GT/s\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Configuration.Idle \u72b6\u6001\u3002</p> <p>\u5728\u8fd9\u6b21\u72b6\u6001\u8df3\u53d8\u4e2d\uff0cchanged_speed_recovery \u53d8\u91cf\u6e05\u9664\u4e3a 0\u3002\u5e76\u4e14\uff0c\u53d8\u91cf upconfigure_capable \u4e5f\u53ef\u80fd\u4f1a\u88ab\u66f4\u65b0\uff0c\u5c3d\u7ba1\u8fd9\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u5f53\u81f3\u5c11\u4e00\u4e2a\u901a\u9053\u4e0a\u89c1\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS2 \u5e8f\u5217\uff0c\u5b83\u4eec\u90fd\u643a\u5e26\u6709\u5339\u914d\u7684\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\uff08\u975e\u586b\u5145\u7b26\u53f7\uff09\uff0c\u5982\u679c\u94fe\u8def\u6536\u53d1\u53cc\u65b9\u7684 Upconfig Capability \u6bd4\u7279\u90fd\u4e3a 1\uff0c\u90a3\u4e48 upconfigure_capable \u53d8\u91cf\u66f4\u65b0\u4e3a 1b\uff0c\u5426\u5219\u6e05\u9664\u4e3a 0\u3002</p> <p>\u4efb\u4f55\u6ca1\u6709\u914d\u7f6e\u4e3a\u94fe\u8def\u4e00\u90e8\u5206\u7684\u901a\u9053\u5c06\u4e0e\u5f53\u524d\u7684 LTSSM \u4e0d\u518d\u6709\u5173\u8054\uff0c\u5176\u4ed6\u6240\u9700\u7684\u6761\u4ef6\u4e0e\u4e0a\u8ff0\u5217\u51fa\u7684\u975e\u8d85\u65f6\u65f6\u7684\u6761\u4ef6\u4e00\u81f4\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5728\u8d85\u65f6\u540e\uff0c\u5982\u679c\u672a\u6ee1\u8db3\u4e0a\u4e00\u6bb5\u7684\u6761\u4ef6\uff0c\u5219\u8f6c\u5165 Detect \u72b6\u6001\u3002</p> <p>B. Upstream \u901a\u9053</p> <p>Configuration.Complete\u671f\u95f4</p> <p>\u5728 Configuration.Complete \u72b6\u6001\u671f\u95f4\uff0cUSP \u5c06\u53d1\u9001 TS2 \u5e8f\u5217\uff0c\u5176\u4e2d\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4e0e\u63a5\u6536\u5230\u7684 TS2 \u4e2d\u7684\u5185\u5bb9\u3002\u5982\u679c\u5f53\u524d\u7aef\u53e3\u6709\u4e00\u6761\u4f7f\u7528 lane 0 \u7684 x1 \u94fe\u8def\uff0c\u5e76\u652f\u6301\u589e\u52a0\u94fe\u8def\u5bbd\u5ea6\u6062\u590d\uff08upconfigure\uff09\uff0c\u90a3\u4e48 USP \u53ef\u4ee5\u7f6e\u4f4d TS2 \u5e8f\u5217\u4e2d\u7684 Upconfigure Capability \u6bd4\u7279\u3002</p> <p>\u4f7f\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u5fc5\u987b\u5728\u79bb\u5f00\u5f53\u524d\u72b6\u6001\u524d\u5b8c\u6210\u901a\u9053\u95f4\u53bb\u504f\u79fb\u3002\u53e6\u5916\uff0c\u5982\u679c\u6240\u6709\u914d\u7f6e\u4e2d\u7684\u901a\u9053\u90fd\u6536\u5230\u4e86\u4e24\u4e2a\u8fde\u7eed\u7684 TS2\uff0c\u5176\u4e2d\u5173\u95ed\u52a0\u6270\uff08Disable Scrambling\uff09\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1'b1\uff0c\u90a3\u4e48\u505c\u6b62\u5bf9\u7f16\u7801\u8fdb\u884c\u52a0\u6270\uff08scrambling\uff09 \u3002\u53d1\u9001\u8fd9\u4e9b TS2 \u7684\u7aef\u53e3\u4e5f\u5fc5\u987b\u505c\u6b62\u52a0\u6270\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728 128b/130b \u7f16\u7801\u6a21\u5f0f\u65f6\uff0c\u65e0\u6cd5\u5173\u95ed\u52a0\u6270\uff0c\u56e0\u4e3a\u6dfb\u52a0\u7684\u6270\u7801\u5bf9\u4fe1\u53f7\u5b8c\u6574\u6027\u7684\u5e2e\u52a9\u4e0d\u53ef\u6216\u7f3a\u3002</p> <p>USP \u5728\u672c\u72b6\u6001\u4e2d\u4ece DSP \u63a5\u6536 TS2 \u5e8f\u5217\uff0cUSP \u4f1a\u8bb0\u5f55\u63a5\u6536\u5230\u7684 TS2 \u4e2d\u7684 N_FTS \u57df\u6570\u503c\uff0c\u5176\u8868\u793a\uff08\u8bd1\u8005\u6dfb\u52a0\uff1a\u5bf9\u7aef\uff09\u9000\u51fa L0s \u72b6\u6001\u5fc5\u9700\u7684 FTS \u6570\u91cf\uff0c\u4ee5\u5907\u540e\u7eed\u4f7f\u7528\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Idle\u201c \u72b6\u6001</p> <p>\u5f53\u6240\u6709\u53d1\u9001 TS2 \u7684\u901a\u9053\u90fd\u63a5\u6536\u5230 8 \u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684 TS2 \u65f6\uff0c\u5e76\u4e14\u5728\u63a5\u6536\u5230\u4e00\u4e2a TS2 \u540e\u8be5\u901a\u9053\u5df2\u7ecf\u53d1\u9001\u81f3\u5c11 16 \u4e2a TS2 \u540e\uff0c\u72b6\u6001\u673a\u5c06\u8df3\u8f6c\u81f3\u4e0b\u4e00\u4e2a\u72b6\u6001\uff1aConfiguration.Idle\u3002\u8fd9\u4e9b\u6761\u4ef6\u6307\u7684\u662f\u6240\u6709\u63a5\u6536\u7684 TS2 \u4e2d\u90fd\u643a\u5e26\u6709\u5339\u914d\u7684\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\uff08\u975e\u586b\u5145\u7b26\u53f7\uff09\uff0c\u5339\u914d\u7684\u901f\u7387\u6807\u8bc6\u7b26\uff08 rate identifier\uff09\uff0c\u4ee5\u53ca\u5339\u914d\u7684\u94fe\u8def Upconfig Capability \u6bd4\u7279\u3002</p> <p>\u5982\u679c\u8bbe\u5907\u652f\u6301 2.5 GT/s \u4ee5\u4e0a\u7684\u901f\u7387\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u8bb0\u5f55\u5728\u4efb\u4f55\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u7684\u901f\u7387\u6807\u8bc6\u7b26\uff0c\u5e76\u8986\u76d6\u6240\u6709\u6b64\u524d\u8bb0\u5f55\u7684\u6570\u503c\u3002\u201cchanged_speed_recovery\u201d \u7528\u4e8e\u5728 Recivery \u72b6\u6001\u4e2d\u8ffd\u8e2a\u901f\u7387\u7f16\u53f7\u7684\u53d8\u91cf\uff0c\u6b64\u65f6\u6e05\u9664\u4e3a 0\u3002</p> <p>\u53d8\u91cf \u201cupconfigure_capable\u201d \u5c06\u88ab\u8bbe\u7f6e\u4e3a 1b\uff0c\u5982\u679c\u8bbe\u5907\u53d1\u51fa\u7684 TS2 \u4e2d\u7684 Link Upconfigure Capability \u57df\u8bbe\u7f6e\u4e3a 1b\uff0c\u5e76\u4e14\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS2 \u5e8f\u5217\u5728\u8be5\u6bd4\u7279\u4e0a\u7684\u8bbe\u7f6e\u540c\u6837\u4e3a 1\u3002\u5426\u5219\uff0c\u8be5\u53d8\u91cf\u6e05\u9664\u4e3a 0\u3002</p> <p>\u4efb\u4f55\u6ca1\u6709\u914d\u7f6e\u4e3a\u94fe\u8def\u4e00\u90e8\u5206\u7684\u901a\u9053\u5c06\u4e0e\u5f53\u524d\u7684 LTSSM \u4e0d\u518d\u6709\u5173\u8054\uff0c\u5e76\u4e14\u5fc5\u987b\u8bbe\u7f6e\u4e3a\u4e0b\u8ff0\u5404\u79cd\u72b6\u6001\u4e2d\u7684\u4e00\u79cd\uff1a</p> <ul> <li>\u53ef\u9009\u7684\uff0c\u4e0e\u65b0\u7684 crosslink LTSSM \u76f8\u5173\u8054\uff08\u5982\u679c\u652f\u6301 crosslink \u7279\u6027\uff09\uff0c\u6216\u8005</li> <li>\u8f6c\u4e3a\u7535\u6c14\u7a7a\u95f2\u72b6\u6001</li> <li>\u8fd9\u91cc\u6d89\u53ca\u4e00\u79cd\u7279\u6b8a\u7684\u72b6\u6001\uff0c\u5373\u8fd9\u4e9b\u672a\u88ab\u914d\u7f6e\u8fdb\u94fe\u8def\u7684\u901a\u9053\u66fe\u7ecf\u5728 L0 \u72b6\u6001\u4e2d\u88ab\u914d\u7f6e\u4e3a\u94fe\u8def\u7684\u4e00\u90e8\u5206\uff0c\u5e76\u4e14 \u4ece\u90a3\u4e4b\u540e LinkUp \u72b6\u6001\u4f4d\u4e00\u76f4\u88ab\u8bbe\u7f6e\u4e3a 1b\u3002\u5982\u679c\u94fe\u8def\u652f\u6301 upconfigure\uff0c\u90a3\u4e48\u5b83\u4eec\u9700\u8981\u4ecd\u7136\u548c\u539f\u6765\u7684 LTSSM \u76f8\u5173\u8054\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u534f\u8bae\u5efa\u8bae\u8fd9\u4e9b\u901a\u9053\u4ecd\u7136\u4fdd\u6301\u6253\u5f00\u5bf9\u63a5\u6536\u7aef\u7684\u7ec8\u7ed3\uff08termination\uff09\u7279\u6027\uff0c\u56e0\u4e3a\u5728 upconfigured \u4e4b\u540e\uff0c\u5b83\u4eec\u53c8\u4f1a\u91cd\u65b0\u53d8\u6210\u94fe\u8def\u7684\u4e00\u4efd\u5b50\u3002\u5982\u679c\u4e0d\u4fdd\u6301\u7ec8\u7ed3\u7279\u6027\u6253\u5f00\uff0c\u90a3\u4e48\u5728 LTSSM \u4ece Configuration.Complete \u72b6\u6001\u8f6c\u4e3a Recovery.RcvrCfg \u72b6\u6001\u65f6\uff0c\u4e5f\u9700\u8981\u518d\u6b21\u6253\u5f00\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u8fd9\u4e9b\u901a\u9053\u5e76\u975e\u66fe\u7ecf\u662f\u94fe\u8def\u7684\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u5b83\u4eec\u65e0\u6cd5\u901a\u8fc7\u8be5\u8fc7\u7a0b\u6210\u4e3a\u94fe\u8def\u7684\u4e00\u90e8\u5206\u3002</li> <li>\u63a5\u6536\u963b\u6297\u5fc5\u987b\u4fdd\u6301\u5728 Z RX\u2010HIGH\u2010IMP\u2010DC\u2010POS \u548c Z RX\u2010HIGH\u2010IMP\u2010DC\u2010NEG \u4e4b\u95f4\u3002</li> <li>\u5728 LTSSM \u8fd4\u56de Detect \u72b6\u6001\u540e\uff0c\u8fd9\u4e9b\u901a\u9053\u4f1a\u91cd\u65b0\u548c\u5176\u5173\u8054\u3002</li> <li>\u8fd9\u4e9b\u901a\u9053\u8fdb\u5165\u7535\u5668\u7a7a\u95f2\u72b6\u6001\u4e4b\u524d\u65e0\u9700\u53d1\u9001 EIOS \u5e8f\u5217\uff0c\u5e76\u4e14\u72b6\u6001\u8f6c\u53d8\u4e5f\u5e76\u4e0d\u4e00\u5b9a\u9700\u8981\u53d1\u751f\u5728\u7b26\u53f7\u6216\u8005\u547d\u4ee4\u96c6\u7684\u8fb9\u754c\u4e0a\u3002</li> </ul> <p>\u5728 2ms \u7684\u8d85\u65f6\u53d1\u751f\u540e\uff1a</p> <p>\u8f6c\u79fb\u81f3 \u201dConfiguration.Idle\u201c \u72b6\u6001</p> <p>\u5982\u679c idle_to_rlock_transitioned \u53d8\u91cf\u5c0f\u4e8e FFh\uff0c\u5e76\u4e14\u5f53\u524d\u6570\u636e\u901f\u7387\u4e3a 8GT/s\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Configuration.Idle \u72b6\u6001\u3002</p> <p>\u5728\u8fd9\u6b21\u72b6\u6001\u8df3\u53d8\u4e2d\uff0cchanged_speed_recovery \u53d8\u91cf\u6e05\u9664\u4e3a 0\u3002\u5e76\u4e14\uff0c\u53d8\u91cf upconfigure_capable \u4e5f\u53ef\u80fd\u4f1a\u88ab\u66f4\u65b0\uff0c\u5c3d\u7ba1\u8fd9\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u5f53\u81f3\u5c11\u4e00\u4e2a\u901a\u9053\u4e0a\u89c1\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS2 \u5e8f\u5217\uff0c\u5b83\u4eec\u90fd\u643a\u5e26\u6709\u5339\u914d\u7684\u94fe\u8def\u7f16\u53f7\u548c\u901a\u9053\u7f16\u53f7\uff08\u975e\u586b\u5145\u7b26\u53f7\uff09\uff0c\u5982\u679c\u94fe\u8def\u6536\u53d1\u53cc\u65b9\u7684 Upconfig Capability \u6bd4\u7279\u90fd\u4e3a 1\uff0c\u90a3\u4e48 upconfigure_capable \u53d8\u91cf\u66f4\u65b0\u4e3a 1b\uff0c\u5426\u5219\u6e05\u9664\u4e3a 0\u3002</p> <p>\u4efb\u4f55\u6ca1\u6709\u914d\u7f6e\u4e3a\u94fe\u8def\u4e00\u90e8\u5206\u7684\u901a\u9053\u5c06\u4e0e\u5f53\u524d\u7684 LTSSM \u4e0d\u518d\u6709\u5173\u8054\uff0c\u5176\u4ed6\u6240\u9700\u7684\u6761\u4ef6\u4e0e\u4e0a\u8ff0\u5217\u51fa\u7684\u975e\u8d85\u65f6\u65f6\u7684\u6761\u4ef6\u4e00\u81f4\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5728\u8d85\u65f6\u540e\uff0c\u5982\u679c\u672a\u6ee1\u8db3\u4e0a\u4e00\u6bb5\u7684\u6761\u4ef6\uff0c\u5219\u8f6c\u5165 Detect \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14646-configurationidle","title":"14.6.4.6 Configuration.Idle","text":"<p>Configuration.Idle \u671f\u95f4</p> <p>\u5728 Configuration.Idle \u6b21\u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u65b9\u4e0d\u65ad\u53d1\u9001\u7a7a\u95f2\u6570\u636e\uff0c\u7b49\u5f85\u63a5\u6536\u5230\u8db3\u591f\u6570\u91cf\u7684\u7a7a\u95f2\u6570\u636e\u540e\uff0c\u5c06\u94fe\u8def\u8f6c\u4e3a L0 \u72b6\u6001\u3002\u6b64\u65f6\uff0c\u7269\u7406\u5c42\u5411\u4e0a\u5c42\u62a5\u544a\u94fe\u8def\u5df2\u7ecf\u5904\u4e8e\u5c31\u7eea\u72b6\u6001\uff08Linkup = 1b\uff09\u3002</p> <p>\u5bf9\u4e8e 8b/10b \u7f16\u7801\u800c\u8a00\uff0c\u53d1\u9001\u65b9\u5728\u6240\u6709\u5df2\u914d\u7f6e\u7684\u901a\u9053\u4e0a\u53d1\u9001\u7a7a\u95f2\u6570\u636e\uff0c\u6240\u8c13\u7a7a\u95f2\u6570\u636e\u5176\u5b9e\u5c31\u662f\u6570\u503c\u96f6\u7ecf\u8fc7\u52a0\u6270\u548c\u7f16\u7801\u4e4b\u540e\u7684\u6570\u503c\u3002</p> <p>\u5bf9\u4e8e 128b/130b \u7f16\u7801\u800c\u8a00\uff0c\u53d1\u9001\u65b9\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u53d1\u9001\u4e00\u4e2a SDS \u6709\u5e8f\u547d\u4ee4\u96c6\uff0c\u540e\u9762\u7d27\u63a5\u7740\u53d1\u9001\u7a7a\u95f2\u6570\u636e\u3002\u901a\u9053 0 \u4e0a\u7684\u7b2c\u4e00\u4e2a\u7a7a\u95f2\u7b26\u53f7\u662f\u6570\u636e\u6d41\u7684\u7b2c\u4e00\u4e2a\u7b26\u53f7\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dL0\u201c \u72b6\u6001</p> <p>\u5982\u679c\u91c7\u7528 8b/10b \u7f16\u7801\u65b9\u5f0f\uff0c\u90a3\u4e48\u5728\u5168\u90e8\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7b26\u53f7\u5468\u671f\u7a7a\u95f2\u6570\u636e\uff0c\u5e76\u4e14\u5728\u6536\u5230\u4e00\u4e2a\u7a7a\u95f2\u7b26\u53f7\u540e\u5df2\u7ecf\u53d1\u9001\u4e86 16 \u4e2a\u7b26\u53f7\u5468\u671f\u7684\u7a7a\u95f2\u6570\u636e\u540e\uff0c\u8fdb\u5165 L0 \u72b6\u6001\u3002</p> <p>\u5982\u679c\u91c7\u7528 128b/130b \u7f16\u7801\u65b9\u5f0f\uff0c\u90a3\u4e48\u5728\u5168\u90e8\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7b26\u53f7\u5468\u671f\u7a7a\u95f2\u6570\u636e\uff0c\u5e76\u4e14\u5728\u6536\u5230\u4e00\u4e2a\u7a7a\u95f2\u7b26\u53f7\u540e\u5df2\u7ecf\u53d1\u9001\u4e86 16 \u4e2a\u7b26\u53f7\u5468\u671f\u7684\u7a7a\u95f2\u6570\u636e\uff0c\u5e76\u4e14\u4e0d\u662f\u5728 Configuration.Complete \u72b6\u6001\u8d85\u65f6\u540e\u4e0b\u8fdb\u5165\u7684\u672c\u72b6\u6001\uff0c\u90a3\u4e48\u8df3\u8f6c\u81f3 L0 \u72b6\u6001\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a</p> <ul> <li>\u5404\u901a\u9053\u95f4\u53bb\u504f\u659c\u5fc5\u987b\u5728\u5f00\u59cb\u5904\u7406\u6570\u636e\u6d41\u4e4b\u524d\u5b8c\u6210</li> <li>\u7a7a\u95f2\u7b26\u53f7\u5fc5\u987b\u5728\u6570\u636e\u5757\u5185\u6536\u5230</li> <li>\u5982\u679c\u6b64\u6b21\u7531 configuration \u72b6\u6001\u6216\u8005 Recovery \u72b6\u6001\u81f3 L0 \u72b6\u6001\u7684\u8df3\u8f6c\uff0c\u662f\u8f6f\u4ef6\u901a\u8fc7\u7f6e\u4f4d\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\uff08Link Control register\uff09\u4e2d\u7684\u91cd\u65b0\u8bad\u7ec3\u94fe\u8def\uff08Retrain Link\uff09\u6bd4\u7279\u89e6\u53d1\u7684\u3002\u90a3\u4e48 DSP \u5fc5\u987b\u7f6e\u4f4d\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\uff08Link Status register\uff09\u4e2d\u7684\u94fe\u8def\u5e26\u5bbd\u7ba1\u7406\uff08Link Bandwidth Management\uff09\u6bd4\u7279\uff0c\u8868\u793a\u6b64\u6b21\u72b6\u6001\u8df3\u8f6c\u4e0d\u662f\u7531\u786c\u4ef6\u53d1\u8d77\u7684\uff08autonomous\uff09</li> <li>\u5728\u8fdb\u5165 L0 \u72b6\u6001\u524d\uff0c\u5c06\u53d8\u91cf  \u201cidle_to_rlock_transitioned\u201d \u6e05\u96f6\u3002</li> </ul> <p>\u672a\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u5e76\u89e6\u53d1 2ms \u8d85\u65f6\u540e\uff1a</p> <p>\u8f6c\u79fb\u81f3\u5177\u4f53\u7684 Recovery \u6b21\u72b6\u6001</p> <p>\u5982\u679c\u53d8\u91cf  \u201cidle_to_rlock_transitioned\u201d  \u5c0f\u4e8e FFh\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u8df3\u8f6c\u72b6\u6001\u662f Recovery\uff08Recovery.Rcvrlock\uff09\u3002\u8df3\u8f6c\u540e\uff1a</p> <p>a) 8.0 GT/s \u65f6\uff0c\u53d8\u91cf idle_to_rlock_transitioned \u81ea\u589e 1\u3002</p> <p>b) 2.5 \u6216\u8005 5.0 GT/s \u65f6\uff0c\u53d8\u91cf idle_to_rlock_transitioned \u8bbe\u7f6e\u4e3a FFh\u3002</p> <p>c) \u6ce8\u610f\uff1a\u8be5\u53d8\u91cf\u8bb0\u5f55\u4e86\u56e0\u4e3a\u914d\u7f6e\u8fc7\u7a0b\u6ca1\u6709\u8d77\u4f5c\u7528\uff0c\u4ece\u800c\u5bfc\u81f4\u72b6\u6001\u673a\u4ece Configuration.Idle \u72b6\u6001\u8df3\u8f6c\u5230 Recovery \u72b6\u6001\u7684\u6b21\u6570\u3002\u8fd9\u53ef\u80fd\u662f\u56e0\u4e3a\u5747\u8861\u8bbe\u7f6e\u4e0d\u5408\u9002\uff0c\u6216\u8005\u5f53\u524d\u9009\u62e9\u7684\u901f\u7387\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u5bfc\u81f4\u7684\uff0cRecovery \u72b6\u6001\u5185\u4f1a\u91c7\u53d6\u63aa\u65bd\u5c1d\u8bd5\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002\u8be5\u53d8\u91cf\u9650\u5236\u4e86\u4ece\u672c\u72b6\u6001\u8df3\u8f6c\u81f3 Recovery \u72b6\u6001\u7684\u5c1d\u8bd5\u6b21\u6570\uff0c\u4ece\u800c\u907f\u514d\u4e86\u6c38\u4e45\u7684\u65e0\u9650\u5faa\u73af\u3002\u5982\u679c\u94fe\u8def\u5728 256 \u6b21\u5c1d\u8bd5\u540e\uff08\u53d8\u91cf\u8ba1\u6570\u81f3 FFh\uff09\u4ecd\u7136\u6ca1\u6cd5\u6b63\u5e38\u5de5\u4f5c\uff0c\u90a3\u4e48\u8df3\u8f6c\u56de Detect \u72b6\u6001\u91cd\u65b0\u5f00\u59cb\uff0c\u5e76\u5e0c\u671b\u8fd9\u6b21\u80fd\u6709\u66f4\u597d\u7684\u7ed3\u679c\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5426\u5219\uff0c\u5373 idle_to_rlock_transitioned \u4e3a FFh \u65f6\uff0c\u8df3\u8f6c\u81f3 Detect \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#147-l0-state-l0","title":"14.7 L0 State // L0 \u72b6\u6001","text":"<p>L0 \u72b6\u6001\u662f\u94fe\u8def\u7684\u5168\u529f\u80fd\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001, \u867d\u7136\u521a\u8fdb\u5165\u6b64\u72b6\u6001\u65f6\u5904\u4e8e\u903b\u8f91\u7a7a\u95f2\u72b6\u6001,\u4f46\u4e4b\u540e\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u4f1a\u4ea4\u6362 TLP \u548c DLLP\uff08\u8bd1\u6ce8\uff1a\u6b64\u5904\u6309\u7167\u4e2a\u4eba\u7406\u89e3\u7ffb\u8bd1\u4e86\uff0c\u539f\u6587\u4e3a This is the normal, fully\u2010operational Link state, during which Logical Idle, TLPs and DLLPs are exchanged between Link neighbors.\uff09\u3002\u5728\u94fe\u8def\u8bad\u7ec3\u8fc7\u7a0b\u5b8c\u6210\u540e\uff0c\u4f1a\u7acb\u523b\u8fbe\u6210 L0 \u72b6\u6001\u3002\u7269\u7406\u5c42\u6b64\u65f6\u901a\u8fc7 LinkUp \u53d8\u91cf\u901a\u77e5\u66f4\u9ad8\u5c42\u7684\u903b\u8f91: \u94fe\u8def\u5df2\u7ecf\u51c6\u5907\u5c31\u7eea\u3002\u6b64\u5916\u53d8\u91cf idle_to_rlock_transitioned \u4e5f\u590d\u4f4d\u4e3a 00h\u3002</p> <p>\u8f6c\u79fb\u81f3 Recovery \u72b6\u6001</p> <p>\u5982\u679c\u672c\u65b9\u8bbe\u5907\u63d0\u8bae\u6539\u53d8\u94fe\u8def\u901f\u7387\u6216\u8005\u5bbd\u5ea6\uff0c\u6216\u8005\u5bf9\u7aef\u8bbe\u5907\u5df2\u7ecf\u8fdb\u5165\u4e86 Recovery \u6216\u8005\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u8868\u793a\u63d0\u8bae\u53d1\u8d77\u94fe\u8def\u901f\u7387\u6216\u8005\u5bbd\u5ea6\u6539\u53d8\uff0c\u90a3\u4e48\u72b6\u6001\u673a\u7684\u4e0b\u4e00\u4e2a\u72b6\u6001\u662f Recovery \u72b6\u6001\u3002\u8ba9\u6211\u4eec\u63a5\u4e0b\u6765\u7528\u4e00\u4e9b\u7565\u8be6\u7ec6\u7684\u7bc7\u5e45\u6765\u4ecb\u7ecd\u4e09\u79cd\u60c5\u51b5\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1471-speed-change","title":"14.7.1 Speed Change // \u901f\u7387\u5207\u6362","text":"<p>\u534f\u8bae\u4e2d\u63d0\u5230\u4e24\u79cd\u89e6\u53d1\u81ea\u52a8\u901f\u7387\u6539\u53d8\u7684\u60c5\u51b5\u3002</p> <p>\u7b2c\u4e00\u79cd\u60c5\u51b5\u662f\u94fe\u8def\u53cc\u65b9\u90fd\u652f\u6301 2.5GT/s \u4ee5\u4e0a\u7684\u901f\u7387\uff0c\u5e76\u4e14\u94fe\u8def\u5904\u4e8e\u6d3b\u8dc3\u72b6\u6001\u65f6\uff08\u6570\u636e\u94fe\u8def\u5c42\u62a5\u544a DL_Active\uff09\uff0c\u6216\u8005\u94fe\u8def\u4e00\u65b9\u901a\u8fc7 TS\u00bd \u6709\u5e8f\u96c6\u8bf7\u6c42\u901f\u7387\u8f6c\u6362\u65f6\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u5bf9\u65b9\u58f0\u660e\u652f\u6301\u66f4\u9ad8\u7684\u901f\u7387\uff0c\u5e76\u4e14\u8f6f\u4ef6\u901a\u8fc7\u4f7f\u80fd\u91cd\u8bad\u7ec3\uff08Retrain Link \uff09\u6bd4\u7279\uff0c\u5e76\u5c06\u76ee\u6807\u901f\u7387\uff08Target Link Speed\uff0c\u89c1\u539f\u6587 569 \u9875\u7684\u56fe 14-26\uff09\u8bbe\u7f6e\u4e3a\u4e0e\u5f53\u524d\u4e0d\u540c\u7684\u901f\u7387\uff0c\u90a3\u4e48 DSP \u4f1a\u53d1\u8d77\u4e00\u6b21\u901f\u7387\u8f6c\u6362\u3002</p> <p>\u7b2c\u4e8c\u79cd\u901f\u7387\u5207\u6362\u7684\u60c5\u51b5\u662f\u94fe\u8def\u53cc\u65b9\u90fd\u652f\u6301 8GT/s \u901f\u7387\uff0c\u5e76\u4e14\u4e00\u65b9\u6253\u7b97\u8fdb\u884c Tx \u5747\u8861\u3002\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\u53d8\u91cf directed_speed_change \u90fd\u4f1a\u88ab\u8bbe\u7f6e\u4e3a 1b\uff0c\u5e76\u4e14 changed_speed_recovery \u6bd4\u7279\u4f1a\u88ab\u6e05\u9664\u4e3a 0b\u3002</p> <p>\u5982\u679c\u94fe\u8def\u5bf9\u7aef\u5728 Configuration.Complete \u6216\u8005 Recovery.RcvrCfg \u72b6\u6001\u4e2d\u4ece\u672a\u901a\u544a\u8fc7\u6bd4 2.5 GT/s \u66f4\u9ad8\u7684\u901f\u7387\uff0c\u90a3\u4e48\u5f53\u524d\u7aef\u53e3\u4e0d\u4f1a\u53d1\u8d77\u901f\u7387\u6539\u53d8\uff08\u4e5f\u5c31\u662f\u4e0d\u4f1a\u8bbe\u7f6e directed_speed_change \u53d8\u91cf\uff09\u3002</p> <p></p> <p>\u56fe 14-25 \u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668</p> <p></p> <p>\u56fe 14-26 \u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668 2</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1472-link-width-change","title":"14.7.2 Link Width Change // \u94fe\u8def\u5bbd\u5ea6\u5207\u6362","text":"<p>\u5f53\u53d8\u91cf upconfigure_capable \u8bbe\u7f6e\u4e3a 1b \u65f6\uff0c\u4e0a\u5c42\u7684\u903b\u8f91\uff08Upper layer\uff09\u4e00\u822c\u53ea\u4f1a\u51cf\u5c11\u94fe\u8def\u5bbd\u5ea6\uff0c\u7528\u4e8e\u6062\u590d\u94fe\u8def\u7684\u539f\u59cb\u5bbd\u5ea6\u3002\u5982\u679c\u7981\u6b62\u786c\u4ef6\u81ea\u4e3b\u51b3\u5b9a\u4f4d\u5bbd\uff08Hardware Autonomous Width Disable\uff09\u6bd4\u7279\u88ab\u7f6e\u4f4d\u4e3a 1b\uff0c\u90a3\u4e48\u7aef\u53e3\u5c06\u53ea\u80fd\u901a\u8fc7\u51cf\u5c11\u94fe\u8def\u5bbd\u5ea6\u6765\u89e3\u51b3\u53ef\u9760\u6027\u95ee\u9898\u3002\u4ec5\u5f53\u94fe\u8def\u5bf9\u7aef\u4f19\u4f34\u901a\u544a\u5176\u5177\u6709\u94fe\u8def\u5bbd\u5ea6\u6062\u590d\u80fd\u529b\uff0c\u5e76\u4e14\u94fe\u8def\u5bbd\u5ea6\u6ca1\u6709\u88ab\u914d\u7f6e\u4e3a\u6700\u5927\u5bbd\u5ea6\u65f6\uff0c\u4e0a\u5c42\u903b\u8f91\u624d\u53ef\u4ee5\u53d1\u8d77\u4e00\u6b21\u94fe\u8def\u5bbd\u5ea6\u589e\u52a0\u64cd\u4f5c\u3002\u9664\u4e86\u4e0a\u8ff0\u6307\u5bfc\u6027\u5efa\u8bae\u4ee5\u5916\uff0c\u534f\u8bae\u4e2d\u6ca1\u6709\u5176\u4ed6\u5173\u4e8e\u4f55\u65f6\u8fdb\u884c\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u7684\u89c4\u5b9a\uff0c\u56e0\u6b64\u8be5\u884c\u4e3a\u7684\u7ec6\u8282\u53d6\u51b3\u4e8e\u5177\u4f53\u5b9e\u73b0\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1473-link-partner-initiated","title":"14.7.3 Link Partner Initiated //\u94fe\u8def\u4f19\u4f34\u53d1\u8d77\u94fe\u8def\u6539\u53d8\u7684\u60c5\u5f62","text":"<p>\u534f\u8bae\u4e2d\u63cf\u8ff0\u4e86\u4e09\u79cd\u94fe\u8def\u4f19\u4f34\u53d1\u8d77\u94fe\u8def\u6539\u53d8\u7684\u60c5\u5f62\uff1a</p> <p>\u9996\u5148\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u672c\u65b9\u7aef\u53e3\u5728\u94fe\u8def\u4e0a\u7684\u6240\u6709\u901a\u9053\u4e0a\u68c0\u6d4b\u6216\u8005\u63a8\u65ad\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff08\u8be6\u89c1\u539f\u6587 596 \u9875\u7684\u8868 14-10\uff09\uff0c\u5e76\u4e14\u6b64\u524d\u6ca1\u6709\u5728\u4efb\u4f55\u901a\u9053\u4e0a\u63a5\u6536\u5230 EIOS \u6709\u5e8f\u96c6\u3002\u6b64\u65f6\uff0c\u7aef\u53e3\u53ef\u4ee5\u9009\u62e9\u7559\u5728 L0 \u72b6\u6001\u6216\u8005\u8fdb\u5165 Recovery \u72b6\u6001\u3002\u5982\u679c\u7531\u6b64\u4ea7\u751f\u9519\u8bef\uff0c\u90a3\u4e48\u7aef\u53e3\u53ef\u80fd\u901a\u8fc7\u7f6e\u4f4d Retrain link \u6bd4\u7279\u7684\u65b9\u5f0f\u8fdb\u5165 Recovery \u72b6\u6001\u3002</p> <p>\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u672c\u65b9\u7aef\u53e3\u5728\u4efb\u4f55\u5df2\u914d\u7f6e\u7684\u901a\u9053\u4e0a\u63a5\u6536\u5230 TS1 \u6216\u8005 TS2 \u5e8f\u5217\uff08128b/130b \u7f16\u7801\u65f6\u63a5\u6536\u5230 EIEOS\uff09\uff0c\u8fd9\u8868\u793a\u5bf9\u7aef\u5df2\u7ecf\u8fdb\u5165 Recovery \u72b6\u6001\u3002\u7531\u4e8e\u8fd9\u4e24\u79cd\u60c5\u51b5\u90fd\u662f\u7531\u5bf9\u7aef\u53d1\u8d77\u7684\uff0c\u56e0\u6b64\u672c\u65b9\u7aef\u53e3\u53d1\u9001\u7aef\u88ab\u5141\u8bb8\u5b8c\u6210\u6b63\u5728\u8fdb\u884c\u4e2d\u7684 TLP \u6216\u8005 DLLP\u3002</p> <p>\u7b2c\u4e09\u79cd\u60c5\u51b5\uff0c\u5982\u679c\u4efb\u4f55\u901a\u9053\u4e0a\u63a5\u6536\u5230\u4e86 EIOS \u5e8f\u5217\uff0c\u8868\u793a\u5bf9\u65b9\u5df2\u8fdb\u884c\u4e86\u7535\u6e90\u72b6\u6001\u8f6c\u53d8\uff0c\u4f46\u662f\u63a5\u6536\u65b9\u4e0d\u652f\u6301 L0s \u5e76\u4e14\u6ca1\u6709\u8fdb\u5165\u5230 L1 \u6216\u8005 L2\uff0c\u56e0\u6b64\u53ea\u80fd\u9009\u62e9\u8fdb\u5165 Recovery \u72b6\u6001\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dL0s\u201c \u72b6\u6001</p> <p>\u5728\u53d1\u9001\u65b9\u53d1\u8d77\u8fdb\u5165 L0s \u72b6\u6001\u7684\u8bf7\u6c42\u540e\uff0c\u6216\u8005\u63a5\u6536\u65b9\u63a5\u6536\u5230 EIOS \u5e8f\u5217\u540e\uff0c\u8fdb\u5165 L0s \u72b6\u6001\u3002\u6709\u8da3\u7684\u662f\uff0c\u6b64\u65f6\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u7684 LTSSM \u72b6\u6001\u673a\u72b6\u6001\u53ef\u80fd\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u4e3a\u534f\u8bae\u5141\u8bb8\u5176\u4e2d\u4e00\u65b9\u5904\u4e8e L0s \u72b6\u6001\uff0c\u800c\u53e6\u4e00\u65b9\u4ecd\u5728 L0 \u72b6\u6001\u3002</p> <ul> <li>\u53d1\u9001\u65b9\u63a5\u6536\u5230\u4e0a\u5c42\u903b\u8f91\u8fdb\u5165 L0s \u72b6\u6001\u7684\u6307\u793a\u540e\u8fdb\u5165 L0s \u72b6\u6001\uff0c\u5e76\u5728\u94fe\u8def\u4e0a\u53d1\u9001 EIOS \u53d1\u8d77\u6539\u53d8\u8bf7\u6c42\u3002</li> <li>\u63a5\u6536\u65b9\u5728\u4efb\u4e00\u901a\u9053\u4e0a\u63a5\u6536\u5230 EIOS \u540e\u8fdb\u5165 L0s \u72b6\u6001\u3002\u7136\u800c\uff0c\u5982\u679c\u63a5\u6536\u65b9\u6ca1\u6709\u5b9e\u73b0 L0s \u72b6\u6001\uff0c\u5e76\u4e14\u672a\u88ab\u4e0a\u5c42\u903b\u8f91\u8981\u6c42\u8fdb\u5165 L1 \u6216\u8005 L2 \u72b6\u6001\u65f6\uff0c\u4f1a\u88ab\u89c6\u4f5c\u53d1\u751f\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u8f6c\u800c\u8fdb\u5165  Recovery \u72b6\u6001\u3002</li> </ul> <p>\u8f6c\u79fb\u81f3 \u201dRx_L0s.Entry\u201c \u72b6\u6001</p> <p>\u5f53\u94fe\u8def\u4f19\u4f34\u88ab\u547d\u4ee4\u5728\u94fe\u8def\u4e0a\u53d1\u8d77 L1 \u72b6\u6001\u8f6c\u79fb\u540e\uff0c\u5b83\u4f1a\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u4e00\u4e2a EIOS \u5e8f\u5217\uff08\u5982\u679c\u901f\u7387\u4e3a 5.0 GT/s\uff0c\u90a3\u5c31\u53d1\u4e24\u4e2a \uff09\uff0c\u5e76\u5728\u4efb\u610f\u901a\u9053\u4e0a\u63a5\u6536\u5230\u4e00\u4e2a EIOS \u540e\uff0c\u4e0b\u4e00\u4e2a\u8df3\u8f6c\u72b6\u6001\u662f L1 \u72b6\u6001\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u94fe\u8def\u8fdb\u5165 L1 \u72b6\u6001\u4e4b\u524d\u9700\u8981\u94fe\u8def\u53cc\u65b9\u90fd\u4e8b\u5148\u540c\u610f\uff0c\u56e0\u6b64\u9700\u8981\u4e00\u9879\u6570\u636e\u94fe\u8def\u5c42\u63e1\u624b\u673a\u5236\u4fdd\u8bc1\u53cc\u65b9\u90fd\u5df2\u7ecf\u51c6\u5907\u597d\u8fdb\u5165 L1\u3002\u5173\u4e8e L1 \u72b6\u6001\u7684\u8be6\u60c5\uff0c\u53ef\u4ee5\u53c2\u8003\u539f\u6587 733 \u9875\u7684 \u201d\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u201c \u4e00\u8282 \uff08\u539f\u4e66\u7b2c 16 \u7ae0\uff09\u3002</p> <p>\u8f6c\u79fb\u81f3 \u201dL2\u201c \u72b6\u6001</p> <p>\u5f53\u94fe\u8def\u4f19\u4f34\u88ab\u547d\u4ee4\u5728\u94fe\u8def\u4e0a\u53d1\u8d77 L2 \u72b6\u6001\u8f6c\u79fb\u540e\uff0c\u5b83\u4f1a\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u4e00\u4e2a EIOS \u5e8f\u5217\uff08\u5982\u679c\u901f\u7387\u4e3a 5.0 GT/s\uff0c\u90a3\u5c31\u53d1\u4e24\u4e2a \uff09\uff0c\u5e76\u5728\u4efb\u610f\u901a\u9053\u4e0a\u63a5\u6536\u5230\u4e00\u4e2a EIOS \u540e\uff0c\u4e0b\u4e00\u4e2a\u8df3\u8f6c\u72b6\u6001\u662f L2 \u72b6\u6001\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u94fe\u8def\u8fdb\u5165 L2 \u72b6\u6001\u4e4b\u524d\u9700\u8981\u94fe\u8def\u53cc\u65b9\u90fd\u4e8b\u5148\u540c\u610f\uff0c\u56e0\u6b64\u9700\u8981\u4e00\u9879\u6570\u636e\u94fe\u8def\u5c42\u63e1\u624b\u673a\u5236\u4fdd\u8bc1\u53cc\u65b9\u90fd\u5df2\u7ecf\u51c6\u5907\u597d\u8fdb\u5165 L2\u3002\u5173\u4e8e L2 \u72b6\u6001\u7684\u8be6\u60c5\uff0c\u53ef\u4ee5\u53c2\u8003\u539f\u6587 733 \u9875\u7684 \u201d\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u201c \u4e00\u8282 \uff08\u539f\u4e66\u7b2c 16 \u7ae0\uff09\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#148-recovery-state","title":"14.8 Recovery State // \u6062\u590d\u72b6\u6001","text":"<p>\u5982\u679c\u4e00\u5207\u5982\u9884\u671f\u4e00\u6837\u987a\u5229\uff0c\u90a3\u4e48\u94fe\u8def\u53ef\u4ee5\u5728\u4e0d\u8fdb\u5165 Recovery \u72b6\u6001\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u88ab\u8bad\u7ec3\u8fdb\u5165 L0 \u72b6\u6001\uff0c\u8fd9\u4e00\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001\u3002\u4f46\u6211\u4eec\u4e4b\u524d\u8ba8\u8bba\u8fc7\uff0c\u5728\u4e24\u79cd\u60c5\u51b5\u4e0b\u4e00\u5b9a\u9700\u8981\u8fdb\u5165 Recovery \u72b6\u6001\u3002</p> <p>\u9996\u5148\u4e00\u79cd\u60c5\u51b5\uff0c\u5982\u679c\u5728 Configuration.Idle \u72b6\u6001\u4e2d\u6ca1\u80fd\u6210\u529f\u63a5\u6536\u5230\u6b63\u786e\u7684\u94fe\u8def\u7b26\u53f7\uff0c\u90a3\u4e48 LTSSM \u4f1a\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u5c1d\u8bd5\u7ea0\u6b63\u94fe\u8def\u4e2d\u7684\u4fe1\u53f7\u8d28\u91cf\u95ee\u9898\uff0c\u6bd4\u5982\u901a\u8fc7\u8c03\u6574\u5747\u8861\u53c2\u6570\u7684\u65b9\u5f0f\u3002</p> <p>\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u5728\u94fe\u8def\u4ee5 2.5GT/s \u901f\u7387\u8bad\u7ec3\u5b8c\u6210\uff0c\u8fdb\u5165 L0 \u72b6\u6001\u540e\uff0c\u5982\u679c\u53cc\u65b9\u90fd\u652f\u6301\u66f4\u9ad8\u7684\u901f\u7387\uff0c\u90a3\u4e48 LTSSM \u4f1a\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u5c06\u901f\u7387\u8c03\u6574\u4e3a\u53cc\u65b9\u540c\u65f6\u652f\u6301\u6216\u8005\u901a\u544a\u7684\u6700\u9ad8\u901f\u7387\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cLTSSM \u5fc5\u987b\u91cd\u65b0\u8fdb\u884c\u6bd4\u7279\u9501\u5b9a\u548c\u7b26\u53f7\u6216\u8005\u5757\u9501\u5b9a\uff0c\u4ee5\u53ca\u94fe\u8def\u95f4\u7684\u53bb\u9664\u504f\u659c\u64cd\u4f5c\u3002</p> <p>\u94fe\u8def\u7f16\u53f7\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\u6b63\u5e38\u60c5\u51b5\u4e0b\u9700\u8981\u4fdd\u6301\u4e0d\u53d8\uff0c\u9664\u975e\u9700\u8981\u6539\u53d8\u94fe\u8def\u5bbd\u5ea6\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b LTSSM \u8fdb\u5165 Configuration \u72b6\u6001\uff0c\u91cd\u65b0\u8fdb\u884c\u94fe\u8def\u5bbd\u5ea6\u534f\u5546\u3002</p> <p>\u6ce8\u610f\uff1a\u7b80\u6d01\u8d77\u89c1\uff0c\u672c\u7ae0\u540e\u7eed\u4e2d\u4f7f\u7528\u9501\u5b9a\uff08Lock\uff09\u4e00\u8bcd\u8868\u793a\u5df2\u7ecf\u5b8c\u6210\u4e86\u6bd4\u7279\u9501\u5b9a\u548c 8b/10b \u7f16\u7801\u7684\u7b26\u53f7\u9501\u5b9a\u3001\u6216\u8005 128b/130b \u7f16\u7801\u7684\u5757\u9501\u5b9a\u3002\u63a5\u6536\u7aef\u5fc5\u987b\u9996\u5148\u5b8c\u6210\u6bd4\u7279\u548c\u7b26\u53f7\u6216\u8005\u5757\u7684\u9501\u5b9a\u64cd\u4f5c\u4e4b\u540e\uff0c\u624d\u80fd\u5728\u94fe\u8def\u4e0a\u8bc6\u522b\u51fa\u6709\u6548\u7684\u7b26\u53f7\u3001\u5e8f\u5217\u4ee5\u53ca\u62a5\u6587\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1481-recovery","title":"14.8.1 \u51e0\u4e2a\u8fdb\u5165 Recovery \u72b6\u6001\u7684\u7406\u7531","text":"<ul> <li>\u4ece L1 \u72b6\u6001\u9000\u51fa\u65f6\uff0c\u5fc5\u987b\u8fdb\u5165 Recovery \u72b6\u6001\u91cd\u65b0\u8bad\u7ec3\uff0c\u56e0\u4e3a\u534f\u8bae\u4e2d\uff0c\u9000\u51fa L1\u6ca1\u6709\u4efb\u4f55\u5feb\u901f\u91cd\u8bad\u7ec3\u9009\u9879\u3002\uff08\u6bd4\u5982\u53d1\u9001 FTS \u5e8f\u5217\u7b49\u65b9\u6cd5\uff09</li> <li>\u4ece L0s \u72b6\u6001\u9000\u51fa\u65f6\uff0c\u5982\u679c\u63a5\u6536\u65b9\u5728\u89c4\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u6ca1\u80fd\u4f9d\u9760 FTS \u5e8f\u5217\u5b8c\u6210\u540c\u6b65\uff0c\u90a3\u4e48\u4e5f\u5fc5\u987b\u8fdb\u5165 Recovery \u72b6\u6001\u91cd\u65b0\u8bad\u7ec3\u3002</li> <li>\u5728 L0 \u72b6\u6001\u4e2d\uff0c\u8fd9\u4e9b\u60c5\u51b5\u4e0b\u9700\u8981\u8fdb\u5165 Recovery \u72b6\u6001\uff1a</li> <li>\u5728\u521d\u6b21\u8bad\u7ec3\u5b8c\u6210\u540e\uff0c\u6253\u7b97\u5c06\u94fe\u8def\u8bad\u7ec3\u4e3a\u66f4\u9ad8\u7684\u901f\u7387\u3002</li> <li>\u94fe\u8def\u88ab\u4e0a\u5c42\u903b\u8f91\u8981\u6c42\u6539\u53d8\u901f\u5ea6\u6216\u8005\u5bbd\u5ea6\u3002\uff08\u53ef\u80fd\u662f\u56e0\u4e3a\u529f\u8017\u7ba1\u7406\u7684\u9700\u6c42\uff0c\u6216\u8005\u662f\u56e0\u4e3a\u94fe\u8def\u65e0\u6cd5\u5728\u5f53\u524d\u901f\u7387\u6216\u8005\u5bbd\u5ea6\u4e0b\u7a33\u5b9a\u5de5\u4f5c\uff09</li> <li>\u8f6f\u4ef6\u901a\u8fc7\u5199\u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668\uff08Link Control Register \uff09\u4e2d\u7684\u91cd\u8bad\u7ec3\u5b57\u6bb5\uff08Retrain Link bit\uff09\uff0c\uff08\u53ef\u89c1\u539f\u6587 644 \u9875\u56fe 14\u201071\uff09\uff0c\u89e6\u53d1\u94fe\u8def\u91cd\u8bad\u7ec3\u4ee5\u5c1d\u8bd5\u4fee\u590d\u4e00\u4e9b\u4f20\u8f93\u95ee\u9898\u3002</li> <li>\u56e0\u4e3a Ack/Nak \u534f\u8bae\u51fa\u73b0\u8bf8\u5982\u91cd\u653e\u8ba1\u6570\u5668\u7ffb\u8f6c\u7b49\u9519\u8bef\u4e8b\u4ef6\uff0c\u6570\u636e\u94fe\u8def\u5c42\u81ea\u52a8\u63a7\u5236\u7269\u7406\u5c42\u91cd\u65b0\u8bad\u7ec3\u94fe\u8def\u3002</li> <li>\u63a5\u6536\u7aef\u5728\u5b8c\u6210\u914d\u7f6e\u7684\u94fe\u8def\u4e0a\u63a5\u6536\u5230 TS1\uff0cTS2 \u5e8f\u5217\uff0c\u4ece\u800c\u83b7\u77e5\u5230\u5bf9\u7aef\u5df2\u7ecf\u8fdb\u5165 Recovery \u72b6\u6001\u3002</li> <li>\u63a5\u6536\u7aef\u5728\u5b8c\u6210\u914d\u7f6e\u7684\u94fe\u8def\u4e0a\uff0c\u5728\u6ca1\u6709\u63a5\u6536\u5230 EIOS \uff08Electrical Idle Ordered Set\uff09\u5e8f\u5217\u7684\u60c5\u51b5\u4e0b\u68c0\u6d4b\u5230\u4e86\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</li> </ul>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1482-recovery","title":"14.8.2 \u521d\u59cb\u5316 Recovery \u72b6\u6001","text":"<p>\u94fe\u8def\u4e2d\u7684\u4efb\u610f\u4e00\u65b9\u90fd\u53ef\u4ee5\u901a\u8fc7\u5411\u5bf9\u7aef\u53d1\u9001 TS1 \u5e8f\u5217\u6765\u53d1\u8d77\u8fdb\u5165 Recovery \u72b6\u6001\u7684\u8bf7\u6c42\u3002\u5f53\u4e00\u4e2a PCIe \u7aef\u53e3\u63a5\u6536\u5230 TS1 \u65f6\uff0c\u4ed6\u4fbf\u83b7\u77e5\u5bf9\u7aef\u5df2\u7ecf\u8fdb\u5165\u4e86 Recovery \u72b6\u6001\uff0c\u968f\u540e\u5176\u8ddf\u968f\u5bf9\u7aef\u8fdb\u5165 Recovery \u72b6\u6001\u3002\u8fdb\u5165 Recovery  \u72b6\u6001\u4e4b\u540e\uff0c\u672c\u65b9\u7aef\u53e3\u4e5f\u5f00\u59cb\u5411\u5bf9\u65b9\u56de\u590d TS1 \u5e8f\u5217\u3002\u53cc\u65b9\u63a5\u6536\u7aef\u90fd\u901a\u8fc7\u5bf9\u65b9\u7684 TS1 \u5e8f\u5217\u5b8c\u6210\u9501\u5b9a\uff08\u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff09\uff0c\u7136\u540e\u6309\u7167\u9700\u6c42\u8fdb\u5165\u5404\u4e2a\u6b21\u72b6\u6001\u3002Recovery \u5404\u4e2a\u6b21\u72b6\u6001\u5982\u539f\u6587 573 \u9875\u56fe 14-27 \u6240\u793a\uff0c\u672c\u8282\u540e\u7eed\u5c06\u8be6\u7ec6\u8ba8\u8bba\u5404\u4e2a\u6b21\u72b6\u6001\u4e2d\u90fd\u8fdb\u884c\u4e86\u54ea\u4e9b\u64cd\u4f5c\u3002</p> <p></p> <p>\u56fe 14-27 Recovery \u72b6\u6001\u673a</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1483-recovery","title":"14.8.3 Recovery \u72b6\u6001\u5404\u6b21\u72b6\u6001\u8be6\u7ec6\u8ba8\u8bba","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#recoveryrcvrlock","title":"Recovery.RcvrLock \u72b6\u6001\u671f\u95f4","text":"<p>\u5728 Recovery.RcvrLock \u72b6\u6001\u671f\u95f4\uff0c\u65e0\u8bba\u94fe\u8def\u7684\u901f\u7387\u4e3a\u591a\u5c11\uff0c\u53d1\u9001\u65b9\u603b\u662f\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u53d1\u9001 TS1 \u5e8f\u5217\uff0cTS1 \u5e8f\u5217\u4e2d\u7684\u94fe\u8def\u4ee5\u53ca\u901a\u9053\u7f16\u53f7\uff0c\u548c\u5728 Configuration \u72b6\u6001\u671f\u95f4\u8bbe\u7f6e\u7684\u6570\u503c\u76f8\u540c\u3002\u5982\u679c\u8fdb\u5165 Recovery \u72b6\u6001\u7684\u76ee\u7684\u662f\u5207\u6362\u901f\u7387\uff0c\u90a3\u4e48\u53d1\u8d77\u65b9\u53d1\u9001\u7684 TS1 \u5e8f\u5217\u4e2d\u7684\uff0c\u6570\u636e\u901f\u7387\u8bc6\u522b\u7b26\u53f7\uff08Data Rate Identifier Symbol\uff09\u4e2d\u7684 speed_change \u6bd4\u7279\u4f1a\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c\u5e76\u5c06\u5185\u90e8\u53d8\u91cf directed_speed_change \u4e5f\u8bbe\u7f6e\u4e3a 1\u3002\u5728\u5bf9\u7aef\u8bbe\u5907\u63a5\u6536\u5230 speed_change \u6bd4\u7279\u4e3a 1 \u7684 TS1 \u5e8f\u5217\u540e\uff0c\u4e5f\u4f1a\u540c\u6837\u5c06\u5176\u5185\u90e8\u53d8\u91cf directed_speed_change \u8bbe\u7f6e\u4e3a 1\u3002\u6b64\u5916\uff0c\u4e00\u65e6\u8fdb\u5165 Recovery.RcvrLock \u72b6\u6001\u540e\uff0c\u53e6\u4e00\u4e2a\u5185\u90e8\u53d8\u91cf successful_speed_negotiation \u4f1a\u6e05\u9664\uff0c\u8bbe\u7f6e\u4e3a 0\u3002</p> <p>\u5728 Recovery.RcvrLock \u72b6\u6001\u4e2d\uff0c\u9762\u5411\u4e0a\u6e38\u7aef\u53e3\uff08USP\uff09\u53ef\u4ee5\u6307\u5b9a\u9762\u5411\u4e0b\u6e38\u7aef\u53e3\uff08DSP\uff09\u5728 5GT/s \u901f\u7387\u4e0b\u4f7f\u7528\u7684\u53bb\u52a0\u91cd\u7b49\u7ea7\u7cfb\u6570\uff08de\u2010emphasis level\uff09\u3002USP \u901a\u8fc7 TS1 \u5e8f\u5217\u4e2d\u7684\u53ef\u9009\u53bb\u52a0\u91cd\u7b49\u7ea7\uff08Selectable  de\u2010emphasis leve\uff09\u6bd4\u7279\uff0c\u6765\u6307\u5b9a DSP \u7684\u6570\u503c\u8bbe\u7f6e\u3002\u4f46\u662f DSP \u6709\u53ef\u80fd\u4f1a\u56e0\u4e3a\u94fe\u8def\u4e0a\u7684\u6bd4\u7279\u9519\u8bef\uff0c\u65e0\u6cd5\u63a5\u6536\u5230 USP \u53d1\u9001\u7684\u8fd9\u4e00\u4fe1\u606f\uff0c\u6240\u4ee5 USP \u53ef\u4ee5\u5728\u56e0\u4e3a\u901f\u7387\u5207\u6362\u8fdb\u5165  Recovery \u72b6\u6001\u540e\uff0c\u518d\u6b21\u6307\u5b9a DSP \u7684\u53bb\u52a0\u91cd\u7b49\u7ea7\u3002\u5982\u679c DSP \u6253\u7b97\u91c7\u7528 USP \u6240\u8981\u6c42\u7684\u7684\u6570\u503c\uff0c\u90a3\u4e48 DSP \u5fc5\u987b\u5728 Recovery.RcvrLock \u72b6\u6001\u4e2d\u8bb0\u5f55\u63a5\u6536\u5230\u7684\u53ef\u9009\u53bb\u52a0\u91cd\u7b49\u7ea7\u6bd4\u7279\u7684\u6570\u503c\u3002</p> <p>\u5728\u8fdb\u5165 Recovery.RcvrLock \u72b6\u6001\u65f6\uff0cTS1 \u5e8f\u5217\u63a5\u6536\u65b9\u4e5f\u53ef\u4ee5\u88ab\u6307\u5b9a\u65b0\u7684\u53d1\u9001\u7535\u538b\u6570\u503c\u3002\u63a5\u6536\u65b9\u4f1a\u5728\u8fdb\u5165\u8be5\u72b6\u6001\u65f6\u91c7\u6837\u4e00\u6b21\u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u56682\uff08 Link Control 2 register\uff09\u4e2d\u7684 Transmit Margin \u6bd4\u7279\uff0c\u5e76\u4e14\u4fdd\u6301\u8be5\u6570\u503c\u6709\u6548\uff0c\u76f4\u5230\u4e0b\u4e00\u6b21\u4ece  L0, L0s, \u6216\u8005 L1 \u8fdb\u5165\u5230 Recovery \u72b6\u6001\uff0c\u91c7\u6837\u5230\u65b0\u7684\u6570\u503c\u4e3a\u6b62\u3002</p> <p>DSP \u5982\u679c\u60f3\u5c06\u901f\u7387\u5207\u6362\u5230 8GT/s \u5e76\u4e14\u91cd\u65b0\u8fdb\u884c\u5747\u8861\u7684\u8bdd\uff0c\u9700\u8981\u53d1\u9001  speed_change \u6bd4\u7279\u7f6e\u4e3a 1\uff0c\u5e76\u4e14\u901f\u7387\u58f0\u660e\u4e3a 8GT/s \u7684 EQ TS1 \u5e8f\u5217\u3002\u5982\u679c\u4e00\u4e2a USP \u8fde\u7eed\u63a5\u6536\u5230 8 \u4e2a  speed_change \u6bd4\u7279\u7f6e\u4e3a 1\uff0c\u5e76\u4e14\u901f\u7387\u58f0\u660e\u652f\u6301 8GT/s \u7684EQ TS1 \u6216\u8005 EQ TS2 \u5e8f\u5217\u540e\uff0cUSP \u4e5f\u4f1a\u5ba3\u544a\u652f\u6301\u4f7f\u7528 8GT/s \u901f\u7387\uff0c\u9664\u975e USP \u786e\u8ba4\u5728\u8be5\u901f\u7387\u4e0b\u5b58\u5728\u53ef\u9760\u6027\u95ee\u9898\uff0c\u5e76\u4e14\u65e0\u6cd5\u9760\u5747\u8861\u89e3\u51b3\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4efb\u610f\u7aef\u53e3\u53ef\u4ee5\u5728\u8fdb\u5165  Recovery \u72b6\u6001\u65f6\uff0c\u6539\u53d8\u5176\u901a\u544a\u652f\u6301\u7684\u901f\u7387\uff0c\u4f46\u9700\u8981\u786e\u4fdd\u81ea\u8eab\u53ef\u4ee5\u7a33\u5b9a\u53ef\u9760\u5730\u652f\u6301\u8fd9\u4e00\u901f\u7387\u3002\u9664\u4e86\u4e0a\u8ff0\u8fd9\u79cd\u60c5\u5f62\u5916\uff0c\u7aef\u53e3\u5728 Recovery.RcvrLock \u72b6\u6001\uff0cRecovery.RcvrCfg \u72b6\u6001\u4ee5\u53ca Recovery.Equalization \u72b6\u6001\u4e2d\uff0c\u4e0d\u5f97\u6539\u53d8\u81ea\u5df1\u901a\u544a\u7684\u652f\u6301\u901f\u7387\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#recoveryrcvrcfg","title":"\u8f6c\u79fb\u81f3 Recovery.RcvrCfg \u72b6\u6001","text":"<p>Recovery.RcvrLock \u72b6\u6001\u6ee1\u8db3\u4e0b\u8ff0\u6761\u4ef6\u540e\uff0c\u8f6c\u79fb\u81f3 Recovery.RcvrCfg \u72b6\u6001\u3002\u5982\u679c\u53cc\u65b9\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS1 \u6216\u8005 TS2 \u5e8f\u5217\uff0c\u5176\u4e2d\u94fe\u8def\u4e0e\u901a\u9053\u7f16\u53f7\u4e0e\u53d1\u9001\u7684\u6570\u503c\u4e00\u81f4\uff0c\u5e76\u4e14\u5e8f\u5217\u4e2d\u7684 speed_change \u6bd4\u7279\u4e0e\u672c\u5730\u53d8\u91cf directed_speed_change \u4e00\u81f4\uff0c\u5e76\u4e14 EC \u57df\u6570\u503c\u4e3a 00b \uff088 GT/s \u901f\u7387\u4e0b\uff0c\u8bd1\u6ce8\uff1a\u5373\u65e0\u9700\u8fdb\u884c\u5747\u8861\u8bad\u7ec3\uff09\u3002</p> <ul> <li>\u5982\u679c\u8bbe\u7f6e\u4e86 Extended Synch \u6bd4\u7279\uff0c\u90a3\u4e48\u5728\u8fdb\u5165 Recovery.RcvrCfg \u72b6\u6001\u4e4b\u524d\uff0c\u5fc5\u987b\u6700\u5c11\u53d1\u9001 1024 \u4e2a\u8fde\u7eed\u7684 TS1 \u5e8f\u5217\u3002</li> <li>\u5982\u679c\u539f\u5148\u662f\u4ece Recovery.Equalization \u72b6\u6001\u8fdb\u5165\u5f53\u524d\u6b21\u72b6\u6001\uff0c\u90a3\u4e48 USP \u9700\u8981\u6bd4\u8f83\u6240\u6709\u901a\u9053\u4e0a\u63a5\u6536\u7684\u5747\u8861\u53c2\u6570\u6216\u8005 preset\uff0c\u5c06\u4ed6\u4eec\u548c\u5747\u8861\u7684 Phase2 \u4e2d\u6240\u63a5\u6536\u7684\u6700\u7ec8\u53c2\u6570\u96c6\uff08final set of coefficient\uff09\u6216\u8005 preset \u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679c\u4ed6\u4eec\u6570\u503c\u4e0d\u4e00\u81f4\uff0c\u90a3\u4e48 USP \u4f1a\u5c06\u5176\u53d1\u9001\u7684 TS2 \u5e8f\u5217\u4e2d\u7684  Request Equalization \u6bd4\u7279\u8bbe\u7f6e\u4e3a 1\u3002</li> </ul>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#recoveryequalization","title":"\u8f6c\u79fb\u81f3 Recovery.Equalization \u72b6\u6001","text":"<p>\u5f53\u6570\u636e\u901f\u7387\u4e3a 8 GT/s \u65f6\uff0c\u6570\u636e\u901a\u9053\u5fc5\u987b\u91c7\u53d6\u5408\u9002\u7684\u5747\u8861\u53c2\u6570\uff0c\u4ee5\u83b7\u5f97\u826f\u597d\u7684\u4fe1\u53f7\u5b8c\u6574\u6027\u3002\u672c\u8282\u7684\u5185\u5bb9\u5e76\u4e0d\u9002\u7528\u4e8e\u66f4\u4f4e\u901f\u7684\u901f\u7387\u3002\u5bf9\u4e8e\u8fd0\u884c\u5728 8GT/s \u901f\u7387\u7684\u94fe\u8def\u6765\u8bf4\uff0c\u4ed6\u4eec\u5e76\u4e0d\u662f\u6bcf\u6b21\u8fdb\u5165 Recovery  \u72b6\u6001\u65f6\uff0c\u90fd\u9700\u8981\u7ecf\u8fc7 Recovery.Equalization \u6b21\u72b6\u6001\u3002\u94fe\u8def\u53ea\u4f1a\u5728\u6ee1\u8db3\u4e0b\u8ff0\u60c5\u51b5\u65f6\uff0c\u624d\u4f1a\u8fdb\u5165 Recovery.Equalization \u72b6\u6001\uff1a</p> <p>\u5982\u679c\u5185\u90e8\u53d8\u91cf start_equalization_w_preset \u8bbe\u7f6e\u4e3a 1\uff0c\u90a3\u4e48\uff1a</p> <p>a\uff09USP \u9700\u8981\u5728\u8f6c\u4e3a 8.0 GT/s \u901f\u7387\u4e4b\u524d\uff0c\u91c7\u6837\u5176\u63a5\u6536\u7684\u8fde\u7eed 8 \u4e2a TS2 \u4e2d\u7684 preset \u6570\u503c\u3002USP \u5fc5\u987b\u91c7\u7528\u5176\u4e2d\u7684\u53d1\u9001\u7aef preset\uff0c\u53ef\u4ee5\u9009\u62e9\u662f\u5426\u91c7\u7528\u5176\u4e2d\u7684\u63a5\u6536\u7aef preset\u3002</p> <p>b\uff09DSP \u8fdb\u5165 8.0 GT/s \u901f\u7387\u540e\uff0c\u5fc5\u987b\u91c7\u7528\u5176\u901a\u9053\u5747\u8861\u63a7\u5236\u5bc4\u5b58\u5668\uff08 Lane Equalization Control register \uff09\u4e2d\u7684\u53d1\u9001\u7aef preset\uff0c\u53ef\u4ee5\u9009\u62e9\u662f\u5426\u91c7\u7528\u5176\u4e2d\u7684\u63a5\u6536\u7aef preset\u3002</p> <p>\u5426\u5219\uff08\u5373\u8be5\u53d8\u91cf\u4e0d\u4e3a 1\uff09\uff0c\u53d1\u9001\u7aef\u5fc5\u987b\u91c7\u7528\u5728\u4e0a\u4e00\u6b21\u5747\u8861\u8fc7\u7a0b\u4e2d\u534f\u5546\u4e00\u81f4\u7684\u53c2\u6570\uff08coefficient\uff09\u8bbe\u7f6e\u3002</p> <p>a\uff09\u5982\u679c USP \u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS1 \u5e8f\u5217\uff0c\u5176\u4e2d\u94fe\u8def\u4e0e\u901a\u9053\u7f16\u53f7\u4e0e\u53d1\u9001\u7684\u6570\u503c\u4e00\u81f4\uff0c\u5e76\u4e14\u5e8f\u5217\u4e2d\u7684 speed_change \u6bd4\u7279\u4e3a 0\uff0c\u4f46\u662f EC \u57df\u6570\u503c\u4e0d\u4e3a\u96f6\u65f6\uff0c\u4e0b\u4e00\u4e2a\u72b6\u6001\u4e3a Recovery.Equalization\u3002\u56e0\u4e3a\u63a5\u6536\u5230\u4e0a\u8ff0 TS1 \u5e8f\u5217\u8868\u793a DSP \u5e0c\u671b\u91cd\u65b0\u8fdb\u884c\u5747\u8861\u4e2d\u7684\u90e8\u5206\u6d41\u7a0b\u3002\u534f\u8bae\u4e2d\u63d0\u5230\uff0cDSP \u53ef\u4ee5\u5728\u4e0a\u5c42\u8f6f\u4ef6\u8981\u6c42\uff0c\u6216\u8005\u5176\u4ed6\u5177\u4f53\u5b9e\u73b0\u51b3\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u53d1\u8d77\u8be5\u8bf7\u6c42\u3002\u5f53\u7136\uff0cDSP \u5fc5\u987b\u4fdd\u8bc1\u8fdb\u884c\u8be5\u64cd\u4f5c\u7684\u65f6\u95f4\uff0c\u4e0d\u80fd\u5bfc\u81f4\u8be5\u4f20\u8f93\u8d85\u65f6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cDSP \u9700\u8981\u4fdd\u8bc1\u53d1\u8d77\u8be5\u8bf7\u6c42\u524d\uff0c\u94fe\u8def\u4e0a\u6ca1\u6709\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u4f20\u8f93\u3002</p> <p>b\uff09\u5728\u4e0a\u5c42\u534f\u8bae\u8981\u6c42\u540e\uff0cDSP \u5373\u8fdb\u5165 Recovery.Equalization \u72b6\u6001\uff0c\u4f46\u662f\u4e0d\u80fd\u7531 Configuration.Idle \u6216\u8005 Recovery.Idle \u72b6\u6001\u76f4\u63a5\u8fdb\u5165 Recovery.Equalization \u72b6\u6001\u3002\uff08\u8bd1\u6ce8\uff1a\u9700\u8981\u901a\u8fc7 Recovery.RcvrLock \u6b21\u72b6\u6001\u8fdb\u5165\uff09\u534f\u8bae\u89c4\u5b9a\u5728 DSP \u901a\u8fc7\u53d1\u9001 EC \u4e0d\u4e3a 0 \u7684 TS1 \u8981\u6c42\u5bf9\u7aef\u91cd\u65b0\u8fdb\u884c\u5747\u8861\u8fc7\u7a0b\u4e4b\u524d\uff0c\u4e0d\u80fd\u53d1\u9001\u8d85\u8fc7\u4e24\u4e2a EC=00b \u7684 TS1 \u5e8f\u5217\u3002</p> <p>\u5982\u679c\u4e0a\u8ff0\u60c5\u51b5\u90fd\u6ca1\u6709\u6ee1\u8db3\uff0c\u5728 24ms \u8d85\u65f6\u540e\uff1a</p> <p>\u8f6c\u79fb\u81f3 Recovery.RcvrCfg \u72b6\u6001</p> <p>\u5982\u679c\u540c\u65f6\u6ee1\u8db3\u4e0b\u8ff0\u4e24\u4e2a\u6761\u4ef6\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u4e3a Recovery.RcvrCfg \u72b6\u6001\uff1a</p> <ul> <li>\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS1 \u6216\u8005 TS2 \u5e8f\u5217\uff0c\u5176\u4e2d\u94fe\u8def\u4e0e\u901a\u9053\u7f16\u53f7\u4e0e\u53d1\u9001\u7684\u6570\u503c\u4e00\u81f4\uff0c\u5e76\u4e14\u5e8f\u5217\u4e2d\u7684 speed_change \u6bd4\u7279\u4e3a 1\u3002</li> <li>\u5f53\u524d\u901f\u7387\u9ad8\u4e8e 2.5 GT/s\uff0c\u6216\u8005 TS1/TS2 \u4e2d\u8868\u793a\u8fd8\u652f\u6301\u81f3\u5c11\u4e00\u79cd\u66f4\u9ad8\u7684\u901f\u7387\u8bbe\u7f6e\u3002</li> </ul> <p>\u8f6c\u79fb\u81f3 Recovery.Speed \u72b6\u6001</p> <p>\u5982\u679c\u6ee1\u8db3\u4e0b\u8ff0\u4e24\u4e2a\u6761\u4ef6\u4e2d\u7684\u4e00\u4e2a\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u4e3a Recovery.Speed \u72b6\u6001\uff1a</p> <ul> <li>\u5982\u679c\u5f53\u524d\u901f\u7387\u8bbe\u7f6e\u9ad8\u4e8e 2.5 GT/s\uff0c\u4f46\u662f\u81ea\u4ece\u8fdb\u5165 Recovery \u72b6\u6001\u540e\uff0c\u4ece\u6765\u6ca1\u80fd\u5728\u8be5\u901f\u7387\u4e0b\u6b63\u5e38\u5de5\u4f5c\u8fc7\uff0c\uff08\u53d8\u91cf changed_speed_recovery \u88ab\u6e05\u9664\u4e3a 0 \u63ed\u793a\u4e86\u8fd9\u79cd\u73b0\u8c61\uff09\u3002\u6b64\u65f6\uff0c\u5f85\u79bb\u5f00 Recovery.Speed \u72b6\u6001\u540e\uff0c\u901f\u7387\u4f1a\u91cd\u65b0\u964d\u4f4e\u4e3a 2.5 GT/s\u3002</li> <li>\u5982\u679c\u53d8\u91cf changed_speed_recovery \u88ab\u8bbe\u7f6e\u4e3a 1\uff0c\u8868\u793a\u67d0\u4e2a\u9ad8\u4e8e 2.5 GT/s \u7684\u901f\u7387\u5df2\u7ecf\u80fd\u591f\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f46\u662f\u5728\u5207\u6362\u5230\u65b0\u7684\u534f\u5546\u901f\u7387\u540e\uff0c\u94fe\u8def\u4e0d\u80fd\u5de5\u4f5c\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u901f\u7387\u4f1a\u88ab\u6062\u590d\u4e3a\u7531 L0 \u6216\u8005 L1 \u8fdb\u5165 Recovery \u72b6\u6001\u524d\u7684\u6570\u503c\u3002</li> </ul> <p>\u8f6c\u79fb\u81f3 Configuration \u72b6\u6001</p> <p>\u5982\u679c\u6ca1\u6709\u53d1\u8d77\u901f\u7387\u6539\u53d8\u8bf7\u6c42\uff0c\uff08\u5373 directed_speed_change \u53d8\u91cf\u4e3a 0\uff0c\u5e76\u4e14 TS\u00bd \u4e2d\u7684 speed_change \u6bd4\u7279\u4e5f\u4e3a 0\uff09\uff0c\u6216\u8005\u53cc\u65b9\u534f\u5546\u540e\u53d1\u73b0\u5f7c\u6b64\u540c\u65f6\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u53ea\u662f 2.5 GT/s\uff0c\u6b64\u65f6 LTSSM \u4f1a\u8f6c\u79fb\u81f3 Configuration \u72b6\u6001\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c\u4e0a\u8ff0\u6761\u4ef6\u90fd\u6ca1\u80fd\u6ee1\u8db3\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u79fb\u81f3 Detect \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1484","title":"14.8.4 \u4e00\u6b21\u901f\u7387\u53d8\u6362\u793a\u4f8b","text":"<p>\u5728 Recovery \u72b6\u6001\u7684\u7ae0\u8282\u4e2d\uff0c\u534f\u8bae\u63d0\u4f9b\u4e86\u4e00\u4e2a\u901f\u7387\u53d8\u6362\u8fc7\u7a0b\u7684\u793a\u4f8b\u3002\u793a\u4f8b\u4e2d\u4e24\u4e2a\u94fe\u8def\u4e0a\u7684\u4f19\u4f34\uff08\u8bbe\u5907 A \u548c\u8bbe\u5907 B\uff09\u540c\u65f6\u4ece\u590d\u4f4d\u72b6\u6001\u4e2d\u91ca\u653e\uff0c\u5e76\u4e14\u90fd\u652f\u6301 5.0 GT/s \u548c 8.0 GT/s \u901f\u7387\u3002</p> <p>\u9996\u5148\uff0c\u94fe\u8def\u4f1a\u4ee5  2.5 GT/s \u7684\u901f\u7387\u81ea\u52a8\u8bad\u7ec3\u4e3a L0 \u72b6\u6001\u3002\uff08\u8fd9\u4e00\u884c\u4e3a\u5f88\u5927\u6982\u7387\u4f1a\u5728\u540e\u7eed\u7684\u534f\u8bae\u7248\u672c\u4e2d\u4fdd\u7559\uff0c\u56e0\u4e3a\u540e\u7eed\u534f\u8bae\u5c06\u63d0\u4f9b\u548c\u5148\u524d\u8bbe\u5907\u7684\u540e\u5411\u517c\u5bb9\u6027\u3002\uff09</p> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c\u4e24\u4e2a\u8bbe\u5907\u90fd\u652f\u6301\u66f4\u9ad8\u7684\u901f\u7387\uff0c\u5e76\u901a\u8fc7\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u53d1\u9001\u7684 TS \u6709\u5e8f\u96c6\u4e2d\u7684\u901f\u7387\u6807\u8bc6\u7b26\u5b57\u6bb5\u901a\u77e5\u4e86\u5bf9\u65b9\u8fd9\u4e00\u60c5\u51b5\u3002\u4e24\u8005\u90fd\u660e\u767d\u5bf9\u65b9\u652f\u6301\u66f4\u9ad8\u901f\u7387\uff0c\u5e76\u4e14\u5b83\u4eec\u5176\u4e2d\u7684\u4e00\u4e2a\uff08\u6bd4\u5982\u8bbe\u5907 A\uff09\u4f1a\u9996\u5148\u5c06\u5185\u90e8\u53d8\u91cf directed_speed_change \u8bbe\u7f6e\u4e3a 1\u3002\u6b64\u65f6\uff0c\u8bbe\u5907 A \u4f1a\u8fdb\u5165 Recovery.RcvrLock \u72b6\u6001\u5e76\u4e14\u53d1\u9001 speed_change \u6bd4\u7279\u7f6e\u4e3a 1 \u7684 TS1 \u5e8f\u5217\u3002\u5982\u679c\u76ee\u6807\u901f\u7387\u4e3a 8.0 GT/s\uff0c\u4e14\u94fe\u8def\u4e4b\u524d\u4ece\u672a\u8fbe\u5230\u8fc7\u8be5\u901f\u7387\uff0c\u90a3\u4e48\u8bbe\u5907\u95f4\u4f1a\u4ea4\u6362 EQ TS1 \u6765\u4f20\u8fbe TX \u5747\u8861\u4f7f\u7528\u7684 preset\uff0c\u800c\u4e0d\u662f\u4ea4\u6362\u666e\u901a\u7684 TS1\u3002</p> <p>\u8bbe\u5907 B \u5728\u63a5\u6536\u5230 TS1 \u5e8f\u5217\u540e\uff0c\u4e5f\u8f6c\u79fb\u5230 Recovery.RcvrLock \u72b6\u6001\u3002\u5f53\u5176\u8bc6\u522b\u5230\u8fde\u7eed 8 \u4e2a\u63a5\u6536 TS1 \u4e2d\u7684 speed_change \u6bd4\u7279\u90fd\u4e3a 1 \u65f6\uff0c\u8bbe\u5907 B \u901a\u8fc7\u5c06\u5176\u53d1\u9001 TS1 \u4e2d\u7684 speed_change \u6bd4\u7279\u4e5f\u7f6e\u4e3a 1 \u4f5c\u4e3a\u56de\u5e94\uff0c\u5e76\u8fdb\u5165 Recovery.Speed \u72b6\u6001\u3002\u8bbe\u5907 A \u7b49\u5f85\u8bbe\u5907 B \u505a\u51fa\u56de\u5e94\u540e\uff0c\u5f53\u5176\u4e5f\u63a5\u6536\u5230 8 \u4e2a speed_change \u6bd4\u7279\u7f6e\u4e3a 1 \u7684 TS1 \u540e\uff0c\u8bbe\u5907 A \u7ecf\u7531 Recovery.RcvrCfg \u72b6\u6001\u8fdb\u5165 Recovery.Speed \u72b6\u6001\u3002\u5728 Recovery.Speed \u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u7aef\u88ab\u7f6e\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u4e2d\uff0c\u94fe\u8def\u901f\u7387\u88ab\u8bbe\u7f6e\u4e3a\u53cc\u65b9\u90fd\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\uff0c\u53d8\u91cf directed_speed_change \u7684\u503c\u968f\u5373\u88ab\u6e05\u9664\u4e3a\u96f6\u3002</p> <p>\u5728\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u53cc\u65b9\u91cd\u8fd4 Recovery.RcvrLock \u72b6\u6001\uff0c\u4ee5\u65b0\u901f\u7387\u91cd\u65b0\u6fc0\u6d3b\u53d1\u9001\u7aef\uff08\u672c\u4f8b\u4e2d\u662f 8 GT/s\uff09\u3002\u6b64\u540e\uff0c\u53cc\u65b9\u91cd\u65b0\u4ea4\u6362 TS1\uff0c\u6b64\u65f6 TS1 \u4e2d\u7684 speed_change \u6bd4\u7279\u6570\u503c\u5df2\u7ecf\u88ab\u6e05\u9664\u4e3a 0b\u3002\u5982\u679c\u94fe\u8def\u5728\u65b0\u901f\u7387\u4e0b\u5de5\u4f5c\u6b63\u5e38\uff0c\u90a3\u4e48\u53cc\u65b9\u4f1a\u7ecf\u7531 Recovery.RcvrCfg \u72b6\u6001\u8fd4\u56de L0 \u72b6\u6001\u3002\u7136\u800c\uff0c\u5982\u679c\u8bbe\u5907 B \u51fa\u73b0\u4e86\u4e00\u4e9b\u72b6\u51b5\uff0c\u6bd4\u5982\u65e0\u6cd5\u5b9e\u73b0\u6bd4\u7279\u9501\u5b9a\uff0c\u8fd9\u4f1a\u9020\u6210\u8be5\u6b21\u72b6\u6001\u4e2d\u7684\u903b\u8f91\u8d85\u65f6\uff0c\u5e76\u4e14\u8fd4\u56de Recovery.Speed \u72b6\u6001\u3002\u6b64\u65f6\uff0c\u8bbe\u5907 A \u53ef\u80fd\u5df2\u7ecf\u6b63\u5e38\u8fdb\u5165\u4e86 Recovery.RcvrCfg \u72b6\u6001\uff0c\u4e0d\u8fc7\u5f53\u5176\u5728\u94fe\u8def\u4e0a\u68c0\u6d4b\u5230\u5bf9\u7aef\u91cd\u65b0\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u8fd9\u8868\u793a\u5bf9\u7aef\u91cd\u65b0\u56de\u5230\u4e86 Recovery.Speed \u72b6\u6001\uff0c\u8bbe\u5907 A \u4e5f\u4f1a\u8fd4\u56de\u8be5\u72b6\u6001\u3002\u91cd\u56de Recovery.Speed \u72b6\u6001\u4f7f\u53cc\u65b9\u8bbe\u5907\u95f4\u6062\u590d\u5230\u8fdb\u5165 Recovery \u72b6\u6001\u524d\u7684\u901f\u7387\uff08\u672c\u4f8b\u4e2d\u662f 2.5 GT/s\uff09\uff0c\u5e76\u8fd4\u56de Recovery.RcvrLock \u72b6\u6001\u3002</p> <p>\u9762\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u8bbe\u5907 A \u53ef\u80fd\u91cd\u65b0\u5c06\u5185\u90e8\u53d8\u91cf directed_speed_change \u8bbe\u7f6e\u4e3a 1\uff0c\u5e76\u4e14\u7b2c\u4e8c\u6b21\u5c1d\u8bd5\u901f\u7387\u53d8\u6362\u6d41\u7a0b\u3002\u5982\u679c\u7b2c\u4e8c\u6b21\u901f\u7387\u5207\u6362\u4ecd\u7136\u5931\u8d25\uff0c\u8bbe\u5907 A \u53ef\u80fd\u4f1a\u9009\u62e9\u5c06 8.0 GT/s \u79fb\u51fa\u5176\u901a\u544a\u7684\u652f\u6301\u901f\u7387\u5217\u8868\uff0c\u5e76\u4ee5\u65b0\u7684\u652f\u6301\u901f\u7387\u5217\u8868\u91cd\u65b0\u5f00\u59cb\u901f\u7387\u5207\u6362\u3002\u6b64\u65f6\uff0c\u53cc\u65b9\u5171\u540c\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u53d8\u6210\u4e86 5.0 GT/s\u3002\u5982\u679c\u4e4b\u540e\u8fd8\u662f\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u90a3\u4e48\u8bbe\u5907 A \u53ef\u80fd\u4f1a\u653e\u5f03\u5411\u66f4\u9ad8\u901f\u7387\u7684\u5207\u6362\u3002\u8bbe\u5907\u5982\u4f55\u4ee5\u53ca\u4f55\u65f6\u9009\u62e9\u66f4\u65b0\u5176\u901a\u544a\u7684\u652f\u6301\u901f\u7387\u5217\u8868\uff0c\u4ee5\u53ca\u653e\u5f03\u5207\u6362\u5230\u66f4\u9ad8\u901f\u7387\u7684\u5c1d\u8bd5\uff0c\u534f\u8bae\u4e2d\u90fd\u6ca1\u6709\u5177\u4f53\u5b9a\u4e49\uff0c\u90fd\u53d6\u51b3\u4e8e\u5177\u4f53\u7684\u5b9e\u73b0\u7ec6\u8282\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1485","title":"14.8.5 \u94fe\u8def\u5747\u8861\u6982\u89c8","text":"<p>\u672c\u8282\u662f\u5bf9\u94fe\u8def\u5747\u8861\u8fc7\u7a0b\u4e00\u4e2a\u6982\u62ec\u6027\u7684\u4ecb\u7ecd\uff0c\u5982\u679c\u8bfb\u8005\u5bf9\u5747\u8861\u8fc7\u7a0b\u4e2d\u7684\u72b6\u6001\u673a\u5177\u4f53\u884c\u4e3a\u611f\u5174\u8da3\u7684\u8bdd\uff0c\u53ef\u4ee5\u9605\u8bfb\u672c\u8282\u4ee5\u4e86\u89e3\u8fd9\u65b9\u9762\u7684\u77e5\u8bc6\u3002</p> <p>\u94fe\u8def\u7684\u901f\u7387\u8d8a\u9ad8\uff0c\u76f8\u6bd4\u4f4e\u901f\u7387\u4f1a\u53d7\u5230\u66f4\u591a\u7684\u4fe1\u53f7\u5e72\u6270\u3002\u4e3a\u4e86\u8865\u507f\u8fd9\u65b9\u9762\u7684\u4fe1\u53f7\u8d28\u91cf\u635f\u5931\uff0c\u5e76\u4e14\u6700\u5927\u7a0b\u5ea6\u4e0a\u964d\u4f4e\u7cfb\u7edf\u8bbe\u8ba1\u7684\u6210\u672c\u548c\u7cbe\u529b\uff0cPCIe 3.0 \u534f\u8bae\u589e\u52a0\u4e86\u5bf9\u53d1\u9001\u7aef\u5747\u8861\u7684\u9700\u6c42\u3002\u4e0e\u4f4e\u901f\u7387\u91c7\u53d6\u7684\u56fa\u5b9a\u53bb\u52a0\u91cd\u7cfb\u6570\u65b9\u6cd5\u4e0d\u540c\uff0c\u53bb\u52a0\u91cd\u672c\u8eab\u662f\u53d1\u9001\u5747\u8861\u7684\u7b80\u5316\u7248\u672c\uff0c\u53d1\u9001\u5747\u8861\u91c7\u53d6\u4e86\u4e00\u79cd\u901a\u8fc7\u4e3b\u52a8\u63e1\u624b\u6d41\u7a0b\uff0c\u5c06\u53d1\u9001\u7aef\u4e0e\u5f53\u524d\u4fe1\u53f7\u5b9e\u9645\u4f20\u8f93\u73af\u5883\u76f8\u9002\u914d\u3002\u63e1\u624b\u65f6\uff0c\u63a5\u6536\u7aef\u6bcf\u4e2a\u901a\u9053\u4e0a\u90fd\u4f1a\u8bc4\u4f30\u8f93\u5165\u4fe1\u53f7\u7684\u8d28\u91cf\uff0c\u5e76\u6839\u636e\u4fe1\u53f7\u8d28\u91cf\uff0c\u5efa\u8bae\u94fe\u8def\u4f19\u4f34\u4e3a\u6ee1\u8db3\u4fe1\u53f7\u8d28\u91cf\u9700\u6c42\uff0c\u5e94\u5f53\u91c7\u53d6\u4f55\u79cd\u53d1\u9001\u5747\u8861\u53c2\u6570\u3002</p> <p>\u94fe\u8def\u5747\u8861\u8fc7\u7a0b\u5728\u9996\u6b21\u8fbe\u5230 8.0 GT/s \u901f\u7387\u540e\u8fdb\u884c\uff0c\u5c3d\u7ba1\u4e0d\u662f\u5f3a\u5236\u8981\u6c42\uff0c\u4f46\u662f\u534f\u8bae\u5f3a\u70c8\u5efa\u8bae\u7531\u786c\u4ef6\u81ea\u52a8\u5f00\u59cb\u5747\u8861\u8fc7\u7a0b\u3002\u5982\u679c\u4e0d\u652f\u6301\u786c\u4ef6\u81ea\u52a8\u5747\u8861\u673a\u5236\uff0c\u90a3\u4e48\u8be5\u8bbe\u8ba1\u5219\u5fc5\u987b\u914d\u5907\u57fa\u4e8e\u8f6f\u4ef6\u7684\u5747\u8861\u673a\u5236\u3002\u5982\u679c\u4efb\u610f\u4e00\u65b9\u7aef\u53e3\u65e0\u6cd5\u901a\u8fc7\u5747\u8861\u8fc7\u7a0b\u8fbe\u5230\u9884\u671f\u7684\u4fe1\u53f7\u8d28\u91cf\uff0cLTSSM \u4f1a\u8ba4\u4e3a\u8be5\u901f\u7387\u4e0b\u94fe\u8def\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fd4\u56de Recovery.Speed \u72b6\u6001\uff0c\u5e76\u8981\u6c42\u964d\u4f4e\u901f\u7387\u3002</p> <p>\u6574\u4e2a\u5747\u8861\u8fc7\u7a0b\u5305\u62ec\u56db\u4e2a\u9636\u6bb5\uff0c\u5c06\u5728\u4e0b\u6587\u4e2d\u8be6\u7ec6\u8ba8\u8bba\u3002\u4e00\u65e6\u901f\u7387\u6539\u53d8\u4e3a  8.0 GT/s \u540e\uff0c\u5f53\u524d\u6240\u5904\u7684\u5747\u8861\u9636\u6bb5\u7531\u63a5\u6536\u7684 TS1 \u4e2d\u7684 EC\uff08Equalization Control\uff09\u5b57\u6bb5\u901a\u77e5\uff0c\u5982\u56fe 14-28 \u6240\u793a\u3002</p> <p></p> <p>\u56fe 14-28  8.0 GT/s \u901f\u7387 TS\u00bd \u4e2d\u7684 EC \u5b57\u6bb5\u793a\u610f</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14851-phase-0","title":"14.8.5.1 Phase 0","text":"<p>\u5f53 DSP \u51c6\u5907\u597d\u4ece\u4f4e\u901f\u7387\u8f6c\u6362\u5230 8.0 GT/s \u65f6\uff0cDSP \u8fdb\u5165 Recovery.RcvrCfg \u6b21\u72b6\u6001\uff0c\u901a\u8fc7 EQ TS2 \u5411 USP \u53d1\u9001 Tx Presets \u4ee5\u53ca Rx Hints\uff0c\u5177\u4f53\u5e27\u683c\u5f0f\u5982\u539f\u6587 510 \u9875 \u201dTS1 \u548c TS2 \u6709\u5e8f\u96c6\u201c \u4e00\u8282\u6240\u8ff0\u3002\uff08\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u94fe\u8def\u5df2\u7ecf\u5de5\u4f5c\u5728 8.0 GT/s \u901f\u7387\uff0c\u90a3\u4e48\u5c06\u8df3\u8fc7\u8fd9\u4e2a\u6b65\u9aa4\u3002\uff09DSP \u53d1\u9001\u7684 Tx Preset \u503c\u6765\u81ea\u4e8e\u5747\u8861\u63a7\u5236\u5bc4\u5b58\u5668\uff08Equalization Control register\uff09\u7684\u5185\u5bb9\uff0c\u5982\u539f\u6587 579 \u9875\u56fe 14-29 \u6240\u793a\u3002\u6709\u4e00\u70b9\u503c\u5f97\u5f3a\u8c03\u7684\u662f\uff0c\u5404\u4e2a\u901a\u9053\u7684\u5747\u8861\u503c\u53ef\u80fd\u4e0d\u540c\u3002DSP \u4f1a\u5e94\u7528\u5bc4\u5b58\u5668\u4e2d\u7684 DSP \u7aef\u6570\u503c\u7ed9\u672c\u5730\u53d1\u9001\u7aef\u4f7f\u7528\uff0c\u5e76\u53ef\u9009\u7684\u5c06\u5728\u672c\u5730\u63a5\u6536\u7aef\u5e94\u7528 DSP \u6570\u503c\u3002\u5728\u8f6c\u4e3a\u66f4\u9ad8\u901f\u7387\u65f6\uff0cDSP \u4f1a\u5c06\u5bc4\u5b58\u5668\u4e2d\u7684 USP \u6570\u503c\u53d1\u9001\u7ed9 USP \u4f7f\u7528\u3002</p> <p></p> <p>\u56fe 14-29 \u5747\u8861\u63a7\u5236\u5bc4\u5b58\u5668\u793a\u610f\u56fe</p> <p></p> <p></p> <p>\u8868 14-8 Tx Preset \u7f16\u7801\u65b9\u5f0f</p> <p></p> <p>\u8868 14-9 Rx Preset Hint \u7f16\u7801\u65b9\u5f0f'</p> <p>\u4e00\u65e6\u8fdb\u5165\u901f\u7387\u5207\u6362\u6d41\u7a0b\uff0cDSP \u4f1a\u8fdb\u5165\u5747\u8861\u9636\u6bb5 1\uff08Phase 1\uff09\uff0c\u5e76\u4e14\u53d1\u9001 EC = 01b \u7684 TS1\uff0c\u63a5\u4e0b\u6765\u5c31\u7b49\u5f85 USP \u56de\u5e94 EC \u6570\u503c\u76f8\u540c\u7684 TS \u4e86\u3002</p> <p>\u540c\u65f6\uff0cUSP \u4ece\u5747\u8861\u9636\u6bb5 0 \u542f\u52a8\uff0c\u5982\u539f\u6587 581 \u9875\u56fe 14-30 \u6240\u793a\uff0c\u5f00\u59cb\u901a\u8fc7\u53d1\u9001 TS1 \u5e8f\u5217\u56de\u590d\u6b64\u524d\u4ece EQ TS\u00bd \u4e2d\u6536\u5230\u7684 preset \u6570\u503c\u3002\u5728\u652f\u6301\u8fd9\u4e9b\u6570\u503c\u7684\u524d\u63d0\u4e0b\uff0cUSP \u4f1a\u5c06\u5176\u5e94\u7528\u5230\u5230\u53d1\u9001\u7aef\uff0c\u5e76\u53ef\u9009\u5730\u5728\u63a5\u6536\u7aef\u5e94\u7528 Rx Hints\u3002USP \u88ab\u5141\u8bb8\u5728\u8bc4\u4f30\u8f93\u5165\u4fe1\u53f7\u8d28\u91cf\u4e4b\u524d\u7b49\u5f85 500ns\uff0c\u4e00\u65e6 USP \u80fd\u591f\u8bc6\u522b\u51fa\u4e24\u4e2a\u8fde\u7eed\u7684 TS1 \u5e8f\u5217\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8fdb\u5165\u4e0b\u4e00\u4e2a\u9636\u6bb5\u3002\u8fd9\u610f\u5473\u7740\u4fe1\u53f7\u8d28\u91cf\u6ee1\u8db3\u4e86\u6700\u4f4e\u7684 BER=10-4 \u9700\u6c42\uff08Bit Error Ratio\uff0c\u4e5f\u5c31\u662f\u6bcf 10000 \u4e2a\u6bd4\u7279\u7684\u9519\u8bef\u5c0f\u4e8e\u4e00\u4e2a\u6bd4\u7279\uff09\u3002\u63a5\u4e0b\u6765\uff0cUSP \u5c06\u5176\u53d1\u9001\u7684 TS1 \u4e2d\u7684 EC \u6570\u503c\u6539\u4e3a 01b\uff0c\u5e76\u8fdb\u5165 Phase 1\uff0c\u5c06\u63a7\u5236\u6743\u8f6c\u56de\u7ed9 DSP\u3002</p> <p></p> <p>\u56fe 14-30 \u5747\u8861\u8fc7\u7a0b\uff1a\u5f00\u59cb\u9636\u6bb5</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14852-phase-1","title":"14.8.5.2 Phase 1","text":"<p>DSP \u91c7\u53d6\u548c USP \u4e00\u6837\u7684\u63aa\u65bd\uff0c\u901a\u8fc7\u68c0\u6d4b\u80cc\u9760\u80cc\u8fde\u7eed\u7684 TS1 \u6765\u8fbe\u5230 10-4 \u7684\u8bef\u7801\u7387\u3002\u5728\u6b64\u671f\u95f4\uff0cDSP \u4e0e\u5bf9\u7aef\u4ea4\u6d41\u5176 Tx presets \u4ee5\u53ca FS (Full Swing)\u3001LF (Low Frequency) \u4ee5\u53ca Post\u2010cursor coefficient \u6570\u503c\uff0c\u5982\u539f\u6587 584 \u9875\u56fe 14-32 \u6240\u793a\u3002\u534f\u8bae\u989d\u5916\u6307\u5b9a\u4e86\u53c2\u6570 C-1/C0/C+1 \u5fc5\u987b\u6ee1\u8db3\u7684\u4e00\u4e9b\u89c4\u5219\uff0c\u5b83\u4eec\u5305\u62ec\uff1a</p> <ol> <li>|C\u20101| &lt;= \u4e0b\u53d6\u6574(FS/4)</li> <li>|C\u20101| + C0 + |C+1 | = FS</li> <li>C0 \u2010 |C\u20101| \u2010 |C+1 | &gt;= LF</li> </ol> <p>FS \u4ee3\u8868\u6700\u5927\u7535\u538b\uff0c\u800c LF \u5219\u53c2\u4e0e\u6700\u5c0f\u7535\u538b\u7684\u5b9a\u4e49\uff0c\u6700\u5c0f\u7535\u538b\u5b9a\u4e49\u4e3a LF/FS\u3002\u4e24\u8005\u901a\u77e5\u4e86\u63a5\u6536\u7aef\u5176\u53ef\u80fd\u63a5\u6536\u5230\u7684\u7535\u538b\u6570\u503c\uff0c\u5e76\u4f7f\u5f97\u53cc\u65b9\u80fd\u4ee5\u6574\u6570\u5f62\u5f0f\u4ea4\u6d41\u7535\u538b\u7684\u6570\u503c\uff0c\u800c\u8fd9\u4e9b\u6574\u6570\u5374\u53ef\u4ee5\u8868\u793a\u5c0f\u6570\u7cbe\u5ea6\u7684\u542b\u4e49\u3002</p> <p>\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5047\u8bbe\u91c7\u7528\u7684\u662f Preset P7 \u4e2d\u5b9a\u4e49\u7684\u53c2\u6570\u3002FS \u6570\u503c\u662f\u4e00\u4e2a\u76f8\u5bf9\u53c2\u8003\u503c\uff0c\u53ef\u4ee5\u4e3a\u5927\u4e8e 63 \u7684\u4efb\u4f55\u503c\uff0c\u4f46\u662f\u8fd9\u91cc\u4e3a\u4e86\u8ba1\u7b97\u7b80\u4fbf\uff0c\u5047\u5b9a FS \u6570\u503c\u4e3a 30\u3002\u5728 Preset P7 \u4e2d\uff0cC-1 \u7cfb\u6570\u4e3a -0.1\uff0c\u56e0\u6b64\u5728 TS1 \u4e2d\u4f20\u9012\u7684\u8868\u8fbe C-1 \u7684\u6570\u503c\u5373\u4e3a 3\uff0c\u56e0\u4e3a 3/30 = 0.1, \u5e76\u4e14\u9700\u8981\u6ce8\u610f\u8be5\u6570\u503c\u4f1a\u88ab\u89c6\u4e3a\u8d1f\u6570\u3002C+1 \u7cfb\u6570\u4e3a 0.2\uff0c\u6240\u4ee5\u8868\u8fbe\u8be5\u7cfb\u6570\u7684\u6570\u503c\u4e3a 6\uff0c\u56e0\u4e3a 6/30 = 0.2\uff0c\u5e76\u4e14\u4e5f\u88ab\u89c6\u4e3a\u8d1f\u6570\u3002C0 \u4e3a 0.7\uff0c\u6240\u4ee5\u4ee3\u8868\u8be5\u7cfb\u6570\u7684\u6570\u503c\u4e3a 21\uff0c\u56e0\u4e3a 21/30 = 0.7\u3002\u6700\u540e\uff0cLF \u4ee3\u8868\u8fd9\u6700\u5c0f\u53ef\u80fd\u7684\u7535\u538b\u6bd4\u4f8b\uff08\u6700\u5c0f\u7535\u538b\u4e0e\u6700\u5927\u7535\u538b\u7684\u6bd4\u4f8b\uff09\uff0c\u5728 Preset 7 \u4e2d\u8be5\u6bd4\u4f8b\u4e3a 0.4\uff0c\u56e0\u6b64 LF \u7684\u6570\u503c\u4e3a 12\uff0c\u56e0\u4e3a 12/30 = 0.4\u3002</p> <p>\u6839\u636e\u4e0a\u8ff0\u8ba1\u7b97\u7ed3\u679c\uff0c\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u68c0\u67e5\u4e00\u4e0b\u4e0a\u8ff0\u7684\u4e09\u4e2a Preset7 \u7684\u6570\u503c\uff0c\u662f\u5426\u7b26\u5408\u534f\u8bae\u7684\u8981\u6c42\uff1a</p> <ol> <li>3 &lt;= \u4e0b\u53d6\u6574 (12/4), \u7b26\u5408\u8981\u6c42\u3002</li> <li>3 + 21 + 6 = 30 , \u7b26\u5408\u8981\u6c42\u3002</li> <li>21 \u2010 3 \u2010 6 &gt;= 12 , \u7b26\u5408\u8981\u6c42\uff0c\u6240\u4ee5 P7 \u7684\u53c2\u6570\u4e09\u9879\u68c0\u67e5\u90fd\u7b26\u5408\u8981\u6c42\u3002\u3001</li> </ol> <p>\u4e00\u65e6 DSP \u8ba4\u4e3a\u5f53\u524d\u94fe\u8def\u5de5\u4f5c\u6b63\u5e38\uff08\u5373 DSP \u63a5\u6536\u5230 EC = 01b \u7684\u8f93\u5165 TS1\uff09\uff0c\u53ef\u4ee5\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\u65f6\uff0cDSP \u7ed3\u675f\u5f53\u524d\u9636\u6bb5\u5e76\u53d1\u8d77\u8fdb\u5165 Phase2 \u7684\u8bf7\u6c42\uff0c\u901a\u8fc7\u628a TS1 \u4e2d\u7684 EC \u6bd4\u7279\u8bbe\u7f6e\u4e3a 10b\uff0c\u5982\u539f\u6587 583 \u9875\u56fe 14-31 \u6240\u793a\uff0c\u5e76\u5c06\u4e0b\u4e00\u9636\u6bb5\u7684\u63a7\u5236\u6743\u4ea4\u7ed9 USP\u3002\u5f53 USP \u56de\u590d EC \u6bd4\u7279 = 10b \u7684 TS1 \u540e\uff0c\u53cc\u65b9\u7aef\u53e3\u90fd\u8fdb\u5165 Phase 2\u3002\u5982\u679c\u4e00\u5207\u987a\u5229\u7684\u8bdd\uff0cDSP \u53ef\u80fd\u8ba4\u4e3a\u5f53\u524d\u7684\u4fe1\u53f7\u8d28\u91cf\u5df2\u7ecf\u8db3\u591f\u597d\u4e86\uff0c\u4e0d\u9700\u8981\u66f4\u8fdb\u4e00\u6b65\u7684\u8c03\u6574\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cDSP \u53d1\u9001 EC=00b \u7684 TS1 \u4ee5\u9000\u51fa\u5747\u8861\u8fc7\u7a0b\u3002 </p> <p></p> <p>\u56fe 14-31 \u5747\u8861\u8fc7\u7a0b\uff1a\u5f00\u59cb\u9636\u6bb52</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14853-phase-2","title":"14.8.5.3 Phase 2","text":"<p>\u6b64\u65f6\uff0c\u4fe1\u53f7\u8d28\u91cf\u8db3\u591f\u94fe\u8def\u53cc\u65b9\u4ece\u4fe1\u53f7\u4e2d\u8bfb\u53d6\u51fa TS1 \u5e8f\u5217\uff0c\u4f46\u662f\u4e0d\u8db3\u4ee5\u7ef4\u6301\u957f\u65f6\u95f4\u7684\u8fd0\u884c\u3002\u4e00\u65e6\u53cc\u65b9\u7aef\u53e3\u90fd\u5904\u4e8e Phase2\uff0cUSP \u88ab\u5141\u8bb8\u8981\u6c42\u6539\u53d8 DSP \u7684\u53d1\u9001\u8bbe\u7f6e\uff0c\u5e76\u8bc4\u4f30\u5b83\u4eec\u662f\u5426\u9002\u5408\u5f53\u524d\u7684\u73af\u5883\uff0cUSP \u4e0d\u65ad\u8fed\u4ee3\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u76f4\u5230\u94fe\u8def\u8fbe\u5230\u5f53\u524d\u73af\u5883\u4e0b\u7684\u6700\u4f73\u8bbe\u7f6e\u3002\u53d1\u8d77\u6539\u53d8\u8bf7\u6c42\u65f6\uff0cUSP \u6539\u53d8\u5176\u53d1\u9001\u7684 TS1 \u4e2d\u7684\u5747\u8861\u4fe1\u606f\u5b57\u6bb5\u7684\u6570\u503c\u3002\u5982\u539f\u6587 584 \u9875\u56fe 14-32 \u6240\u793a\uff0c\u51e0\u4e2a\u76f8\u5173\u7684\u5b57\u6bb5\u5982\u4e0b\uff1a</p> <ul> <li>Tx Preset: Tx Preset \u662f\u53d1\u9001\u7aef\u7684\u7c97\u7c92\u5ea6\u8c03\u8282\uff0c\u7528\u4e8e\u5c06\u53d1\u9001\u7aef\u8bbe\u7f6e\u4e3a\u5f53\u524d\u4fe1\u53f7\u73af\u5883\u4e0b\u6b63\u786e\u7684\u5927\u81f4\u8303\u56f4\u5185\u3002USP \u8bbe\u7f6e\u4e86 Tx Preset \u7684\u503c\uff0c\u5e76\u5c06 Use Preset \u6bd4\u7279\uff08\u7b26\u53f7 6 \u7684\u6bd4\u7279 7\uff09\u4f4d\u7f6e 1\uff0c\u901a\u77e5 DSP \u53d1\u9001\u7aef\u4f7f\u7528 USP \u63d0\u4f9b\u7684 Tx Preset \u503c\u3002\u5982\u679c Use Preset \u6bd4\u7279\u6ca1\u6709\u7f6e\u4f4d\uff0c\u90a3\u4e48 DSP \u5c06\u4f1a\u7406\u89e3\u4e3a\uff1a\u4fdd\u6301\u5f53\u524d\u7684 Preset \u4e0d\u53d8\uff0c\u800c\u5e94\u8be5\u8c03\u6574\u53d1\u9001\u53c2\u6570\uff08coefficient\uff09\u3002\u53d1\u9001\u53c2\u6570\u662f\u53d1\u9001\u7aef\u7684\u7ec6\u7c92\u5ea6\u8c03\u8282\u65b9\u6cd5\u3002</li> <li>Coefficients: PCIe \u534f\u8bae\u91c7\u7528\u7684\u662f\u4e09\u62bd\u5934\u7684\u53d1\u9001\u5747\u8861\u5668\uff0c\u56e0\u6b64\u5b9a\u4e49\u4e86\u4e09\u4e2a\u53c2\u6570\u7528\u4e8e\u8c03\u6574\u4fe1\u53f7\u8109\u51b2\u7684\u7535\u538b\uff0c\u7528\u4e8e\u8865\u507f\u4f20\u8f93\u4ecb\u8d28\u5e26\u6765\u7684\u4fe1\u53f7\u5e72\u6270\u548c\u5931\u771f\uff0c\u5982\u539f\u6587 585 \u9875\u56fe 14-33 \u6240\u793a\u3002\u5728\u672c\u4e66\u7b2c\u5341\u4e09\u7ae0\u300aPhysical Layer -Electrical\u300b\u7684 \u201dSolution for 8.0 GT/s \u2010 Transmitter Equalization\u201c \u4ecb\u7ecd\u4e86\u66f4\u591a\u7ec6\u8282\uff0c\u4f4d\u4e8e\u539f\u6587 474 \u9875\u3002</li> <li>Pre-Cursor \u53c2\u6570\uff1a \u7528\u4e8e\u4e58\u4ee5\u91c7\u6837\u70b9\u524d\u4e00\u65f6\u523b\u4fe1\u53f7\u503c\u7684\u7cfb\u6570\uff0c\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u589e\u5f3a\u6216\u8005\u51cf\u5f31\u524d\u4e00\u65f6\u523b\u4fe1\u53f7\u7684\u5f71\u54cd\u3002</li> <li>Cursor \u53c2\u6570\uff1a \u7528\u4e8e\u4e58\u4ee5\u91c7\u6837\u70b9\u65f6\u523b\u4fe1\u53f7\u503c\u7684\u7cfb\u6570\uff0c\u8be5\u503c\u59cb\u7ec8\u4e3a\u6b63\u3002</li> <li>Post-Cursor \u53c2\u6570\uff1a \u7528\u4e8e\u4e58\u4ee5\u91c7\u6837\u70b9\u540e\u4e00\u65f6\u523b\u4fe1\u53f7\u503c\u7684\u7cfb\u6570\uff0c\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u589e\u5f3a\u6216\u8005\u51cf\u5f31\u540e\u4e00\u65f6\u523b\u4fe1\u53f7\u7684\u5f71\u54cd\u3002</li> <li>\u4e00\u65e6\u4fe1\u53f7\u8fbe\u5230\u4e86\u4fe1\u53f7\u8d28\u91cf\u6807\u51c6\u7684\u9700\u6c42\uff0cUSP \u4f1a\u901a\u8fc7\u5c06 EC \u6bd4\u7279\u8bbe\u7f6e\u4e3a 11b\uff0c\u8868\u793a\u5176\u5df2\u7ecf\u51c6\u5907\u597d\u8fdb\u5165\u4e0b\u4e00\u5747\u8861\u9636\u6bb5\u3002</li> </ul> <p></p> <p>\u56fe 14-32\uff1a\u5747\u8861\u53c2\u6570\u4ea4\u6362\u793a\u610f\u56fe</p> <p></p> <p>\u56fe 14-33 \u4e09\u62bd\u5934\u53d1\u9001\u5747\u8861\u5668\u793a\u610f\u56fe</p> <p></p> <p>\u56fe 14-34 \u5747\u8861\u8fc7\u7a0b\uff1aPhase 2 \u9636\u6bb5\u7684\u8c03\u6574</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14854-phase-3","title":"14.8.5.4 Phase 3","text":"<p>DSP \u53d1\u9001 EC = 11b \u7684 TS1 \u4f5c\u4e3a\u5bf9 USP \u8fdb\u5165 Phase 3 \u7684\u56de\u5e94\uff0c\u6b64\u65f6\u53ef\u4ee5\u5bf9 UPS \u53d1\u9001\u7aef\u8fdb\u884c\u540c\u6837\u7684\u4fe1\u53f7\u8bc4\u4f30\u8fc7\u7a0b\u3002\u540c\u6837\u5730\uff0cDSP \u53d1\u9001 TS1 \u8981\u6c42 USP \u5e94\u7528\u4e00\u7ec4\u65b0\u7684\u53d1\u9001\u7aef\u8bbe\u7f6e\uff1a\u5982\u679c Use Preset \u6bd4\u7279\u7f6e\u8d77\uff0c\u5219 DSP \u5b9a\u4e49\u4e86\u4e00\u7ec4\u65b0\u7684 presets\uff0c\u5426\u5219\u5c31\u662f DSP \u63d0\u4f9b\u65b0\u7684\u53c2\u6570\u3002\u65b0\u7684\u53d1\u9001\u7aef\u8bbe\u7f6e\u5c06\u8fde\u7eed\u53d1\u9001 1us\uff0c\u6216\u8005\u6b64\u6b21\u53d1\u9001\u7aef\u8bbe\u7f6e\u6539\u53d8\u7533\u8bf7\u7684\u7ed3\u679c\u5df2\u7ecf\u8bc4\u4f30\u5b8c\u6bd5\u540e\u505c\u6b62\u3002\u8bc4\u4f30\u5fc5\u987b\u7b49\u5f85 500ns \u52a0\u4e0a\u4fe1\u53f7\u5728\u53d1\u9001\u903b\u8f91\u548c\u63a5\u6536\u903b\u8f91\u4e4b\u95f4\u7684\u6765\u56de\u65f6\u95f4\u3002DSP \u53ef\u4ee5\u5c1d\u8bd5\u4e0d\u540c\u7684\u5747\u8861\u8bbe\u7f6e\uff0c\u76f4\u5230\u53d1\u73b0\u5176\u4e2d\u67d0\u4e2a\u8bbe\u7f6e\u53d6\u5f97\u4e86\u9884\u671f\u4e2d\u7684\u4fe1\u53f7\u8d28\u91cf\u3002\u6b64\u65f6\uff0cDSP \u901a\u8fc7\u53d1\u9001 EC = 00b\uff0c\u8868\u793a\u9000\u51fa\u5747\u8861\u72b6\u6001\u3002</p> <p></p> <p>\u56fe 14-35 \u5747\u8861\u8fc7\u7a0b\uff1aPhase 3 \u9636\u6bb5\u7684\u8c03\u6574</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14855","title":"14.8.5.5 \u5747\u8861\u8fc7\u7a0b\u4e2d\u7684\u6ce8\u610f\u4e8b\u9879","text":"<p>\u6b64\u8282\u6574\u7406\u4e86\u534f\u8bae\u4e2d\u548c\u5747\u8861\u8fc7\u7a0b\u76f8\u5173\u7684\u5176\u4ed6\u4e8b\u9879\uff0c\u5982\u4e0b\uff1a</p> <ul> <li>\u6240\u6709\u901a\u9053\u90fd\u9700\u8981\u53c2\u4e0e\u5230\u5747\u8861\u8fc7\u7a0b\u4e2d\uff0c\u5373\u4f7f\u662f\u90a3\u4e9b\u53ea\u5728 upconfig \u4e8b\u4ef6\u540e\u624d\u4f1a\u53d8\u6210\u6fc0\u6d3b\u72b6\u6001\u7684\u901a\u9053\u3002</li> <li>\u7ec4\u4ef6\u8bc4\u4f30\u8f93\u5165\u4fe1\u53f7\u7684\u7b97\u6cd5\uff0c\u4ee5\u53ca\u5efa\u8bae\u94fe\u8def\u4f19\u4f34\u5e94\u8be5\u4f7f\u7528\u4f55\u79cd\u5747\u8861\u503c\u7684\u7b97\u6cd5\u4e0d\u5728\u534f\u8bae\u63cf\u8ff0\u8303\u56f4\u5185\uff0c\u7531\u5177\u4f53\u5b9e\u73b0\u51b3\u5b9a\u3002</li> <li>\u5747\u8861\u8bbe\u7f6e\u6539\u53d8\u53ef\u4ee5\u4efb\u7528\u4e8e\u4efb\u610f\u6570\u91cf\u7684\u901a\u9053\uff0c\u5e76\u4e14\u4e0d\u540c\u901a\u9053\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u5747\u8861\u8bbe\u7f6e\u3002</li> <li>\u5728\u7ec6\u7c92\u5ea6\u8c03\u8282\u6b65\u9aa4\u7ed3\u675f\u65f6\uff08UPS \u7684 Phase 2\uff0cDSP \u7684 Phase 3\uff09\uff0c\u5404\u7ec4\u4ef6\u9700\u8981\u786e\u4fdd\u53d1\u9001\u8bbe\u7f6e\u8c03\u8282\u80fd\u4f7f\u5176\u6ee1\u8db3\u534f\u8bae\u8981\u6c42\u3002\uff08\u539f\u6587\uff1a each component is responsible for ensuring that the Transmitter settings cause it to meet the spec requirements.\uff09</li> <li>\u7ec4\u4ef6\u5fc5\u987b\u8bc4\u4f30\u5e76\u54cd\u5e94\u5bf9\u7aef\u7684\u53d1\u9001\u8bbe\u7f6e\u6539\u53d8\u8bf7\u6c42\uff0c\u5bf9\u4e8e\u5408\u7406\u8bf7\u6c42\uff0c\u7ec4\u4ef6\u5fc5\u987b\u91c7\u7eb3\u5bf9\u65b9\u63d0\u4f9b\u7684\u53d1\u9001\u8bbe\u7f6e\uff0c\u5e76\u5728\u53d1\u9001\u7684 TS1 \u4e2d\u53cd\u5e94\u81ea\u8eab\u6240\u4f7f\u7528\u7684\u53d1\u9001\u8bbe\u7f6e\u3002</li> <li>\u4e00\u6b21\u53c2\u6570\u6539\u53d8\u7684\u8bf7\u6c42\u53ef\u80fd\u56e0\u4e3a\u65b0\u7684\u53c2\u6570\u4e0d\u6ee1\u8db3\u89c4\u5219\u800c\u88ab\u62d2\u7edd\u3002\u88ab\u62d2\u7edd\u7684\u53c2\u6570\u4ecd\u7136\u4f1a\u53cd\u5e94\u5728\u53d1\u9001\u7684 TS1 \u4e2d\uff0c\u53ea\u662f\u53c2\u6570\u503c\u62d2\u7edd\uff08Reject Coefficient Values\uff09\u6bd4\u7279\u4f1a\u88ab\u7f6e\u8d77\u3002</li> <li>\u7ec4\u4ef6\u6709\u5fc5\u8981\u50a8\u5b58 8 GT/s \u901f\u7387\u5747\u8861\u9636\u6bb5\u53d6\u5f97\u7684\u5747\u8861\u6570\u503c\u3002\u534f\u8bae\u5e76\u6ca1\u6709\u660e\u786e\u8981\u6c42\u8fd9\u4e00\u70b9\uff0c\u4f46\u662f\u672c\u6587\u4f5c\u8005\u8ba4\u4e3a\uff0c\u5982\u679c\u5b58\u50a8\u4e0b\u8fd9\u4e9b\u5747\u8861\u7ed3\u679c\uff0c\u90a3\u4e48\u5373\u4f7f\u5207\u6362\u5230\u4f4e\u901f\u7387\u540e\uff0c\u518d\u5207\u6362\u56de 8 GT/s \u901f\u7387\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5b58\u50a8\u7684\u7ed3\u679c\u3002\u8fd9\u4e00\u70b9\u662f\u6709\u610f\u4e49\u7684\uff0c\u4e0d\u7136\u7684\u8bdd\uff0c\u6b64\u65f6\u4f1a\u82b1\u8d39\u5927\u91cf\u7684\u65f6\u95f4\u91cd\u65b0\u8fdb\u884c\u5747\u8861\uff0c\u5374\u6709\u53ef\u80fd\u83b7\u5f97\u76f8\u540c\u7684\u5747\u8861\u7ed3\u679c\uff0c\u56e0\u4e3a\u6b64\u65f6\u76f8\u6bd4\u4e8e\u5f7c\u65f6\u7684\u7535\u6c14\u73af\u5883\u5e76\u6ca1\u6709\u53d8\u5316\u3002</li> <li>\u7ec4\u4ef6\u53ef\u4ee5\u968f\u65f6\u8c03\u6574\u5b83\u4eec\u63a5\u6536\u7aef\u7684\u7ec6\u7c92\u5ea6\u8bbe\u7f6e\uff0c\u53ea\u8981\u8fd9\u4e0d\u4f1a\u5bfc\u81f4\u94fe\u8def\u8fdb\u5165\u4e0d\u7a33\u5b9a\u72b6\u6001\u6216\u8005\u8fdb\u5165 Recovery \u72b6\u6001\u3002</li> </ul>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1486","title":"14.8.6 \u5747\u8861\u6b21\u72b6\u6001\u8be6\u89c8","text":"<p>\u672c\u8282\u5c06\u8be6\u7ec6\u8ba8\u8bba\u94fe\u8def\u5747\u8861\u65f6\u6d89\u53ca\u7684\u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14861-recoveryequalization","title":"14.8.6.1 Recovery.Equalization","text":"<p>Recovery.Equalization \u662f\u7528\u4e8e\u5728 8 GT/s \u53ca\u4ee5\u4e0a\u901f\u7387\u8fdb\u884c\u94fe\u8def\u5747\u8861\u8fc7\u7a0b\u7684\u6b21\u72b6\u6001\u3002\u66f4\u4f4e\u7684\u901f\u7387\u65e0\u9700\u4f7f\u7528\u5747\u8861\u529f\u80fd\uff0c LTSSM \u72b6\u6001\u673a\u4e5f\u4e0d\u4f1a\u8fdb\u5165\u8be5\u6b21\u72b6\u6001\u3002\u56e0\u4e3a\u5747\u8861\u662f PCIe \u4e00\u4e2a\u65b0\u7684\uff0c\u5e76\u4e14\u590d\u6742\u7684\u8bdd\u9898\uff0c\u6240\u4ee5\u5728\u4e0a\u4e00\u8282 \u201d14.8.5 \u94fe\u8def\u5747\u8861\u6982\u89c8\u201c  \u4e2d\uff0c\u4ece\u66f4\u62bd\u8c61\u7684\u5c42\u6b21\u63cf\u8ff0\u4e86\u6574\u4e2a\u5747\u8861\u8fc7\u7a0b\u3002\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u904d\u5386\u6bcf\u4e2a\u6b21\u72b6\u6001\u6765\u770b\u6574\u4e2a\u5747\u8861\u7684\u8be6\u7ec6\u8fc7\u7a0b\u3002</p> <p>\u9762\u5411\u4e0b\u6e38\u901a\u9053// Downstream Lanes</p> <p>DSP \u4ece Phase 1 \u5f00\u59cb\u6574\u4e2a\u5747\u8861\u8fc7\u7a0b\u3002\u5728\u5f00\u59cb\u65f6\uff0c\u4e00\u4e9b\u5bc4\u5b58\u5668\u72b6\u6001\u6bd4\u7279\u6807\u5fd7\u4f4d\u9700\u8981\u88ab\u6e05\u9664\uff0c\u5305\u62ec\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668 2 \uff08Link Status 2 register\uff0c\u539f\u6587 588 \u9875 \u56fe 14-36\uff09\u4e2d\u7684\u4ee5\u4e0b\u6bd4\u7279\uff0c\u90fd\u4f1a\u5728\u8fdb\u5165\u8be5\u72b6\u6001\u540e\u88ab\u6e05\u9664\uff1a</p> <ul> <li>Equalization Phase 1 Successful</li> <li>Equalization Phase 2 Successful</li> <li>Equalization Phase 3 Successful</li> <li>Link Equalization Request</li> <li>Equalization Complete</li> </ul> <p>\u94fe\u8def\u63a7\u5236 3 \u5bc4\u5b58\u5668\uff08Link Control 3 register\uff09\u7684  Perform Equalization \u6bd4\u7279\u548c\u5185\u90e8\u53d8\u91cf start_equalization_w_preset \u4e5f\u4f1a\u88ab\u6e05\u9664\u4e3a 0b\u3002\u53d8\u91cf equalization_done_8GT_data_rate \u7f6e\u4f4d\u4e3a 1b\u3002</p> <p></p> <p>\u56fe 14-36 \u94fe\u8def\u72b6\u6001 2 \u5bc4\u5b58\u5668\u793a\u610f\u56fe</p> <p></p> <p>\u56fe 14-37 \u94fe\u8def\u63a7\u5236 3 \u5bc4\u5b58\u5668\u793a\u610f\u56fe</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#phase-1-downstream","title":"Phase 1 Downstream","text":"<p>DSP \u53d1\u9001 EC = 01b \u7684 TS1 \u5e8f\u5217\uff0c\u5176\u4e2d\u5747\u8861\u76f8\u5173\u5b57\u6bb5\u586b\u5145\u901a\u9053\u5747\u8861\u63a7\u5236\u5bc4\u5b58\u5668\uff08 Lane Equalization Control register\uff09\u4e2d\u7684 Tx Preset\uff0c\u4ee5\u53ca Preset \u5bf9\u5e94\u7684 FS\u3001LF \u4ee5\u53ca Post-cursor \u53c2\u6570\u3002\u5982\u679c DSP \u9700\u8981\u65f6\u95f4\u7b49\u5f85\u63a5\u6536\u4fe1\u53f7\u7a33\u5b9a\uff0c\u90a3\u4e48\u5728\u8bc4\u4f30\u8f93\u5165\u4fe1\u53f7\u4e4b\u524d\uff0c\u5141\u8bb8\u7b49\u5f85 500ns\u3002</p> <p>\u8f6c\u6362\u81f3 \u201dPhase 2 Downstream\u201c \u72b6\u6001</p> <p>\u5f53 DSP \u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 EC = 01b \u7684 TS1 \u5e8f\u5217\uff0c\u5e76\u4e14 DSP \u60f3\u8981\u7ee7\u7eed\u5747\u8861\u8fc7\u7a0b\uff0c\u90a3\u4e48 DSP \u8fdb\u5165 Phase 2\u3002\u6b64\u65f6\uff0c\u7aef\u53e3\u4f1a\u5c06\u5747\u8861 Phase 1 \u6210\u529f\u5b8c\u6210\uff08 Equalization Phase 1 Successful\uff09 \u6bd4\u7279\u7f6e\u4e3a 1\uff0c\u5e76\u5b58\u50a8\u63a5\u6536\u5230\u7684 LF \u4ee5\u53ca FS \u6570\u503c\u7528\u4e8e Phase 3 \u4f7f\u7528\uff08\u5982\u679c DSP \u6253\u7b97\u8c03\u6574 USP \u7684\u53d1\u9001\u53c2\u6570\u7684\u8bdd\uff09\u3002</p> <p>\u8f6c\u6362\u81f3\u5177\u4f53\u7684 Recovery \u6b21\u72b6\u6001</p> <p>\u5982\u679c DSP \u4e0d\u6253\u7b97\u8fdb\u884c Phase 2 \u4ee5\u53ca Phase 3 \u7684\u8bdd\uff0c\u90a3\u4e48 DSP \u4f1a\u5c06\u6240\u6709\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\uff08\u6bd4\u5982 Equalization Phase 1 Successful\uff0cEqualization Phase 2 Successful\uff0cEqualization Phase 3 Successful \u4ee5\u53ca Eq.Complete\uff09DSP \u8fd9\u4e48\u505a\u53ef\u80fd\u7684\u539f\u56e0\u662f\u5f53\u524d\u7684\u8f93\u5165\u4fe1\u53f7\u8d28\u91cf\u5df2\u7ecf\u8db3\u591f\u597d\u4e86\uff0c\u6240\u4ee5\u4e0d\u518d\u9700\u8981\u540e\u7eed\u7684\u9636\u6bb5\u3002</p> <p>\u8f6c\u6362\u81f3  \u201cRecovery.Speed\u201d \u72b6\u6001</p> <p>\u5982\u679c\u76f4\u5230 24ms \u8d85\u65f6\uff0c\u90fd\u6ca1\u6709\u63a5\u6536\u5230 TS1\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Recovery.Speed \u72b6\u6001\uff0csuccessful_speed_negotiation \u6807\u5fd7\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#phase-2-downstream","title":"Phase 2 Downstream","text":"<p>DSP \u53d1\u9001 EC = 10b \u7684 TS1 \u5e8f\u5217\uff0c\u5404\u901a\u9053\u6839\u636e\u4ee5\u4e0b\u60c5\u51b5\u72ec\u7acb\u8bbe\u7f6e\u53c2\u6570\uff1a</p> <ul> <li>\u5982\u679c\u9996\u6b21\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 EC = 10b \u7684 TS1\uff08\u4ee3\u8868 USP \u5df2\u7ecf\u8fdb\u5165 Phase 2\uff09\uff0c\u6216\u8005\u6b64\u6b21\u53c2\u6570\u6216 Preset \u76f8\u6bd4\u4e0a\u6b21\u6709\u6240\u53d8\u5316\uff0c\u5982\u679c\u5bf9\u65b9\u6240\u8981\u6c42\u7684\u53c2\u6570\u662f\u5408\u6cd5\u3001\u53d7\u652f\u6301\u7684\uff0c\u90a3\u4e48 DSP \u4f1a\u5728\u63a5\u6536\u5230 TS1 \u7684 500ns \u5185\u5e94\u7528\u8fd9\u4e9b\u53d1\u9001\u53c2\u6570\uff0c\u5e76\u5728 DSP \u53d1\u9001\u7ed9 USP \u7684 TS1 \u4e2d\u53cd\u6620\u8fd9\u4e9b\u53d8\u5316\uff0cTS1 \u4e2d\u7684\u53c2\u6570\u62d2\u7edd\uff08Reject Coefficient\uff09\u6570\u503c\u6bd4\u7279\u88ab\u6e05\u9664\u4e3a 0b\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u53c2\u6570\u7684\u6539\u53d8\u4e0d\u80fd\u5bfc\u81f4\u8d85\u8fc7 1ns \u7684\u975e\u6cd5\u7535\u538b\u6216\u8005\u53d1\u9001\u7aef\u53c2\u6570\u3002</li> <li>\u5982\u679c\u63a5\u6536\u5230\u7684\u53c2\u6570\u8bf7\u6c42\u975e\u6cd5\uff0c\u6216\u8005\u4e0d\u88ab\u652f\u6301\uff0c\u90a3\u4e48 DSP \u4e0d\u4f1a\u6539\u53d8\u53d1\u9001\u8bbe\u7f6e\uff0c\u4f46\u662f\u4ecd\u7136\u5c06\u4f1a\u5728\u53d1\u9001\u8fd4\u56de\u7684 TS1 \u4e2d\u53cd\u6620\u8fd9\u4e9b\u6570\u503c\uff0c\u4f46\u662f\u53c2\u6570\u62d2\u7edd\u6bd4\u7279\u7684\u6570\u503c\u4f1a\u8bbe\u7f6e\u4e3a 1b\u3002\uff08\u8be6\u60c5\u53c2\u89c1\u539f\u6587 590 \u9875\u7684\u56fe 14-38\uff09</li> <li>\u5982\u679c\u6ca1\u6709\u63a5\u6536\u5230\u8fc7\u4e24\u4e2a\u8fde\u7eed\u7684 TS1\uff0c\u90a3\u4e48\u4fdd\u6301\u5f53\u524d\u7684 Tx preset \u4ee5\u53ca\u53c2\u6570\u6570\u503c\u4e0d\u53d8\u3002</li> </ul> <p>\u8f6c\u6362\u81f3 \u201dPhase 3 Downstream\u201c \u72b6\u6001</p> <p>\u5f53 USP \u5bf9\u66f4\u65b0\u540e\u7684 DSP \u53d1\u9001\u4fe1\u53f7\u8d28\u91cf\u6ee1\u610f\u540e\uff0cUSP \u5f00\u59cb\u53d1\u9001 EC = 11b \u7684 TS1 \u5e8f\u5217\uff0c\u8868\u793a\u5e0c\u671b\u5207\u6362\u5230 Phase 3\u3002\u5f53 DSP \u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a\u8fd9\u6837\u7684 TS1 \u4e4b\u540e\uff0c\u5c06  Eq. Phase 2 Successful \u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\uff0c\u5e76\u8f6c\u6362\u5230 Phase 3\u3002</p> <p>\u8f6c\u6362\u81f3  \u201cRecovery.Speed\u201d \u72b6\u6001</p> <p>\u5982\u679c\u76f4\u5230 32ms \u8d85\u65f6\uff0c\u4ecd\u7136\u6ca1\u80fd\u8f6c\u6362\u5230 Phase 3\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Recovery.Speed \u72b6\u6001\uff0csuccessful_speed_negotiation \u6807\u5fd7\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p> <p></p> <p>\u56fe 14-38 \u53c2\u6570\u62d2\u7edd\u6570\u503c\u57df\u793a\u610f\u56fe</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#phase-3-downstream","title":"Phase 3 Downstream","text":"<p>DSP \u53d1\u9001 EC = 11b \u7684 TS1\u5e8f\u5217\uff0c\u4e3a\u6bcf\u4e2a\u901a\u9053\u5f00\u59cb\u5355\u72ec\u7684\u9762\u5411\u4e0a\u6e38\uff08Upstream\uff09\u53d1\u9001\u8bbe\u7f6e\u8bc4\u4f30\u7684\u8fc7\u7a0b\u3002</p> <p>\u5728\u53d1\u9001\u7684 TS1 \u5e8f\u5217\u4e2d\uff0cDSP \u53ef\u4ee5\u901a\u8fc7\u5c06 Use Preset \u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\uff0c\u4ee5\u53ca\u5728 Tx Preset \u57df\u586b\u5165\u9884\u671f\u7684\u6570\u503c\uff0c\u8981\u6c42\u4e00\u6b21 Preset \u8bbe\u7f6e\u53d8\u66f4\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5c06 Use Preset \u6bd4\u7279\u8bbe\u7f6e\u4e3a 0b\uff0c\u4ee5\u53ca\u5728  Pre\u2010cursor, Cursor, \u4ee5\u53ca Post\u2010Cursor Coefficient \u57df\u586b\u5165\u9884\u671f\u6570\u503c\uff0c\u8981\u6c42\u4e00\u6b21\u53c2\u6570\u53d8\u66f4\u3002\u4efb\u610f\u4e00\u79cd\u53d8\u66f4\uff0cDSP \u90fd\u5fc5\u987b\u6301\u7eed\u8fdb\u884c\u81f3\u5c11 1us\uff0c\u76f4\u81f3\u4fe1\u53f7\u8bc4\u4f30\u5b8c\u6210\u3002\u5982\u679c\u8981\u91c7\u7528\u65b0\u7684 Preset \u6216\u8005\u53c2\u6570\uff0c\u90a3\u4e48\u5fc5\u987b\u540c\u65f6\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u5b83\u4eec\u3002\u7136\u800c\uff0c\u5982\u679c\u67d0\u4e2a\u901a\u9053\u60f3\u8981\u4fdd\u6301\u5176 Preset \u6216\u8005\u53c2\u6570\u4e0d\u53d8\uff0c\u90a3\u4e48\u8be5\u901a\u9053\u65e0\u9700\u53d1\u8d77\u53d8\u66f4\u8981\u6c42\u3002</p> <p>DSP \u9700\u8981\u7b49\u5f85\u8db3\u591f\u957f\u7684\u65f6\u95f4\u4ee5\u786e\u4fdd USP \u53d1\u9001\u7aef\u6709\u673a\u4f1a\u5e94\u7528\u6240\u8981\u6c42\u7684\u8bbe\u7f6e\u66f4\u65b0,\uff08500ns \u52a0\u4e0a\u4fe1\u53f7\u7684\u5f80\u8fd4\u5ef6\u8fdf\uff09\uff0c\u7136\u540e\u91cd\u65b0\u5b8c\u6210\u5757\u5bf9\u9f50\u5e76\u8bc4\u4f30\u63a5\u6536\u5230\u7684 TS1 \u5e8f\u5217\u3002\u56e0\u4e3a\u5728\u7b49\u5f85\u671f\u95f4\uff0cDSP \u9884\u671f USP \u4e0d\u4f1a\u53d1\u9001\u4efb\u4f55\u6709\u6548\u7684\u4fe1\u53f7\uff0c\u751a\u81f3\u53ef\u80fd\u4f1a\u53d1\u9001\u4e00\u4e9b\u975e\u6cd5\u4fe1\u53f7\uff0c\u6240\u4ee5\u53ef\u80fd\u9700\u8981\u5728\u7b49\u5f85\u8db3\u591f\u957f\u7684\u65f6\u95f4\u4e4b\u540e\uff0c\u518d\u8fdb\u884c\u5757\u5bf9\u9f50\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1 \u5e8f\u5217\uff0c\u5e76\u4e14\u5176\u4e2d\u7684 Preset \u6216\u8005\u53c2\u6570\u6570\u503c\u548c\u6240\u8981\u6c42\u7684\u76f8\u540c\uff0c\u5e76\u4e14\u62d2\u7edd\u53c2\u6570\u6570\u503c\u6bd4\u7279\u4e0d\u4e3a 1b\uff0c\u8fd9\u4ee3\u8868\u5bf9\u7aef\u63a5\u6536\u4e86\u8bf7\u6c42\u7684\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5df2\u7ecf\u5e94\u7528\u5230\u53d1\u9001\u4fe1\u53f7\u4e2d\uff0cDSP \u6b64\u65f6\u53ef\u4ee5\u8fdb\u884c\u8bc4\u4f30\u64cd\u4f5c\u3002\u5982\u679c\u53c2\u6570\u76f8\u540c\uff0c\u4f46\u662f\u62d2\u7edd\u53c2\u6570\u6570\u503c\u6bd4\u7279\u4e3a 1b\uff0c\u90a3\u4e48\u4ee3\u8868 USP \u62d2\u7edd\u8bf7\u6c42\u4e86\u8bbe\u7f6e\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5e94\u7528\u5b83\u4eec\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u534f\u8bae\u5efa\u8bae DSP \u7528\u4e0d\u540c\u7684\u6570\u503c\u91cd\u65b0\u518d\u8bd5\u4e00\u6b21\u3002\u4f46\u8fd9\u5e76\u4e0d\u662f\u5fc5\u987b\u7684\uff0cDSP \u4e5f\u53ef\u4ee5\u9009\u62e9\u76f4\u63a5\u9000\u51fa\u5f53\u524d\u9636\u6bb5\u3002</p> <p>\u4ece\u53d1\u9001\u8bf7\u6c42\u5f00\u59cb\u7b97\u8d77\uff0c\u76f4\u5230\u4fe1\u53f7\u8bc4\u4f30\u5b8c\u6210\uff0c\u6574\u4e2a Preset \u6216\u8005\u53c2\u6570\u8bf7\u6c42\u8fc7\u7a0b\u7684\u603b\u7528\u65f6\u4e0d\u80fd\u8d85\u8fc7 2ms\u3002\u534f\u8bae\u5141\u8bb8\u4e00\u79cd\u4f8b\u5916\u60c5\u51b5\uff0c\u90a3\u5c31\u662f\u67d0\u4e9b\u8bbe\u8ba1\u5728\u6700\u540e\u9636\u6bb5\u7684\u4f18\u5316\u4e2d\u9700\u8981\u66f4\u591a\u65f6\u95f4\uff0c\u4f46\u662f\u5728\u8be5 Phase \u4e2d\u7684\u603b\u7528\u65f6\u4e0d\u80fd\u8d85\u8fc7 24ms\uff0c\u5e76\u4e14\u8fd9\u79cd\u4f8b\u5916\u60c5\u51b5\u53ea\u80fd\u51fa\u73b0\u81f3\u591a\u4e24\u6b21\u3002\u5982\u679c\u63a5\u6536\u65b9\u4e0d\u80fd\u5206\u8fa8\u51fa\u4efb\u4f55\u6709\u6548\u7684 TS1\uff0c\u90a3\u4e48\u5176\u53ef\u80fd\u5047\u5b9a\u5176\u6240\u8981\u6c42\u7684\u8bbe\u7f6e\u5728\u8be5\u901a\u9053\u4e0a\u5e76\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>\u8f6c\u6362\u81f3\u5177\u4f53\u7684 Recovery \u6b21\u72b6\u6001</p> <p>\u5f53\u6240\u6709\u5df2\u914d\u7f6e\u7684\u901a\u9053\u90fd\u5b8c\u6210\u4e86\u8bbe\u7f6e\u4f18\u5316\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u72b6\u6001\u662f Recovery.RcvrLock\uff0c\u6b64\u65f6\u5c06\u5747\u8861 Phase 3 \u6210\u529f\u5b8c\u6210\uff08Equalization Phase 3 Successful\uff09\u4ee5\u53ca\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p> <p>\u8f6c\u6362\u81f3  \u201cRecovery.Speed\u201d \u72b6\u6001</p> <p>\u5982\u679c\u76f4\u5230 24ms \u8d85\u65f6\uff08\u53ef\u4ee5\u5bb9\u5fcd -0 \u6216\u8005 2ms \u7684\u504f\u5dee\uff09\uff0c\u4ecd\u7136\u6ca1\u80fd\u5b8c\u6210\u5747\u8861\u8fc7\u7a0b\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Recovery.Speed \u72b6\u6001\uff0csuccessful_speed_negotiation \u6807\u5fd7\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p> <p>\u9762\u5411\u4e0a\u6e38\u901a\u9053// Upstream Lanes</p> <p>USP \u4ece Phase 0 \u5f00\u59cb\u6574\u4e2a\u5747\u8861\u8fc7\u7a0b\u3002\u5728\u5f00\u59cb\u65f6\uff0c\u4e00\u4e9b\u5bc4\u5b58\u5668\u72b6\u6001\u6bd4\u7279\u6807\u5fd7\u4f4d\u9700\u8981\u88ab\u6e05\u9664\uff0c\u5305\u62ec\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668 2 \uff08Link Status 2 register\uff0c\u539f\u6587 588 \u9875 \u56fe 14-36\uff09\u4e2d\u7684\u4ee5\u4e0b\u6bd4\u7279\uff0c\u90fd\u4f1a\u5728\u8fdb\u5165\u8be5\u72b6\u6001\u540e\u88ab\u6e05\u9664\uff1a</p> <ul> <li>Equalization Phase 1 Successful</li> <li>Equalization Phase 2 Successful</li> <li>Equalization Phase 3 Successful</li> <li>Link Equalization Request</li> <li>Equalization Complete</li> </ul> <p>\u94fe\u8def\u63a7\u5236 3 \u5bc4\u5b58\u5668\uff08Link Control 3 register\uff09\u7684  Perform Equalization \u6bd4\u7279\u548c\u5185\u90e8\u53d8\u91cf start_equalization_w_preset \u4e5f\u4f1a\u88ab\u6e05\u9664\u4e3a 0b\u3002\u53d8\u91cf equalization_done_8GT_data_rate \u7f6e\u4f4d\u4e3a 1b\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#phase-0-upstream","title":"Phase 0 Upstream","text":"<p>USP \u53d1\u9001 EC = 00b \u7684 TS1 \u5e8f\u5217\uff0c\u6b64\u65f6\u4f7f\u7528\u7684\u662f\u8fdb\u5165\u8be5\u72b6\u6001\u524d DSP \u901a\u8fc7 EQ TS2 \u4f20\u9012\u7684\u53d1\u9001 Preset\u3002\u53d1\u9001\u7684 TS1 \u4e2d\u7684\u5747\u8861\u4fe1\u606f\u57df\u4e2d\u586b\u5145\u4e86\u5b9e\u9645\u4f7f\u7528\u7684 Preset \u503c\uff0c\u4ee5\u53ca Preset \u5bf9\u5e94\u7684 Pre-cursor\uff0cCursor\uff0c\u4ee5\u53ca Post-cursor \u53c2\u6570\u503c\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u901a\u9053\u5728 EQ TS2 \u4e2d\u63a5\u6536\u5230\u98a0\u5012\u7684\uff0c\u6216\u8005\u4e0d\u652f\u6301\u7684 Preset \u6570\u503c\u65f6\uff0c\u6216\u8005\u5e72\u8106\u6ca1\u6709\u63a5\u6536\u5230 EQ TS2 \u65f6\uff0c\u6b64\u65f6 USP \u4f7f\u7528\u7684 Tx Preset \u548c\u76f8\u5e94\u53c2\u6570\u7531\u901a\u9053\u7684\u5177\u4f53\u5b9e\u73b0\u51b3\u5b9a\u3002</p> <p>\u8f6c\u6362\u81f3 \u201dPhase 1 Upstream\u201c \u72b6\u6001</p> <p>\u5f53\u6240\u6709\u7684\u5df2\u914d\u7f6e\u901a\u9053\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684\uff0cEC = 01b \u7684 TS1 \u5e8f\u5217\u540e\uff0c\u4ee3\u8868 USP \u80fd\u591f\u6b63\u786e\u8bc6\u522b\u51fa DSP \u53d1\u9001\u7684 TS1 \u5e8f\u5217\uff0c\u4e4b\u540e USP \u8fdb\u5165 Phase 1 \u9636\u6bb5\u3002DSP \u603b\u662f\u4ece Phase 1 \u9636\u6bb5\u5f00\u59cb\uff0c\u56e0\u6b64 EC \u4e5f\u603b\u662f = 01b\u3002</p> <p>\u5982\u679c USP \u60f3\u540e\u7eed\u8c03\u6574 DSP \u7684\u53d1\u9001\u53c2\u6570\uff0c\u90a3\u4e48\u6b64\u65f6 USP \u9700\u8981\u8bb0\u5f55 TS1 \u4e2d\u63a5\u6536\u5230\u7684 LF \u4ee5\u53ca FS \u6570\u503c\uff0c\u4ee5\u5728 Phase 2 \u9636\u6bb5\u4f7f\u7528\u3002</p> <p>USP \u5728\u8fdb\u5165 Phase 0 \u540e\uff08\u8bd1\u6ce8\uff1a\u6b64\u5904\u4f3c\u4e4e\u5e94\u4e3a Phase 1\uff09\uff0c\u5728\u8bc4\u4f30\u8f93\u5165\u7684 TS1 \u6570\u636e\u4e4b\u524d\u53ef\u80fd\u9700\u8981\u7b49\u5f85 500ns\uff0c\u7528\u4e8e\u63a5\u6536\u7aef\u7a33\u5b9a\u5730\u63a5\u6536\u4fe1\u53f7\u3002</p> <p>\u8f6c\u6362\u81f3  \u201cRecovery.Speed\u201d \u72b6\u6001</p> <p>\u5982\u679c\u76f4\u5230 12ms \u8d85\u65f6\uff0c\u4ecd\u7136\u6ca1\u80fd\u8bc6\u522b\u63a5\u6536\u5230\u7684 TS1 \u5e8f\u5217\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Recovery.Speed \u72b6\u6001\uff0csuccessful_speed_negotiation \u6807\u5fd7\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#phase-1-upstream","title":"Phase 1 Upstream","text":"<p>USP \u53d1\u9001 EC = 01b \u7684 TS1 \u5e8f\u5217\uff0c\u4f7f\u7528 Phase 0 \u4e2d\u51b3\u5b9a\u7684\u53d1\u9001\u8bbe\u7f6e\uff0c\u5e76\u5728\u53d1\u9001\u7684 TS1 \u5e8f\u5217\u4e2d\u53cd\u6620\u6b63\u5728\u4f7f\u7528\u7684 FS\u3001LF \u4ee5\u53ca Post-cursor \u7b49\u53c2\u6570\u3002</p> <p>\u8f6c\u6362\u81f3 \u201dPhase 2 Upstream\u201c \u72b6\u6001</p> <p>\u5982\u679c\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230\u4e86\u4e24\u4e2a\u8fde\u7eed\u7684\uff0cEC = 10b \u7684 TS1\uff0c\u8fd9\u4ee3\u8868 DSP \u5e0c\u671b\u8fdb\u5165 Phase 2\uff0c\u90a3\u4e48 USP \u5728\u6b64\u4e4b\u540e\u8fdb\u5165 Phase 2 \u9636\u6bb5\uff0c\u5e76\u5c06\u5747\u8861\u9636\u6bb5 1 \u6210\u529f\uff08Equalization Phase 1 Successful\uff09\u72b6\u6001\u6bd4\u7279\u7f6e\u4e3a 1b\u3002</p> <p>\u8f6c\u6362\u81f3\u5177\u4f53\u7684 Recovery \u6b21\u72b6\u6001</p> <p>\u5982\u679c\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230\u4e86\u4e24\u4e2a\u8fde\u7eed\u7684\uff0cEC = 00b \u7684 TS1\uff0c\u8fd9\u4ee3\u8868 DSP \u8ba4\u4e3a\u5747\u8861\u8fc7\u7a0b\u5df2\u7ecf\u5b8c\u6210\uff0c\u5e0c\u671b\u8df3\u8fc7\u4e4b\u540e\u7684\u5747\u8861\u9636\u6bb5\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cUSP \u7684\u4e0b\u4e00\u4e2a\u8df3\u8f6c\u72b6\u6001\u662f Recovery.RcvrLock\uff0c\u5e76\u5c06\u5747\u8861\u9636\u6bb5 1 \u6210\u529f\uff08Equalization Phase 1 Successful\uff09\u72b6\u6001\u6bd4\u7279\u548c\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u7f6e\u4e3a 1b\u3002</p> <p>\u8f6c\u6362\u81f3  \u201cRecovery.Speed\u201d \u72b6\u6001</p> <p>\u5982\u679c\u76f4\u5230 12ms \u8d85\u65f6\uff0c\u4e0a\u8ff0\u4e24\u4e2a\u6761\u4ef6\u4ecd\u7136\u6ca1\u6709\u6ee1\u8db3\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Recovery.Speed \u72b6\u6001\uff0csuccessful_speed_negotiation \u6807\u5fd7\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#phase-2-upstream","title":"Phase 2 Upstream","text":"<p>\u5728\u8be5\u9636\u6bb5\uff0cUPS \u53d1\u9001 EC = 10b \u7684 TS1\uff0c\u5f00\u59cb\u8c03\u4f18 DSP \u53d1\u9001\u8bbe\u7f6e\u7684\u8fc7\u7a0b\u3002\u6b63\u5982\u524d\u6587\u6240\u8ff0 DSP \u7684\u76f8\u5173\u8fc7\u7a0b\uff0c\u6b64\u65f6\u7684\u8c03\u6574\u662f\u6bcf\u4e2a\u901a\u9053\u5206\u522b\u8fdb\u884c\u7684\u3002\u5177\u4f53\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>\u5728\u53d1\u9001\u7684 TS1 \u5e8f\u5217\u4e2d\uff0cUSP \u53ef\u4ee5\u5c06 Tx Preset \u57df\u8bbe\u7f6e\u4e3a\u9884\u671f\u7684\u6570\u503c\uff0c\u8981\u6c42\u4e00\u6b21 Preset \u8bbe\u7f6e\u53d8\u66f4\uff0c\u901a\u8fc7\u5c06 Use Preset \u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b \u901a\u77e5 DSP \u5f00\u59cb\u4f7f\u7528\u65b0\u7684 Preset\u3002\u6216\u8005\uff0c\u901a\u8fc7\u5c06 Use Preset \u6bd4\u7279\u8bbe\u7f6e\u4e3a 0b\uff0c\u4ee5\u53ca\u5728  Pre\u2010cursor, Cursor, \u4ee5\u53ca Post\u2010Cursor Coefficient \u57df\u8bbe\u7f6e\u9884\u671f\u6570\u503c\uff0c\u8981\u6c42\u4e00\u6b21\u53c2\u6570\u53d8\u66f4\u3002DSP \u4f1a\u91c7\u7528\u65b0\u7684\u53c2\u6570\uff0c\u800c\u4e0d\u662f\u8bfb\u53d6 Preset \u57df\u7684\u6570\u503c\u3002\u4e00\u65e6\u5f00\u59cb\u8981\u6c42\u53d8\u66f4\uff0cUSP \u90fd\u5fc5\u987b\u6301\u7eed\u8fdb\u884c\u81f3\u5c11 1us\uff0c\u76f4\u81f3\u4fe1\u53f7\u8bc4\u4f30\u5b8c\u6210\u3002\u5982\u679c\u8981\u91c7\u7528\u65b0\u7684 Preset \u6216\u8005\u53c2\u6570\uff0c\u90a3\u4e48\u5fc5\u987b\u540c\u65f6\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u5b83\u4eec\u3002\u7136\u800c\uff0c\u5982\u679c\u67d0\u4e2a\u901a\u9053\u60f3\u8981\u4fdd\u6301\u5176 Preset \u6216\u8005\u53c2\u6570\u4e0d\u53d8\uff0c\u90a3\u4e48\u8be5\u901a\u9053\u4e0a\u65e0\u9700\u53d1\u8d77\u53d8\u66f4\u8bf7\u6c42\u3002</p> <p>USP \u9700\u8981\u7b49\u5f85\u8db3\u591f\u957f\u7684\u65f6\u95f4\u4ee5\u786e\u4fdd DSP \u53d1\u9001\u7aef\u6709\u673a\u4f1a\u5e94\u7528\u6240\u8981\u6c42\u7684\u8bbe\u7f6e\u66f4\u65b0,\uff08500ns \u52a0\u4e0a\u4fe1\u53f7\u7684\u5f80\u8fd4\u5ef6\u8fdf\uff09\uff0c\u7136\u540e\u91cd\u65b0\u5b8c\u6210\u5757\u5bf9\u9f50\u5e76\u8bc4\u4f30\u63a5\u6536\u5230\u7684 TS1 \u5e8f\u5217\u3002\u5728\u7b49\u5f85\u671f\u95f4\uff0cUSP \u9884\u671f DSP \u4e0d\u4f1a\u53d1\u9001\u4efb\u4f55\u6709\u6548\u7684\u4fe1\u53f7\uff0c\u751a\u81f3\u53ef\u80fd\u4f1a\u53d1\u9001\u4e00\u4e9b\u975e\u6cd5\u4fe1\u53f7\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u9700\u8981\u5728\u7b49\u5f85\u8db3\u591f\u957f\u7684\u65f6\u95f4\u4e4b\u540e\uff0c\u518d\u8fdb\u884c\u5757\u5bf9\u9f50\u64cd\u4f5c\u7684\u539f\u56e0\u3002</p> <p>\u5982\u679c\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1 \u5e8f\u5217\uff0c\u5176\u4e2d\u7684 Preset \u6216\u8005\u53c2\u6570\u6570\u503c\u548c\u6240\u8981\u6c42\u7684\u76f8\u540c\uff0c\u5e76\u4e14\u62d2\u7edd\u53c2\u6570\u6570\u503c\u6bd4\u7279\u4e0d\u4e3a 1b\uff0c\u8fd9\u4ee3\u8868\u5bf9\u7aef\u63a5\u6536\u4e86\u8bf7\u6c42\u7684\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5df2\u7ecf\u5e94\u7528\u5230\u53d1\u9001\u4fe1\u53f7\u4e2d\uff0cUSP \u6b64\u65f6\u53ef\u4ee5\u8bc4\u4f30\u5bf9\u65b9\u53d1\u9001\u7684\u4fe1\u53f7\u3002\u5982\u679c\u53c2\u6570\u76f8\u540c\uff0c\u4f46\u662f\u62d2\u7edd\u53c2\u6570\u6570\u503c\u6bd4\u7279\u4e3a 1b\uff0c\u90a3\u4e48\u4ee3\u8868 DSP \u62d2\u7edd\u8bf7\u6c42\u4e86\u8bbe\u7f6e\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5e94\u7528\u5b83\u4eec\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u534f\u8bae\u5efa\u8bae USP \u7528\u4e0d\u540c\u7684\u6570\u503c\u91cd\u65b0\u518d\u8bd5\u4e00\u6b21\u3002\u4f46\u8fd9\u5e76\u4e0d\u662f\u5fc5\u987b\u7684\u3002</p> <p>\u6574\u4e2a Preset \u6216\u8005\u53c2\u6570\u8bf7\u6c42\u8fc7\u7a0b\u7684\u603b\u7528\u65f6\u4e0d\u80fd\u8d85\u8fc7 2ms\uff0c\u4ece\u53d1\u9001\u8bf7\u6c42\u5f00\u59cb\u7b97\u8d77\uff0c\u76f4\u5230\u4fe1\u53f7\u8bc4\u4f30\u5b8c\u6210\u3002\u534f\u8bae\u5141\u8bb8\u4e00\u79cd\u4f8b\u5916\u60c5\u51b5\uff0c\u90a3\u5c31\u662f\u67d0\u4e9b\u8bbe\u8ba1\u5728\u6700\u540e\u9636\u6bb5\u7684\u4f18\u5316\u4e2d\u9700\u8981\u66f4\u591a\u65f6\u95f4\uff0c\u4f46\u662f\u5728\u8be5 Phase \u4e2d\u7684\u603b\u7528\u65f6\u4e0d\u80fd\u8d85\u8fc7 24ms\uff0c\u5e76\u4e14\u8fd9\u79cd\u4f8b\u5916\u60c5\u51b5\u53ea\u80fd\u51fa\u73b0\u81f3\u591a\u4e24\u6b21\u3002\u5982\u679c\u63a5\u6536\u65b9\u4e0d\u80fd\u5206\u8fa8\u51fa\u4efb\u4f55\u6709\u6548\u7684 TS1\uff0c\u90a3\u4e48\u5176\u53ef\u80fd\u5047\u5b9a\u5176\u6240\u8981\u6c42\u7684\u8bbe\u7f6e\u5728\u8be5\u901a\u9053\u4e0a\u5e76\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>\u8f6c\u6362\u81f3 \u201dPhase 3 Upstream\u201c \u72b6\u6001</p> <p>\u5982\u679c\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u90fd\u5df2\u7ecf\u5c06\u5bf9\u7aef\u53d1\u9001\u8bbe\u7f6e\u8c03\u6574\u4e3a\u6700\u4f18\uff0c\u90a3\u4e48 USP \u5728\u6b64\u4e4b\u540e\u8fdb\u5165 Phase 3 \u9636\u6bb5\uff0c\u5e76\u5c06\u5747\u8861\u9636\u6bb5 2 \u6210\u529f\uff08Equalization Phase 2 Successful\uff09\u72b6\u6001\u6bd4\u7279\u7f6e\u4e3a 1b\u3002</p> <p>\u8f6c\u6362\u81f3  \u201cRecovery.Speed\u201d \u72b6\u6001</p> <p>\u5982\u679c\u76f4\u5230 24ms \u8d85\u65f6\uff08\u53ef\u4ee5\u5bb9\u5fcd -0 \u6216\u8005 2ms \u7684\u504f\u5dee\uff09\uff0c\u4ecd\u7136\u6ca1\u80fd\u5b8c\u6210\u5747\u8861\u8fc7\u7a0b\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Recovery.Speed \u72b6\u6001\uff0csuccessful_speed_negotiation \u6807\u5fd7\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#phase-3-upstream","title":"Phase 3 Upstream","text":"<p>USP \u53d1\u9001 EC = 11b \u7684 TS1\u5e8f\u5217\uff0c\u5f00\u59cb\u54cd\u5e94 DSP \u6240\u8981\u6c42\u7684\u53d1\u9001\u8bbe\u7f6e\u66f4\u6539\u8bf7\u6c42\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1\uff0c\u90a3\u4e48\u4fdd\u6301\u5f53\u524d\u7684 Tx preset \u4ee5\u53ca\u53c2\u6570\u6570\u503c\u4e0d\u53d8\u3002\u4f46\u5982\u679c\u9996\u6b21\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 EC = 11b \u7684 TS1\uff08\u4ee3\u8868 DSP \u5df2\u7ecf\u8fdb\u5165 Phase 3\uff09\uff0c\u6216\u8005\u6b64\u6b21\u53c2\u6570\u6216 Preset \u76f8\u6bd4\u4e0a\u6b21\u6709\u6240\u53d8\u5316\uff0c\u5982\u679c\u6240\u8981\u6c42\u7684\u53c2\u6570\u662f\u5408\u6cd5\u3001\u88ab\u652f\u6301\u7684\uff0c\u90a3\u4e48 USP \u4f1a\u5728\u63a5\u6536\u5230 TS1 \u7684 500ns \u5185\u5e94\u7528\u8fd9\u4e9b\u53d1\u9001\u53c2\u6570\uff0c\u5e76\u5728\u53d1\u9001\u7ed9 DSP \u7684 TS1 \u4e2d\u53cd\u6620\u8fd9\u4e00\u53c2\u6570\u7684\u53d8\u5316\uff0cTS1 \u4e2d\u7684\u53c2\u6570\u62d2\u7edd\uff08Reject Coefficient\uff09\u6570\u503c\u6bd4\u7279\u88ab\u6e05\u9664\u4e3a 0b\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u53c2\u6570\u7684\u6539\u53d8\u4e0d\u80fd\u5bfc\u81f4\u8d85\u8fc7 1ns \u7684\u975e\u6cd5\u7535\u538b\u6216\u8005\u53d1\u9001\u7aef\u53c2\u6570\u3002</p> <ul> <li>\u5982\u679c\u63a5\u6536\u5230\u7684\u53c2\u6570\u8bf7\u6c42\u975e\u6cd5\uff0c\u6216\u8005\u4e0d\u88ab\u652f\u6301\uff0c\u90a3\u4e48 USP \u4e0d\u4f1a\u6539\u53d8\u53d1\u9001\u8bbe\u7f6e\uff0c\u4f46\u662f\u4ecd\u7136\u5c06\u4f1a\u5728\u53d1\u9001\u8fd4\u56de\u7684 TS1 \u4e2d\u53cd\u5e94\u8fd9\u4e00\u6570\u503c\uff0c\u4f46\u662f\u53c2\u6570\u62d2\u7edd\u6bd4\u7279\u7684\u6570\u503c\u4f1a\u8bbe\u7f6e\u4e3a 1b\u3002\uff08\u8be6\u60c5\u53c2\u89c1\u539f\u6587 590 \u9875\u7684\u56fe 14-38\uff09</li> </ul> <p>\u8f6c\u6362\u81f3\u5177\u4f53\u7684 Recovery \u6b21\u72b6\u6001</p> <p>\u5982\u679c DSP \u5bf9\u66f4\u65b0\u540e\u7684\u4fe1\u53f7\u8d28\u91cf\u6ee1\u610f\uff0c\u90a3\u4e48 DSP \u5f00\u59cb\u53d1\u9001 EC = 00b \u7684 TS1 \u5e8f\u5217\uff0c\u8868\u793a\u5e0c\u671b\u7ed3\u675f\u5747\u8861\u8fc7\u7a0b\u3002\u5f53 USP \u63a5\u6536\u5230\u8fde\u7eed\u4e24\u4e2a\u8fd9\u6837\u7684 TS1 \u4e4b\u540e\uff0cUSP \u8f6c\u5165 Recovery \u5177\u4f53\u6b21\u72b6\u6001\uff0c\u5c06\u5747\u8861 Phase 3 \u6210\u529f\uff08 Eq. Phase 3 Successful \uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p> <p>\u8f6c\u6362\u81f3  \u201cRecovery.Speed\u201d \u72b6\u6001</p> <p>\u5982\u679c\u76f4\u5230 32ms \u8d85\u65f6\uff0c\u4ecd\u7136\u6ca1\u80fd\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8f6c\u5165 Recovery.Speed \u72b6\u6001\uff0csuccessful_speed_negotiation \u6807\u5fd7\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u5c06\u5747\u8861\u5b8c\u6210\uff08Equalization Complete\uff09\u72b6\u6001\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14862-recoveryspeed","title":"14.8.6.2 Recovery.Speed","text":"<p>\u5f53\u8fdb\u5165\u8be5\u6b21\u72b6\u6001\u65f6\uff0c\u8bbe\u5907\u53d1\u9001\u7aef\u5fc5\u987b\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u7136\u540e\u7b49\u5f85\u5176\u63a5\u6536\u7aef\u4e5f\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u4e4b\u540e\uff0c\u5982\u679c\u901f\u7387\u8f6c\u6362\u662f\u6210\u529f\u7684\uff08successful_speed_negotiation = 1b\uff09\uff0c\u90a3\u4e48\u5728\u6b64\u81f3\u5c11\u7b49\u5f85 800ns\uff0c\u5982\u679c\u901f\u7387\u8f6c\u6362\u4e0d\u6210\u529f\uff08successful_speed_negotiation = 0b\uff09\uff0c\u90a3\u4e48\u81f3\u5c11\u5728\u6b64\u7b49\u5f85 6us\uff0c\u4f46\u662f\u7b49\u5f85\u7684\u65f6\u95f4\u90fd\u4e0d\u8981\u8d85\u8fc7\u989d\u5916\u7684 1ms\u3002</p> <p>\u5982\u679c\u94fe\u8def\u901f\u7387\u662f 2.5GT/s \u6216\u8005 8GT/s\uff0c\u90a3\u4e48\u5728\u8fdb\u5165\u8be5\u6b21\u72b6\u6001\u524d\u5fc5\u987b\u53d1\u9001\u4e00\u4e2a EIOS\uff0c\u5982\u679c\u901f\u7387\u662f 5GT/s\uff0c\u90a3\u4e48\u5fc5\u987b\u53d1\u9001\u4e24\u4e2a\u3002\u6240\u8c13\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u662f\u6307\u5728\u94fe\u8def\u4e0a\u770b\u5230\u4e00\u4e9b EIOS\uff0c\u6216\u8005\u68c0\u6d4b\u5230\uff0c\u6216\u8005\u63a8\u65ad\u51fa\u5f53\u524d\u6b63\u5904\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff08\u8be6\u89c1\u539f\u6587 736 \u9875 \u201dElecitrical Idle\u201c \u8282\uff09\u3002</p> <p>\u53ea\u6709\u5f53\u63a5\u6536\u7aef\u4e5f\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u540e\uff0c\u624d\u80fd\u8fdb\u884c\u94fe\u8def\u8fd0\u884c\u901f\u7387\u6539\u53d8\u3002\u5982\u679c\u94fe\u8def\u5df2\u7ecf\u5de5\u4f5c\u4e8e\u53cc\u65b9\u6240\u80fd\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\uff0c\u90a3\u4e48\u8fdb\u5165\u8be5\u6b21\u72b6\u6001\u4e5f\u4e0d\u4f1a\u6539\u53d8\u8fd0\u884c\u901f\u7387\u3002</p> <p>\u5982\u679c\u53cc\u65b9\u534f\u5546\u7684\u65b0\u901f\u7387\u662f 5GT/s\uff0c\u90a3\u4e48\u53bb\u52a0\u91cd\u6c34\u5e73\u5fc5\u987b\u57fa\u4e8e\u5f53\u524d\u5185\u90e8\u53d8\u91cf select_deemphasis \u7684\u6570\u503c\u6765\u51b3\u5b9a\u3002\u5982\u679c\u53d8\u91cf\u6570\u503c\u4e3a 0b\uff0c\u90a3\u4e48\u91c7\u7528 -6dB \u7684\u53bb\u52a0\u91cd\u6c34\u5e73\uff0c\u5982\u679c\u53d8\u91cf\u4e3a 1b\uff0c\u90a3\u4e48\u8f6c\u800c\u91c7\u7528 -3.5dB \u7684\u53bb\u52a0\u91cd\u6c34\u5e73\u3002</p> <p>\u4ee4\u4eba\u597d\u5947\u7684\u4e00\u70b9\u662f\uff0c\u534f\u8bae\u4e2d\u5e76\u6ca1\u6709\u8981\u6c42\u94fe\u8def\u53cc\u65b9\u5728\u8be5\u6b21\u72b6\u6001\u5fc5\u987b\u4fdd\u6301\u5171\u6a21\u7535\u538b\u5728\u534f\u8bae\u89c4\u5b9a\u7684\u7535\u538b\u8303\u56f4\u5185\u3002</p> <p>\u5982\u679c\u94fe\u8def\u662f\u5728\u4e00\u6b21\u6210\u529f\u7684\u901f\u7387\u534f\u5546\uff08successful_speed_negotiation = 1b\uff09\u540e\u8fdb\u5165\u7684\u672c\u6b21\u72b6\u6001\uff0c\u90a3\u4e48\u53ef\u4ee5\u6309\u7167\u539f\u6587 596 \u9875\u7684\u8868 14-10 \u4e2d\u7684\u76f8\u5173\u8868\u683c\u4e2d\u7684\u6761\u4ef6\u6765\u63a8\u65ad\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u534f\u8bae\u6307\u51fa\u8be5\u6761\u4ef6\u662f\u4e3a\u4e86\u8986\u76d6\u94fe\u8def\u53cc\u65b9\u90fd\u80fd\u591f\u8bc6\u522b\u51fa\u5bf9\u65b9\u53d1\u9001\u7684 TS1 \u548c TS2 \u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u94fe\u8def\u4e0a\u4e0d\u5b58\u5728 TS \u5e8f\u5217\u65f6\uff0c\u5c31\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u5f53\u524d\u5df2\u7ecf\u8fdb\u5165\u4e86\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p> <p>\u5982\u679c\u94fe\u8def\u662f\u5728\u4e00\u6b21\u4e0d\u6210\u529f\u7684\u901f\u7387\u534f\u5546\uff08successful_speed_negotiation = 0b\uff09\u4e4b\u540e\u8fdb\u5165\u8be5\u6b21\u72b6\u6001\uff0c\u90a3\u4e48\u901a\u8fc7\u6ca1\u6709\u5728\u4efb\u4f55\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u770b\u5230\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u5e8f\u5217\uff0c\u6765\u63a8\u65ad\u51fa\u5f53\u524d\u94fe\u8def\u5904\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u8fd9\u9879\u89c4\u5219\u662f\u4e3a\u4e86\u8986\u76d6\u94fe\u8def\u53cc\u65b9\u4e2d\u81f3\u5c11\u4e00\u65b9\u65e0\u6cd5\u8bc6\u522b\u5bf9\u65b9\u7684 TS \u5e8f\u5217\u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u5982\u679c\u4e00\u6bb5\u65f6\u95f4\u95f4\u9694\u540e\uff0c\u4ecd\u7136\u6ca1\u6709\u770b\u5230\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u9000\u51fa\u5e8f\u5217\u65f6\uff0c\u94fe\u8def\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u8fdb\u5165\u4e86\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p> <p>\u8868 14-10 \u63a8\u65ad\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u7684\u6761\u4ef6</p> \u72b6\u6001 2.5 GT/s 5 GT/s 8 GT/s L0 128us \u7a97\u53e3\u5185\u6ca1\u6709\u89c1\u5230\u6d41\u63a7\u66f4\u65b0 DLLP \u6216\u8005 SoS 128us \u7a97\u53e3\u5185\u6ca1\u6709\u89c1\u5230\u6d41\u63a7\u66f4\u65b0 DLLP \u6216\u8005 SoS 128us \u7a97\u53e3\u5185\u6ca1\u6709\u89c1\u5230\u6d41\u63a7\u66f4\u65b0 DLLP \u6216\u8005 SoS Recovery.RcvrCfg 1280 UI \u5185\u6ca1\u6709\u89c1\u5230 TS\u00bd 1280 UI \u5185\u6ca1\u6709\u89c1\u5230 TS\u00bd 4ms \u5185\u6ca1\u6709\u89c1\u5230 TS\u00bd Recovery.Speed (successful_speed_negotiation = 1b) 1280 UI \u5185\u6ca1\u6709\u89c1\u5230 TS\u00bd 1280 UI \u5185\u6ca1\u6709\u89c1\u5230 TS\u00bd 4680UI \u5185\u6ca1\u6709\u89c1\u5230 TS\u00bd Recovery.Speed (successful_speed_negotiation = 0b) 2000UI \u5185\u6ca1\u6709\u89c1\u5230\u7535\u6c14\u7a7a\u95f2\u9000\u51fa\u5e8f\u5217 16000UI \u5185\u6ca1\u6709\u89c1\u5230\u7535\u6c14\u7a7a\u95f2\u9000\u51fa\u5e8f\u5217 16000UI \u5185\u6ca1\u6709\u89c1\u5230\u7535\u6c14\u7a7a\u95f2\u9000\u51fa\u5e8f\u5217 Loopback.Active (slave) 128us \u5185\u6ca1\u6709\u89c1\u5230\u7535\u6c14\u7a7a\u95f2\u9000\u51fa\u5e8f\u5217 N/A N/A <p>\u6b64\u65f6\uff0c\u5185\u90e8\u53d8\u91cf  directed_speed_change \u4f1a\u88ab\u6e05\u9664\u4e3a 0b\uff0c\u5e76\u4e14\u65b0\u7684\u901f\u7387\u9700\u8981\u53cd\u6620\u5728\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\uff08 Link Status register\uff09\u7684\u5f53\u524d\u94fe\u8def\u901f\u7387\uff08Current Link Speed\uff09\u57df\u4e2d\uff0c\u5982\u56fe 14-39 \u6240\u793a\u3002</p> <p>\u5982\u679c\u901f\u7387\u6539\u53d8\u662f\u7531\u94fe\u8def\u5e26\u5bbd\u6539\u53d8\u5f15\u8d77\u7684\uff0c\u90a3\u4e48\uff1a</p> <ul> <li>\u5982\u679c\u901f\u7387\u534f\u5546\u6210\u529f\uff08successful_speed_negotiation = 1b\uff09\uff0c\u5e76\u4e14\u5728\u8fde\u7eed\u7684 8 \u4e2a TS2 \u4e2d Autonomous Change \u6bd4\u7279\u90fd\u4e3a 1b\uff0c\u6216\u8005\u901f\u7387\u6539\u53d8\u662f\u7531 DSP \u786c\u4ef6\u81ea\u53d1\u7684\uff08\u800c\u4e0d\u662f\u56e0\u4e3a\u94fe\u8def\u53ef\u9760\u6027\u95ee\u9898\uff0c\u6216\u8005\u8f6f\u4ef6\u8bbe\u7f6e\u94fe\u8def\u91cd\u8bad\u7ec3\u6bd4\u7279\uff08Link Retrain bit\uff09\u5f15\u8d77\u7684\uff09\uff0c\u90a3\u4e48\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\uff08Link Status register\uff09\u4e2d\u7684\u94fe\u8def\u81ea\u53d1\u5e26\u5bbd\u72b6\u6001\uff08Link Autonomous Bandwidth Status\uff09\u6bd4\u7279\u8bbe\u7f6e\u4e3a 1b\u3002</li> <li>\u5426\u5219\uff0c\u94fe\u8def\u5e26\u5bbd\u7ba1\u7406\u72b6\u6001\u6bd4\u7279\uff08 Link Bandwidth Management Status bit\uff09\u7f6e\u4e3a 1b\u3002</li> </ul> <p></p> <p>\u56fe 14-39 \u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668</p> <p>\u8f6c\u6362\u81f3\u5177\u4f53\u7684 Recovery \u6b21\u72b6\u6001</p> <p>\u5728\u8d85\u65f6\u89e6\u53d1\u540e\uff0c\u4e0b\u4e00\u4e2a\u6b21\u72b6\u6001\u662f Recovery.RcvrLock\u3002</p> <p>\u5982\u679c\u5f53\u524d\u7684\u6b21\u72b6\u6001\u662f\u4ece Recovery.RcvrLock \u72b6\u6001\u8fdb\u5165\u7684\uff0c\u5e76\u4e14\u901f\u7387\u8f6c\u6362\u6210\u529f\uff0c\u90a3\u4e48\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u6539\u53d8\u4e3a\u65b0\u7684\u901f\u7387\uff1a\u4e5f\u5c31\u662f\u53cc\u65b9\u5171\u540c\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\uff0c\u5e76\u628a changed_speed_recovery \u53d8\u91cf\u7f6e\u4e3a 1b\u3002</p> <p>\u5982\u679c\u5f53\u524d\u5df2\u7ecf\u662f\u81ea L0 \u6216\u8005 L1 \u72b6\u6001\u8fdb\u5165 Recovery \u4ee5\u6765\uff0c\u7b2c\u4e8c\u6b21\u8fdb\u5165 Recovery.Speed \u6b21\u72b6\u6001\u4e86\uff08\u901a\u8fc7\u5185\u90e8\u53d8\u91cf changed_speed_recovery = 1b \u5f97\u77e5\uff09\uff0c\u65b0\u7684\u901f\u7387\u4f1a\u6062\u590d\u6210 LTSSM \u8fdb\u5165 Recovery \u72b6\u6001\u4e4b\u524d\u4f7f\u7528\u7684\u901f\u7387\uff0c\u6b64\u65f6  changed_speed_recovery \u53d8\u91cf\u4f1a\u88ab\u6e05\u9664\u4e3a 0b\u3002</p> <p>\u5426\u5219\uff0c\u65b0\u7684\u901f\u7387\u4f1a\u6062\u590d\u4e3a 2.5GT/s\uff0c\u5e76\u4e14  changed_speed_recovery \u53d8\u91cf\u540c\u6837\u4f1a\u4fdd\u6301\u4e3a 0b\u3002\u534f\u8bae\u6307\u51fa\u8be5\u60c5\u51b5\u5bf9\u5e94\u4e8e\u6b64\u524d\u5728 L0 \u72b6\u6001\u4e2d\u94fe\u8def\u901f\u7387\u5927\u4e8e 2.5GT/s\uff0c\u4f46\u662f\u94fe\u8def\u4e00\u65b9\u4e0d\u80fd\u5728\u8be5\u901f\u7387\u6b63\u5e38\u8fd0\u884c\uff0c\u5e76\u5728\u7b2c\u4e00\u6b21\u7684 Recovery.RcvrLock \u72b6\u6001\u4e2d\u8d85\u65f6\u9000\u51fa\u3002</p> <p>\u8f6c\u6362\u81f3 Detect\u72b6\u6001</p> <p>\u5982\u679c\u4e0a\u8ff0\u8f6c\u6362\u5230 Recovery.RcvrLock \u72b6\u6001\u7684\u6761\u4ef6\u90fd\u6ca1\u6709\u88ab\u6ee1\u8db3\uff0c\u90a3\u4e48\u72b6\u6001\u4f1a\u8f6c\u79fb\u4e3a Detect\u3002\u534f\u8bae\u6307\u51fa\u5728\u6b63\u5e38\u7684\u6d41\u7a0b\u4e2d\u4e0d\u4f1a\u51fa\u73b0\u8fd9\u79cd\u8df3\u8f6c\u60c5\u51b5\uff0c\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u4ee3\u8868\u6b64\u65f6\u94fe\u8def\u53cc\u65b9\u5df2\u7ecf\u6839\u672c\u65e0\u6cd5\u6b63\u5e38\u901a\u4fe1\u4e86\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14863-recoveryrcvrcfg","title":"14.8.6.3 Recovery.RcvrCfg","text":"<p>\u8be5\u72b6\u6001\u53ea\u4f1a\u4ece Recovery.RcvrLock \u72b6\u6001\u8df3\u8f6c\u8fdb\u6765\uff0c\u5f53\u63a5\u6536\u5230\u81f3\u5c11 8 \u4e2a\u5e26\u6709\u4e0e\u6b64\u524d\u534f\u5546\u503c\u4e00\u81f4\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u7684 TS1 \u6216\u8005 TS2 \u4e4b\u540e\u8df3\u8f6c\u3002\u8df3\u8f6c\u8fdb\u5165\u672c\u72b6\u6001\u610f\u5473\u7740\u5728 Recovery.RcvrLock \u72b6\u6001\u4e2d\u91cd\u65b0\u5efa\u7acb\u4e86\u6bd4\u7279\u548c\u7b26\u53f7\u6216\u8005\u5757\u9501\u5b9a\uff0c\u6b64\u65f6\u7aef\u53e3\u9700\u8981\u51b3\u5b9a\u5728 Recovery \u72b6\u6001\u662f\u5426\u8fd8\u6709\u64cd\u4f5c\u9700\u8981\u8fdb\u884c\u3002\u5982\u679c\u8fdb\u5165 Recovery \u72b6\u6001\u7684\u76ee\u7684\u4ec5\u4ec5\u662f\u5728\u79bb\u5f00\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u72b6\u6001\u4e4b\u540e\u91cd\u65b0\u5efa\u7acb\u6bd4\u7279\u548c\u7b26\u53f7\u9501\u5b9a\uff0c\u90a3\u4e48\u5728\u8be5\u72b6\u6001\u53ea\u4f1a\u5728\u94fe\u8def\u4e0a\u4ea4\u6362 TS2 \u5e8f\u5217\uff0c\u7136\u540e\u8df3\u8f6c\u81f3\u4e0b\u4e00\u4e2a\u72b6\u6001\uff1aRecovery.Idle\u3002\u4f46\u662f\uff0c\u5982\u679c\u8fdb\u5165 Recovery \u72b6\u6001\u8fd8\u53e6\u6709\u7406\u7531\uff08\u6bd4\u5982\u51fa\u4e8e\u6539\u53d8\u94fe\u8def\u901f\u7387\u6216\u8005\u5bbd\u5ea6\u7684\u9700\u6c42\uff09\uff0c\u90a3\u4e48\u5728\u8be5\u72b6\u6001\u4e2d\u4f1a\u8fdb\u884c\u76f8\u5e94\u52a8\u4f5c\uff0c\u968f\u540e\u8df3\u8f6c\u81f3\u9002\u5408\u7684\u540e\u7eed\u72b6\u6001\u3002</p> <p>\u5728\u672c\u6b21\u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u65b9\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u53d1\u9001 TS2\uff0c\u5176\u4e2d\u5e26\u6709\u4e0e\u5148\u524d\u534f\u5546\u7ed3\u679c\u4e00\u81f4\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u3002\u5982\u679c\u5185\u90e8\u53d8\u91cf directed_speed_change \u8bbe\u7f6e\u4e3a 1b\uff0c\u90a3\u4e48 TS2 \u4e2d speed_change \u6bd4\u7279\u4e5f\u88ab\u7f6e\u4e3a 1b\u3002TS2 \u4e2d\u7684 N_FTS \u53d8\u91cf\u4e5f\u9700\u8981\u66f4\u65b0\u4e3a\u4e0e\u5f53\u524d\u901f\u7387\u5339\u914d\u7684\u6570\u503c\u3002\u5728\u8fdb\u5165\u672c\u6b21\u72b6\u6001\u540e\uff0c\u5185\u90e8\u53d8\u91cf start_equalization_w_preset \u6e05\u9664\u4e3a 0b\u3002</p> <p>\u5728\u901f\u7387\u53d1\u751f\u6539\u53d8\u540e\uff0c\u5728 TS2 \u4e2d\u5e94\u8be5\u4e5f\u80fd\u770b\u5230\u4e0d\u540c\u7684 N_FTS \u7684\u6570\u503c\uff0c\u5c06\u6765\u9000\u51fa L0s \u4f4e\u529f\u8017\u72b6\u6001\u65f6\u5fc5\u987b\u7528\u5230\u8be5\u6570\u503c\u3002\u5f53\u91c7\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u79bb\u5f00\u672c\u6b21\u72b6\u6001\u524d\uff0c\u5fc5\u987b\u5b8c\u6210\u901a\u9053\u95f4\u7684\u53bb\u504f\u659c\u64cd\u4f5c\u3002\u8bbe\u5907\u5fc5\u987b\u5728\u5176\u63a5\u6536\u7684 TS2 \u4e2d\uff0c\u63d0\u53d6\u5e76\u4fdd\u5b58\u5bf9\u7aef\u6240\u652f\u6301\u7684\u901f\u7387\u6807\u8bc6\u7b26\uff0c\u5e76\u8986\u76d6\u5148\u524d\u7684\u91c7\u6837\u503c\u3002\u5f53\u91c7\u7528 128b/130b \u7f16\u7801\u65f6\uff0c\u8bbe\u5907\u5fc5\u987b\u8bb0\u5f55 TS2 \u4e2d\u7684 Request Equalization \u6bd4\u7279\uff0c\u7528\u4e8e\u540e\u7eed\u4f7f\u7528\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\u5728\u8be5\u6b21\u72b6\u6001\u4e2d\uff0c\u5185\u90e8\u53d8\u91cf successful_speed_negotiation \u4f1a\u88ab\u8bbe\u7f6e\u4e3a 1b\u3002\u5982\u679c TS2 \u4e2d\u7684 speed_change \u6bd4\u7279\u4e3a 1b\uff0c\u90a3\u4e48\u5176\u643a\u5e26\u7684\u901f\u7387\u6807\u8bc6\u7b26\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u4ee5\u5907\u540e\u7eed\u4f7f\u7528\u3002\u5982\u540c\u5728 Recovery.Speed \u72b6\u6001\u4e2d\uff0c\u4f1a\u4ece\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\uff08Link Status register\uff09\u4e2d\u8bb0\u5f55 Autonomous Change \u6bd4\u7279\u7684\u503c\u4e00\u6837\u3002Recovery.Speed \u72b6\u6001\u4e2d\u4f1a\u5c06\u65b0\u901f\u7387\u8bbe\u5b9a\u4e3a\u53cc\u65b9\u5171\u540c\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u3002\u6709\u8da3\u7684\u662f\uff0c\u5c31\u7b97\u5f53\u524d\u94fe\u8def\u901f\u7387\u5df2\u7ecf\u662f\u6700\u9ad8\u7684 8GT/s \uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ecd\u7136\u4f1a\u8fdb\u5165 Recovery.Speed \u72b6\u6001\uff0c\u5c3d\u7ba1\u6b64\u65f6\u901f\u7387\u4e0d\u4f1a\u53d1\u751f\u4efb\u4f55\u53d8\u5316\u3002</p> <p>\u5982\u679c\u901f\u7387\u5373\u5c06\u88ab\u8f6c\u6362\u4e3a 8GT/s\uff0c\u90a3\u4e48\u5728\u672c\u6b21\u72b6\u6001\u4e2d DSP \u9700\u8981\u53d1\u9001 EQ TS2 \uff08\u7b26\u53f7 6 \u7684\u6bd4\u7279 7 \u7f6e\u4e3a 1b\uff0c\u8868\u793a\u8fd9\u662f\u4e00\u4e2a EQ \u8bad\u7ec3\u5e8f\u5217\uff09\u5e8f\u5217\u3002\u8fd9\u79cd\u60c5\u51b5\u4f1a\u5728\u4ee5\u4e0b\u6761\u4ef6\u6ee1\u8db3\u65f6\u53d1\u751f\uff1a\u53cc\u65b9\u5171\u540c\u652f\u6301 8.0 GT/s \uff0c\u5e76\u4e14\u53cc\u65b9\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u90fd\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684\uff0cspeed_change \u6bd4\u7279\u4e3a 1 \u7684 TS 1 \u6216\u8005 TS2 \u5e8f\u5217\uff1b\u6216\u8005\u5185\u90e8\u53d8\u91cf equalization_done_8GT_data_rate \u8bbe\u7f6e\u4e3a 0b \u65f6\uff1b\u6216\u8005\u4e0a\u5c42\u903b\u8f91\u8981\u6c42\u8fd9\u4e48\u505a\u65f6\u3002UPS \u53ef\u4ee5\u4f7f\u80fd Request Equalization \u6bd4\u7279\uff0c\u5982\u679c\u5f53\u524d\u901f\u7387\u4e3a 8GT/s\uff0c\u4f46\u662f\u5b58\u5728\u4e0e\u5747\u8861\u8fc7\u7a0b\u76f8\u5173\u7684\u95ee\u9898\u65f6\u3002\u94fe\u8def\u53cc\u65b9\u4efb\u610f\u7aef\u53e3\u90fd\u53ef\u4ee5\u901a\u8fc7\u7f6e\u4f4d Request Equalization \u6bd4\u7279\u4ee5\u53ca  Quiesce Guarantee \u6bd4\u7279\u4e3a 1b \u8981\u6c42\u518d\u6b21\u8fdb\u884c\u5747\u8861\u3002</p> <p>USP \u57fa\u4e8e\u63a5\u6536\u5230\u7684 TS2 \u4e2d\u7684 Selectable Deemphasis \u6bd4\u7279\uff0c\u66f4\u65b0\u5b83\u4eec\u7684 select_deemphasis \u53d8\u91cf\u3002\u5982\u679c\u63a5\u6536\u5230\u7684 TS2 \u662f EQ TS2\uff0c\u90a3\u4e48 USP \u4f1a\u5c06\u5185\u90e8\u53d8\u91cf start_equalization_w_preset \u8bbe\u7f6e\u4e3a 1b\uff0c\u5e76\u66f4\u65b0\u5404\u901a\u9053\u7684\u5747\u8861\u5bc4\u5b58\u5668\u6570\u503c\uff08\u6bd4\u5982\u66f4\u65b0\u5bc4\u5b58\u5668\u4e2d\u7684 USP \u53d1\u9001 Preset \u548c\u63a5\u6536 Preset Hint \u4fe1\u606f\uff09\u3002\u4efb\u4f55\u6ca1\u6709\u63a5\u6536\u5230 EQ TS2 \u7684\u901a\u9053\u4f1a\u57fa\u4e8e\u5177\u4f53\u5b9e\u73b0\u9009\u62e9\u5b83\u4eec\u7528\u4e8e 8GT/s \u901f\u7387\u7684 Preset \u6570\u503c\u3002\u5f53 DSP \u7684\u5185\u90e8\u53d8\u91cf equalization_done_8GT_data_rate \u6e05\u9664\u4e3a 0b \u6216\u8005\u4e0a\u5c42\u903b\u8f91\u8981\u6c42\u8fd9\u4e48\u505a\u65f6\uff0cDSP \u5c06\u53d8\u91cf start_equalization_w_preset \u7f6e\u4e3a 1b\u3002</p> <p>\u6700\u540e\uff0c\u5982\u679c\u4f7f\u7528\u7684\u662f 128b/130b \u7f16\u7801\uff0c\u8bbe\u5907\u9700\u8981\u6ce8\u610f\u5230\u63a5\u6536\u7684 Request Equalization \u6bd4\u7279\uff0c\u5982\u679c\u8be5\u6bd4\u7279\u4e3a 1b\uff0c\u90a3\u4e48\u8fde\u540c\u8be5\u6bd4\u7279\u548c Quiesce Guarantee \u6bd4\u7279\u90fd\u5fc5\u987b\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u4ee5\u4f9b\u672a\u6765\u4f7f\u7528\u3002</p> <p>\u8f6c\u6362\u81f3  Recovery.Idle \u72b6\u6001</p> <p>\u5982\u679c\u4e0b\u8ff0\u4e24\u4e2a\u6761\u4ef6\u90fd\u5f97\u5230\u6ee1\u8db3\uff0c\u90a3\u4e48\u8f6c\u79fb\u81f3 Recovery.Idle \u72b6\u6001\uff1a</p> <ul> <li>\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS2 \u5e8f\u5217\uff0c\u5176\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u3001\u901f\u7387\u6807\u8bc6\u7b26\u90fd\u4e0e\u53d1\u9001\u7684\u6570\u503c\u4fdd\u6301\u4e00\u81f4\uff0c\u5e76\u4e14</li> <li>TS2 \u4e2d\u7684 speed_change \u6bd4\u7279\u5df2\u7ecf\u88ab\u6e05\u9664\u4e3a 0b\uff0c\u6216\u8005</li> <li>\u53cc\u65b9\u6ca1\u6709\u9ad8\u4e8e 2.5GT/s \u7684\u5171\u540c\u652f\u6301\u901f\u7387</li> <li>\u5728\u63a5\u6536\u5230 TS2 \u5e8f\u5217\u540e\uff0c\u5df2\u7ecf\u53d1\u9001\u4e86 16 \u4e2a TS2 \u5e8f\u5217\uff0c\u5e76\u4e14\u6ca1\u6709\u88ab\u4efb\u4f55 EIEOS \u6253\u65ad\u3002\u8fdb\u5165\u4e0b\u4e2a\u72b6\u6001\u65f6\uff0c\u53d8\u91cf changed_speed_recovery \u548c directed_speed_change \u5df2\u7ecf\u88ab\u6e05\u9664\u4e3a 0b\u3002</li> </ul> <p>\u8f6c\u6362\u81f3  Recovery.Speed \u72b6\u6001</p> <p>LTSSM \u4f1a\u8f6c\u79fb\u81f3 Recovery.Speed \u72b6\u6001\uff0c\u5982\u679c\u4e0b\u8ff0\u4e09\u4e2a\u6761\u4ef6\u90fd\u5f97\u5230\u6ee1\u8db3\uff1a</p> <ul> <li>\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS2 \u5e8f\u5217\uff0c\u5176\u901f\u7387\u6807\u8bc6\u7b26\u4ee5\u53ca\u7b26\u53f7 6 \u7684\u6570\u503c\u90fd\u548c\u53d1\u9001\u6570\u503c\u4fdd\u6301\u4e00\u81f4\uff0c\u5e76\u4e14 speed_change \u6bd4\u7279\u4e3a 1b\uff0c\u5e76\u4e14\uff1a</li> <li>\u8be5 TS2 \u4e3a\u6807\u51c6\u7684 8b/10b TS2\uff0c\u6216\u8005</li> <li>\u8be5 TS2 \u4e3a EQ TS2\uff0c\u6216\u8005</li> <li>\u5728\u4efb\u4f55\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 EQ TS2 \u540e\uff0c\u5df2\u7ecf\u8fc7\u53bb\u4e86 1ms</li> <li>\u94fe\u8def\u53cc\u65b9\u652f\u6301\u7684\u5171\u540c\u6700\u9ad8\u901f\u7387\u9ad8\u4e8e  2.5GT/s\uff0c\u6216\u8005\u94fe\u8def\u7684\u901f\u7387\u5df2\u7ecf\u9ad8\u4e8e  2.5GT/s\u3002</li> <li>\u5f53\u91c7\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u5728\u63a5\u6536\u5230 speed_change \u6bd4\u7279\u4e3a 1 \u7684 TS2 \u5e8f\u5217\u540e\uff0c\u5df2\u7ecf\u5728\u8be5\u901a\u9053\u4e0a\u53d1\u9001\u4e86\u81f3\u5c11 32 \u4e2a speed_change \u6bd4\u7279\u4e3a 1 \u7684 TS2 \u5e8f\u5217\uff0c\u5e76\u4e14\u6ca1\u6709\u88ab\u4efb\u4f55 EIEOS \u6253\u65ad\u3002\u5f53\u91c7\u7528 128b/130b \u7f16\u7801\u65f6\uff0c\u5728\u63a5\u6536\u5230 speed_change \u6bd4\u7279\u4e3a 1 \u7684 TS2 \u5e8f\u5217\u540e\uff0c\u5df2\u7ecf\u5728\u8be5\u901a\u9053\u4e0a\u53d1\u9001\u4e86\u81f3\u5c11 128 \u4e2a speed_change \u6bd4\u7279\u4e3a 1 \u7684 TS2 \u5e8f\u5217\uff0c\u5e76\u4e14\u6ca1\u6709\u88ab\u4efb\u4f55 EIEOS \u6253\u65ad\u3002</li> </ul> <p>LTSSM \u8df3\u8f6c\u5230 Recovery.Speed \u72b6\u6001\u4e5f\u53ef\u80fd\u662f\u8fd9\u4e48\u4e00\u79cd\u60c5\u51b5\uff1a\u94fe\u8def\u53cc\u65b9\u81ea\u4ece L0 \u6216\u8005 L1 \u72b6\u6001\u8fdb\u5165 Recovery \u72b6\u6001\u540e\uff0c\u94fe\u8def\u53cc\u65b9\u5df2\u7ecf\u5c06\u94fe\u8def\u901f\u7387\u534f\u5546\u4e3a\u66f4\u9ad8\u7684\u901f\u7387\uff08changed_speed_recovery = 1b\uff09\u3002\u4f46\u662f\u5728\u67d0\u4e2a\u901a\u9053\u4e0a\u63a5\u6536\u5230 EIOS \u6216\u8005\u68c0\u6d4b\u5230\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u5e76\u4e14\u5728\u8fdb\u5165\u672c\u72b6\u6001\u540e\u672a\u63a5\u6536\u5230\u4efb\u4f55 TS2 \u5e8f\u5217\u3002\u8fd9\u4ee3\u8868\u94fe\u8def\u53cc\u65b9\u5c1d\u8bd5\u5207\u6362\u5230\u66f4\u9ad8\u7684\u94fe\u8def\u901f\u7387\uff0c\u4f46\u662f\u94fe\u8def\u5bf9\u7aef\u4f19\u4f34\u8868\u793a\u56e0\u4e3a\u67d0\u79cd\u539f\u56e0\uff0c\u5176\u5728\u65b0\u7684\u901f\u7387\u4e0b\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u65b0\u7684\u901f\u7387\u4f1a\u8fd4\u56de\u5230\u94fe\u8def\u8fdb\u5165\u5230 Recovery \u72b6\u6001\u4e4b\u524d\u7684\u901f\u7387\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u8df3\u8f6c\u5230 Recovery.Speed \u72b6\u6001\u7684\u60c5\u51b5\u662f\uff1a\u94fe\u8def\u53cc\u65b9\u81ea\u4ece L0 \u6216\u8005 L1 \u72b6\u6001\u8fdb\u5165 Recovery \u72b6\u6001\u540e\uff0c\u94fe\u8def\u53cc\u65b9*\u6ca1\u80fd*\u5c06\u94fe\u8def\u901f\u7387\u534f\u5546\u4e3a\u66f4\u9ad8\u7684\u901f\u7387\uff08changed_speed_recovery = 0b\uff09\uff0c\u4e0d\u8fc7\u6b64\u65f6\u94fe\u8def\u7684\u901f\u7387\u9ad8\u4e8e  2.5GT/s\uff0c\u4f46\u662f\u5728\u67d0\u4e2a\u901a\u9053\u4e0a\u63a5\u6536\u5230 EIOS \u6216\u8005\u68c0\u6d4b\u5230\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u5e76\u4e14\u5728\u8fdb\u5165\u672c\u72b6\u6001\u540e\u672a\u63a5\u6536\u5230\u4efb\u4f55 TS2 \u5e8f\u5217\u3002\u8fd9\u79cd\u60c5\u51b5\u8868\u793a\u94fe\u8def\u5728\u5f53\u524d\u901f\u7387\u4e0b\u65e0\u6cd5\u5de5\u4f5c\uff0c\u89e3\u51b3\u7684\u529e\u6cd5\u662f\u628a\u65b0\u7684\u901f\u7387\u964d\u4f4e\u56de\u5230\u6700\u4f4e\u7684 2.5GT/s\u3002</p> <p>\u8f6c\u6362\u81f3 Configuration\u72b6\u6001</p> <p>\u5982\u679c\u5728\u4efb\u610f\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\uff0c\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 TS1 \u5e8f\u5217\uff0c\u5176\u94fe\u8def\u7f16\u53f7\u6216\u8005\u901a\u9053\u7f16\u53f7\u548c\u53d1\u9001\u7684\u6570\u503c\u4e0d\u4e00\u81f4\uff0c\u5e76\u4e14 speed_change \u6bd4\u7279\u4e3a 0b\uff0c\u6216\u8005\u4e0d\u5171\u540c\u652f\u6301\u9ad8\u4e8e 2.5GT/s \u7684\u901f\u7387\u3002</p> <p>\u8fdb\u5165 Configuration \u72b6\u6001\u524d\uff0c\u5185\u90e8\u53d8\u91cf changed_speed_recovery \u548c directed_speed_change \u4f1a\u6e05\u9664\u4e3a 0b\u3002\u5982\u679c N_FTS \u53d8\u91cf\u6709\u66f4\u65b0\uff0c\u90a3\u4e48\u66f4\u65b0\u540e\u7684\u6570\u503c\u5fc5\u987b\u7528\u4e8e\u540e\u7eed\u7684 L0s \u72b6\u6001\u3002</p> <p>\u8f6c\u6362\u81f3 Detect\u72b6\u6001</p> <p>\u5982\u679c 48ms \u8d85\u65f6\u540e\uff0c\u4e0a\u8ff0\u5404\u79cd\u72b6\u6001\u8f6c\u6362\u7684\u6761\u4ef6\u90fd\u6ca1\u6709\u88ab\u6ee1\u8db3\uff0c\u90a3\u4e48\u5728  2.5GT/s \u6216\u8005 5GT/s \u901f\u7387\u65f6\uff0c\u72b6\u6001\u4f1a\u8f6c\u79fb\u4e3a Detect\u3002</p> <p>\u5982\u679c\u901f\u7387\u4e3a  8GT/s\uff0c\u90a3\u4e48\u8fd8\u5b58\u5728\u4e00\u79cd\u53ef\u80fd\u7684\u72b6\u6001\u8f6c\u79fb\u884c\u4e3a\uff0c\u90a3\u5c31\u662f\u867d\u7136\u672c\u6b21\u901f\u7387\u6539\u53d8\u5931\u8d25\u4e86\uff0c\u4f46\u662f\u901f\u7387\u6539\u53d8\u7684\u53ef\u5c1d\u8bd5\u6b21\u6570\u8fd8\u6ca1\u6709\u7528\u5b8c\uff0c\u8fd9\u4e00\u70b9\u7531\u53d8\u91cf idle_to_rlock_transitioned \u7684\u6570\u503c\u6240\u53cd\u5e94\u3002\u5982\u679c\u901f\u7387\u4e3a  8GT/s \u65f6\uff0c\u53d8\u91cf idle_to_rlock_transitioned \u6570\u503c\u5c0f\u4e8e FFh\uff0c\u90a3\u4e48\u65b0\u7684\u72b6\u6001\u4f1a\u662f Recovery.Idle\u3002\u5728\u72b6\u6001\u8df3\u8f6c\u540e\uff0c\u53d8\u91cf changed_speed_recovery \u548c directed_speed_change \u8fd8\u662f\u4f1a\u88ab\u6e05\u9664\u4e3a 0b\u3002\u7136\u800c\uff0c\u4e00\u65e6\u53d8\u91cf idle_to_rlock_transitioned \u6570\u503c\u8fbe\u5230 FFh\uff0c\u90a3\u4e48\u5f53 48ms \u8d85\u65f6\u89e6\u53d1\u540e\uff0c\u4e0b\u4e00\u4e2a\u72b6\u6001\u5c06\u4f1a\u662f Detect\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14864-recoveryidle","title":"14.8.6.4 Recovery.Idle","text":"<p>\u6b63\u5982\u540d\u5b57\u4f53\u73b0\u5730\u90a3\u6837\uff0c\u53d1\u9001\u7aef\u4f1a\u5728\u8be5\u6b21\u72b6\u6001\u5185\u53d1\u9001 Idle \u5e8f\u5217\uff0c\u4f5c\u4e3a\u8fdb\u5165\u6b63\u5e38\u5de5\u4f5c L0 \u72b6\u6001\u4e4b\u524d\u7684\u51c6\u5907\u3002\u5f53\u91c7\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u4f1a\u6b63\u5e38\u5730\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001 Idle \u6570\u636e\u3002\u5f53\u91c7\u7528 128b/130b \u7f16\u7801\u65f6\uff0c\u4f1a\u9996\u5148\u53d1\u9001\u4e00\u4e2a SDS \u5e8f\u5217\u6765\u5f00\u59cb\u4e00\u6bb5\u6570\u636e\u6d41\uff0c\u63a5\u4e0b\u6765\u624d\u4f1a\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001 Idle \u7b26\u53f7\u3002</p> <p>\u8f6c\u6362\u81f3 L0 \u72b6\u6001</p> <p>\u5982\u679c\u4e0b\u8ff0\u6761\u4ef6\u4e4b\u4e00\u6ee1\u8db3\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u72b6\u6001\u662f L0\u3002\u5728\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u81ea\u4e0a\u6b21\u4ece Recovery \u72b6\u6001\u6216\u8005 Configuration \u72b6\u6001\u8fdb\u5165 L0 \u72b6\u6001\u540e\uff0c\u66fe\u7ecf\u8bbe\u7f6e\u8fc7\u94fe\u8def\u91cd\u8bad\u7ec3\u6bd4\u7279\uff08Retrain Link bit\uff09\uff0c\u90a3\u4e48 DSP \u4f1a\u5c06\u94fe\u8def\u5e26\u5bbd\u7ba1\u7406\u72b6\u6001\u6bd4\u7279\u5199\u4e3a 1b\uff08\u5982\u539f\u6587 597 \u9875\u56fe 14-39 \u6240\u793a\uff09\u3002</p> <ul> <li> <p>\u5f53\u91c7\u7528 8b/10b \u7f16\u7801\u65f6\uff0c\u5f53\u63a5\u6536\u5230\u8fde\u7eed 8 \u4e2a\u5468\u671f\u7a7a\u95f2\u6570\u636e\u540e\uff0c\u5e76\u4e14\u5728\u63a5\u6536\u5230\u7b2c\u4e00\u4e2a\u7a7a\u95f2\u6570\u636e\u7b26\u53f7\u540e\uff0c\u5df2\u7ecf\u53d1\u9001\u4e86 16 \u4e2a\u7a7a\u95f2\u6570\u636e\u7b26\u53f7\u3002</p> </li> <li> <p>\u5f53\u91c7\u7528 128b/130b \u7f16\u7801\u65f6\uff0c\u5f53\u63a5\u6536\u5230\u8fde\u7eed 8 \u4e2a\u5468\u671f\u7a7a\u95f2\u6570\u636e\u540e\uff0c\u5e76\u4e14\u5728\u63a5\u6536\u5230\u7b2c\u4e00\u4e2a\u7a7a\u95f2\u6570\u636e\u7b26\u53f7\u540e\uff0c\u5df2\u7ecf\u53d1\u9001\u4e86 16 \u4e2a\u7a7a\u95f2\u6570\u636e\u7b26\u53f7\uff0c\u5e76\u4e14\u6ce8\u610f\u5230\u4e0d\u80fd\u4ece Recovery.RcvrCfg \u72b6\u6001\u76f4\u63a5\u8fdb\u5165 L0 \u72b6\u6001\u3002\u53e6\u5916\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a\u7a7a\u95f2\u6570\u636e\u5fc5\u987b\u5305\u62ec\u5728\u6570\u636e\u5757\u4e2d\uff0c\u901a\u9053\u95f4\u53bb\u504f\u659c\u5fc5\u987b\u5728\u6570\u636e\u6d41\u5f00\u59cb\u4f20\u8f93\u524d\u5b8c\u6210\uff0c\u6700\u540e\uff0c\u5728\u8fdb\u5165 L0 \u72b6\u6001\u65f6\uff0c\u53d8\u91cf idle_to_rlock_transitioned \u6e05\u9664\u4e3a 00h\u3002</p> </li> </ul> <p>\u8f6c\u6362\u81f3 Configuration\u72b6\u6001</p> <p>\u5982\u679c\u4ee5\u4e0b\u6761\u4ef6\u4e4b\u4e00\u6ee1\u8db3\uff0c\u90a3\u4e48\u8fdb\u5165 Configuration \u72b6\u6001\uff1a</p> <ul> <li>\u7aef\u53e3\u53d7\u5230\u4e0a\u5c42\u903b\u8f91\u7684\u6307\u4ee4\uff0c\u53ef\u9009\u5730\u91cd\u65b0\u914d\u7f6e\u94fe\u8def\uff0c\u6bd4\u5982\u6539\u53d8\u94fe\u8def\u5bbd\u5ea6\u3002</li> <li>\u4efb\u610f\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\uff0c\u63a5\u6536\u5230\u4e24\u4e2a\u8fde\u7eed\u7684 TS1\uff0c\u5176\u4e2d\u901a\u9053\u7f16\u53f7\u4e3a PAD\uff08\u5982\u679c\u5bf9\u7aef\u8fdb\u5165 Configuration \u72b6\u6001\u4ee5\u6539\u53d8\u94fe\u8def\u65f6\uff0c\u4f1a\u5728\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u901a\u9053\u7f16\u53f7\u4e3a PAD \u7684 TS1\uff09\u3002\u534f\u8bae\u5efa\u8bae LTSSM \u6b64\u65f6\u76f4\u63a5\u8f6c\u6362\u8fdb\u5165 Configuration \u72b6\u6001\u6539\u53d8\u94fe\u8def\u5bbd\u5ea6\uff0c\u4ee5\u8282\u7ea6\u6539\u53d8\u6240\u9700\u8981\u7684\u65f6\u95f4\u3002</li> </ul> <p>\u8f6c\u6362\u81f3 Disable \u72b6\u6001</p> <p>\u5982\u679c\u4ee5\u4e0b\u6761\u4ef6\u4e4b\u4e00\u6ee1\u8db3\uff0c\u90a3\u4e48\u8fdb\u5165 Disable \u72b6\u6001\uff1a</p> <ul> <li>\u94fe\u8def\u5bf9\u7aef\u7684 DSP \u6216\u8005\uff0c\u53ef\u9009\u652f\u6301\u7684 crosslink \u7aef\u53e3\u53d7\u5230\u4e0a\u5c42\u903b\u8f91\u7684\u6307\u4ee4\uff0c\u5728\u6240\u53d1\u9001\u7684 TS\u00bd \u4e2d\u4f7f\u80fd\u94fe\u8def\u5173\u95ed\uff08Disable Link\uff09\u6bd4\u7279\u3002</li> <li>USP \u6216\u8005\uff0c\u53ef\u9009\u652f\u6301\u7684 crosslink \u7aef\u53e3\u5728\u4efb\u610f\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230\u7684\u8fde\u7eed\u4e24\u4e2a TS1 \u4e2d\u7684\u94fe\u8def\u5173\u95ed\uff08Disable Link\uff09\u6bd4\u7279\u90fd\u4e3a 1b\u3002 </li> </ul> <p>\u8f6c\u6362\u81f3 Hot Reset\u72b6\u6001</p> <p>\u5982\u679c\u4ee5\u4e0b\u6761\u4ef6\u4e4b\u4e00\u6ee1\u8db3\uff0c\u90a3\u4e48\u8fdb\u5165 Hot Reset \u72b6\u6001\uff1a</p> <ul> <li>\u94fe\u8def\u5bf9\u7aef\u7684 DSP \u6216\u8005\uff0c\u53ef\u9009\u652f\u6301\u7684 crosslink \u7aef\u53e3\u53d7\u5230\u4e0a\u5c42\u903b\u8f91\u7684\u6307\u4ee4\uff0c\u5728\u6240\u53d1\u9001\u7684 TS\u00bd \u4e2d\u4f7f\u80fd Hot Reset\u6bd4\u7279\u3002</li> <li>USP \u6216\u8005\uff0c\u53ef\u9009\u652f\u6301\u7684 crosslink \u7aef\u53e3\u5728\u4efb\u610f\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230\u7684\u8fde\u7eed\u4e24\u4e2a TS1 \u4e2d\u7684 Hot Reset \u6bd4\u7279\u90fd\u4e3a 1b\u3002 </li> </ul> <p>\u8f6c\u6362\u81f3 Loopback \u72b6\u6001</p> <p>\u5982\u679c\u4ee5\u4e0b\u6761\u4ef6\u4e4b\u4e00\u6ee1\u8db3\uff0c\u90a3\u4e48\u8fdb\u5165Loopback \u72b6\u6001\uff1a</p> <ul> <li>\u53d1\u9001\u7aef\u786e\u5b9a\u81ea\u5df1\u6709\u6210\u4e3a Loopback \u4e3b\u673a\u7684\u80fd\u529b\uff08\u7ec6\u8282\u7531\u5177\u4f53\u5b9e\u73b0\u51b3\u5b9a\uff0c\u534f\u8bae\u6ca1\u6709\u63d0\u4f9b\u5177\u4f53\u7684\u65b9\u5f0f\u53bb\u9a8c\u8bc1\u8fd9\u4e00\u70b9\uff09\u5e76\u53d7\u5230\u4e0a\u5c42\u903b\u8f91\u7684\u6307\u4ee4\uff0c\u5728\u6240\u53d1\u9001\u7684 TS\u00bd \u4e2d\u4f7f\u80fd Loopback \u6bd4\u7279\u3002</li> <li>USP \u6216\u8005\uff0c\u53ef\u9009\u652f\u6301\u7684 crosslink \u7aef\u53e3\u5728\u4efb\u610f\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230\u7684\u8fde\u7eed\u4e24\u4e2a TS1 \u4e2d\u7684 Loopback \u6bd4\u7279\u90fd\u4e3a 1b\u3002 \u63a5\u6536\u65b9\u6210\u4e3a Loopback \u4ece\u673a\u3002</li> </ul> <p>\u8f6c\u6362\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c\u4e0a\u8ff0\u6761\u4ef6\u90fd\u6ca1\u6709\u5f97\u5230\u6ee1\u8db3\uff0c\u90a3\u4e48\u5728 2ms \u8d85\u65f6\u89e6\u53d1\u540e\uff0c\u8f6c\u5165 Detect \u72b6\u6001\u3002\u9664\u975e idle_to_rlock_transitioned \u53d8\u91cf\u6570\u503c\u5c0f\u4e8e FFh\uff0c\u6b64\u65f6\u8f6c\u5165 Recovery \u76f8\u5173\u72b6\u6001\u3002\u5f53\u8f6c\u5165 Recovery.RcvrLock \u72b6\u6001\u65f6\uff0c\u5982\u679c\u6570\u636e\u901f\u7387\u4e3a 8.0 GT/s \u65f6\uff0cidle_to_rlock_transitioned \u53d8\u91cf\u503c\u9012\u589e 1b\uff0c\u5982\u679c\u6570\u636e\u901f\u7387\u4e3a  5.0 GT/s \u6216\u8005 2.5 GT/s\uff0c\u90a3\u4e48\u8be5\u53d8\u91cf\u6570\u503c\u8bbe\u7f6e\u4e3a FFh\u3002 </p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#149-l0s-state-l0s","title":"14.9 L0s State // L0s \u72b6\u6001","text":"<p>L0s \u662f\u4e00\u4e2a\u4f4e\u529f\u8017\u94fe\u8def\u72b6\u6001\uff0cL0s \u8fd4\u56de L0 \u72b6\u6001\u7684\u9000\u51fa\u5ef6\u8fdf\u6700\u77ed\u3002\u8bbe\u5907\u901a\u8fc7\u786c\u4ef6\u903b\u8f91\u81ea\u52a8\u63a7\u5236\u8fdb\u51fa L0s \u72b6\u6001\u7684\u884c\u4e3a\uff0c\u65e0\u9700\u8f6f\u4ef6\u53c2\u4e0e\u3002\u94fe\u8def\u53cc\u65b9\u90fd\u53ef\u4ee5\u5355\u72ec\u5730\u8fdb\u5165\u6216\u8005\u9000\u51fa L0s \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1491-l0s","title":"14.9.1 L0s \u53d1\u9001\u7aef\u72b6\u6001\u673a","text":"<p>\u94fe\u8def\u5730\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u6709\u4e0d\u540c\u7684 L0s \u6b21\u72b6\u6001\uff0c\u9996\u5148\u8ba8\u8bba\u53d1\u9001\u7aef\u7684 L0s \u5404\u6b21\u72b6\u6001\u3002\u5982\u539f\u6587 603 \u9875\u5730\u56fe 14-40 \u6240\u793a\uff0cL0s \u72b6\u6001\u7684\u53d1\u9001\u7aef\u72b6\u6001\u673a\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u7ed3\u6784\u3002</p> <p></p> <p>\u56fe 14-40 L0s \u53d1\u9001\u7aef\u72b6\u6001\u673a</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14911-tx_l0sentry","title":"14.9.1.1 Tx_L0s.Entry. \u72b6\u6001","text":"<p>\u53d1\u9001\u7aef\u5728\u4e0a\u5c42\u903b\u8f91\u7684\u547d\u4ee4\u4e0b\u8fdb\u5165 L0s \u72b6\u6001\u3002\u534f\u8bae\u6ca1\u6709\u5177\u4f53\u89c4\u5b9a\u53d1\u9001\u7aef\u8fdb\u5165 L0s \u72b6\u6001\u7684\u6761\u4ef6\uff0c\u4f46\u76f4\u89c2\u5730\u8bf4\uff0c\u53d1\u9001\u7aef\u4f1a\u5728\u7a7a\u95f2\u72b6\u6001\u6301\u7eed\u4e00\u6bb5\u65f6\u95f4\u540e\u8fdb\u5165 L0s \u72b6\u6001\uff1a\u8fd9\u6bb5\u65f6\u95f4\u5185\u6ca1\u6709\u53d1\u9001\u8fc7 TLP \u6216\u8005 DLLP\u3002\u4e3a\u4e86\u8fdb\u5165 L0s \u72b6\u6001\uff0c\u53d1\u9001\u7aef\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a EIOS \uff085GT/s \u901f\u7387\u4e0b\u53d1\u9001\u4e24\u4e2a EIOS\uff09\uff0c\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u7136\u800c\uff0c\u6b64\u65f6\u53d1\u9001\u7aef\u8fd8\u6ca1\u6709\u771f\u6b63\u5173\u95ed\uff0c\u5e76\u4e14\u9700\u8981\u7ef4\u6301\u5171\u6a21\u7535\u538b\u5728\u534f\u8bae\u89c4\u5b9a\u7684\u8303\u56f4\u5185\u3002</p> <p>\u8f6c\u79fb\u81f3 Tx_L0s.Idle. \u72b6\u6001</p> <p>\u5728\u7ecf\u8fc7  T TX\u2010IDLE\u2010MIN \uff0820ns\uff09\u65f6\u957f\u540e\uff0c\u8fdb\u5165 Tx_L0s.Idle. \u72b6\u6001\u3002\u8fd9\u6bb5\u5ef6\u65f6\u662f\u4e3a\u4e86\u786e\u4fdd\u53d1\u9001\u7aef\u5df2\u7ecf\u8fdb\u5165\u4e86\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14912-tx_l0sidle","title":"14.9.1.2 Tx_L0s.Idle. \u72b6\u6001","text":"<p>\u5728\u8be5\u6b21\u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u7aef\u7ee7\u7eed\u4fdd\u6301\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u76f4\u5230\u6709\u4e0a\u5c42\u903b\u8f91\u547d\u4ee4\u9000\u51fa\u4e3a\u6b62\u3002\u56e0\u4e3a\u8fd9\u4e2a\u65b9\u5411\u7684\u94fe\u8def\u5904\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u6240\u4ee5\u80fd\u591f\u8282\u7ea6\u4e00\u4e9b\u80fd\u8017\uff0c\u8282\u80fd\u662f L0s \u72b6\u6001\u7684\u4e3b\u8981\u4f5c\u7528\u3002</p> <p>\u8f6c\u79fb\u81f3 Tx_L0s.FTS. \u72b6\u6001</p> <p>\u5728\u4e0a\u5c42\u903b\u8f91\u7684\u547d\u4ee4\u4e0b\uff0c\u72b6\u6001\u673a\u4f1a\u8f6c\u79fb\u81f3 Tx_L0s.FTS. \u72b6\u6001\uff0c\u6bd4\u5982\u4e0a\u5c42\u9700\u8981\u6062\u590d\u62a5\u6587\u53d1\u9001\u65f6\u3002LTSSM \u5177\u4f53\u9000\u51fa\u8be5\u72b6\u6001\u7684\u65b9\u5f0f\uff0c\u7531\u8bbe\u8ba1\u5b9e\u73b0\u51b3\u5b9a\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14913-tx_l0sfts","title":"14.9.1.3 Tx_L0s.FTS. \u72b6\u6001","text":"<p>\u5728\u8be5\u6b21\u72b6\u6001\u4e2d\uff0c\u53d1\u9001\u7aef\u4f1a\u5f00\u59cb\u4e0d\u65ad\u53d1\u9001 FTS \u6709\u5e8f\u96c6\uff0c\u4ee5\u8bad\u7ec3\u94fe\u8def\u5bf9\u7aef\u7684\u63a5\u6536\u7aef\u3002\u6240\u53d1\u9001\u7684 FTS \u6709\u5e8f\u96c6\u6570\u91cf\u53d6\u81ea\u5bf9\u65b9\u5728\u4e0a\u6b21\u8fdb\u5165 L0 \u72b6\u6001\u7684\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u9001\u7684 TS \u8bad\u7ec3\u4e2d\u901a\u544a\u7684 N_FTS \u5b57\u6bb5\u3002\u534f\u8bae\u4e2d\u63d0\u5230\u4e00\u70b9\uff0c\u5982\u679c\u5bf9\u65b9\u54cd\u5e94\u8d85\u65f6\uff0c\u90a3\u4e48\u53d1\u9001\u7aef\u53ef\u80fd\u4f1a\u589e\u52a0\u53d1\u9001\u7684 FTS \u6709\u5e8f\u96c6\u6570\u91cf\uff0c\u8d85\u8fc7 Recovery \u72b6\u6001\u4e2d\u5bf9\u7aef\u901a\u544a\u7684 N_FTS \u6570\u91cf\u3002</p> <p>\u5982\u679c Extened Synch \u6bd4\u7279\u7f6e\u4f4d\uff08\u5982\u539f\u6587 644 \u9875\u56fe 14-71 \u6240\u793a\uff09\uff0c\u53d1\u9001\u7aef\u5fc5\u987b\u53d1\u9001 4096 \u4e2a FTS \u6709\u5e8f\u96c6\uff0c\u800c\u4e0d\u662f N_FTS \u4e2a\u3002\u8be5\u7279\u6027\u4e3a\u540c\u6b65\u5916\u90e8\u6d4b\u8bd5\u548c\u5206\u6790\u8bbe\u5907\u62d3\u5c55\u4e86\u6240\u9700\u7684\u540c\u6b65\u65f6\u95f4\uff0c\u5b83\u4eec\u53ef\u80fd\u65e0\u6cd5\u50cf\u6b63\u5e38\u7684\u5bf9\u7aef\u8bbe\u5907\u90a3\u6837\uff0c\u5728\u8f83\u77ed\u7684\u65f6\u95f4\u5185\u6062\u590d\u6bd4\u7279\u9501\u5b9a\u3002</p> <p>\u5728\u4efb\u4f55\u901f\u7387\u4e0b\uff0c\u4e0d\u80fd\u5728 FTS \u5e8f\u5217\u4e4b\u524d\u53d1\u9001 SOS \u5e8f\u5217\u3002\u7136\u540e\uff0c\u5728 5GT/s \u901f\u7387\u65f6\uff0c\u5fc5\u987b\u5728 FTS \u5e8f\u5217\u4e4b\u524d\u53d1\u9001 4 \u5230 8 \u4e2a EIE \u7b26\u53f7\u3002\u5728 128b/130b \u7f16\u7801\u65f6\uff0c\u5fc5\u987b\u5728 FTS \u5e8f\u5217\u4e4b\u524d\u53d1\u9001\u4e00\u4e2a EIEOS \u5e8f\u5217\u3002</p> <p>\u8f6c\u79fb\u81f3 L0 \u72b6\u6001</p> <p>\u53d1\u9001\u7aef\u4f1a\u5728\u53d1\u9001\u5b8c\u6240\u6709\u5fc5\u987b\u7684 FTS \u5e8f\u5217\u540e\uff0c\u5e76\u6ee1\u8db3\u4e0b\u8ff0\u6761\u4ef6\u65f6\uff0c\u8f6c\u79fb\u81f3 L0 \u72b6\u6001\uff1a</p> <p>a) 8b/10b: \u5728 FTS \u5e8f\u5217\u53d1\u9001\u4e4b\u540e\uff0c\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u53d1\u9001\u8fc7\u4e00\u4e2a SOS \u5e8f\u5217\u3002</p> <p>b) 128b/130b: \u9996\u5148\u53d1\u9001\u4e00\u4e2a EIEOS \u5e8f\u5217\uff0c\u5176\u540e\u662f SDS \u5e8f\u5217\u4ee5\u53ca\u6570\u636e\u6d41\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1492-l0s","title":"14.9.2 L0s \u63a5\u6536\u7aef\u72b6\u6001\u673a","text":"<p>\u539f\u6587 605 \u9875\u56fe 14-41 \u5c55\u793a\u4e86\u63a5\u6536\u7aef L0s \u72b6\u6001\u673a\u793a\u610f\u56fe\u3002\u5982\u679c\u63a5\u6536\u7aef\u7684 Link Capability \u5bc4\u5b58\u5668\u8868\u793a\u652f\u6301 ASPM \u529f\u80fd\uff0c\u90a3\u4e48\u63a5\u6536\u7aef\u5fc5\u987b\u5b9e\u73b0 L0s \u72b6\u6001\u529f\u80fd\u3002\u5f53\u7136\uff0c\u5373\u4f7f\u4e0d\u652f\u6301 ASPM \u529f\u80fd\uff0c\u63a5\u6536\u7aef\u4e5f\u53ef\u4ee5\u5b9e\u73b0 L0s \u72b6\u6001\u3002</p> <p></p> <p>\u56fe 14-41 \u63a5\u6536\u7aef L0s \u72b6\u6001\u673a</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14921-rx_l0sentry","title":"14.9.2.1 Rx_L0s.Entry. \u72b6\u6001","text":"<p>\u5982\u679c\u63a5\u6536\u7aef\u63a5\u6536\u7aef\u652f\u6301 L0s \u72b6\u6001\uff0c\u5728\u4e0d\u6ee1\u8db3\u8fdb\u5165 L1 \u6216\u8005 L2 \u7684\u6761\u4ef6\u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u6536\u5230 EIOS \u540e\u8fdb\u5165\u8be5\u72b6\u6001\u3002</p> <p>\u8f6c\u79fb\u81f3 Rx_L0s.Idle. \u72b6\u6001</p> <p>\u5728\u7ecf\u8fc7  T TX\u2010IDLE\u2010MIN \uff0820ns\uff09\u65f6\u957f\u540e\uff0c\u8fdb\u5165 Rx_L0s.Idle. \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14922-rx_l0sidle","title":"14.9.2.2 Rx_L0s.Idle. \u72b6\u6001","text":"<p>\u6b64\u65f6\uff0c\u63a5\u6536\u7aef\u5904\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u5728\u6761\u4ef6\u6ee1\u8db3\u540e\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p> <p>\u8fd9\u65f6\u5019\uff0c\u8bf4\u4e00\u70b9\u6709\u5173\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u7684\u9898\u5916\u8bdd\uff0c\u65e9\u671f\u7248\u672c\u7684  PCIe \u534f\u8bae\u4e2d\uff0c\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u4e0e\u5426\u53d6\u51b3\u4e8e squelch-detect \u7535\u8def\u5bf9\u7535\u538b\u9608\u503c\u7684\u6d4b\u91cf\u7ed3\u679c\u3002\u540e\u6765\uff0c\u968f\u7740\u94fe\u8def\u901f\u5ea6\u7684\u63d0\u9ad8\uff0c\u6d4b\u91cf\u5982\u6b64\u4e4b\u5c0f\u7684\u7535\u538b\u5dee\u53d8\u5f97\u8d8a\u6765\u8d8a\u56f0\u96be\u3002\u56e0\u6b64\uff0c\u5728\u66f4\u65b0\u7684\u534f\u8bae\u4e2d\uff0c\u5141\u8bb8\u901a\u8fc7\u94fe\u8def\u7684\u884c\u4e3a\u6765\u63a8\u65ad\u7535\u6c14\u7a7a\u95f2\u4e0e\u5426\uff0c\u800c\u4e0d\u662f\u771f\u7684\u901a\u8fc7\u6d4b\u91cf\u7535\u8def\u7535\u538b\u3002\u7136\u800c\uff0c\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff0c\u5982\u679c\u4e0d\u662f\u901a\u8fc7\u68c0\u6d4b\u7535\u8def\u7535\u538b\u6765\u5224\u65ad\u94fe\u8def\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u90a3\u4e48\u4e5f\u4e0d\u80fd\u901a\u8fc7\u7535\u8def\u7535\u538b\u5224\u65ad\u94fe\u8def\u9000\u51fa\u4e86\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u6709\u5e8f\u7b26\u53f7\u96c6 EIEOS\uff08Electrical Idle Exit Ordered Set\uff09\u3002EIEOS \u7531\u4ea4\u66ff\u7684\u5168\u96f6\u548c\u5168\u4e00\u5b57\u8282\u7ec4\u6210\uff0c\u5728\u94fe\u8def\u4e0a\u521b\u9020\u4e86\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u4f4e\u9891\u65f6\u949f\u7684\u4fe1\u53f7\u3002\u4e00\u65e6\u63a5\u6536\u65b9\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u540e\uff0c\u5176\u53ef\u4ee5\u901a\u8fc7\u68c0\u6d4b EIEOS \u6709\u5e8f\u96c6\uff0c\u6765\u5f97\u77e5\u94fe\u8def\u662f\u5426\u9000\u51fa\u4e86\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p> <p>\u8f6c\u79fb\u81f3 Rx_L0s.FTS. \u72b6\u6001</p> <p>\u5982\u679c\u63a5\u6536\u65b9\u5982\u4e0a\u6240\u8ff0\uff0c\u68c0\u6d4b\u5230\u4e86\u94fe\u8def\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u94fe\u8def\u8fdb\u5165 Rx_L0s.FTS. \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14923-rx_l0sfts","title":"14.9.2.3 Rx_L0s.FTS. \u72b6\u6001","text":"<p>\u5728\u8be5\u6b21\u72b6\u6001\u4e2d\uff0c\u63a5\u6536\u7aef\u5df2\u7ecf\u68c0\u6d4b\u5230\u94fe\u8def\u4e0a\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u7684\u4fe1\u53f7\uff0c\u5e76\u6b63\u5728\u5c1d\u8bd5\u4ece\u8f93\u5165\u7684\u6bd4\u7279\u6d41\u4e2d\u91cd\u5efa\u6bd4\u7279\u548c\u7b26\u53f7\uff08\u6216\u5757\uff09\u9501\u5b9a\uff0c\u6b64\u65f6\u7684\u8f93\u5165\u6bd4\u7279\u6d41\u5176\u5b9e\u5c31\u662f\u5bf9\u7aef\u53d1\u9001\u7684 FTS \u6709\u5e8f\u96c6\u3002</p> <p>\u8f6c\u79fb\u81f3 L0 \u72b6\u6001</p> <p>\u5982\u679c\u5728\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u4e0a\u63a5\u6536\u5230 SOS \u6709\u5e8f\u96c6\uff088b/10b \u7f16\u7801\uff09\uff0c\u6216\u8005 SDS \u6709\u5e8f\u96c6\uff08128b/130b \u7f16\u7801\uff09\uff0c\u90a3\u4e48\u63a5\u6536\u7aef\u9000\u51fa\u81f3 L0 \u72b6\u6001\u3002\u63a5\u6536\u7aef\u5fc5\u987b\u6709\u80fd\u529b\u5728\u8df3\u8f6c\u540e\u8fc5\u901f\u63a5\u6536\u6709\u6548\u6570\u636e\uff0c\u5e76\u4e14\u5728\u72b6\u6001\u8f6c\u79fb\u4e4b\u524d\uff0c\u9700\u8981\u5b8c\u6210\u901a\u9053\u95f4\u7684\u53bb\u504f\u659c\u64cd\u4f5c\uff08deskew\uff09\u3002</p> <p>\u8f6c\u79fb\u81f3 Recovery \u72b6\u6001</p> <p>\u7136\u540e\uff0c\u5982\u679c N_FTS \u53d1\u9001\u8d85\u65f6\u540e\uff0c\u63a5\u6536\u7aef\u4ecd\u7136\u6ca1\u80fd\u6ee1\u8db3\u8fdb\u5165 L0 \u72b6\u6001\u7684\u6761\u4ef6\uff0c\u6b64\u65f6\u63a5\u6536\u65b9\u8fdb\u5165 Recovery \u72b6\u6001\u3002\u6b64\u65f6\uff0c\u53d1\u9001\u7aef\u4e5f\u9700\u8981\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u4e0d\u8fc7\u5728\u6b64\u4e4b\u524d\u53d1\u9001\u7aef\u53ef\u4ee5\u5148\u5b8c\u6210\u4efb\u610f\u7684\u5728\u9014 TLP \u6216\u8005 DLLP\u3002\u5728\u8d85\u65f6\u53d1\u751f\u540e\uff0c\u534f\u8bae\u5efa\u8bae\u53d1\u9001\u7aef\u63d0\u9ad8\u5176 N_FTS \u6570\u503c\u5927\u5c0f\uff0c\u6765\u964d\u4f4e\u8d85\u65f6\u4e8b\u4ef6\u518d\u6b21\u53d1\u751f\u7684\u673a\u7387\u3002N_FTS \u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <p>8b/10b \u7f16\u7801\u65f6\uff0c\u6700\u5c0f\u8d85\u65f6\u6570\u503c\u4e3a 40 * [N_FTS +3] * UI\uff0c\u6700\u5927\u8d85\u65f6\u6570\u503c\u5219\u662f\u524d\u8005\u7684\u4e24\u500d\u3002\u56e0\u4e3a\u6bcf\u4e2a\u7b26\u53f7\u4f20\u8f93\u9700\u8981 10bit\uff0c\u4e0a\u8ff0\u6570\u503c\u53ef\u4ee5\u8f6c\u6362\u4e3a 4*N_FTS + 12 \u7b26\u53f7\uff08UI \u4ee3\u8868 1bit \u7684\u4f20\u8f93\u65f6\u95f4\uff09\u3002\u989d\u5916\u7684 12 \u4e2a\u7b26\u53f7\u89e3\u91ca\u4e3a\uff1a6 \u4e2a\u7b26\u53f7\u662f\u6700\u5927\u60c5\u51b5\u4e0b\u7684 SOS \u6709\u5e8f\u96c6\u957f\u5ea6\uff0c4 \u4e2a\u7b26\u53f7\u7528\u4e8e\u989d\u5916\u7684 FTS\uff0c\u800c\u5269\u4e0b 2 \u4e2a\u7b26\u53f7\u7528\u4e8e\u7b26\u53f7\u95f4\u7684\u95f4\u9694\uff08Symbol margin\uff09\u3002\u603b\u4f53\u800c\u8a00\uff0c\u6700\u5c0f\u8d85\u65f6\u65f6\u95f4\u662f\u53d1\u9001\u6240\u9700 FTS \u6570\u91cf\u7684 FTS \u52a0\u4e0a\u989d\u5916 12 \u4e2a\u7b26\u53f7\u6240\u9700\u7684\u65f6\u95f4\uff0c\u800c\u6700\u5927\u8d85\u65f6\u65f6\u95f4\u5219\u662f\u524d\u8005\u7684\u4e24\u500d\u3002</p> <p>\u5982\u679c extended synch \u6bd4\u7279\u7f6e\u4f4d\uff0c\u90a3\u4e48\u6700\u5c0f\u8d85\u65f6\u65f6\u95f4\u662f 2048 \u4e2a FTS\uff0c\u6700\u5927\u8d85\u65f6\u65f6\u95f4\u662f 4096 \u4e2a FTS\u3002\u5982\u679c\u662f\u8d85\u8fc7 2.5GT/s \u7684\u901f\u7387\uff0c\u90a3\u4e48\u63a5\u6536\u7aef\u5b9e\u9645\u7528\u5230\u7684\u8d85\u65f6\u65f6\u95f4\u8fd8\u8981\u52a0\u4e0a 4 \u5230 8 \u4e2a EIE \u7b26\u53f7\u3002</p> <p>128b/130b \u7f16\u7801\u65f6\uff0c\u6700\u5c0f\u8d85\u65f6\u6570\u503c\u4e3a 130 * [N_FTS +5 +12 + Floor(N_FTS/32) ] * UI\uff0c\u6700\u5927\u8d85\u65f6\u6570\u503c\u5219\u662f\u524d\u8005\u7684\u4e24\u500d\u3002\u6570\u503c 130 * UI \u4ee3\u8868\u4f20\u8f93 130 \u6bd4\u7279\u7684\u65f6\u95f4\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u5757\uff0c\u6240\u4ee5\u7ecf\u8fc7\u6362\u7b97\u540e\u5c31\u53d8\u6210\u4e86\uff1a[N_FTS +5 +12 + Floor(N_FTS/32) ] \u5757\u3002\u6570\u503c 5 + Floor(N_FTS/32) \u4ee3\u8868\u9700\u8981\u53d1\u9001 EIEOS \u7684\u95f4\u9694\uff0cFloor(N_FTS/32) \u8868\u793a\u4e86\u9700\u8981\u6bcf\u9694 32 \u4e2a FTS \u53d1\u9001\u4e00\u4e2a EIEOS\u3002\u5269\u4e0b\u7684 5 \u4e2a\u5757\u5206\u522b\u4ee3\u8868\uff1a\u7b2c\u4e00\u4e2a EIEOS\uff0c\u6700\u540e\u4e00\u4e2a EIEOS\uff0cSDS\uff0c\u5468\u671f\u6027\u7684 EIEOS \u4ee5\u53ca\u4e00\u4e2a\u989d\u5916\u7684 EIEOS\uff0c\u9632\u6b62\u53d1\u9001\u7aef\u9009\u62e9\u5728 SDS \u540e\u53d1\u9001\u4e24\u4e2a EIEOS\u3002\u6700\u540e\uff0c12 \u4ee3\u8868\u5728 extended synch \u6bd4\u7279\u7f6e\u8d77\u65f6\uff0c\u9700\u8981\u53d1\u9001\u7684 12 \u4e2a SOS\uff0c\u8be5\u6bd4\u7279\u7f6e\u8d77\u65f6\uff0c\u8d85\u65f6\u957f\u5ea6\u4e3a N_FTS = 4096\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1410-l1-state-l1","title":"14.10 L1 State // L1 \u72b6\u6001","text":"<p>L1 \u662f\u4e00\u4e2a\u76f8\u8f83\u4e8e L0s \u72b6\u6001\u66f4\u52a0\u6fc0\u8fdb\u5730\u51cf\u5c11\u529f\u8017\u7684\u94fe\u8def\u7535\u6e90\u72b6\u6001\uff0c\u4f5c\u4e3a\u4ee3\u4ef7\uff0cL1 \u4f1a\u6709\u66f4\u957f\u7684\u4f4e\u529f\u8017\u72b6\u6001\u9000\u51fa\u5ef6\u8fdf\u3002\u548c L0s \u4e00\u6837\uff0cL1 \u662f ASPM \u53ef\u9009\u652f\u6301\u7684\u4e00\u9879\u72b6\u6001\uff0c\u4e5f\u5c31\u662f\u8bf4\u8bbe\u5907\u53ef\u4ee5\u5728\u6ca1\u6709\u8f6f\u4ef6\u53c2\u4e0e\u7684\u60c5\u51b5\u4e0b\uff0c\u7531\u786c\u4ef6\u81ea\u52a8\u8fdb\u5165\u6216\u8005\u9000\u51fa\u4f4e\u529f\u8017\u72b6\u6001\u3002\u7136\u800c\uff0c\u548c L0s \u4e0d\u540c\u7684\u662f\uff0c\u8f6f\u4ef6\u4e5f\u53ef\u4ee5\u76f4\u63a5\u547d\u4ee4 USP \u53d1\u8d77\u94fe\u8def\u8fdb\u5165 L1 \u72b6\u6001\u7684\u6539\u53d8\uff0c\u901a\u8fc7\u5c06\u8bbe\u5907\u7535\u6e90\u72b6\u6001\u6539\u53d8\u4e3a\u66f4\u4f4e\u529f\u8017\u7684\u72b6\u6001\uff08D1\uff0cD2\uff0c\u6216\u8005 D3\uff09\u505a\u5230\u8fd9\u4e00\u70b9\u3002L1 \u72b6\u6001\u548c L0s \u72b6\u6001\u7684\u4e0d\u540c\u70b9\u8fd8\u5728\u4e8e\uff0cL1 \u72b6\u6001\u4f1a\u5f71\u54cd\u94fe\u8def\u53cc\u5411\u7684\u72b6\u6001\uff0c\u800c L0s \u53ea\u4f5c\u7528\u4e8e\u94fe\u8def\u5355\u4e2a\u65b9\u5411\u3002</p> <p></p> <p>\u56fe 14-42 L1 \u72b6\u6001\u673a</p> <p>\u5f53\u8bbe\u5907\u5728\u68c0\u6d4b\u5230\u94fe\u8def\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u4f1a\u8ba4\u4e3a\u94fe\u8def\u4f19\u4f34\u5e0c\u671b\u5c06\u94fe\u8def\u8f6c\u4e3a L0s\uff0cL1 \u6216\u8005 L2 \u7b49\u4f4e\u529f\u8017\u72b6\u6001\uff0c\u4e3a\u4e86\u533a\u5206\u5230\u5e95\u5e94\u8be5\u8fdb\u5165\u54ea\u79cd\u4f4e\u529f\u8017\u72b6\u6001\uff0c\u5728\u8fdb\u5165 L1 \u72b6\u6001\u4e4b\u524d\uff0c\u94fe\u8def\u53cc\u65b9\u4f1a\u9996\u5148\u8fbe\u5230\u4e00\u81f4\u3002\u901a\u8fc7\u63e1\u624b\u673a\u5236\u4f7f\u94fe\u8def\u53cc\u65b9\u660e\u767d\u5bf9\u65b9\u5df2\u7ecf\u51c6\u5907\u5c31\u7eea\uff0c\u6b64\u65f6\u53ef\u4ee5\u5b89\u5168\u5730\u7ee7\u7eed\u8fdb\u5165 L1 \u7684\u6d41\u7a0b\u3002\u539f\u6587 733 \u9875\u7684 \u201c\u94fe\u8def\u7535\u6e90\u72b6\u6001\u7ba1\u7406\u4ecb\u7ecd\u201d \uff08Introduction to Link Power Management\uff09\u4e00\u8282\u63d0\u4f9b\u4e86\u8fd9\u5957\u673a\u5236\u66f4\u591a\u7684\u7ec6\u8282\uff0c\u6709\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u53c2\u9605\u3002\u539f\u6587 608 \u9875\u7684\u56fe 14-42 \u5c55\u793a\u4e86 L1 \u72b6\u6001\u76f8\u5173\u7684\u72b6\u6001\u8df3\u8f6c\u5173\u7cfb\uff0c\u6211\u4eec\u5c06\u5728\u540e\u4e00\u8282\u4e2d\u5c55\u5f00\u8ba8\u8bba\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14101-l1-entry","title":"14.10.1 L1 Entry \u72b6\u6001","text":"<p>\u5f53 USP \u60f3\u8981\u8fdb\u5165 L1 \u72b6\u6001\u65f6\uff0c\u5fc5\u987b\u5411\u94fe\u8def\u4f19\u4f34\u53d1\u51fa\u8bf7\u6c42\u8fdb\u5165 L1 \u7684\u7533\u8bf7\uff0c\u5f97\u5230\u5bf9\u7aef\u53ef\u884c\u7684\u56de\u590d\u4e4b\u540e\uff0c\u624d\u53ef\u4ee5\u8fdb\u5165 L1 \u72b6\u6001\uff08\u8fdb\u5165 L1 \u72b6\u6001\u7684\u7533\u8bf7\u53ef\u80fd\u662f ASPM \u6216\u8005\u8f6f\u4ef6\u53d1\u8d77\u7684\uff09\u3002\u5728\u63a5\u6536\u5230\u53ef\u4ee5\u8fdb\u5165 L1 \u72b6\u6001\u7684\u56de\u5e94\u540e\uff0cUSP \u8fdb\u5165 L1.Entry \u6b21\u72b6\u6001\u3002</p> <p>DSP \u8fdb\u5165 L1 \u72b6\u6001\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff0cDSP \u5fc5\u987b\u63a5\u6536\u5230 USP \u53d1\u51fa\u7684\u8bf7\u6c42\u8fdb\u5165 L1 \u72b6\u6001\u7684\u7533\u8bf7\uff0c\u5e76\u7ed9\u51fa\u80af\u5b9a\u7684\u7b54\u590d\u3002\u63a5\u4e0b\u6765\uff0cDSP \u7b49\u5f85\u94fe\u8def\u4e0a\u51fa\u73b0\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u6709\u5e8f\u96c6\uff08EIOS\uff0cElectrical Idle Ordered Set\uff09\uff0c\u5e76\u4f7f\u63a5\u6536\u5230 EIOS \u7684\u901a\u9053\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u540e\uff0c\u8fdb\u5165 L1.Entry \u6b21\u72b6\u6001\u3002</p> <p>L1 Entry \u72b6\u6001\u671f\u95f4</p> <p>\u6240\u6709\u5df2\u914d\u7f6e\u901a\u9053\u7684\u53d1\u9001\u7aef\u53d1\u9001 EIOS \u5e76\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u6b64\u65f6\u9700\u8981\u4fdd\u6301\u5408\u9002\u7684\u76f4\u6d41\u5171\u6a21\u7535\u538b\uff08DC common mode voltage\uff09\u3002</p> <p>\u8f6c\u79fb\u81f3 L1.Idle \u72b6\u6001</p> <p>\u5728\u7b49\u5f85 TTX\u2010IDLE\u2010MIN \uff0820ns\uff09\u540e\u8fdb\u5165 L1.Idle \u6b21\u72b6\u6001\u3002\u8fd9\u6bb5\u5ef6\u65f6\u662f\u4e3a\u4e86\u786e\u4fdd\u53d1\u9001\u7aef\u5df2\u7ecf\u8fdb\u5165\u4e86\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14102-l1-idle","title":"14.10.2 L1 Idle \u72b6\u6001","text":"<p>\u6b64\u65f6\uff0c\u53d1\u9001\u7aef\u4ecd\u7136\u4fdd\u6301\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p> <p>\u5f53\u901f\u7387\u8d85\u8fc7 2.5GT/s \u65f6\uff0cLTSSM \u5fc5\u987b\u5728\u8be5\u6b21\u72b6\u6001\u81f3\u5c11\u505c\u7559 40ns\u3002\u5728\u534f\u8bae\u4e2d\uff0c\u8be5\u5ef6\u8fdf\u88ab\u63cf\u8ff0\u4e3a \u201c\u7528\u4e8e\u7ed9\u903b\u8f91\u51c6\u5907\u597d\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u68c0\u6d4b\u7535\u8def\u7559\u51fa\u65f6\u95f4\uff0c\u9632\u6b62\u51fa\u73b0\u94fe\u8def\u8fdb\u5165 L1 \u53c8\u5f88\u5feb\u9000\u51fa\u7684\u60c5\u51b5\uff08\u68c0\u6d4b\u4e0d\u5230\u8fd9\u6b21\u8fdb\u51fa L1 \u72b6\u6001\uff09\u201d\u3002</p> <p>\u8f6c\u79fb\u81f3 Recovery \u72b6\u6001</p> <p>\u5f53\u53d1\u9001\u7aef\u6536\u5230\u4e0a\u5c42\u6307\u4ee4\u9000\u51fa L1 \u72b6\u6001\uff0c\u6216\u8005\u63a5\u6536\u7aef\u68c0\u6d4b\u5230\u94fe\u8def\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u4e0b\u4e00\u6b65\u8f6c\u79fb\u81f3 Recovery \u72b6\u6001\u3002\u9000\u51fa L1 \u72b6\u6001\u7684\u539f\u56e0\u53ef\u80fd\u662f\u53d1\u9001\u7aef\u9700\u8981\u53d1\u9001 DLLP \u6216\u8005 TLP\uff0c\u6216\u8005\u5e0c\u671b\u6539\u53d8\u94fe\u8def\u7684\u5bbd\u5ea6\u6216\u8005\u901f\u7387\u3002\u5982\u679c\u9700\u8981\u6539\u53d8\u94fe\u8def\u901f\u7387\uff0c\u5141\u8bb8\u7aef\u53e3\u5c06\u53d8\u91cf directed_speed_change \u8bbe\u7f6e\u4e3a 1b\uff0c\u5e76\u4e14\u5c06\u53d8\u91cf changed_speed_recovery \u6e05\u9664\u4e3a 0b\u3002\u53ef\u9009\u7684\uff0c\u7aef\u53e3\u53ef\u80fd\u4ece L1 \u9000\u51fa\uff0c\u901a\u8fc7\u5c06 directed_speed_change \u8bbe\u7f6e\u4e3a 1b \u53d1\u8d77\u901f\u7387\u6539\u53d8\u8bf7\u6c42\uff0c\u76f4\u63a5\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u800c\u4e0d\u662f\u50cf\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4ece L0 \u8fdb\u5165 Recovery \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1411-l2-state-l2","title":"14.11 L2 State // L2 \u72b6\u6001","text":"<p>L2 \u72b6\u6001\u662f\u76f8\u6bd4 L1 \u72b6\u6001\u7a0b\u5ea6\u66f4\u6df1\u7684\u4f4e\u529f\u8017\u6a21\u5f0f\uff0c\u76f8\u5e94\u5730\uff0c\u4e5f\u9700\u8981\u66f4\u957f\u7684\u6062\u590d\u65f6\u95f4\u3002\u5f53\u8bbe\u5907\u5904\u4e8e D3Cold \u7535\u6e90\u72b6\u6001\u4e0b\uff0c\u5e76\u5b8c\u6210\u76f8\u5e94\u7684\u94fe\u8def\u63e1\u624b\u4e4b\u540e\uff0c\u5728\u7535\u6e90\u7ba1\u7406\u8f6f\u4ef6\u7684\u547d\u4ee4\u4e0b\uff0cUSP \u53d1\u8d77\u8fdb\u5165 L2 \u72b6\u6001\u7684\u8bf7\u6c42\uff08\u4f7f\u94fe\u8def\u4e24\u4e2a\u65b9\u5411\u4e0a\u90fd\u8fdb\u5165 L2 \u72b6\u6001\uff09\u3002</p> <p>\u7cfb\u7edf\u5728\u4e00\u5207\u5c31\u7eea\u540e\u4f1a\u5207\u65ad\u4e3b\u7535\u6e90\u3002\u5728\u4e3b\u7535\u6e90\u79fb\u9664\u540e\uff0c\u8bbe\u5907\u4f1a\u8fdb\u5165 L2 \u6216\u8005 L3 \u72b6\u6001\uff0c\u53d6\u51b3\u4e8e\u5907\u7528\u7535\u6e90 Vaux \u662f\u5426\u53ef\u7528\u3002\u5982\u679c Vaux \u5b58\u5728\uff0c\u90a3\u4e48\u94fe\u8def\u8fdb\u5165 L2 \u72b6\u6001\uff0c\u5426\u5219\u8fdb\u5165 L3 \u72b6\u6001\u3002</p> <p>L2 \u72b6\u6001\u7684\u76ee\u7684\u5728\u4e8e\u4f7f\u7528\u4f4e\u529f\u8017\u7684 Vaux \u7ed9\u8bbe\u5907\u4f9b\u7535\uff0c\u5728\u9700\u8981\u94fe\u8def\u6062\u590d\u7535\u6e90\u7684\u4e8b\u4ef6\u53d1\u751f\u540e\u5524\u9192\u7cfb\u7edf\u3002\u8bbe\u5907\u6709\u4e24\u79cd\u6807\u51c6\u65b9\u6cd5\u901a\u77e5\u7cfb\u7edf\u8be5\u7c7b\u4e8b\u4ef6\u7684\u53d1\u751f\u3002\u4e00\u4e2a\u662f\u8fb9\u5e26\uff08side-band\uff09\u4fe1\u53f7 WAKE# \u5f15\u811a\uff0c\u53e6\u4e00\u4e2a\u662f\u94fe\u8def\uff08in-band\uff09\u4fe1\u53f7 Beacon\u3002WAKE# \u4fe1\u53f7\u5bf9\u4e8e L2 \u6765\u8bf4\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u7528\u53ef\u9009\u7684 Beacon\uff0c\u90a3\u4e48\u5176\u662f\u5fc5\u987b\u7684\u3002\uff08\u8bd1\u6ce8\uff1a\uff09\u534f\u8bae\u4e2d\u660e\u786e\u6307\u51fa\u5de5\u4f5c\u5728 5.0 \u6216\u8005 8.0 GT/s \u7684\u8bbe\u5907\uff0c\u65e0\u9700\u652f\u6301 Beacon \u7279\u6027\uff0c\u6240\u4ee5\u770b\u4e0a\u53bb Beacon \u662f\u4e00\u9879\u8fc7\u65f6\uff08legacy\uff09\u7684\u7279\u6027\uff0c\u4ec5\u7528\u4e8e\u8fd0\u884c\u5728 2.5 GT/s \u7684\u8bbe\u5907\u3002\u5173\u4e8e\u94fe\u8def\u5524\u9192\u9009\u9879\u7684\u66f4\u591a\u7ec6\u8282\uff0c\u53ef\u4ee5\u53c2\u89c1\u539f\u6587 772 \u9875\u7684 \u201cWaking Non-Communicating Links\u201d \u4e00\u8282\u3002</p> <p>\u5982\u679c\u8bbe\u5907\u652f\u6301 Beacon\uff0c\u90a3\u4e48\u5176\u5b9e Beacon \u6307\u7684\u662f\u4e00\u4e2a\u94fe\u8def\u4e0a\u7684\u4f4e\u9891\u4fe1\u53f7\uff0830 KHz \u2010 500 MHz\uff09\uff0c\u652f\u6301\u5524\u9192\u529f\u80fd\u7684 USP \u81f3\u5c11\u80fd\u591f\u5728\u901a\u9053 0 \u4e0a\u53d1\u9001 Beacon \u4fe1\u53f7\uff0c\u800c DSP \u5219\u5fc5\u987b\u80fd\u591f\u63a5\u6536\u5b83\u3002\u4e2d\u7ee7\u8bbe\u5907\uff0c\u6bd4\u5982\u4ea4\u6362\u673a\uff0c\u5982\u679c\u5728\u5176 DSP \u7aef\u53e3\u4e0a\u63a5\u6536\u5230 Beacon\uff0c\u5fc5\u987b\u6709\u80fd\u529b\u5c06\u5176\u8f6c\u53d1\u7ed9\u5b83\u7684 USP \u7aef\u53e3\u3002Beacon \u7684\u6700\u7ec8\u76ee\u7684\u5730\u5c06\u4f1a\u662f RC\uff08Root Complex\uff09\uff0c\u56e0\u4e3a RC \u662f\u7cfb\u7edf\u7535\u6e90\u63a7\u5236\u903b\u8f91\u7684\u6240\u5728\u4e4b\u5904\u3002</p> <p>\u5f53\u53d1\u9001\u7aef\u8fdb\u5165\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u53ef\u80fd\u4ee3\u8868\u60f3\u5c06\u94fe\u8def\u8f6c\u4e3a L0s\uff0cL1 \u6216\u8005 L2 \u7b49\u4f4e\u529f\u8017\u72b6\u6001\u4e2d\u7684\u5176\u4e2d\u4e00\u79cd\uff0c\u6240\u4ee5\u9700\u8981\u673a\u5236\u6765\u533a\u5206\u5230\u5e95\u53d1\u9001\u7aef\u60f3\u8fdb\u5165\u54ea\u79cd\u4f4e\u529f\u8017\u72b6\u6001\u3002\u5728\u8fdb\u5165 L2 \u72b6\u6001\u4e4b\u524d\uff0c\u94fe\u8def\u53cc\u65b9\u4f1a\u9996\u5148\u8fbe\u5230\u4e00\u81f4\u3002\u901a\u8fc7\u63e1\u624b\u673a\u5236\u4f7f\u94fe\u8def\u53cc\u65b9\u660e\u767d\u5bf9\u65b9\u5df2\u7ecf\u51c6\u5907\u5c31\u7eea\u3002\u539f\u6587 733 \u9875\u7684 \u201c\u94fe\u8def\u7535\u6e90\u72b6\u6001\u7ba1\u7406\u4ecb\u7ecd\u201d \uff08Introduction to Link Power Management\uff09\u4e00\u8282\u63d0\u4f9b\u4e86\u8fd9\u5957\u673a\u5236\u66f4\u591a\u7684\u7ec6\u8282\uff0c\u6709\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u53c2\u9605\u3002\u539f\u6587 611 \u9875\u7684\u56fe 14-43 \u5c55\u793a\u4e86 L2 \u72b6\u6001\u76f8\u5173\u7684\u72b6\u6001\u8df3\u8f6c\u5173\u7cfb\uff0c\u6211\u4eec\u5c06\u5728\u540e\u4e00\u8282\u4e2d\u5c55\u5f00\u8ba8\u8bba\u3002</p> <p></p> <p>\u56fe 14-43 L2 \u72b6\u6001\u673a\u793a\u610f\u56fe</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14111-l2idle","title":"14.11.1 L2.Idle \u72b6\u6001","text":"<p>\u8fdb\u5165\u8be5\u6b21\u72b6\u6001\u524d\uff0c\u6240\u6709\u5fc5\u987b\u7684\u63e1\u624b\u6d41\u7a0b\u5fc5\u987b\u5df2\u7ecf\u5728\u94fe\u8def\u4e0a\u7684\u4e24\u4e2a\u7aef\u53e3\u4e4b\u95f4\u5b8c\u6210\uff0c\u5e76\u4e14\u7aef\u53e3\u5df2\u7ecf\u53d1\u9001\u6216\u8005\u63a5\u6536\u5230\u6240\u9700\u7684 EIOS \u5e8f\u5217\u3002</p> <p>\u6240\u6709\u5df2\u914d\u7f6e\u53d1\u9001\u7aef\u5fc5\u987b\u81f3\u5c11\u5728\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u7b49\u5f85 TTX\u2010IDLE\u2010MIN \uff0820ns\uff09\u3002\u4f46\u662f\u56e0\u4e3a\u6b64\u65f6\u4e3b\u7535\u6e90\u5df2\u7ecf\u88ab\u5173\u95ed\uff0c\u56e0\u6b64\u53d1\u9001\u7aef\u65e0\u9700\u5c06\u76f4\u6d41\u5171\u6a21\u7535\u538b\u4fdd\u6301\u5728\u534f\u8bae\u89c4\u5b9a\u7684\u8303\u56f4\u5185\u3002\u63a5\u6536\u7aef\u5219\u5728\u6700\u77ed 20ns \u7684\u5ef6\u8fdf\u7ed3\u675f\u524d\uff0c\u4e0d\u4f1a\u5f00\u59cb\u68c0\u6d4b\u94fe\u8def\u662f\u5426\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u6240\u6709\u63a5\u6536\u7aef\u5fc5\u987b\u6253\u5f00\u7ec8\u7ed3\uff08termination\uff09\u529f\u80fd\uff0c\u5904\u4e8e\u4f4e\u963b\u6297\u6a21\u5f0f\u3002</p> <p>\u8f6c\u79fb\u81f3 L2.TransmitWake \u72b6\u6001</p> <p>\u5982\u679c USP \u88ab\u4e0a\u5c42\u547d\u4ee4\u5f00\u59cb\u53d1\u9001 Beacon\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8fdb\u5165 L2.TransmitWake \u72b6\u6001\uff08Beacon \u4f1a\u4e00\u76f4\u5411\u4e0a\u6d41\u53d1\u9001\uff0c\u53ea\u4ee5 RC \u4f5c\u4e3a\u6700\u7ec8\u76ee\u7684\u5730\uff09\u3002</p> <p>\u5982\u679c\u4ea4\u6362\u673a\u7684 DSP \u63a5\u6536\u5230 Beacon\uff0c\u4ea4\u6362\u673a\u5fc5\u987b\u4f7f\u5176 USP \u9000\u51fa\u81f3 L2.TransmitWake \u72b6\u6001\uff0c\u5e76\u5f00\u59cb\u7ee7\u7eed\u5411\u4e0a\u6e38\u53d1\u9001 Beacon\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5728\u4e3b\u7535\u6e90\u6062\u590d\u540e\uff0c\u8f6c\u79fb\u81f3 Detect \u72b6\u6001\u3002</p> <p>\u5728\u7aef\u53e3\u4e3b\u7535\u6e90\u6062\u590d\u540e\uff0c\u5728\u4efb\u4f55\u9884\u5148\u5b9a\u4e49\u7684\u901a\u9053\u4e0a\u68c0\u6d4b\u5230\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u540e\uff0c\u610f\u5473\u7740\u8fd9\u4e9b\u901a\u9053\u53ef\u4ee5\u88ab\u534f\u5546\u4e3a\u901a\u9053 0 \uff08\u591a\u901a\u9053\u94fe\u8def\u5fc5\u987b\u81f3\u5c11\u6709 2 \u4e2a\u9884\u5148\u5b9a\u4e49\u7684\u901a\u9053\uff09\uff0c\u4e4b\u540e\u8f6c\u5165 Detect \u72b6\u6001\u3002\u5982\u679c\u662f\u4ea4\u6362\u673a\u7684 USP \u7ecf\u5386\u4e86\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u90a3\u4e48\u5176\u5fc5\u987b\u5c06\u5176 DSP \u72b6\u6001\u8f6c\u79fb\u4e3a Detect \u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14112-l2transmitwake","title":"14.11.2 L2.TransmitWake \u72b6\u6001","text":"<p>\u5728\u8be5\u6b21\u72b6\u6001\uff0c\u53d1\u9001\u7aef\u4f1a\u81f3\u5c11\u5728\u901a\u9053 0 \u4e0a\u53d1\u9001 Beacon\u3002\u6ce8\u610f\u8be5\u72b6\u6001\u4ec5\u4f5c\u7528\u4e8e USP\uff0c\u56e0\u4e3a\u53ea\u6709 USP \u53ef\u4ee5\u53d1\u9001 Beacon\u3002</p> <p>\u8f6c\u79fb\u81f3 Detect \u72b6\u6001</p> <p>\u5982\u679c USP \u7684\u4efb\u610f\u63a5\u6536\u7aef\u68c0\u6d4b\u5230\u94fe\u8def\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u540e\uff0c\u8f6c\u79fb\u4e3a Detect \u72b6\u6001\u3002\u5f53\u7136\uff0c\u6b64\u65f6\u53cc\u65b9\u8bbe\u5907\u7684\u7535\u6e90\u5fc5\u987b\u5df2\u7ecf\u6062\u590d\uff0c\u94fe\u8def\u4f19\u4f34\u624d\u80fd\u591f\u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1412-hot-reset-state","title":"14.12 Hot Reset State // \u70ed\u590d\u4f4d\u72b6\u6001","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1413-disable-state-disable","title":"14.13 Disable State // Disable \u72b6\u6001","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1414-loopback-state","title":"14.14 Loopback State // \u56de\u73af\u72b6\u6001","text":""},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1415-dynamic-bandwidth-changes","title":"14.15 Dynamic Bandwidth Changes // \u52a8\u6001\u5e26\u5bbd\u6539\u53d8","text":"<p>\u66f4\u65b0\u4e00\u4ee3\u7684 PCIe \u534f\u8bae\u4ee5\u66f4\u9ad8\u7684\u901f\u7387\u548c\u66f4\u5bbd\u7684\u94fe\u8def\u63d0\u4f9b\u4e86\u6bd4\u65e9\u5148\u7248\u672c\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4f46\u4e5f\u6d88\u8017\u4e86\u66f4\u591a\u529f\u8017\u3002\u6240\u4ee5\uff0c2.0 \u534f\u8bae\u7684\u4f5c\u8005\u63d0\u51fa\u4e86\u53e6\u4e00\u79cd\u7535\u6e90\u7ba1\u7406\u673a\u5236\uff0c\u5373\u5141\u8bb8\u786c\u4ef6\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u52a8\u6001\u5730\uff08on the fly\uff09\u8c03\u6574\u94fe\u8def\u7684\u901f\u7387\u548c\u5bbd\u5ea6\u3002\u8fd9\u9879\u673a\u5236\u5141\u8bb8\u94fe\u8def\u5728\u9700\u8981\u63d0\u9ad8\u6027\u80fd\u65f6\uff0c\u4f7f\u7528\u5c3d\u53ef\u80fd\u5feb\u7684\u901f\u7387\u548c\u5c3d\u53ef\u80fd\u5bbd\u7684\u94fe\u8def\u5bbd\u5ea6\u3002\u800c\u5728\u9700\u8981\u964d\u4f4e\u529f\u8017\u65f6\uff0c\u5c3d\u53ef\u80fd\u4f4e\u5730\u964d\u4f4e\u94fe\u8def\u901f\u7387\uff0c\u6216\u8005\u51cf\u5c11\u94fe\u8def\u5bbd\u5ea6\uff0c\u6216\u8005\u4e8c\u8005\u7686\u4e3a\u3002\u52a8\u6001\u5e26\u5bbd\u6539\u53d8\u673a\u5236\u76f8\u6bd4\u6539\u53d8\u94fe\u8def\u72b6\u6001\u6216\u8005\u8bbe\u5907\u7535\u6e90\u72b6\u6001\u5730\u673a\u5236\uff0c\u6709\u4e24\u70b9\u660e\u663e\u7684\u4f18\u52bf\uff1a</p> <p>\u7b2c\u4e00\u70b9\uff0c\u5728\u5e26\u5bbd\u6539\u53d8\u671f\u95f4\uff0c\u94fe\u8def\u59cb\u7ec8\u80fd\u591f\u5de5\u4f5c\uff0c\u6539\u53d8\u5e26\u5bbd\u5bf9\u4e1a\u52a1\u4f20\u8f93\u7684\u4e2d\u65ad\u65f6\u95f4\u8f83\u77ed\u3002\u7b2c\u4e8c\u70b9\u4f18\u52bf\u5728\u4e8e\u8282\u7701\u529f\u8017\u7684\u7a0b\u5ea6\u66f4\u5927\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u4e00\u4e2a x16 \u94fe\u8def\uff0c\u5982\u679c\u4ee5\u4e00\u4e2a x1 \u94fe\u8def\u5de5\u4f5c\uff0c\u6240\u9700\u7684\u529f\u8017\u6bd4\u4e00\u4e2a L0s \u72b6\u6001\u7684 x16 \u94fe\u8def\u8fd8\u8981\u5c0f\u3002</p> <p>\u9664\u4e86\u8282\u7701\u529f\u8017\u4e4b\u5916\uff0c\u5e26\u5bbd\u964d\u4f4e\u8fd8\u53ef\u4ee5\u7528\u4e8e\u89e3\u51b3\u53ef\u9760\u6027\u95ee\u9898\u3002\u4e3e\u4f8b\u800c\u8a00\uff0c\u67d0\u4e2a\u4e0d\u53ef\u63a5\u53d7\u7684\u94fe\u8def\u53ef\u9760\u6027\u95ee\u9898\u53ef\u80fd\u662f\u8fc7\u9ad8\u7684\u94fe\u8def\u901f\u7387\u9020\u6210\u7684\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u94fe\u8def\u53cc\u65b9\u90fd\u53ef\u4ee5\u901a\u8fc7\u5e26\u5bbd\u6539\u53d8\u8fc7\u7a0b\uff0c\u4ece\u81ea\u5df1\u5ba3\u544a\u7684\u652f\u6301\u901f\u7387\u5217\u8868\u4e2d\u79fb\u9664\u8f83\u9ad8\u7684\u901f\u7387\u3002\u4e0d\u8fc7\uff0c\u534f\u8bae\u4e2d\u6ca1\u6709\u5177\u4f53\u89c4\u5b9a\u8bbe\u5907\u5982\u4f55\u505a\u51fa\u8be5\u53ef\u9760\u6027\u51b3\u5b9a\u3002\u6709\u8da3\u7684\u662f\uff08\u8bd1\u6ce8\uff1a\u597d\u50cf\u4e5f\u6ca1\u6709\u5f88\u6709\u8da3\uff09\uff0c\u9664\u4e86\u901a\u8fc7\u5e26\u5bbd\u6539\u53d8\u8fc7\u7a0b\u4e4b\u5916\uff0c\u8bbe\u5907\u4e5f\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u901a\u544a\u4e0d\u540c\u7684\u901f\u7387\u652f\u6301\u5217\u8868\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u6539\u53d8\u94fe\u8def\u7684\u901f\u7387\u6216\u8005\u5e26\u5bbd\u9700\u8981\u94fe\u8def\u88ab\u91cd\u65b0\u8bad\u7ec3\u3002\u5f53\u94fe\u8def\u5904\u4e8e L0 \u72b6\u6001\uff0c\u9700\u8981\u6539\u53d8\u901f\u7387\u65f6\uff0c\u5e0c\u671b\u6539\u53d8\u901f\u7387\u7684\u7aef\u53e3\u7684 LTSSM \u4f1a\u5411\u94fe\u8def\u5bf9\u7aef\u53d1\u9001 TS1\uff0c\u4f7f\u94fe\u8def\u53cc\u65b9\u7aef\u53e3\u7684 LTSSM \u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u5b8c\u6210\u901f\u7387\u5207\u6362\u540e\u8fd4\u56de L0 \u72b6\u6001\u3002</p> <p>\u76f8\u4f3c\u5730\uff0c\u5e0c\u671b\u6539\u53d8\u94fe\u8def\u5bbd\u5ea6\u7684\u7aef\u53e3\u5411\u94fe\u8def\u5bf9\u7aef\u53d1\u9001 TS1\uff0c\u4f7f\u94fe\u8def\u53cc\u65b9\u7aef\u53e3\u7684 LTSSM \u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u7136\u540e\u8fdb\u5165 Configuration \u72b6\u6001\uff0c\u5b8c\u6210\u94fe\u8def\u5bbd\u5ea6\u5207\u6362\u540e\u4ee5\u65b0\u7684\u94fe\u8def\u5bbd\u5ea6\u8fd4\u56de L0 \u72b6\u6001\u3002</p> <p>\u56e0\u4e3a\u94fe\u8def\u5e26\u5bbd\u6539\u53d8\u9700\u8981 LTSSM \u7684\u53c2\u4e0e\uff0c\u8fd9\u4e0e\u901f\u7387\u6539\u53d8\u6709\u6240\u4e0d\u540c\uff0c\u6240\u4ee5\u5728\u672c\u8282\u4e2d\u4f1a\u5206\u522b\u8ba8\u8bba\u94fe\u8def\u5e26\u5bbd\u7ba1\u7406\u7684\u4e24\u4e2a\u8fc7\u7a0b\uff1a\u52a8\u6001\u94fe\u8def\u901f\u7387\u6539\u53d8\u548c\u52a8\u6001\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u3002\u672c\u8282\u5c06\u5355\u72ec\u5730\u8ba8\u8bba\u8fd9\u4e24\u4e2a\u8bdd\u9898\uff0c\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u4ece\u94fe\u8def\u901f\u7387\u5207\u6362\u5f00\u59cb\u672c\u8282\u7684\u5185\u5bb9\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14151-dynamic-link-speed-changes","title":"14.15.1 Dynamic Link Speed Changes //\u52a8\u6001\u94fe\u8def\u901f\u7387\u6539\u53d8","text":"<p>\u4e3a\u4e86\u5e2e\u52a9\u8bfb\u8005\u4eec\u56de\u5fc6\u524d\u51e0\u8282\u4e2d\u8ba8\u8bba\u7684 LTSSM \u5404\u72b6\u6001\uff0c\u539f\u6587 620 \u9875\u7684\u56fe 14-45 \u63d0\u4f9b\u4e86 LTSSM \u7c97\u7565\u7684\u72b6\u6001\u8f6c\u79fb\u56fe\u3002\u5728\u6700\u65e9\u7684 Gen1 \u534f\u8bae\u4e2d\uff0c\u901f\u7387\u5207\u6362\u88ab\u89c4\u5212\u5728 Polling \u72b6\u6001\u8fdb\u884c\uff0c\u4f46\u662f\u5728\u968f\u540e\u7684 Gen2 \u4e2d\uff0c\u901f\u7387\u8f6c\u6362\u884c\u4e3a\u88ab\u6539\u5728 Recovery \u72b6\u6001\u8fdb\u884c\u3002</p> <p></p> <p>\u56fe 14-45 LTSSM \u72b6\u6001\u6982\u89c8</p> <p>\u5728 Polling \u72b6\u6001\u671f\u95f4\uff0c\u94fe\u8def\u53cc\u65b9\u4ea4\u6362 TS1 \u5e8f\u5217\uff0c\u5176\u4e2d\u643a\u5e26\u7684\u4fe1\u606f\u5982\u539f\u6587 621 \u56fe 14-46 \u6240\u793a\u3002\u5176\u4e2d\u6700\u6709\u8da3\u7684\u90e8\u5206\u5728\u4e8e Byte4 \u7684\u901f\u7387\u6807\u8bc6\u7b26\uff08Rate Identifier\uff09\u3002\u5176\u4e2d\u7684\u6bd4\u7279 1\uff0c2\uff0c3 \u5206\u522b\u8868\u793a\u652f\u6301\u54ea\u4e9b\u901f\u7387\uff0c\u534f\u8bae\u6307\u51fa\u6240\u6709\u8bbe\u5907\u90fd\u9700\u8981\u652f\u6301 2.5 GT/s\uff0c\u5982\u679c\u8bbe\u5907\u652f\u6301 8.0 GT/s\uff0c\u90a3\u4e48\u5fc5\u987b\u4e5f\u652f\u6301  5.0 GT/s\u3002</p> <p>\u6bd4\u7279 6 \u7684\u542b\u4e49\u53d6\u51b3\u4e8e\u7aef\u53e3\u9762\u5411\u94fe\u8def\u7684\u4e0a\u6e38\u8fd8\u662f\u4e0b\u6e38\uff0c\u4ee5\u53ca\u7aef\u53e3\u5f53\u524d\u6240\u5904\u7684 LTSSM \u72b6\u6001\u3002\u7136\u800c\uff0c\u5728\u901f\u7387\u6539\u53d8\u65f6\uff0c\u6709\u610f\u4e49\u7684\u53ea\u6709 USP \u53d1\u51fa\u7684 TS1 \u4e2d\u7684\u8be5\u6bd4\u7279\uff0c\u8868\u793a\u6b64\u6b21\u901f\u7387\u6539\u53d8\u662f\u5426\u662f\u4e00\u6b21\u81ea\u53d1\u884c\u4e3a\u3002\u81ea\u53d1\uff08Autonomous\uff09\u8868\u793a\u8be5\u7aef\u53e3\u56e0\u4e3a\u81ea\u8eab\u7684\u786c\u4ef6\u539f\u56e0\u8bf7\u6c42\u901f\u7387\u6539\u53d8\uff0c\u800c\u4e0d\u662f\u4e3a\u4e86\u89e3\u51b3\u67d0\u4e2a\u53ef\u9760\u6027\u95ee\u9898\u3002USP \u901a\u8fc7\u5c06\u6bd4\u7279 7 \u7f6e 1 \u4ee5\u53d1\u8d77\u901f\u7387\u6539\u53d8\u8bf7\u6c42\u3002TS1 \u4e2d\u7684\u5404\u4e2a\u57df\u53ca\u5176\u542b\u4e49\u548c TS2 \u7684\u975e\u5e38\u8fd1\u4f3c\uff0c\u4f46\u662f TS2 \u4e2d\u7684\u6bd4\u7279 6 \u6709\u5176\u4ed6\u542b\u4e49\uff0c\u548c\u81ea\u53d1\u7684\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u6709\u5173\uff0c\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p></p> <p>\u56fe 14-46 TS1 \u542b\u4e49</p> <p></p> <p>\u56fe 14-47 TS2 \u542b\u4e49</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14152-upstream-port-initiates-speed-change-usp","title":"14.15.2 Upstream Port Initiates Speed Change // USP \u53d1\u8d77\u7684\u901f\u7387\u6539\u53d8","text":"<p>\u901f\u7387\u6539\u53d8\u5fc5\u987b\u7531 USP \uff08\u9762\u5411\u4e0a\u6e38\u7684\u7aef\u53e3\uff0c\u4e00\u822c\u6307 EP \u8bbe\u5907\uff09\u53d1\u8d77\uff0c\u53d1\u8d77\u540e\u8fdb\u5165 Recovery \u72b6\u6001\u3002Recovery \u72b6\u6001\u7684\u6b21\u72b6\u6001\u5982\u539f\u6587 622 \u9875\u7684\u56fe 14-48 \u6240\u793a\uff0c\u5176\u4e2d\u4e0e\u672c\u8282\u76f8\u5173\u7684\u90e8\u5206\uff0c\u4f7f\u7528\u692d\u5706\u5708\u51fa\u9ad8\u4eae\u4e86\u3002\u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u5c06\u4f1a\u5728\u9ad8\u5c42\u6b21\u7684\u901f\u7387\u6539\u53d8\u8fc7\u7a0b\u5c55\u5f00\uff0c\u5c06\u4e0d\u4f1a\u6df1\u5165\u8ba8\u8bba LTSSM \u7684\u884c\u4e3a\u7ec6\u8282\u3002\u5982\u679c\u60f3\u8981\u4e86\u89e3\u5176\u4e2d\u7684\u7ec6\u8282\uff0c\u53ef\u4ee5\u53c2\u89c1\u539f\u6587 571 \u9875\u7684 \u201cRecovery State\u201d \u4e00\u8282\u3002</p> <p></p> <p>\u56fe 14-48 Recovery \u72b6\u6001\u6b21\u72b6\u6001\u793a\u610f\u56fe</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14153-speed-change-example","title":"14.15.3 Speed Change Example // \u901f\u7387\u6539\u53d8\u793a\u4f8b","text":"<p>\u901a\u8fc7\u539f\u6587 623 \u9875\u7684\u56fe 14-49 \u5c55\u793a\u7684\u901f\u7387\u6539\u53d8\u793a\u4f8b\uff0c\u6211\u4eec\u80fd\u66f4\u6e05\u695a\u5730\u4e86\u89e3\u6574\u4e2a\u8fc7\u7a0b\u3002\u6ce8\u610f\uff0c\u8be5\u793a\u4f8b\u4e2d\u7565\u53bb\u4e86\u5747\u8861\uff08Equalization\uff09\u76f8\u5173\u72b6\u6001\uff0c\u4ee5\u4f7f\u6574\u4e2a\u793a\u4f8b\u7684\u793a\u610f\u56fe\u66f4\u52a0\u7b80\u5355\u548c\u5bb9\u6613\u7406\u89e3\u3002\u8003\u8651\u5230\u793a\u4f8b\u5c55\u793a\u7684\u662f\u4ece 2.5GT/s \u6539\u53d8\u5230 5GT/s \u7684\u8fc7\u7a0b\uff0c\u6240\u4ee5\u53cd\u6b63\u4e5f\u4e0d\u4f1a\u8fdb\u5165\u5747\u8861\u6b21\u72b6\u6001\u3002\u5982\u679c\u901f\u7387\u8981\u6539\u53d8\u4e3a 8GT/s\uff0c\u90a3\u4e48\u6574\u4e2a\u8fc7\u7a0b\u4e5f\u662f\u76f8\u540c\u7684\uff0c\u9664\u4e86\u9700\u8981\u5728\u6700\u540e\u589e\u52a0\u8fdb\u5165\u5747\u8861\u6b21\u72b6\u6001\u8fdb\u884c\u5747\u8861\u7684\u8fc7\u7a0b\u3002\u5982\u679c\u9700\u8981\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u5747\u8861\u6b21\u72b6\u6001\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u53c2\u7167\u539f\u6587 587 \u9875\u7684  \u201cRecovery.Equalization\u201d \u4e00\u8282\uff08\u8bd1\u6587 14.8.6 \u8282\uff09\u3002</p> <p>\u5728\u5982\u56fe 14-49 \u6240\u793a\u7684\u793a\u4f8b\u62d3\u6251\u8fde\u63a5\u4e2d\uff0cEP \u8bbe\u5907\u4ec5\u6709\u4e00\u4e2a USP\uff0c\u8fde\u63a5\u5230 RC \u552f\u4e00\u7684 DSP\u3002\u5728**\u53d1\u8d77\u9636\u6bb5**\u4e2d\uff0c\u53ea\u6709 USP \u53ef\u4ee5\u53d1\u8d77\u901f\u7387\u6539\u53d8\u8bf7\u6c42\uff0c\u793a\u4f8b\u4e2d\u7684 USP \u4e5f\u662f\u8fd9\u4e48\u505a\u7684\uff0c\u5176\u5185\u90e8\u53d8\u91cf Directed Speed Change \u6807\u5fd7\u4f4d\u5148\u524d\u5df2\u7ecf\u5728\u786c\u4ef6\u5b9e\u73b0\u5b9a\u4e49\u7684\u6761\u4ef6\u6ee1\u8db3\u540e\u7f6e\u8d77\uff0c\u89e6\u53d1 USP \u53d1\u8d77\u901f\u7387\u6539\u53d8\u8bf7\u6c42\u3002\u5728\u53d1\u8d77\u901f\u7387\u6539\u53d8\u8bf7\u6c42\u65f6\uff0cUSP \u5c06\u5176 LTSSM \u8df3\u53d8\u81f3 Recovery \u72b6\u6001\uff0c\u8fdb\u5165 Recovery.RcvrLock \u6b21\u72b6\u6001\uff0c\u5e76\u53d1\u8d77 Speed Change \u6bd4\u7279\u7f6e\u8d77\uff0c\u5305\u62ec\u5176\u6240\u652f\u6301\u901f\u7387\u5217\u8868\u7684 TS1 \u5e8f\u5217\uff0c\u5982\u539f\u6587 623 \u9875\u7684\u56fe 14-49 \u6240\u793a\u3002\u5f53 DSP \u63a5\u6536\u5230\u8fd9\u4e9b USP \u53d1\u751f\u7684 TS1 \u5e8f\u5217\u540e\uff0c\u5176\u540c\u6837\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u5e76\u5f00\u59cb\u7ed9 USP \u8fd4\u56de TS1 \u5e8f\u5217\u3002\u56e0\u4e3a\u63a5\u6536\u5230\u7684 TS1 \u4e2d\u7684 Speed Change \u6bd4\u7279\u7f6e\u8d77\uff0c\u6240\u4ee5 RC \u5185\u90e8\u53d8\u91cf Directed Speed Change \u6807\u5fd7\u4f4d\u4e5f\u88ab\u7f6e\u8d77\uff0c\u8fd9\u6837\u4e00\u6765 RC DSP \u53d1\u9001\u7684 TS1 \u5e8f\u5217\u4e2d\u7684 Speed Change \u6bd4\u7279\u540c\u6837\u4f1a\u88ab\u7f6e\u8d77\u3002\u56e0\u4e3a\u94fe\u8def\u4e4b\u540e\u4f1a\u5c1d\u8bd5\u8fdb\u5165\u53cc\u65b9\u6240\u540c\u65f6\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u67d0\u4e2a\u8bbe\u5907\u5e0c\u671b\u94fe\u8def\u4f7f\u7528\u66f4\u4f4e\u7684\u901f\u7387\uff0c\u5176\u53ea\u9700\u8981\u5728\u5ba3\u544a\u7684\u901f\u7387\u5217\u8868\u4e2d\uff0c\u4e0d\u8981\u5217\u51fa\u5b83\u4e0d\u60f3\u4f7f\u7528\u7684\u66f4\u9ad8\u901f\u7387\u5373\u53ef\u3002</p> <p></p> <p>\u56fe 14-49 \u901f\u7387\u6539\u53d8\u793a\u4f8b - \u53d1\u8d77\u9636\u6bb5</p> <p>\u7b2c\u4e8c\u9636\u6bb5\uff0c\u5f53 USP \u68c0\u6d4b\u5230\u8fd4\u56de\u7684 TS1 \u5e8f\u5217\u8f93\u5165\u540e\uff0cUSP \u72b6\u6001\u673a\u8df3\u53d8\u4e3a Recovery.RcvrCfg \u6b21\u72b6\u6001\uff0c\u5e76\u5f00\u59cb\u53d1\u9001 Speed Change \u6bd4\u7279\u4ecd\u7136\u7f6e\u8d77\u7684 TS2 \u5e8f\u5217\uff0c\u8fc7\u7a0b\u5982\u539f\u6587 624 \u9875\u56fe 14-50 \u6240\u793a\u3002\u5982\u679c\u901f\u7387\u6539\u53d8\u5e76\u4e0d\u662f\u56e0\u4e3a\u94fe\u8def\u53ef\u9760\u6027\u5f15\u8d77\u7684\uff0c\u90a3\u4e48\u8fd9\u4e9b TS2 \u4e2d\u7684\u81ea\u4e3b\u5e26\u5bbd\u6539\u53d8\uff08Autonomous Change\uff09\u6bd4\u7279\u7f6e\u4e3a 1\u3002DSP \u5728\u63a5\u6536\u5230\u8fd9\u4e9b Speed Change \u6bd4\u7279\u7f6e\u8d77\u7684 TS2 \u540e\uff0c LTSSM \u540c\u6837\u8fdb\u5165 Recovery.RcvrCfg \u6b21\u72b6\u6001\uff0c\u5e76\u5411 USP \u8fd4\u56de Speed Change \u6bd4\u7279\u7f6e\u8d77\u7684 TS2\u3002\u4e0d\u8fc7\uff0cDSP \u53d1\u9001\u7684 TS2 \u4e2d\u7684\u81ea\u4e3b\u5e26\u5bbd\u6539\u53d8\u6bd4\u7279\u6570\u503c\u4e0e\u63a5\u6536\u5230\u7684 TS2 \u4e2d\u7684\u6570\u503c\u76f8\u53cd\uff08\u8bd1\u6ce8\uff1a\u6b64\u4f8b\u4e2d\uff0c\u53d6\u53cd\u4e3a 0\uff09\u3002</p> <p></p> <p>\u56fe 14-50 \u901f\u7387\u6539\u53d8\u793a\u4f8b - \u7b2c\u4e8c\u9636\u6bb5</p> <p>\u7b2c\u4e09\u9636\u6bb5\uff0c\u5728\u6bcf\u4e2a\u7aef\u53e3\u90fd\u63a5\u6536\u5230 8 \u4e2a\u8fde\u7eed\u7684 Speed Change \u6bd4\u7279\u7f6e\u8d77\u7684 TS2 \u540e\uff0c\u94fe\u8def\u53cc\u65b9\u610f\u8bc6\u5230\u4e0b\u4e00\u6b65\u662f\u53cc\u65b9\u4e00\u8d77\u8fdb\u5165 Recovery.Speed \u6b21\u72b6\u6001\uff0c\u5982\u539f\u6587 625 \u9875\u7684\u56fe 14-51 \u6240\u793a\u3002\u6b64\u65f6\uff0cDSP \u9700\u8981\u8bb0\u5f55\u63a5\u6536\u5230\u7684 TS2 \u4e2d\u7684\u5e26\u5bbd\u81ea\u4e3b\u6539\u53d8\u6bd4\u7279\u7684\u6570\u503c\uff0c\u5728 PCIe \u7684 Capability Register \u4e2d\u6dfb\u52a0\u4e86\u989d\u5916\u7684\u6570\u503c\u57df\u7528\u4e8e\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002</p> <p>\u5982\u539f\u6587 625 \u9875\u7684\u56fe 14-52 \u6240\u793a\uff0c\u94fe\u8def\u72b6\u6001\uff08Link Status\uff09\u5bc4\u5b58\u5668\u4e2d\u6709\u7528\u4e8e\u8bb0\u5f55\u94fe\u8def\u5e26\u5bbd\u6539\u53d8\u76ee\u7684\u7684\u72b6\u6001\u6bd4\u7279\u3002\u5982\u679c\u8bbe\u5907\u786c\u4ef6\u652f\u6301\u5e76\u5df2\u4f7f\u80fd\u76f8\u5173\u529f\u80fd\uff0c\u4e0a\u8ff0\u72b6\u6001\u6bd4\u7279\u7684\u6539\u53d8\u4e5f\u53ef\u4ee5\u88ab\u7528\u4e8e\u89e6\u53d1\u4e2d\u65ad\uff0c\u63d0\u9192\u8f6f\u4ef6\u53d1\u751f\u4e86\u901f\u7387\u53d8\u5316\u4e8b\u4ef6\u3002\u63a7\u5236\u8fd9\u4e00\u529f\u80fd\u4f7f\u80fd\u7684\u662f\u94fe\u8def\u5e26\u5bbd\u6539\u53d8\u63d0\u9192\u4f7f\u80fd\uff08Link Bandwidth Notification Capable\uff09\u6bd4\u7279\uff0c\u5bc4\u5b58\u5668\u57df\u5982\u539f\u6587 626 \u9875\u56fe 14-53 \u6240\u793a\uff0c\u4ee5\u53ca\u94fe\u8def\u63a7\u5236\uff08Link Control\uff09\u5bc4\u5b58\u5668\u4e2d\u7684\u4e2d\u65ad\u4f7f\u80fd\uff08Interrupt Enable\uff09\u6bd4\u7279\uff0c\u5bc4\u5b58\u5668\u57df\u5982\u539f\u6587 626 \u9875\u56fe 14-54 \u6240\u793a\u3002\u6ce8\u610f\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u5e26\u5bbd\u6539\u53d8\u60c5\u51b5\uff1a\u81ea\u4e3b\u5e26\u5bbd\u6539\u53d8\uff08autonomous\uff09\u548c\u5e26\u5bbd\u7ba1\u7406\uff08bandwidth management\uff09\u3002\u81ea\u4e3b\u5e26\u5bbd\u6539\u53d8\u610f\u5473\u7740\u5e76\u4e0d\u662f\u56e0\u4e3a\u94fe\u8def\u53ef\u9760\u6027\u95ee\u9898\uff0c\u6240\u4ee5\u624d\u6539\u53d8\u94fe\u8def\u5e26\u5bbd\uff08\u901f\u7387\uff09\uff0c\u800c\u5e26\u5bbd\u7ba1\u7406\u6307\u7684\u5c31\u662f\u4e3a\u89e3\u51b3\u53ef\u9760\u6027\u95ee\u9898\uff0c\u6539\u53d8\u94fe\u8def\u5e26\u5bbd\uff08\u901f\u7387\uff09\u3002</p> <p></p> <p>\u56fe 14-51 \u901f\u7387\u6539\u53d8-\u7b2c\u4e09\u9636\u6bb5</p> <p></p> <p>\u56fe 14-52 \u5e26\u5bbd\u6539\u53d8\u72b6\u6001\u6bd4\u7279</p> <p></p> <p>\u56fe 14-53 \u5e26\u5bbd\u901a\u77e5 Capability</p> <p></p> <p>\u56fe 14-54 \u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668\uff08\u539f\u6587\u56fe\u6ce8\u6709\u8bef\uff09</p> <p>\u7ed3\u675f\u9636\u6bb5\uff0c\u5728\u8fdb\u5165 Recovery.Speed \u6b21\u72b6\u6001\u540e\uff0c\u94fe\u8def\u4f1a\u5728\u4e24\u4e2a\u65b9\u5411\u4e0a\u90fd\u88ab\u7f6e\u4e8e\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u5e76\u8c03\u6574\u5185\u90e8\u7535\u8def\u7684\u901f\u7387\u3002\u8c03\u6574\u540e\u7684\u901f\u7387\u662f\u53cc\u65b9\u5728 TS1 \u4ee5\u53ca TS2 \u4e2d\u53d1\u9001\u7684\u652f\u6301\u901f\u7387\u5217\u8868\uff08Rate ID \u57df\uff09\u4e2d\u53cc\u65b9\u540c\u65f6\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u3002\u672c\u4f8b\u4e2d\uff0c\u53cc\u65b9\u5171\u540c\u652f\u6301\u7684\u6700\u9ad8\u901f\u7387\u4e3a 5GT/s\uff0c\u6240\u4ee5\u94fe\u8def\u6539\u53d8\u4e3a\u8be5\u901f\u7387\u3002\u5728\u7b49\u5f85\u4e00\u6bb5\u5ef6\u65f6\u540e\uff0c\u94fe\u8def\u53cc\u65b9\u540c\u65f6\u56de\u5230 Recovery.RcvrLock \u6b21\u72b6\u6001\uff0c\u5e76\u901a\u8fc7\u91cd\u65b0\u53d1\u9001 TS1 \u9000\u51fa\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\uff0c\u5982\u539f\u6587 627 \u9875\u56fe 14-55 \u6240\u793a\u3002\u5728 USP \u63a5\u6536\u5230\u91cd\u65b0\u53d1\u9001\u7684 TS1 \u540e\uff0c\u5176 LTSSM \u8df3\u8f6c\u5230 Recovery.RcvrCfg \u72b6\u6001\uff0c\u5f00\u59cb\u53d1\u9001 TS2 \u5e8f\u5217\uff0c\u540c\u4e0a\u4e00\u6b21\u7531Recovery.RcvrLock \u6b21\u72b6\u6001\u8fdb\u5165 Recovery.RcvrCfg \u6b21\u72b6\u6001\u8fc7\u7a0b\u76f8\u540c\u3002\u4e0d\u8fc7\u6b64\u65f6 TS1 \u4e2d\u7684 Speed Change \u6bd4\u7279\u4e0d\u4f1a\u88ab\u7f6e\u8d77\u3002\u6700\u7ec8\uff0cUSP \u63a5\u6536\u5230 DSP \u8fd4\u56de\u7684\uff0cSpeed Change \u6bd4\u7279\u672a\u7f6e\u8d77\u7684 TS2 \u5e8f\u5217\uff0c\u6b64\u65f6 USP \uff08\u4ee5\u53ca DSP\uff09LTSSM \u9014\u5f84 Recovery.Idle \u6b21\u72b6\u6001\u8fd4\u56de L0 \u72b6\u6001\u3002</p> <p>\u5982\u679c\u901f\u7387\u6539\u53d8\u56e0\u4e3a\u4e00\u4e9b\u539f\u56e0\u5931\u8d25\uff0c\u8bbe\u5907\u4e0d\u88ab\u5141\u8bb8\u5728\u5931\u8d25\u5e76\u8fd4\u56de L0 \u7684 200ms \u5185\u91cd\u65b0\u534f\u5546\u8be5\u901f\u7387\u6216\u8005\u66f4\u9ad8\u901f\u7387\uff0c\u6216\u8005\u7b49\u5f85\u94fe\u8def\u4f19\u4f34\u901a\u544a\u5176\u652f\u6301\u65b0\u7684\u66f4\u9ad8\u901f\u7387\uff0c\u624d\u80fd\u91cd\u65b0\u53d1\u8d77\u901f\u7387\u6539\u53d8\u534f\u5546\u3002</p> <p></p> <p>\u56fe 14-55 \u901f\u7387\u6539\u53d8-\u7ed3\u675f\u9636\u6bb5</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14154-software-control-of-speed-changes","title":"14.15.4 Software Control of Speed Changes // \u901f\u7387\u6539\u53d8\u7684\u8f6f\u4ef6\u63a7\u5236","text":"<p>\u5f53\u786c\u4ef6\u5df2\u7ecf\u51b3\u5b9a\u6539\u53d8\u94fe\u8def\u901f\u7387\u540e\uff0c\u8f6f\u4ef6\u65e0\u6cd5\u518d\u63a7\u5236\u901f\u7387\u6539\u53d8\u6d41\u7a0b\uff0c\u4f46\u662f\u8f6f\u4ef6\u53ef\u4ee5\u9650\u5236\u6216\u8005\u7981\u6b62\u786c\u4ef6\u7684\u901f\u7387\u6539\u53d8\u884c\u4e3a\u3002\u901a\u8fc7\u539f\u6587 628 \u9875\u56fe 14-56 \u6240\u793a\u7684\u94fe\u8def\u63a7\u5236 2 \uff08Link Control 2\uff09\u5bc4\u5b58\u5668\u7684**\u76ee\u6807\u94fe\u8def\u901f\u7387**\uff08Target Link Speed\uff09\u6570\u503c\u53ef\u4ee5\u9650\u5236\u786c\u4ef6\u901f\u7387\u6539\u53d8\u884c\u4e3a\u3002\u8be5\u6570\u503c\u4f1a\u8bbe\u5b9a USP \u6240\u80fd\u53d1\u8d77\u901f\u7387\u6539\u53d8\u7684\u6700\u9ad8\u76ee\u6807\u901f\u7387\uff0c\u6216\u8005\u7528\u4e8e\u4fdd\u6301\u5f53\u524d\u94fe\u8def\u901f\u7387\u3002\u8f6f\u4ef6\u4e5f\u53ef\u4ee5\u5f3a\u5236\u786c\u4ef6\u5c1d\u8bd5\u5c06\u94fe\u8def\u901f\u7387\u8bbe\u5b9a\u4e3a\u67d0\u4e2a\u7279\u5b9a\u901f\u7387\uff0c\u9996\u5148\u8bbe\u7f6e USP \u7684**\u76ee\u6807\u94fe\u8def\u901f\u7387**\uff0c\u7136\u540e\u7f6e\u4f4d**\u94fe\u8def\u63a7\u5236**\uff08Link Control\uff09\u5bc4\u5b58\u5668\u4e2d\u7684\uff08Retrain Link\uff09\u94fe\u8def\u91cd\u8bad\u7ec3**\u6bd4\u7279\uff0c\u5bc4\u5b58\u5668\u57df\u5982\u539f\u6587 629 \u9875\u56fe 14-57 \u6240\u793a\u3002\u53e6\u5916\uff0c\u5982\u524d\u6587\u6240\u8ff0\uff0c\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u94fe\u8def\u5e26\u5bbd\u901a\u77e5\u673a\u5236\u5f97\u77e5\u4efb\u4f55\u786c\u4ef6\u5b8c\u6210\u7684\u94fe\u8def\u901f\u7387\u6216\u8005\u5e26\u5bbd\u53d8\u5316\u3002\u6700\u540e\uff0c\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e**\u7981\u6b62\u786c\u4ef6\u81ea\u53d1\u901f\u7387\u6539\u53d8\uff08Hardware Autonomous Speed Disable\uff09\u6bd4\u7279\u5173\u95ed\u786c\u4ef6\u7684\u81ea\u52a8\u901f\u7387\u6539\u53d8\u529f\u80fd\u3002</p> <p></p> <p>\u56fe 14-56 \u94fe\u8def\u63a7\u5236 2 \u5bc4\u5b58\u5668</p> <p></p> <p>\u56fe 14-57 \u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14155-dynamic-link-width-changes","title":"14.15.5 Dynamic Link Width Changes // \u52a8\u6001\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8","text":"<p>\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u7684\u57fa\u672c\u8fc7\u7a0b\u548c\u901f\u7387\u6539\u53d8\u76f8\u540c\uff0c\u4f46\u662f\u4f4d\u5bbd\u6539\u53d8\u7684\u8fc7\u7a0b\u4f1a\u76f8\u5bf9\u66f4\u52a0\u590d\u6742\uff0c\u56e0\u4e3a\u7275\u6d89\u5230\u66f4\u591a\u7684 LTSSM \u72b6\u6001\u6539\u53d8\u6b65\u9aa4\u3002\u8f6f\u4ef6\u5728\u4f7f\u80fd\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u4e4b\u524d\u9700\u8981\u4e86\u89e3\u4e00\u4ef6\u91cd\u8981\u7684\u4e8b\u60c5\uff0c\u90a3\u5c31\u662f\u5bf9\u7aef\u8bbe\u5907\u662f\u5426\u652f\u6301\u5c06\u7a84\u94fe\u8def\u6062\u590d\u6210\u5bbd\u5ea6\u8f83\u5bbd\u7684\u94fe\u8def\uff08\u8be5\u7279\u6027\u88ab\u79f0\u4e3a Link Upconfiguring\uff09\u3002\u8bbe\u5907\u5728\u4ed6\u4eec\u8bad\u7ec3\u671f\u95f4\u53d1\u9001\u7684 TS2 \u5e8f\u5217\u4e2d\u7684 Rate ID \u57df\u7684\u6bd4\u7279 6 \u4f4d\u7f6e\u901a\u544a\u4ed6\u4eec\u662f\u5426\u652f\u6301\u8fd9\u4e00\u7279\u6027\uff0c\u5982\u539f\u6587 630 \u9875\u56fe 14-58 \u6240\u793a\u3002\u5982\u679c\u5bf9\u7aef\u8bbe\u5907\u4e0d\u652f\u6301\u8fd9\u4e00\u7279\u6027\uff0c\u90a3\u4e48\u610f\u5473\u7740\u5c06\u94fe\u8def\u5bbd\u5ea6\u6539\u5c0f\u4f1a\u662f\u4e00\u9524\u5b50\u4e70\u5356\uff08\u65e0\u6cd5\u6062\u590d\u56de\u539f\u6765\u5c06\u5bbd\u7684\u94fe\u8def\u5bbd\u5ea6\uff09\uff0c\u6b64\u65f6\u53ea\u4f1a\u5728\u51fa\u73b0\u94fe\u8def\u53ef\u9760\u6027\u95ee\u9898\u65f6\uff0c\u624d\u4f1a\u51cf\u5c0f\u94fe\u8def\u5bbd\u5ea6\u3002</p> <p></p> <p>\u56fe 14-58 TS2 \u5e8f\u5217\u5185\u5bb9</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14156-link-width-change-example","title":"14.15.6 Link Width Change Example // \u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u793a\u4f8b","text":"<p>\u8ba9\u6211\u6765\u770b\u4e00\u4e2a\u793a\u4f8b\uff0c\u793a\u4f8b\u57fa\u4e8e\u5982\u539f\u6587 631 \u9875\u56fe 14-59 \u6240\u793a\u7684\u8fde\u63a5\u62d3\u6251\uff0c\u4e00\u4e2a\u6839\u7aef\u53e3\uff08Root Port\uff09\u8fde\u63a5\u5230\u4e00\u4e2a EP\uff08\u5343\u5146\u4ee5\u592a\u7f51\u8bbe\u5907\uff09\u3002\u540c\u6837\u5730\uff0c\u53ea\u6709 USP \u624d\u80fd\u591f\u53d1\u8d77\u94fe\u8def\u5bbd\u5ea6\u7684\u6539\u53d8\uff0c\u548c\u524d\u6587\u901f\u7387\u6539\u53d8\u65f6\u4e00\u6837\uff0cUSP \u5148\u4f7f\u81ea\u8eab\u8fdb\u5165 Recovery \u72b6\u6001\u53d1\u8d77\u8fd9\u4e00\u64cd\u4f5c\u3002\u4f46\u6b64\u65f6\u4e0d\u4f1a\u5728 TS\u00bd \u4e2d\u7f6e\u8d77 Speed Change \u6807\u5fd7\u3002\u4e3a\u4e86\u786e\u5b9a\u6539\u53d8\u540e\u7684\u94fe\u8def\u5bbd\u5ea6\uff0cUSP \u4f1a\u901a\u77e5 DSP \u5728\u4ece Recovery \u72b6\u6001\u8fd4\u56de L0 \u72b6\u6001\u4e4b\u524d\uff0c\u8fdb\u5165\u4e00\u6b21 Configuration \u72b6\u6001\uff0c\u5982\u539f\u6587 631 \u9875\u56fe 14-60 \u6240\u8ff0\u3002Configuration \u72b6\u6001\u5305\u542b\u591a\u4e2a\u6b21\u72b6\u6001\uff0c\u539f\u6587 632 \u9875\u7684\u56fe 14-60 \u7ed9\u51fa\u4e86\u4e00\u4e2a\u7b80\u5316\u7248\u7684\u72b6\u6001\u8df3\u53d8\u8fc7\u7a0b\u793a\u610f\u56fe\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4f1a\u4e00\u4e00\u8ba8\u8bba\u5404\u4e2a\u6b65\u9aa4\u3002</p> <p></p> <p>\u56fe 14-59 \u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u793a\u4f8b\u62d3\u6251\u8fde\u63a5\u56fe</p> <p></p> <p>\u56fe 14-60 \u94fe\u8def\u5bbd\u5ea6\u6539\u53d8 LTSSM \u72b6\u6001\u53d8\u5316\u8fc7\u7a0b</p> <p></p> <p>\u56fe 14-61 \u7b80\u5316\u540e\u7684 Configuration \u6b21\u72b6\u6001\u8df3\u53d8\u793a\u610f\u56fe</p> <p>\u5982\u524d\u6587\u6240\u8ff0\u901f\u7387\u53d8\u5316\u7684\u8fc7\u7a0b\u76f8\u540c\uff0cUSP \u8fdb\u5165 Recovery \u72b6\u6001\u53d1\u8d77\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\u8bf7\u6c42\uff0c\u5e76\u53d1\u9001 TS1 \u5e8f\u5217\uff0c\u5176\u4e2d Speed Change \u6bd4\u7279\u5e76\u672a\u7f6e\u8d77\uff0c\u5982\u539f\u6587 631 \u9875\u56fe 14-59\u6240\u793a\uff0c\u793a\u4f8b\u4e2d\u4ee5\u592a\u7f51\u8bbe\u5907\u4f5c\u4e3a USP\uff0c\u7387\u5148\u53d1\u8d77\u8fd9\u4e00\u8fc7\u7a0b\u3002\u4f5c\u4e3a\u56de\u5e94\uff0cDSP \u4e5f\u53d1\u9001 TS1 \u8fd4\u56de\u7ed9 USP\uff0c\u5176 Speed Change \u6bd4\u7279\u4e5f\u672a\u7f6e\u8d77\uff0c\u6b64\u65f6 TS1 \u4e2d\u7684\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u4fdd\u6301\u4e0d\u53d8\uff0c\u4ecd\u4e3a\u5148\u524d\u94fe\u8def\u8bad\u7ec3\u7684\u7ed3\u679c\u503c\u3002\u6839\u636e\u524d\u6587\u4e2d\u4f4d\u4e8e\u539f\u6587 622 \u9875\u7684\u56fe 14-48\uff0c\u6b64\u65f6\uff0c\u63a5\u4e0b\u6765\u4e00\u4e2a\u6b21\u72b6\u6001\u662f Recovery.RcvrCfg\uff0c\u5728\u8be5\u6b21\u72b6\u6001\u53cc\u65b9\u4f1a\u4ea4\u6362 TS2\u3002</p> <p></p> <p>\u56fe 14-62 \u94fe\u8def\u5bbd\u5ea6\u6539\u53d8 - \u5f00\u59cb\u9636\u6bb5</p> <p>\u56e0\u4e3a\u6b64\u65f6\u6ca1\u6709\u8bf7\u6c42\u901f\u7387\u53d8\u6362\uff08TS \u4e2d\u7684 Speed Change \u6bd4\u7279\u4e3a 0\uff09\uff0c\u6240\u4ee5\u63a5\u4e0b\u6765\u76f4\u63a5\u8fdb\u5165 Recovery.Idle \u72b6\u6001\u3002\u5728\u8be5\u6b21\u72b6\u6001\u4e2d\uff0c\u53cc\u65b9\u4e00\u822c\u53d1\u9001\u903b\u8f91\u7a7a\u95f2\u4fe1\u53f7\uff08\u5373\u5168\u96f6\u4fe1\u53f7\uff09\uff0c\u5982\u539f\u6587 634 \u9875\u56fe 14-63 \u6240\u793a\u3002\u4f46\u662f\uff0c\u56e0\u4e3a\u6b64\u65f6 USP \u60f3\u8981\u6539\u53d8\u94fe\u8def\u5bbd\u5ea6\uff0c\u6240\u4ee5 USP \u4e0d\u4f1a\u53d1\u9001\u903b\u8f91\u7a7a\u95f2\u4fe1\u53f7\uff0c\u800c\u662f\uff0c\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u5747\u4e3a PAD \u7684 TS1\u3002DSP \u8bc6\u522b\u5230\u63a5\u6536\u7684 TS1 \u4e2d\uff0c\u539f\u672c\u5df2\u7ecf\u5b8c\u6210\u914d\u7f6e\u7684\u901a\u9053\u7f16\u53f7\u53d8\u6210\u4e86 PAD\uff0c\u610f\u8bc6\u5230\u5bf9\u7aef\u60f3\u8981\u6539\u53d8\u4f4d\u5bbd\uff0c\u6240\u4ee5\u63a5\u4e0b\u6765\u8fdb\u5165 Configuration \u7684\u7b2c\u4e00\u4e2a\u6b21\u72b6\u6001\uff1aConfig.Linkwidth.Start\u3002</p> <p></p> <p>\u56fe 14-63 \u94fe\u8def\u5bbd\u5ea6\u6539\u53d8 - Recovery Idle \u9636\u6bb5</p> <p>DSP \u5728 Configuration \u72b6\u6001\u4e2d\u53d1\u8d77\u5bf9 USP \u901a\u9053\u7684\u914d\u7f6e\u5de5\u4f5c\uff0c\u5411 USP \u53d1\u9001 TS1 \u5e8f\u5217\uff0c\u5176\u4e2d\u94fe\u8def\u7f16\u53f7\u57df\u4e3a\u539f\u534f\u5546\u94fe\u8def\u7f16\u53f7\uff0c\u4f46\u662f\u6240\u6709\u901a\u9053\u4e0a\u53d1\u9001\u7684 TS1 \u4e2d\u7684\u901a\u9053\u7f16\u53f7\u57df\u90fd\u4f7f\u7528 PAD \u586b\u5145\uff0c\u5982\u539f\u6587 635 \u9875\u56fe 14-64 \u6240\u793a\u3002USP \u5728\u5176\u60f3\u8981 \u201c\u6fc0\u6d3b\u201d \uff08active\uff09\u7684\u901a\u9053\u4e0a\u56de\u5e94\u76f8\u540c\u7684 TS1\uff0c\u4f46\u5728 USP \u4e0d\u60f3\u8981\u6fc0\u6d3b\u7684\u901a\u9053\u4e0a\uff0c\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u5747\u4f7f\u7528 PAD \u586b\u5145\u7684 TS1\u3002DSP \u5728\u63a5\u6536\u5230\u8fd9\u4e9b TS1 \u56de\u590d\u540e\uff0c\u8f6c\u5165 Config.Linkwidth.Accept \u6b21\u72b6\u6001\u3002\u6ce8\u610f\uff0c\u6b64\u65f6\u6240\u6709 TS1 \u7684\u81ea\u4e3b\u6539\u53d8\uff08Autonomous Change\uff09\u6bd4\u7279\u5747\u4e3a 1\u3002</p> <p></p> <p>\u56fe 14-64 USP \u6807\u8bc6\u6240\u9700\u6fc0\u6d3b\u7684\u901a\u9053</p> <p>\u4f5c\u4e3a\u56de\u5e94\uff0cRP \u5728\u90a3\u4e9b\u5df2\u6fc0\u6d3b\u901a\u9053\u4e0a\uff0c\u8f6c\u800c\u53d1\u9001\u5e26\u6709\u5408\u9002\u901a\u9053\u7f16\u53f7\u7684 TS1 \u5e8f\u5217\uff0c\u800c\u5728\u90a3\u4e9b\u975e\u6fc0\u6d3b\u901a\u9053\u4e0a\u5219\u53d1\u9001\u94fe\u8def\u548c\u901a\u9053\u7f16\u53f7\u90fd\u662f PAD \u7684 TS1 \u5e8f\u5217\u3002USP \u5219\u56de\u5e94\u76f8\u540c\u7684 TS1 \u5e8f\u5217\uff0c\u5982\u539f\u6587 636 \u9875\u56fe 14-65 \u6240\u793a\uff0c\u5e76\u5c06\u72b6\u6001\u673a\u72b6\u6001\u6539\u53d8\u4e3a Config.Lanenum.Accept \u6b21\u72b6\u6001\u3002\u6b64\u65f6\uff0cRP \u66f4\u65b0\u5176\u5bc4\u5b58\u5668\u4e2d\u7684\u72b6\u6001\u6bd4\u7279\uff0c\u8868\u793a\u68c0\u6d4b\u5230\u4e00\u6b21\u81ea\u53d1\u7684\u5e26\u5bbd\u6539\u53d8\uff0c\u5e76\u5c06\u72b6\u6001\u8f6c\u79fb\u4e3a Config.Complete \u6b21\u72b6\u6001\u3002</p> <p></p> <p>\u56fe 14-65 DSP/USP \u54cd\u5e94\u901a\u9053\u7f16\u53f7\u53d8\u5316</p> <p>\u4e0b\u4e00\u6b65\u4e2d\uff0cRP \u5f00\u59cb\u5728\u90a3\u4e9b\u6fc0\u6d3b\u901a\u9053\u4e0a\u53d1\u9001 TS2 \u5e8f\u5217\uff0c\u5e76\u5c06\u975e\u6fc0\u6d3b\u901a\u9053\u6539\u53d8\u4e3a\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u8ba9\u6211\u4eec\u56de\u5fc6\u4e00\u4e0b\uff0cTS2 \u4f1a\u5728\u5176\u76f8\u5173\u5b57\u6bb5\u4e2d\u901a\u62a5\u8be5\u8bbe\u5907\u662f\u5426\u652f\u6301 \u201cupconfigure\u201d \u80fd\u529b\uff0c\u5728\u672c\u4f8b\u4e2d\uff0c\u94fe\u8def\u53cc\u65b9\u90fd\u652f\u6301\u8be5\u80fd\u529b\u3002EP \u4ee5\u76f8\u540c\u7684\u884c\u4e3a\u4f5c\u4e3a\u56de\u5e94\uff0c\u5728\u90a3\u4e9b\u6fc0\u6d3b\u901a\u9053\u4e0a\u53d1\u9001 TS2 \u5e8f\u5217\uff0c\u5e76\u5c06\u975e\u6fc0\u6d3b\u901a\u9053\u6539\u53d8\u4e3a\u7535\u6c14\u7a7a\u95f2\u72b6\u6001\u3002\u5728\u68c0\u6d4b\u5230 EP \u7684\u56de\u5e94\u540e\uff0cRP \u72b6\u6001\u673a\u6539\u53d8\u4e3a Config.Idle \u72b6\u6001\uff0c\u5e76\u5728\u6fc0\u6d3b\u901a\u9053\u4e0a\u53d1\u9001\u903b\u8f91\u7a7a\u95f2\u4fe1\u53f7\u3002EP \u4ee5\u76f8\u540c\u7684\u884c\u4e3a\u4f5c\u4e3a\u56de\u5e94\uff0c\u5e76\u5c06\u5176\u72b6\u6001\u673a\u6539\u53d8\u56de\u5230 L0 \u5de5\u4f5c\u72b6\u6001\u3002\u6b64\u65f6\uff0c\u94fe\u8def\u5df2\u7ecf\u6062\u590d\u4e86\u6b63\u5e38\u7684\u5de5\u4f5c\u72b6\u6001\uff0c\u53ea\u662f\u6216\u8bb8\u4e3a\u4e86\u7701\u7535\uff0c\u51cf\u5c11\u901a\u9053\u964d\u4f4e\u4e86\u5e26\u5bbd\u3002</p> <p></p> <p>\u56fe 14-66 \u94fe\u8def\u5bbd\u5ea6\u6539\u53d8 - \u7ed3\u675f\u9636\u6bb5</p> <p>\u548c\u52a8\u6001\u901f\u7387\u6539\u53d8\u65f6\u4e00\u6837\uff0c\u8f6f\u4ef6\u4e0d\u80fd\u591f\u53d1\u8d77\u94fe\u8def\u5bbd\u5ea6\u6539\u53d8\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u94fe\u8def\u63a7\u5236\uff08Link Control\uff09\u5bc4\u5b58\u5668\u4e2d\u7684\u76f8\u5e94\u6bd4\u7279\u7981\u6b62\u786c\u4ef6\u53d1\u8d77\u8be5\u8bf7\u6c42\uff0c\u5982\u539f\u6587 638 \u9875\u7684\u56fe 14-67 \u6240\u793a\u3002\u4f46\u548c\u901f\u7387\u6539\u53d8\u7684\u65f6\u4e0d\u540c\u7684\u60c5\u51b5\u662f\uff0c\u6ca1\u6709\u76f8\u5e94\u7684\u8f6f\u4ef6\u673a\u5236\u80fd\u591f\u5c06\u94fe\u8def\u5bbd\u5ea6\u8bbe\u4e3a\u7279\u5b9a\u503c\u3002</p> <p></p> <p>\u56fe 14-67 \u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#1416-related-configuration-registers","title":"14.16 Related Configuration Registers // \u76f8\u5173\u914d\u7f6e\u5bc4\u5b58\u5668","text":"<p>\u6211\u4eec\u5728\u524d\u6587\u4e2d\u591a\u6b21\u63d0\u53ca\u4e00\u4e9b\u548c\u94fe\u8def\u521d\u59cb\u5316\u548c\u8bad\u7ec3\u76f8\u5173\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\uff08Configuration Register\uff09\uff0c\u5728\u8fd9\u4e00\u8282\u6211\u4eec\u5c06\u5bf9\u5b83\u4eec\u505a\u4e00\u756a\u603b\u7ed3\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14161-link-capabilities-register","title":"14.16.1 Link Capabilities Register // \u94fe\u8def\u80fd\u529b\u5bc4\u5b58\u5668","text":"<p>\u94fe\u8def\u80fd\u529b\u5bc4\u5b58\u5668\u5404\u6bd4\u7279\u542b\u4e49\u5982\u539f\u6587 639 \u9875\u56fe 14-68 \u6240\u793a\uff0c\u672c\u8282\u8be6\u7ec6\u63cf\u8ff0\u4e86\u548c\u94fe\u8def\u521d\u59cb\u5316\u548c\u8bad\u7ec3\u76f8\u5173\u6bd4\u7279\u7684\u542b\u4e49\u3002</p> <p></p> <p>\u56fe 14-68 \u94fe\u8def\u80fd\u529b\u5bc4\u5b58\u5668\u5404\u6bd4\u7279\u542b\u4e49\u793a\u610f\u56fe</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#max-link-speed-30","title":"Max Link Speed [3:0]","text":"<p>\u6b64\u5904\u63cf\u8ff0\u7684\u662f\u94fe\u8def\u7684\u6700\u9ad8\u901f\u7387\uff0c\u5176\u503c\u662f\u4e00\u4e2a\u6307\u5411\u94fe\u8def\u80fd\u529b 2 \uff08Link Capabilities 2\uff09\u5bc4\u5b58\u5668\u7684\u94fe\u8def\u652f\u6301\u901f\u7387\u5411\u91cf\uff08Supported Link Speeds Vector\uff09\u57df\u7684\u6307\u9488\u3002\u6307\u9488\u6307\u5411\u7684\u6bd4\u7279\u6240\u4ee3\u8868\u7684\u901f\u7387\u4e3a\u94fe\u8def\u6700\u9ad8\u901f\u7387\uff0c\u5177\u4f53\u5b9a\u4e49\u5982\u4e0b\uff1a \u2022 0001b \u2010 Supported Link Speeds Vector field bit 0 \u2022 0010b \u2010 Supported Link Speeds Vector field bit 1 \u2022 0011b \u2010 Supported Link Speeds Vector field bit 2 \u2022 0100b \u2010 Supported Link Speeds Vector field bit 3 \u2022 0101b \u2010 Supported Link Speeds Vector field bit 4 \u2022 0110b \u2010 Supported Link Speeds Vector field bit 5 \u2022 0111b \u2010 Supported Link Speeds Vector field bit 6</p> <p>\u9664\u6b64\u4ee5\u5916\u6240\u6709\u7684\u503c\u4e3a reserved\uff0c\u65e0\u542b\u4e49\u3002\u540c\u4e00\u4e2a USP \u4e2d\u7684\u591a\u4e2a function \u5fc5\u987b\u4f7f\u7528\u540c\u4e00\u4e2a\u6570\u503c\u3002\u8be5\u5bc4\u5b58\u5668\u662f\u4e00\u4e2a\u53ea\u8bfb\u5bc4\u5b58\u5668\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#maximum-link-width94","title":"Maximum Link Width[9:4]","text":"<p>\u6b64\u5904\u63cf\u8ff0\u7684\u662f PCIe \u94fe\u8def\u7684\u6700\u5927\u5bbd\u5ea6\uff0c\u5177\u4f53\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <p>\u2022 00 0000b: Reserved \u2022 00 0001b: x1 \u2022 00 0010b: x2 \u2022 00 0100b: x4 \u2022 00 1000b: x8 \u2022 00 1100b: x12 \u2022 01 0000b: x16 \u2022 10 0000b: x32</p> <p>\u9664\u6b64\u4ee5\u5916\u6240\u6709\u7684\u503c\u4e3a reserved\uff0c\u65e0\u542b\u4e49\u3002\u540c\u4e00\u4e2a USP \u4e2d\u7684\u591a\u4e2a function \u5fc5\u987b\u4f7f\u7528\u540c\u4e00\u4e2a\u6570\u503c\u3002\u8be5\u5bc4\u5b58\u5668\u662f\u4e00\u4e2a\u53ea\u8bfb\u5bc4\u5b58\u5668\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14162-link-capabilities-2-register-2","title":"14.16.2 Link Capabilities 2 Register // \u94fe\u8def\u80fd\u529b 2 \u5bc4\u5b58\u5668","text":"<p>\u5728\u4e0a\u4e00\u5e45\u56fe\u7247\u56fe 14-68 \u7684\u94fe\u8def\u5bc4\u5b58\u5668\u4e2d\u7684\u6700\u9ad8\u94fe\u8def\u901f\u7387\u57df\uff0c\u662f\u4e00\u4e2a\u6307\u5411\u672c\u5bc4\u5b58\u5668\u94fe\u8def\u652f\u6301\u901f\u7387\u5411\u91cf\u57df\u7684\u6307\u9488\uff0c\u8be5\u57df\u5728\u5bc4\u5b58\u5668\u7684\u4f4d\u7f6e\u5982\u56fe 14-69 \u6240\u793a\uff0c\u5177\u4f53\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <p>\u2022 Bit 0 = 2.5 GT/s \u2022 Bit 1 = 5.0 GT/s \u2022 Bit 2 = 8.0 GT/s \u2022 Bits 6:3 RsvdP (reserved \u5e76 preserved)</p> <p></p> <p>\u56fe 14-69 \u94fe\u8def\u80fd\u529b 2 \u5bc4\u5b58\u5668</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14163-link-status-register","title":"14.16.3 Link Status Register // \u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668","text":"<p>\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\u5982\u539f\u6587 597 \u9875\u7684\u56fe 14-39 \u6240\u793a\uff1a</p> <p></p> <p>\u56fe 14-39 \u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#current-link-speed30","title":"Current Link Speed[3:0]","text":"<p>\u8be5\u53ea\u8bfb\u5bc4\u5b58\u5668\u8868\u793a\u5f53\u524d\u7684\u94fe\u8def\u901f\u5ea6\u3002\u5728\u94fe\u8def\u9996\u6b21\u8fdb\u5165 L0 \u72b6\u6001\u65f6\uff0c\u94fe\u8def\u901f\u5ea6\u59cb\u7ec8\u4e3a 2.5GT/s\u3002\u5728\u6b64\u4e4b\u540e\uff0c\u5982\u679c\u94fe\u8def\u53cc\u65b9\u5171\u540c\u652f\u6301\u66f4\u9ad8\u7684\u901f\u7387\uff0c\u5219\u94fe\u8def\u901a\u8fc7\u8fdb\u5165 Recovery \u72b6\u6001\uff0c\u5c1d\u8bd5\u6539\u53d8\u5230\u66f4\u9ad8\u7684\u901f\u5ea6\u3002\u8be5\u5bc4\u5b58\u5668\u57df\u7684\u7f16\u7801\u65b9\u5f0f\u548c\u6700\u5927\u94fe\u8def\u901f\u5ea6\u57df\u76f8\u540c\uff0c\u4e3a\u4e00\u4e2a\u6307\u5411\u94fe\u8def\u652f\u6301\u901f\u7387\u5411\u91cf\u57df\u7684\u6307\u9488\uff1a</p> <p>\u2022 0001b \u2010 Supported Link Speeds Vector field bit 0 \u2022 0010b \u2010 Supported Link Speeds Vector field bit 1 \u2022 0011b \u2010 Supported Link Speeds Vector field bit 2 \u2022 0100b \u2010 Supported Link Speeds Vector field bit 3 \u2022 0101b \u2010 Supported Link Speeds Vector field bit 4 \u2022 0110b \u2010 Supported Link Speeds Vector field bit 5 \u2022 0111b \u2010 Supported Link Speeds Vector field bit 6</p> <p>\u9664\u6b64\u4ee5\u5916\u6240\u6709\u7684\u503c\u4e3a reserved\uff0c\u65e0\u542b\u4e49\u3002</p> <p>\u6ce8\u610f\uff1a\u5982\u679c\u94fe\u8def\u8fd8\u6ca1\u6709 link up\uff0c\u5219\u8be5\u57df\u4e3a\u672a\u5b9a\u4e49\u72b6\u6001\uff08LinkUp = 0b\uff09\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#negotiated-link-width94","title":"Negotiated Link Width[9:4]","text":"<p>\u8be5\u5bc4\u5b58\u5668\u8868\u793a\u7684\u662f\u94fe\u8def\u5bbd\u5ea6\u534f\u5546\u7684\u7ed3\u679c\u3002\u6709\u4e03\u79cd\u53ef\u80fd\u7684\u5bbd\u5ea6\uff0c\u5176\u4ed6\u4e3a\u65e0\u542b\u4e49\u503c\u3002\u5177\u4f53\u542b\u4e49\u5982\u4e0b\uff1a</p> <p>\u2022 00 0001b: for x1. \u2022 00 0010b for x2. \u2022 00 0100b for x4. \u2022 00 1000b for x8. \u2022 00 1100b for x12. \u2022 01 0000b for x16. \u2022 10 0000b for x32.</p> <p>\u9664\u6b64\u4ee5\u5916\u6240\u6709\u7684\u503c\u4e3a reserved\uff0c\u65e0\u542b\u4e49\u3002</p> <p>\u6ce8\u610f\uff1a\u5982\u679c\u94fe\u8def\u8fd8\u6ca1\u6709 link up\uff0c\u5219\u8be5\u57df\u4e3a\u672a\u5b9a\u4e49\u72b6\u6001\uff08LinkUp = 0b\uff09\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#undefined10","title":"Undefined[10]","text":"<p>\u76ee\u524d\u7684\u534f\u8bae\u7248\u672c\u4e2d\uff0c\u8be5\u57df\u65e0\u5b9a\u4e49\u3002\u5728\u65e9\u524d\u7684\u534f\u8bae\u7248\u672c\u4e2d\uff0c\u5982\u679c\u94fe\u8def\u8bad\u7ec3\u53d1\u751f\u9519\u8bef\uff0c\u90a3\u4e48\u786c\u4ef6\u4f1a\u5c06\u8be5\u4f4d\u5199 1\uff0c\u5e76\u5728 LTSSM \u8fdb\u5165 L0 \u72b6\u6001\u540e\u6e05\u9664\u3002\u76ee\u524d\u534f\u8bae\u89c4\u5b9a\u8f6f\u4ef6\u53ef\u4ee5\u5411\u8be5\u5bc4\u5b58\u5668\u57df\u4e2d\u5199\u5165\u4efb\u4f55\u503c\uff0c\u4f46\u5fc5\u987b\u5ffd\u7565\u4ece\u8be5\u5bc4\u5b58\u5668\u4e2d\u8bfb\u53d6\u7684\u4efb\u4f55\u503c\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#link-training11","title":"Link Training[11]","text":"<p>\u8be5\u53ea\u8bfb\u5bc4\u5b58\u5668\u4e3a 1 \u65f6\u8868\u793a LTSSM \u6b63\u5904\u4e8e\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u3002\u6280\u672f\u4e0a\u6765\u8bb2\uff0c\u8be5\u6bd4\u7279\u4e3a 1 \u65f6\uff0c\u8868\u793a LTSSM \u6b63\u5904\u4e8e Configuration \u6216\u8005 Recovery \u72b6\u6001\u4e2d\uff0c\u6216\u8005\u6b64\u65f6\u94fe\u8def\u91cd\u8bad\u7ec3\uff08Retrain Link\uff09\u6bd4\u7279\u88ab\u5199 1\uff0c\u4f46\u5b9e\u9645\u7684\u94fe\u8def\u8bad\u7ec3\u8fd8\u6ca1\u5f00\u59cb\u3002\u8be5\u6bd4\u7279\u5728 LTSSM \u9000\u51fa Configuration \u6216\u8005 Recovery \u72b6\u6001\u540e\u88ab\u6e05\u9664\u3002\u56e0\u4e3a LTSSM \u5904\u4e8e\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u5fc5\u987b\u5bf9\u8f6f\u4ef6\u53ef\u89c1\uff0c\u6240\u4ee5\u8be5\u6bd4\u7279\u53ea\u5bf9 DSP \u6709\u610f\u4e49\uff0c\u6240\u4ee5\u5728 EP\uff0c\u6865\u8bbe\u5907\u548c\u4ea4\u6362\u673a\u7684 USP \u4e2d\u6ca1\u6709\u4f5c\u7528\uff0c\u8be5\u6bd4\u7279\u5fc5\u987b\u786c\u8fde\u7ebf\u56fa\u5b9a\u4e3a 0b\u3002 </p> <p></p> <p>\u56fe 14-70 \u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#14164-link-control-register","title":"14.16.4 Link Control Register // \u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668","text":"<p>\u94fe\u8def\u72b6\u6001\u5bc4\u5b58\u5668\u5404\u57df\u5982\u539f\u6587 644 \u9875\u56fe 14-71 \u6240\u793a\uff0c\u5176\u4e2d\u6709\u4e09\u4e2a\u6211\u4eec\u611f\u5174\u8da3\u7684\u5bc4\u5b58\u5668\u57df\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#link-disable","title":"Link Disable","text":"<p>\u8be5\u6bd4\u7279\u88ab\u8bbe\u7f6e\u4e3a 1 \u65f6\uff0c\u94fe\u8def\u88ab\u7f6e\u4e3a\u672a\u4f7f\u80fd\uff08Disable\uff09\u72b6\u6001\u3002\u76f4\u89c2\u4e0a\u6765\u8bf4\uff0c\u8be5\u6bd4\u7279\u4e0d\u53ef\u88ab EP\uff0c\u6865\u8bbe\u5907\u548c\u4ea4\u6362\u673a\u7684 USP \u4f7f\u7528\uff0c\u56e0\u4e3a\u5373\u4f7f\u5728\u94fe\u8def\u672a\u4f7f\u80fd\u72b6\u6001\u4e0b\uff0c\u8be5\u6bd4\u7279\u4e5f\u5fc5\u987b\u80fd\u88ab\u8f6f\u4ef6\u8bbf\u95ee\u3002\u65e0\u8bba\u5728\u4f55\u79cd\u94fe\u8def\u72b6\u6001\u4e0b\uff0c\u5199\u8be5\u5bc4\u5b58\u5668\u540e\uff0c\u7acb\u523b\u8fdb\u884c\u7684\u8bfb\u64cd\u4f5c\u90fd\u4f1a\u8bfb\u51fa\u5199\u5165\u7684\u503c\u3002 \u5728\u6e05\u9664\u8be5\u6bd4\u7279\u540e\uff0c\u8f6f\u4ef6\u5fc5\u987b\u5c0f\u5fc3\u5730\u5904\u7406\u4f20\u7edf\u65b9\u5f0f\u590d\u4f4d\u540e\uff0c\u7b2c\u4e00\u4e2a Configuration \u8bfb\u8bf7\u6c42\u5728\u65f6\u5e8f\u4e0a\u7684\u8981\u6c42\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#retrain-link","title":"Retrain Link","text":"<p>\u8be5\u6bd4\u7279\u53ef\u88ab\u8f6f\u4ef6\u7528\u4e8e\u5728\u4efb\u4f55\u8f6f\u4ef6\u8ba4\u4e3a\u6709\u5fc5\u8981\u5730\u65f6\u5019\uff0c\u53d1\u8d77\u94fe\u8def\u91cd\u8bad\u7ec3\u8bf7\u6c42\uff0c\u6bd4\u5982\u60f3\u8981\u6062\u590d\u9519\u8bef\u65f6\u3002\u8be5\u6bd4\u7279\u4e0d\u53ef\u88ab EP\uff0c\u6865\u8bbe\u5907\u548c\u4ea4\u6362\u673a\u7684 USP \u4f7f\u7528\u3002\u5f53\u8be5\u6bd4\u7279\u88ab\u8bbe\u7f6e\u4e3a 1 \u65f6\uff0c\u5176\u4f1a\u5c06 LTSSM \u5f3a\u5236\u8bbe\u4e3a Recovery \u72b6\u6001\uff0c\u4e0d\u4f1a\u7b49\u5f85 Configuration \u5199\u8bf7\u6c42\u7684 completion \u5305\u8fd4\u56de\uff08\u5982\u6709\uff09\u3002</p>"},{"location":"pcie/14%20%E9%93%BE%E8%B7%AF%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E8%AE%AD%E7%BB%83/#extended-synch","title":"Extended Synch","text":"<p>\u8be5\u6bd4\u7279\u548c\u8bad\u7ec3\u6709\u5173\u662f\u56e0\u4e3a\u8be5\u6bd4\u7279\u7528\u4e8e\u5927\u5e45\u589e\u52a0\u4e24\u4e2a LTSSM \u72b6\u6001\u4e0b\u7684\u7528\u65f6\uff0c\u7528\u4e8e\u5e2e\u52a9\u8f83\u6162\u7684\u5916\u90e8\u6d4b\u8bd5\u6216\u8005\u5206\u6790\u8bbe\u5907\uff0c\u5728\u6b63\u5e38\u901a\u4fe1\u6062\u590d\u65f6\uff0c\u80fd\u591f\u4e0e\u8bbe\u5907\u5efa\u7acb\u540c\u6b65\u3002\u5176\u4e2d\u4e00\u4e2a\u573a\u666f\u662f\u5728\u9000\u51fa L0s \u65f6\uff0c\u6b64\u65f6\u7f6e\u8d77\u8be5\u6bd4\u7279\u4f1a\u5728\u9000\u51fa L0s \u65f6\uff0c\u5f3a\u5236\u53d1\u9001 4096 \u4e2a FTS\u3002\u53e6\u4e00\u4e2a\u573a\u666f\u662f\u5728 Recovery \u72b6\u6001\u4e2d\uff0c\u5728\u8fdb\u5165 Recovery.RcvrCfg \u4e4b\u524d\uff0c\u7f6e\u8d77\u8be5\u6bd4\u7279\u4f1a\u5f3a\u5236\u53d1\u9001 1024 \u4e2a TS1 \u5e8f\u5217\u3002</p> <p></p> <p>\u56fe 14-71 \u94fe\u8def\u63a7\u5236\u5bc4\u5b58\u5668</p>"},{"location":"pcie/all/","title":"All","text":"<p>PCIe\u6280\u672f</p> <p>\u2014\u2014\u9762\u5411****1.x,2.x,3.0****\u7684\u7efc\u5408\u6307\u5357</p> \u7248\u672c \u4fee\u6539\u65e5\u671f \u4fee\u6539\u63cf\u8ff0 \u4f5c\u8005 V0.1 2020-07-27 \u521d\u7248\uff0c\u7ec8\u4e8e\u5f00\u59cb\u4e86\uff0c\u62d6\u4e86\u4e24\u4e2a\u661f\u671f\u4eca\u5929\u770b\u5e76\u5f00\u59cb\u7ffb\u8bd1\u7b2c\u4e00\u7ae0Big Picture\u4e2d\u5173\u4e8ePCI\u7684\u5185\u5bb9 \u5f20\u4ef2\u79b9 V0.2 2020-08-03 PCI\u4e0ePCI-X\u7684\u8bb2\u8ff0\u7ed3\u675f\u4e86\uff0c\u7ec8\u4e8e\u80fd\u5f00\u59cbPCIe\u4e86 \u5f20\u4ef2\u79b9 V0.3 2020-08-16 Chapter 2\u5bf9PCIe\u4f53\u7cfb\u7ed3\u6784\u7684\u6982\u8ff0\u5b8c\u6210\u4e86 \u5f20\u4ef2\u79b9 V0.4 2020-09-03 \u968f\u7740Chapter 4\u5b8c\u6210\uff0cPart 1\u7ec8\u4e8e\u5b8c\u6210\u4e86\uff01 \u5f20\u4ef2\u79b9 V0.5 2020-10-22 \u524d\u51e0\u5929\u627e\u5b8c\u5de5\u4f5c\u540e\u7ee7\u7eed\u5f00\u59cb\u8fdb\u884c\uff0c\u4eca\u5929\u5b8c\u6210\u4e86Chapter 6 \u5f20\u4ef2\u79b9 V0.6 2020-11-24 Part 2\u5b8c\u6210\uff01\u4e8b\u52a1\u5c42\u7684\u4e1c\u897f\u5b8c\u6210\u540e\uff0c\u4e00\u4e2a\u8f83\u4e3a\u9ad8\u5c42\u89c6\u89d2\u7684PCIe\u67b6\u6784\u57fa\u672c\u4e0a\u5c55\u73b0\u4e86\u51fa\u6765\u3002 \u5f20\u4ef2\u79b9 <p>\u76ee\u5f55</p> <p>\u7b2c\u4e00\u90e8\u5206    Part One\uff1aThe Big Picture\u5927\u5c40\u603b\u89c8... 12</p> <p>Chapter 1  Background //\u80cc\u666f... 12</p> <p>\u5173\u4e8e\u672c\u7ae0... 12</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 12</p> <p>1.1    \u5f15\u8a00... 12</p> <p>1.2    PCI\u4e0ePCI-X.. 12</p> <p>1.3    PCI\u57fa\u7840(PCI Basics) 14</p> <p>1.3.1   \u57fa\u4e8ePCI\u7684\u7cfb\u7edf\u7684\u4e00\u4e9b\u57fa\u7840\u77e5\u8bc6... 14</p> <p>1.3.2   PCI\u603b\u7ebf\u53d1\u8d77\u65b9(Initiator)\u4e0e\u76ee\u6807\u65b9(Target) 14</p> <p>1.3.3   \u5178\u578b\u7684PCI\u603b\u7ebf\u5468\u671f... 15</p> <p>1.3.4   \u53cd\u5c04\u6ce2\u4fe1\u53f7\u4f20\u8f93(Reflected-Wave Signaling) 17</p> <p>1.4    PCI\u603b\u7ebf\u4f53\u7cfb\u7ed3\u6784\u900f\u89c6\u63a2\u7a76(PCI Bus Architecture Perspective) 19</p> <p>1.4.1   PCI\u4e8b\u52a1\u6a21\u578b... 19</p> <p>1.4.1.1   Programmed  I/O(PIO) 19</p> <p>1.4.1.2   Direct  Memory Access(DMA) 20</p> <p>1.4.1.3   Peer-to-Peer(\u70b9\u5bf9\u70b9) 20</p> <p>1.4.2   PCI\u603b\u7ebf\u4ef2\u88c1... 21</p> <p>1.4.3   PCI\u4f4e\u6548\u7684\u5730\u65b9(PCI Inefficiencies) 21</p> <p>1.4.3.1   PCI\u91cd\u8bd5\u534f\u8bae(PCI Retry Protocol) 21</p> <p>1.4.3.2   PCI\u65ad\u5f00\u8fde\u63a5\u534f\u8bae(PCI Disconnect  Protocol) 22</p> <p>1.4.4   PCI\u4e2d\u65ad\u5904\u7406(PCI Interrupt  Handling) 23</p> <p>1.4.5   PCI\u9519\u8bef\u5904\u7406(PCI Error Handling) 24</p> <p>1.4.6   PCI\u5730\u5740\u7a7a\u95f4\u6620\u5c04(PCI Address Map) 25</p> <p>1.4.7   PCI\u914d\u7f6e\u5468\u671f\u7684\u751f\u6210(PCI Configuration  Cycle Generation) 26</p> <p>1.4.8   PCI  Function\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4(PCI  Function Cfg Reg Space) 26</p> <p>1.4.9   \u66f4\u9ad8\u5e26\u5bbd\u7684PCI(Higher-bandwidth PCI) 29</p> <p>1.4.9.1   66MHz  PCI\u603b\u7ebf\u7684\u9650\u5236... 29</p> <p>1.4.9.2   \u5e76\u884cPCI\u603b\u7ebf\u6a21\u578b\u572866MHz\u4ee5\u4e0a\u65f6\u51fa\u73b0\u7684\u4fe1\u53f7\u65f6\u5e8f\u95ee\u9898... 29</p> <p>1.5    PCI-X\u7b80\u4ecb... 30</p> <p>1.5.1   PCI-X\u7cfb\u7edf\u793a\u4f8b(PCI-X System  Example) 30</p> <p>1.5.2   PCI-X\u4e8b\u52a1(PCI-X Transactions) 31</p> <p>1.5.3   PCI-X\u7279\u6027(PCI-X Features) 31</p> <p>1.5.3.1   \u62c6\u5206\u4e8b\u52a1\u6a21\u578b\uff08Split-Transaction Model\uff09... 31</p> <p>1.5.3.2   MSI\u6d88\u606f\u5f0f\u4e2d\u65ad\uff08Message Signaled  Interrupts\uff09... 32</p> <p>1.5.3.3   \u4e8b\u52a1\u5c5e\u6027\uff08Transaction Attributes\uff09... 33</p> <p>1.5.4   \u66f4\u9ad8\u5e26\u5bbd\u7684PCI-X(Higher Bandwidth PCI-X) 33</p> <p>1.5.4.1   PCI\u4e0ePCI-X 1.0\u5e76\u884c\u603b\u7ebf\u6a21\u578b\u4e2d\u7531\u4e8e\u516c\u5171\u65f6\u949f\u65b9\u6cd5\u6240\u5e26\u6765\u7684\u95ee\u9898... 33</p> <p>1.5.4.2   PCI-X  2.0\u6e90\u540c\u6b65\u6a21\u578b\uff08PCI-X  2.0 Source-Synchronous Model\uff09... 34</p> <p>Chapter 2  PCIe Architecture Overview //PCIe\u4f53\u7cfb\u7ed3\u6784\u6982\u8ff0... 36</p> <p>\u5173\u4e8e\u524d\u4e00\u7ae0... 36</p> <p>\u5173\u4e8e\u672c\u7ae0... 36</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 36</p> <p>2.1    PCI Express\u7b80\u4ecb... 36</p> <p>2.1.1   \u8f6f\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\uff08Software Backward Compatibility\uff09... 37</p> <p>2.1.2   \u4e32\u884c\u4f20\u8f93\uff08Serial Transport\uff09... 37</p> <p>2.1.2.1   \u5bf9\u4f20\u8f93\u901f\u7387\u7684\u9700\u6c42\uff08The Need for Speed\uff09... 37</p> <p>2.1.2.2   PCIe\u5e26\u5bbd\u8ba1\u7b97\u65b9\u6cd5... 39</p> <p>2.1.2.3   PCIe\u7684\u5dee\u5206\u4fe1\u53f7... 40</p> <p>2.1.2.4   \u4e0d\u518d\u4f7f\u7528\u516c\u5171\u65f6\u949f... 40</p> <p>2.1.2.5   \u57fa\u4e8e\u6570\u636e\u5305\u7684\u534f\u8bae\u4f53\u7cfb\uff08Packet-based Protocol\uff09... 41</p> <p>2.1.3   \u94fe\u8def\u548c\u901a\u9053\uff08Links and Lanes\uff09... 42</p> <p>2.1.3.1   \u53ef\u6269\u5c55\u7684\u6027\u80fd\uff08Scalable Performance\uff09... 42</p> <p>2.1.3.2   \u7075\u6d3b\u7684\u62d3\u6251\u7ed3\u6784\u9009\u62e9\uff08Flexible Topology Options\uff09... 42</p> <p>2.1.4   \u5173\u4e8ePCIe\u62d3\u6251\u7684\u4e00\u4e9b\u5b9a\u4e49... 42</p> <p>2.1.4.1   \u62d3\u6251\u7279\u5f81\uff08Topology Characteristics\uff09... 43</p> <p>2.1.4.2   Root  Complex\uff08RC \u6839\u7ec4\u4ef6\uff09... 43</p> <p>2.1.4.3   Switches  and Bridge\uff08\u4ea4\u6362\u7ed3\u6784\u4e0e\u6865\uff09... 43</p> <p>2.1.4.4   Native  PCIe Endpoints and Legacy PCIe Endpoints\uff08\u539f\u751f\u4e0e\u9057\u7559EP\uff09... 44</p> <p>2.1.4.5   \u8f6f\u4ef6\u517c\u5bb9\u7279\u6027... 44</p> <p>2.1.4.6   \u7cfb\u7edf\u793a\u4f8b... 46</p> <p>2.2    \u8bbe\u5907\u5c42\u6b21\u4ecb\u7ecd\uff08Introduction to  Device Layers\uff09... 48</p> <p>l   \u8bbe\u5907\u6838\uff08Device Core\uff09\u4ee5\u53ca\u5b83\u4e0e\u4e8b\u52a1\u5c42\uff08Transaction  Layer\uff09\u7684\u63a5\u53e3\u3002... 48</p> <p>l   \u4e8b\u52a1\u5c42\uff08Transaction Layer\uff09\u3002... 48</p> <p>l   \u6570\u636e\u94fe\u8def\u5c42\uff08Data Link Layer\uff09\u3002... 48</p> <p>l   \u7269\u7406\u5c42\uff08Physical Layer\uff09\u3002... 49</p> <p>2.2.1   \u8bbe\u5907\u6838/\u8f6f\u4ef6\u5c42\uff08Device Core/Software Layer\uff09... 51</p> <p>2.2.2   \u4e8b\u52a1\u5c42\uff08Transaction Layer\uff09... 51</p> <p>2.2.2.1   TLP\u57fa\u7840\u5185\u5bb9... 52</p> <p>l   TLP\u7ec4\u5305\uff08TLP Packet Assembly\uff09... 54</p> <p>l   TLP\u62c6\u5305\uff08TLP Packet Disassembly\uff09... 55</p> <p>2.2.2.2   Non-Posted\u4e8b\u52a1... 56</p> <p>l   \u666e\u901a\u8bfb\uff08Ordinary Reads\uff09... 56</p> <p>l   \u9501\u5b9a\u8bfb\uff08Locked Reads\uff09... 57</p> <p>l   IO\u548c\u914d\u7f6e\u5199\uff08IO and Configuration Writes\uff09... 58</p> <p>2.2.2.3   Posted\u5199\u4e8b\u52a1... 59</p> <p>l   Memory\u5199\uff08Memory Writes\uff09... 59</p> <p>l   Message\u5199\uff08Message Writes\uff09... 60</p> <p>2.2.2.4   QoS\u670d\u52a1\u8d28\u91cf\uff08Quality of Service\uff09... 60</p> <p>2.2.2.5   \u4e8b\u52a1\u6392\u5e8f\uff08Transaction Ordering\uff09... 62</p> <p>2.2.2.6   \u6d41\u91cf\u63a7\u5236\uff08Flow Control\uff09... 62</p> <p>2.2.3   \u6570\u636e\u94fe\u8def\u5c42\uff08Data Link Layer\uff09... 62</p> <p>2.2.3.1   DLLPs\u6570\u636e\u94fe\u8def\u5c42\u5305\uff08Data Link Layer  Packet\uff09... 63</p> <p>l   DLLP\u7ec4\u5305\uff08DLLP Assembly\uff09... 63</p> <p>l   DLLP\u62c6\u5305\uff08DLLP Disassembly\uff09... 63</p> <p>2.2.3.2   Ack/Nak\u534f\u8bae\uff08Ack/Nak Protocol\uff09... 63</p> <p>2.2.3.3   \u6d41\u91cf\u63a7\u5236\uff08Flow Control\uff09... 65</p> <p>2.2.3.4   \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09... 66</p> <p>2.2.4   \u7269\u7406\u5c42\uff08Physical Layer\uff09... 66</p> <p>2.2.4.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 66</p> <p>2.2.4.2   \u903b\u8f91\u7269\u7406\u5c42\uff08Physical Layer-Logical\uff09... 66</p> <p>2.2.4.3   \u94fe\u8def\u8bad\u7ec3\u548c\u521d\u59cb\u5316\uff08Link Training and Initialization\uff09... 67</p> <p>2.2.4.4   \u7535\u6c14\u7269\u7406\u5c42\uff08Physical Layer-Electrical\uff09... 68</p> <p>2.2.4.5   \u547d\u4ee4\u96c6\uff08Ordered Sets\uff09... 68</p> <p>2.3    \u534f\u8bae\u56de\u987e\uff08Protocol Review  Example\uff09... 69</p> <p>2.3.1   Memory  Read Request\uff08MRd\u8bf7\u6c42\uff09... 69</p> <p>2.3.2   Completion  with Data\uff08CplD\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff09... 71</p> <p>Chapter 3  Configuration Overview //PCIe\u914d\u7f6e\u6982\u8ff0... 73</p> <p>\u5173\u4e8e\u524d\u4e00\u7ae0... 73</p> <p>\u5173\u4e8e\u672c\u7ae0... 73</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 73</p> <p>3.1    \u603b\u7ebf/\u8bbe\u5907/\u529f\u80fd/\u7684\u5b9a\u4e49\uff08Definition of  Bus,Device and Function\uff09... 73</p> <p>3.2    PCIe\u603b\u7ebf\uff08PCIe Buses\uff09... 74</p> <p>3.3    PCIe\u8bbe\u5907\uff08PCIe Devices\uff09... 75</p> <p>3.4    PCIe\u529f\u80fd\uff08PCIe Functions\uff09... 75</p> <p>3.5    \u914d\u7f6e\u5730\u5740\u7a7a\u95f4\uff08Configuration  Address Space\uff09... 75</p> <p>3.5.1   PCI\u517c\u5bb9\u7a7a\u95f4\uff08PCI-Compatible Space\uff09... 76</p> <p>3.5.2   \u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\uff08Extended Configuration Space\uff09... 76</p> <p>3.6    Host-to-PCI Bridge\u914d\u7f6e\u5bc4\u5b58\u5668... 77</p> <p>3.6.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 77</p> <p>3.6.2   \u53ea\u6709RC\u53d1\u9001\u914d\u7f6e\u8bf7\u6c42\uff08Only the Root Sends Configuration Request\uff09... 77</p> <p>3.7    \u751f\u6210\u914d\u7f6e\u4e8b\u52a1\uff08Generating  Configuration Transactions\uff09... 78</p> <p>3.7.1   \u4f20\u7edfPCI\u673a\u5236\uff08Legacy PCI Mechanism\uff09... 78</p> <p>3.7.1.1   \u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09... 78</p> <p>3.7.1.2   \u603b\u7ebf\u6bd4\u8f83\u548c\u6570\u636e\u7aef\u53e3\u7684\u4f7f\u7528\uff08Bus Compare and Data Port Usage\uff09... 79</p> <p>3.7.1.3   \u5355Host\u7cfb\u7edf\uff08Single Host System\uff09... 80</p> <p>3.7.1.4   \u591aHost\u7cfb\u7edf\uff08Multi-Host System\uff09... 82</p> <p>3.7.2   \u589e\u5f3a\u578b\u914d\u7f6e\u8bbf\u95ee\u673a\u5236\uff08Enhanced Configuration Access Mechanism\uff09... 83</p> <p>3.7.2.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 83</p> <p>3.7.2.2   \u4e00\u4e9b\u89c4\u5219\uff08Some Rules\uff09... 84</p> <p>3.8    \u914d\u7f6e\u8bf7\u6c42\uff08Configuration  Requests\uff09... 85</p> <p>3.8.1   Type  0\u914d\u7f6e\u8bf7\u6c42\uff08Type 0  Configuration Request\uff09... 85</p> <p>3.8.2   Type  1\u914d\u7f6e\u8bf7\u6c42\uff08Type 1  Configuration Request\uff09... 86</p> <p>3.9    PCI\u517c\u5bb9\u914d\u7f6e\u8bbf\u95ee\u793a\u4f8b\uff08Example PCI-Compatible Configuration Access\uff09... 87</p> <p>3.10   \u589e\u5f3a\u578b\u914d\u7f6e\u8bbf\u95ee\u793a\u4f8b\uff08Example  Enhanced Configuration Access\uff09... 88</p> <p>3.11   \u679a\u4e3e\u2014\u2014\u641c\u7d22\u53d1\u73b0\u62d3\u6251\uff08Enumeration-Discovering the  Topology\uff09... 90</p> <p>3.11.1    \u641c\u7d22\u67d0\u4e2aFunction\u662f\u5426\u5b58\u5728\uff08Discovering the  Presence or Absence of a Function\uff09  90</p> <p>3.11.1.1   \u8bbe\u5907\u4e0d\u5b58\u5728\uff08Device not Present\uff09... 90</p> <p>3.11.1.2   \u8bbe\u5907\u672a\u51c6\u5907\u597d\uff08Device not Ready\uff09... 91</p> <p>3.11.2    \u786e\u8ba4\u67d0\u4e2aFunction\u662fEP\u8fd8\u662fBridge. 93</p> <p>3.12   \u5355RC\u679a\u4e3e\u793a\u4f8b\uff08Single Root  Enumeration Example\uff09... 93</p> <p>3.13   \u591aRC\u679a\u4e3e\u793a\u4f8b\uff08Multi-Root  Enumeration Example\uff09... 97</p> <p>3.13.1    \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 97</p> <p>3.13.2    \u591aRC\u679a\u4e3e\u8fc7\u7a0b\uff08Multi-Root Enumeration Process\uff09... 98</p> <p>3.13.3    \u70ed\u63d2\u62d4\u6ce8\u610f\u4e8b\u9879\uff08Hot-Plug Considerations\uff09... 99</p> <p>3.14   MindShare Arbor\uff1a\u8c03\u8bd5/\u9a8c\u8bc1/\u5206\u6790\u548c\u5b66\u4e60\u7684\u8f6f\u4ef6\u5de5\u5177... 100</p> <p>3.14.1    \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 100</p> <p>3.14.2  MindShare  Arbor\u529f\u80fd\u5217\u8868... 101</p> <p>Chapter 4  Address Space &amp; Transaction Routing//\u5730\u5740\u7a7a\u95f4\u4e0e\u4e8b\u52a1\u8def\u7531... 103</p> <p>\u5173\u4e8e\u524d\u4e00\u7ae0... 103</p> <p>\u5173\u4e8e\u672c\u7ae0... 103</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 103</p> <p>4.1    \u6211\u9700\u8981\u4e00\u4e2a\u5730\u5740\uff08I Need An Address\uff09... 103</p> <p>4.1.1   \u914d\u7f6e\u7a7a\u95f4\uff08Configuration Space\uff09... 103</p> <p>4.1.2   \u5185\u5b58\u548cIO\u5730\u5740\u7a7a\u95f4\uff08Memory and IO Address Spaces\uff09... 104</p> <p>4.1.2.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 104</p> <p>4.1.2.2   \u53ef\u9884\u53d6\u7684\u4e0e\u4e0d\u53ef\u9884\u53d6\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u5bf9\u6bd4\uff08Prefetchable vs. Non-Prefetchable  Memory Space\uff09... 104</p> <p>4.2    \u57fa\u5730\u5740\u5bc4\u5b58\u5668BARs\uff08Base Address Registers\uff09... 106</p> <p>4.2.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 106</p> <p>4.2.2   BAR\u793a\u4f8b1\u2014\u201432bit\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42... 108</p> <p>4.2.3   BAR\u793a\u4f8b2\u2014\u201464bit\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42... 110</p> <p>4.2.4   BAR\u793a\u4f8b3\u2014\u2014IO\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42... 112</p> <p>4.2.5   \u6240\u6709\u7684BARs\u90fd\u5fc5\u987b\u6309\u987a\u5e8f\u88ab\u8bc4\u4f30... 113</p> <p>4.2.6   \u5927\u5c0f\u53ef\u53d8\u7684BARs\uff08Resizable BARs\uff09... 114</p> <p>4.3    Base\u5bc4\u5b58\u5668\u548cLimit\u5bc4\u5b58\u5668\uff08Base and Limit Registers\uff09... 114</p> <p>4.3.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 114</p> <p>4.3.2   P-MMIO\u53ef\u9884\u53d6\u8303\u56f4\uff08Prefetchable Range\uff09... 115</p> <p>4.3.3   NP-MMIO\u4e0d\u53ef\u9884\u53d6\u8303\u56f4\uff08Non-Prefetchable  Range\uff09... 117</p> <p>4.3.4   IO\u8303\u56f4\uff08IO Range\uff09... 119</p> <p>4.3.5   \u672a\u88ab\u4f7f\u7528\u7684Base\u548cLimit\u5bc4\u5b58\u5668... 121</p> <p>4.4    \u5b8c\u6574\u6027\u68c0\u67e5\uff1a\u5bf9\u6240\u6709\u7528\u4e8e\u5730\u5740\u8def\u7531\u7684\u5bc4\u5b58\u5668\uff08Sanity  Check\uff1aRegisters  Used For Address Routing\uff09... 122</p> <p>4.5    TLP\u8def\u7531\u57fa\u7840\uff08TLP Routing Basics\uff09... 123</p> <p>4.5.1   \u63a5\u6536\u5668\u68c0\u67e53\u79cd\u7c7b\u578b\u7684\u6d41\u91cf\uff08Recievers Check For Three Types of Traffic\uff09... 124</p> <p>4.5.2   \u8def\u7531\u5143\u4ef6\uff08Routing Elements\uff09... 124</p> <p>4.5.3   TLP\u8def\u7531\u7684\u4e09\u79cd\u65b9\u6cd5\uff08Three Methods of  TLP Routing\uff09... 124</p> <p>4.5.3.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 124</p> <p>4.5.3.2   \u9690\u5f0f\u8def\u7531\u548cMessage\u7684\u76ee\u7684\uff08Purpose of Implicit Routing and  Message\uff09... 125</p> <p>l   \u4e3a\u4ec0\u4e48\u662fMessage\uff1f\uff08Why Messages\uff1f\uff09... 125</p> <p>l   \u9690\u5f0f\u8def\u7531\u662f\u600e\u4e48\u63d0\u4f9b\u5e2e\u52a9\u7684\uff1f\uff08How  Implicit Routing Helps\uff1f\uff09... 125</p> <p>4.5.4   \u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff08Split Transaction Protocol\uff09... 125</p> <p>4.5.5   Posted\u4e0eNon-Posted. 126</p> <p>4.5.6   Header\u4e2d\u5b9a\u4e49\u6570\u636e\u5305\u683c\u5f0f\u548c\u7c7b\u578b\u7684\u5b57\u6bb5... 129</p> <p>4.5.6.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 129</p> <p>4.5.6.2   Header\u4e2dFormat/Type\u5b57\u6bb5\u7684\u7f16\u7801\u542b\u4e49... 130</p> <p>4.5.7   TLP  Header\u6982\u8ff0... 131</p> <p>4.6    \u8def\u7531\u673a\u5236\u7684\u5e94\u7528\u65b9\u6cd5\uff08Applying  Routing Mechanisms\uff09... 131</p> <p>4.6.1   ID\u8def\u7531\uff08ID Routing\uff09... 131</p> <p>4.6.1.1   Bus\u53f7\uff0cDevice\u53f7\uff0cFunction\u53f7\u7684\u4f7f\u7528\u4e0a\u9650... 131</p> <p>4.6.1.2   TLP  Header\u4e2d\u6709\u5173ID\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5... 131</p> <p>4.6.1.3   EP\u8fdb\u884c\u4e00\u6b21\u68c0\u67e5\uff08Endpoint\uff1aOne Check\uff09... 132</p> <p>4.6.1.4   Switches\uff08Bridges\uff09\u6bcf\u4e2a\u7aef\u53e3\u8fdb\u884c\u4e24\u6b21\u68c0\u67e5... 132</p> <p>4.6.2   \u5730\u5740\u8def\u7531\uff08Address Routing\uff09... 134</p> <p>4.6.2.1   TLP  Header\u4e2d\u6709\u5173\u5730\u5740\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5... 134</p> <p>l   \u4f7f\u752832bit\u5730\u5740\u7684TLP. 134</p> <p>l   \u4f7f\u752864bit\u5730\u5740\u7684TLP. 134</p> <p>4.6.2.2   EP\u5bf9\u5730\u5740\u7684\u68c0\u67e5... 135</p> <p>4.6.2.3   Switch\u8fdb\u884c\u8def\u7531\uff08Switch  Routing\uff09... 136</p> <p>l   TLP\u5411\u4e0b\u884c\u79fb\u52a8\uff08\u7531Switch\u4e3b\u63a5\u53e3\u63a5\u6536\u5e76\u5411\u4e0b\u8f6c\u53d1\uff09... 137</p> <p>l   TLP\u5411\u4e0a\u884c\u79fb\u52a8\uff08\u7531\u6b21\u7ea7\u63a5\u53e3\u63a5\u6536\u5e76\u5411\u4e0a\u8f6c\u53d1\uff09... 137</p> <p>4.6.2.4   \u591a\u64ad\u80fd\u529b\uff08Multicast Capabilities\uff09... 138</p> <p>4.6.3   \u9690\u5f0f\u8def\u7531\uff08Implicit Routing\uff09... 138</p> <p>4.6.3.1   \u4ec5\u4e3aMessage\u6240\u4f7f\u7528\uff08Only for Messages\uff09... 138</p> <p>4.6.3.2   TLP  Header\u4e2d\u6709\u5173\u9690\u5f0f\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5... 138</p> <p>4.6.3.3   Message\u7684Type\u5b57\u6bb5\u603b\u7ed3... 139</p> <p>4.6.3.4   EP\u7684\u5904\u7406... 139</p> <p>4.6.3.5   Switch\u7684\u5904\u7406... 139</p> <p>4.7    DLLP\u548cOrdered Set\u4e0d\u4f1a\u88ab\u8def\u7531... 140</p> <p>\u7b2c\u4e8c\u90e8\u5206    Part Two\uff1aTransaction Layer\u4e8b\u52a1\u5c42... 141</p> <p>Chapter 5  TLP Element //TLP\u5143\u7d20... 141</p> <p>\u5173\u4e8e\u4e0a\u4e00\u7ae0... 141</p> <p>\u5173\u4e8e\u672c\u7ae0... 141</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 141</p> <p>5.1    \u57fa\u4e8e\u5305\u7684\u534f\u8bae\u7684\u4ecb\u7ecd\uff08Introduction to  Packet-Based Protocol\uff09... 141</p> <p>5.1.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 141</p> <p>5.1.2   \u4f7f\u7528\u57fa\u4e8e\u5305\u7684\u534f\u8bae\u7684\u539f\u56e0... 142</p> <p>5.1.2.1   \u5305\u683c\u5f0f\u662f\u7cbe\u5fc3\u5b9a\u4e49\u7684... 142</p> <p>5.1.2.2   \u4f7f\u7528\u7ec4\u5e27\u7b26\u53f7\u5b9a\u4e49\u5305\u7684\u8fb9\u754c... 143</p> <p>5.1.2.3   \u4f7f\u7528CRC\u4fdd\u969c\u6574\u4e2a\u6570\u636e\u5305\u7684\u6b63\u786e\u4f20\u8f93... 143</p> <p>5.2    TLP\u7ec6\u8282\uff08TLP Details\uff09... 143</p> <p>5.2.1   TLP\u7684\u7ec4\u5305\u548c\u62c6\u5305... 143</p> <p>5.2.2   TLP\u7ed3\u6784... 145</p> <p>5.2.3   \u901a\u7528TLP Header\u683c\u5f0f\uff08Generic TLP Header Format\uff09... 146</p> <p>5.2.3.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 146</p> <p>5.2.3.2   \u901a\u7528Header\u5404\u5b57\u6bb5\u603b\u7ed3... 146</p> <p>5.2.4   \u901a\u7528TLP Header\u8be6\u7ec6\u8bf4\u660e\uff08Generic TLP Header Details\uff09... 149</p> <p>5.2.4.1   Header\u7684Type/Format\u5b57\u6bb5\u7f16\u7801\u542b\u4e49... 149</p> <p>5.2.4.2   Digest/ECRC\u5b57\u6bb5... 150</p> <p>l   ECRC\u7684\u751f\u6210\u548c\u68c0\u67e5... 151</p> <p>l   \u8c01\u6765\u68c0\u67e5ECRC.. 151</p> <p>5.2.4.3   \u4f7f\u7528\u5b57\u8282\u4f7f\u80fd\uff08Using Byte Enables\uff09... 151</p> <p>l   \u6574\u4f53\u8bf4\u660e... 151</p> <p>l   \u5b57\u8282\u4f7f\u80fd\u89c4\u5219... 152</p> <p>l   \u5b57\u8282\u4f7f\u80fd\u793a\u4f8b... 152</p> <p>5.2.4.4   \u4e8b\u52a1\u63cf\u8ff0\u7b26\u5b57\u6bb5\uff08Transaction Descriptor Fields\uff09... 153</p> <p>l   \u4e8b\u52a1ID\uff08Transaction ID\uff09... 153</p> <p>l   \u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff09... 153</p> <p>l   \u4e8b\u52a1\u5c5e\u6027\uff08Transaction  Attributes\uff09... 154</p> <p>5.2.4.5   \u5e26\u6709\u6570\u636e\u8377\u8f7d\u7684TLP\u7684\u4e00\u4e9b\u989d\u5916\u89c4\u5219... 154</p> <p>5.2.5   \u5177\u4f53\u7684TLP\u683c\u5f0f\uff1a\u8bf7\u6c42TLP\u548c\u5b8c\u6210TLP. 154</p> <p>5.2.5.1   IO\u8bf7\u6c42\uff08IO Request\uff09... 154</p> <p>l   IO Request Header\u7684\u683c\u5f0f... 155</p> <p>l   IO Request Header\u5404\u5b57\u6bb5... 156</p> <p>5.2.5.2   Memory\u8bf7\u6c42\uff08Memory Request\uff09... 157</p> <p>l   Memory Request Header\u5404\u5b57\u6bb5... 158</p> <p>l   Memory Request \u6ce8\u610f\u4e8b\u9879... 161</p> <p>5.2.5.3   Configuration\u8bf7\u6c42\uff08Configuration Request\uff09... 161</p> <p>l   Configuration Request Header\u5404\u5b57\u6bb5\u7684\u5b9a\u4e49... 162</p> <p>l   Configuration Request\u6ce8\u610f\u4e8b\u9879... 164</p> <p>5.2.5.4   \u5b8c\u6210\u5305\uff08Completion\uff09... 164</p> <p>l   Completion Header\u5404\u5b57\u6bb5\u7684\u5b9a\u4e49... 165</p> <p>l   \u5b8c\u6210\u5305\u72b6\u6001\u7801\u603b\u7ed3\uff08Summary  of Completion Status Codes\uff09... 167</p> <p>l   \u8ba1\u7b97\u4f4e\u4f4d\u5730\u5740\u5b57\u6bb5\uff08Calculating the  Lower Address Field\uff09... 167</p> <p>l   \u4f7f\u7528\u5b57\u8282\u6570\u4fee\u6539\u4f4d\uff08Using The Byte  Count Modified Bit\uff09... 168</p> <p>l   \u8bfb\u8bf7\u6c42\u6570\u636e\u8fd4\u56de\uff08Data Returned For  Read Requests\uff09: 169</p> <p>l   \u63a5\u6536\u8005\u5bf9\u5b8c\u6210\u5305\u7684\u5904\u7406\u89c4\u5219\uff08Receiver  Completion Handling Rules\uff09: 169</p> <p>5.2.5.5   \u6d88\u606f\u8bf7\u6c42\uff08Message Requests\uff09... 170</p> <p>l   Message\u8bf7\u6c42Header\u5404\u5b57\u6bb5\uff08Message Request Header Fields\uff09... 171</p> <p>l   Message\u6ce8\u610f\u4e8b\u9879\uff08Using The Byte Count Modified Bit\uff09... 173</p> <p>l   INTx\u4e2d\u65adMessage\uff08INTx Interrupt Messages\uff09... 173</p> <p>l   \u7535\u6e90\u7ba1\u7406Message\uff08Power Management  Messages\uff09... 174</p> <p>l   \u9519\u8befMessage\uff08Error Messages\uff09... 175</p> <p>l   \u652f\u6301\u9501\u5b9a\u4e8b\u52a1\uff08Locked Transaction  Support\uff09... 176</p> <p>l   \u8bbe\u7f6e\u63d2\u69fd\u529f\u7387\u9650\u5236Message\uff08Set Slot Power Limit  Message\uff09... 176</p> <p>l   \u5382\u5546\u5b9a\u4e49\u7684Message 0\u548c1\uff08Vendor-Defined Message 0  and 1\uff09... 177</p> <p>l   \u88ab\u5ffd\u7565\u7684Message\uff08Ignored Message\uff09... 177</p> <p>l   \u5ef6\u8fdf\u5bb9\u5fcd\u62a5\u544aMessage\uff08Latency Tolerance  Reporting Message\uff09... 178</p> <p>l   \u4f18\u5316\u7684Buffer\u5237\u65b0\u548c\u586b\u5145Message\uff08Optimized Buffer Flush  and Fill\uff09... 179</p> <p>Chapter 6  Flow Control //\u6d41\u91cf\u63a7\u5236... 180</p> <p>\u5173\u4e8e\u4e0a\u4e00\u7ae0... 180</p> <p>\u5173\u4e8e\u672c\u7ae0... 180</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 180</p> <p>6.1    \u6d41\u91cf\u63a7\u5236\u6982\u5ff5\uff08Flow Control  Concept\uff09... 180</p> <p>6.2    \u6d41\u91cf\u63a7\u5236Buffer\u548cCredit\uff08Flow Control Buffer and  Credits\uff09... 181</p> <p>6.2.1   VC\u6d41\u91cf\u63a7\u5236Buffer\u7684\u7ec4\u6210\uff08VC Flow Control  Buffer Organization\uff09... 182</p> <p>6.2.2   \u6d41\u63a7Credit\uff08Flow Control Credits\uff09... 182</p> <p>6.3    \u521d\u59cb\u6d41\u91cf\u63a7\u5236\u901a\u544a\uff08Initial Flow  Control Advertisement\uff09... 183</p> <p>6.3.1   \u6d41\u63a7\u901a\u544a\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff08Minimum and Maximum Flow Control  Advertisement\uff09... 183</p> <p>6.3.2   \u65e0\u9650Credit\uff08Infinite Credits\uff09... 184</p> <p>6.3.3   \u65e0\u9650Credit\u901a\u544a\u7684\u7279\u6b8a\u7528\u6cd5... 185</p> <p>6.4    \u6d41\u91cf\u63a7\u5236\u521d\u59cb\u5316\uff08Flow Control  Initialization\uff09... 185</p> <p>6.4.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 185</p> <p>6.4.2   \u6d41\u63a7\u521d\u59cb\u5316\u6d41\u7a0b\uff08The FC Initialization Sequence\uff09... 186</p> <p>6.4.3   FC_Init1\u8be6\u7ec6\u8bf4\u660e\uff08FC_Init1 Details\uff09... 187</p> <p>6.4.4   FC_Init2\u8be6\u7ec6\u8bf4\u660e\uff08FC_Init2 Details\uff09... 188</p> <p>6.4.5   FC_INIT1\u548cFC_INIT2\u7684\u4f20\u8f93\u901f\u7387\uff08Rate of FC_INIT1  and FC_INIT2 Transmission\uff09... 189</p> <p>6.4.6   \u6d41\u63a7\u521d\u59cb\u5316\u534f\u8bae\u8fdd\u4f8b... 189</p> <p>6.5    \u6d41\u63a7\u673a\u5236\u7684\u4ecb\u7ecd\uff08Introduction to  Flow Control Mechanism\uff09... 189</p> <p>6.5.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 189</p> <p>6.5.2   \u6d41\u63a7\u76f8\u5173\u5143\u7d20\uff08The Flow Control Elements\uff09... 190</p> <p>6.5.2.1   \u53d1\u9001\u65b9\u6d41\u63a7\u5143\u7d20\uff08Transmitter Elements\uff09... 190</p> <p>6.5.2.2   \u63a5\u6536\u65b9\u6d41\u63a7\u5143\u7d20\uff08Receiver Elements\uff09... 191</p> <p>6.6    \u6d41\u63a7\u793a\u4f8b\uff08Flow Control Example\uff09... 191</p> <p>6.6.1   \u9636\u6bb5\u4e00\u2014\u2014\u521d\u59cb\u5316\u540e\u7684\u6d41\u63a7\uff08Flow Control  Following Initialization\uff09... 192</p> <p>6.6.2   \u9636\u6bb5\u4e8c\u2014\u2014\u6d41\u63a7Buffer\u5df2\u6ee1\uff08Flow Control Buffer  Fills Up\uff09... 194</p> <p>6.6.3   \u9636\u6bb5\u4e09\u2014\u2014\u8ba1\u6570\u5668\u7ffb\u8f6c\u4e3a0\uff08Counters Roll Over\uff09... 195</p> <p>6.6.4   \u9636\u6bb5\u56db\u2014\u2014\u6d41\u63a7Buffer\u6ea2\u51fa\u9519\u8bef\u68c0\u67e5\uff08FC Buffer Overflow  Error Check\uff09... 195</p> <p>6.7    \u6d41\u63a7\u66f4\u65b0\uff08Flow Control Update\uff09... 196</p> <p>6.7.1   \u6d41\u63a7\u66f4\u65b0DLLP\u683c\u5f0f\u548c\u5185\u5bb9\uff08FC_Update DLLP Format and Content\uff09... 197</p> <p>6.7.2   \u6d41\u63a7\u66f4\u65b0\u9891\u7387\uff08Flow Control Update Frequency\uff09... 198</p> <p>6.7.2.1   \u7acb\u5373\u901a\u544aCREDITS_ALLOCATED\uff08Immediate Notification of CA\uff09... 198</p> <p>6.7.2.2   \u6d41\u63a7\u66f4\u65b0DLLP\u95f4\u6700\u5927\u5ef6\u65f6\uff08Maximum Latency Between UpdateFC\uff09... 198</p> <p>6.7.2.3   \u57fa\u4e8ePayload Size\u548c\u94fe\u8def\u5bbd\u5ea6\u8ba1\u7b97\u66f4\u65b0\u9891\u7387... 198</p> <p>6.7.3   \u9519\u8bef\u68c0\u6d4b\u8ba1\u65f6\u5668\u2014\u2014\u4e00\u4e2a\u8f6f\u8981\u6c42\uff08Error Detection  Timer\u2014\u2014A Pseudo Requirement\uff09... 201</p> <p>Chapter 7  Quality of Service //QoS\u670d\u52a1\u8d28\u91cf... 202</p> <p>\u5173\u4e8e\u4e0a\u4e00\u7ae0... 202</p> <p>\u5173\u4e8e\u672c\u7ae0... 202</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 202</p> <p>7.1    QoS\u7684\u51fa\u53d1\u70b9\uff08Motivation\uff09... 202</p> <p>7.2    \u57fa\u672c\u5143\u7d20\uff08Basic Elements\uff09... 202</p> <p>7.2.1   \u6d41\u91cf\u7c7b\u578bTC\uff08Traffic Class\uff09... 203</p> <p>7.2.2   \u865a\u62df\u901a\u9053VC\uff08Virtual Channels\uff09... 204</p> <p>7.2.2.1   \u4e3a\u6bcf\u4e2aVC\u5206\u914dTCs\u2014\u2014TC/VC\u6620\u5c04... 204</p> <p>7.2.2.2   \u786e\u5b9a\u8981\u4f7f\u7528\u7684VC\u7684\u6570\u91cf... 205</p> <p>7.2.2.3   \u5206\u914dVC ID.. 207</p> <p>7.3    VC\u4ef2\u88c1\uff08VC Arbitration\uff09... 208</p> <p>7.3.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 208</p> <p>7.3.2   \u4e25\u683c\u4f18\u5148\u7ea7VC\u4ef2\u88c1\uff08Strict Priority VC Arbitration\uff09... 209</p> <p>7.3.3   \u5206\u7ec4\u4ef2\u88c1\uff08Group Arbitration\uff09... 210</p> <p>7.3.3.1   \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\u65b9\u6848\uff08Hardware Fixed Arbitration Scheme\uff09... 213</p> <p>7.3.3.2   \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\u65b9\u6848\uff08Weighted Round Robin Arbitration Scheme\uff09... 213</p> <p>7.3.3.3   \u5efa\u7acb\u865a\u62df\u901a\u9053\u4ef2\u88c1\u8868... 213</p> <p>7.4    \u7aef\u53e3\u4ef2\u88c1\uff08Port Arbitration\uff09... 215</p> <p>7.4.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09... 215</p> <p>7.4.2   \u7aef\u53e3\u4ef2\u88c1\u673a\u5236\uff08Port Arbitration Mechanisms\uff09... 218</p> <p>7.4.2.1   \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\uff08Hardware-Fixed Arbitration\uff09... 219</p> <p>7.4.2.2   \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\uff08WRR Arbitration\uff09... 219</p> <p>7.4.2.3   \u57fa\u4e8e\u65f6\u95f4\u7684\u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\uff08Time-Based WRR Arbitration\uff0cTBWRR\uff09... 220</p> <p>7.4.3   \u8f7d\u5165\u7aef\u53e3\u4ef2\u88c1\u8868\uff08Loading the Port Arbitration Tables\uff09... 220</p> <p>7.4.4   Switch\u4ef2\u88c1\u793a\u4f8b\uff08Switch Arbitration  Example\uff09... 221</p> <p>7.5    \u591a\u529f\u80fd EP\u7684\u4ef2\u88c1\uff08Arbitration in  Multi-Function Endpoints\uff09... 223</p> <p>7.6    \u540c\u6b65\u7b49\u65f6\u670d\u52a1\u652f\u6301\uff08Isochronous  Support\uff09... 224</p> <p>7.6.1   \u65f6\u95f4\u89c4\u5212\u5c31\u662f\u4e00\u5207\uff08Timing is Everything\uff09... 224</p> <p>7.6.1.1   \u5982\u4f55\u5b9a\u4e49\u65f6\u95f4\u89c4\u5212\uff08How Timing Defined\uff09... 226</p> <p>7.6.1.2   \u5982\u4f55\u5b9e\u65bd\u65f6\u95f4\u89c4\u5212\uff08How Timing is Enforced\uff09... 226</p> <p>7.6.2   \u8f6f\u4ef6\u652f\u6301\uff08Software Support\uff09... 226</p> <p>7.6.2.1   \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff08Device Drivers\uff09... 227</p> <p>7.6.2.2   \u540c\u6b65\u7b49\u65f6\u4ee3\u7406\uff08Isochronous Broker\uff09... 227</p> <p>7.6.3   \u5c06\u4e00\u5207\u7ed3\u5408\u8d77\u6765\uff08Bringing it all together\uff09... 227</p> <p>7.6.3.1   Endpoints. 227</p> <p>7.6.3.2   Switches. 228</p> <p>l   \u4ef2\u88c1\u95ee\u9898\uff08Arbitration Issues\uff09... 228</p> <p>l   \u65f6\u95f4\u89c4\u5212\u95ee\u9898\uff08Timing Issues\uff09... 229</p> <p>l   \u5e26\u5bbd\u5206\u914d\u95ee\u9898\uff08Bandwidth  Allocation Problems\uff09... 230</p> <p>l   \u5ef6\u65f6\u95ee\u9898\uff08Latency Issues\uff09... 231</p> <p>7.6.3.3   Root  Complex. 232</p> <p>l   \u95ee\u9898\uff1a\u7aa5\u63a2\uff08Problem\uff1aSnooping\uff09... 232</p> <p>l   \u7aa5\u63a2\u95ee\u9898\u89e3\u51b3\u65b9\u6cd5\uff08Snooping  Solution\uff09... 232</p> <p>7.6.3.4   \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09... 232</p> <p>7.6.3.5   \u9519\u8bef\u5904\u7406\uff08Error Handling\uff09... 232</p> <p>Chapter 8  Transaction Ordering //\u4e8b\u52a1\u6392\u5e8f... 234</p> <p>\u5173\u4e8e\u4e0a\u4e00\u7ae0... 234</p> <p>\u5173\u4e8e\u672c\u7ae0... 234</p> <p>\u5173\u4e8e\u4e0b\u4e00\u7ae0... 234</p> <p>8.1    \u4ecb\u7ecd\uff08Introduction\uff09... 234</p> <p>8.2    \u5b9a\u4e49\uff08Definitions\uff09... 234</p> <p>8.3    \u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\uff08Simplified  Ordering Rules\uff09... 235</p> <p>8.3.1   \u6392\u5e8f\u89c4\u5219\u4e0e\u6d41\u91cf\u7c7b\u578b\uff08Ordering Rules and Traffic Classes\uff09... 235</p> <p>8.3.2   \u57fa\u4e8e\u5305\u7c7b\u578b\u7684\u6392\u5e8f\u89c4\u5219\uff08Ordering Rules Based On Packet Type\uff09... 236</p> <p>8.3.3   \u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\u8868\uff08The Simplified Ordering Rules Table\uff09... 236</p> <p>8.4    \u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\uff08Producer/Consumer  Model\uff09... 237</p> <p>8.4.1   \u6b63\u786e\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b\uff08Producer/Consumer Sequence-No Errors\uff09... 238</p> <p>8.4.2   \u51fa\u9519\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6392\u5e8f\uff08Producer/Consumer Sequence-Errors\uff09... 241</p> <p>8.5    \u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09... 243</p> <p>8.5.1   RO\u5bf9MWr\u548cMessage\u7684\u5f71\u54cd\uff08RO Effects on MWr and  Message\uff09... 243</p> <p>8.5.2   RO\u5bf9MRd\u4e8b\u52a1\u7684\u5f71\u54cd\uff08RO Effects on MRd  Transactions\uff09... 244</p> <p>8.6    \u5f31\u6392\u5e8f\uff08Weak Ordering\uff09... 244</p> <p>8.6.1   \u4e8b\u52a1\u7684\u6392\u5e8f\u4e0e\u6d41\u63a7\uff08Transaction Ordering and Flow Control\uff09... 245</p> <p>8.6.2   \u4e8b\u52a1\u6682\u505c\uff08Transaction Stalls\uff09... 245</p> <p>8.6.3   VC  Buffer\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4f18\u70b9\uff08VC  Buffers Offer an Advantage\uff09... 246</p> <p>8.7    \u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID Based Ordering\uff0cIDO\uff09... 246</p> <p>8.7.1   \u89e3\u51b3\u65b9\u6848\uff08The Solution\uff09... 246</p> <p>8.7.2   \u4f55\u65f6\u4f7f\u7528IDO\uff08When to use IDO\uff09... 247</p> <p>8.8    \u6b7b\u9501\u7684\u907f\u514d\uff08Deadlock Avoidance\uff09... 248</p>"},{"location":"pcie/all/#part-onethe-big-picture","title":"\u7b2c\u4e00\u90e8\u5206    Part One\uff1aThe Big Picture\u5927\u5c40\u603b\u89c8","text":""},{"location":"pcie/all/#chapter-1-background","title":"Chapter 1      Background //\u80cc\u666f","text":""},{"location":"pcie/all/#_1","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u4e3a\u4e86\u5efa\u7acb\u7406\u89e3PCI Express\uff08PCIe\uff09\u4f53\u7cfb\u7ed3\u6784\u7684\u57fa\u7840\uff0c\u672c\u7ae0\u5148\u56de\u987e\u4e86\u65e9\u51fa\u73b0\u4e8ePCIe\u7684\u603b\u7ebfPCI\uff08Peripheral Component Interface\u5916\u8bbe\u7ec4\u4ef6\u63a5\u53e3\uff09\u7684\u603b\u7ebf\u6a21\u578b\uff0c\u5e76\u63cf\u8ff0\u4e86\u4ed6\u4eec\u7684\u57fa\u672c\u7279\u5f81\u4ee5\u53ca\u5404\u81ea\u7279\u70b9\uff0c\u63a5\u7740\u8ba8\u8bba\u4e86\u4ece\u65e9\u671f\u7684\u5e76\u884c\u603b\u7ebf\u6a21\u578b\u8fc1\u79fb\u5230PCIe\u4f7f\u7528\u7684\u4e32\u884c\u9ad8\u901f\u603b\u7ebf\u6a21\u578b\u7684\u51fa\u53d1\u70b9\u548c\u52a8\u673a\u3002</p>"},{"location":"pcie/all/#_2","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u5bf9PCIe\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u4e86\u4ecb\u7ecd\uff0c\u5e76\u6253\u7b97\u4f5c\u4e3a\u4e00\u4e2a\u201c\u64cd\u4f5c\u6267\u884c\u7ea7\uff08executive level\uff09\u201d\u7684\u6982\u8ff0\uff0c\u5b83\u8986\u76d6\u4e86\u9ad8\u5c42\u4f53\u7cfb\u7ed3\u6784\u7684\u6240\u6709\u57fa\u7840\u5185\u5bb9\u3002\u5b83\u4ecb\u7ecd\u4e86\u534f\u8bae\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u5206\u5c42\u7684PCIe\u7aef\u53e3\u8bbe\u8ba1\u65b9\u6cd5\uff0c\u5e76\u63cf\u8ff0\u4e86\u6bcf\u4e2a\u5c42\u7ea7\u7684\u804c\u8d23\u4f5c\u7528\u3002</p>"},{"location":"pcie/all/#11","title":"1.1 \u5f15\u8a00","text":"<p>\u60f3\u8981\u7406\u89e3PCIe\u7684\u9996\u5148\u4e00\u6b65\uff0c\u662f\u8981\u5bf9PCIe\u6240\u57fa\u4e8e\u7684\u5148\u524d\u7684\u6280\u672f\u5efa\u7acb\u575a\u5b9e\u7684\u57fa\u7840\uff0c\u800c\u672c\u7ae0\u5219\u5c06\u5bf9\u5b83\u4eec\u7684\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u6982\u8ff0\u3002\u5bf9PCI\u5df2\u7ecf\u6bd4\u8f83\u719f\u6089\u7684\u8bfb\u8005\u53ef\u4ee5\u8df3\u8fc7\u672c\u7ae0\u53bb\u770b\u4e0b\u4e00\u7ae0\u3002\u5982\u672c\u7ae0\u6807\u9898\u201c\u80cc\u666f\u201d\uff0c\u672c\u7ae0\u4ec5\u610f\u5728\u7ed9\u51fa\u4e00\u4e2a\u7b80\u660e\u7684\u6982\u8ff0\u3002\u5bf9\u4e8e\u5173\u4e8ePCI\u548cPCI-X\u7684\u66f4\u6df1\u66f4\u7ec6\u8282\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003MindShare\u7684\u4e66\u7c4d\u300aPCI System Architecture\u300b\u4ee5\u53ca\u300aPCI-X System Architecture\u300b\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u4e3a\u4ec0\u4e48\u672c\u7ae0\u7684\u80cc\u666f\u4ecb\u7ecd\u662f\u5bf9\u7406\u89e3PCIe\u6709\u5e2e\u52a9\u7684\uff0c\u73b0\u5728\u5728PCIe\u4e0a\u4f7f\u7528\u7684\u8f6f\u4ef6\uff08\u9a71\u52a8\u64cd\u4f5c\uff09\u4e0e\u5f53\u521d\u5728PCI\u4e0a\u4f7f\u7528\u7684\u8f6f\u4ef6\u5927\u81f4\u76f8\u540c\u3002\u4fdd\u6301\u8fd9\u79cd\u5411\u540e\u7684\u517c\u5bb9\u6027\uff0c\u4f7f\u5f97\u65e7\u7684\u8bbe\u8ba1\u8fc1\u79fb\u5230\u65b0\u7684\u8bbe\u8ba1\uff08PCI\u5230PCIe\uff09\u65f6\u53ef\u4ee5\u8ba9\u8f6f\u4ef6\u4fee\u6539\u7684\u5c3d\u53ef\u80fd\u5c11\u3001\u82b1\u8d39\u5c3d\u53ef\u80fd\u4f4e\u7684\u6210\u672c\uff0c\u8fd9\u5373\u662f\u5728\u9f13\u52b1\u5c31\u8bbe\u8ba1\u5411\u65b0\u8bbe\u8ba1\u8fc1\u79fb\u3002\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u662f\uff0c\u65e7\u7684\u652f\u6301PCI\u7684\u8f6f\u4ef6\u5728PCIe\u7cfb\u7edf\u4e2d\u7684\u5de5\u4f5c\u65b9\u5f0f\u65e0\u9700\u53d1\u751f\u6539\u53d8\uff0c\u800c\u65b0\u7684\u8f6f\u4ef6\uff08PCIe\u7684\u9a71\u52a8\u8f6f\u4ef6\uff09\u4e5f\u5c06\u6309\u7167PCI\u4e00\u6837\u7684\u6a21\u578b\u8fdb\u884c\u64cd\u4f5c\uff08\u4f8b\u5982\u5bf9\u914d\u7f6e\u7a7a\u95f4\uff09\u3002\u57fa\u4e8e\u8fd9\u6837\u7684\u539f\u56e0\u4ee5\u53ca\u5176\u4ed6\u7684\u4e00\u4e9b\u539f\u56e0\uff0c\u7406\u89e3PCI\u4ee5\u53ca\u5b83\u7684\u64cd\u4f5c\u6a21\u578b\u5c06\u6709\u52a9\u4e8e\u4fc3\u8fdb\u5bf9PCIe\u7684\u7406\u89e3\u3002</p>"},{"location":"pcie/all/#12-pcipci-x","title":"1.2 PCI\u4e0ePCI-X","text":"<p>PCI\uff08Peripheral Component Interface\u5916\u8bbe\u7ec4\u4ef6\u63a5\u53e3\uff09\u603b\u7ebf\uff0c\u5176\u88ab\u5f00\u53d1\u51fa\u6765\u7684\u65f6\u95f4\u4e3a1990\u5e74\u4ee3\u521d\uff0c\u5f53\u65f6\u4eba\u4eec\u671f\u671b\u7528\u5b83\u6765\u89e3\u51b3PCs\uff08personal computer\u4e2a\u4eba\u7535\u8111\uff09\u7684\u5916\u8bbe\u603b\u7ebf\u7684\u4e00\u4e9b\u7f3a\u70b9\u3002\u800c\u90a3\u4e2a\u5e74\u4ee3\u7684\u8fd9\u4e2a\u9886\u57df\u7684\u6280\u672f\u6807\u51c6\u662fIBM\u7684AT\u603b\u7ebf\uff08Advanced Technology\uff09\uff0c\u5b83\u4e5f\u88ab\u5176\u4ed6\u4f9b\u5e94\u5546\u79f0\u4e3aISA\u603b\u7ebf\uff08Industry Standard Architecture\uff09\u3002ISA\u603b\u7ebf\u662f\u4e3a286 16\u4f4d\u8ba1\u7b97\u673a\u800c\u8bbe\u8ba1\u7684\uff0c\u5b83\u5728286\u4e0a\u4e5f\u53d1\u6325\u4e86\u8db3\u591f\u7684\u6027\u80fd\uff0c\u4f46\u968f\u7740\u65b0\u578b\u768432\u4f4d\u8ba1\u7b97\u673a\u53ca\u5176\u5916\u8bbe\u4eec\u51fa\u73b0\uff0c\u65b0\u7684\u9700\u6c42\u4e5f\u51fa\u73b0\u4e86\uff1a\u66f4\u9ad8\u7684\u5e26\u5bbd\u3001\u66f4\u591a\u66f4\u597d\u7684\u529f\u80fd\uff08\u4f8b\u5982\u5373\u63d2\u5373\u7528\uff09\u3002\u9664\u6b64\u4e4b\u5916\uff0cISA\u603b\u7ebf\u4f7f\u7528\u7684\u8fde\u63a5\u5668\u662f\u5177\u6709\u8f83\u591a\u9488\u811a\u6570\u7684\u5927\u578b\u8fde\u63a5\u5668\u3002PC\u4f9b\u5e94\u5546\u4eec\u8ba4\u8bc6\u5230\u4e86\u9700\u8981\u505a\u51fa\u4e00\u5b9a\u7684\u6539\u53d8\u4e86\uff0c\u51e0\u79cd\u7528\u4e8e\u66ff\u4ee3ISA\u603b\u7ebf\u7684\u8bbe\u8ba1\u4e5f\u88ab\u63d0\u51fa\uff0c\u4f8b\u5982IBM\u7684MCA\uff08Micro-Channel Architecture\uff09\uff0cEISA\u603b\u7ebf\uff08Extended ISA\uff0c\u8fd9\u662f\u7531IBM\u7684\u7ade\u4e89\u5bf9\u624b\u63d0\u51fa\u7684\uff09\uff0c\u4ee5\u53caVESA\u603b\u7ebf\uff08Video Electronics Standards Association\uff0c\u5b83\u7531\u58f0\u5361\u4f9b\u5e94\u5546\u4eec\u4e3a\u9002\u914d\u58f0\u5361\u800c\u63d0\u51fa\uff09\u3002\u7136\u800c\uff0c\u6240\u6709\u7684\u8fd9\u4e9b\u8bbe\u8ba1\u90fd\u5177\u6709\u4e00\u4e9b\u4f7f\u5f97\u5b83\u4eec\u65e0\u6cd5\u88ab\u666e\u53ca\u7684\u7f3a\u70b9\u3002\u6700\u7ec8\uff0c\u4e00\u4e2a\u7531PC\u5e02\u573a\u7684\u4e3b\u8981\u516c\u53f8\u4eec\u5171\u540c\u8054\u5408\u5efa\u7acb\u7684\u7ec4\u7ec7PCISIG\uff08PCI Special Interest Group\uff09\u5f00\u53d1\u51fa\u4e86PCI\u603b\u7ebf\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u4e00\u79cd\u5f00\u653e\u603b\u7ebf\u3002\u5728\u5f53\u65f6\uff0cPCI\u8fd9\u79cd\u65b0\u578b\u603b\u7ebf\u4f53\u7cfb\u7ed3\u6784\u5728\u6027\u80fd\u4e0a\u5927\u5927\u7684\u4f18\u4e8eISA\uff0c\u800c\u4e14\u5b83\u5728\u6bcf\u4e2a\u8bbe\u5907\u5185\u90e8\u65b0\u5b9a\u4e49\u4e86\u4e00\u7ec4\u5bc4\u5b58\u5668\uff0c\u79f0\u4e4b\u4e3a\u914d\u7f6e\u7a7a\u95f4\uff08configuration space\uff09\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u67e5\u770b\u4e00\u4e2aPCI\u8bbe\u5907\u5185\u90e8\u6240\u9700\u7684\u5b58\u50a8\u548cIO\u8d44\u6e90\uff0c\u540c\u65f6\u8ba9\u8f6f\u4ef6\u4e3a\u4e00\u4e2a\u7cfb\u7edf\u4e0b\u7684\u5404\u4e2a\u8bbe\u5907\u5206\u914d\u4e92\u4e0d\u51b2\u7a81\u7684\u5730\u5740\u3002\u8fd9\u4e9b\u7279\u6027\uff1a\u5f00\u653e\u5f0f\u8bbe\u8ba1\u3001\u9ad8\u901f\u3001\u8f6f\u4ef6\u53ef\u89c1\u6027\u4e0e\u53ef\u63a7\u6027\uff08software visibility and control\uff09\uff0c\u5e2e\u52a9PCI\u514b\u670d\u4e86\u9650\u5236ISA\u4e0e\u5176\u4ed6\u603b\u7ebf\u7684\u53d1\u5c55\u969c\u788d\uff0c\u8ba9PCI\u8fc5\u901f\u7684\u79f0\u4e3a\u4e86PC\u4e2d\u7684\u6807\u51c6\u5916\u8bbe\u603b\u7ebf\u3002</p> <p>\u51e0\u5e74\u4e4b\u540e\uff0cPCI-X\uff08PCI eXtended\uff09\u88ab\u5f00\u53d1\u51fa\u6765\uff0c\u4f5c\u4e3aPCI\u4f53\u7cfb\u7ed3\u6784\u7684\u4e00\u79cd\u903b\u8f91\u6269\u5c55\uff08logical extension\uff09\uff0c\u5e76\u5c06\u603b\u7ebf\u6027\u80fd\u63d0\u5347\u4e86\u4e0d\u5c11\u3002\u6211\u4eec\u5c06\u7a0d\u540e\u518d\u8ba8\u8bbaPCI-X\u76f8\u8f83\u4e8ePCI\u7684\u6539\u53d8\uff0c\u4f46\u662f\u9700\u63d0\u524d\u4e00\u63d0\u7684\u662fPCI-X\u7684\u4e00\u4e2a\u4e3b\u8981\u8bbe\u8ba1\u76ee\u6807\u5c31\u662f\u4fdd\u6301\u4e0ePCI\u8bbe\u5907\u7684\u53ef\u517c\u5bb9\u6027\uff0c\u800c\u4e14\u662f\u8f6f\u4ef6\u548c\u786c\u4ef6\u7684\u517c\u5bb9\u6027\u90fd\u8981\u4fdd\u8bc1\uff0c\u8fd9\u5c06\u4f7f\u5f97\u4ecePCI\u8fc1\u79fb\u81f3PCI-X\u5c3d\u53ef\u80fd\u7684\u7b80\u5355\u3002\u4e0d\u4e45\u540e\uff0cPCI-X 2.0\u7248\u672c\u5c06\u901f\u7387\u63d0\u5347\u5230\u4e86\u66f4\u9ad8\uff0c\u539f\u59cb\u6570\u636e\u901f\u7387\u8fbe\u5230\u4e864GB/s\u3002\u56e0\u4e3aPCI-X\u4fdd\u6301\u4e86\u5bf9PCI\u786c\u4ef6\u4e0a\u7684\u5411\u540e\u517c\u5bb9\u6027\uff0c\u6240\u4ee5\u5b83\u4f9d\u7136\u662f\u4e00\u4e2a\u5e76\u884c\u603b\u7ebf\uff0c\u5e76\u7ee7\u627f\u4e86\u4e0e\u8be5\u603b\u7ebf\u6a21\u578b\u76f8\u5173\u7684\u4e00\u4e9b\u95ee\u9898\u3002\u6709\u610f\u601d\u7684\u4e8b\u60c5\u6765\u4e86\uff0c\u5e76\u884c\u603b\u7ebf\u7684\u6709\u6548\u5e26\u5bbd\u6700\u7ec8\u4f1a\u8fbe\u5230\u4e00\u4e2a\u5b9e\u9645\u7684\u4e0a\u9650\uff0c\u7136\u540e\u5c31\u65e0\u6cd5\u7b80\u5355\u7684\u7ee7\u7eed\u63d0\u5347\u3002\u800cPCISIG\u4e00\u76f4\u5728\u63a2\u7d22\u5982\u4f55\u5c06PCI-X\u7684\u901f\u7387\u8fdb\u4e00\u6b65\u63d0\u5347\uff0c\u4f46\u6700\u7ec8\u8fd9\u9879\u52aa\u529b\u8fd8\u662f\u88ab\u653e\u5f03\u4e86\u3002\u8fd9\u79cd\u901f\u7387\u4e0a\u9650\uff0c\u8fde\u540c\u591a\u9488\u811a\u7684\u8fde\u63a5\u65b9\u5f0f\uff0c\u867d\u7136\u662f\u5e76\u884c\u603b\u7ebf\u7684\u7f3a\u70b9\u4f46\u662f\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e86\u52a8\u529b\uff0c\u63a8\u52a8\u4e86\u5e76\u884c\u603b\u7ebf\u6a21\u578b\u5411\u65b0\u578b\u7684\u4e32\u884c\u603b\u7ebf\u6a21\u578b\u8f6c\u578b\u3002</p> <p>\u8fd9\u4e9b\u65e9\u671f\u603b\u7ebf\u7684\u5b9a\u4e49\u88ab\u7f57\u5217\u5728\u8868 1\u20111\uff0c\u5b83\u5c55\u793a\u4e86\u968f\u65f6\u95f4\u53d1\u5c55\u800c\u53d8\u5f97\u66f4\u9ad8\u7684\u5e26\u5bbd\u4e0e\u9891\u7387\u3002\u8868\u4e2d\u6709\u4e00\u70b9\u5f88\u6709\u8da3\u7684\u9700\u8981\u6ce8\u610f\uff0c\u90a3\u5c31\u662f\u65f6\u949f\u9891\u7387\u548c\u603b\u7ebf\u4e0a\u63d2\u677f\u5361\u7684\u63d2\u69fd\u6570\u91cf\u4e4b\u95f4\u7684\u76f8\u5173\u6027\u3002\u8fd9\u662f\u7531PCI\u7684\u4f4e\u529f\u8017\u4fe1\u53f7\u6a21\u578b\u5e26\u6765\u7684\uff0c\u8fd9\u610f\u5473\u7740\u66f4\u9ad8\u7684\u603b\u7ebf\u9891\u7387\u9700\u8981\u66f4\u77ed\u7684\u677f\u4e0a\u8d70\u7ebf\u4ee5\u53ca\u66f4\u5c11\u7684\u603b\u7ebf\u8d1f\u8f7d\uff08\u8be6\u60c5\u53ef\u89c1\u201cReflected-Wave Signaling\u201d\uff09\u3002\u53e6\u5916\u6709\u8da3\u7684\u4e00\u70b9\u662f\uff0c\u968f\u7740\u603b\u7ebf\u9891\u7387\u7684\u589e\u52a0\uff0c\u5171\u4eab\u603b\u7ebf\u4e0a\u5141\u8bb8\u7684\u8bbe\u5907\u6570\u91cf\u5728\u51cf\u5c11\u3002\u5f53PCI-X 2.0\u88ab\u5f15\u5165\u4f7f\u7528\u65f6\uff0c\u60f3\u8981\u8fbe\u5230\u5b83\u7684\u9ad8\u901f\u7387\u9700\u8981\u8981\u6c42\u603b\u7ebf\u53d8\u4e3a\u4e00\u4e2a\u70b9\u5230\u70b9\u7684\u4e92\u8fde\uff08point-to-point interconnect\uff09\u3002</p> <p></p> <p>\u8868 1\u20111 \u603b\u7ebf\u9891\u7387\u3001\u5e26\u5bbd\u3001\u63d2\u69fd\u6570\u91cf\u7684\u5bf9\u6bd4</p>"},{"location":"pcie/all/#13-pcipci-basics","title":"1.3 PCI\u57fa\u7840(PCI Basics)","text":""},{"location":"pcie/all/#131-pci","title":"1.3.1     \u57fa\u4e8ePCI\u7684\u7cfb\u7edf\u7684\u4e00\u4e9b\u57fa\u7840\u77e5\u8bc6","text":"<p>\u56fe 1\u20111\u5c55\u793a\u4e86\u4e00\u4e2a\u57fa\u4e8ePCI\u603b\u7ebf\u7684\u8001\u7cfb\u7edf\u7ed3\u6784\u3002\u8be5\u7cfb\u7edf\u5305\u62ec\u4e00\u4e2a\u5317\u6865\uff08North Bridge\u79f0\u4e3a\u201c\u5317\u201d\u662f\u56e0\u4e3a\u5982\u679c\u5c06\u56fe\u770b\u505a\u4e00\u5f20\u5730\u56fe\uff0c\u5b83\u4f4d\u4e8e\u4e2d\u592ePCI\u603b\u7ebf\u7684\u5317\u65b9\u5411\uff09\uff0c\u5317\u6865\u662f\u5904\u7406\u5668\u4e0ePCI\u603b\u7ebf\u4e4b\u95f4\u7684\u63a5\u53e3\u3002\u4e0e\u5317\u6865\u76f8\u8fde\u7684\u662f\u5904\u7406\u5668\u603b\u7ebf\uff08processor bus\uff09\u3001\u7cfb\u7edf\u5b58\u50a8\u603b\u7ebf\uff08system memory bus\uff09\u3001AGP\u56fe\u50cf\u603b\u7ebf\uff08AGP graphics bus\uff09\uff0c\u4ee5\u53caPCI\u603b\u7ebf\u3002\u51e0\u4e2a\u8bbe\u5907\u5c06\u4f1a\u5171\u4eabPCI\u603b\u7ebf\uff0c\u5b83\u4eec\u8981\u4e48\u76f4\u63a5\u4e0e\u603b\u7ebf\u76f8\u8fde\uff0c\u8981\u4e48\u4f5c\u4e3a\u63d2\u5165\u677f\u5361\u63d2\u5165\u5230\u8fde\u63a5\u5668\u4e0a\u3002\u5728\u4e2d\u592ePCI\u603b\u7ebf\u7684\u201c\u5357\u65b9\u201d\u6709\u4e00\u4e2a\u5357\u6865\uff08South Bridge\uff09\uff0c\u5b83\u7528\u4e8e\u5c06PCI\u4e0e\u7cfb\u7edf\u5916\u8bbe\u76f8\u8fde\u63a5\uff0c\u8fd9\u91cc\u7684\u7cfb\u7edf\u5916\u8bbe\u53ef\u4ee5\u662f\u4e3a\u4e86\u4f7f\u7528\u65e7\u7684\u9057\u7559\u8bbe\u5907\u800c\u5e94\u7528\u53d1\u5c55\u4e86\u591a\u5e74\u7684ISA\u603b\u7ebf\u3002\u5357\u6865\u901a\u5e38\u4e5f\u662fPCI\u7684\u4e2d\u5fc3\u8d44\u6e90\u533a\uff08central resource\uff09\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7cfb\u7edf\u4fe1\u53f7\u8bf8\u5982\u590d\u4f4d\u3001\u53c2\u8003\u65f6\u949f\u548c\u9519\u8bef\u62a5\u544a\u64cd\u4f5c\u3002</p> <p></p> <p>\u56fe 1\u20111\u57fa\u4e8e\u65e7PCI\u603b\u7ebf\u7684\u5e73\u53f0</p>"},{"location":"pcie/all/#132-pciinitiatortarget","title":"1.3.2     PCI\u603b\u7ebf\u53d1\u8d77\u65b9(Initiator)\u4e0e\u76ee\u6807\u65b9(Target)","text":"<p>\u5728PCI\u5c42\u6b21\u7ed3\u6784\u4e2d\uff0c\u603b\u7ebf\u4e0a\u7684\u6bcf\u4e2a\u8bbe\u5907\uff08device\uff09\u53ef\u4ee5\u5305\u542b\u591a\u8fbe8\u4e2a\u529f\u80fd\uff08function\uff09\uff0c\u8fd9\u4e9b\u529f\u80fd\u90fd\u5171\u4eab\u8be5\u8bbe\u5907\u7684\u603b\u7ebf\u63a5\u53e3\uff0c\u529f\u80fd\u7f16\u53f7\u4e3a0\u52307\uff08\u4e00\u4e2a\u4ec5\u5177\u6709\u5355\u529f\u80fd\u7684\u8bbe\u5907\u901a\u5e38\u5c06\u88ab\u5206\u914d\u529f\u80fd\u53f70\uff09\u3002\u6bcf\u4e2a\u529f\u80fd\u90fd\u80fd\u4f5c\u4e3a\u603b\u7ebf\u4e0a\u4e8b\u52a1\uff08transaction\uff09\u7684\u76ee\u6807\u65b9\uff0c\u800c\u4e14\u5b83\u4eec\u4e2d\u7684\u5927\u591a\u6570\u8fd8\u53ef\u4ee5\u4f5c\u4e3a\u4e8b\u52a1\u7684\u53d1\u8d77\u65b9\u3002\u8fd9\u6837\u7684\u53d1\u8d77\u65b9\uff08\u79f0\u4e3a\u603b\u7ebf\u4e3b\u8bbe\u5907\uff09\u6709\u4e00\u5bf9\u9488\u811a\uff08REQ#\u4e0eGNT#\uff0c\u7b26\u53f7#\u8868\u793a\u4ed6\u4eec\u4e3a\u4f4e\u6709\u6548\u4fe1\u53f7\uff09\uff0c\u8fd9\u4e00\u5bf9\u4fe1\u53f7\u7528\u6765\u5904\u7406\u5171\u4eabPCI\u603b\u7ebf\u65f6\u7684\u4ef2\u88c1\u3002\u5982\u56fe 1\u20112\u6240\u793a\uff0c\u8bf7\u6c42\u4fe1\u53f7\uff08REQ#\uff09\u6709\u6548\u65f6\u8868\u793a\u4e3b\u8bbe\u5907\u9700\u8981\u4f7f\u7528\u603b\u7ebf\uff0c\u5e76\u5c06\u6b64\u4fe1\u606f\u544a\u77e5\u603b\u7ebf\u4ef2\u88c1\u5668\u6765\u4e0e\u6b64\u65f6\u6240\u6709\u7684\u5176\u4ed6\u8bf7\u6c42\u4e00\u8d77\u8fdb\u884c\u8bc4\u4f30\u4ef2\u88c1\uff0c\u6700\u7ec8\u5c06\u5f97\u51fa\u4e0b\u4e00\u65f6\u523b\u7531\u54ea\u4e00\u4e2a\u8bbe\u5907\u6765\u5360\u7528PCI\u603b\u7ebf\u3002\u4ef2\u88c1\u5668\u901a\u5e38\u4f4d\u4e8e\u6865\uff08bridge\uff09\u4e2d\uff0c\u6865\u662f\u4e00\u79cd\u5728\u5c42\u6b21\u7ed3\u6784\u4e2d\u4f4d\u4e8e\u603b\u7ebf\u4e4b\u4e0a\u7684\u7ed3\u6784\uff0c\u5b83\u53ef\u4ee5\u63a5\u6536\u603b\u7ebf\u4e0a\u6240\u6709\u4e8b\u52a1\u53d1\u8d77\u65b9\uff08\u603b\u7ebf\u4e3b\u8bbe\u5907\uff09\u6240\u53d1\u51fa\u7684\u4ef2\u88c1\u8bf7\u6c42\u3002\u4ef2\u88c1\u5668\u5c06\u51b3\u5b9a\u8c01\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\uff0c\u5e76\u5c06\u8fd9\u4e2a\u8bbe\u5907\u7684Grant\uff08GNT#\uff09\u7f6e\u4e3a\u6709\u6548\uff08asserts the Grant pin for that device\uff09\u3002\u6839\u636e\u534f\u8bae\uff0c\u53ea\u8981\u603b\u7ebf\u4e0a\u7684\u4e0a\u4e00\u4e2a\u4e8b\u52a1\u7ed3\u675f\u4e14\u603b\u7ebf\u8fdb\u5165\u7a7a\u95f2\u72b6\u6001\u65f6\uff0c\u5bf9\u4e8e\u4efb\u610f\u8bbe\u5907\uff0c\u53ea\u8981\u5728\u6b64\u65f6\u770b\u5230\u81ea\u5df1\u7684GNT#\u4fe1\u53f7\u88ab\u7f6e\u4e3a\u6709\u6548\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u7684\u4e3b\u8bbe\u5907\uff0c\u5b83\u5c31\u53ef\u4ee5\u5f00\u59cb\u53d1\u8d77\u5b83\u7684\u4e8b\u52a1\u3002</p> <p></p> <p>\u56fe 1\u20112 PCI\u603b\u7ebf\u4ef2\u88c1</p>"},{"location":"pcie/all/#133-pci","title":"1.3.3     \u5178\u578b\u7684PCI\u603b\u7ebf\u5468\u671f","text":"<p>\u56fe 1\u20113\u5c55\u793a\u4e86\u4e00\u6b21\u5178\u578b\u7684PCI\u603b\u7ebf\u5468\u671f\u3002PCI\u603b\u7ebf\u662f\u540c\u6b65\u603b\u7ebf\uff0c\u8fd9\u610f\u5473\u7740\u603b\u7ebf\u4e0a\u7684\u6d3b\u52a8\u90fd\u53d1\u751f\u5728\u65f6\u949f\u8fb9\u6cbf\uff0c\u56e0\u6b64\u5c06\u65f6\u949f\u4fe1\u53f7\u653e\u5728\u56fe\u6807\u7684\u9876\u90e8\uff0c\u5e76\u5c06\u5b83\u7684\u4e0a\u5347\u6cbf\u90fd\u7528\u865a\u7ebf\u6807\u6ce8\u51fa\u6765\uff0c\u8fd9\u662f\u56e0\u4e3a\u4fe1\u53f7\u6b63\u662f\u5728\u8fd9\u4e9b\u865a\u7ebf\u6240\u8868\u793a\u7684\u65f6\u523b\u88ab\u53d1\u51fa\uff08driven out\uff09\u6216\u88ab\u91c7\u6837\uff08sampled\uff09\u3002\u4e0b\u9762\u5bf9\u603b\u7ebf\u4e0a\u53d1\u751f\u4e86\u4ec0\u4e48\u8fdb\u884c\u4e00\u4e2a\u7b80\u660e\u7684\u63cf\u8ff0\u3002</p> <p>\\1.    \u5728\u65f6\u949f\u6cbf1\uff0cFRAME#\u4fe1\u53f7\uff08\u6b64\u4fe1\u53f7\u6709\u6548\u65f6\u88ab\u7528\u6765\u8868\u793a\u603b\u7ebf\u8bbf\u95ee\u6b63\u5728\u8fdb\u884c\u4e2d\uff09\u548cIRDY#\u4fe1\u53f7\uff08Initiator ReaDY for data\uff0c\u53d1\u8d77\u65b9\u51c6\u5907\u597d\u6570\u636e\uff09\u8fd9\u4e24\u4e2a\u4fe1\u53f7\u90fd\u5904\u4e8e\u672a\u6709\u6548\u72b6\u6001\uff0c\u8fd9\u8868\u793a\u603b\u7ebf\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\u3002\u4e0e\u6b64\u540c\u65f6\uff0cGNT#\u6709\u6548\uff0c\u8fd9\u610f\u5473\u7740\u603b\u7ebf\u4ef2\u88c1\u5668\u5df2\u7ecf\u9009\u62e9\u4e86\u8be5\u8bbe\u5907\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u4e8b\u52a1\u53d1\u8d77\u65b9\u3002</p> <p>\\2.    \u5728\u65f6\u949f\u6cbf2\uff0c\u53d1\u8d77\u65b9\u5c06\u4f1a\u628aFRAME#\u4fe1\u53f7\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u8868\u793a\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\u5df2\u7ecf\u88ab\u5b83\u53d1\u8d77\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u5b83\u5c06\u628a\u8fd9\u4e2a\u4e8b\u52a1\u7684\u5730\u5740\u4e0e\u547d\u4ee4\u9a71\u52a8\u5230\u603b\u7ebf\u4e0a\u3002\u603b\u7ebf\u4e0a\u5176\u4ed6\u6240\u6709\u7684\u8bbe\u5907\u90fd\u5c06\u4f1a\u628a\u8fd9\u4e9b\u4fe1\u606f\u9501\u5b58\u8d77\u6765\uff0c\u5e76\u5c06\u5730\u5740\u8bd1\u7801\uff0c\u67e5\u770b\u81ea\u5df1\u662f\u5426\u4e0e\u4e4b\u76f8\u5339\u914d\u3002</p> <p>\\3.    \u5728\u65f6\u949f\u6cbf3\uff0c\u53d1\u8d77\u65b9\u5c06IRDY#\u4fe1\u53f7\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u8868\u793a\u5b83\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002\u56fe\u4e2dAD\u603b\u7ebf\u4e0a\u7684\u73af\u5f62\u7bad\u5934\u7b26\u53f7\u8868\u793a\u8fd9\u4e2a\u4e09\u6001\u603b\u7ebf\uff08\u53ef\u4ee5\u7406\u89e3\u4e3ainout\u578b\uff09\u6b63\u5904\u4e8e\u201c\u8f6c\u5411\u5468\u671f\u201d\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2a\u4fe1\u53f7\u7684\u62e5\u6709\u8005\uff08\u4e09\u6001\u603b\u7ebf\u4e0a\u7684\u4fe1\u53f7\u6b64\u65f6\u662f\u8c01\u7684\uff09\u53d1\u751f\u4e86\u53d8\u5316\uff08\u8fd9\u91cc\u51fa\u73b0\u201c\u8f6c\u5411\u5468\u671fturn-around cycles\u201d\u662f\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u8bfb\u4e8b\u52a1\uff1b\u53d1\u8d77\u8005\u53d1\u51fa\u5730\u5740\u4fe1\u606f\u548c\u63a5\u6536\u6570\u636e\u7684\u4fe1\u53f7\u5f15\u811a\u662f\u76f8\u540c\u7684\uff09\u3002\u6253\u5f00\u76ee\u6807\u65b9\uff08target\uff09\u7684\u7f13\u51b2buffer\u7684\u65f6\u949f\u6cbf\u4e0e\u5173\u95ed\u53d1\u8d77\u65b9\u7f13\u51b2buffer\u7684\u65f6\u949f\u6cbf\u4e0d\u80fd\u76f8\u540c\uff0c\u56e0\u4e3a\u6211\u4eec\u60f3\u5c3d\u91cf\u907f\u514d\u4e24\u4e2abuffer\u90fd\u5728\u9a71\u52a8\u540c\u4e00\u4e2a\u4fe1\u53f7\u7684\u53ef\u80fd\u6027\uff08\u5373\u90fd\u5f80AD\u603b\u7ebf\u4e0a\u9a71\u52a8\u6570\u636e\uff09\uff0c\u54ea\u6015\u53ea\u662f\u5f88\u77ed\u7684\u65f6\u95f4\u4e5f\u4e0d\u884c\u3002\u603b\u7ebf\u7684\u4e89\u7528\u5c06\u4f1a\u635f\u574f\u8bbe\u5907\uff0c\u56e0\u6b64\uff0c\u76f8\u53cd\u5730\uff0c\u9700\u8981\u5728\u524d\u4e00\u4e2abuffer\u5173\u95ed\u540e\u7684\u4e0b\u4e00\u4e2a\u65f6\u949f\u518d\u6253\u5f00\u4e00\u4e2a\u65b0\u7684buffer\u3002\u5728\u6539\u53d8\u65b9\u5411\u4e4b\u524d\uff0c\u6bcf\u4e2a\u5171\u4eab\u4fe1\u53f7\u90fd\u9700\u8981\u8fd9\u6837\u8fdb\u884c\u5904\u7406\u3002</p> <p>\\4.    \u5728\u65f6\u949f\u6cbf4\uff0c\u603b\u7ebf\u4e0a\u7684\u4e00\u4e2a\u8bbe\u5907\u8bc6\u522b\u5230\u4e86\u8bf7\u6c42\u7684\u5730\u5740\u4e0e\u81ea\u5df1\u76f8\u5339\u914d\uff0c\u4e8e\u662f\u4fbf\u901a\u8fc7\u5c06DEVSEL#\u4fe1\u53f7\uff08device select\uff09\u7f6e\u4e3a\u6709\u6548\u7684\u65b9\u5f0f\u5bf9\u4e8b\u52a1\u53d1\u51fa\u54cd\u5e94\uff0c\u5e76\u52a0\u5165\u5230\u4e8b\u52a1\u7684\u5b8c\u6210\u4e2d\u53bb\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u5b83\u5c06\u628aTRDY#\u4fe1\u53f7\uff08Target ReaDY\uff09\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u8868\u793a\u5b83\u6b63\u5728\u53d1\u9001\u8bfb\u6570\u636e\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u5e76\u5c06\u6570\u636e\u9a71\u52a8\u5230AD\u603b\u7ebf\u4e0a\uff08\u653e\u5230\u603b\u7ebf\u4e0a\u7684\u65f6\u95f4\u53ef\u4ee5\u540e\u5ef6\uff0c\u603b\u7ebf\u5141\u8bb8\u76ee\u6807\u65b9\u5728FRAME#\u6709\u6548\u4e0eTRDY#\u6709\u6548\u95f4\u95f4\u9694\u6700\u591a16\u4e2a\u65f6\u949f\u5468\u671f\uff09\u3002\u7531\u4e8e\u6b64\u65f6IRDY#\u4e0eTRDY#\u90fd\u5904\u4e8e\u6709\u6548\u72b6\u6001\u4e86\uff0c\u6570\u636e\u5c06\u5728\u6b64\u4e0a\u5347\u6cbf\u5f00\u59cb\u4f20\u8f93\uff0c\u81f3\u6b64\u5b8c\u6210\u4e86\u7b2c\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff08first data phase\uff09\u3002Initiator\u77e5\u9053\u6700\u7ec8\u4e00\u5171\u8981\u4f20\u8f93\u591a\u5c11\u5b57\u8282\u7684\u6570\u636e\uff0c\u4f46\u662fTarget\u5e76\u4e0d\u77e5\u9053\u3002\u5728\u4e8b\u52a1\u7684\u547d\u4ee4\u4fe1\u606f\u4e2d\u5e76\u4e0d\u5305\u542b\u5b57\u8282\u6570\u4fe1\u606f\uff0c\u56e0\u6b64\u6bcf\u5f53\u5b8c\u6210\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff0cTarget\u90fd\u5fc5\u987b\u67e5\u770bFRAME#\u4fe1\u53f7\u7684\u72b6\u6001\uff0c\u4ee5\u6b64\u6765\u5f97\u77e5Initiator\u662f\u5426\u5bf9\u4f20\u8f93\u7684\u6570\u636e\u91cf\u6ee1\u610f\uff08\u5373\u662f\u5426\u8fbe\u5230Initiator\u9700\u8981\u7684\u6570\u636e\u91cf\uff09\u3002\u5982\u679cFRAME#\u4f9d\u7136\u6709\u6548\uff0c\u90a3\u4e48\u8bf4\u660e\u8fd9\u5e76\u4e0d\u662f\u6700\u540e\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff0cTarget\u4ecd\u7136\u9700\u8981\u7ee7\u7eed\u5411Initiator\u4f20\u8f93\u6570\u636e\uff0c\u4e8b\u52a1\u5c06\u6309\u7167\u76f8\u540c\u7684\u65b9\u5f0f\u7ee7\u7eed\u5904\u7406\u63a5\u4e0b\u6765\u4f20\u8f93\u7684\u5b57\u8282\u3002</p> <p>\\5.    \u5728\u65f6\u949f\u6cbf5\uff0cTarget\u8fd8\u6ca1\u6709\u51c6\u5907\u597d\u7ee7\u7eed\u53d1\u9001\u4e0b\u4e00\u7ec4\u6570\u636e\uff0c\u56e0\u6b64\u5b83\u5c06TRDY#\u7f6e\u4e3a\u65e0\u6548\u3002\u6211\u4eec\u5c06\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a\u63d2\u5165\u4e86\u4e00\u4e2a\u201c\u7b49\u5f85\u72b6\u6001\u201d\uff0c\u8fd9\u4f7f\u5f97\u4e8b\u52a1\u88ab\u5ef6\u8fdf\u4e86\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u3002Initiator\u548cTarget\u90fd\u53ef\u4ee5\u8fdb\u884c\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u5b83\u4eec\u6700\u591a\u53ef\u4ee5\u5c06\u4e0b\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u540e\u5ef68\u4e2a\u8fde\u7eed\u7684\u65f6\u949f\u5468\u671f\u3002</p> <p>\\6.    \u5728\u65f6\u949f\u6cbf6\uff0c\u7b2c\u4e8c\u7ec4\u6570\u636e\u88ab\u4f20\u8f93\uff0c\u5e76\u4e14\u7531\u4e8e\u4f20\u8f93\u540eFRAME#\u4fe1\u53f7\u4f9d\u7136\u6709\u6548\uff0cTarget\u5c31\u77e5\u9053\u4f9d\u7136\u9700\u8981\u7ee7\u7eed\u5411Initiator\u4f20\u9012\u6570\u636e\u3002</p> <p>\\7.    \u5728\u65f6\u949f\u6cbf7\uff0cInitiator\u5f3a\u5236\u603b\u7ebf\u8fdb\u5165\u4e86\u4e00\u4e2a\u7b49\u5f85\u72b6\u6001\u3002\u5728\u7b49\u5f85\u72b6\u6001\u4e2d\uff0c\u8bbe\u5907\u53ef\u4ee5\u4f7f\u5f53\u524d\u4e8b\u52a1\u6682\u505c\uff0c\u5e76\u5feb\u901f\u5730\u5c06\u8981\u53d1\u9001\u7684\u6570\u636e\u586b\u5145\u8fdbbuffer\u6216\u662f\u5c06\u63a5\u6536\u5230\u7684\u7f13\u5b58\u5728buffer\u5185\u7684\u6570\u636e\u642c\u51fa\uff0c\u80fd\u8fdb\u884c\u8fd9\u6837\u7684\u64cd\u4f5c\u662f\u56e0\u4e3aInitiator\u548cTarget\u5141\u8bb8\u4e8b\u52a1\u5728\u6682\u505c\u540e\u76f4\u63a5\u6062\u590d\uff0c\u800c\u4e0d\u9700\u8981\u8fdb\u884c\u4e2d\u6b62\u548c\u91cd\u542f\u4e8b\u52a1\u7684\u64cd\u4f5c\u3002\u4f46\u662f\u4ece\u53e6\u4e00\u65b9\u9762\u6765\u8bf4\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u5c06\u4f1a\u5341\u5206\u4f4e\u6548\uff0c\u56e0\u4e3a\u5b83\u4e0d\u4ec5\u4f7f\u5f53\u524d\u4e8b\u52a1\u505c\u987f\uff0c\u540c\u65f6\u4e5f\u7981\u6b62\u5176\u4ed6\u8bbe\u5907\u8bbf\u95ee\u548c\u4f7f\u7528\u603b\u7ebf\uff0c\u5c3d\u7ba1\u6b64\u65f6\u603b\u7ebf\u4e0a\u6ca1\u6709\u6570\u636e\u5728\u4f20\u8f93\u3002</p> <p>\\8.    \u5728\u65f6\u949f\u6cbf8\uff0c\u7b2c\u4e09\u7ec4\u6570\u636e\u88ab\u4f20\u8f93\uff0c\u5e76\u4e14\u6b64\u65f6FRAME#\u4fe1\u53f7\u88ab\u7f6e\u4e3a\u65e0\u6548\uff0c\u56e0\u6b64Target\u5f97\u77e5\u8fd9\u5c31\u662f\u6700\u540e\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u3002\u56e0\u6b64\uff0c\u5728\u8fd9\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u540e\uff0c\u6240\u6709\u7684\u63a7\u5236\u4fe1\u53f7\u7ebf\u90fd\u5173\u95ed\uff0c\u603b\u7ebf\u518d\u6b21\u8fdb\u5165\u4e86\u7a7a\u95f2\u72b6\u6001\u3002</p> <p>\u5728PCI\u603b\u7ebf\u4e0a\uff0c\u8bb8\u591a\u4fe1\u53f7\u90fd\u5177\u6709\u591a\u79cd\u542b\u4e49\uff0c\u8fd9\u662f\u4e3a\u4e86\u51cf\u5c11\u5f15\u811a\u6570\u91cf\uff0c\u4ee5\u6b64\u6765\u4fdd\u6301PCI\u8bbe\u8ba1\u4e2d\u7684\u4f4e\u6210\u672c\u8fd9\u4e00\u8bbe\u8ba1\u76ee\u6807\u3002\u6570\u636e\u548c\u5730\u5740\u4fe1\u53f7\u4e00\u8d77\u590d\u752832bit\u603b\u7ebf\uff0cC/BE#\uff08Command/Byte Enable\uff09\u4fe1\u53f7\u4e5f\u5171\u4eab\u4ed6\u4eec\u76844\u4e2a\u4fe1\u53f7\u5f15\u811a\u3002\u5c3d\u7ba1\u51cf\u5c11\u5f15\u811a\u6570\u91cf\u662f\u4e00\u79cd\u53ef\u884c\u7684\u65b9\u6cd5\uff0c\u5e76\u4e14\u5b83\u4e5f\u662fPCI\u4f7f\u7528\u201c\u8f6c\u5411\u5468\u671f\u201d\u8fd9\u79cd\u4f1a\u589e\u52a0\u5ef6\u65f6\u7684\u65b9\u6cd5\u7684\u539f\u56e0\u3002\u4f46\u662f\u8fd9\u79cd\u590d\u7528\u5f15\u811a\u7684\u505a\u6cd5\u963b\u6b62\u4e86\u5bf9\u4e8b\u52a1\u7684\u6d41\u6c34\u7ebf\u64cd\u4f5c\uff08\u5728\u53d1\u9001\u4e0a\u4e00\u4e2a\u5468\u671f\u7684\u6570\u636e\u7684\u540c\u65f6\u53d1\u9001\u4e0b\u4e00\u4e2a\u5468\u671f\u7684\u5730\u5740\uff09\u3002\u63e1\u624b\u4fe1\u53f7\u8bf8\u5982FRAME#\u3001DEVSEL#\u3001TRDY#\u3001IRDY#\u4ee5\u53caSTOP#\u88ab\u7528\u6765\u63a7\u5236\u5728\u4e8b\u52a1\uff08transaction\uff09\u8fdb\u884c\u671f\u95f4\u5404\u4e8b\u4ef6\uff08event\uff09\u4f55\u65f6\u8fdb\u884c\u3002</p> <p></p> <p>\u56fe 1\u20113\u7b80\u5355\u7684PCI\u603b\u7ebf\u4f20\u8f93</p>"},{"location":"pcie/all/#134-reflected-wave-signaling","title":"1.3.4     \u53cd\u5c04\u6ce2\u4fe1\u53f7\u4f20\u8f93(Reflected-Wave Signaling)","text":"<p>PCI\u4f53\u7cfb\u7ed3\u6784\u652f\u6301\u6bcf\u8def\u603b\u7ebf\u4e0a\u6700\u591a\u6302\u8f7d32\u4e2a\u8bbe\u5907\uff0c\u4f46\u662f\u7531\u4e8e\u5b9e\u9645\u7684\u7535\u6c14\u4e0a\u9650\u8981\u5c0f\u5f97\u591a\uff0c\u572833MHz\u7684\u57fa\u9891\u4e0b\u5927\u7ea6\u53ef\u4ee5\u670910\u523012\u4e2a\u7535\u6c14\u8d1f\u8f7d\u3002\u51fa\u73b0\u8fd9\u79cd\u73b0\u8c61\u662f\u7531\u4e8e\u603b\u7ebf\u4f7f\u7528\u4e86\u4e00\u79cd\u6280\u672f\u79f0\u4e3a\u201c\u53cd\u5c04\u6ce2\u4fe1\u53f7\u4f20\u8f93\u201d\uff0c\u8be5\u6280\u672f\u53ef\u4ee5\u964d\u4f4e\u603b\u7ebf\u4e0a\u7684\u529f\u7387\u635f\u8017\uff08\u5982\u56fe 1\u20114\uff09\u3002\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0c\u8bbe\u5907\u901a\u8fc7\u5b9e\u73b0\u5f31\u4f20\u8f93\u7f13\u51b2buffer\uff08weak transmit buffer\uff09\u6765\u8fbe\u5230\u8282\u7701\u6210\u672c\u4e0e\u529f\u8017\u7684\u76ee\u7684\uff0c\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u4ec5\u9700\u4e00\u534a\u7684\u9a71\u52a8\u7535\u538b\u5373\u53ef\u5b8c\u6210\u4fe1\u53f7\u7535\u5e73\u7684\u7ffb\u8f6c\u3002\u4fe1\u53f7\u7684\u5165\u5c04\u6ce2\u6cbf\u7740\u4f20\u8f93\u7ebf\u4f20\u8f93\u4e0b\u53bb\uff0c\u76f4\u5230\u5230\u8fbe\u4f20\u8f93\u7ebf\u7684\u672b\u7aef\u3002\u6309\u7167\u8bbe\u8ba1\uff0c\u867d\u7136\u5230\u4e86\u4f20\u8f93\u7ebf\u7684\u672b\u7aef\uff0c\u4f46\u662f\u4fe1\u53f7\u4f20\u8f93\u5e76\u6ca1\u6709\u5c31\u6b64\u4e2d\u6b62\uff0c\u6ce2\u9635\u9762\uff08wavefront\uff09\u5728\u906d\u9047\u4f20\u8f93\u7ebf\u672b\u7aef\u7684\u65e0\u7a77\u5927\u963b\u6297\u540e\u4f1a\u88ab\u53cd\u5c04\u56de\u6765\u3002\u8fd9\u79cd\u53cd\u5c04\u672c\u8d28\u4e0a\u662f\u53e0\u52a0\u6027\u7684\uff0c\u5f53\u4fe1\u53f7\u8fd4\u56de\u53d1\u5c04\u65b9\u65f6\uff0c\u5b83\u4f1a\u4e0e\u5165\u5c04\u4fe1\u53f7\u53e0\u52a0\u4f7f\u4fe1\u53f7\u589e\u52a0\u5230\u5168\u7535\u538b\u7535\u5e73\u3002\u5f53\u8fd9\u6837\u7684\u53cd\u5c04\u4fe1\u53f7\u5230\u8fbe\u521d\u59cb\u7684buffer\u65f6\uff0cbuffer\u9a71\u52a8\u5668\u7684\u4f4e\u8f93\u51fa\u963b\u6297\u4f1a\u4e2d\u6b62\u8fd9\u4e2a\u4fe1\u53f7\u7684\u4f20\u8f93\u4ee5\u53ca\u505c\u6b62\u5176\u7ee7\u7eed\u53cd\u5c04\u3002\u56e0\u6b64\uff0c\u4ecebuffer\u53d1\u51fa\u4e00\u4e2a\u4fe1\u53f7\u4e00\u76f4\u5230\u63a5\u6536\u65b9\u68c0\u6d4b\u5230\u6709\u6548\u7684\u4fe1\u53f7\u6240\u82b1\u8d39\u7684\u65f6\u95f4\uff0c\u5c31\u7b49\u4e8e\u4fe1\u53f7\u6cbf\u7ebf\u8def\u4f20\u8f93\u7684\u65f6\u95f4\u52a0\u4e0a\u53cd\u5c04\u56de\u6765\u7684\u5ef6\u8fdf\u65f6\u95f4\u548c\u5efa\u7acb\u65f6\u95f4\u3002\u6240\u6709\u8fd9\u4e9b\u90fd\u5fc5\u987b\u5c0f\u4e8e\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u3002</p> <p></p> <p>\u56fe 1\u20114 PCI\u7684\u53cd\u5c04\u6ce2\u4fe1\u53f7\u4f20\u8f93</p> <p>\u5f53\u8d70\u7ebf\u957f\u5ea6\u548c\u603b\u7ebf\u4e0a\u7684\u7535\u6c14\u8d1f\u8f7d\u6570\u91cf\u589e\u52a0\u65f6\uff0c\u4fe1\u53f7\u5f80\u8fd4\u6240\u9700\u8981\u7684\u65f6\u95f4\u4e5f\u589e\u52a0\u3002\u4e00\u4e2a33MHz\u7684PCI\u603b\u7ebf\u53ea\u80fd\u6ee1\u8db3\u6700\u591a10-12\u4e2a\u7535\u6c14\u8d1f\u8f7d\u7684\u4fe1\u53f7\u65f6\u5e8f\u8981\u6c42\u3002\u4e00\u4e2a\u7535\u6c14\u8d1f\u8f7d\u6307\u7684\u662f\u7cfb\u7edf\u677f\u4e0a\u5b89\u88c5\u7684\u4e00\u4e2a\u8bbe\u5907\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u4e00\u4e2a\u63d2\u4e86\u677f\u5361\u7684\u8fde\u63a5\u5668\u63d2\u69fd\u88ab\u7b97\u4f5c\u4e24\u4e2a\u7535\u6c14\u8d1f\u8f7d\u3002\u56e0\u6b64\uff0c\u5982\u8868 1\u20111\u6240\u793a\u7684\u90a3\u6837\uff0c\u4e00\u4e2a33MHz\u7684PCI\u603b\u7ebf\u6700\u591a\u53ea\u80fd\u67094\u6216\u80055\u4e2a\u63d2\u5165\u677f\u5361\u7684\u8fde\u63a5\u5668\uff0c\u5426\u5219\u5c06\u65e0\u6cd5\u4fdd\u8bc1\u53ef\u9760\u6027\u3002</p> <p>\u4e3a\u4e86\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u63a5\u5165\u66f4\u591a\u7684\u8d1f\u8f7d\uff0c\u9700\u8981\u4f7f\u7528PCI-to-PCI bridge\uff0c\u5982\u56fe 1\u20115\u6240\u793a\u3002\u5f53\u51fa\u73b0\u4e86\u8d8a\u6765\u8d8a\u591a\u66f4\u4e3a\u5148\u8fdb\u7684\u4e3b\u82af\u7247\u7ec4\u540e\uff0c\u5916\u8bbe\u7684\u53d1\u5c55\u4e5f\u5341\u5206\u8fc5\u901f\uff0c\u4ee5\u81f3\u4e8e\u7ade\u4e89\u8bbf\u95ee\u5171\u4eabPCI\u603b\u7ebf\u53d8\u6210\u4e86\u9650\u5236\u5916\u8bbe\u6027\u80fd\u7684\u539f\u56e0\u3002PCI\u603b\u7ebf\u7684\u901f\u7387\u6ca1\u6709\u8ddf\u4e0a\u5916\u8bbe\u901f\u7387\u589e\u957f\u7684\u811a\u6b65\uff0c\u867d\u7136\u5b83\u4f9d\u65e7\u662f\u4e3b\u6d41\u7684\u5916\u8bbe\u603b\u7ebf\uff0c\u4f46\u662f\u5df2\u7ecf\u6210\u4e3a\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u74f6\u9888\u3002\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u51b3\u529e\u6cd5\u4e3a\uff0c\u628aPCI\u79fb\u5230\u7cfb\u7edf\u5916\u8bbe\u4e0e\u5b58\u50a8\u5668\u4e4b\u95f4\u7684\u4e3b\u8def\u5f84\u4e4b\u5916\uff0c\u5c06\u82af\u7247\u7ec4\u4e92\u8fde\u7528\u4e00\u4e9b\u4e13\u6709\u7684\u89e3\u51b3\u65b9\u6848\u6765\u66ff\u4ee3\uff08\u4f8b\u5982Intel\u7684Hub Link Interface\uff09\u3002</p> <p>PCI Bridge\u662f\u62d3\u6251\u7ed3\u6784\u7684\u5ef6\u4f38\u3002\u6bcf\u4e2aBridge\u90fd\u80fd\u4ea7\u751f\u65b0\u7684PCI\u603b\u7ebf\uff0c\u800c\u4e14\u8fd9\u79cd\u7531PCI Bridge\u4ea7\u751f\u7684PCI\u603b\u7ebf\u4e0e\u4e0a\u5c42PCI\u603b\u7ebf\u5728\u7535\u6c14\u4e0a\u662f\u76f8\u9694\u7edd\u7684\uff0c\u56e0\u6b64\u5b83\u4e5f\u53ef\u4ee5\u72ec\u7acb\u7684\u63d0\u4f9b\u989d\u5916\u768410-12\u4e2a\u7535\u6c14\u8d1f\u8f7d\u3002PCI\u603b\u7ebf\u4e0a\u7684\u4e00\u4e9b\u8bbe\u5907\u4e5f\u53ef\u4ee5\u4f5c\u4e3aBridge\uff0c\u53ef\u4ee5\u4ee4\u8f83\u591a\u7684\u8bbe\u5907\u63a5\u5165\u7cfb\u7edf\u4e2d\u3002PCI\u4f53\u7cfb\u7ed3\u6784\u5141\u8bb8\u5728\u5355\u7cfb\u7edf\u4e2d\u5b58\u5728256\u8def\u603b\u7ebf\uff0c\u6bcf\u8def\u603b\u7ebf\u4e0b\u6700\u591a\u53ef\u4ee5\u6302\u8f7d32\u4e2a\u8bbe\u5907\u3002</p> <p></p> <p>\u56fe 1\u20115 \u5305\u542bPCI-to-PCI bridge\u768433MHz PCI\u7cfb\u7edf</p>"},{"location":"pcie/all/#14-pcipci-bus-architecture-perspective","title":"1.4 PCI\u603b\u7ebf\u4f53\u7cfb\u7ed3\u6784\u900f\u89c6\u63a2\u7a76(PCI Bus Architecture Perspective)","text":""},{"location":"pcie/all/#141-pci","title":"1.4.1     PCI\u4e8b\u52a1\u6a21\u578b","text":"<p>PCI\u540c\u5148\u524d\u7684\u603b\u7ebf\u6a21\u578b\u4e00\u6837\uff0c\u5728\u6570\u636e\u4f20\u8f93\u4e0a\u4f7f\u7528\u4e09\u79cd\u6a21\u578b\uff1aProgrammed I/O\uff08PIO\uff09\u3001Peer-to-peer\u3001\u4ee5\u53caDMA\u3002\u8fd9\u4e9b\u6a21\u578b\u7684\u56fe\u89e3\u5982\u56fe 1\u20116\u6240\u793a\uff0c\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u5c06\u5bf9\u5b83\u4eec\u8fdb\u884c\u63cf\u8ff0\u3002</p>"},{"location":"pcie/all/#1411-programmed-iopio","title":"1.4.1.1   Programmed I/O(PIO)","text":"<p>PIO\u5728\u65e9\u671fPC\u4e2d\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u56e0\u4e3a\u8bbe\u8ba1\u8005\u4e0d\u613f\u610f\u589e\u52a0\u8bbe\u5907\u4e2d\u7531\u4e8e\u4e8b\u52a1\u7ba1\u7406\u903b\u8f91\u800c\u5e26\u6765\u7684\u6210\u672c\u5f00\u9500\u4ee5\u53ca\u989d\u5916\u589e\u52a0\u7684\u590d\u6742\u5ea6\u3002\u5728\u5f53\u65f6\uff0c\u5904\u7406\u5668\u6bd4\u4efb\u4f55\u5176\u4ed6\u8bbe\u5907\u5de5\u4f5c\u7684\u90fd\u8981\u5feb\uff0c\u6240\u4ee5\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0c\u5904\u7406\u5668\u5305\u63fd\u4e86\u6240\u6709\u7684\u5de5\u4f5c\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5f53\u4e00\u4e2aPCI\u8bbe\u5907\u5411CPU\u53d1\u51fa\u4e2d\u65ad\uff0c\u5e76\u8868\u793a\u5b83\u9700\u8981\u5411memory\u4e2d\u653e\u5165\u6570\u636e\uff0c\u5219\u7531CPU\u6700\u7ec8\u5c06\u6570\u636e\u4ecePCI\u8bbe\u5907\u4e2d\u8bfb\u51fa\u5e76\u653e\u5165\u4e00\u4e2a\u5185\u90e8\u5bc4\u5b58\u5668\u4e2d\uff0c\u7136\u540e\u518d\u5c06\u8fd9\u4e2a\u5185\u90e8\u5bc4\u5b58\u5668\u7684\u503c\u590d\u5236\u8fdbmemory\u4e2d\u3002\u53cd\u4e4b\uff0c\u5982\u679c\u6570\u636e\u8981\u4ecememory\u79fb\u52a8\u5230PCI\u8bbe\u5907\u4e2d\uff0c\u90a3\u4e48\u8f6f\u4ef6\u4f1a\u6307\u793aCPU\u5c06memory\u4e2d\u7684\u6570\u636e\u8bfb\u51fa\u81f3\u5185\u90e8\u5bc4\u5b58\u5668\u4e2d\uff0c\u7136\u540e\u518d\u5c06\u5185\u90e8\u5bc4\u5b58\u5668\u7684\u503c\u5199\u5165\u5230PCI\u8bbe\u5907\u4e2d\u53bb\u3002</p> <p>\u8fd9\u6837\u7684\u64cd\u4f5c\u6d41\u7a0b\u867d\u7136\u53ef\u884c\uff0c\u4f46\u662f\u6548\u7387\u5374\u6bd4\u8f83\u4f4e\uff0c\u5176\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\u3002\u7b2c\u4e00\u4e2a\u539f\u56e0\uff0c\u6bcf\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u90fd\u9700\u8981CPU\u4ea7\u751f\u4e24\u4e2a\u603b\u7ebf\u5468\u671f\u3002\u7b2c\u4e8c\u4e2a\u539f\u56e0\uff0c\u5728\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\u4e2dCPU\u90fd\u8981\u5fd9\u4e8e\u6570\u636e\u4f20\u8f93\u800c\u4e0d\u80fd\u505a\u5176\u4ed6\u66f4\u6709\u610f\u4e49\u7684\u4efb\u52a1\u3002\u5728\u65e9\u671f\uff0c\u8fd9\u662f\u4e00\u79cd\u6700\u5feb\u901f\u7684\u4f20\u8f93\u65b9\u5f0f\uff0c\u800c\u4e14\u5355\u4efb\u52a1\u5904\u7406\u5668\u4e5f\u6ca1\u6709\u5176\u4ed6\u7684\u4efb\u52a1\u8981\u505a\u3002\u7136\u800c\u8fd9\u79cd\u4f4e\u6548\u7684\u65b9\u5f0f\u663e\u7136\u4e0d\u9002\u7528\u4e8e\u66f4\u4e3a\u5148\u8fdb\u7684\u7cfb\u7edf\u4e2d\uff0c\u56e0\u6b64\u8fd9\u79cd\u65b9\u5f0f\u5df2\u4e0d\u518d\u662f\u6570\u636e\u4f20\u8f93\u7684\u5e38\u7528\u65b9\u5f0f\uff0c\u53d6\u800c\u4ee3\u4e4b\u9996\u9009\u65b9\u6cd5\u7684\u662f\u4e0b\u4e00\u8282\u5c06\u8bb2\u8ff0\u7684DMA\u65b9\u6cd5\u3002\u7136\u800c\u4e3a\u4e86\u4f7f\u8f6f\u4ef6\u4e0e\u8bbe\u5907\u4ea4\u4e92\uff0cProgrammed IO\u4ecd\u7136\u662f\u4e00\u79cd\u5fc5\u8981\u7684\u4e8b\u52a1\u6a21\u578b\u3002</p> <p></p> <p>\u56fe 1\u20116 PCI\u4e8b\u52a1\u6a21\u578b</p>"},{"location":"pcie/all/#1412-direct-memory-accessdma","title":"1.4.1.2   Direct Memory Access(DMA)","text":"<p>\u5728\u4f20\u8f93\u6570\u636e\u7684\u65b9\u6cd5\u4e0a\uff0c\u4e00\u79cd\u66f4\u4e3a\u9ad8\u6548\u7684\u65b9\u5f0f\u6210\u4e3aDMA\uff08Direct Memory Access\uff0c\u76f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff09\u3002\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\u6709\u53e6\u4e00\u79cd\u8bbe\u5907\u79f0\u4e3aDMA Engine\uff08DMA\u5f15\u64ce\uff09\uff0c\u7531\u5b83\u6765\u4ee3\u8868\u5904\u7406\u5668\u6765\u8d1f\u8d23\u4e0e\u638c\u63e1\u4ecememory\u5411\u5916\u8bbe\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u7684\u5404\u79cd\u7ec6\u8282\u64cd\u4f5c\uff0c\u8fd9\u5c31\u5c06\u8fd9\u4e2a\u7e41\u7410\u7684\u4efb\u52a1\u4eceCPU\u5378\u8f7d\u4e86\u4e0b\u6765\u3002\u4e00\u65e6CPU\u5c06\u8d77\u59cb\u5730\u5740\uff08starting address\uff09\u548c\u6570\u636e\u5b57\u8282\u603b\u91cf\uff08byte count\uff09\u5199\u5165DMA Engine\uff0cDMA Engine\u5c06\u81ea\u5df1\u5904\u7406\u603b\u7ebf\u534f\u8bae\u4e0e\u5730\u5740\u6392\u5e8f\u3002\u8fd9\u6837\u7684\u505a\u6cd5\u5bf9PCI\u5916\u8bbe\u6765\u8bf4\u5e76\u4e0d\u5f15\u5165\u65b0\u7684\u53d8\u5316\uff0c\u53ef\u4ee5\u8ba9\u5916\u8bbe\u4eec\u4fdd\u6301\u5b83\u4eec\u7684\u4f4e\u6210\u672c\u8bbe\u8ba1\u76ee\u6807\u3002\u540e\u6765\uff0c\u7ecf\u8fc7\u96c6\u6210\u6027\u6539\u8fdb\uff0c\u5916\u8bbe\u81ea\u8eab\u53ef\u4ee5\u96c6\u6210\u5165\u8fd9\u79cdDMA\u529f\u80fd\uff0c\u8fd9\u6837\u5b83\u4eec\u5c31\u4e0d\u518d\u9700\u8981\u4e00\u4e2a\u5916\u90e8\u7684DMA Engine\u3002\u8fd9\u4e9b\u8bbe\u5907\u6709\u80fd\u529b\u5904\u7406\u81ea\u5df1\u53d1\u8d77\u7684\u603b\u7ebf\u4f20\u8f93\uff0c\u6211\u4eec\u5c06\u5b83\u4eec\u79f0\u4e3a\u603b\u7ebf\u4e3b\u8bbe\u5907\uff08Bus Master device\uff09\u3002</p> <p>\u56fe 1\u20113\u5c31\u662f\u4e00\u4e2aPCI\u603b\u7ebf\u4e0a\u7684\u603b\u7ebf\u4e3b\u8bbe\u5907\u6b63\u5728\u8fdb\u884c\u4e8b\u52a1\u7684\u8fc7\u7a0b\u3002\u5317\u6865\u53ef\u4ee5\u5bf9\u5730\u5740\u8fdb\u884c\u8bd1\u7801\uff0c\u4ee5\u6b64\u6765\u8bc6\u522b\u81ea\u5df1\u662f\u5426\u662f\u8fd9\u4e2a\u4e8b\u52a1\u7684Target\uff0c\u6bd4\u5982\u5317\u6865\u8bd1\u7801\u540e\u53d1\u73b0\u5730\u5740\u4e0e\u81ea\u5df1\u76f8\u5339\u914d\u5219\u8ba4\u4e3a\u81ea\u5df1\u662f\u8fd9\u4e2a\u4e8b\u52a1\u7684Target\u3002\u5728\u603b\u7ebf\u5468\u671f\u4e2d\u7684\u6570\u636e\u4f20\u8f93\u9636\u6bb5\uff0c\u6570\u636e\u5728\u603b\u7ebf\u4e3b\u8bbe\u5907\u4e0e\u5317\u6865\u4e4b\u95f4\u4f20\u8f93\uff0c\u5317\u6865\u5373\u662f\u6570\u636e\u4f20\u8f93\u7684Target\u3002\u5317\u6865\u5c06\u5bf9\u6570\u636e\u4f9d\u6b21\u4ea7\u751fDRAM\u603b\u7ebf\u5468\u671f\u4ee5\u8fdb\u884c\u4e0e\u7cfb\u7edfmemory\u7684\u901a\u4fe1\uff0c\u800cPCI\u5916\u8bbe\u4e5f\u53ef\u4ee5\u4ea7\u751f\u4e00\u4e2a\u4e2d\u65ad\u6765\u901a\u77e5\u7cfb\u7edf\u3002DMA\u8fd9\u79cd\u6570\u636e\u4f20\u8f93\u65b9\u6cd5\u5c06\u6548\u7387\u63d0\u5347\u4e86\u5f88\u591a\uff0c\u56e0\u4e3a\u8fd9\u79cd\u65b9\u5f0f\u5728\u642c\u79fb\u6570\u636e\u65f6\u4e0d\u9700\u8981CPU\u7684\u53c2\u4e0e\uff0c\u90a3\u4e48\u5bf9\u4e8eCPU\u6765\u8bf4\u53ea\u9700\u8981\u4e00\u4e2a\u603b\u7ebf\u5468\u671f\u5373\u53ef\u5b8c\u6210\u9ad8\u6548\u7684\u6570\u636e\u5757\u642c\u79fb\uff08move a block of data\uff09\uff0c\u5373\u53ea\u9700\u628a\u8d77\u59cb\u5730\u5740\u548c\u603b\u6570\u636e\u91cf\u5199\u5165DMA Engine\u5373\u53ef\u3002</p>"},{"location":"pcie/all/#1413-peer-to-peer","title":"1.4.1.3   Peer-to-Peer(\u70b9\u5bf9\u70b9)","text":"<p>\u5982\u679c\u4e00\u4e2a\u8bbe\u5907\u80fd\u591f\u4f5c\u4e3a\u603b\u7ebf\u4e3b\u8bbe\u5907\uff0c\u90a3\u4e48\u5b83\u5c31\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6709\u8da3\u7684\u4f5c\u7528\u3002\u4e00\u4e2aPCI\u603b\u7ebfMaster\u53ef\u4ee5\u53d1\u8d77\u9488\u5bf9\u5176\u4ed6PCI\u8bbe\u5907\u7684\u6570\u636e\u4f20\u8f93\uff0c\u800c\u5bf9\u4e8ePCI\u603b\u7ebf\u81ea\u8eab\u6765\u8bf4\u8fd9\u6574\u4e2a\u4e8b\u52a1\u90fd\u662f\u5728\u672c\u5730\u8fdb\u884c\u7684\uff0c\u5e76\u672a\u56e0\u4e3a\u5982\u4efb\u4f55\u5176\u4ed6\u7cfb\u7edf\u7684\u8d44\u6e90\u3002\u56e0\u4e3a\u8fd9\u4e2a\u4e8b\u52a1\u662f\u5728\u603b\u7ebf\u4e0a\u7684\u4e24\u4e2a\u8bbe\u5907\u4e4b\u95f4\u8fdb\u884c\u7684\uff0c\u4e14\u8fd9\u4e24\u4e2a\u8bbe\u5907\u88ab\u8ba4\u4e3a\u662f\u603b\u7ebf\u4e2d\u4e24\u4e2a\u5bf9\u7b49\u7684\u8282\u70b9\uff0c\u56e0\u6b64\u8fd9\u4e2a\u4e8b\u52a1\u88ab\u79f0\u4f5c\u4e00\u4e2a\u201c\u70b9\u5bf9\u70b9\u201d\u7684\u4e8b\u52a1\u3002\u8fd9\u79cd\u4e8b\u52a1\u5177\u6709\u660e\u663e\u7684\u9ad8\u6548\u6027\uff0c\u56e0\u4e3a\u7cfb\u7edf\u4e2d\u5176\u4f59\u7684\u90e8\u5206\u4ecd\u7136\u53ef\u4ee5\u81ea\u7531\u7684\u5b8c\u6210\u5176\u4ed6\u7684\u4efb\u52a1\u3002\u7136\u800c\uff0c\u5728\u5b9e\u9645\u573a\u666f\u4e2d\u70b9\u5bf9\u70b9\u4e8b\u52a1\u5f88\u5c11\u88ab\u4f7f\u7528\uff0c\u8fd9\u662f\u56e0\u4e3aInitiator\u548cTarget\u901a\u5e38\u4e0d\u4f1a\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u683c\u5f0f\uff0c\u9664\u975e\u4e8c\u8005\u90fd\u662f\u7531\u4e00\u4e2a\u4f9b\u5e94\u5546\u5236\u9020\u7684\u3002\u56e0\u6b64\uff0c\u6570\u636e\u4e00\u822c\u5fc5\u987b\u8981\u9996\u5148\u53d1\u9001\u5230memory\uff0c\u8fd9\u6837CPU\u5c31\u53ef\u4ee5\u5728\u6570\u636e\u4f20\u8f93\u5230Target\u4e4b\u524d\u5bf9\u5176\u8fdb\u884c\u683c\u5f0f\u8f6c\u6362\uff0c\u800c\u8fd9\u5c31\u963b\u788d\u5e76\u7834\u574f\u4e86\u70b9\u5bf9\u70b9\u4f20\u8f93\u7684\u8bbe\u8ba1\u76ee\u6807\u3002</p>"},{"location":"pcie/all/#142-pci","title":"1.4.2     PCI\u603b\u7ebf\u4ef2\u88c1","text":"<p>\u601d\u8003\u56fe 1\u20112\uff0c\u56e0\u4e3a\u5f53\u4eca\u7684PCI\u8bbe\u5907\u57fa\u672c\u90fd\u80fd\u4f5c\u4e3a\u603b\u7ebfMaster\uff0c\u5b83\u4eec\u90fd\u53ef\u4ee5\u8fdb\u884cDMA\u4e0epeer-to-peer\u7684\u6570\u636e\u4f20\u8f93\u3002\u5728\u50cfPCI\u8fd9\u79cd\u5171\u4eab\u603b\u7ebf\u7684\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u5404\u8bbe\u5907\u9700\u8981\u8f6e\u6d41\u5360\u7528\u603b\u7ebf\uff0c\u56e0\u6b64\u5f53\u4e00\u4e2a\u8bbe\u5907\u60f3\u8981\u53d1\u8d77\u4e8b\u52a1\u65f6\u5fc5\u987b\u9996\u5148\u5411\u603b\u7ebf\u4ef2\u88c1\u5668\u8bf7\u6c42\u603b\u7ebf\u6240\u6709\u6743\uff08ownership\uff09\u3002\u4ef2\u88c1\u5668\u5c06\u67e5\u770b\u5f53\u524d\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u5e76\u4f7f\u7528\u4e00\u4e9b\u7279\u5b9a\u7684\u4ef2\u88c1\u5b9e\u73b0\u7b97\u6cd5\u6765\u51b3\u5b9a\u54ea\u4e2aMaster\u53ef\u4ee5\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u3002PCI\u534f\u8bae\u89c4\u8303\u5e76\u6ca1\u6709\u63cf\u8ff0\u8fd9\u4e2a\u4ef2\u88c1\u7b97\u6cd5\uff0c\u4f46\u662f\u6709\u58f0\u660e\u8fd9\u4e2a\u4ef2\u88c1\u5fc5\u987b\u662f\u201c\u516c\u5e73\u201d\u7684\uff0c\u4e0d\u5f97\u5728\u8bbf\u95ee\u4e2d\u5dee\u522b\u5bf9\u5f85\u4efb\u4f55\u4e00\u4e2a\u8bbe\u5907\u3002</p> <p>\u4ef2\u88c1\u5668\u53ef\u4ee5\u5728\u4e0a\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u7684Master\u8fd8\u6b63\u5728\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u65f6\u5c31\u51b3\u5b9a\u51fa\u4e0b\u4e00\u4e2a\u5360\u7528\u603b\u7ebf\u7684\u8bbe\u5907\uff0c\u8fd9\u6837\u603b\u7ebf\u4e0a\u5c31\u4e0d\u9700\u8981\u5f15\u5165\u989d\u5916\u7684\u65f6\u5ef6\u6765\u5bf9\u4e0b\u4e00\u4e2a\u603b\u7ebf\u6240\u6709\u8005\u8fdb\u884c\u6392\u5e8f\u3002\u56e0\u6b64\uff0c\u603b\u7ebf\u4ef2\u88c1\u5668\u7684\u4ef2\u88c1\u4f5c\u7528\u53d1\u6325\u5728\u201c\u5e55\u540e\u201d\uff0c\u88ab\u79f0\u4e3a\u201c\u9690\u85cf\u201d\u7684\u603b\u7ebf\u4ef2\u88c1\uff0c\u8fd9\u662f\u4e00\u79cd\u5bf9\u65e9\u671f\u603b\u7ebf\u534f\u8bae\u7684\u6539\u8fdb\u3002</p>"},{"location":"pcie/all/#143-pcipci-inefficiencies","title":"1.4.3     PCI\u4f4e\u6548\u7684\u5730\u65b9(PCI Inefficiencies)","text":""},{"location":"pcie/all/#1431-pcipci-retry-protocol","title":"1.4.3.1   PCI\u91cd\u8bd5\u534f\u8bae(PCI Retry Protocol)","text":"<p>\u5f53\u4e00\u4e2aPCI Master\u53d1\u8d77\u4e00\u4e2a\u4e8b\u52a1\uff0c\u7528\u4e8e\u8bbf\u95ee\u4e00\u4e2aTarget\u8bbe\u5907\uff0c\u800c\u6b64\u65f6Target\u8bbe\u5907\u5e76\u672a\u5904\u4e8eReady\u72b6\u6001\uff0c\u90a3\u4e48Target\u5c31\u4f1a\u7ed9\u51fa\u4e00\u4e2a\u4e8b\u52a1\u91cd\u8bd5\u7684\u4fe1\u53f7\uff0c\u8fd9\u79cd\u573a\u666f\u7684\u793a\u610f\u56fe\u5982\u56fe 1\u20117\u3002</p> <p></p> <p>\u56fe 1\u20117 PCI\u4e8b\u52a1\u91cd\u8bd5\u673a\u5236</p> <p>\u8003\u8651\u63a5\u4e0b\u6765\u7ed9\u51fa\u7684\u4f8b\u5b50\uff1a\u5317\u6865\u53d1\u8d77\u4e00\u4e2a\u8bfbmemory\u4e8b\u52a1\uff0c\u5e0c\u671b\u4ece\u4ee5\u592a\u7f51\u8bbe\u5907\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u8fd9\u4e2a\u4ee5\u592a\u7f51\u8bbe\u5907Target\u54cd\u5e94\u8fd9\u4e2a\u4e8b\u52a1\uff0c\u8bf7\u6c42\u5e76\u53c2\u4e0e\u5230\u603b\u7ebf\u5468\u671f\u4e2d\u6765\u3002\u7136\u800c\uff0c\u8fd9\u4e2a\u4ee5\u592a\u7f51\u8bbe\u5907Target\u6b64\u523b\u5e76\u6ca1\u6709\u7acb\u5373\u5c06\u6570\u636e\u8fd4\u56de\u7ed9\u5317\u6865Master\u3002\u8fd9\u4e2a\u4ee5\u592a\u7f51\u8bbe\u5907\u6b64\u65f6\u6709\u4e24\u4e2a\u529e\u6cd5\u6765\u63a8\u8fdf\u8fd9\u6b21\u6570\u636e\u4f20\u8f93\u3002\u7b2c\u4e00\u4e2a\u529e\u6cd5\u5c31\u662f\u5728\u6570\u636e\u4f20\u8f93\u4e2d\u63d2\u5165\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002\u5982\u679c\u8fc7\u7a0b\u4e2d\u4ec5\u9700\u63d2\u5165\u5c11\u91cf\u7684\u7b49\u5f85\u6001\uff0c\u90a3\u4e48\u6570\u636e\u7684\u4f20\u8f93\u8fd8\u80fd\u7b97\u662f\u6bd4\u8f83\u6709\u6548\u7387\u3002\u4f46\u662f\u5982\u679cTarget\u8bbe\u5907\u9700\u8981\u5ef6\u8fdf\u66f4\u591a\u7684\u65f6\u95f4\uff08\u4ece\u4e8b\u52a1\u88ab\u53d1\u8d77\u540e\u5ef6\u8fdf16\u4e2a\u65f6\u949f\u5468\u671f\u4ee5\u4e0a\uff09\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7528\u7b2c\u4e8c\u79cd\u529e\u6cd5\u4e86\uff0c\u7b2c\u4e8c\u79cd\u529e\u6cd5\u5c31\u662fTarget\u53d1\u51fa\u4e00\u4e2aSTOP#\u4fe1\u53f7\u6765\u8868\u793a\u4e8b\u52a1\u91cd\u8bd5\uff08retry\uff09\u3002Retry\u64cd\u4f5c\u662f\u901a\u77e5Master\u5728\u6570\u636e\u6ca1\u6709\u4f20\u8f93\u524d\u5c31\u63d0\u524d\u7ed3\u675f\u603b\u7ebf\u5468\u671f\u3002\u8fd9\u6837\u505a\u53ef\u4ee5\u9632\u6b62\u603b\u7ebf\u957f\u65f6\u95f4\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u800c\u964d\u4f4e\u4e86\u603b\u7ebf\u6548\u7387\u3002\u5f53Master\u63a5\u6536\u5230Target\u53d1\u6765\u7684Retry\u8bf7\u6c42\uff0cMaster\u81f3\u5c11\u7b49\u5f852\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u7136\u540e\u5fc5\u987b\u91cd\u65b0\u5411\u603b\u7ebf\u53d1\u8d77\u4ef2\u88c1\u8bf7\u6c42\uff0c\u5f53\u518d\u6b21\u83b7\u5f97\u603b\u7ebf\u7684\u4f7f\u7528\u6743\u4e4b\u540e\u91cd\u65b0\u53d1\u8d77\u76f8\u540c\u7684\u603b\u7ebf\u5468\u671f\u3002\u5728\u5f53\u524d\u603b\u7ebfMaster\u6b63\u5728\u5904\u7406Retry\u7684\u8fd9\u6bb5\u65f6\u95f4\u4e2d\uff0c\u4ef2\u88c1\u5668\u53ef\u4ee5\u5c06\u603b\u7ebf\u4f7f\u7528\u6743\u6388\u4e88\u5176\u4ed6\u7684Master\uff0c\u4ee5\u4fbf\u4e8ePCI\u603b\u7ebf\u80fd\u88ab\u66f4\u6709\u6548\u7387\u7684\u5229\u7528\u8d77\u6765\u3002\u5f53\u6b64\u524d\u6267\u884cRetry\u7684Master\u518d\u6b21\u5360\u7528\u603b\u7ebf\u5e76\u91cd\u65b0\u542f\u52a8\u4e0e\u6b64\u524d\u76f8\u540c\u7684\u603b\u7ebf\u5468\u671f\u65f6\uff0cTarget\u53ef\u80fd\u4e5f\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\uff0c\u5e76\u53c2\u4e0e\u5230\u603b\u7ebf\u5468\u671f\u4e2d\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002\u5426\u5219\uff0c\u82e5Target\u4ecd\u7136\u672a\u51c6\u5907\u597d\uff0c\u90a3\u4e48\u5b83\u5c06\u4f1a\u518d\u6b21\u53d1\u8d77Retry\uff0c\u6309\u7167\u8fd9\u6837\u7684\u6d41\u7a0b\u5faa\u73af\u4e0b\u53bb\u76f4\u5230Master\u6210\u529f\u5b8c\u6210\u4e86\u6570\u636e\u4f20\u8f93\u3002</p>"},{"location":"pcie/all/#1432-pcipci-disconnect-protocol","title":"1.4.3.2   PCI\u65ad\u5f00\u8fde\u63a5\u534f\u8bae(PCI Disconnect Protocol)","text":"<p>\u5f53\u4e00\u4e2aPCI Master\u53d1\u8d77\u4e00\u4e2a\u4e8b\u52a1\u6765\u8bbf\u95ee\u4e00\u4e2aTarget\uff0c\u5e76\u4e14\u5982\u679c\u8fd9\u4e2aTarget\u53ef\u4ee5\u4f20\u8f93\u81f3\u5c11\u4e00\u4e2a\u53cc\u5b57\uff08doubleword\uff0c\u540e\u9762\u4f7f\u7528dw\u7b80\u5199\uff09\u7684\u6570\u636e\uff0c\u4f46\u662f\u5b83\u65e0\u6cd5\u5b8c\u6210\u6574\u4e2a\u5b8c\u6574\u7684\u5168\u6570\u636e\u91cf\u7684\u4f20\u8f93\uff0c\u90a3\u4e48\u5b83\u5c06\u4f1a\u5728\u5b83\u65e0\u6cd5\u7ee7\u7eed\u8fdb\u884c\u4f20\u8f93\u65f6\u65ad\u5f00\u4e0e\u4e8b\u52a1\u64cd\u4f5c\u7684\u8fde\u63a5\u3002\u8fd9\u79cd\u573a\u666f\u7684\u793a\u610f\u56fe\u5982\u56fe 1\u20118\u6240\u793a\u3002</p> <p>\u8003\u8651\u63a5\u4e0b\u6765\u7ed9\u51fa\u7684\u4f8b\u5b50\uff1a\u5317\u6865\u53d1\u8d77\u4e00\u4e2a\u7a81\u53d1\u8bfbmemory\u4e8b\u52a1\uff08burst memory read\uff09\uff0c\u5e0c\u671b\u4ece\u4ee5\u592a\u7f51\u8bbe\u5907\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u4ee5\u592a\u7f51\u8bbe\u5907Target\u8bf7\u6c42\u5e76\u53c2\u4e0e\u5230\u8fd9\u4e2a\u603b\u7ebf\u5468\u671f\u4e2d\u6765\uff0c\u4f20\u8f93\u4e86\u4e00\u4e9b\u6570\u636e\uff0c\u4f46\u662f\u968f\u540e\u4e0d\u4e45\u628a\u5df2\u6709\u7684\u6240\u6709\u6570\u636e\u90fd\u53d1\u9001\u5149\u4e86\uff0c\u5374\u4f9d\u7136\u6ca1\u6709\u8fbe\u5230Master\u9700\u8981\u7684\u6570\u636e\u603b\u91cf\u3002\u4ee5\u592a\u7f51\u8bbe\u5907Target\u6b64\u65f6\u6709\u4e24\u4e2a\u9009\u62e9\u6765\u5ef6\u8fdf\u6570\u636e\u7684\u4f20\u8f93\u3002\u7b2c\u4e00\u4e2a\u9009\u62e9\u662f\u5728\u6570\u636e\u4f20\u8f93\u9636\u6bb5\u63d2\u5165\u7b49\u5f85\u6001\uff0c\u7136\u540e\u81ea\u8eab\u4e5f\u540c\u65f6\u5728\u7b49\u5f85\u6536\u5230\u65b0\u589e\u7684\u6570\u636e\u3002\u5982\u679c\u8fc7\u7a0b\u4e2d\u4ec5\u9700\u63d2\u5165\u5c11\u91cf\u7684\u7b49\u5f85\u6001\uff0c\u90a3\u4e48\u6570\u636e\u7684\u4f20\u8f93\u8fd8\u80fd\u7b97\u662f\u6bd4\u8f83\u6709\u6548\u7387\u3002\u4f46\u662f\u5982\u679cTarget\u8bbe\u5907\u9700\u8981\u5ef6\u8fdf\u66f4\u591a\u7684\u65f6\u95f4\uff08PCI\u534f\u8bae\u89c4\u8303\u4e2d\u5141\u8bb8\u5728\u6570\u636e\u4f20\u8f93\u4e2d\u9014\u6700\u591a\u67098\u4e2a\u65f6\u949f\u5468\u671f\u7684\u7b49\u5f85\u6001\uff0c\u8fd9\u91cc\u533a\u522b\u4e8e\u4e0a\u4e00\u8282Retry\u4e2d\u768416\u4e2a\u5468\u671f\uff0c\u90a3\u662f\u56e0\u4e3a\u90a3\u65f6\u4f20\u8f93\u8fd8\u6ca1\u5f00\u59cb\uff0c\u800c\u8fd98\u4e2a\u5468\u671f\u9488\u5bf9\u7684\u662f\u4f20\u8f93\u5df2\u7ecf\u5f00\u59cb\u4e86\u4e00\u6bb5\u65f6\u95f4\u7684\u4f20\u8f93\u4e2d\u9014\u7b49\u5f85\uff09\uff0cTarget\u5fc5\u987b\u53d1\u51fa\u65ad\u5f00\u8fde\u63a5\u7684\u4fe1\u53f7\u3002\u8981\u65ad\u5f00\u8fde\u63a5\uff0cTarget\u9700\u8981\u5728\u603b\u7ebf\u5468\u671f\u8fd0\u884c\u4e2d\u5c06STOP#\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u6837\u5c31\u80fd\u544a\u77e5Master\u63d0\u524d\u7ed3\u675f\u603b\u7ebf\u5468\u671f\u3002Disconnect\u4e0eRetry\u7684\u4e00\u4e2a\u533a\u522b\u5c31\u5728\u4e8e\uff0cDisconnect\u6709\u6570\u636e\u5df2\u7ecf\u88ab\u4f20\u8f93\uff0c\u800cRetry\u5219\u662f\u6570\u636e\u4f20\u8f93\u6839\u672c\u5c31\u6ca1\u5f00\u59cb\u3002Disconnect\u8fd9\u79cd\u64cd\u4f5c\u4e5f\u8ba9\u603b\u7ebf\u907f\u514d\u957f\u65f6\u95f4\u5904\u4e8e\u7b49\u5f85\u6001\u3002Master\u81f3\u5c11\u7b49\u5f852\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u7136\u540e\u624d\u80fd\u518d\u6b21\u5411\u603b\u7ebf\u53d1\u8d77\u4ef2\u88c1\u8bf7\u6c42\uff0c\u5f53\u518d\u6b21\u83b7\u5f97\u603b\u7ebf\u7684\u4f7f\u7528\u6743\u4e4b\u540e\u5c31\u53ef\u4ee5\u518d\u6b21\u8bbf\u95ee\u521a\u624d\u65ad\u5f00\u8fde\u63a5\u7684\u8bbe\u5907\u5730\u5740\uff0c\u7ee7\u7eed\u5b8c\u6210\u6b64\u524d\u65ad\u5f00\u672a\u5b8c\u6210\u7684\u603b\u7ebf\u5468\u671f\u3002\u5728\u5f53\u524d\u603b\u7ebfMaster\u6b63\u5728\u7ecf\u5386Disconnect\u7684\u8fd9\u6bb5\u65f6\u95f4\u4e2d\uff0c\u4ef2\u88c1\u5668\u53ef\u4ee5\u5c06\u603b\u7ebf\u4f7f\u7528\u6743\u6388\u4e88\u5176\u4ed6\u7684Master\uff0c\u4ee5\u4fbf\u4e8ePCI\u603b\u7ebf\u80fd\u88ab\u66f4\u6709\u6548\u7387\u7684\u5229\u7528\u8d77\u6765\u3002\u5f53\u6b64\u524d\u7ecf\u5386Disconnect\u7684Master\u518d\u6b21\u5360\u7528\u603b\u7ebf\u5e76\u51c6\u5907\u7ee7\u7eed\u6b64\u524d\u672a\u5b8c\u6210\u7684\u603b\u7ebf\u5468\u671f\u65f6\uff0cTarget\u53ef\u80fd\u4e5f\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u9700\u8981\u7ee7\u7eed\u4f20\u8f93\u7684\u6570\u636e\uff0c\u5e76\u53c2\u4e0e\u5230\u603b\u7ebf\u5468\u671f\u4e2d\u7ee7\u7eed\u5b8c\u6210\u6570\u636e\u4f20\u8f93\u3002\u5426\u5219\uff0c\u82e5Target\u4ecd\u7136\u672a\u51c6\u5907\u597d\uff0c\u90a3\u4e48\u5b83\u5c06\u4f1a\u518d\u6b21\u53d1\u8d77Retry\u6216\u8005Disconnect\uff0c\u7136\u540e\u6309\u7167\u8fd9\u6837\u7684\u6d41\u7a0b\u5faa\u73af\u4e0b\u53bb\u76f4\u5230Master\u6210\u529f\u5b8c\u6210\u4e86\u6240\u6709\u6570\u636e\u7684\u4f20\u8f93\u3002</p> <p></p> <p>\u56fe 1\u20118 PCI\u4e8b\u52a1\u65ad\u5f00\u8fde\u63a5\u673a\u5236</p>"},{"location":"pcie/all/#144-pcipci-interrupt-handling","title":"1.4.4     PCI\u4e2d\u65ad\u5904\u7406(PCI Interrupt Handling)","text":"<p>PCI\u8bbe\u5907\u4f7f\u75284\u4e2a\u8fb9\u5e26\u4fe1\u53f7\uff08sideband\uff09\u4f5c\u4e3a\u4e2d\u65ad\u4fe1\u53f7\uff0c\u5206\u522b\u4e3aINTA#\u3001INTB#\u3001INTC#\u3001INTD#\uff0c\u5e76\u4ece\u4e2d\u9009\u53d6\u4e00\u4e2a\u6765\u5411\u7cfb\u7edf\u53d1\u9001\u4e2d\u65ad\u8bf7\u6c42\uff0c\u5373\u4f7f\u75284\u4e2a\u4e2d\u65ad\u4fe1\u53f7\u4e2d\u76841\u4e2a\u6765\u53d1\u9001\u4e2d\u65ad\u8bf7\u6c42\u3002\u5f53\u5176\u4e2d\u4e00\u4e2a\u4e2d\u65ad\u5f15\u811a\u88ab\u7f6e\u4e3a\u6709\u6548\u65f6\uff0c\u5355CPU\u7cfb\u7edf\u7684\u4e2d\u65ad\u63a7\u5236\u5668\u5c06\u4f1a\u5bf9\u4e2d\u65ad\u4f5c\u51fa\u54cd\u5e94\uff0c\u76f8\u5e94\u7684\u65b9\u5f0f\u4e3a\u5c06INTR\uff08interrupt request\uff09\u4fe1\u53f7\u7f6e\u4e3a\u6709\u6548\uff0c\u5c06\u4e2d\u65ad\u8bf7\u6c42\u53d1\u9001\u7ed9CPU\u3002\u540e\u6765\u51fa\u73b0\u7684\u591aCPU\u7cfb\u7edf\u4e0d\u518d\u9002\u7528\u8fd9\u79cd\u5355\u4fe1\u53f7\u7ebf\u8f93\u5165\u4f5c\u4e3a\u4e2d\u65ad\u7684\u65b9\u5f0f\uff0c\u56e0\u6b64\u8fdb\u884c\u4e86\u6539\u8fdb\uff0c\u5c06\u4e2d\u65ad\u6539\u4e3a\u4e86APIC\uff08Advanced Programmable Interrupt Controller\uff09\u6a21\u578b\uff0c\u5728\u8fd9\u79cd\u6a21\u578b\u4e2d\u4e2d\u65ad\u63a7\u5236\u5668\u5c06\u4f1a\u5411\u591aCPU\u53d1\u9001\u62a5\u6587\uff08message\uff09\u800c\u4e0d\u662f\u5411\u5176\u4e2d\u4e00\u4e2aCPU\u53d1\u9001INTR\u4fe1\u53f7\u3002\u4e0d\u8fc7\u65e0\u8bba\u4e2d\u65ad\u4f20\u8f93\u6a21\u578b\u662f\u4ec0\u4e48\uff0c\u63a5\u6536\u5230\u4e2d\u65ad\u7684CPU\u90fd\u5fc5\u987b\u786e\u8ba4\u4e2d\u65ad\u6765\u6e90\uff0c\u7136\u540e\u4e3a\u4e2d\u65ad\u63d0\u4f9b\u670d\u52a1\u3002\u4f20\u7edf\u7684\u6a21\u578b\u9700\u8981\u597d\u51e0\u4e2a\u603b\u7ebf\u5468\u671f\u6765\u5b8c\u6210\u786e\u8ba4\u4e2d\u65ad\u548c\u670d\u52a1\u4e2d\u65ad\u7684\u64cd\u4f5c\uff0c\u6548\u7387\u4e0d\u662f\u5f88\u9ad8\u3002APIC\u6a21\u578b\u4f1a\u6bd4\u4f20\u7edf\u6a21\u578b\u597d\u4e00\u4e9b\u4f46\u662f\u4e5f\u4f9d\u7136\u5b58\u5728\u6539\u8fdb\u7684\u7a7a\u95f4\u3002</p>"},{"location":"pcie/all/#145-pcipci-error-handling","title":"1.4.5     PCI\u9519\u8bef\u5904\u7406(PCI Error Handling)","text":"<p>PCI\u8bbe\u5907\u53ef\u4ee5\u5728\u4e8b\u52a1\u8fdb\u884c\u5668\u4ef6\u6709\u9009\u62e9\u7684\u68c0\u6d4b\u5e76\u62a5\u544a\u5730\u5740\u4e0e\u6570\u636e\u7684\u5947\u5076\u6821\u9a8c\u9519\u8bef\u3002\u5728\u4e8b\u52a1\u8fdb\u884c\u671f\u95f4\uff0cPCI\u901a\u8fc7\u4f7f\u7528PAR\u4fe1\u53f7\u6765\u5728\u7edd\u5927\u591a\u6570\u4fe1\u53f7\u4e0a\u4ea7\u751f\u5076\u6821\u9a8c\u4f4d\u3002\u8fd9\u8868\u793a\u5982\u679c\u4f20\u8f93\u7684\u6570\u636e\u6216\u8005\u5730\u5740\u4fe1\u606f\u4e2d\u4e3a\u903b\u8f91\u7535\u5e731\u7684bit\u6570\u91cf\u662f\u5947\u6570\uff0c\u90a3\u4e48\u5c31\u5c06PAR\u4fe1\u53f7\u7f6e\u4e3a1\uff0c\u4ee5\u6b64\u6765\u4f7f\u5f97\u201c1\u201d\u7684\u6570\u91cf\u4e3a\u5076\u6570\u4e2a\u3002Target\u8bbe\u5907\u5728\u63a5\u6536\u5230\u6570\u636e\u6216\u5730\u5740\u65f6\u5c06\u4f1a\u8fdb\u884c\u6821\u9a8c\u68c0\u67e5\u9519\u8bef\u3002\u5947\u5076\u6821\u9a8c\uff08\u5728\u8fd9\u91cc\u4e3a\u5076\u6821\u9a8c\uff09\u7684\u65b9\u6cd5\u4ec5\u5728\u6709\u5947\u6570\u4e2a\u4fe1\u53f7\u51fa\u9519\u65f6\u624d\u80fd\u68c0\u6d4b\u5230\u3002\u5982\u679c\u8bbe\u5907\u68c0\u6d4b\u5230\u6570\u636e\u7684\u5947\u5076\u6821\u9a8c\u9519\u8bef\uff0c\u5b83\u5c06\u628aPERR#\uff08parity error\uff09\u7f6e\u4e3a\u6709\u6548\u3002\u8fd9\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u53ef\u4ee5\u6062\u590d\u7684\u9519\u8bef\uff0c\u56e0\u4e3a\u4f8b\u5982\u5bf9\u4e8ememory\u8bfb\u53d6\u6765\u8bf4\uff0c\u53ea\u9700\u8981\u518d\u6b21\u53d1\u8d77\u76f8\u540c\u7684\u4e8b\u52a1\u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\u7136\u800c\uff0cPCI\u81ea\u8eab\u5e76\u4e0d\u5305\u542b\u4efb\u4f55\u7684\u81ea\u52a8\u7684\u6216\u662f\u57fa\u4e8e\u786c\u4ef6\u7684\u9519\u8bef\u6062\u590d\u673a\u5236\uff0c\u56e0\u6b64\u8f6f\u4ef6\u5c06\u5b8c\u5168\u8d1f\u8d23\u53bb\u5c1d\u8bd5\u89e3\u51b3\u9519\u8bef\u3002</p> <p></p> <p>\u56fe 1\u20119 PCI\u9519\u8bef\u5904\u7406</p> <p>\u7136\u800c\uff0c\u4e0a\u9762\u6240\u8bf4\u7684\u662f\u6570\u636e\u51fa\u9519\u7684\u60c5\u51b5\uff0c\u82e5\u5730\u5740\u6821\u9a8c\u51fa\u9519\u5219\u60c5\u51b5\u4e0d\u540c\u3002\u5728\u56fe 1\u20119\u7684\u4f8b\u5b50\u4e2d\uff0c\u5730\u5740\u4fe1\u606f\u635f\u574f\uff0c\u8fd9\u5bfc\u81f4\u4e00\u4e2aTarget\u5339\u914d\u4e0a\u4e86\u8fd9\u4e2a\u9519\u8bef\u7684\u5730\u5740\u3002\u6211\u4eec\u65e0\u6cd5\u5f97\u77e5\u635f\u574f\u7684\u5730\u5740\u4fe1\u606f\u53d8\u6210\u4e86\u4ec0\u4e48\uff0c\u4e5f\u65e0\u6cd5\u5f97\u77e5\u603b\u7ebf\u4e0a\u54ea\u4e2a\u8bbe\u5907\u5339\u914d\u4e0a\u4e86\u8fd9\u4e2a\u9519\u8bef\u7684\u5730\u5740\uff0c\u6240\u4ee5\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\u5c31\u4e0d\u5b58\u5728\u80fd\u591f\u7b80\u5355\u8fdb\u884c\u9519\u8bef\u6062\u590d\u7684\u65b9\u6cd5\u3002\u56e0\u6b64\uff0c\u8fd9\u79cd\u7c7b\u578b\u7684\u9519\u8bef\u5c06\u4f1a\u5bfc\u81f4SERR#\uff08system error\uff09\u88ab\u7f6e\u4e3a\u6709\u6548\uff0c\u7136\u540e\u901a\u5e38\u4f1a\u4f7f\u5f97\u7cfb\u7edf\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u88ab\u8c03\u7528\u3002\u5728\u8001\u5f0f\u673a\u5668\u4e2d\uff0c\u4e3a\u4e86\u9884\u9632\u5f15\u8d77\u66f4\u8fdb\u4e00\u6b65\u7684\u9519\u8bef\uff0c\u5c06\u4f1a\u5f3a\u884c\u8ba9\u7cfb\u7edf\u505c\u6b62\u5de5\u4f5c\uff0c\u4ece\u800c\u5bfc\u81f4\u51fa\u73b0\u201c\u84dd\u5c4f\u6b7b\u673a\u201d\u3002</p>"},{"location":"pcie/all/#146-pcipci-address-map","title":"1.4.6     PCI\u5730\u5740\u7a7a\u95f4\u6620\u5c04(PCI Address Map)","text":"<p>PCI\u4f53\u7cfb\u7ed3\u6784\u652f\u63013\u79cd\u5730\u5740\u7a7a\u95f4\uff0c\u5982\u56fe 1\u201110\u6240\u793a\uff0c\u5305\u542b\uff1aMemory\uff08\u5185\u5b58\uff09\u3001I/O\u3001Configuration Address Space\uff08\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\uff09\u3002x86\u5904\u7406\u5668\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95eeMemory\u548cI/O\u7a7a\u95f4\u3002\u4e00\u4e2aPCI\u8bbe\u5907\u6620\u5c04\u5230\u5904\u7406\u5668\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u53ef\u4ee5\u652f\u630132\u621664\u4f4d\u5bfb\u5740\u3002\u5728I/O\u5730\u5740\u7a7a\u95f4\uff0cPCI\u8bbe\u5907\u53ef\u4ee5\u652f\u630132\u4f4d\u5bfb\u5740\uff0c\u4f46\u662f\u56e0\u4e3ax86 CPU\u4ec5\u4f7f\u752816\u4f4d\u7684I/O\u5730\u5740\u7a7a\u95f4\uff0c\u8bb8\u591a\u5e73\u53f0\u90fd\u4f1a\u5c06I/O\u7a7a\u95f4\u9650\u5236\u572864KB\uff08\u5bf9\u5e9416bit\uff09\u3002</p> <p></p> <p>\u56fe 1\u201110\u5730\u5740\u7a7a\u95f4\u6620\u5c04</p> <p>PCI\u8fd8\u5f15\u8fdb\u4e86\u7b2c\u4e09\u79cd\u5730\u5740\u7a7a\u95f4\uff0c\u79f0\u4e3a\u914d\u7f6e\u7a7a\u95f4\uff0cCPU\u53ea\u80fd\u5bf9\u5b83\u8fdb\u884c\u95f4\u63a5\u8bbf\u95ee\u800c\u975e\u76f4\u63a5\u8bbf\u95ee\u3002PCI\u8bbe\u5907\u4e2d\u7684\u6bcf\u4e2aFunction\uff08\u529f\u80fd\uff09\u90fd\u5305\u542b\u4e13\u4e3a\u914d\u7f6e\u7a7a\u95f4\u6240\u51c6\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668\uff0c\u8fd9\u4e9b\u5bc4\u5b58\u5668\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u662f\u53ef\u89c1\u7684\uff0c\u5e76\u4e14\u8f6f\u4ef6\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u6807\u51c6\u5316\u7684\u65b9\u5f0f\u6765\u63a7\u5236\u5b83\u4eec\u7684\u5730\u5740\u4e0e\u8d44\u6e90\uff0c\u8fd9\u4e3aPC\u63d0\u4f9b\u4e86\u4e00\u4e2a\u771f\u6b63\u7684\u5373\u63d2\u5373\u7528\uff08plug and play\uff09\u7684\u73af\u5883\u3002\u6bcf\u4e2aPCI Function\u6700\u591a\u53ef\u4ee5\u6709256 Bytes\u7684\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u3002\u8003\u8651\u5230PCI\u6700\u591a\u53ef\u652f\u6301\u5355\u4e2a\u8bbe\u5907\u542b\u67098\u4e2aFunction\u3001\u6bcf\u8def\u603b\u7ebf\u542b\u670932\u4e2a\u8bbe\u5907\u3001\u5355\u4e2a\u7cfb\u7edf\u5305\u542b256\u8def\u603b\u7ebf\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7cfb\u7edf\u7684\u914d\u7f6e\u7a7a\u95f4\u603b\u91cf\u4e3a256B/Function *8Function/device * 32devices/bus *256buses/system =16MB\uff0c\u5373\u4e00\u4e2a\u7cfb\u7edf\u7684\u914d\u7f6e\u7a7a\u95f4\u603b\u5927\u5c0f\u4e3a16MB\u3002</p> <p>\u56e0\u4e3ax86 CPU\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\uff0c\u6240\u4ee5\u5b83\u5fc5\u987b\u901a\u8fc7IO\u5bc4\u5b58\u5668\u8fdb\u884c\u7d22\u5f15\uff08\u7136\u800c\u5728PCI Express\u4e2d\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u65b9\u6cd5\u6765\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\uff0c\u8fd9\u79cd\u65b0\u65b9\u6cd5\u662f\u901a\u8fc7\u5c06\u914d\u7f6e\u7a7a\u95f4\u6620\u5c04\u5165\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u6765\u5b8c\u6210\u7684\uff09\u3002\u5728\u4f20\u7edf\u6a21\u578b\u4e2d\uff0c\u5982\u56fe 1\u201110\u6240\u793a\uff0c\u4f7f\u7528\u4e86\u4e00\u79cd\u88ab\u79f0\u4e3a\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09\u7684IO\u7aef\u53e3\uff0c\u5b83\u4f4d\u4e8e\u5730\u5740CF8h-CFBh\uff1b\u8fd8\u4f7f\u7528\u4e86\u4e00\u79cd\u88ab\u79f0\u4e3a\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08Configuration Data Port\uff09\u7684IO\u7aef\u53e3\uff0c\u5b83\u4f4d\u4e8e\u5730\u5740CFCh-CFFh\u3002\u5173\u4e8e\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u4ee5\u53ca\u901a\u8fc7\u5185\u5b58\u6620\u5c04\u65b9\u6cd5\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u7684\u7ec6\u8282\u5c06\u4f1a\u5728\u4e0b\u4e00\u8282\u8fdb\u884c\u89e3\u91ca\u3002</p>"},{"location":"pcie/all/#147-pcipci-configuration-cycle-generation","title":"1.4.7     PCI\u914d\u7f6e\u5468\u671f\u7684\u751f\u6210(PCI Configuration Cycle Generation)","text":"<p>\u7531\u4e8eIO\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u662f\u6709\u9650\u7684\uff0c\u4f20\u7edf\u6a21\u578b\u7684\u8bbe\u8ba1\u4e0a\u5bf9\u5730\u5740\u5341\u5206\u4fdd\u5b88\u3002\u5728IO\u7a7a\u95f4\u4e2d\u5e38\u89c1\u7684\u505a\u6cd5\u662f\u4ee4\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u6307\u5411\u4e00\u4e2a\u5185\u90e8\u4f4d\u7f6e\uff0c\u7136\u540e\u7528\u53e6\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u8fdb\u884c\u6570\u636e\u7684\u8bfb\u53d6\u6216\u5199\u5165\u3002PCI\u7684\u914d\u7f6e\u8fc7\u7a0b\u5305\u542b\u5982\u4e0b\u4e24\u6b65\u3002</p> <p>l \u7b2c\u4e00\u6b65\uff1aCPU\u4ea7\u751f\u4e00\u4e2aIO\u5199\uff0c\u5199\u5165\u7684\u4f4d\u7f6e\u4e3a\u5317\u6865\u4e2dIO\u5730\u5740\u4e3aCF8h\u7684\u5730\u5740\u7aef\u53e3\uff08Address Port\uff09\uff0c\u8fd9\u6837\u5c31\u7ed9\u51fa\u4e86\u9700\u8981\u88ab\u914d\u7f6e\u7684\u5bc4\u5b58\u5668\u7684\u5730\u5740\uff0c\u5373\u201c\u7528\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u6307\u5411\u4e00\u4e2a\u5185\u90e8\u4f4d\u7f6e\u201d\u3002\u5982\u56fe 1\u201111\u6240\u793a\uff0c\u8fd9\u4e2a\u5730\u5740\u4e3b\u8981\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff0c\u901a\u8fc7\u8fd9\u4e09\u90e8\u5206\u5c31\u53ef\u4ee5\u5b9a\u4f4d\u4e00\u4e2aPCI Function\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u7684\u4f4d\u7f6e\uff0c\u5b83\u4eec\u4e3a\uff1a\u5728256\u6761\u603b\u7ebf\u4e2d\u6211\u4eec\u60f3\u8bbf\u95ee\u54ea\u4e00\u6761\u603b\u7ebf\u3001\u5728\u8be5\u603b\u7ebf\u4e0a\u768432\u4e2a\u8bbe\u5907\u4e2d\u8bbf\u95ee\u54ea\u4e00\u4e2a\u3001\u5728\u8be5\u8bbe\u5907\u76848\u4e2aFunction\u4e2d\u8bbf\u95ee\u54ea\u4e00\u4e2a\u3002\u9664\u4e86\u8fd9\u4e9b\u4ee5\u5916\uff0c\u552f\u4e00\u8fd8\u9700\u8981\u63d0\u4f9b\u7684\u4fe1\u606f\u662f\u8981\u786e\u8ba4\u8bbf\u95ee\u8fd9\u4e2aFunction\u768464dw\uff08256Bytes\uff09\u4e2d\u7684\u54ea\u4e2adw\u3002</p> <p>l \u7b2c\u4e8c\u6b65\uff1aCPU\u4ea7\u751f\u4e00\u4e2aIO\u8bfb\u6216\u8005IO\u5199\uff0c\u64cd\u4f5c\u7684\u4f4d\u7f6e\u4e3a\u5317\u6865\u4e2d\u7684\u5730\u5740\u4e3aCFCh\u7684\u6570\u636e\u7aef\u53e3\uff08Data Port\uff09\uff0c\u5373\u201c\u7528\u53e6\u4e00\u4e2a\u5bc4\u5b58\u5668\u6765\u8fdb\u884c\u6570\u636e\u7684\u8bfb\u53d6\u6216\u5199\u5165\u201d\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u5317\u6865\u5411PCI\u603b\u7ebf\u53d1\u8d77\u4e00\u4e2a\u914d\u7f6e\u8bfb\u4e8b\u52a1\uff08configuration read\uff09\u6216\u914d\u7f6e\u5199\u4e8b\u52a1\uff08configuration write\uff09\uff0c\u4e8b\u52a1\u8981\u64cd\u4f5c\u7684\u5730\u5740\u5373\u4e3a\u6b65\u9aa4\u4e00\u4e2d\u5730\u5740\u7aef\u53e3\u4e2d\u6240\u6307\u5b9a\u7684\u5730\u5740\u3002</p> <p></p> <p>\u56fe 1\u201111\u914d\u7f6e\u5730\u5740\u5bc4\u5b58\u5668</p>"},{"location":"pcie/all/#148-pci-functionpci-function-cfg-reg-space","title":"1.4.8     PCI Function\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4(PCI Function Cfg Reg Space)","text":"<p>\u6ca1\u4e2aPCI Function\u53ef\u4ee5\u5305\u542b\u6700\u591a256Bytes\u7684\u914d\u7f6e\u7a7a\u95f4\u3002\u8fd9\u4e2a\u914d\u7f6e\u7a7a\u95f4\u7684\u999664Bytes\u5305\u542b\u4e00\u4e2a\u88ab\u79f0\u4e3aHeader\uff08\u914d\u7f6e\u7a7a\u95f4\u5934\uff09\u7684\u7ed3\u6784\uff0c\u5269\u4f59\u7684192Bytes\u7528\u6765\u652f\u6301\u4e00\u4e9b\u5176\u4ed6\u53ef\u9009\u529f\u80fd\u3002\u7cfb\u7edf\u914d\u7f6e\u9996\u5148\u7531Boot ROM\u56fa\u4ef6\u6765\u6267\u884c\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u88ab\u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u5b83\u5c06\u91cd\u65b0\u5bf9\u7cfb\u7edf\u8fdb\u884c\u914d\u7f6e\uff0c\u91cd\u65b0\u8fdb\u884c\u8d44\u6e90\u5206\u914d\u3002\u8fd9\u4e5f\u5c31\u662f\u8bf4\u7cfb\u7edf\u914d\u7f6e\u7684\u8fc7\u7a0b\u53ef\u80fd\u4f1a\u88ab\u6267\u884c\u4e24\u6b21\u3002</p> <p>\u6839\u636eHeader\u7684\u7c7b\u578b\uff0cPCI Function\u88ab\u5206\u4e3a\u4e24\u4e2a\u57fa\u672c\u7684\u7c7b\u522b\u3002\u7b2c\u4e00\u79cdHeader\u79f0\u4e3aType 1 Header\uff08\u7c7b\u578b1\uff09\uff0c\u5b83\u7684\u7ed3\u6784\u5982\u56fe 1\u201112\uff0c\u5b83\u7528\u4e8e\u6807\u8bc6\u8fd9\u4e2aFunction\u662f\u4e00\u4e2aBridge\uff0cBridge\u5c06\u4f1a\u5728\u62d3\u6251\u7ed3\u6784\u4e0a\u521b\u5efa\u53e6\u4e00\u6761\u603b\u7ebf\u3002\u800cType 0 Header\uff08\u7c7b\u578b0\uff09\u5c31\u662f\u7528\u6765\u6307\u793a\u8fd9\u4e2aFunction\u4e0d\u662f\u4e00\u4e2aBridge\uff08\u5982\u56fe 1\u201113\uff09\u3002\u5173\u4e8eHeader\u7c7b\u578b\u7684\u4fe1\u606f\u5305\u542b\u5728dword3\u7684\u5b57\u82822\u7684\u540c\u540d\u5b57\u6bb5\u4e2d\uff08Class Code\u5b57\u6bb5\uff09\uff0c\u5f53\u8f6f\u4ef6\u5728\u7cfb\u7edf\u4e2d\u53d1\u73b0\u67d0\u4e2aFunction\u65f6\uff0c\u7b2c\u4e00\u4ef6\u4e8b\u5c31\u662f\u8981\u68c0\u67e5\u5176Header\u7684\u8fd9\u4e2a\u5b57\u6bb5\uff08\u8f6f\u4ef6\u53d1\u73b0\u7cfb\u7edf\u4e2dFunction\u7684\u8fc7\u7a0b\u79f0\u4e3a\u679a\u4e3eenumeration\uff09\u3002</p> <p>\u5173\u4e8e\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4\u4ee5\u53ca\u679a\u4e3e\u8fc7\u7a0b\u7684\u66f4\u4e3a\u8be6\u7ec6\u7684\u8bb2\u89e3\u5c06\u4f1a\u7a0d\u540e\u518d\u8fdb\u884c\u3002\u5728\u8fd9\u91cc\u6211\u4eec\u53ea\u662f\u5e0c\u671b\u4f60\u5148\u719f\u6089\u4e00\u4e0b\u5404\u4e2a\u90e8\u5206\u662f\u5982\u4f55\u76f8\u4e92\u914d\u5408\u5de5\u4f5c\u7684\u3002</p> <p></p> <p>\u56fe 1\u201112 PCI\u914d\u7f6eHeader Type 1\uff08Bridge\uff09</p> <p></p> <p>\u56fe 1\u201113 PCI\u914d\u7f6eHeader Type 0\uff08\u975eBridge\uff09</p>"},{"location":"pcie/all/#149-pcihigher-bandwidth-pci","title":"1.4.9     \u66f4\u9ad8\u5e26\u5bbd\u7684PCI(Higher-bandwidth PCI)","text":"<p>\u4e3a\u4e86\u652f\u6301\u66f4\u9ad8\u7684\u5e26\u5bbd\uff0cPCI\u534f\u8bae\u89c4\u8303\u66f4\u65b0\u6210\u4e86\u652f\u6301\u4f4d\u5bbd\u66f4\u5bbd\uff0864bit\uff09\u65f6\u949f\u901f\u7387\u66f4\u5feb\uff0866MHz\uff09\u7684\u7248\u672c\uff0c\u4f7f\u5176\u53ef\u4ee5\u8fbe\u5230533MB/s\u7684\u901f\u7387\u3002\u56fe 1\u201114\u5c55\u793a\u4e86\u4e00\u4e2a\u4f7f\u752866MHz 64bit PCI\u603b\u7ebf\u7684\u7cfb\u7edf\u3002</p> <p></p> <p>\u56fe 1\u201114 \u57fa\u4e8e66MHz PCI\u603b\u7ebf\u7684\u5e73\u53f0</p>"},{"location":"pcie/all/#1491-66mhz-pci","title":"1.4.9.1   66MHz PCI\u603b\u7ebf\u7684\u9650\u5236","text":"<p>66MHz\u603b\u7ebf\u7684\u541e\u5410\u91cf\u76f8\u8f83\u4e8e33MHz\u5df2\u7ecf\u7ffb\u500d\uff0c\u4f46\u662f\u5176\u5b58\u5728\u4e00\u5b9a\u7684\u95ee\u9898\uff0c\u56fe 1\u201114\u663e\u793a\u4e86\u5b83\u7684\u4e00\u4e2a\u4e3b\u8981\u7f3a\u70b9\uff1a66MHz\u603b\u7ebf\u4e0e33MHz\u603b\u7ebf\u4f7f\u7528\u76f8\u540c\u7684\u53cd\u5c04\u6ce2\u5f00\u5173\u6a21\u578b\uff0c\u4f7f\u5f97\u7559\u7ed9\u5728\u4f20\u8f93\u7ebf\u4e0a\u4fe1\u53f7\u4f20\u8f93\u7684\u65f6\u95f4\u51cf\u534a\uff0c\u8fd9\u5c06\u4f1a\u5927\u5927\u7684\u964d\u4f4e\u603b\u7ebf\u7684\u8d1f\u8f7d\u80fd\u529b\u3002\u6700\u7ec8\u9020\u6210\u7684\u7ed3\u679c\u662f\uff0c\u4e00\u6761\u603b\u7ebf\u4e0a\u53ea\u80fd\u6709\u4e00\u4e2a\u63d2\u5165\u677f\u5361\u3002\u589e\u52a0\u66f4\u591a\u7684\u8bbe\u5907\u610f\u5473\u7740\u9700\u8981\u589e\u52a0\u66f4\u591a\u7684PCI Bridge\u6765\u4ea7\u751f\u66f4\u591a\u7684\u603b\u7ebf\uff0c\u8fd9\u5c06\u4f1a\u589e\u52a0\u6210\u672c\u4ee5\u53ca\u5bf9PCB\u677f\u6750\u7684\u8981\u6c42\u3002\u540c\u65f6\uff0c64bit PCI\u603b\u7ebf\u76f8\u8f83\u4e8e32bit\u589e\u52a0\u4e86\u5f15\u811a\u6570\uff0c\u8fd9\u4e5f\u4f1a\u589e\u52a0\u7cfb\u7edf\u6210\u672c\u4e14\u964d\u4f4e\u53ef\u9760\u6027\u3002\u5c06\u4e0a\u8ff0\u7ed3\u5408\u8d77\u6765\uff0c\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u770b\u51fa\u6765\u4e3a\u4ec0\u4e48\u8fd9\u4e9b\u56e0\u7d20\u9650\u5236\u4e8664bit\u6216\u800566MHz\u7248\u672c\u7684PCI\u603b\u7ebf\u7684\u5e7f\u6cdb\u4f7f\u7528\u3002</p>"},{"location":"pcie/all/#1492-pci66mhz","title":"1.4.9.2   \u5e76\u884cPCI\u603b\u7ebf\u6a21\u578b\u572866MHz\u4ee5\u4e0a\u65f6\u51fa\u73b0\u7684\u4fe1\u53f7\u65f6\u5e8f\u95ee\u9898","text":"<p>\u9274\u4e8ePCI\u603b\u7ebf\u4e0a\u7684\u5b9e\u9645\u8d1f\u8f7d\u4ee5\u53ca\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\uff08signal flight times\uff09\uff0cPCI\u603b\u7ebf\u7684\u65f6\u949f\u9891\u7387\u65e0\u6cd5\u572866MHz\u4e0a\u7ee7\u7eed\u589e\u52a0\u4e86\u3002\u5bf9\u4e8e66MHz\u65f6\u949f\u6765\u8bf4\uff0c\u5176\u65f6\u949f\u5468\u671f\u4e3a15ns\u3002\u63a5\u6536\u5668\u7684\u5efa\u7acb\u65f6\u95f4\u4e3a3ns\u3002\u56e0\u4e3aPCI\u4f7f\u7528\u7684\u201c\u975e\u5bc4\u5b58\u8f93\u5165\uff08non-registered input\uff09\u201d\u4fe1\u53f7\u6a21\u578b\uff0c\u60f3\u8981\u5c06\u51763ns\u7684\u5efa\u7acb\u65f6\u95f4\u7ee7\u7eed\u51cf\u5c0f\u662f\u4e0d\u73b0\u5b9e\u7684\u3002\u5269\u4f59\u768412ns\u7684\u65f6\u95f4\u9884\u7b97\u5206\u914d\u7ed9\u4e86\u53d1\u9001\u5668\u7684\u8f93\u51fa\u5ef6\u8fdf\u4ee5\u53ca\u4fe1\u53f7\u4f20\u8f93\u65f6\u95f4\u3002\u603b\u7ebf\u4e0a\u4f20\u8f93\u7684\u4fe1\u53f7\u5c06\u4f1a\u56e0\u4e3a\u65e0\u6cd5\u53ca\u65f6\u88ab\u63a5\u6536\u800c\u4f7f\u5f97\u5176\u65e0\u6cd5\u5728\u63a5\u6536\u7aef\u88ab\u6b63\u786e\u91c7\u6837\u3002</p> <p>\u5728\u4e0b\u4e00\u8282\u5c06\u4f1a\u4ecb\u7ecdPCI-X\u603b\u7ebf\uff0c\u5b83\u5c06\u6240\u6709\u7684\u8f93\u5165\u4fe1\u53f7\u90fd\u5148\u7528\u89e6\u53d1\u5668\u6765\u5bc4\u5b58\u4e00\u4e0b\uff0c\u7136\u540e\u518d\u53bb\u4f7f\u7528\u3002\u8fd9\u6837\u505a\u53ef\u4ee5\u5c06\u4fe1\u53f7\u7684\u5efa\u7acb\u65f6\u95f4\u964d\u4f4e\u52301ns\u4ee5\u4e0b\u3002\u5728\u5efa\u7acb\u65f6\u95f4\u4e0a\u7684\u4f18\u5316\u4f7f\u5f97PCI-X\u603b\u7ebf\u53ef\u4ee5\u8dd1\u5230\u4e00\u4e2a\u66f4\u9ad8\u7684\u9891\u7387\uff0c\u4f8b\u5982100MHz\u751a\u81f3133MHz\u3002\u4e0b\u4e00\u8282\u4e2d\u6211\u4eec\u5c06\u4f1a\u5bf9PCI-X\u603b\u7ebf\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u7b80\u660e\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"pcie/all/#15-pci-x","title":"1.5 PCI-X\u7b80\u4ecb","text":"<p>PCI-X\u5bf9PCI\u7684\u8f6f\u4ef6\u548c\u786c\u4ef6\u90fd\u80fd\u505a\u5230\u5411\u540e\u517c\u5bb9\uff0c\u540c\u65f6PCI-X\u8fd8\u80fd\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd\u548c\u66f4\u9ad8\u7684\u6548\u7387\u3002\u5b83\u548cPCI\u6240\u4f7f\u7528\u7684\u8fde\u63a5\u5668\u4e5f\u662f\u76f8\u540c\u7684\uff0c\u56e0\u6b64PCI-X\u4e0ePCI\u7684\u8bbe\u5907\u53ef\u4ee5\u63d2\u5165\u76f8\u4e92\u7684\u63d2\u69fd\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5b83\u4eec\u4e8c\u8005\u8fd8\u4f7f\u7528\u76f8\u540c\u7684\u914d\u7f6e\u6a21\u578b\uff0c\u56e0\u6b64\u5728PCI\u7cfb\u7edf\u4e2d\u80fd\u4f7f\u7528\u7684\u8bbe\u5907\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ee5\u53ca\u5e94\u7528\uff0c\u5728PCI-X\u7cfb\u7edf\u4e2d\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u3002</p> <p>\u4e3a\u4e86\u5728\u4e0d\u6539\u53d8PCI\u4fe1\u53f7\u4f20\u8f93\u6a21\u578b\u7684\u57fa\u7840\u4e0a\u8fbe\u5230\u66f4\u9ad8\u7684\u901f\u7387\uff0cPCI-X\u4f7f\u7528\u4e86\u51e0\u4e2a\u6280\u5de7\u6765\u6539\u5584\u603b\u7ebf\u65f6\u5e8f\u3002\u9996\u5148\uff0c\u4ed6\u4eec\u5b9e\u73b0\u4e86PLL\uff08\u9501\u76f8\u73af\uff09\u65f6\u949f\u53d1\u751f\u5668\uff0c\u5229\u7528\u5b83\u5728\u5185\u90e8\u63d0\u4f9b\u76f8\u79fb\u65f6\u949f\u3002\u8fd9\u4f7f\u5f97\u8f93\u51fa\u53ef\u4ee5\u63d0\u524d\u4e00\u70b9\u9a71\u52a8\u51fa\u53bb\uff0c\u800c\u8f93\u5165\u53ef\u4ee5\u7a0d\u665a\u4e00\u70b9\u8fdb\u884c\u91c7\u6837\uff0c\u4ece\u800c\u6539\u5584\u603b\u7ebf\u4e0a\u7684\u65f6\u5e8f\u3002\u540c\u65f6\uff0cPCI-X\u7684\u8f93\u5165\u4fe1\u53f7\u90fd\u5728Target\u8bbe\u5907\u7684\u8f93\u5165\u5f15\u811a\u88ab\u5bc4\u5b58\uff08\u9501\u5b58\uff09\uff0c\u8fd9\u6837\u5c31\u4f7f\u5f97\u5efa\u7acb\u65f6\u95f4\u66f4\u5c0f\u3002\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u8282\u7701\u51fa\u6765\u7684\u65f6\u95f4\u53ef\u4ee5\u6709\u6548\u589e\u52a0\u4fe1\u53f7\u5728\u603b\u7ebf\u4e0a\u4f20\u8f93\u7684\u53ef\u7528\u65f6\u95f4\uff0c\u5e76\u4f7f\u5f97\u603b\u7ebf\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63d0\u9ad8\u65f6\u949f\u9891\u7387\u3002</p>"},{"location":"pcie/all/#151-pci-xpci-x-system-example","title":"1.5.1     PCI-X\u7cfb\u7edf\u793a\u4f8b(PCI-X System Example)","text":"<p>\u5982\u56fe 1\u201115\u6240\u793a\uff0c\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8eIntel 7500\u670d\u52a1\u5668\u82af\u7247\u7ec4\u7684\u7cfb\u7edf\u5e73\u53f0\u3002</p> <p></p> <p>\u56fe 1\u201115\u57fa\u4e8e66MHz/33MHz PCI-X\u603b\u7ebf\u7684\u5e73\u53f0</p> <p>MCH\uff08Memory Controller Hub\uff09\u82af\u7247\u63d0\u4f9b\u4e863\u4e2a\u989d\u5916\u7684\u9ad8\u6027\u80fd\u7684Hub-Link 2.0\u7aef\u53e3\uff0c\u5b83\u4eec\u5404\u4e0e\u4e00\u4e2aPCI-X 2 Bridge\uff08P64H2\uff09\u76f8\u8fde\u63a5\u3002\u6bcf\u4e2aBridge\u652f\u6301\u4e24\u6761PCI-X\u603b\u7ebf\uff0c\u603b\u7ebf\u6700\u9ad8\u65f6\u949f\u9891\u7387\u53ef\u4ee5\u8fbe\u5230133MHz\u3002Hub Link 2.0\u53ef\u4ee5\u652f\u6491PCI-X\u66f4\u9ad8\u5e26\u5bbd\u7684\u6570\u636e\u6d41\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728PCI-X\u4e0a\u6211\u4eec\u4f9d\u7136\u5b58\u5728\u4e0e\u5f53\u521d\u6539\u8fdb66MHz PCI\u65f6\u9047\u5230\u7684\u4e00\u6837\u7684\u8d1f\u8f7d\u65b9\u9762\u7684\u95ee\u9898\uff0c\u8fd9\u4f7f\u5f97\u5982\u679c\u6211\u4eec\u8981\u652f\u6301\u66f4\u591a\u7684\u8bbe\u5907\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528Bridge\u6765\u751f\u6210\u66f4\u591a\u7684\u603b\u7ebf\uff0c\u5e76\u4e14\u8fd9\u5c06\u4f1a\u662f\u4e00\u4e2a\u76f8\u5bf9\u6210\u672c\u6602\u8d35\u7684\u89e3\u51b3\u65b9\u6848\u3002\u4e0d\u8fc7\uff0c\u73b0\u5728\u7684\u5e26\u5bbd\u786e\u5b9e\u63d0\u9ad8\u4e86\u4e0d\u5c11\u3002</p>"},{"location":"pcie/all/#152-pci-xpci-x-transactions","title":"1.5.2     PCI-X\u4e8b\u52a1(PCI-X Transactions)","text":"<p>\u5982\u56fe 1\u201116\u6240\u793a\uff0c\u8fd9\u662f\u4e00\u4e2aPCI-X\u603b\u7ebf\u4e0aMemory\u7a81\u53d1\u8bfb\u53d6\uff08burst memory read\uff09\u4e8b\u52a1\u3002</p> <p></p> <p>\u56fe 1\u201116 PCI-X Memory\u7a81\u53d1\u8bfb\u53d6\u7684\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\u793a\u4f8b</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cPCI-X\u5e76\u4e0d\u5141\u8bb8\u5728\u7b2c\u4e00\u4e2a\u6570\u636e\u9636\u6bb5\uff08first data phase\uff09\u540e\u63d2\u5165\u7b49\u5f85\u6001\u3002\u4e4b\u6240\u4ee5\u8fd9\u6837\u505a\u662f\u56e0\u4e3aPCI-X\u4e2d\u4f1a\u5c06\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\u603b\u91cf\u544a\u8bc9Target\u8bbe\u5907\uff0c\u8fd9\u4e2a\u4fe1\u606f\u5c06\u4f1a\u5728\u4e8b\u52a1\u7684\u5c5e\u6027\u9636\u6bb5\uff08Attribute Phase\uff09\uff0c\u56e0\u6b64Target\u662f\u77e5\u9053\u81ea\u5df1\u9700\u8981\u4f20\u8f93\u591a\u5c11\u6570\u636e\u7684\uff0c\u8fd9\u91cc\u5c31\u4e0ePCI\u4e0d\u540c\u4e86\u3002\u6b64\u5916\uff0c\u591a\u6570PCI-X\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\u662f\u4f7f\u7528\u7a81\u53d1\u6a21\u5f0f\u4f20\u8f93\u7684\uff0c\u5e76\u4e14\u6570\u636e\u901a\u5e38\u4ee5128Bytes\u4f5c\u4e3a\u4e00\u4e2a\u6570\u636e\u5757\uff08block\uff09\u6765\u8fdb\u884c\u4f20\u8f93\u3002\u8fd9\u4e9b\u7279\u6027\u4f7f\u5f97\u603b\u7ebf\u5229\u7528\u7387\u63d0\u9ad8\uff0c\u540c\u65f6\u4e5f\u63d0\u9ad8\u4e86\u8bbe\u5907buffer\u7ba1\u7406\u7684\u6548\u7387\u3002</p>"},{"location":"pcie/all/#153-pci-xpci-x-features","title":"1.5.3     PCI-X\u7279\u6027(PCI-X Features)","text":""},{"location":"pcie/all/#1531-split-transaction-model","title":"1.5.3.1   \u62c6\u5206\u4e8b\u52a1\u6a21\u578b\uff08Split-Transaction Model\uff09","text":"<p>\u5728\u4f20\u7edf\u7684PCI\u8bfb\u4e8b\u52a1\u4e2d\uff0c\u603b\u7ebfMaster\u5411\u603b\u7ebf\u4e0a\u67d0\u4e2a\u8bbe\u5907\u53d1\u8d77\u8bfb\u53d6\u3002\u5982\u524d\u9762\u7684\u5185\u5bb9\u6240\u8ff0\uff0c\u82e5Target\u8bbe\u5907\u672a\u51c6\u5907\u597d\uff0c\u65e0\u6cd5\u5b8c\u6210\u4e8b\u52a1\uff0c\u90a3\u4e48\u5b83\u65e2\u53ef\u4ee5\u9009\u62e9\u5728\u83b7\u53d6\u6570\u636e\u7684\u540c\u65f6\u8ba9\u603b\u7ebf\u4fdd\u6301\u7b49\u5f85\u6001\uff0c\u4e5f\u53ef\u4ee5\u53d1\u8d77Retry\u6765\u63a8\u8fdf\u4e8b\u52a1\u3002</p> <p>PCI-X\u5219\u4e0d\u540c\uff0c\u5b83\u4f7f\u7528\u62c6\u5206\u4e8b\u52a1\u7684\u65b9\u6cd5\u6765\u5904\u7406\u8fd9\u4e9b\u60c5\u51b5\uff0c\u5982\u56fe 1\u201117\u6240\u793a\u3002</p> <p></p> <p>\u56fe 1\u201117 PCI-X \u62c6\u5206\u4e8b\u52a1\u5904\u7406\u534f\u8bae</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u63cf\u8ff0\u8ffd\u8e2a\u6bcf\u4e2a\u8bbe\u5907\u6b63\u5728\u505a\u4ec0\u4e48\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u4f8b\u5b50\u4e2d\u53d1\u8d77\u8bfb\u53d6\u64cd\u4f5c\u7684\u4e00\u65b9\u79f0\u4e3aRequester\uff08\u8bf7\u6c42\u65b9\uff09\uff0c\u5c06\u5b8c\u6210\u8bfb\u53d6\u8bf7\u6c42\u63d0\u4f9b\u6570\u636e\u7684\u4e00\u65b9\u79f0\u4e3aCompleter\uff08\u5b8c\u6210\u65b9\uff09\u3002\u5982\u679cCompleter\u65e0\u6cd5\u9a6c\u4e0a\u5bf9\u8bf7\u6c42\u505a\u51fa\u76f8\u5e94\u7684\u670d\u52a1\uff0c\u5b83\u5c06\u628a\u8fd9\u4e2a\u4e8b\u52a1\u7684\u76f8\u5173\u4fe1\u606f\u5b58\u50a8\u8d77\u6765\uff08\u5730\u5740\u3001\u4e8b\u52a1\u7c7b\u578b\u3001\u603b\u6570\u636e\u91cf\u3001Requester ID\uff09\uff0c\u5e76\u53d1\u51fa\u62c6\u5206\u54cd\u5e94\u4fe1\u53f7\u3002\u8fd9\u5c31\u544a\u8bc9Requester\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u4e8b\u52a1\u5148\u653e\u7f6e\u5728\u961f\u5217\u4e2d\uff0c\u5e76\u7ed3\u675f\u5f53\u524d\u7684\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\uff0c\u91ca\u653e\u603b\u7ebf\u4f7f\u4e4b\u56de\u5230\u7a7a\u95f2\u72b6\u6001\u3002\u8fd9\u6837\uff0c\u5728Completer\u7b49\u5f85\u6240\u8bf7\u6c42\u7684\u6570\u636e\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff0c\u603b\u7ebf\u4e0a\u53ef\u4ee5\u6267\u884c\u5176\u4ed6\u7684\u4e8b\u52a1\u3002Requester\u5728\u8fd9\u6bb5\u65f6\u95f4\u91cc\u4e5f\u53ef\u4ee5\u81ea\u7531\u7684\u505a\u5176\u4ed6\u4e8b\u60c5\uff0c\u6bd4\u5982\u53d1\u8d77\u53e6\u4e00\u4e2a\u8bf7\u6c42\uff0c\u751a\u81f3\u662f\u5411\u6b64\u524d\u7684\u90a3\u4e2aCompleter\u53d1\u8d77\u8bf7\u6c42\u90fd\u53ef\u4ee5\u3002\u4e00\u65e6Completer\u6536\u96c6\u5230\u4e86\u6240\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u5b83\u5c06\u4f1a\u7533\u8bf7\u603b\u7ebf\u5360\u7528\u4ef2\u88c1\uff0c\u5f53\u83b7\u53d6\u5230\u603b\u7ebf\u7684\u4f7f\u7528\u6743\u540e\uff0c\u5b83\u5c06\u53d1\u8d77\u4e00\u4e2a\u62c6\u5206\u5b8c\u6210\uff08Split Completion\uff09\u6765\u8fd4\u56de\u6b64\u524dRequester\u6240\u8bf7\u6c42\u7684\u6570\u636e\u3002Requester\u5c06\u4f1a\u54cd\u5e94\u5e76\u53c2\u4e0e\u62c6\u5206\u5b8c\u6210\u8fd9\u4e2a\u4e8b\u52a1\u7684\u603b\u7ebf\u65f6\u5e8f\u5468\u671f\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u63a5\u6536\u6765\u81eaCompleter\u7684\u6570\u636e\u3002\u5bf9\u4e8e\u7cfb\u7edf\u6765\u8bf4\uff0c\u62c6\u5206\u5b8c\u6210\u4e8b\u52a1\u5176\u5b9e\u4e0e\u5199\u4e8b\u52a1\u975e\u5e38\u76f8\u4f3c\u3002\u8fd9\u79cd\u62c6\u5206\u4e8b\u52a1\u6a21\u578b\uff08Split Transaction Model\uff09\u662f\u53ef\u884c\u7684\u662f\u56e0\u4e3a\u5728\u8bf7\u6c42\u53d1\u8d77\u65f6\u5c31\u901a\u8fc7\u5c5e\u6027\u9636\u6bb5\uff08Attribute Phase\uff09\u6307\u51fa\u4e86\u603b\u5171\u9700\u8981\u4f20\u8f93\u591a\u5c11\u6570\u636e\uff0c\u5e76\u4e14\u4e5f\u544a\u8bc9\u4e86Completer\u662f\u8c01\u53d1\u8d77\u4e86\u8fd9\u4e2a\u8bf7\u6c42\uff08\u901a\u8fc7\u63d0\u4f9bRequester\u81ea\u5df1\u7684Bus:Device:Function\u53f7\u7801\uff09\uff0c\u8fd9\u4f7f\u5f97Completer\u5728\u53d1\u8d77\u62c6\u5206\u5b8c\u6210\u4e8b\u52a1\u65f6\u80fd\u591f\u627e\u5230\u6b63\u786e\u7684\u76ee\u6807\u3002</p> <p>\u5bf9\u4e8e\u4e0a\u8ff0\u7684\u6574\u4e2a\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\u6765\u8bf4\uff0c\u9700\u8981\u901a\u8fc7\u4e24\u4e2a\u603b\u7ebf\u4e8b\u52a1\u6765\u5b8c\u6210\uff0c\u4f46\u662f\u8bfb\u8bf7\u6c42\u548c\u62c6\u5206\u5b8c\u6210\u8fd9\u4e24\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u7684\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff0c\u603b\u7ebf\u662f\u53ef\u4ee5\u6267\u884c\u5176\u4ed6\u4efb\u52a1\u7684\u3002Requester\u4e0d\u9700\u8981\u91cd\u590d\u7684\u8f6e\u8be2\u8bbe\u5907\u6765\u68c0\u67e5\u6570\u636e\u662f\u5426\u5df2\u7ecf\u51c6\u5907\u597d\u3002Completer\u53ea\u9700\u8981\u7b80\u5355\u7684\u7533\u8bf7\u603b\u7ebf\u5360\u7528\u4ef2\u88c1\uff0c\u7136\u540e\u5728\u80fd\u4f7f\u7528\u603b\u7ebf\u65f6\u5c06\u88ab\u8bf7\u6c42\u7684\u6570\u636e\u8fd4\u56de\u7ed9Requester\u5373\u53ef\u3002\u5c31\u603b\u7ebf\u5229\u7528\u7387\u800c\u8a00\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u6d41\u7a0b\u4f7f\u5f97\u4e8b\u52a1\u6a21\u578b\u66f4\u52a0\u9ad8\u6548\u3002</p> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5bf9PCI-X\u6240\u505a\u7684\u8fd9\u4e9b\u534f\u8bae\u589e\u5f3a\u6539\u8fdb\u4f7f\u5f97PCI-X\u7684\u4f20\u8f93\u6548\u7387\u63d0\u9ad8\u81f3\u7ea685%\uff0c\u800c\u4f7f\u7528\u6807\u51c6PCI\u534f\u8bae\u5219\u4e3a50%-60%\u3002</p>"},{"location":"pcie/all/#1532-msimessage-signaled-interrupts","title":"1.5.3.2   MSI\u6d88\u606f\u5f0f\u4e2d\u65ad\uff08Message Signaled Interrupts\uff09","text":"<p>PCI-X\u8bbe\u5907\u9700\u8981\u652f\u6301MSI\u4e2d\u65ad\uff08Message Signaled Interrupts\uff09\uff0c\u5728\u4f20\u7edf\u4e2d\u65ad\u4f53\u7cfb\u7ed3\u6784\u4e2d\u7ecf\u5e38\u89c1\u5230\u591a\u4e2a\u8bbe\u5907\u9700\u8981\u5171\u4eab\u4e2d\u65ad\uff0c\u5f00\u53d1\u8fd9\u79cd\u529f\u80fd\u662f\u4e3a\u4e86\u51cf\u5c11\u6216\u8005\u6d88\u9664\u8fd9\u79cd\u9700\u8981\u3002\u60f3\u8981\u4ea7\u751f\u4e00\u4e2aMSI\u4e2d\u65ad\u8bf7\u6c42\uff0c\u8bbe\u5907\u9700\u8981\u53d1\u8d77\u4e00\u4e2amemory\u5199\u4e8b\u52a1\uff0c\u5176\u64cd\u4f5c\u5730\u5740\u4e3a\u4e00\u6bb5\u9884\u5148\u5b9a\u4e49\u597d\u7684\u5730\u5740\u533a\u57df\uff0c\u5728\u8fd9\u4e2a\u5730\u5740\u533a\u57df\u5185\u7684\u4e00\u4e2a\u5199\u5165\u64cd\u4f5c\u5c31\u4f1a\u88ab\u89c6\u4e3a\u662f\u4e00\u4e2a\u4e2d\u65ad\uff0c\u8fd9\u4e2a\u4fe1\u606f\u5c06\u4f1a\u88ab\u4f20\u9001\u7ed9\u4e00\u4e2a\u6216\u591a\u4e2aCPU\uff0c\u5199\u5165\u7684\u6570\u636e\u5219\u662f\u53d1\u8d77\u4e2d\u65ad\u7684\u8bbe\u5907\u7684\u4e2d\u65ad\u5411\u91cf\uff0c\u8fd9\u4e2a\u4e2d\u65ad\u5411\u91cf\u5728\u7cfb\u7edf\u4e2d\u662f\u552f\u4e00\u7684\uff0c\u4ec5\u6307\u5411\u8fd9\u4e00\u4e2a\u8bbe\u5907\u3002\u5bf9\u4e8eCPU\u6765\u8bf4\uff0c\u62e5\u6709\u4e86\u4e2d\u65ad\u53f7\u4e4b\u540e\u5c31\u53ef\u4ee5\u8fc5\u901f\u7684\u8df3\u8f6c\u5230\u5bf9\u5e94\u8bbe\u5907\u7684\u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u8fd8\u9700\u8981\u82b1\u8d39\u989d\u5916\u7684\u5f00\u9500\u6765\u67e5\u627e\u662f\u90a3\u4e2a\u8bbe\u5907\u53d1\u8d77\u7684\u4e2d\u65ad\u3002\u6b64\u5916\uff0c\u8fd9\u6837\u7684\u4e2d\u65ad\u65b9\u5f0f\u5c31\u4e0d\u9700\u8981\u989d\u5916\u7684\u4e2d\u65ad\u5f15\u811a\u4e86\u3002</p>"},{"location":"pcie/all/#1533-transaction-attributes","title":"1.5.3.3   \u4e8b\u52a1\u5c5e\u6027\uff08Transaction Attributes\uff09","text":"<p>\u6700\u540e\uff0c\u6211\u4eec\u6765\u4ecb\u7ecd\u4e00\u4e0bPCI-X\u5728\u6bcf\u4e2a\u4e8b\u52a1\u5f00\u59cb\u65f6\u65b0\u52a0\u5165\u7684\u4e00\u4e2a\u9636\u6bb5\uff0c\u79f0\u4e4b\u4e3a\u5c5e\u6027\u9636\u6bb5\uff08\u5982\u56fe 1\u201116\u6240\u793a\uff09\u3002\u5728\u6bb5\u65f6\u95f4\u4e2d\uff0cRequester\u4f1a\u5c06\u6240\u53d1\u8d77\u4e8b\u52a1\u7684\u4e00\u4e9b\u4fe1\u606f\u4f20\u9012\u7ed9Completer\uff0c\u4fe1\u606f\u5305\u62ec\u8bf7\u6c42\u7684\u603b\u6570\u636e\u91cf\u5927\u5c0f\u3001Requester\u662f\u8c01\uff08Bus:Device:Function \u53f7\u7801\uff09\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u6709\u6548\u7684\u8ba9\u603b\u7ebf\u4e0a\u7684\u4e8b\u52a1\u6267\u884c\u63d0\u5347\u6548\u7387\u3002\u9664\u4e86\u8fd9\u4e9b\u4ee5\u5916\uff0c\u8fd8\u65b0\u5f15\u5165\u4e862bit\u7684\u4fe1\u53f7\u6765\u63cf\u8ff0\u6240\u53d1\u8d77\u7684\u4e8b\u52a1\uff1a\u201cNo Snoop\uff08\u65e0\u7aa5\u63a2\uff09\u201d\u4f4d\u4e0e\u201cRelaxed Ordering\uff08\u5bbd\u677e\u6392\u5e8f\uff09\u201d\u4f4d\u3002</p> <p>l No Snoop**\uff08NS****\uff09\uff1a**\u4e00\u822c\u6765\u8bf4\uff0c\u5f53\u4e00\u4e2a\u4e8b\u52a1\u8981\u628a\u6570\u636e\u79fb\u5165\u6216\u8005\u79fb\u51faMemory\u65f6\uff0cCPU\u5185\u90e8\u7684Cache\u9700\u8981\u68c0\u67e5\u88ab\u64cd\u4f5c\u7684Memory\u533a\u57df\u4e2d\u662f\u5426\u5b58\u5728\u5df2\u7ecf\u88ab\u62f7\u8d1d\u5230Cache\u4e2d\u7684\u90e8\u5206\u3002\u82e5\u5b58\u5728\uff0c\u90a3\u4e48Cache\u9700\u8981\u5728\u4e8b\u52a1\u8bbf\u95eeMemory\u4e4b\u524d\u5c31\u628a\u6570\u636e\u5199\u56deMemory\uff0c\u6216\u662f\u628aCache\u5185\u7684\u6570\u636e\u6309\u5931\u6548\u5904\u7406\u3002\u5f53\u7136\uff0c\u8fd9\u4e2a\u7aa5\u63a2Memory\u5185\u5bb9\u6709\u65e0\u51fa\u73b0\u5728cache\u4e2d\u7684\u8fc7\u7a0b\u5c06\u4f1a\u6d88\u8017\u4e00\u5b9a\u7684\u65f6\u95f4\uff0c\u5e76\u4e14\u4f1a\u589e\u52a0\u8fd9\u4e2a\u8bf7\u6c42\u7684\u5ef6\u8fdf\u3002\u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\uff0c\u8f6f\u4ef6\u662f\u77e5\u9053\u67d0\u4e2a\u8bf7\u6c42\u7684Memory\u4f4d\u7f6e\u6c38\u8fdc\u4e0d\u4f1a\u51fa\u73b0\u5728Cache\u4e2d\uff08\u8fd9\u53ef\u80fd\u662f\u56e0\u4e3a\u8fd9\u4e2a\u4f4d\u7f6e\u88ab\u7cfb\u7edf\u5b9a\u4e49\u4e3a\u4e0d\u53ef\u7f13\u5b58\u7684\uff09\uff0c\u56e0\u6b64\u5bf9\u4e8e\u8fd9\u4e9b\u4f4d\u7f6e\u662f\u4e0d\u9700\u8981\u8fdb\u884c\u7aa5\u63a2\u7684\uff0c\u5e94\u8be5\u8df3\u8fc7\u8fd9\u4e00\u6b65\u9aa4\u3002No Snoop\u4f4d\u6b63\u662f\u57fa\u4e8e\u8fd9\u79cd\u539f\u56e0\u800c\u88ab\u5f15\u5165\u8fdb\u6765\u3002</p> <p>l Relaxed Ordering**\uff08RO****\uff09\uff1a**\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53\u4e8b\u52a1\u901a\u8fc7Bridge\u7684buffer\u65f6\uff0c\u4e8b\u52a1\u95f4\u9700\u8981\u4fdd\u6301\u5f53\u521d\u88ab\u653e\u7f6e\u5230\u603b\u7ebf\u4e0a\u65f6\u7684\u987a\u5e8f\u3002\u8fd9\u88ab\u79f0\u4e3a\u5f3a\u6392\u5e8f\u6a21\u578b\uff08Strongly ordered model\uff09\uff0cPCI\u4e0ePCI-X\u4e00\u822c\u90fd\u4f1a\u9075\u5faa\u8fd9\u79cd\u89c4\u5219\uff0c\u9664\u4e86\u4e00\u4e9b\u4e2a\u522b\u60c5\u51b5\u3002\u8fd9\u662f\u56e0\u4e3a\u5f3a\u6392\u5e8f\u6a21\u578b\u53ef\u4ee5\u89e3\u51b3\u6709\u76f8\u4e92\u8054\u7cfb\u7684\u4e8b\u52a1\u4e4b\u95f4\u7684\u4f9d\u8d56\u95ee\u9898\uff0c\u4f8b\u5982\u5bf9\u540c\u4e00\u4e2a\u4f4d\u7f6e\u5148\u8fdb\u884c\u5199\u5165\u518d\u8fdb\u884c\u8bfb\u53d6\uff0c\u6309\u7167\u5f3a\u6392\u5e8f\u6a21\u578b\u5c31\u53ef\u4ee5\u4f7f\u5f97\u8bfb\u53d6\u64cd\u4f5c\u8bfb\u53d6\u5230\u5199\u5165\u540e\u7684\u6b63\u786e\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5199\u5165\u524d\u7684\u65e7\u6570\u636e\u3002\u7136\u800c\u5b9e\u9645\u4e0a\u5e76\u4e0d\u662f\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\u3002\u5982\u679c\u6709\u4e9b\u4e8b\u52a1\u4e0d\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\uff0c\u90a3\u4e48\u4f9d\u7136\u5f3a\u5236\u5b83\u4eec\u4fdd\u6301\u539f\u6765\u7684\u987a\u5e8f\u5c06\u4f1a\u9020\u6210\u6027\u80fd\u635f\u5931\uff0c\u8fd9\u5c31\u662f\u65b0\u6dfb\u52a0\u8fd9\u4e00\u4f4d\u60f3\u89e3\u51b3\u7684\u95ee\u9898\u3002\u5982\u679cRequester\u77e5\u9053\u67d0\u4e2a\u7279\u5b9a\u7684\u4e8b\u52a1\u662f\u4e0e\u6b64\u524d\u5176\u4ed6\u4e8b\u52a1\u4e0d\u76f8\u5173\u8054\u7684\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u4e8b\u52a1\u7684\u8fd9\u4e00\u4f4d\u7f6e\u4e3a\u6709\u6548\uff0c\u8fd9\u6837\u5c31\u80fd\u544a\u8bc9Bridge\u53ef\u4ee5\u8ba9\u8fd9\u4e2a\u4e8b\u52a1\u5728\u961f\u5217\u4e2d\u5f80\u524d\u79fb\u52a8\u63d0\u524d\u6267\u884c\uff0c\u4ee5\u6b64\u5e26\u6765\u66f4\u597d\u7684\u6027\u80fd\u3002</p>"},{"location":"pcie/all/#154-pci-xhigher-bandwidth-pci-x","title":"1.5.4     \u66f4\u9ad8\u5e26\u5bbd\u7684PCI-X(Higher Bandwidth PCI-X)","text":""},{"location":"pcie/all/#1541-pcipci-x-10","title":"1.5.4.1   PCI\u4e0ePCI-X 1.0\u5e76\u884c\u603b\u7ebf\u6a21\u578b\u4e2d\u7531\u4e8e\u516c\u5171\u65f6\u949f\u65b9\u6cd5\u6240\u5e26\u6765\u7684\u95ee\u9898","text":"<p>\u5f53\u5c1d\u8bd5\u5c06PCI\u8fd9\u6837\u7684\u603b\u7ebf\u5347\u7ea7\u5230\u66f4\u9ad8\u7684\u901f\u7387\u65f6\uff0c\u4e00\u4e2a\u95ee\u9898\u53d8\u5f97\u8d8a\u6765\u8d8a\u660e\u663e\uff0c\u90a3\u5c31\u662f\u5e76\u884c\u603b\u7ebf\u8bbe\u8ba1\u5b58\u5728\u4e00\u4e9b\u56fa\u6709\u7684\u5148\u5929\u5c40\u9650\u3002\u56fe 1\u201118\u53ef\u4ee5\u6709\u52a9\u4e8e\u7406\u89e3\u8fd9\u4e2a\u95ee\u9898\u3002\u8fd9\u4e9b\u8bbe\u8ba1\u901a\u5e38\u4f7f\u7528\u516c\u5171\u65f6\u949f\uff08common clock\uff09\u6216\u8005\u662f\u5206\u5e03\u5f0f\u65f6\u949f\uff08distributed clock\uff09\uff0c\u5176\u4e2d\uff0c\u53d1\u9001\u65b9\u5728\u516c\u5171\u65f6\u949f\u7684\u67d0\u4e00\u4e2a\u65f6\u949f\u6cbf\u5c06\u6570\u636e\u8f93\u51fa\uff0c\u7136\u540e\u63a5\u6536\u65b9\u5728\u516c\u5171\u65f6\u949f\u7684\u4e0b\u4e00\u4e2a\u65f6\u949f\u6cbf\u5c06\u6570\u636e\u9501\u5b58\uff0c\u4e5f\u5c31\u662f\u8bf4\u7528\u4e8e\u4f20\u8f93\u7684\u65f6\u95f4\u9884\u7b97\u957f\u5ea6\u5c31\u662f\u4e00\u4e2a\u65f6\u949f\u5468\u671f\u3002</p> <p></p> <p>\u56fe 1\u201118\u5e76\u884c\u8bbe\u8ba1\u7684\u56fa\u6709\u95ee\u9898</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u7b2c\u4e00\u4e2a\u95ee\u9898\u662f\u4fe1\u53f7\u6b6a\u659c\uff08signal skew\uff09\u3002\u5f53\u6570\u636e\u7684\u591a\u4e2abit\u5728\u540c\u4e00\u65f6\u523b\u88ab\u53d1\u51fa\uff0c\u4ed6\u4eec\u6240\u7ecf\u5386\u7684\u5ef6\u65f6\u4f1a\u5b58\u5728\u8f7b\u5fae\u7684\u5dee\u522b\uff0c\u8fd9\u4f7f\u5f97\u4ed6\u4eec\u5230\u8fbe\u63a5\u53d7\u4f10\u7684\u65f6\u523b\u4e5f\u4f1a\u5b58\u5728\u8f7b\u5fae\u7684\u5dee\u522b\u3002\u5982\u679c\u67d0\u4e9b\u539f\u56e0\u9020\u6210\u8fd9\u79cd\u5dee\u522b\u8fc7\u5927\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u56fe\u4e2d\u6240\u793a\u7684\u4fe1\u53f7\u91c7\u6837\u9519\u8bef\u7684\u95ee\u9898\u3002\u7b2c\u4e8c\u4e2a\u95ee\u9898\u662f\u591a\u4e2a\u8bbe\u5907\u95f4\u7684\u65f6\u949f\u6b6a\u659c\u95ee\u9898\u3002\u516c\u5171\u65f6\u949f\u5230\u8fbe\u5404\u4e2a\u8bbe\u5907\u7684\u65f6\u95f4\u70b9\u5e76\u4e0d\u662f\u5341\u5206\u7cbe\u786e\u4e00\u81f4\u7684\uff0c\u8fd9\u4e5f\u4f1a\u5927\u5927\u7684\u538b\u7f29\u4e86\u7528\u4e8e\u4f20\u8f93\u4fe1\u53f7\u7684\u65f6\u95f4\u9884\u7b97\u957f\u5ea6\u3002\u6700\u540e\uff0c\u7b2c\u4e09\u4e2a\u95ee\u9898\u4e0e\u4e00\u4e2a\u4fe1\u53f7\u4ece\u53d1\u9001\u65b9\u4f20\u8f93\u5230\u63a5\u6536\u65b9\u6240\u9700\u8981\u7684\u65f6\u95f4\u6709\u5173\uff0c\u6211\u4eec\u79f0\u8fd9\u4e2a\u65f6\u95f4\u4e3a\u6e21\u8d8a\u65f6\u95f4\uff08flight time\uff09\u3002\u65f6\u949f\u5468\u671f\u6216\u662f\u4f20\u8f93\u65f6\u95f4\u9884\u7b97\u5fc5\u987b\u8981\u5927\u4e8e\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u3002\u4e3a\u4e86\u786e\u4fdd\u6ee1\u8db3\u8fd9\u6837\u7684\u6761\u4ef6\uff0cPCB\u786c\u4ef6\u677f\u7ea7\u8bbe\u8ba1\u9700\u8981\u8ba9\u4fe1\u53f7\u8d70\u7ebf\u5c3d\u53ef\u80fd\u77ed\uff0c\u4ee5\u6b64\u6765\u8ba9\u4fe1\u53f7\u4f20\u8f93\u65f6\u5ef6\u5c0f\u4e8e\u65f6\u949f\u5468\u671f\u3002\u5728\u8bb8\u591a\u7535\u8def\u677f\u8bbe\u8ba1\u4e2d\uff0c\u8fd9\u79cd\u77ed\u4fe1\u53f7\u8d70\u7ebf\u7684\u8bbe\u8ba1\u5e76\u4e0d\u73b0\u5b9e\u3002</p> <p>\u5c3d\u7ba1\u5b58\u5728\u8fd9\u4e9b\u81ea\u8eab\u5c40\u9650\uff0c\u4f46\u662f\u4e3a\u4e86\u66f4\u8fdb\u4e00\u6b65\u63d0\u5347\u6027\u80fd\uff0c\u8fd8\u662f\u6709\u51e0\u9879\u6280\u672f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002\u9996\u5148\uff0c\u53ef\u4ee5\u5bf9\u73b0\u6709\u7684\u534f\u8bae\u8fdb\u884c\u7b80\u5316\u800c\u63d0\u9ad8\u6548\u7387\u3002\u7b2c\u4e8c\uff0c\u53ef\u4ee5\u5c06\u603b\u7ebf\u6a21\u578b\u66f4\u6539\u4e3a\u6e90\u540c\u6b65\u65f6\u949f\u6a21\u578b\uff08source synchronous clocking model\uff09\uff0c\u5728\u8fd9\u79cd\u65f6\u949f\u6a21\u578b\u4e2d\uff0c\u603b\u7ebf\u4fe1\u53f7\u548c\u65f6\u949f\uff08strobe\u9009\u901a\u8109\u51b2\uff09\u88ab\u9a71\u52a8\u540e\u5c06\u7ecf\u5386\u76f8\u540c\u7684\u4f20\u8f93\u5ef6\u8fdf\u5230\u8fbe\u63a5\u6536\u7aef\uff08\u8fd9\u91cc\u53ef\u4ee5\u5bf9\u6bd4\u4e00\u4e0bcommon clock\u4e0e\u5176\u7684\u533a\u522b\uff09\u3002\u8fd9\u79cd\u65b9\u6cd5\u88abPCI-X 2.0\u6240\u91c7\u7528\u3002</p>"},{"location":"pcie/all/#1542-pci-x-20pci-x-20-source-synchronous-model","title":"1.5.4.2   PCI-X 2.0\u6e90\u540c\u6b65\u6a21\u578b\uff08PCI-X 2.0 Source-Synchronous Model\uff09","text":"<p>PCI-X2.0\u66f4\u8fdb\u4e00\u6b65\u7684\u63d0\u9ad8\u4e86PCI-X\u7684\u5e26\u5bbd\u3002\u5982\u6b64\u524d\u5347\u7ea7\u65f6\u4e00\u6837\uff0cPCI-X 2.0\u4f9d\u7136\u4fdd\u6301\u4e86\u5bf9PCI\u7684\u8f6f\u4ef6\u4e0e\u786c\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\u3002\u4e3a\u4e86\u8fbe\u5230\u66f4\u9ad8\u7684\u901f\u7387\uff0c\u603b\u7ebf\u4f7f\u7528\u4e86\u6e90\u540c\u6b65\u4f20\u8f93\u6a21\u578b\uff0c\u6765\u652f\u6301DDR\uff08\u53cc\u500d\u6570\u636e\u901f\u7387\uff09\u6216\u662fQDR\uff08\u56db\u500d\u6570\u636e\u901f\u7387\uff09\u3002</p> <p>\u201c\u6e90\u540c\u6b65\u201d\u8fd9\u4e2a\u672f\u8bed\u7684\u610f\u601d\u662f\uff0c\u8bbe\u5907\u5728\u4f20\u8f93\u6570\u636e\u7684\u540c\u65f6\uff0c\u8fd8\u63d0\u4f9b\u4e86\u989d\u5916\u4e00\u4e2a\u4e0e\u6570\u636e\u4fe1\u53f7\u57fa\u672c\u4f20\u8f93\u8def\u5f84\u76f8\u540c\u7684\u4fe1\u53f7\u3002\u5982\u56fe 1\u201119\u6240\u793a\uff0c\u5728PCI-X 2.0\u4e2d\uff0c\u90a3\u4e2a\u201c\u989d\u5916\u201d\u7684\u4fe1\u53f7\u88ab\u79f0\u4e3a\u201cstrobe\uff08\u8109\u51b2\u9009\u901a\uff09\u201d\uff0c\u63a5\u6536\u65b9\u4f7f\u7528\u5b83\u6765\u9501\u5b58\u53d1\u6765\u7684\u6570\u636e\u3002\u53d1\u9001\u65b9\u53ef\u4ee5\u5206\u914ddata\u4e0estrobe\u4fe1\u53f7\u4e4b\u95f4\u7684\u65f6\u5e8f\u5173\u7cfb\uff0c\u53ea\u8981data\u4e0estrobe\u4fe1\u53f7\u7684\u4f20\u8f93\u8def\u5f84\u957f\u5ea6\u76f8\u8fd1\u4e14\u5176\u4ed6\u4f1a\u5f71\u54cd\u4f20\u8f93\u5ef6\u8fdf\u7684\u6761\u4ef6\u4e5f\u76f8\u8fd1\uff0c\u90a3\u4e48\u5f53\u4fe1\u53f7\u5230\u8fbe\u63a5\u6536\u65b9\u65f6\uff0c\u8fd9\u79cd\u4fe1\u53f7\u95f4\u7684\u65f6\u5e8f\u5173\u7cfb\u4e5f\u5c06\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u3002\u8fd9\u79cd\u7279\u70b9\u53ef\u4ee5\u7528\u4e8e\u652f\u6301\u66f4\u9ad8\u901f\u7387\u7684\u4f20\u8f93\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u6e90\u540c\u6b65\u65f6\u949f\u6a21\u578b\u4e2d\uff0c\u63a5\u6536\u65b9\u91c7\u6837\u6240\u4f7f\u7528\u7684strobe\uff08\u7c7b\u4f3c\u4e8e\u539f\u6765\u7684\u65f6\u949f\uff09\u4e5f\u662f\u6570\u636e\u7684\u6765\u6e90\u65b9\u53d1\u9001\u7684\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u516c\u5171\u65f6\u949f\u5230\u8fbe\u5404\u8bbe\u5907\u7684\u5ef6\u65f6\u4e0d\u540c\u800c\u9020\u6210\u7684\u65f6\u949f\u6b6a\u659c\u95ee\u9898\uff0c\u56e0\u4e3a\u5982\u4e0a\u6240\u8ff0\u6b64\u65f6\u7684data\u4e0estrobe\u4e4b\u95f4\u7684\u65f6\u5e8f\u5173\u7cfb\u662f\u57fa\u672c\u76f8\u5bf9\u4e0d\u53d8\u7684\uff0c\u8fd9\u6837\u5c31\u5c06\u65f6\u949f\u6b6a\u659c\u7684\u8fd9\u6bb5\u65f6\u95f4\u5355\u72ec\u5254\u9664\u4e86\u51fa\u53bb\uff0c\u4e0d\u518d\u5360\u7528\u539f\u6765\u7684\u4f20\u8f93\u65f6\u95f4\u9884\u7b97\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u56e0\u4e3a\u5b58\u5728\u4e86strobe\u4fe1\u53f7\u6765\u968f\u8def\u6307\u793a\u63a5\u6536\u65b9\u4f55\u65f6\u9501\u5b58\u91c7\u6837\u6570\u636e\uff0c\u6240\u4ee5\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u4e0d\u518d\u662f\u4e2a\u95ee\u9898\uff0c\u5373\u4f7f\u8d70\u7ebf\u8f83\u957f\u4e5f\u4f9d\u7136\u80fd\u7531\u4f34\u968fdata\u7684strobe\u4fe1\u53f7\u6765\u8ba9\u63a5\u6536\u65b9\u6b63\u786e\u7684\u91c7\u6837\u6570\u636e\uff0c\u800c\u4e0d\u5fc5\u7ea0\u7ed3\u5728\u4e0b\u4e00\u4e2a\u201c\u65f6\u949f\u4e0a\u5347\u6cbf\u201d\u5fc5\u987b\u8981\u8fdb\u884c\u91c7\u6837\uff0c\u73b0\u5728strobe\u4f55\u65f6\u6307\u793a\u5219\u5728\u4f55\u65f6\u91c7\u6837\u3002</p> <p></p> <p>\u56fe 1\u201119\u6e90\u540c\u6b65\u65f6\u949f\u6a21\u578b</p> <p>\u9700\u8981\u518d\u6b21\u5f3a\u8c03\u7684\u662f\uff0c\u8fd9\u79cd\u975e\u5e38\u9ad8\u901f\u7684\u4fe1\u53f7\u65f6\u5e8f\u4f7f\u5f97\u5171\u4eab\u603b\u7ebf\u6a21\u578b\u65e0\u6cd5\u88ab\u4f7f\u7528\uff0c\u5b83\u53ea\u80fd\u88ab\u8bbe\u8ba1\u4e3a\u70b9\u5bf9\u70b9\u7684\u4f20\u8f93\u5f62\u5f0f\u3002\u56e0\u6b64\uff0c\u60f3\u8981\u589e\u52a0\u66f4\u591a\u7684\u8bbe\u5907\u5c31\u9700\u8981\u66f4\u591a\u7684Bridge\u6765\u4ea7\u751f\u66f4\u591a\u7684\u603b\u7ebf\u3002\u4e3a\u4e86\u8fbe\u5230\u8fd9\u6837\u7684\u4f7f\u7528\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u79cd\u8bbe\u5907\uff0c\u5b83\u62e5\u67093\u4e2aPCI-X 2.0\u63a5\u53e3\uff0c\u5176\u5185\u90e8\u8fd8\u6709\u4e00\u4e2aBridge\u7ed3\u6784\u4ee5\u6b64\u6765\u8ba9\u4ed6\u4eec\u4e09\u8005\u8fdb\u884c\u76f8\u4e92\u901a\u4fe1\u3002\u4e0d\u8fc7\uff0c\u8fd9\u6837\u7684\u8bbe\u5907\u5c06\u4f1a\u5177\u6709\u5f88\u9ad8\u7684\u5f15\u811a\u6570\u91cf\uff0c\u800c\u4e14\u6210\u672c\u4e5f\u4f1a\u66f4\u9ad8\uff0c\u8fd9\u4f7f\u5f97PCI-X 2.0\u88ab\u56f0\u5728\u4e86\u9ad8\u7aef\u5e02\u573a\u800c\u65e0\u6cd5\u5927\u9762\u79ef\u666e\u53ca\u3002</p> <p>\u7531\u4e8e\u534f\u8bae\u5236\u5b9a\u8005\u8ba4\u8bc6\u5230\u4e86PCI-X 2.0\u7684\u6602\u8d35\u89e3\u51b3\u65b9\u6848\u4ec5\u80fd\u5438\u5f15\u66f4\u591a\u7684\u9ad8\u7aef\u5f00\u53d1\u8005\u800c\u4e0d\u662f\u4e00\u822c\u5f00\u53d1\u8005\uff0c\u56e0\u6b64PCI-X 2.0\u63d0\u4f9b\u4e86\u66f4\u7b26\u5408\u9ad8\u7aef\u8bbe\u8ba1\u7684\u6280\u672f\u6807\u51c6\uff0c\u4f8b\u5982\u652f\u6301ECC\u7684\u751f\u6210\u4e0e\u6821\u9a8c\u3002PCI-X\u7684ECC\u6bd4PCI\u4e2d\u4f7f\u7528\u7684\u5947\u5076\u6821\u9a8c\u8981\u66f4\u4e3a\u590d\u6742\uff0c\u9c81\u68d2\u6027\uff08robust\uff09\u4e5f\u8981\u9ad8\u5f97\u591a\uff0c\u5b83\u53ef\u4ee5\u52a8\u6001\u7684\u81ea\u52a8\u7ea0\u6b63\u5355bit\u9519\u8bef\uff0c\u4ee5\u53ca\u5bf9\u591abit\u9519\u8bef\u8fdb\u884c\u53ef\u9760\u7684\u68c0\u6d4b\u3002\u8fd9\u79cd\u6539\u8fdb\u540e\u7684\u9519\u8bef\u5904\u7406\u65b9\u6cd5\u589e\u52a0\u4e86\u6210\u672c\uff0c\u4f46\u662f\u5bf9\u4e8e\u9ad8\u7aef\u5e73\u53f0\u6765\u8bf4\uff0c\u5b83\u6240\u80fd\u589e\u52a0\u7684\u53ef\u9760\u6027\u624d\u662f\u66f4\u4e3a\u770b\u4e2d\u7684\uff0c\u56e0\u6b64\u5373\u4f7f\u589e\u52a0\u4e86\u6210\u672c\u8fd9\u4e5f\u662f\u4e00\u4e2a\u5408\u7406\u7684\u9009\u62e9\u3002</p> <p>\u5c3d\u7ba1PCI-X 2.0\u5c06\u5e26\u5bbd\u3001\u6548\u7387\u4ee5\u53ca\u53ef\u9760\u6027\u90fd\u63d0\u5347\u4e86\uff0c\u4f46\u662f\u5e76\u884c\u603b\u7ebf\u7684\u7ec8\u7a76\u8fd8\u662f\u8d70\u5230\u4e86\u5b83\u7684\u7ec8\u70b9\uff0c\u9700\u8981\u4e00\u79cd\u65b0\u7684\u6a21\u578b\u6765\u6ee1\u8db3\u4eba\u4eec\u5bf9\u4e8e\u66f4\u9ad8\u5e26\u5bbd\u4e14\u66f4\u4f4e\u6210\u672c\u7684\u4e0d\u65ad\u7684\u9700\u6c42\u3002\u6700\u7ec8\u88ab\u9009\u4e2d\u7684\u65b0\u578b\u603b\u7ebf\u6a21\u578b\u4f7f\u7528\u7684\u662f\u4e32\u884c\u63a5\u53e3\uff0c\u4ece\u7269\u7406\u5c42\u9762\u6765\u770b\u5b83\u4e0ePCI\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u603b\u7ebf\uff0c\u4f46\u662f\u5b83\u5728\u8f6f\u4ef6\u5c42\u9762\u4fdd\u7559\u4e86\u5bf9PCI\u7684\u5411\u540e\u517c\u5bb9\u6027\u3002</p> <p>\u8fd9\u4e2a\u65b0\u6a21\u578b\uff0c\u5c31\u662f\u6211\u4eec\u6240\u77e5\u9053\u7684PCI Express\uff08PCIe\uff09\u3002</p>"},{"location":"pcie/all/#chapter-2-pcie-architecture-overview-pcie","title":"Chapter 2      PCIe Architecture Overview //PCIe\u4f53\u7cfb\u7ed3\u6784\u6982\u8ff0","text":""},{"location":"pcie/all/#_3","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u524d\u4e00\u7ae0\u8282\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86PCI\u6280\u672f\u53d1\u5c55\u7684\u5386\u53f2\uff0c\u4ee5\u6b64\u6765\u5efa\u7acb\u66f4\u597d\u7684\u7406\u89e3PCIe\u7684\u57fa\u7840\u3002\u5b83\u4e3b\u8981\u4e86\u56de\u987ePCI\u4e0ePCI-X1.0/2.0\u7684\u57fa\u7840\u5185\u5bb9\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u7ed9\u63a5\u4e0b\u6765\u5bf9PCIe\u7684\u6982\u8ff0\u5185\u5bb9\u63d0\u4f9b\u4e00\u4e9b\u5185\u5bb9\u4e0a\u7684\u524d\u56e0\u540e\u679c\uff0c\u66f4\u65b9\u4fbf\u5bf9PCIe\u8fdb\u884c\u7406\u89e3\u3002</p>"},{"location":"pcie/all/#_4","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5bf9PCI Express\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u4e86\u5168\u9762\u7684\u4ecb\u7ecd\uff0c\u65e8\u5728\u5c06\u672c\u7ae0\u4f5c\u4e3a\u4e00\u4e2a\u201c\u6267\u884c\u5c42\u201d\u6982\u8ff0\uff0c\u6db5\u76d6\u8be5\u4f53\u7cfb\u7ed3\u6784\u5728\u9ad8\u5c42\u7684\u6240\u6709\u57fa\u7840\u77e5\u8bc6\u3002\u5b83\u4ecb\u7ecd\u4e86PCIe\u534f\u8bae\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u5206\u5c42\u7684\u65b9\u6cd5\uff0c\u5e76\u63cf\u8ff0\u4e86\u6bcf\u4e2a\u5c42\u7ea7\u7684\u804c\u8d23\u4f5c\u7528\u3002\u4ecb\u7ecd\u4e86\u5404\u79cd\u6570\u636e\u5305\u7c7b\u578b\u7684\u540c\u65f6\u4e5f\u4e00\u8d77\u4ecb\u7ecd\u4e86\u7528\u4e8e\u901a\u4fe1\u548c\u589e\u5f3a\u4f20\u8f93\u53ef\u9760\u6027\u7684\u534f\u8bae\u3002</p>"},{"location":"pcie/all/#_5","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u4ecb\u7ecd\u4e86PCI Express\u73af\u5883\u4e2d\u7684\u914d\u7f6e\u90e8\u5206\u3002\u5b83\u5305\u62ec\u7528\u4e8e\u5b9e\u73b0Function\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u7a7a\u95f4\uff0c\u4e00\u4e2aFunction\u5982\u4f55\u5728\u603b\u7ebf\u4e0a\u88ab\u53d1\u73b0\uff0c\u914d\u7f6e\u4e8b\u52a1\u662f\u5982\u4f55\u88ab\u751f\u6210\u548c\u8def\u7531\u5230\u6b63\u786e\u7684\u4f4d\u7f6e\uff0cPCI\u517c\u5bb9\u7a7a\u95f4\u4e0ePCIe\u6269\u5c55\u7a7a\u95f4\u4e4b\u95f4\u7684\u5dee\u5f02\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u662f\u5982\u4f55\u533a\u5206Endpoint\uff08EP\uff0c\u7aef\u70b9\uff09\u548cBridge\u3002</p>"},{"location":"pcie/all/#21-pci-express","title":"2.1 PCI Express\u7b80\u4ecb","text":"<p>PCI Express\u7684\u51fa\u73b0\u4ee3\u8868\u4e86\u5176\u524d\u8eab\u5e76\u884c\u603b\u7ebf\u7684\u91cd\u5927\u8f6c\u53d8\u3002\u4f5c\u4e3a\u4e00\u79cd\u4e32\u884c\u603b\u7ebf\uff0c\u5b83\u4e0e\u65e9\u671f\u7684\u4e32\u884c\u8bbe\u8ba1\uff08\u4f8b\u5982InfiniBand\u6216\u8005Fibre Channel\uff09\u6709\u8bb8\u591a\u7684\u5171\u540c\u70b9\uff0c\u4f46\u662f\u5b83\u4ecd\u7136\u4fdd\u6301\u4e86\u5728\u8f6f\u4ef6\u5c42\u9762\u5bf9PCI\u7684\u5411\u540e\u517c\u5bb9\u3002</p> <p>\u6b63\u5982\u8bb8\u591a\u9ad8\u901f\u4e32\u884c\u4f20\u8f93\u65b9\u6cd5\u4e00\u6837\uff0cPCIe\u4f7f\u7528\u53cc\u5411\u8fde\u63a5\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5728\u540c\u4e00\u65f6\u95f4\u540c\u65f6\u8fdb\u884c\u4fe1\u606f\u7684\u6536\u53d1\u64cd\u4f5c\uff08\u5373\u533a\u5206\u5f00\u4e86TX\u3001RX\uff0c\u800c\u4e0d\u662f\u50cfPCI\u4e00\u6837\u5728\u540c\u4e00\u6839\u7ebf\u4e0a\u4f5c\u4e3ainout\uff09\u3002\u8fd9\u79cd\u6a21\u578b\u88ab\u79f0\u4e3a\u53cc\u5355\u5de5\u8fde\u63a5\uff08Dual-simplex connection\uff09\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u63a5\u53e3\u90fd\u6709\u4e00\u4e2a\u5355\u5de5\u53d1\u9001\u8def\u5f84\u548c\u4e00\u4e2a\u5355\u5de5\u63a5\u6536\u8def\u5f84\uff0c\u56fe 2\u20111\u5c55\u793a\u4e86\u8fd9\u79cd\u6a21\u578b\u3002\u56e0\u4e3a\u6570\u636e\u6d41\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u53cc\u5411\u4f20\u8f93\uff0c\u56e0\u6b64\u5728\u6280\u672f\u5c42\u9762\u4e0a\u6765\u8bf4\u4e24\u4e2a\u8bbe\u5907\u95f4\u7684\u901a\u4fe1\u5176\u5b9e\u662f\u5168\u53cc\u5de5\u7684\uff0c\u4f46\u662fPCIe\u534f\u8bae\u89c4\u8303\u4f9d\u7136\u4f7f\u7528\u53cc\u5355\u5de5\u8fd9\u4e2a\u672f\u8bed\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u79cd\u79f0\u547c\u5bf9\u5b9e\u9645\u901a\u4fe1\u4fe1\u9053\u4e5f\u8fdb\u884c\u4e86\u4e00\u70b9\u63cf\u8ff0\uff0c\u5373\u901a\u4fe1\u4fe1\u9053\u7531\u4e24\u4e2a\u65b9\u5411\u7684\u5404\u81ea\u7684\u5355\u5de5\u4fe1\u9053\u7ec4\u6210\u3002</p> <p></p> <p>\u56fe 2\u20111\u53cc\u5355\u5de5\u94fe\u8def</p> <p>\u7528\u4e8e\u63cf\u8ff0\u8bbe\u5907\u4e4b\u95f4\u4fe1\u53f7\u4f20\u8f93\u8def\u5f84\u7684\u672f\u8bed\u4e3a\u201c\u94fe\u8def\uff08Link\uff09\u201d\uff0c\u5b83\u7531\u4e00\u4e2a\u6216\u4ee5\u4e0a\u7684\u63a5\u6536\u53d1\u9001\u5bf9\u7ec4\u6210\u3002\u8fd9\u6837\u7684\u4e00\u5bf9\u63a5\u6536\u548c\u53d1\u9001\u88ab\u79f0\u4e3a\u4e00\u4e2a\u201c\u901a\u9053\uff08Lane\uff09\u201d\uff0c\u534f\u8bae\u89c4\u8303\u5141\u8bb8\u4e00\u6761\u94fe\u8def\u5185\u67091\u30012\u30014\u30018\u300112\u300116\u621632\u4e2aLane\u3002\u94fe\u8def\u5185Lane\u7684\u6570\u91cf\u79f0\u4e3a\u94fe\u8def\u5bbd\u5ea6\uff0c\u901a\u5e38\u7528x1\u3001x2\u3001x4\u3001x8\u3001x16\u4ee5\u53cax32\u6765\u8fdb\u884c\u8868\u793a\u3002\u7528\u4e8e\u6743\u8861\u5728\u5b9e\u9645\u8bbe\u8ba1\u4e2d\u4f7f\u7528\u591a\u5c11Lane\u7684\u601d\u8def\u5176\u5b9e\u5f88\u7b80\u5355\uff1a\u4f7f\u7528\u66f4\u591a\u7684Lane\u53ef\u4ee5\u589e\u52a0\u5e26\u5bbd\uff0c\u4f46\u662f\u4e5f\u4f1a\u589e\u52a0\u6210\u672c\u3001\u589e\u52a0\u7a7a\u95f4\u5360\u7528\u4ee5\u53ca\u589e\u52a0\u529f\u8017\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u9605\u8bfb\u201cLinks and Lanes\uff08\u94fe\u8def\u4e0e\u901a\u9053\uff09\u201d\u8fd9\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 2\u20112\u4e00\u4e2aLane\uff08\u901a\u9053\uff09</p>"},{"location":"pcie/all/#211-software-backward-compatibility","title":"2.1.1     \u8f6f\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\uff08Software Backward Compatibility\uff09","text":"<p>PCIe\u8bbe\u8ba1\u76ee\u6807\u4e2d\u6781\u4e3a\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\u8981\u4fdd\u6301\u5bf9PCI\u8f6f\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\u3002\u5982\u679c\u4e00\u4e2a\u8bbe\u8ba1\u4f7f\u7528\u7684\u662f\u73b0\u6709\u7684\u7cfb\u7edf\uff0c\u800c\u4e14\u8fd9\u4e2a\u8bbe\u8ba1\u5df2\u7ecf\u80fd\u591f\u5728\u8fd9\u4e2a\u73b0\u6709\u7cfb\u7edf\u4e2d\u6b63\u5e38\u5de5\u4f5c\uff0c\u90a3\u4e48\u60f3\u8981\u4fc3\u4f7f\u5b83\u8f6c\u5411\u4f7f\u7528\u53e6\u4e00\u79cd\u7cfb\u7edf\u5219\u9700\u8981\u6ee1\u8db3\u4e24\u4ef6\u4e8b\uff1a\u7b2c\u4e00\uff0c\u65b0\u6280\u672f\u8981\u6709\u8db3\u591f\u5438\u5f15\u4eba\u7684\u6027\u80fd\u63d0\u5347\uff0c\u7b2c\u4e8c\uff0c\u5c3d\u53ef\u80fd\u51cf\u5c0f\u4ece\u6765\u6280\u672f\u8fc1\u79fb\u5230\u65b0\u6280\u672f\u65f6\u7684\u6210\u672c\u3001\u98ce\u9669\u4ee5\u53ca\u5de5\u4f5c\u91cf\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u70b9\u6765\u8bf4\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u901a\u5e38\u7684\u505a\u6cd5\u662f\u8ba9\u90a3\u4e9b\u4e3a\u65e7\u6a21\u578b\u6240\u7f16\u5199\u7684\u8f6f\u4ef6\u5728\u65b0\u6a21\u578b\u4e2d\u4f9d\u7136\u53ef\u7528\u3002\u4e3a\u4e86\u5728PCIe\u4e2d\u505a\u5230\u8fd9\u4e00\u70b9\uff0cPCI\u4e2d\u6240\u7528\u5230\u7684\u6240\u6709\u7684\u5730\u5740\u7a7a\u95f4\u8981\u4e48\u4e0d\u505a\u66f4\u6539\u4fbf\u76f4\u63a5\u7167\u642c\uff0c\u8981\u4e48\u4ec5\u4ec5\u8fdb\u884c\u4e86\u4e86\u7b80\u5355\u7684\u6269\u5c55\u3002Memory\u3001IO\u548c\u914d\u7f6e\u7a7a\u95f4\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u4f9d\u7136\u662f\u53ef\u89c1\u7684\uff0c\u800c\u4e14\u8fde\u5199\u5165\u65b9\u5f0f\u90fd\u548c\u4ee5\u524d\u4e00\u6837\u3002\u56e0\u6b64\u5c31\u7b97\u662f\u6570\u5e74\u524d\u4e3aPCI\u800c\u5199\u7684\u8f6f\u4ef6\uff08BIOS\u4ee3\u7801\u3001\u8bbe\u5907\u9a71\u52a8\u7b49\u7b49\uff09\u5c06\u4f9d\u7136\u53ef\u4ee5\u5728\u73b0\u5728\u7684PCIe\u8bbe\u5907\u4e0a\u4f7f\u7528\u3002\u914d\u7f6e\u7a7a\u95f4\u5df2\u7ecf\u88ab\u5927\u5927\u7684\u6269\u5c55\uff0c\u6dfb\u52a0\u4e86\u8bb8\u591a\u65b0\u7684\u5bc4\u5b58\u5668\u6765\u652f\u6301\u65b0\u7684\u529f\u80fd\uff0c\u4f46\u662f\u8001\u7684\u5bc4\u5b58\u5668\u4f9d\u7136\u5b58\u5728\u4e14\u53ef\u4ee5\u6309\u7167\u5e38\u89c4\u65b9\u5f0f\u6765\u8bbf\u95ee\u4ed6\u4eec\uff08\u8fd9\u90e8\u5206\u7684\u8be6\u7ec6\u5185\u5bb9\u89c1\u201cSoftware Compatibility Characteristic\u8f6f\u4ef6\u517c\u5bb9\u6027\u7279\u6027\u201d\uff09\u3002</p>"},{"location":"pcie/all/#212-serial-transport","title":"2.1.2     \u4e32\u884c\u4f20\u8f93\uff08Serial Transport\uff09","text":""},{"location":"pcie/all/#2121-the-need-for-speed","title":"2.1.2.1   \u5bf9\u4f20\u8f93\u901f\u7387\u7684\u9700\u6c42\uff08The Need for Speed\uff09","text":"<p>\u5f88\u660e\u663e\uff0c\u4e32\u884c\u4f20\u8f93\u6a21\u578b\u5fc5\u987b\u8981\u6bd4\u5e76\u884c\u7684\u8bbe\u8ba1\u8dd1\u7684\u5feb\u5f88\u591a\u624d\u80fd\u8fbe\u5230\u76f8\u540c\u7684\u5e26\u5bbd\uff0c\u8fd9\u662f\u56e0\u4e3a\u4e32\u884c\u4f20\u8f93\u4e00\u6b21\u53ea\u53d1\u90011bit\u6570\u636e\u3002\u7136\u800c\uff0c\u4e8b\u5b9e\u8bc1\u660e\u8fd9\u5e76\u4e0d\u56f0\u96be\uff0c\u8fc7\u53bb\u7684PCIe\u57282.5GT/s\u548c5.0GT/s\u90fd\u80fd\u7a33\u5b9a\u7684\u5de5\u4f5c\u3002\u4e4b\u6240\u4ee5PCIe\u53ef\u4ee5\u8fbe\u5230\u8fd9\u6837\u7684\u901f\u7387\uff0c\u751a\u81f3\u8fbe\u5230\u66f4\u9ad8\u76848GT/s\uff0c\u662f\u56e0\u4e3a\u4e32\u884c\u4f20\u8f93\u6a21\u578b\u514b\u670d\u4e86\u5e76\u884c\u6a21\u578b\u7684\u4e0d\u8db3\u3002</p> <p>l \u514b\u670d\u95ee\u9898</p> <p>\u901a\u8fc7\u56de\u987e\u5e76\u884c\u603b\u7ebf\u7684\u5185\u5bb9\u6211\u4eec\u77e5\u9053\uff0c\u5b83\u7684\u6027\u80fd\u88ab\u4e00\u4e9b\u95ee\u9898\u6240\u9650\u5236\uff0c\u5982\u56fe 2\u20113\u5c55\u793a\u4e86\u5176\u4e2d\u7684\u4e09\u4e2a\u95ee\u9898\u3002\u9996\u5148\u56de\u60f3\u4e00\u4e0b\uff0c\u5e76\u884c\u603b\u7ebf\u4f7f\u7528\u516c\u5171\u65f6\u949f\uff08common clock\uff09\uff1b\u4fe1\u53f7\u5728\u4e00\u4e2a\u65f6\u949f\u6cbf\u88ab\u8f93\u51fa\uff0c\u7136\u540e\u5728\u4e0b\u4e00\u4e2a\u65f6\u949f\u6cbf\u88ab\u63a5\u6536\u65b9\u63a5\u6536\u3002\u8fd9\u4e2a\u6a21\u578b\u7684\u7b2c\u4e00\u4e2a\u95ee\u9898\u6765\u81ea\u4e8e\u4fe1\u53f7\u4ece\u53d1\u9001\u7aef\u4f20\u8f93\u5230\u63a5\u6536\u7aef\u6240\u82b1\u8d39\u7684\u65f6\u95f4\uff0c\u79f0\u4e3a\u6e21\u8d8a\u65f6\u95f4\u3002\u6e21\u8d8a\u65f6\u95f4\u5fc5\u987b\u5c0f\u4e8e\u4e00\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u5426\u5219\u5c06\u4f1a\u51fa\u95ee\u9898\uff0c\u8fd9\u4f7f\u5f97\u96be\u4ee5\u901a\u8fc7\u7ee7\u7eed\u51cf\u5c0f\u65f6\u949f\u5468\u671f\u6765\u63d0\u5347\u901f\u5ea6\u3002\u56e0\u4e3a\u82e5\u9700\u8981\u7ee7\u7eed\u51cf\u5c0f\u65f6\u949f\u5468\u671f\uff0c\u4e3a\u4e86\u8ba9\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u4f9d\u7136\u5c0f\u4e8e\u65f6\u949f\u5468\u671f\uff0c\u9700\u8981\u5e03\u7ebf\u66f4\u77ed\u5e76\u51cf\u5c11\u8d1f\u8f7d\u7684\u8bbe\u5907\u6570\u91cf\uff0c\u4f46\u662f\u6700\u7ec8\u8fd9\u6837\u7684\u505a\u6cd5\u90fd\u4f1a\u5230\u8fbe\u6781\u9650\uff0c\u5728\u5b9e\u9645\u60c5\u51b5\u4e0b\u53d8\u5f97\u65e0\u6cd5\u8fbe\u5230\u3002\u7b2c\u4e8c\u4e2a\u9020\u6210\u5e76\u884c\u6a21\u578b\u6027\u80fd\u53d7\u9650\u7684\u56e0\u7d20\u662f\u4f7f\u7528\u516c\u5171\u65f6\u949f\u65f6\uff0c\u65f6\u949f\u5230\u8fbe\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u7684\u65f6\u523b\u4e0d\u4e00\u81f4\uff0c\u8fd9\u79f0\u4e3a\u65f6\u949f\u6b6a\u659c\u3002PCB\u5e03\u7ebf\u8bbe\u8ba1\u4eba\u5458\u5c3d\u529b\u53bb\u51cf\u5c0f\u65f6\u949f\u6b6a\u659c\u7684\u503c\uff0c\u56e0\u4e3a\u65f6\u949f\u6b6a\u659c\u5c06\u4f1a\u964d\u4f4e\u4fe1\u53f7\u4f20\u8f93\u65f6\u95f4\u9884\u7b97\uff0c\u4f46\u662f\u8fd9\u79cd\u6b6a\u659c\u6c38\u8fdc\u65e0\u6cd5\u5f7b\u5e95\u6d88\u9664\u3002\u7b2c\u4e09\u4e2a\u56e0\u7d20\u662f\u4fe1\u53f7\u6b6a\u659c\uff0c\u5b83\u6307\u7684\u662f\u591abit\u4f4d\u5bbd\u6570\u636e\u7684\u5404\u4e2abit\u5230\u8fbe\u63a5\u6536\u7aef\u7684\u65f6\u523b\u5b58\u5728\u5dee\u5f02\u3002\u663e\u7136\uff0c\u8fd9\u6837\u7684\u591abit\u4f4d\u5bbd\u6570\u636e\u5728\u6240\u6709\u7684bit\u90fd\u5230\u8fbe\u4e14\u7a33\u5b9a\u4e4b\u524d\u90fd\u4e0d\u80fd\u88ab\u63a5\u6536\u65b9\u91c7\u6837\uff0c\u8fd9\u4f7f\u5f97\u6211\u4eec\u5fc5\u987b\u53bb\u7b49\u5f85\u6700\u6162\u7684\u90a3\u4e00bit\u3002</p> <p></p> <p>\u56fe 2\u20113 \u5e76\u884c\u603b\u7ebf\u7684\u5c40\u9650</p> <p>PCIe\u8fd9\u6837\u7684\u4e32\u884c\u4f20\u8f93\u65b9\u6cd5\u662f\u5982\u4f55\u5904\u7406\u8fd9\u4e9b\u95ee\u9898\u7684\u5462\uff1f\u9996\u5148\uff0c\u4fe1\u53f7\u6e21\u8d8a\u65f6\u95f4\u5c06\u4e0d\u518d\u662f\u4e00\u4e2a\u95ee\u9898\uff0c\u56e0\u4e3a\u7528\u4e8e\u6307\u793a\u63a5\u6536\u7aef\u9501\u5b58\u6570\u636e\u7684\u65f6\u949f\u73b0\u5728\u5df2\u7ecf\u88ab\u5185\u7f6e\u5165\u6570\u636e\u6d41\u4e2d\uff0c\u4e0d\u5728\u9700\u8981\u989d\u5916\u4f20\u8f93\u7ebf\u6765\u4f20\u8f93\u53c2\u8003\u65f6\u949f\u3002\u56e0\u6b64\uff0c\u65e0\u8bba\u518d\u5c0f\u7684\u65f6\u949f\u5468\u671f\u6216\u662f\u518d\u957f\u7684\u4fe1\u53f7\u4f20\u8f93\u65f6\u95f4\u90fd\u4e0d\u4f1a\u4ea7\u751f\u4ee5\u524d\u7684\u95ee\u9898\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3a\u5185\u7f6e\u5728\u6570\u636e\u6d41\u4e2d\u7684\u65f6\u949f\u5fc5\u7136\u80fd\u4e0e\u6570\u636e\u4e00\u8d77\u5230\u8fbe\u63a5\u6536\u65b9\u3002\u540c\u6837\u5730\uff0c\u65f6\u949f\u6b6a\u659c\u7684\u95ee\u9898\u5c06\u4e0d\u518d\u5b58\u5728\uff0c\u8fd9\u8fd8\u662f\u56e0\u4e3a\u65f6\u949f\u88ab\u5185\u7f6e\u5165\u6570\u636e\u6d41\u4e2d\uff0c\u63a5\u6536\u65b9\u901a\u8fc7\u6062\u590d\u51fa\u6570\u636e\u6d41\u4e2d\u7684\u65f6\u949f\u6765\u8fdb\u884c\u6570\u636e\u91c7\u6837\uff0c\u81ea\u7136\u4e0d\u5b58\u5728\u65f6\u949f\u6b6a\u659c\u7684\u95ee\u9898\u3002\u6700\u540e\uff0c\u4fe1\u53f7\u6b6a\u659c\u7684\u95ee\u9898\u5728\u4e00\u4e2aLane\uff08\u901a\u9053\uff09\u5185\u88ab\u6d88\u9664\u4e86\uff0c\u56e0\u4e3a\u4e00\u4e2aLane\u4e00\u6b21\u53ea\u4f20\u8f931bit\u6570\u636e\u3002\u5728\u591a\u901a\u9053\u8bbe\u8ba1\u4e2d\uff0c\u867d\u7136\u4fe1\u53f7\u6b6a\u659c\u7684\u95ee\u9898\u518d\u6b21\u51fa\u73b0\u4e86\uff0c\u4f46\u662f\u63a5\u6536\u7aef\u5c06\u81ea\u52a8\u5bf9\u5176\u8fdb\u884c\u7ea0\u6b63\uff0c\u5b83\u53ef\u4ee5\u4fee\u590d\u5927\u91cf\u6b6a\u659c\u3002\u867d\u7136\u4e32\u884c\u8bbe\u8ba1\u514b\u670d\u4e86\u5e76\u884c\u6a21\u578b\u7684\u8bb8\u591a\u95ee\u9898\uff0c\u4f46\u662f\u4e32\u884c\u8bbe\u8ba1\u81ea\u8eab\u4e5f\u6709\u4e00\u7cfb\u5217\u7684\u590d\u6742\u95ee\u9898\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u7a0d\u540e\u5c06\u770b\u5230\uff0c\u5bf9\u8fd9\u4e9b\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u6613\u4e8e\u63a7\u5236\u7684\uff0c\u5e76\u53ef\u4ee5\u8ba9\u6211\u4eec\u505a\u5230\u9ad8\u901f\u7684\u3001\u53ef\u9760\u7684\u901a\u4fe1\u3002</p> <p>l \u5e26\u5bbd</p> <p>PCIe\u652f\u6301\u7684\u9ad8\u901f\u4e14\u542b\u6709\u591aLane\uff08\u901a\u9053\uff09\u7684\u94fe\u8def\u5e26\u6765\u4e86\u50b2\u4eba\u7684\u5e26\u5bbd\u6570\u503c\uff0c\u5982\u8868 2\u20111\u6240\u793a\u3002\u8fd9\u4e9b\u6570\u5b57\u90fd\u6765\u6e90\u4e8e\u6bd4\u7279\u7387\u4e0e\u603b\u7ebf\u7279\u6027\u3002\u5176\u4e2d\u4e00\u79cd\u7279\u6027\u4e0e\u5176\u4ed6\u8bb8\u591a\u4e32\u884c\u4f20\u8f93\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u90a3\u5c31\u662fPCIe\u7684\u524d\u4e24\u4ee3\u7248\u672c\u4e2d\u4f7f\u7528\u4e86\u88ab\u79f0\u4e3a8b/10b\u7684\u7f16\u7801\u8fc7\u7a0b\uff0c\u8fd9\u79cd\u7f16\u7801\u8fc7\u7a0b\u4f1a\u6839\u636e8bit\u7684\u8f93\u5165\u800c\u751f\u621010bit\u7684\u8f93\u51fa\u3002\u5c3d\u7ba1\u8fd9\u6837\u505a\u4f1a\u5f15\u8d77\u4e00\u4e9b\u5f00\u9500\uff0c\u4f46\u662f\u6709\u51e0\u4e2a\u5f88\u597d\u7684\u7406\u7531\u652f\u6301\u6211\u4eec\u8fd9\u6837\u505a\uff0c\u6211\u4eec\u5c06\u4f1a\u5728\u540e\u9762\u8bb2\u5230\u3002\u5bf9\u4e8e\u73b0\u5728\u6765\u8bf4\uff0c\u53ea\u9700\u8981\u77e5\u9053\u5bf9\u4e8e8b/10b\u7f16\u7801\u6765\u8bf4\uff0c\u8981\u53d1\u90011Byte\u7684\u6570\u636e\u5b9e\u9645\u9700\u8981\u4f20\u900110bit\u3002\u7b2c\u4e00\u4ee3PCIe\uff08\u79f0\u4e3aGen1\u6216\u8005PCIe\u534f\u8bae\u89c4\u8303\u7248\u672c1.x\uff09\u4e2d\uff0c\u6bd4\u7279\u7387\u4e3a2.5GT/s\uff0c\u5c06\u5b83\u9664\u4ee510\u5373\u53ef\u5f97\u77e5\u4e00\u4e2aLane\uff08\u901a\u9053\uff09\u7684\u901f\u7387\u5c06\u53ef\u4ee5\u8fbe\u52300.25GB/s\u3002\u56e0\u4e3a\u94fe\u8def\u53ef\u4ee5\u5728\u540c\u4e00\u65f6\u523b\u8fdb\u884c\u53d1\u9001\u548c\u63a5\u6536\uff0c\u56e0\u6b64\u805a\u5408\u5e26\u5bbd\u53ef\u4ee5\u8fbe\u5230\u8fd9\u4e2a\u6570\u503c\u7684\u4e24\u500d\uff0c\u5373\u6bcf\u4e2aLane\uff08\u901a\u9053\uff09\u8fbe\u52300.5GB/s\u3002\u7b2c\u4e8c\u4ee3PCIe\uff08\u79f0\u4e3aGen2\u6216\u8005PCIe 2.x\uff09\u4e2d\u5c06\u603b\u7ebf\u9891\u7387\u7ffb\u500d\uff0c\u8fd9\u4e5f\u4f7f\u5f97\u5b83\u7684\u5e26\u5bbd\u76f8\u8f83\u4e8eGen1\u7ffb\u500d\u3002\u7b2c\u4e09\u4ee3PCIe\uff08\u79f0\u4e3aGen3\u6216\u8005PCIe 3.0\uff09\u518d\u6b21\u8ba9\u5e26\u5bbd\u7ffb\u500d\uff0c\u4f46\u662f\u8fd9\u6b21\u534f\u8bae\u7684\u5236\u5b9a\u8005\u4eec\u5e76\u6ca1\u6709\u9009\u62e9\u5c06\u9891\u7387\u7ffb\u500d\u3002\u76f8\u53cd\uff0c\u51fa\u4e8e\u4e00\u4e9b\u539f\u56e0\uff08\u6211\u4eec\u7a0d\u540e\u5c06\u4f1a\u8fdb\u884c\u8ba8\u8bba\uff09\uff0c\u4ed6\u4eec\u4ec5\u5c06\u9891\u7387\u63d0\u5347\u52308GT/s\uff08Gen2\u4e2d\u662f5GT/s\uff0c\u672a\u7ffb\u500d\uff09\uff0c\u5e76\u4e0d\u518d\u91c7\u75288b/10b\u7684\u7f16\u7801\u65b9\u5f0f\uff0c\u800c\u662f\u91c7\u7528\u4e86\u53e6\u4e00\u79cd\u7f16\u7801\u673a\u5236\uff0c\u5373128b/130b\u7f16\u7801\uff08\u5173\u4e8e\u8fd9\u4e2a\u5185\u5bb9\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53ef\u4ee5\u9605\u8bfb\u201cPhysical Layer-Logical\uff08Gen3\uff09\u201d\u7ae0\u8282\uff09\u3002\u8868 2\u20111\u5217\u51fa\u4e86\u5f53\u524d\u51e0\u4ee3PCIe\u7684\u5404\u79cdLane\uff08\u901a\u9053\uff09\u6570\u91cf\u60c5\u51b5\u4e0b\u7684\u5e26\u5bbd\uff0c\u5c55\u793a\u51fa\u4e86\u94fe\u8def\u5bf9\u5e94\u60c5\u51b5\u4e0b\u7684\u5cf0\u503c\u541e\u5410\u91cf\u3002</p> <p></p> <p>\u8868 2\u20111 PCIe Gen1,Gen2,Gen3\u7684\u5404\u79cd\u94fe\u8def\u5bbd\u5ea6\u4e0b\u7684\u5e26\u5bbd\u6c47\u603b</p>"},{"location":"pcie/all/#2122-pcie","title":"2.1.2.2   PCIe\u5e26\u5bbd\u8ba1\u7b97\u65b9\u6cd5","text":"<p>\u8981\u8ba1\u7b97\u4e0a\u8ff0\u8868\u683c\u4e2d\u7684PCIe\u5e26\u5bbd\u5927\u5c0f\uff0c\u53ef\u4ee5\u53c2\u7167\u5982\u4e0b\u7684\u8ba1\u7b97\u65b9\u6cd5\u3002</p> <p>n Gen1 PCIe\u5e26\u5bbd=\uff082.5Gb/s x 2 directions\uff09/10bits per symbol=0.5GB/s</p> <p>n Gen2 PCIe\u5e26\u5bbd=\uff085.0Gb/s x 2 directions\uff09/10bits per symbol=1.0GB/s</p> <p>\u9700\u8981\u6ce8\u610f\uff0c\u4e0a\u8ff0\u8ba1\u7b97\u4e2d\uff0c\u6211\u4eec\u662f\u9664\u4ee510bit\u800c\u4e0d\u662f8bit\uff081Byte\uff09\uff0c\u8fd9\u662f\u56e0\u4e3aGen1\u548cGen2\u7684\u534f\u8bae\u4e2d\u8981\u6c42\u5c06Byte\u8fdb\u884c8b/10b\u7f16\u7801\u540e\u5c01\u88c5\u4e3a10bit\uff0c\u7136\u540e\u624d\u8fdb\u884c\u6570\u636e\u5305\u7684\u4f20\u8f93\uff0c\u56e0\u6b64\u539f\u6570\u636e\u4e2d\u76841Byte\u5728\u5b9e\u9645\u4f20\u8f93\u65f6\u5176\u5b9e\u662f\u9700\u8981\u4f20\u8f9310bit\u3002</p> <p>n Gen3 PCIe\u5e26\u5bbd=\uff082.0Gb/s x 2 directions\uff09/8bits per byte=2.0GB/s</p> <p>\u6ce8\u610f\u5230\u5728Gen3\u901f\u7387\u7684\u8ba1\u7b97\u4e2d\uff0c\u6211\u4eec\u9664\u4ee5\u7684\u662f8bit\u800c\u4e0d\u518d\u662f10bit\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3aGen3\u4e2d\u5e76\u4e0d\u518d\u4f7f\u75288b/10b\u7f16\u7801\u65b9\u5f0f\uff0c\u800c\u662f128b/130b\u7f16\u7801\u65b9\u5f0f\u3002\u8fd9\u79cd\u7f16\u7801\u65b9\u5f0f\u6bcf128bit\u5f15\u51652bit\u5f00\u9500\uff0c\u8fd9\u4e2a\u5f00\u9500\u975e\u5e38\u5c0f\u4ee5\u81f3\u4e8e\u6211\u4eec\u6682\u4e14\u53ef\u4ee5\u5c06\u5b83\u5728\u6211\u4eec\u7684\u8ba1\u7b97\u4e2d\u5ffd\u7565\u3002</p> <p>\u4e0a\u8ff0\u4e09\u79cd\u65b9\u6cd5\u8ba1\u7b97\u51fa\u6765\u7684\u5e26\u5bbd\u53ea\u9700\u8981\u518d\u4e58\u4ee5\u94fe\u8def\u5bbd\u5ea6\u5373\u53ef\u5f97\u5230\u6574\u4e2a\u591aLane\uff08\u901a\u9053\uff09\u94fe\u8def\u7684\u94fe\u8def\u5e26\u5bbd\u3002</p>"},{"location":"pcie/all/#2123-pcie","title":"2.1.2.3   PCIe\u7684\u5dee\u5206\u4fe1\u53f7","text":"<p>\u6bcf\u4e2a\u901a\u9053\u90fd\u4f7f\u7528\u5dee\u5206\u4fe1\u53f7\u8fdb\u884c\u4f20\u8f93\uff0c\u5dee\u5206\u4fe1\u53f7\u662f\u6307\u6bcf\u6b21\u4f20\u8f93\u4e00\u4e2a\u4fe1\u53f7\u65f6\u540c\u65f6\u53d1\u9001\u5b83\u7684\u6b63\u4fe1\u53f7\u548c\u8d1f\u4fe1\u53f7\uff08D+\u548cD-\uff0c\u8fd9\u4e24\u79cd\u4fe1\u53f7\u632f\u5e45\u76f8\u540c\u76f8\u4f4d\u76f8\u53cd\uff09\uff0c\u5982\u56fe 2\u20114\u6240\u793a\u3002\u5f53\u7136\uff0c\u8fd9\u6837\u4f1a\u5c06\u5f15\u811a\u589e\u52a0\u4e00\u500d\uff0c\u4f46\u662f\u76f8\u5bf9\u4e8e\u5355\u7aef\u4fe1\u53f7\u800c\u8a00\uff0c\u5dee\u5206\u4fe1\u53f7\u5728\u9ad8\u901f\u4f20\u8f93\u4e0a\u7684\u4e24\u4e2a\u660e\u663e\u7684\u4f18\u70b9\u8db3\u4ee5\u62b5\u6d88\u5176\u5f15\u811a\u6570\u65b9\u9762\u7684\u4e0d\u8db3\uff1a\u5b83\u63d0\u9ad8\u4e86\u566a\u58f0\u5bb9\u9650\uff0c\u5e76\u964d\u4f4e\u4e86\u4fe1\u53f7\u7535\u538b\u3002</p> <p>\u5dee\u5206\u4fe1\u53f7\u7684\u63a5\u6536\u7aef\u5c06\u4f1a\u63a5\u6536\u8fd9\u4e00\u5bf9\u76f8\u4f4d\u76f8\u53cd\u7684\u4fe1\u53f7\uff0c\u7528\u6b63\u4fe1\u53f7\u7684\u7535\u538b\u51cf\u53bb\u5176\u53cd\u76f8\u4fe1\u53f7\u7684\u7535\u538b\uff0c\u5f97\u5230\u5b83\u4eec\u7684\u5dee\u503c\uff0c\u4ee5\u6b64\u6765\u5224\u5b9a\u8fd91bit\u7684\u903b\u8f91\u7535\u5e73\u503c\u3002\u5dee\u5206\u4f20\u8f93\u8bbe\u8ba1\u5185\u7f6e\u4e86\u6297\u566a\u58f0\u5e72\u6270\u7684\u8bbe\u8ba1\uff0c\u56e0\u4e3a\u5b83\u8981\u6c42\u6210\u5bf9\u7684\u5dee\u5206\u4fe1\u53f7\u5fc5\u987b\u4f4d\u4e8e\u6bcf\u4e2a\u8bbe\u5907\u7684\u76f8\u90bb\u7684\u5f15\u811a\u4e0a\uff0c\u5b83\u4eec\u7684\u8d70\u70b9\u4e5f\u5fc5\u987b\u5f7c\u6b64\u975e\u5e38\u9760\u8fd1\uff0c\u4ee5\u4fdd\u6301\u5408\u9002\u7684\u4f20\u8f93\u7ebf\u963b\u6297\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u56e0\u7d20\u5728\u5f71\u54cd\u5dee\u5206\u5bf9\u4e2d\u7684\u4e00\u4e2a\u4fe1\u53f7\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u540c\u7b49\u7a0b\u5ea6\u4e14\u540c\u6837\u65b9\u5411\u5730\u5f71\u54cd\u5230\u53e6\u4e00\u4e2a\u4fe1\u53f7\u3002\u4f46\u662f\u63a5\u6536\u7aef\u6240\u5728\u610f\u7684\u662f\u5b83\u4eec\u7684\u5dee\u503c\uff0c\u800c\u8fd9\u4e9b\u566a\u58f0\u5e72\u6270\u5e76\u4e0d\u4f1a\u6539\u53d8\u8fd9\u4e2a\u5dee\u503c\uff0c\u6240\u4ee5\u5e26\u6765\u7684\u7ed3\u679c\u5c31\u662f\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u566a\u58f0\u5bf9\u4fe1\u53f7\u7684\u5f71\u54cd\u5e76\u4e0d\u4f1a\u5f15\u8d77\u63a5\u6536\u7aef\u5bf9bit\u7684\u6b63\u786e\u5224\u522b\u3002</p> <p></p> <p>\u56fe 2\u20114 \u5dee\u5206\u4fe1\u53f7\u793a\u610f\u56fe</p>"},{"location":"pcie/all/#2124","title":"2.1.2.4   \u4e0d\u518d\u4f7f\u7528\u516c\u5171\u65f6\u949f","text":"<p>\u5728\u5148\u524d\u7684\u5185\u5bb9\u4e2d\u6709\u63d0\u5230\uff0cPCIe\u94fe\u8def\u4e0d\u518d\u50cfPCI\u4e00\u6837\u4f7f\u7528\u516c\u5171\u65f6\u949f\uff08common clock\uff09\uff0c\u5b83\u4f7f\u7528\u4e86\u4e00\u4e2a\u6e90\u540c\u6b65\u6a21\u578b\uff08source-synchronous\uff09,\u8fd9\u610f\u5473\u7740\u9700\u8981\u7531\u53d1\u9001\u7aef\u7ed9\u63a5\u6536\u7aef\u63d0\u4f9b\u4e00\u4e2a\u65f6\u949f\u6765\u7528\u4e8e\u5bf9\u8f93\u5165\u6570\u636e\u8fdb\u884c\u9501\u5b58\u91c7\u6837\u3002\u5bf9\u4e8ePCIe\u94fe\u8def\u6765\u8bf4\uff0c\u5e76\u4e0d\u542b\u6709\u8f6c\u53d1\u65f6\u949f\uff08forwarded clock\uff09\u3002\u76f8\u53cd\u5730\uff0c\u53d1\u9001\u7aef\u4f1a\u5c06\u65f6\u949f\u901a\u8fc78b/10b\u7f16\u7801\u6765\u5d4c\u5165\u6570\u636e\u6d41\u4e2d\uff0c\u7136\u540e\u63a5\u6536\u7aef\u5c06\u4f1a\u4ece\u6570\u636e\u6d41\u4e2d\u6062\u590d\u51fa\u8fd9\u4e2a\u65f6\u949f\uff0c\u5e76\u7528\u4e8e\u5bf9\u8f93\u5165\u6570\u636e\u8fdb\u884c\u9501\u5b58\u3002\u8fd9\u4e00\u8fc7\u7a0b\u542c\u8d77\u6765\u53ef\u80fd\u975e\u5e38\u795e\u79d8\uff0c\u4f46\u662f\u5176\u5b9e\u5f88\u7b80\u5355\u3002\u5728\u63a5\u6536\u7aef\u4e2d\uff0cPLL\u7535\u8def\uff08Phase-Locked Loop\u9501\u76f8\u73af\uff0c\u5982\u56fe 2\u20115\uff09\u5c06\u8f93\u5165\u7684\u6bd4\u7279\u6d41\u4f5c\u4e3a\u53c2\u8003\u65f6\u949f\uff0c\u5e76\u5c06\u5176\u65f6\u5e8f\u6216\u8005\u76f8\u4f4d\u4e0e\u4e00\u4e2a\u8f93\u51fa\u65f6\u949f\u76f8\u6bd4\u8f83\uff0c\u8fd9\u4e2a\u8f93\u51fa\u65f6\u949f\u662fPLL\u6309\u7167\u6307\u5b9a\u9891\u7387\u4ea7\u751f\u7684\u65f6\u949f\u3002\u4e5f\u5c31\u662f\u8bf4PLL\u81ea\u8eab\u4f1a\u4ea7\u751f\u4e00\u4e2a\u6307\u5b9a\u9891\u7387\u7684\u8f93\u51fa\u65f6\u949f\uff0c\u7136\u540e\u7528\u6bd4\u7279\u6d41\u4f5c\u4e3a\u7684\u53c2\u8003\u65f6\u949f\u4e0e\u81ea\u8eab\u4ea7\u751f\u7684\u8f93\u51fa\u65f6\u949f\u76f8\u6bd4\u8f83\u3002\u57fa\u4e8e\u6bd4\u8f83\u7684\u7ed3\u679c\uff0cPLL\u5c06\u4f1a\u5347\u9ad8\u6216\u8005\u964d\u4f4e\u8f93\u51fa\u65f6\u949f\u7684\u9891\u7387\uff0c\u76f4\u5230\u6240\u6bd4\u8f83\u7684\u53cc\u65b9\u8fbe\u5230\u5339\u914d\u3002\u6b64\u65f6\u5219\u53ef\u4ee5\u79f0PLL\u5df2\u9501\u5b9a\uff0c\u4e14\u8f93\u51fa\u65f6\u949f\uff08\u6062\u590d\u65f6\u949frecovered clock\uff09\u7684\u9891\u7387\u5df2\u7ecf\u7cbe\u786e\u5730\u4e0e\u53d1\u9001\u6570\u636e\u7684\u65f6\u949f\u76f8\u5339\u914d\u3002PLL\u5c06\u4f1a\u4e0d\u65ad\u5730\u8c03\u6574\u6062\u590d\u65f6\u949f\uff0c\u56e0\u6b64\u7531\u6e29\u5ea6\u3001\u7535\u538b\u56e0\u7d20\u5bf9\u53d1\u9001\u7aef\u65f6\u949f\u9891\u7387\u9020\u6210\u7684\u5f71\u54cd\u90fd\u4f1a\u88ab\u5feb\u901f\u7684\u8865\u507f\u4fee\u6b63\u3002</p> <p>\u5173\u4e8e\u65f6\u949f\u6062\u590d\uff0c\u6709\u4e00\u4ef6\u9700\u8981\u6ce8\u610f\u7684\u4e8b\u60c5\uff0cPLL\u9700\u8981\u8f93\u5165\u7aef\u7684\u4fe1\u53f7\u8df3\u53d8\u6765\u5b8c\u6210\u76f8\u4f4d\u6bd4\u8f83\u3002\u5982\u679c\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u6570\u636e\u90fd\u6ca1\u6709\u4efb\u4f55\u8df3\u53d8\uff0c\u90a3\u4e48PLL\u7684\u6062\u590d\u65f6\u949f\u53ef\u80fd\u4f1a\u504f\u79bb\u6b63\u786e\u7684\u65f6\u949f\u9891\u7387\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u95ee\u9898\uff0c8b/10b\u7f16\u7801\u4e2d\u7684\u8bbe\u8ba1\u76ee\u6807\u4e4b\u4e00\u5c31\u662f\u8981\u786e\u4fdd\u6bd4\u7279\u6d41\u4e2d\u8fde\u7eed\u76841\u6216\u80050\u7684\u6570\u91cf\u4e0d\u80fd\u8d85\u8fc75\u4e2a\uff08\u60f3\u83b7\u5f97\u66f4\u591a\u5173\u4e8e\u8fd9\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003\u201c8b/10b Encoding\u201d\u4e00\u8282\uff09</p> <p></p> <p>\u56fe 2\u20115\u7b80\u5355\u7684\u9501\u76f8\u73af\u56fe\u793a</p> <p>\u4e00\u65e6\u65f6\u949f\u88ab\u6062\u590d\u51fa\u6765\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u9501\u5b58\u8f93\u5165\u6570\u636e\u6d41\u7684bit\uff0c\u5e76\u5c06\u9501\u5b58\u5230\u7684\u7ed3\u679c\u7ed9\u5230\u89e3\u4e32\u5668\uff08deserializer\uff09\u3002\u6709\u65f6\u5019\u5b66\u751f\u4eec\u53ef\u80fd\u60f3\u77e5\u9053\u8fd9\u4e2a\u6062\u590d\u65f6\u949f\u80fd\u5426\u4f5c\u4e3a\u63a5\u6536\u7aef\u7684\u6240\u6709\u903b\u8f91\u6240\u4f7f\u7528\u7684\u5de5\u4f5c\u65f6\u949f\uff0c\u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u662f\u201c\u4e0d\u884c\u201d\u3002\u4e00\u4e2a\u539f\u56e0\u662f\uff0c\u63a5\u6536\u7aef\u4e0d\u80fd\u6307\u671b\u7528\u4e8e\u6062\u590d\u51fa\u65f6\u949f\u7684\u6bd4\u7279\u6d41\u53c2\u8003\u65f6\u949f\u4e00\u76f4\u5b58\u5728\u4e14\u6d3b\u8dc3\uff0c\u56e0\u4e3a\u5f53\u94fe\u8def\u7684\u4f4e\u529f\u8017\u72b6\u6001\u5c31\u5305\u62ec\u4e86\u505c\u6b62\u6570\u636e\u4f20\u8f93\uff0c\u6b64\u65f6\u5fc5\u7136\u4e5f\u5c31\u65e0\u6cd5\u7ee7\u7eed\u6062\u590d\u65f6\u949f\u3002\u56e0\u6b64\uff0c\u63a5\u6536\u7aef\u5fc5\u987b\u8981\u6709\u81ea\u5df1\u672c\u5730\u751f\u6210\u7684\u5185\u90e8\u65f6\u949f\u3002</p>"},{"location":"pcie/all/#2125-packet-based-protocol","title":"2.1.2.5   \u57fa\u4e8e\u6570\u636e\u5305\u7684\u534f\u8bae\u4f53\u7cfb\uff08Packet-based Protocol\uff09","text":"<p>\u5c06\u5e76\u884c\u4f20\u8f93\u8f6c\u53d8\u4e3a\u4e32\u884c\u4f20\u8f93\u53ef\u4ee5\u6781\u5927\u7684\u51cf\u5c11\u6570\u636e\u4f20\u8f93\u9700\u8981\u7684\u5f15\u811a\u6570\u91cf\u3002\u5982\u5176\u4ed6\u5927\u591a\u6570\u4e32\u884c\u4f20\u8f93\u534f\u8bae\u4e00\u6837\uff0cPCIe\u901a\u8fc7\u6d88\u9664\u4e86\u7edd\u5927\u90e8\u5206\u539f\u6765\u5e76\u884c\u603b\u7ebf\u4e2d\u5e38\u7528\u7684\u8fb9\u5e26\u63a7\u5236\u4fe1\u53f7\uff08side-band control signal\uff09\u6765\u51cf\u5c11\u4e86\u5f15\u811a\u6570\u91cf\u3002\u7136\u800c\uff0c\u5982\u679c\u6ca1\u6709\u63a7\u5236\u4fe1\u53f7\u6765\u6307\u793a\u88ab\u63a5\u6536\u7684\u4fe1\u606f\u7684\u7c7b\u578b\uff0c\u63a5\u6536\u7aef\u5982\u4f55\u77e5\u9053\u8f93\u5165\u7684bit\u662f\u4ec0\u4e48\u4fe1\u606f\u5462\uff1f\u56e0\u6b64\uff0c\u5728PCIe\u4e2d\uff0c\u6240\u6709\u7684\u4e8b\u52a1\u5728\u53d1\u9001\u65f6\u90fd\u4f7f\u7528\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\u7ed3\u6784\uff0c\u79f0\u4e3a\u6570\u636e\u5305\u3002\u63a5\u6536\u7aef\u9700\u8981\u627e\u5230\u6570\u636e\u5305\u7684\u8fb9\u754c\uff08\u5373\u5305\u5934\u548c\u5305\u5c3e\uff09\uff0c\u5e76\u4e14\u77e5\u9053\u8fd9\u4e2a\u6570\u636e\u5305\u7684\u88ab\u5b9a\u4e49\u7684\u7ed3\u6784\u662f\u4ec0\u4e48\u6837\u5b50\u7684\uff08\u5373\u6570\u636e\u5305\u7684\u6a21\u677f\uff09\uff0c\u7136\u540e\u89e3\u6790\u6570\u636e\u5305\u7ed3\u6784\u6765\u83b7\u77e5\u5b83\u9700\u8981\u6267\u884c\u4ec0\u4e48\u64cd\u4f5c\u3002</p> <p>\u5173\u4e8e\u6570\u636e\u5305\u534f\u8bae\u4f53\u7cfb\u7684\u8be6\u7ec6\u4fe1\u606f\u5c06\u5728\u201cTLP Elements\u201d\u8fd9\u4e00\u7ae0\u8fdb\u884c\u5168\u9762\u8bb2\u89e3\uff0c\u4f46\u5728\u672c\u7ae0\u4e5f\u53ef\u4ee5\u627e\u5230\u5bf9\u5404\u79cd\u5305\u683c\u5f0f\u7684\u4ecb\u7ecd\u4ee5\u53ca\u4ed6\u4eec\u5404\u81ea\u7528\u9014\u7684\u6982\u8ff0\uff0c\u8bf7\u89c1\u201cData Link Layer\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/all/#213-links-and-lanes","title":"2.1.3     \u94fe\u8def\u548c\u901a\u9053\uff08Links and Lanes\uff09","text":"<p>\u5982\u5148\u524d\u7684\u5185\u5bb9\u6240\u63d0\u5230\uff0c\u4e24\u4e2aPCIe\u8bbe\u5907\u4e4b\u95f4\u7684\u7269\u7406\u8fde\u63a5\u88ab\u79f0\u4e3a\u4e00\u6761\u94fe\u8def\uff08Link\uff09\uff0c\u8fd9\u4e2a\u94fe\u8def\u7531\u8bb8\u591a\u901a\u9053\uff08Lane\uff09\u6240\u6784\u6210\u3002\u5982\u56fe 2\u20112\uff0c\u6bcf\u4e2a\u901a\u9053\u90fd\u542b\u6709\u4e00\u5bf9\u53d1\u9001\u5dee\u5206\u4fe1\u53f7\u5bf9\u548c\u4e00\u5bf9\u63a5\u6536\u5dee\u5206\u4fe1\u53f7\u5bf9\u3002\u8fd9\u6837\u7684\u4e00\u4e2a\u901a\u9053\u5df2\u7ecf\u8db3\u591f\u7528\u4e8e\u8bbe\u5907\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u4e0d\u9700\u8981\u5176\u4ed6\u989d\u5916\u7684\u4fe1\u53f7\u3002</p>"},{"location":"pcie/all/#2131-scalable-performance","title":"2.1.3.1   \u53ef\u6269\u5c55\u7684\u6027\u80fd\uff08Scalable Performance\uff09","text":"<p>\u5c3d\u7ba1\u4e00\u4e2a\u901a\u9053\uff08Lane\uff09\u5c31\u53ef\u4ee5\u6ee1\u8db3\u4e24\u4e2a\u8bbe\u5907\u4e4b\u95f4\u901a\u4fe1\u7684\u9700\u6c42\uff0c\u4f46\u662f\u4f7f\u7528\u591a\u7684\u901a\u9053\u7684\u94fe\u8def\u53ef\u4ee5\u63d0\u5347\u94fe\u8def\u7684\u4f20\u8f93\u6027\u80fd\uff0c\u8fd9\u4e2a\u6027\u80fd\u53d6\u51b3\u4e8e\u94fe\u8def\u7684\u4f20\u8f93\u901f\u7387\u4ee5\u53ca\u94fe\u8def\u5bbd\u5ea6\u3002\u4f8b\u5982\uff0c\u4f7f\u7528\u591a\u901a\u9053\u94fe\u8def\u53ef\u4ee5\u589e\u52a0\u6bcf\u4e2a\u65f6\u949f\u4f20\u8f93\u7684bit\u6570\u91cf\uff0c\u56e0\u6b64\u8fd9\u6837\u5c31\u53ef\u4ee5\u63d0\u5347\u5e26\u5bbd\u3002\u5982\u8868 2\u20111\u6240\u63d0\u5230\uff0cPCIe\u534f\u8bae\u89c4\u8303\u652f\u6301\u4e00\u6761\u94fe\u8def\u4e2d\u542b\u6709\u7684\u901a\u9053\u6570\u76ee\u4e3a2\u7684\u5e42\uff0c\u6700\u591a32\u901a\u9053\u3002\u9664\u4e862\u7684\u5e42\u4ee5\u5916\uff0cx12\u94fe\u8def\u4e5f\u662f\u652f\u6301\u7684\uff0c\u8fd9\u53ef\u80fd\u662f\u4e3a\u4e86\u652f\u6301InfiniBand\u7684x12\u94fe\u8def\uff0c\u5b83\u662f\u4e00\u79cd\u8f83\u65e9\u7684\u4e32\u884c\u8bbe\u8ba1\u3002PCIe\u8fd9\u79cd\u5141\u8bb8\u591a\u79cd\u94fe\u8def\u5bbd\u5ea6\u7684\u7279\u6027\uff0c\u4f7f\u5f97\u5e73\u53f0\u8bbe\u8ba1\u8005\u53ef\u4ee5\u5728\u6210\u672c\u548c\u6027\u80fd\u4e4b\u95f4\u505a\u51fa\u9002\u5f53\u7684\u6743\u8861\uff0c\u6839\u636e\u94fe\u8def\u4e2d\u901a\u9053\u7684\u6570\u91cf\u8f7b\u677e\u5730\u8fdb\u884c\u589e\u51cf\u3002</p>"},{"location":"pcie/all/#2132-flexible-topology-options","title":"2.1.3.2   \u7075\u6d3b\u7684\u62d3\u6251\u7ed3\u6784\u9009\u62e9\uff08Flexible Topology Options\uff09","text":"<p>\u4e00\u6761PCIe\u94fe\u8def\u5fc5\u987b\u662f\u4e00\u4e2a\u70b9\u5bf9\u70b9\u7684\u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u50cfPCI\u4e00\u6837\u7684\u5171\u4eab\u603b\u7ebf\uff0c\u8fd9\u662f\u56e0\u4e3aPCIe\u4f7f\u7528\u7684\u94fe\u8def\u901f\u7387\u975e\u5e38\u9ad8\u3002\u7531\u4e8e\u4e00\u6761\u94fe\u8def\u53ea\u80fd\u8fde\u63a5\u4e24\u4e2a\u63a5\u53e3\uff0c\u56e0\u6b64\u9700\u8981\u4e00\u79cd\u6269\u5c55\u8fde\u63a5\u7684\u65b9\u6cd5\u6765\u6784\u5efa\u4e00\u4e2a\u4e0d\u7410\u788e\u7684\u7cfb\u7edf\uff08non-trivial system\uff09\uff0c\u8fd9\u91cc\u4e0d\u7410\u788e\u7684\u610f\u601d\u662f\u6307\u4e0d\u8fc7\u4e8e\u7ec6\u788e\u548c\u5197\u6742\uff0c\u4f8b\u5982\u82e5\u76f4\u63a5\u5bf9\u6240\u6709\u8bbe\u5907\u90fd\u91c7\u7528\u76f4\u63a5\u7684\u4e24\u4e24\u76f8\u8fde\uff0c\u90a3\u4e48\u4f1a\u4f7f\u5f97\u6574\u4e2a\u7cfb\u7edf\u5341\u5206\u5197\u6742\u7410\u788e\u3002\u8fd9\u79cd\u9700\u6c42\u5728PCIe\u4e2d\u901a\u8fc7Switches\uff08\u4ea4\u6362\u7ed3\u6784\uff09\u548cBridge\u6765\u5b9e\u73b0\uff0c\u8fd9\u4e24\u8005\u53ef\u4ee5\u7075\u6d3b\u7684\u6784\u5efa\u7cfb\u7edf\u62d3\u6251\u2014\u2014\u7cfb\u7edf\u4e2d\u5143\u7d20\u4e4b\u95f4\u7684\u8fde\u63a5\u96c6\u3002\u5bf9\u7cfb\u7edf\u4e2d\u4e00\u4e2a\u5143\u7d20\u7684\u5b9a\u4e49\u4ee5\u53ca\u4e00\u4e9b\u62d3\u6251\u7ed3\u6784\u7684\u4f8b\u5b50\u5c06\u5728\u4e0b\u9762\u7684\u5c0f\u8282\u4e2d\u7ed9\u51fa\u3002</p>"},{"location":"pcie/all/#214-pcie","title":"2.1.4     \u5173\u4e8ePCIe\u62d3\u6251\u7684\u4e00\u4e9b\u5b9a\u4e49","text":"<p>\u5982\u56fe 2\u20116\u5c55\u793a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684PCIe\u62d3\u6251\u793a\u4f8b\uff0c\u5b83\u5c06\u6709\u52a9\u4e8e\u6211\u4eec\u5bf9\u672c\u8282\u7684\u4e00\u4e9b\u5b9a\u4e49\u5185\u5bb9\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p></p> <p>\u56fe 2\u20116 PCIe\u62d3\u6251\u793a\u4f8b</p>"},{"location":"pcie/all/#2141-topology-characteristics","title":"2.1.4.1   \u62d3\u6251\u7279\u5f81\uff08Topology Characteristics\uff09","text":"<p>\u5728\u56fe\u7684\u6700\u4e0a\u65b9\u662f\u4e00\u4e2aCPU\u3002\u8fd9\u91cc\u9700\u8981\u6307\u51fa\uff0cCPU\u88ab\u8ba4\u4e3a\u662fPCIe\u5c42\u6b21\u7ed3\u6784\u7684\u9876\u7aef\u3002\u5c31\u50cfPCI\u4e00\u6837\uff0cPCIe\u53ea\u5141\u8bb8\u7b80\u5355\u7684\u6811\u7ed3\u6784\uff0c\u8fd9\u610f\u5473\u7740\u4e0d\u5141\u8bb8\u51fa\u73b0\u5faa\u73af\u6216\u8005\u5176\u4ed6\u590d\u6742\u7684\u62d3\u6251\u7ed3\u6784\u3002\u8fd9\u6837\u505a\u7684\u539f\u56e0\u662f\u4e3a\u4e86\u4fdd\u6301\u4e0ePCI\u8f6f\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\uff0c\u56e0\u4e3aPCI\u8f6f\u4ef6\u4f7f\u7528\u7b80\u5355\u7684\u914d\u7f6e\u65b9\u6cd5\u6765\u8bb0\u5f55\u62d3\u6251\u7ed3\u6784\uff0c\u5b83\u5e76\u4e0d\u652f\u6301\u590d\u6742\u7684\u73af\u5883\u3002</p> <p>\u4e3a\u4e86\u4fdd\u6301\u8fd9\u79cd\u5411\u540e\u517c\u5bb9\u6027\uff0c\u8f6f\u4ef6\u5fc5\u987b\u80fd\u591f\u4ee5\u4e0e\u4ece\u524d\u4e00\u6837\u65b9\u5f0f\u4ea7\u751f\u914d\u7f6e\u5468\u671f\uff0c\u5e76\u4e14\u603b\u7ebf\u62d3\u6251\u7ed3\u6784\u4e5f\u5fc5\u987b\u4e0e\u4ee5\u524d\u4e00\u6837\u3002\u56e0\u6b64\uff0c\u8f6f\u4ef6\u5e0c\u671b\u627e\u5230\u7684\u6240\u6709\u914d\u7f6e\u5bc4\u5b58\u5668\u4f9d\u7136\u5b58\u5728\uff0c\u800c\u4e14\u5b83\u4eec\u7684\u884c\u4e3a\u65b9\u5f0f\u7b49\u4e5f\u4f9d\u7136\u4e0e\u4ece\u524d\u76f8\u540c\u3002\u6211\u4eec\u5c06\u7a0d\u665a\u4e9b\u5728\u56de\u8fc7\u5934\u6765\u8ba8\u8bba\u8fd9\u4e00\u5757\u7684\u5185\u5bb9\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u5148\u5b9a\u4e49\u4e00\u4e9b\u672f\u8bed\u6982\u5ff5\u3002</p>"},{"location":"pcie/all/#2142-root-complexrc","title":"2.1.4.2   Root Complex\uff08RC \u6839\u7ec4\u4ef6\uff09","text":"<p>CPU\u4e0ePCIe\u603b\u7ebf\u4eec\u652f\u67b6\u53ef\u80fd\u5305\u542b\u4e00\u7cfb\u5217\u7684\u7ec4\u4ef6\uff08\u5904\u7406\u5668\u63a5\u53e3\uff0cDRAM\u63a5\u53e3\u7b49\u7b49\uff09\uff0c\u751a\u81f3\u662f\u5305\u542b\u591a\u4e2a\u82af\u7247\u3002\u5c06\u8fd9\u4e9b\u7ec4\u4ef6\u5408\u8d77\u6765\uff0c\u79f0\u8fd9\u4e00\u7ec4\u7ec4\u4ef6\u4e3aRoot Complex\uff08\u6839\u7ec4\u4ef6\uff0c\u7b80\u79f0\u4e3aRC\u6216\u8005Root\uff09\u3002RC\u5b58\u5728\u4e8ePCI\u5012\u8f6c\u7684\u6811\u72b6\u62d3\u6251\u7684\u201c\u6839\u90e8\u201d\uff0c\u5e76\u4ee3\u8868CPU\u4e0e\u7cfb\u7edf\u7684\u5176\u4f59\u90e8\u5206\u901a\u4fe1\u3002\u4f46\u662f\uff0cPCIe\u534f\u8bae\u89c4\u8303\u5e76\u6ca1\u6709\u5f88\u4ed4\u7ec6\u7684\u5bf9RC\u8fdb\u884c\u5b9a\u4e49\uff0c\u800c\u662f\u7ed9\u51fa\u4e86\u4e00\u4e2aRC\u5fc5\u9700\u529f\u80fd\u4e0e\u53ef\u9009\u529f\u80fd\u7684\u5217\u8868\u3002\u4ece\u5e7f\u4e49\u4e0a\u8bf4\uff0cRoot Complex\u53ef\u4ee5\u88ab\u7406\u89e3\u4e3a\u7cfb\u7edfCPU\u4e0ePCIe\u62d3\u6251\u4e4b\u95f4\u7684\u63a5\u53e3\uff0c\u8fd9\u4e2aPCIe\u7aef\u53e3\uff0c\u5373RC\uff0c\u5728\u914d\u7f6e\u7a7a\u95f4\u4e2d\u88ab\u6807\u8bb0\u4e3a\u201c\u6839\u7aef\u53e3\uff08Root Port\uff09\u201d\u3002</p>"},{"location":"pcie/all/#2143-switches-and-bridge","title":"2.1.4.3   Switches and Bridge\uff08\u4ea4\u6362\u7ed3\u6784\u4e0e\u6865\uff09","text":"<p>Switch\u63d0\u4f9b\u4e86\u6247\u51fa\u4ee5\u53ca\u805a\u5408\u80fd\u529b\uff0c\u4f7f\u5f97\u5355\u4e2aPCIe\u7aef\u53e3\u4e0a\u53ef\u4ee5\u8fde\u63a5\u66f4\u591a\u7684\u8bbe\u5907\u3002\u5b83\u626e\u6f14\u6570\u636e\u5305\u8def\u7531\u5668\u7684\u89d2\u8272\uff0c\u53ef\u4ee5\u6839\u636e\u6240\u7ed9\u6570\u636e\u5305\u7684\u5730\u5740\u6216\u8005\u5176\u4ed6\u8def\u7531\u4fe1\u606f\u6765\u8bc6\u522b\u8fd9\u4e2a\u6570\u636e\u5305\u8981\u8d70\u54ea\u6761\u8def\u5f84\u3002</p> <p>Bridge\u63d0\u4f9b\u4e86\u4e00\u4e2a\u901a\u5f80\u5176\u4ed6\u603b\u7ebf\u7684\u63a5\u53e3\uff0c\u4f8b\u5982PCI\u6216\u8005PCI-X\uff0c\u751a\u81f3\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u7684PCIe\u603b\u7ebf\u3002\u56fe 2\u20116\u4e2d\u5c55\u793a\u7684Bridge\u6709\u65f6\u88ab\u79f0\u4e3a\u201cforward bridge\uff08\u524d\u5411Bridge\uff09\u201d\uff0c\u5b83\u4f7f\u5f97\u4e00\u4e2a\u65e7\u7684PCI\u6216\u8005PCI-X\u677f\u5361\u53ef\u4ee5\u63d2\u5165\u4e00\u4e2a\u65b0\u7cfb\u7edf\u4e2d\uff08PCIe\u7cfb\u7edf\uff09\u3002\u4e0eforward bridge\u76f8\u53cd\u7c7b\u578b\u7684Bridge\u79f0\u4e3a\u201creserve bridge\uff08\u53cd\u5411Bridge\uff09\u201d\uff0c\u5b83\u4f7f\u5f97\u65b0\u7684PCIe\u677f\u5361\u53ef\u4ee5\u63d2\u5165\u5230\u65e7\u7684PCI\u7cfb\u7edf\u4e2d\u3002</p>"},{"location":"pcie/all/#2144-native-pcie-endpoints-and-legacy-pcie-endpointsep","title":"2.1.4.4   Native PCIe Endpoints and Legacy PCIe Endpoints\uff08\u539f\u751f\u4e0e\u9057\u7559EP\uff09","text":"<p>Endpoints\uff08EP\uff0c\u7aef\u70b9\uff09\u662fPCIe\u62d3\u6251\u4e2d\u7684\u65e2\u4e0d\u662fSwitch\u4e5f\u4e0d\u662fBridge\u7684\u8bbe\u5907\uff0c\u5b83\u4eec\u53ef\u4ee5\u4f5c\u4e3a\u603b\u7ebf\u4e0a\u4e8b\u52a1\u7684Initiator\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e8b\u52a1\u7684Completers\u3002EP\u5b58\u5728\u4e8e\u6811\u72b6\u62d3\u6251\u7684\u5206\u652f\u7684\u5e95\u90e8\uff0c\u4ec5\u5b9e\u73b0\u4e00\u4e2a\u4e0a\u884c\u7aef\u53e3\uff08\u9762\u5411Root\uff09\uff0c\u8fd9\u91cc\u7684\u4e0a\u884c\u6307\u7684\u662f\u62d3\u6251\u7ed3\u6784\u7684\u5411\u4e0a\uff0c\u8868\u793aEP\u5df2\u7ecf\u662f\u6811\u7684\u5206\u652f\u7684\u7aef\u70b9\uff0c\u4e0d\u518d\u4ea7\u751f\u4e0b\u7ea7\u5206\u652f\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u4e00\u4e2aSwitch\u53ef\u4ee5\u6709\u51e0\u4e2a\u4e0b\u884c\u7aef\u53e3\u3002\u8bbe\u8ba1\u7528\u4e8e\u8001\u5f0f\u603b\u7ebf\uff08\u4f8b\u5982PCI-X\uff09\u7684\u8bbe\u5907\u5982\u4eca\u62e5\u6709\u4e86\u53ef\u4f9b\u5b83\u4eec\u4f7f\u7528\u7684PCIe\u63a5\u53e3\uff0c\u8fd9\u79cdPCIe\u63a5\u53e3\u5c06\u5728\u914d\u7f6e\u5bc4\u5b58\u5668\u4e2d\u5c06\u81ea\u8eab\u6807\u8bc6\u4e3a\u201cLegacy PCIe Endpoints\uff08\u9057\u7559PCIe\u7aef\u70b9\uff09\u201d\u3002\u5b83\u4eec\u4f7f\u7528\u4e86\u5728PCIe\u8bbe\u8ba1\u4e2d\u88ab\u7981\u6b62\u7684\u4e1c\u897f\uff0c\u4f8b\u5982IO\u7a7a\u95f4\u3001\u652f\u6301IO\u4e8b\u52a1\u4ee5\u53ca\u652f\u6301\u9501\u5b9a\u8bf7\u6c42\u3002\u4e0e\u4e4b\u76f8\u53cd\uff0c\u201cNative PCIe Endpoints\uff08\u539f\u751fPCIe\u7aef\u70b9\uff09\u201d\u662f\u4ece\u4e00\u5f00\u59cb\u5c31\u88ab\u8bbe\u8ba1\u7528\u6765\u5728PCIe\u7cfb\u7edf\u4e2d\u4f7f\u7528\u7684\uff0c\u8fd9\u533a\u522b\u4e8e\u5728\u65e7\u7684PCI\u8bbe\u5907\u4e0a\u6dfb\u52a0PCIe\u63a5\u53e3\u3002\u539f\u751fPCIe\u7aef\u70b9\u8bbe\u5907\u662f\u5185\u5b58\u6620\u5c04\u8bbe\u5907\uff08MMIO\u8bbe\u5907\uff09\u3002</p>"},{"location":"pcie/all/#2145","title":"2.1.4.5   \u8f6f\u4ef6\u517c\u5bb9\u7279\u6027","text":"<p>\u4e00\u79cd\u4fdd\u6301\u8f6f\u4ef6\u517c\u5bb9\u6027\u7684\u65b9\u6cd5\u662f\u4fdd\u6301EP\u548cBridge\u7684\u914d\u7f6e\u5934\uff08configuration header\uff09\u4e0ePCI\u4e00\u81f4\uff0c\u5982\u56fe 2\u20117\u6240\u793a\u3002</p> <p></p> <p>\u56fe 2\u20117 \u914d\u7f6e\u5934</p> <p>\u6709\u4e00\u70b9\u4e0d\u540c\u7684\u662f\u5728\u73b0\u5728PCIe\u4e2dBridge\u7ecf\u5e38\u4f1a\u88ab\u805a\u5408\u8fdbSwitch\u548cRoot\uff0c\u4f46\u662f\u9057\u7559\u7684PCI\u8f6f\u4ef6\u662f\u65e0\u6cd5\u53d1\u73b0\u8fd9\u79cd\u533a\u522b\u7684\uff0c\u5b83\u53ea\u628a\u8fd9\u4e9b\u5185\u542bBridge\u7684\u8bbe\u5907\u7b80\u5355\u7684\u5f53\u505aBridge\u3002\u5728\u8fd9\u91cc\u6211\u4eec\u5148\u5bf9\u4e00\u4e9b\u6982\u5ff5\u8fdb\u884c\u719f\u6089\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u4f1a\u5728\u8fd9\u91cc\u8ba8\u8bba\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u7ec6\u8282\u3002\u914d\u7f6e\u662f\u4e00\u4e2a\u76f8\u5f53\u5927\u7684\u4e3b\u9898\uff0c\u5173\u4e8e\u5b83\u7684\u5177\u4f53\u4ecb\u7ecd\u5c06\u5728\u201cConfiguration Overview\u201d\u8fd9\u4e00\u8282\u8fdb\u884c\u3002</p> <p>\u4e3a\u4e86\u4e3e\u4f8b\u8bf4\u660ePCIe\u7cfb\u7edf\u5728\u8f6f\u4ef6\u4e2d\u7684\u5c55\u73b0\u5f62\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u53c2\u8003\u56fe 2\u20118\u4e2d\u6240\u5c55\u793a\u7684\u62d3\u6251\u7ed3\u6784\u7684\u4f8b\u5b50\u3002\u50cf\u4e4b\u524d\u6240\u8bf4\u7684\u4e00\u6837\uff0cRC\u4f4d\u4e8e\u6574\u4e2a\u5c42\u6b21\u7ed3\u6784\u7684\u9876\u7aef\u3002RC\u81ea\u8eab\u7684\u5185\u90e8\u53ef\u4ee5\u975e\u5e38\u590d\u6742\uff0c\u4f46\u662f\u5b83\u901a\u5e38\u4f1a\u5b9e\u73b0\u4e00\u4e2a\u5185\u90e8\u603b\u7ebf\u7ed3\u6784\u4ee5\u53ca\u4e00\u4e9b\u6865\u63a5\u7ed3\u6784\uff0c\u4ee5\u4fbf\u5c06\u62d3\u6251\u6247\u51fa\u5230\u51e0\u4e2a\u7aef\u53e3\u3002RC\u7684\u5185\u90e8\u603b\u7ebf\u5c06\u88ab\u914d\u7f6e\u8f6f\u4ef6\u89c6\u4f5cPCI\u603b\u7ebf0\uff0c\u4e14RC\u4e0a\u8fd9\u51e0\u4e2aPCIe\u7aef\u53e3\u5c06\u88ab\u89c6\u4f5c\u662fPCI-to-PCI Bridge\u3002\u8fd9\u79cd\u5185\u90e8\u7ed3\u6784\u5176\u5b9e\u5e76\u4e0d\u662f\u4e00\u4e2a\u5b9e\u9645\u7684PCI\u603b\u7ebf\uff0c\u4f46\u662f\u5b83\u5728\u8f6f\u4ef6\u4e2d\u770b\u8d77\u6765\u5c31\u662f\u8fd9\u79cd\u7ed3\u6784\u3002\u56e0\u4e3a\u8fd9\u4e2a\u603b\u7ebf\u662f\u5728RC\u5185\u90e8\u7684\uff0c\u6240\u4ee5\u5b83\u5b9e\u9645\u7684\u903b\u8f91\u8bbe\u8ba1\u5e76\u4e0d\u9700\u8981\u9075\u5faa\u4efb\u4f55\u7684\u6807\u51c6\uff0c\u8fd9\u91cc\u662f\u53ef\u4ee5\u7531\u4f9b\u5e94\u5546\u6765\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u3002</p> <p></p> <p>\u56fe 2\u20118\u62d3\u6251\u7ed3\u6784\u793a\u4f8b</p> <p>\u7c7b\u4f3c\u7684\uff0cPCIe Switch\uff08\u4ea4\u6362\u7ed3\u6784\uff09\u7684\u5185\u90e8\u7ed3\u6784\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u5c31\u662f\u7b80\u5355\u5730\u51e0\u4e2aBridge\u5171\u4eab\u4e00\u6761\u516c\u5171\u603b\u7ebf\uff0c\u5982\u56fe 2\u20119\u6240\u793a\u3002\u8fd9\u6837\u505a\u7684\u4e3b\u8981\u4f18\u70b9\u5c31\u662f\u4f7f\u5f97\u4e8b\u52a1\u7684\u8def\u7531\u65b9\u6cd5\u80fd\u591f\u4e0ePCI\u4e00\u81f4\u3002\u679a\u4e3e\uff0c\u8fd9\u662f\u914d\u7f6e\u8f6f\u4ef6\u7528\u6765\u53d1\u73b0\u7cfb\u7edf\u62d3\u6251\u7ed3\u6784\u5e76\u5206\u914d\u603b\u7ebf\u53f7\u548c\u7cfb\u7edf\u8d44\u6e90\u7684\u8fc7\u7a0b\uff0c\u5b83\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e5f\u4e0ePCI\u4e2d\u76f8\u540c\u3002\u5728\u7a0d\u540e\u7684\u5185\u5bb9\u4e2d\u6211\u4eec\u5c06\u901a\u8fc7\u4e00\u4e9b\u4f8b\u5b50\u6765\u8bb2\u8ff0\u679a\u4e3e\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\u4e00\u65e6\u679a\u4e3e\u5b8c\u6210\uff0c\u7cfb\u7edf\u4e2d\u7684\u603b\u7ebf\u53f7\u5c31\u5c06\u6309\u7167\u56fe 2\u20119\u6240\u793a\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u914d\u3002</p> <p></p> <p>\u56fe 2\u20119\u7cfb\u7edf\u679a\u4e3e\u7ed3\u679c\u7684\u793a\u4f8b</p>"},{"location":"pcie/all/#2146","title":"2.1.4.6   \u7cfb\u7edf\u793a\u4f8b","text":"<p>\u5982\u56fe 2\u201110\u4e2d\u4e3e\u4f8b\u8bf4\u660e\u4e86\u4e00\u4e2a\u57fa\u4e8ePCIe\u7684\u7cfb\u7edf\uff0c\u5b83\u88ab\u8bbe\u8ba1\u7528\u4e8e\u4e00\u4e9b\u4f4e\u6210\u672c\u5e94\u7528\u6bd4\u5982\u6d88\u8d39\u54c1\u53f0\u5f0f\u8ba1\u7b97\u673a\u3002\u6709\u4e00\u4e9bPCIe\u7aef\u53e3\u5b9e\u73b0\u65f6\u9644\u5e26\u4e86\u4e00\u4e9b\u677f\u5361\u63d2\u69fd\uff0c\u4f46\u662f\u57fa\u672c\u7684\u6846\u67b6\u4e0e\u8001\u5f0f\u7684PCI\u7cfb\u7edf\u5e76\u6ca1\u6709\u592a\u5927\u533a\u522b\u3002</p> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5982\u56fe 2\u201111\u6240\u793a\u7684\u9ad8\u7aef\u7684\u670d\u52a1\u5668\u7cfb\u7edf\u5c55\u793a\u4e86\u4e00\u4e9b\u5185\u7f6e\u5728\u7cfb\u7edf\u7684\u7528\u4e8e\u8fde\u63a5\u5176\u4ed6\u7f51\u7edc\u7684\u63a5\u53e3\u3002\u5728\u65e9\u671fPCIe\u4e2d\uff0c\u6709\u4eba\u66fe\u8003\u8651\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7edc\u6765\u8fd0\u884c\uff0c\u7528\u6765\u53d6\u4ee3\u90a3\u4e9b\u65e7\u7684\u6a21\u578b\u3002\u6bd5\u7adf\uff0c\u5982\u679cPCIe\u5728\u5927\u4f53\u4e0a\u662f\u5176\u4ed6\u7f51\u7edc\u534f\u8bae\u7684\u7b80\u5316\u7248\u672c\uff0c\u6216\u8bb8\u5b83\u4e5f\u80fd\u6ee1\u8db3\u6240\u6709\u9700\u6c42\u3002\u7531\u4e8e\u5404\u79cd\u5404\u6837\u7684\u539f\u56e0\uff0c\u8fd9\u4e00\u6982\u5ff5\u4ece\u6765\u6ca1\u6709\u771f\u6b63\u5f97\u5230\u5927\u529b\u53d1\u5c55\uff0c\u57fa\u4e8ePCIe\u7684\u7cfb\u7edf\u901a\u5e38\u4ecd\u7136\u9700\u8981\u4f7f\u7528\u5176\u4ed6\u7684\u534f\u8bae\u6765\u8fde\u63a5\u5230\u5916\u90e8\u7f51\u7edc\u3002</p> <p>\u8fd9\u4e5f\u7ed9\u4e86\u6211\u4eec\u4e00\u4e2a\u673a\u4f1a\u6765\u91cd\u65b0\u5ba1\u89c6\u4e00\u4e2a\u95ee\u9898\uff0cRC\u662f\u7531\u4ec0\u4e48\u7ec4\u6210\u7684\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u88ab\u6807\u8bc6\u4e3a\u201c\u82f1\u7279\u5c14\u5904\u7406\u5668\u201d\u7684\u65b9\u5757\u5305\u542b\u4e86\u8bb8\u591a\u7ec4\u4ef6\uff0c\u5927\u591a\u6570\u73b0\u4ee3\u7684CPU\u67b6\u6784\u90fd\u662f\u5982\u6b64\u3002\u8fd9\u4e2a\u5904\u7406\u5668\u5305\u542b\u4e86\u4e00\u4e2a\u7528\u4e8e\u8bbf\u95ee\u56fe\u5f62\u8bbe\u5907\uff08\u4f8b\u5982\u663e\u5361\uff09\u7684x16 PCIe\u7aef\u53e3\uff0c\u4ee5\u53ca\u4e24\u6761DRAM\u901a\u9053\uff0c\u8fd9\u4e24\u6761DRAM\u901a\u9053\u610f\u5473\u7740\u5185\u5b58\u63a7\u5236\u5668\u4ee5\u53ca\u4e00\u4e9b\u8def\u7531\u903b\u8f91\u5df2\u7ecf\u88ab\u96c6\u6210\u5230CPU\u5c01\u88c5\uff08CPU Package\uff09\u4e2d\u3002\u603b\u7684\u6765\u8bf4\uff0c\u8fd9\u4e9b\u8d44\u6e90\u901a\u5e38\u88ab\u79f0\u4e3a\u201c\u975e\u6838\u5fc3\u201d\u8d44\u6e90\uff0c\u8fd9\u6837\u7684\u79f0\u547c\u7528\u4e8e\u5c06\u4ed6\u4eec\u4e0eCPU\u5c01\u88c5\u4e2d\u7684\u51e0\u4e2aCPU\u6838\u5fc3\uff08CPU Core\uff09\u533a\u5206\u5f00\u6765\u3002\u6b64\u524d\uff0c\u6211\u4eec\u63cf\u8ff0\u8fc7Root\u662fCPU\u4e0ePCIe\u62d3\u6251\u76f8\u8fde\u63a5\u7684\u63a5\u53e3\uff0c\u8fd9\u610f\u5473\u7740\u5728CPU\u5c01\u88c5\u4e2d\u5fc5\u987b\u542b\u6709Root\u7684\u4e00\u90e8\u5206\u3002\u6b63\u5982\u56fe 2\u201111\u4e2d\u865a\u7ebf\u6240\u6846\u51fa\u7684\uff0cRoot\u7531\u591a\u4e2a\u5c01\u88c5\u7684\u4e00\u90e8\u5206\u5171\u540c\u7ec4\u6210\u3002\u8fd9\u79cdRoot\u7684\u7ec4\u6210\u65b9\u5f0f\u53ef\u80fd\u5c06\u4f1a\u662f\u672a\u6765\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u7cfb\u7edf\u7684\u8bbe\u8ba1\u65b9\u5f0f\u3002</p> <p></p> <p>\u56fe 2\u201110 \u4f4e\u6210\u672c\u7684PCIe\u7cfb\u7edf</p> <p></p> <p>\u56fe 2\u201111\u670d\u52a1\u5668PCIe\u7cfb\u7edf</p>"},{"location":"pcie/all/#22-introduction-to-device-layers","title":"2.2 \u8bbe\u5907\u5c42\u6b21\u4ecb\u7ecd\uff08Introduction to Device Layers\uff09","text":"<p>PCIe\u5b9a\u4e49\u4e86\u4e00\u79cd\u5206\u5c42\u7684\u4f53\u7cfb\u7ed3\u6784\uff0c\u5982\u56fe 2\u201112\u662f\u8fd9\u79cd\u5206\u5c42\u4f53\u7cfb\u7ed3\u6784\u7684\u793a\u610f\u56fe\u3002\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u4e9b\u5c42\u5728\u903b\u8f91\u4e0a\u662f\u76f8\u4e92\u72ec\u7acb\u7684\u90e8\u5206\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5404\u81ea\u90fd\u6709\u4e00\u4e2a\u7528\u4e8e\u53d1\u51fa\u4fe1\u606f\u6d41\u7684\u53d1\u9001\u7aef\u548c\u4e00\u4e2a\u63a5\u6536\u4fe1\u606f\u6d41\u7684\u63a5\u6536\u7aef\u3002\u8fd9\u79cd\u5206\u5c42\u7684\u8bbe\u8ba1\u65b9\u6cd5\u5bf9\u786c\u4ef6\u8bbe\u8ba1\u8005\u6765\u8bf4\u6709\u4e0d\u5c11\u7684\u4f18\u70b9\uff0c\u56e0\u4e3a\u5982\u679c\u5728\u8bbe\u8ba1\u4e2d\u5bf9\u903b\u8f91\u8fdb\u884c\u4e86\u4ed4\u7ec6\u7684\u5212\u5206\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728\u4ee5\u540e\u5347\u7ea7\u5230\u65b0\u7684\u534f\u8bae\u89c4\u8303\u7248\u672c\u65f6\u4ec5\u6539\u53d8\u539f\u8bbe\u8ba1\u4e2d\u7684\u67d0\u4e00\u5c42\u5373\u53ef\uff0c\u800c\u4e0d\u4f1a\u5f71\u54cd\u6216\u8005\u53d8\u52a8\u5176\u5b83\u5c42\u3002\u867d\u7136\u5982\u6b64\uff0c\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e9b\u5c42\u53ea\u662f\u5b9a\u4e49\u4e86\u63a5\u53e3\u7684\u5de5\u4f5c\u804c\u8d23\uff0c\u800c\u5b9e\u9645\u8bbe\u8ba1\u5e76\u4e0d\u8981\u6c42\u4e3a\u4e86\u7b26\u5408\u89c4\u8303\u800c\u5c06\u8bbe\u8ba1\u6309\u7167\u5c42\u7ea7\u6765\u5206\u6210\u51e0\u4e2a\u90e8\u5206\uff0c\u5373\u5206\u5c42\u7684\u6982\u5ff5\u66f4\u504f\u91cd\u4e8e\u5728\u903b\u8f91\u5c42\u9762\uff0c\u4e0d\u5f3a\u5236\u8981\u6c42\u5212\u5206\u7684\u5f88\u4e25\u683c\u3002\u672c\u8282\u7684\u76ee\u7684\u5728\u4e8e\u63cf\u8ff0\u5404\u4e2a\u5c42\u7684\u529f\u80fd\u804c\u8d23\uff0c\u4ee5\u53ca\u63cf\u8ff0\u5b8c\u6210\u4e00\u6b21\u6570\u636e\u4f20\u8f93\u65f6\u7684\u4e8b\u4ef6\u6d41\u7a0b\u3002</p> <p></p> <p>\u56fe 2\u201112 PCI Express\u8bbe\u5907\u5c42\u6b21\u793a\u610f\u56fe</p> <p>\u56fe 2\u201112\u6240\u5c55\u793a\u7684PCIe\u8bbe\u5907\u5185\u90e8\u5c42\u6b21\u5305\u62ec\uff1a</p> <p>l \u8bbe\u5907\u6838\uff08Device Core\uff09\u4ee5\u53ca\u5b83\u4e0e\u4e8b\u52a1\u5c42\uff08Transaction Layer\uff09\u7684\u63a5\u53e3\u3002\u8bbe\u5907\u6838\u5b9e\u73b0\u8bbe\u5907\u7684\u4e3b\u8981\u529f\u80fd\u3002\u5982\u679c\u8bbe\u5907\u662f\u4e00\u4e2aEP\uff08\u7aef\u70b9\uff09\uff0c\u90a3\u4e48\u5b83\u6700\u591a\u53ef\u4ee5\u5305\u542b8\u4e2aFunction\uff08\u529f\u80fd\uff09\uff0c\u6bcf\u4e2aFunction\u5b9e\u73b0\u81ea\u5df1\u7684\u914d\u7f6e\u7a7a\u95f4\u3002\u5982\u679c\u8bbe\u5907\u662f\u4e00\u4e2aSwitch\uff08\u4ea4\u6362\u7ed3\u6784\uff09\uff0c\u90a3\u4e48\u5b83\u7684Switch\u6838\u662f\u7531\u6570\u636e\u5305\u8def\u7531\u903b\u8f91\u548c\u4e3a\u4e86\u5b9e\u73b0\u8def\u7531\u7684\u5185\u90e8\u603b\u7ebf\u800c\u6784\u6210\u3002\u5982\u679c\u8bbe\u5907\u662f\u4e00\u4e2aRC\uff08Root\u6839\u8bbe\u5907\uff09\uff0c\u90a3\u4e48\u4ed6\u7684Root\u6838\u4f1a\u5b9e\u73b0\u4e00\u4e2a\u865a\u62df\u7684PCI\u603b\u7ebf0\uff0c\u5728\u8fd9\u4e2a\u865a\u62df\u7684PCI\u603b\u7ebf0\u4e2d\u5b58\u5728\u7740\u6240\u6709\u7684\u82af\u7247\u7ec4\u5d4c\u5165\u5f0fEP\uff0c\u4ee5\u53ca\u5b58\u5728\u7740\u865a\u62dfBridge\u3002</p> <p>l \u4e8b\u52a1\u5c42\uff08Transaction Layer\uff09\u3002\u4e8b\u52a1\u5c42\u8d1f\u8d23\u5728\u53d1\u9001\u7aef\u4ea7\u751fTransaction Layer Packet\uff08TLP\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\uff0c\u5728\u63a5\u6536\u7aef\u5bf9TLP\u8fdb\u884c\u8bd1\u7801\u3002\u8fd9\u4e00\u5c42\u4e5f\u8d1f\u8d23QoS\u529f\u80fd\uff08Quality of Service\uff0c\u670d\u52a1\u8d28\u91cf\uff09\u3001\u6d41\u91cf\u63a7\u5236\u529f\u80fd\uff08Flow Control\uff09\u4ee5\u53ca\u4e8b\u52a1\u6392\u5e8f\u529f\u80fd\uff08Transaction Ordering\uff09\u3002\u6240\u6709\u7684\u8fd9\u56db\u4e2a\u4e8b\u52a1\u5c42\u7684\u529f\u80fd\u5c06\u5728\u672c\u4e66\u7684\u7b2c\u4e8c\u90e8\u5206Part Two\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p>l \u6570\u636e\u94fe\u8def\u5c42\uff08Data Link Layer\uff09\u3002\u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8d23\u5728\u53d1\u9001\u7aef\u4ea7\u751fData Link Layer Packet\uff08DLLP\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\uff0c\u5728\u63a5\u6536\u7aef\u5bf9DLLP\u8fdb\u884c\u8bd1\u7801\u3002\u8fd9\u4e00\u5c42\u4e5f\u8d1f\u8d23\u94fe\u8def\u9519\u8bef\u68c0\u6d4b\u4ee5\u53ca\u4fee\u6b63\uff08Link error detection and correction\uff09\uff0c\u8fd9\u4e2a\u6570\u636e\u94fe\u8def\u5c42\u529f\u80fd\u88ab\u79f0\u4e3aAck/Nak\u534f\u8bae\u3002\u8fd9\u4e24\u4e2a\u6570\u636e\u94fe\u8def\u5c42\u529f\u80fd\u4f1a\u5728\u672c\u4e66\u7684\u7b2c\u4e09\u90e8\u5206Part Three\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p>l \u7269\u7406\u5c42\uff08Physical Layer\uff09\u3002\u7269\u7406\u5c42\u8d1f\u8d23\u5728\u53d1\u9001\u7aef\u4ea7\u751fOrdered-set Packet\uff08\u547d\u4ee4\u96c6\u5305\uff09\uff0c\u5728\u63a5\u6536\u7aef\u5bf9Ordered-set\u8fdb\u884c\u8bd1\u7801\u3002\u8fd9\u4e00\u5c42\u5c06\u5904\u7406\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b\u7684\u5305\uff08TLP\u3001DLLP\u3001Ordered-set\uff09\u5728\u7269\u7406\u94fe\u8def\u4e0a\u7684\u53d1\u9001\u4e0e\u63a5\u6536\u3002\u6570\u636e\u5305\u5728\u53d1\u9001\u7aef\u8981\u7ecf\u8fc7byte striping logic\uff08\u5b57\u8282\u6761\u5e26\u5316\u903b\u8f91\uff0c\u4e3b\u8981\u5728\u591alane\u65f6\u4f53\u73b0\u4f5c\u7528\uff09\u3001Scrambler\uff08\u6270\u7801\u5668\uff09\u30018b/10b encoder\uff08\u5bf9\u4e8eGen1/Gen\uff09\u6216\u662f128b/130b\u7f16\u7801\u5668\uff08\u5bf9\u4e8eGen3\uff09\u4ee5\u53ca\u6570\u636e\u5305\u5e76\u4e32\u8f6c\u6362\u6a21\u5757\u7684\u5904\u7406\u3002\u6700\u7ec8\u6570\u636e\u5305\u4ee5\u8bad\u7ec3\u540e\u7684\u94fe\u8def\u901f\u7387\u5728\u6240\u6709Lane\uff08\u901a\u9053\uff09\u4e0a\u6309\u7167\u65f6\u949f\u4ee5\u5dee\u5206\u5f62\u5f0f\u8f93\u51fa\u3002\u5728\u7269\u7406\u5c42\u7684\u63a5\u6536\u7aef\uff0c\u6570\u636e\u5305\u7684\u5904\u7406\u5305\u62ec\u4e32\u884c\u7684\u63a5\u6536\u5dee\u5206\u4fe1\u53f7\u6240\u4f20\u8f93\u7684\u7ecf\u8fc7\u7f16\u7801\u7684bit\uff0c\u5c06\u5176\u8f6c\u6362\u4e3a\u6570\u5b57\u4fe1\u53f7\u5f62\u5f0f\uff0c\u7136\u540e\u5c06\u8f93\u5165\u6bd4\u7279\u6d41\u505a\u4e32\u5e76\u8f6c\u6362\u3002\u5b8c\u6210\u8fd9\u4e2a\u64cd\u4f5c\uff08\u5bf9\u8f93\u5165\u6570\u636e\u7684\u91c7\u6837\uff09\u6240\u57fa\u4e8e\u7684\u65f6\u949f\u662f\u6765\u6e90\u4e8eCDR\uff08Clock and Data Recovery\uff0c\u65f6\u949f\u6570\u636e\u6062\u590d\uff09\u7535\u8def\u6240\u63d0\u4f9b\u7684\u6062\u590d\u65f6\u949f\u3002\u63a5\u6536\u4e0b\u6765\u7684\u6570\u636e\u5305\u8981\u7ecf\u8fc7elastic buffers\uff08\u5f39\u6027\u7f13\u5b58\uff09\u30018b/10b\u89e3\u7801\u5668\uff08\u5bf9\u4e8eGen1/Gen2\uff09\u6216\u8005128b/130b\u89e3\u7801\u5668\uff08\u5bf9\u4e8eGen3\uff09\u3001de-scramblers\uff08\u89e3\u6270\u5668\uff09\u4ee5\u53cabyte un-striping logic\uff08\u5b57\u8282\u53cd\u6761\u5e26\u5316\u903b\u8f91\uff09\u3002\u6700\u7ec8\uff0c\u7269\u7406\u5c42\u7684LTSSM\uff08Link Training and Status State Machine\uff0c\u94fe\u8def\u8bad\u7ec3\u4e0e\u72b6\u6001 \u72b6\u6001\u673a\uff09\u8d1f\u8d23\u8fdb\u884c\u94fe\u8def\u521d\u59cb\u5316\u4ee5\u53ca\u8bad\u7ec3\u3002\u6240\u6709\u8fd9\u4e9b\u7269\u7406\u5c42\u529f\u80fd\u5c06\u5728\u672c\u4e66\u7684\u7b2c\u56db\u90e8\u5206Part Four\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p>\u6bcf\u4e2aPCIe\u63a5\u53e3\u90fd\u652f\u6301\u8fd9\u4e9b\u5c42\u7684\u529f\u80fd\uff0c\u5305\u62ecSwitch\u7aef\u53e3\uff0c\u5982\u56fe 2\u201113\u6240\u793a\u3002</p> <p></p> <p>\u56fe 2\u201113 Switch\u7aef\u53e3\u7684\u5c42\u6b21</p> <p>\u5728\u65e9\u671f\u5927\u5bb6\u7ecf\u5e38\u4f1a\u4ea7\u751f\u4e00\u4e2a\u7591\u95ee\uff0c\u90a3\u5c31\u662f\u4e00\u4e2aSwitch\u7aef\u53e3\u662f\u5426\u8fd8\u9700\u8981\u5b9e\u73b0\u6240\u6709\u7684\u5c42\u5462\uff0c\u6bd5\u7adf\u5b83\u901a\u5e38\u53ea\u7528\u4e8e\u8f6c\u53d1\u6570\u636e\u5305\u3002\u7b54\u6848\u662f\u9700\u8981\uff0c\u56e0\u4e3a\u5bf9\u5305\u7684\u5185\u5bb9\u8fdb\u884c\u89e3\u6790\u6765\u786e\u5b9a\u5b83\u4eec\u7684\u8def\u7531\u662f\u9700\u8981\u67e5\u770b\u6570\u636e\u5305\u7684\u5185\u90e8\u7ec6\u8282\u7684\uff0c\u800c\u8fd9\u4ef6\u4e8b\u60c5\u662f\u5728\u4e8b\u52a1\u5c42\uff08Transaction Layer\uff09\u4e2d\u505a\u7684\u3002</p> <p>\u539f\u5219\u4e0a\uff0c\u672c\u8bbe\u5907\u4e0a\u7684\u6bcf\u4e2a\u5c42\u90fd\u4e0e\u94fe\u8def\u5bf9\u7aef\u8bbe\u5907\u7684\u5404\u81ea\u5bf9\u5e94\u5c42\u8fdb\u884c\u901a\u4fe1\uff0c\u4f8b\u5982\u672c\u8bbe\u5907\u7684\u4e8b\u52a1\u5c42\u4e0e\u5bf9\u7aef\u7684\u4e8b\u52a1\u5c42\u901a\u4fe1\u3001\u672c\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e0e\u5bf9\u7aef\u7684\u6570\u636e\u94fe\u8def\u5c42\u901a\u4fe1\u3002\u4e0a\u9762\u7684\u4e24\u5c42\u901a\u8fc7\u5728\u6570\u636e\u5305\u5185\u6dfb\u52a0\u4e00\u4e32\u7279\u5b9a\u7684bit\u4fe1\u606f\uff0c\u4ea7\u751f\u4e00\u4e2a\u63a5\u6536\u7aef\u7684\u5bf9\u5e94\u5c42\u53ef\u4ee5\u8bc6\u522b\u7684\u5b57\u6bb5\u6837\u5f0f\u6765\u5b9e\u73b0\u5bf9\u5e94\u5c42\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u6570\u636e\u5305\u901a\u8fc7\u5176\u4ed6\u5c42\u7684\u8f6c\u53d1\uff0c\u4ece\u800c\u505a\u5230\u5230\u8fbe\u6216\u8005\u79bb\u5f00\u94fe\u8def\u3002\u7269\u7406\u5c42\u4e5f\u76f4\u63a5\u4e0e\u53e6\u4e00\u4e2a\u8bbe\u5907\u4e2d\u7684\u7269\u7406\u5c42\u901a\u4fe1\uff0c\u4f46\u662f\u65b9\u5f0f\u4e0e\u6b64\u4e0d\u540c\u3002</p> <p>\u5728\u6211\u4eec\u8bb2\u7684\u66f4\u6df1\u5165\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u5148\u5927\u81f4\u4e86\u89e3\u4e00\u4e0b\u8fd9\u4e9b\u5c42\u662f\u5982\u4f55\u4ea4\u4e92\u7684\u3002\u4ece\u5e7f\u4e49\u4e0a\u8bf4\uff0c\u8bbe\u5907\u6240\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u6216\u8005\u5b8c\u6210\u5305\u662f\u5728\u4e8b\u52a1\u5c42\u8fdb\u884c\u7ec4\u5305\u7684\uff0c\u7ec4\u5305\u6240\u7528\u5230\u7684\u4fe1\u606f\u662f\u7531device core\u6240\u63d0\u4f9b\u7684\uff0c\u6709\u65f6\u6211\u4eec\u5c06device core\u79f0\u4e3aSoftware Layer\u8f6f\u4ef6\u5c42\uff08\u5c3d\u7ba1\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u4f7f\u7528\u8fd9\u4e00\u672f\u8bed\uff09\u3002\u5b83\u63d0\u4f9b\u7684\u7ec4\u5305\u4fe1\u606f\u901a\u5e38\u5305\u62ec\u671f\u671b\u7684\u547d\u4ee4\u7c7b\u578b\u3001\u76ee\u6807\u8bbe\u5907\u7684\u5730\u5740\u3001\u8bf7\u6c42\u7684\u5c5e\u6027\u7279\u5f81\u7b49\u7b49\u3002\u521a\u7ec4\u597d\u7684\u6570\u636e\u5305\u4f1a\u88ab\u5b58\u5165\u4e00\u4e2abuffer\u79f0\u4e3aVirtual Channel\uff08\u865a\u62df\u901a\u9053\uff09\uff0c\u76f4\u5230\u8fd9\u4e2a\u5305\u53ef\u4ee5\u88ab\u53d1\u5f80\u4e0b\u4e00\u4e2a\u5c42\u7ea7\u3002\u5f53\u8fd9\u4e2a\u5305\u88ab\u5411\u4e0b\u53d1\u7ed9\u6570\u636e\u94fe\u8def\u5c42\u540e\uff0c\u6570\u636e\u94fe\u8def\u5c42\u4f1a\u5728\u6570\u636e\u5305\u4e2d\u52a0\u5165\u989d\u5916\u7684\u4fe1\u606f\u4ee5\u4f9b\u5bf9\u7aef\u7684\u63a5\u6536\u65b9\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\uff0c\u800c\u4e14\u8fd9\u4e2a\u6570\u636e\u5305\u4f1a\u5728\u672c\u5730\u50a8\u5b58\u4e0b\u6765\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u5bf9\u7aef\u68c0\u6d4b\u5230\u4f20\u8f93\u51fa\u9519\u65f6\u91cd\u65b0\u53d1\u9001\u8fd9\u4e2a\u6570\u636e\u5305\u3002\u5f53\u6570\u636e\u5305\u5230\u8fbe\u7269\u7406\u5c42\u540e\uff0c\u5b83\u88ab\u7f16\u7801\uff0c\u5e76\u4f7f\u7528\u94fe\u8def\u4e0a\u7684\u6240\u6709\u53ef\u7528\u7684\u901a\u9053\u3001\u4ee5\u5dee\u5206\u4fe1\u53f7\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u8f93\u3002</p> <p></p> <p>\u56fe 2\u201114 PCIe\u8bbe\u5907\u5c42\u6b21\u7684\u8be6\u7ec6\u6846\u56fe</p> <p>\u63a5\u6536\u7aef\u5bf9\u7269\u7406\u5c42\u7684\u8f93\u5165bit\u8fdb\u884c\u89e3\u7801\uff0c\u68c0\u67e5\u672c\u5c42\u7ea7\u6240\u80fd\u53d1\u73b0\u7684\u9519\u8bef\uff0c\u5982\u679c\u6ca1\u6709\u68c0\u67e5\u5230\u9519\u8bef\u90a3\u4e48\u5c31\u5c06\u63a5\u6536\u4e0b\u6765\u7684\u6570\u636e\u5305\u5411\u4e0a\u8f6c\u53d1\u7ed9\u6570\u636e\u94fe\u8def\u5c42\u3002\u5728\u6570\u636e\u94fe\u8def\u5c42\uff0c\u6570\u636e\u5305\u8fdb\u884c\u4e0d\u540c\u4e8e\u7269\u7406\u5c42\u7684\u9519\u8bef\u68c0\u67e5\uff0c\u5982\u679c\u6ca1\u6709\u53d1\u73b0\u9519\u8bef\u90a3\u4e48\u5c31\u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002\u8fd9\u4e2a\u6570\u636e\u5305\u5728\u4e8b\u52a1\u5c42\u88ab\u7f13\u5b58\u548c\u9519\u8bef\u68c0\u67e5\uff0c\u5e76\u88ab\u62c6\u5305\u62c6\u6210\u5404\u539f\u59cb\u4fe1\u606f\uff08\u547d\u4ee4\u3001\u5c5e\u6027\u7b49\u7b49\uff09\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8fd9\u4e9b\u539f\u59cb\u4fe1\u606f\u5185\u5bb9\u5448\u4ea4\u7ed9device core\uff0c\u8fd9\u91cc\u7684device core\u662f\u8fd9\u6b21\u6570\u636e\u4f20\u8f93\u7684\u63a5\u6536\u7aef\u8bbe\u5907\u7684device core\u3002\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u66f4\u6df1\u5165\u7684\u63a2\u7d22\u6bcf\u4e00\u4e2a\u5c42\u9700\u8981\u600e\u4e48\u505a\u624d\u80fd\u5b8c\u6210\u4e0a\u8ff0\u8fd9\u6837\u7684\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u8fc7\u7a0b\u5728\u56fe 2\u201114\u8fdb\u884c\u4e86\u5c55\u793a\u3002\u6211\u4eec\u4ece\u6700\u9876\u7aef\u5f00\u59cb\u3002</p>"},{"location":"pcie/all/#221-device-coresoftware-layer","title":"2.2.1     \u8bbe\u5907\u6838/\u8f6f\u4ef6\u5c42\uff08Device Core/Software Layer\uff09","text":"<p>Device Core\u662f\u4e00\u4e2a\u8bbe\u5907\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u4f8b\u5982\u7f51\u7edc\u63a5\u53e3\u6216\u662f\u786c\u76d8\u9a71\u52a8\u63a7\u5236\u5668\u3002\u5b83\u5e76\u4e0d\u662fPCIe\u534f\u8bae\u89c4\u8303\u4e2d\u6240\u5b9a\u4e49\u7684\u4e00\u4e2a\u5c42\u7ea7\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5f53\u505a\u4e00\u4e2aPCIe\u7684\u5c42\u7ea7\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4f4d\u4e8e\u4e8b\u52a1\u5c42\u7684\u4e0a\u65b9\uff0c\u800c\u4e14\u5b83\u662f\u6240\u6709\u8bf7\u6c42\uff08Request\uff09\u7684\u6e90\u5934\u6216\u662f\u76ee\u7684\u5730\u3002\u5b83\u4e3a\u4e8b\u52a1\u5c42\u63d0\u4f9b\u4e86\u9700\u8981\u53d1\u9001\u7684\u8bf7\u6c42\u4fe1\u606f\uff0c\u5176\u4e2d\u7684\u4fe1\u606f\u5305\u62ec\u4e8b\u52a1\u7c7b\u578b\u3001\u5730\u5740\u3001\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\u91cf\u7b49\u7b49\u3002\u5f53\u4e8b\u52a1\u5c42\u63a5\u6536\u5230\u8f93\u5165\u6570\u636e\u5305\u65f6\uff0c\u5b83\u4e5f\u662f\u4e8b\u52a1\u5c42\u5411\u4e0a\u8f6c\u53d1\u8f93\u5165\u6570\u636e\u5305\u4fe1\u606f\u7684\u76ee\u7684\u5730\u3002</p>"},{"location":"pcie/all/#222-transaction-layer","title":"2.2.2     \u4e8b\u52a1\u5c42\uff08Transaction Layer\uff09","text":"<p>\u4e3a\u4e86\u54cd\u5e94\uff08response\uff09\u6765\u81ea\u8f6f\u4ef6\u5c42\u7684\u8bf7\u6c42\uff08request\uff09\uff0c\u4e8b\u52a1\u5c42\u751f\u6210\u51fa\u7ad9\u6570\u636e\u5305\uff08outbound packet\uff09\u3002\u5b83\u4e5f\u4f1a\u68c0\u67e5\u5165\u7ad9\u6570\u636e\u5305\uff08inbound packet\uff09\uff0c\u5e76\u5c06\u5165\u7ad9\u6570\u636e\u5305\u5185\u5305\u542b\u7684\u4fe1\u606f\u5411\u4e0a\u8f6c\u53d1\u7ed9\u8f6f\u4ef6\u5c42\u3002\u4e8b\u52a1\u5c42\u652f\u6301non-posted\uff08\u975e\u6295\u9012\u5f0f\uff09\u8bf7\u6c42\u7684\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff08Split Transaction Protocol\uff0c\u524d\u9762\u5728PCI-X\u7684\u4ecb\u7ecd\u4e2d\u63d0\u5230\u8fc7\uff09\uff0c\u5e76\u5c06\u5165\u7ad9\u5b8c\u6210\u5305\uff08Completion\uff09\u4e0e\u5148\u524d\u4f20\u8f93\u7684\u51fa\u7ad9non-posted\u8bf7\u6c42\u5305\u5173\u8054\u8d77\u6765\uff0c\u5373\u77e5\u9053\u8fd9\u4e2a\u5b8c\u6210\u5305\u662f\u5bf9\u5e94\u5230\u54ea\u4e2anon-posted\u8bf7\u6c42\u5305\u3002\u4e8b\u52a1\u5c42\u6240\u5904\u7406\u7684\u4e8b\u52a1\u4f7f\u7528\u7684\u6570\u636e\u5305\u79cd\u7c7b\u4e3aTLP\uff08Transaction Layer Packet\uff09\uff0cTLP\u53ef\u4ee5\u5206\u4e3a\u56db\u4e2a\u8bf7\u6c42\u79cd\u7c7b\uff1a</p> <p>\\1.    Memory</p> <p>\\2.    IO</p> <p>\\3.    Configuration</p> <p>\\4.    Message</p> <p>\u524d\u4e09\u79cd\uff08Memory\u3001IO\u3001Configuration\uff09\u5728PCI\u548cPCI-X\u4e2d\u5c31\u5df2\u7ecf\u5f97\u5230\u652f\u6301\uff0c\u4f46\u662fMessage\u662fPCIe\u4e2d\u7684\u4e00\u4e2a\u65b0\u7684\u8bf7\u6c42\u79cd\u7c7b\u3002\u4e00\u4e2a\u8bf7\u6c42\u5305\u5411\u76ee\u6807\u8bbe\u5907\u4f20\u9001\u547d\u4ee4\uff0c\u76ee\u6807\u8bbe\u5907\u4f5c\u4e3a\u54cd\u5e94\u8bf7\u6c42\u800c\u53d1\u56de\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5b8c\u6210\u5305\uff0c\u8fd9\u4e8c\u8005\u7ec4\u5408\u8d77\u6765\u5c31\u662f\u5bf9\u4e00\u4e2a\u4e8b\u52a1\u7684\u5b9a\u4e49\uff0c\u5373\u4e00\u4e2a\u4e8b\u52a1\u7531\u4e00\u4e2a\u8bf7\u6c42\u5305\u4ee5\u53ca\u6240\u6709\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u5171\u540c\u7ec4\u6210\u3002\u5982\u8868 2\u20112\u5217\u51fa\u4e86PCIe\u8bf7\u6c42\u7684\u7c7b\u578b\u3002</p> <p></p> <p>\u8868 2\u20112 PCIe\u8bf7\u6c42\u7c7b\u578b</p> <p>\u8fd9\u4e9b\u8bf7\u6c42\u8fd8\u53ef\u4ee5\u88ab\u5f52\u4e3a\u4e24\u7c7b\uff0c\u5982\u4e0a\u8868\u7684\u53f3\u8fb9\u4e00\u5217\uff1anon-posted**\u548c**posted\u3002\u5bf9\u4e8enon-posted\u8bf7\u6c42\uff0cRequester\u9996\u5148\u5411Completer\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u6570\u636e\u5305\uff0cCompleter\u5e94\u8be5\u4ea7\u751f\u4e00\u4e2a\u5b8c\u6210\u5305\u4f5c\u4e3a\u54cd\u5e94\u3002\u8bfb\u8005\u4eec\u5e94\u8be5\u8ba4\u51fa\u6765\u4e86\uff0c\u8fd9\u5c31\u662f\u4ecePCI-X\u90a3\u91cc\u7ee7\u627f\u6765\u7684\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff08split transaction protocol\uff09\u3002\u4f8b\u5982\uff0c\u6240\u6709\u7684\u8bfb\u8bf7\u6c42\u90fd\u662fnon-posted\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8bfb\u8bf7\u6c42\u6240\u8bf7\u6c42\u7684\u6570\u636e\u9700\u8981\u901a\u8fc7\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u7ed9Requester\u3002\u53ef\u80fd\u4ee4\u4f60\u611f\u5230\u51fa\u4e4e\u610f\u6599\uff0cIO\u5199\u8bf7\u6c42\u548cConfiguration\u5199\u8bf7\u6c42\u4e5f\u662fnon-posted\u7684\u3002\u5c3d\u7ba1\u5b83\u4eec\u5728\u53d1\u9001\u7ed9\u76ee\u6807\u8bbe\u5907\u7684\u547d\u4ee4\u4e2d\u5c31\u5df2\u7ecf\u5305\u542b\u4e86\u8981\u5199\u5165\u76ee\u6807\u8bbe\u5907\u7684\u6570\u636e\uff0c\u4f46\u662f\u8fd9\u4e24\u79cd\u8bf7\u6c42\u4f9d\u7136\u9700\u8981\u76ee\u6807\u8bbe\u5907\u5728\u5199\u5165\u5b8c\u6210\u540e\u8fd4\u56de\u5b8c\u6210\u5305\uff0c\u4ee5\u6b64\u6765\u8ba9Requester\u786e\u8ba4\u6570\u636e\u88ab\u6b63\u786e\u65e0\u8bef\u7684\u5199\u5165\u5230\u76ee\u7684\u8bbe\u5907\u4e2d\u3002</p> <p>\u4e0e\u4e0a\u8ff0\u7684\u8bf7\u6c42\u76f8\u53cd\u5730\uff0cMemory Write\u8bf7\u6c42\uff08Mwr\uff09\u548cMessage\u8bf7\u6c42\u90fd\u662fposted\u7684\uff0c\u8fd9\u610f\u5473\u7740Completer\u5728\u5b8c\u6210\u8fd9\u4e9b\u8bf7\u6c42\u540e\u4e0d\u9700\u8981\u5411Requester\u8fd4\u56de\u5b8c\u6210\u5305TLP\u3002Posted\u4e8b\u52a1\u5bf9\u6574\u4f53\u6027\u80fd\u63d0\u5347\u662f\u6709\u597d\u5904\u7684\uff0c\u56e0\u4e3aRequester\u4e0d\u9700\u8981\u7b49\u5f85\u54cd\u5e94\uff0c\u4e5f\u4e0d\u9700\u8981\u627f\u62c5\u5bf9\u5b8c\u6210\u5305\u8fdb\u884c\u5904\u7406\u7684\u989d\u5916\u8d1f\u62c5\u3002\u8fd9\u91cc\u505a\u51fa\u7684\u53d6\u820d\u5c31\u662fRequester\u65e0\u6cd5\u5f97\u5230\u5199\u8bf7\u6c42\u662f\u5426\u88ab\u6b63\u786e\u65e0\u8bef\u7684\u5b8c\u6210\u7684\u53cd\u9988\u4fe1\u606f\u3002Posted\u8fd9\u79cd\u64cd\u4f5c\u884c\u4e3a\u7ee7\u627f\u81eaPCI\uff0c\u5b83\u4f9d\u7136\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u64cd\u4f5c\u65b9\u6cd5\uff0c\u867d\u7136\u65e0\u6cd5\u5f97\u5230\u53cd\u9988\u4fe1\u606f\uff0c\u4f46\u662f\u53d1\u751f\u9519\u8bef\u7684\u53ef\u80fd\u6027\u6bd4\u8f83\u5c0f\u5e76\u4e14\u4f7f\u7528posted\u5f97\u5230\u7684\u6027\u80fd\u63d0\u5347\u4e5f\u6bd4\u8f83\u660e\u663e\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5c3d\u7ba1\u5b83\u4eec\u8981\u6c42\u8fd4\u56de\u5b8c\u6210\u5305\uff0cPosted\u5199\u64cd\u4f5c\u4ecd\u7136\u8981\u53c2\u4e0e\u6570\u636e\u94fe\u8def\u5c42\u7684Ack/Nak\u534f\u8bae\uff0c\u4ee5\u6b64\u6765\u4fdd\u8bc1\u8f83\u4e3a\u53ef\u9760\u7684\u6570\u636e\u5305\u4f20\u8f93\u3002\u5173\u4e8e\u8fd9\u4e00\u70b9\u7684\u66f4\u591a\u5185\u5bb9\uff0c\u8bf7\u89c1Chapter 10\u201cAck/Nak Protocol\u201d\u3002</p>"},{"location":"pcie/all/#2221-tlp","title":"2.2.2.1   TLP\u57fa\u7840\u5185\u5bb9","text":"<p>PCIe\u8bf7\u6c42\u5305\u548c\u5b8c\u6210\u5305\u7684\u5305\u7c7b\u578b\u88ab\u7f57\u5217\u5728\u8868 2\u20113\u4e2d\u3002</p> <p></p> <p>\u8868 2\u20113 PCIe TLP\u7c7b\u578b</p> <p>TLPs\u8d77\u59cb\u4e8e\u53d1\u9001\u65b9\u7684\u4e8b\u52a1\u5c42\uff0c\u7ec8\u6b62\u4e8e\u63a5\u6536\u65b9\u7684\u4e8b\u52a1\u5c42\uff0c\u5982\u56fe 2\u201115\u6240\u793a\u3002</p> <p></p> <p>\u56fe 2\u201115 TLP\u7684\u8d77\u70b9\u4e0e\u76ee\u7684\u5730</p> <p>\u5f53TLP\u9014\u7ecf\u53d1\u9001\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u4ee5\u53ca\u7269\u7406\u5c42\u65f6\uff0c\u8fd9\u4e24\u5c42\u5206\u522b\u4f1a\u5411\u6570\u636e\u5305\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u4fe1\u606f\uff0c\u63a5\u6536\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u4f1a\u5206\u522b\u6839\u636e\u53d1\u9001\u65b9\u5bf9\u5e94\u5c42\u6240\u6dfb\u52a0\u7684\u4fe1\u606f\u6765\u8fdb\u884c\u6821\u9a8c\uff0c\u4ee5\u6b64\u786e\u8ba4\u6570\u636e\u5305\u662f\u5426\u5728\u94fe\u8def\u4f20\u8f93\u4e2d\u4f9d\u65e7\u4fdd\u6301\u6b63\u786e\u6ca1\u6709\u51fa\u9519\u3002</p>"},{"location":"pcie/all/#l-tlptlp-packet-assembly","title":"l TLP\u7ec4\u5305\uff08TLP Packet Assembly\uff09","text":"<p>\u5982\u5c55\u793a\u4e86\u4e00\u4e2a\u5c01\u88c5\u5b8c\u6210\u7684TLP\u7684\u5404\u4e2a\u90e8\u5206\u662f\u5982\u4f55\u5728\u94fe\u8def\u4e0a\u8fdb\u884c\u4f20\u8f93\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u4e2d\u53d1\u73b0\u8fd9\u4e2a\u6570\u636e\u5305\u4e2d\u7684\u4e0d\u540c\u90e8\u5206\u662f\u5206\u522b\u7531\u4e0d\u540c\u7684\u5c42\u6765\u6dfb\u52a0\u7684\u3002\u4e3a\u4e86\u66f4\u5bb9\u6613\u770b\u51fa\u8fd9\u4e2a\u6570\u636e\u5305\u662f\u600e\u4e48\u6784\u6210\u7684\uff0c\u6211\u4eec\u5c06TLP\u7684\u4e0d\u540c\u90e8\u5206\u7528\u4e0d\u540c\u7684\u989c\u8272\u8fdb\u884c\u6807\u8bc6\uff0c\u4ee5\u6b64\u6765\u8868\u793a\u5bf9\u5e94\u7684\u90e8\u5206\u662f\u7531\u54ea\u4e00\u5c42\u6dfb\u52a0\u7684\uff1a\u7ea2\u8272\u4ee3\u8868\u4e8b\u52a1\u5c42\uff0c\u84dd\u8272\u4ee3\u8868\u6570\u636e\u94fe\u8def\u5c42\uff0c\u7eff\u8272\u4ee3\u8868\u7269\u7406\u5c42\u3002</p> <p></p> <p>\u56fe 2\u201116 TLP\u7684\u7ec4\u5305\u5f62\u5f0f</p> <p>Device Core\u8d1f\u8d23\u5c06\u7ec4\u6210TLP\u7684\u6838\u5fc3\u90e8\u5206\u7684\u4fe1\u606f\u53d1\u9001\u7ed9\u4e8b\u52a1\u5c42\uff0c\u5373\u4e0a\u56fe\u4e2d\u7684Header\u548cData\u3002\u6bcf\u4e2aTLP\u90fd\u4f1a\u6709\u4e00\u4e2aHeader\uff08\u5934\u90e8\uff09\uff0c\u800c\u6709\u4e9bTLP\u4f1a\u6ca1\u6709\u6570\u636e\u90e8\u5206\uff0c\u4f8b\u5982\u8bfb\u8bf7\u6c42\u3002\u4e8b\u52a1\u5c42\u8fd8\u53ef\u4ee5\u9009\u62e9\u6dfb\u52a0ECRC\uff08End-to-End CRC\uff09\u5b57\u6bb5\uff0c\u8fd9\u4e2aECRC\u7531\u4e8b\u52a1\u5c42\u8fdb\u884c\u8ba1\u7b97\u5e76\u9644\u52a0\u5728\u6570\u636e\u5305\u7684\u540e\u9762\u3002CRC\u7684\u610f\u601d\u662fCyclic Redundancy Check/Code\uff08\u5faa\u73af\u5197\u4f59\u6821\u9a8c/\u5faa\u73af\u5197\u4f59\u6821\u9a8c\u7801\uff09\uff0c\u5b83\u88ab\u51e0\u4e4e\u6240\u6709\u7684\u4e32\u884c\u4f20\u8f93\u67b6\u6784\u6240\u4f7f\u7528\uff0c\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u5b83\u5b9e\u73b0\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\u540c\u65f6\u53c8\u80fd\u63d0\u4f9b\u5f88\u5f3a\u7684\u9519\u8bef\u68c0\u6d4b\u529f\u80fd\u3002CRC\u8fd8\u53ef\u4ee5\u68c0\u6d4b\u201c\u7a81\u53d1\u9519\u8bef\uff08burst error\uff09\u201d\uff0c\u5373\u4e00\u4e32\u91cd\u590d\u7684\u9519\u8befbit\uff0c\u8fd9\u4e00\u4e32bit\u7684\u957f\u5ea6\u53d6\u51b3\u4e8eCRC\u7684\u957f\u5ea6\uff08\u5bf9\u4e8ePCIe\u6765\u8bf4\u662f32bits\uff09\u3002\u56e0\u4e3a\u8fd9\u79cd\u7c7b\u578b\u7684\u9519\u8bef\u5728\u53d1\u9001\u4e00\u957f\u4e32bit\u65f6\u4f1a\u9047\u5230\uff0c\u56e0\u6b64CRC\u7684\u8fd9\u79cd\u7279\u6027\u975e\u5e38\u9002\u7528\u4e8e\u4e32\u884c\u4f20\u8f93\u3002ECRC\u5b57\u6bb5\u533a\u57df\u5728\u901a\u8fc7\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u4e4b\u95f4\u7684\u4efb\u4f55\u670d\u52a1\u70b9\uff08service point\uff0c\u901a\u5e38\u6307\u7684\u662fSwitch\u6216\u8005Root\u7aef\u53e3\u8fd9\u4e9b\u6709TLP\u8def\u7531\u529f\u80fd\u7684\u5730\u65b9\uff09\u65f6\u90fd\u4e0d\u6539\u53d8\uff0c\u8fd9\u4f7f\u5f97\u76ee\u7684\u7aef\u53ef\u4ee5\u7528\u5b83\u6765\u9a8c\u8bc1\u5728\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u90fd\u6ca1\u6709\u53d1\u751f\u9519\u8bef\u3002</p> <p>\u73b0\u5728\u8bf4\u8bf4TLP\u7684\u4f20\u8f93\uff0cTLP\u7684\u6838\u5fc3\u90e8\u5206\u7531\u4e8b\u52a1\u5c42\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\uff0c\u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8d23\u5728TLP\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u548c\u53e6\u5916\u4e00\u4e2aCRC\u5b57\u6bb5\u533a\u57df\u79f0\u4e3a\u94fe\u8defCRC\uff08LCRC\uff0cLink CRC\uff09\u3002LCRC\u88ab\u5bf9\u7aef\u63a5\u6536\u65b9\u7528\u6765\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\uff0c\u5e76\u5c06\u94fe\u8def\u4e0a\u4f20\u8f93\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u7684\u68c0\u67e5\u7ed3\u679c\u90fd\u6c47\u62a5\u7ed9\u53d1\u9001\u65b9\u3002\u5584\u4e8e\u601d\u8003\u7684\u8bfb\u8005\u53ef\u80fd\u4f1a\u6709\u7591\u95ee\uff0c\u5982\u679cLCRC\u5df2\u7ecf\u8bc1\u660e\u4e86\u8fd9\u6b21\u94fe\u8def\u4f20\u8f93\u662f\u65e0\u5dee\u9519\u7684\uff0c\u800cLCRC\u53c8\u662f\u6570\u636e\u5305\u5fc5\u9700\u542b\u6709\u7684\u5b57\u6bb5\uff0c\u90a3\u4e48ECRC\u8fd8\u6709\u4ec0\u4e48\u4f5c\u7528\u5462\uff1f\u8fd9\u4e2a\u7591\u95ee\u7684\u56de\u7b54\u662f\uff0c\u8fd8\u4f7f\u7528ECRC\u662f\u56e0\u4e3a\u8fd8\u6709\u4e00\u4e2a\u5730\u65b9\u7684\u4f20\u8f93\u9519\u8bef\u6ca1\u6709\u88ab\u68c0\u67e5\uff0c\u90a3\u5c31\u662f\u8d1f\u8d23\u8def\u7531\u6570\u636e\u5305\u7684\u8bbe\u5907\u5185\u90e8\u3002\u4e00\u4e2a\u6570\u636e\u5305\u5230\u8fbe\u4e00\u4e2a\u7aef\u53e3\uff0c\u5e76\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\uff0c\u4e5f\u8fdb\u884c\u8def\u7531\u68c0\u67e5\uff0c\u7136\u540e\u5f53\u5b83\u88ab\u4ece\u53e6\u4e00\u4e2a\u7aef\u53e3\u53d1\u51fa\u65f6\u4f1a\u8ba1\u7b97\u51fa\u4e00\u4e2a\u65b0\u7684LCRC\u503c\u5e76\u6dfb\u52a0\u5728\u6570\u636e\u5305\u4e2d\uff0c\u65b0\u7684LCRC\u4f1a\u53d6\u4ee3\u8001\u7684LCRC\u3002\u5185\u90e8\u7aef\u53e3\u4e4b\u95f4\u7684\u8f6c\u53d1\u53ef\u80fd\u4f1a\u9047\u5230PCIe\u534f\u8bae\u6ca1\u6709\u68c0\u67e5\u5230\u7684\u9519\u8bef\uff0c\u8fd9\u65f6\u5019\u5c31\u9700\u8981ECRC\u6765\u53d1\u6325\u5b83\u7684\u4f5c\u7528\u4e86\u3002\u8fd9\u91cc\u53ef\u4ee5\u7406\u89e3\u4e3a\uff0c\u5f53TLP\u5230\u8fbeSwitch\u7684\u4e00\u4e2a\u63a5\u6536\u7aef\u53e3\u65f6\uff0cSwitch\u4f1a\u5728\u63a5\u6536\u7aef\u53e3\u5bf9\u5176LCRC\u8fdb\u884c\u6821\u9a8c\uff0c\u7136\u540e\u6839\u636e\u8def\u7531\u4fe1\u606f\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u8f6c\u53d1\uff0c\u4f46\u662f\u8fd9\u4e2a\u8f6c\u53d1\u8fc7\u7a0b\u662f\u4e0d\u5bf9LCRC\u8fdb\u884c\u6821\u9a8c\u7684\uff0c\u76f4\u5230\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684\u8f93\u51fa\u7aef\u53e3\uff0c\u7136\u540e\u5728\u8f93\u51fa\u7aef\u53e3\u7ed9\u6570\u636e\u5305\u52a0\u4e0a\u65b0\u7684LCRC\u540e\u53d1\u9001\u51fa\u53bb\uff0c\u4e0d\u96be\u53d1\u73b0\u56e0\u4e3a\u5728\u5185\u90e8\u8f6c\u53d1\u8fc7\u7a0b\u4e2d\u4e0d\u5bf9LCRC\u8fdb\u884c\u6821\u9a8c\uff0c\u56e0\u6b64\u82e5\u8f6c\u53d1\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u9519\u8bef\u5219\u5c31\u9700\u8981\u901a\u8fc7\u66f4\u5185\u5c42\u5c01\u88c5\u7684ECRC\u6765\u8fdb\u884c\u6821\u9a8c\u4e86\uff0c\u5426\u5219\u5185\u90e8\u8f6c\u53d1\u8fc7\u7a0b\u662f\u5426\u51fa\u9519\u5c06\u65e0\u4ece\u53ef\u77e5\u3002</p> <p>\u6700\u540e\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c01\u88c5\u597d\u7684\u6570\u636e\u5305\u88ab\u8f6c\u53d1\u7ed9\u7269\u7406\u5c42\uff0c\u7269\u7406\u5c42\u5c06\u5176\u4ed6\u4e00\u4e9b\u5b57\u7b26\u6dfb\u52a0\u5230\u6570\u636e\u5305\u4e2d\uff0c\u8fd9\u4e9b\u5b57\u7b26\u53ef\u4ee5\u8ba9\u63a5\u6536\u65b9\u77e5\u9053\u63a5\u4e0b\u6765\u5c06\u4f1a\u63a5\u6536\u4ec0\u4e48\uff08\u4f8b\u5982\u6807\u8bc6\u4e00\u4e2a\u6570\u636e\u5305\u7684\u5f00\u59cb\u6216\u7ed3\u5c3e\uff09\u3002\u5bf9\u4e8e\u524d\u4e24\u4ee3\u7684PCIe\uff0c\u7269\u7406\u5c42\u5c06\u5728\u6570\u636e\u5305\u7684\u5934\u548c\u5c3e\u6dfb\u52a0\u63a7\u5236\u5b57\u7b26\u3002\u800c\u5728\u7b2c\u4e09\u4ee3PCIe\u4e2d\u4e0d\u518d\u4f7f\u7528\u63a7\u5236\u5b57\u7b26\uff0c\u800c\u662f\u5728\u6570\u636e\u5305\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684bit\u6765\u63d0\u4f9b\u5173\u4e8e\u6570\u636e\u5305\u7684\u4fe1\u606f\u3002\u7ecf\u8fc7\u8fd9\u4e9b\u5904\u7406\u540e\uff0c\u6570\u636e\u5305\u88ab\u7f16\u7801\uff088b/10b for Gen1/Gen2\uff0c128b/130b for Gen3\uff09\uff0c\u7136\u540e\u5728\u94fe\u8def\u4e0a\u6240\u6709\u53ef\u7528\u901a\u9053\u4e2d\u4ee5\u5dee\u5206\u5f62\u5f0f\u4f20\u8f93\u3002</p>"},{"location":"pcie/all/#l-tlptlp-packet-disassembly","title":"l TLP\u62c6\u5305\uff08TLP Packet Disassembly\uff09","text":"<p>\u5f53\u5bf9\u7aef\u7684\u63a5\u6536\u65b9\u770b\u5230\u4e86\u8f93\u5165\u7684\u6bd4\u7279\u6d41\u65f6\uff0c\u5b83\u9700\u8981\u5bf9\u6b64\u524d\u7ec4\u5305\u65f6\u6dfb\u52a0\u7684\u54ea\u4e9b\u90e8\u5206\u8fdb\u884c\u8bc6\u522b\u548c\u5265\u9664\uff0c\u8fd9\u6837\u5c31\u80fd\u6062\u590d\u51fa\u53d1\u9001\u65b9\u8bbe\u5907\u7684Device Core\u7684\u539f\u59cb\u8bf7\u6c42\u4fe1\u606f\u3002\u5982\u56fe 2\u201117\u6240\u793a\uff0c\u7269\u7406\u5c42\u5c06\u4f1a\u786e\u8ba4\u5f53\u524d\u6bd4\u7279\u6d41\u4e2d\u662f\u5426\u5b58\u5728\u6b63\u786e\u7684\u201c\u8d77\u59cb\u201d\u3001\u201c\u7ed3\u675f\u201d\u6216\u8005\u5176\u4ed6\u5b57\u7b26\uff0c\u5e76\u5c06\u5b83\u4eec\u5265\u9664\uff0c\u7136\u540e\u5c06\u5265\u9664\u4e86\u8fd9\u4e9b\u5b57\u7b26\u540e\u7684TLP\u8f6c\u53d1\u7ed9\u6570\u636e\u94fe\u8def\u5c42\u3002\u6570\u636e\u94fe\u8def\u5c42\u5c06\u9996\u5148\u8fdb\u884cLCRC\u4ee5\u53ca\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u7684\u9519\u8bef\u6821\u9a8c\u3002\u5982\u679c\u5e76\u672a\u53d1\u73b0\u9519\u8bef\uff0c\u90a3\u4e48\u6570\u636e\u94fe\u8def\u5c42\u5c06\u4f1a\u628aLCRC\u548c\u5e8f\u5217\u53f7\u4eceTLP\u5265\u9664\uff0c\u5e76\u5c06TLP\u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002\u5982\u679c\u63a5\u6536\u65b9\u662f\u4e00\u4e2aSwitch\uff0c\u90a3\u4e48\u5c06\u5728\u4e8b\u52a1\u5c42\u5bf9\u8fd9\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u89e3\u6790\u8bc4\u4f30\uff0c\u4ece\u5b83\u7684\u6570\u636e\u5305\u5934\u4e2d\u627e\u5230\u8def\u7531\u4fe1\u606f\u6765\u786e\u5b9a\u8fd9\u4e2a\u6570\u636e\u5305\u8981\u88ab\u8f6c\u53d1\u5230\u54ea\u4e00\u4e2a\u7aef\u53e3\u3002\u5373\u4f7f\u8fd9\u4e2aSwitch\u5e76\u4e0d\u662fTLP\u6700\u7ec8\u7684\u76ee\u7684\u5730\uff0c\u5b83\u4e5f\u53ef\u4ee5\u5bf9\u8fd9\u4e2aTLP\u8fdb\u884cECRC\u6821\u9a8c\u4ee5\u53ca\u5728\u53d1\u73b0\u9519\u8bef\u65f6\u8fdb\u884cECRC\u9519\u8bef\u6c47\u62a5\u3002\u4f46\u662f\uff0c Switch\u4e0d\u80fd\u66f4\u6539\u8fd9\u4e2aTLP\u4e2d\u7684ECRC\uff0c\u8fd9\u662f\u5e0c\u671b\u6700\u7ec8\u7684\u76ee\u6807\u8bbe\u5907\u4e5f\u53ef\u4ee5\u68c0\u6d4b\u5230\u8fd9\u4e2aECRC\u9519\u8bef\u3002</p> <p>\u5982\u679c\u76ee\u6807\u8bbe\u5907\u6709\u80fd\u529b\u5e76\u4e14\u542f\u7528\u4e86ECRC\u6821\u9a8c\u7684\u529f\u80fd\uff0c\u90a3\u4e48\u5b83\u5c06\u5bf9ECRC\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002\u82e5TLP\u5230\u8fbe\u4e86\u6700\u7ec8\u7684\u76ee\u7684\u8bbe\u5907\uff0c\u800c\u4e14\u6821\u9a8c\u65e0\u9519\uff0c\u90a3\u4e48\u5728\u4e8b\u52a1\u5c42\u4e2d\u5c06\u628a\u8fd9\u4e2aECRC\u5b57\u6bb5\u5265\u9664\uff0c\u4f7f\u5f97\u6574\u4e2a\u6570\u636e\u5305\u53ea\u5269\u4e0bHeader\u548c\u6570\u636e\u90e8\u5206\uff0c\u5e76\u5c06\u8fd9\u4e9b\u5269\u4f59\u90e8\u5206\u8f6c\u53d1\u7ed9\u8f6f\u4ef6\u5c42\u3002</p> <p></p> <p>\u56fe 2\u201117 TLP\u7684\u62c6\u5305\u5f62\u5f0f</p>"},{"location":"pcie/all/#2222-non-posted","title":"2.2.2.2   Non-Posted\u4e8b\u52a1","text":""},{"location":"pcie/all/#l-ordinary-reads","title":"l \u666e\u901a\u8bfb\uff08Ordinary Reads\uff09","text":"<p>\u5982\u56fe 2\u201118\u5c55\u793a\u4e86\u4e00\u4e2aMemory Read\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u7531EP\u53d1\u5f80\u7cfb\u7edfmemory\u3002\u5728Memory Read\u8bf7\u6c42TLP\u4e2d\u6709\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u90e8\u5206\uff0c\u90a3\u5c31\u662f\u76ee\u6807\u5730\u5740\uff08\u5173\u4e8e\u66f4\u591a\u6709\u5173TLP\u5185\u5bb9\u7684\u8be6\u7ec6\u8bb2\u89e3\uff0c\u8bf7\u89c1Chapter 5 \u201cTLP Element\u201d\uff09\u3002\u4e00\u4e2aMemory\u8bf7\u6c42\u7684\u5730\u5740\u53ef\u4ee5\u662f32bit\u6216\u800564bit\u7684\uff0c\u8fd9\u4e5f\u51b3\u5b9a\u4e86\u6570\u636e\u5305\u7684\u8def\u7531\u65b9\u5f0f\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u4e8b\u52a1\u901a\u8fc7\u4e24\u4e2aSwitch\u7684\u8def\u7531\u540e\u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e86\u76ee\u6807\u8bbe\u5907\uff0c\u4f8b\u5b50\u4e2d\u7684\u76ee\u6807\u8bbe\u5907\u4e3aRC\u3002\u5f53RC\u5bf9\u8bf7\u6c42\u5305\u8fdb\u884c\u8bd1\u7801\uff0c\u5e76\u8bc6\u522b\u51fa\u4e86\u6570\u636e\u5305\u4e2d\u7684\u5730\u5740\u6307\u5411\u4e86\u7cfb\u7edfmemory\uff0c\u5b83\u5c06\u4ece\u90a3\u6bb5\u7cfb\u7edfmemory\u4e2d\u53d6\u51faEP\u6240\u8bf7\u6c42\u7684\u6570\u636e\u3002\u4e3a\u4e86\u5c06\u8fd9\u4e9b\u4ecememory\u4e2d\u53d6\u51fa\u6765\u7684\u6570\u636e\u8fd4\u56de\u7ed9Requester\uff0cRC\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\u5c06\u4ea7\u751f\u8db3\u591f\u591a\u7684\u5b8c\u6210\u5305\uff08Completion\uff09\uff0c\u8fd9\u4e9b\u6570\u91cf\u7684\u5b8c\u6210\u5305\u8db3\u4ee5\u5c06Requester\u6240\u8bf7\u6c42\u7684\u5168\u90e8\u6570\u636e\u90fd\u8fd4\u56de\u56de\u53bb\u3002PCIe\u4e2d\u89c4\u5b9a\u4e00\u4e2a\u6570\u636e\u5305\u4e2d\u6570\u636e\u8377\u8f7d\uff08data payload\uff09\u6700\u5927\u4e3a4KB\uff0c\u4f46\u662f\u5b9e\u9645\u8bbe\u8ba1\u7684\u8bbe\u5907\u4e2d\u4e00\u822c\u4f1a\u4f7f\u7528\u7684payload\u4f1a\u6bd44KB\u5c0f\uff0c\u56e0\u6b64\u9700\u8981\u597d\u51e0\u4e2a\u5b8c\u6210\u5305\u624d\u80fd\u8db3\u591f\u5c06\u6bd4\u8f83\u5927\u91cf\u7684\u6570\u636e\u8fd4\u56de\u7ed9Requester\u3002</p> <p>\u8fd9\u4e9b\u5b8c\u6210\u5305\u5185\u4e5f\u5305\u542b\u4e86\u8def\u7531\u4fe1\u606f\uff0c\u7528\u4e8e\u5c06\u5b83\u4eec\u6307\u5f15\u56de\u5230Requester\uff0c\u8fd9\u662f\u56e0\u4e3aRequester\u5728\u539f\u5148\u7684\u8bf7\u6c42\u5305\u4e2d\u5c31\u9644\u5e26\u4e86\u9700\u8981\u8fd4\u56de\u7684\u5730\u5740\u7684\u4fe1\u606f\uff0c\u6240\u4ee5Completer\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5730\u5740\u7528\u6765\u653e\u5728\u5b8c\u6210\u5305\u4e2d\u4f5c\u4e3a\u5b8c\u6210\u5305\u7684\u8def\u7531\u4fe1\u606f\u3002\u8fd9\u4e2a\u201c\u8fd4\u56de\u5730\u5740\u201d\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5b83\u5c31\u662fPCI\u4e2d\u5b9a\u4e49\u7684Device ID\uff0c\u8fd9\u4e2aID\u7531\u4e09\u4e2a\u4e1c\u897f\u7ec4\u6210\uff1aRequester\u6240\u5c5ePCI\u603b\u7ebf\u5728\u7cfb\u7edf\u4e2d\u7684PCI\u603b\u7ebf\u53f7\u3001Requester\u5728\u6240\u5c5ePCI\u603b\u7ebf\u4e0a\u7684\u8bbe\u5907\u53f7\u3001Requester\u5728\u6240\u5c5e\u8bbe\u5907\u4e2d\u7684Function\u53f7\u3002\u8fd9\u6837\u7684\u603b\u7ebf\u53f7\u3001\u8bbe\u5907\u53f7\u3001Function\u53f7\u7ec4\u5408\u8d77\u6765\u7684\u4fe1\u606f\uff08\u6709\u65f6\u88ab\u7f29\u5199\u4e3aBDF\uff0cBus\u3001Device\u3001Function\uff09\u5c31\u662f\u5b8c\u6210\u5305\u7528\u6765\u8fd4\u56de\u5230Requester\u7684\u8def\u7531\u4fe1\u606f\u3002\u6b63\u5982PCI-X\u6240\u505a\u7684\u90a3\u6837\uff0cRequester\u53ef\u4ee5\u540c\u65f6\u6709\u591a\u4e2a\u6b63\u5728\u8fdb\u884c\u7684\u62c6\u5206\u4e8b\u52a1\uff08split transaction\uff09\uff0c\u5b83\u5fc5\u987b\u80fd\u591f\u5c06\u8f93\u5165\u7684\u5b8c\u6210\u5305\u548c\u6b63\u786e\u7684\u8bf7\u6c42\u5173\u8054\u8d77\u6765\u3002\u4e3a\u4e86\u4fbf\u4e8e\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff0cRequester\u5728\u539f\u5148\u7684\u8bf7\u6c42\u5305\u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\u503c\u79f0\u4e3aTag\uff0c\u8fd9\u4e2aTag\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u800c\u8a00\u90fd\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e00\u4e2a\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u90fd\u6709\u4e00\u4e2a\u4e0e\u5176\u4ed6\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u4e0d\u540c\u7684Tag\u53f7\u3002Completer\u4f1a\u5c06\u8fd9\u4e2a\u4e8b\u52a1\u7684Tag\u62f7\u8d1d\u8fdb\u5b8c\u6210\u5305\u4e2d\uff0c\u8fd9\u6837Requester\u5c31\u53ef\u4ee5\u5feb\u901f\u5730\u901a\u8fc7\u5b8c\u6210\u5305\u4e2d\u7684Tag\u6765\u5c06\u8fd9\u4e2a\u5b8c\u6210\u5305\u4e0e\u6b63\u786e\u7684\u8bf7\u6c42\u5173\u8054\u8d77\u6765\uff0c\u4e5f\u5c31\u662f\u627e\u5230\u4e86\u8fd9\u4e2a\u5b8c\u6210\u5305\u662f\u7528\u6765\u670d\u52a1\u54ea\u4e2a\u8bf7\u6c42\u7684\u3002\u6700\u540e\u8fd8\u8981\u8bf4\u4e00\u70b9\uff0cCompleter\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u5b8c\u6210\u5305\u4e2d\u7684\u5b8c\u6210\u72b6\u6001\u5b57\u6bb5\u4e2d\u7684bit\uff0c\u4ee5\u6b64\u6765\u8868\u793a\u51fa\u4e8b\u52a1\u7684\u9519\u8bef\u60c5\u51b5\u3002\u8fd9\u81f3\u5c11\u53ef\u4ee5\u8ba9Requester\u5bf9\u54ea\u91cc\u53ef\u80fd\u51fa\u9519\u4e86\u6709\u4e00\u4e2a\u5927\u81f4\u7684\u4e86\u89e3\u3002Requester\u5982\u4f55\u53bb\u5904\u7406\u5927\u591a\u6570\u7684\u9519\u8bef\uff0c\u8fd9\u4e2a\u4e8b\u60c5\u4e00\u822c\u662f\u7531\u8f6f\u4ef6\u6765\u51b3\u5b9a\uff0c\u8fd9\u5e76\u4e0d\u5728PCIe\u534f\u8bae\u89c4\u8303\u7684\u8303\u56f4\u5185\u3002</p> <p></p> <p>\u56fe 2\u201118 Non-Posted Read\u7684\u793a\u4f8b</p>"},{"location":"pcie/all/#l-locked-reads","title":"l \u9501\u5b9a\u8bfb\uff08Locked Reads\uff09","text":"<p>Locked Memory Read\u8fd9\u79cd\u8bfb\u8bf7\u6c42\u662f\u4e3a\u4e86\u652f\u6301\u4e00\u79cd\u53eb\u505a\u539f\u5b50\u8bfb-\u4fee\u6539-\u5199\u64cd\u4f5c\uff0c\u6240\u8c13\u539f\u5b50\u64cd\u4f5c\u5c31\u662f\u4e00\u79cd\u4e0d\u53ef\u4e2d\u65ad\u7684\u4e8b\u52a1\uff0c\u5904\u7406\u5668\u4f7f\u7528\u8fd9\u79cd\u4e8b\u52a1\u6765\u8fdb\u884c\u6d4b\u8bd5\u4ee5\u53ca\u8bbe\u7f6e\u4fe1\u53f7\u6807\uff08semaphore\uff09\u7b49\u4efb\u52a1\u3002\u5f53\u6d4b\u8bd5\u548c\u8bbe\u7f6e\u4fe1\u53f7\u6807\u6b63\u5728\u8fdb\u884c\u4e2d\u65f6\uff0c\u4e0d\u5141\u8bb8\u5176\u4ed6\u5bf9\u4fe1\u53f7\u6807\u7684\u8bbf\u95ee\u53d1\u751f\uff0c\u4e0d\u4e88\u8bb8\u53d1\u751f\u7ade\u4e89\u7684\u60c5\u51b5\u3002\u4e3a\u4e86\u907f\u514d\u53d1\u751f\u7ade\u4e89\u60c5\u51b5\uff0c\u5904\u7406\u5668\u4f7f\u7528\u4e00\u4e2a\u9501\u5b9a\u6307\u793a\u7b26\uff08lock indicator\uff09\uff08\u4f8b\u5982\u5e76\u884c\u603b\u7ebf\u524d\u6bb5\u7684\u4e00\u4e2a\u5355\u72ec\u7684pin\uff09\uff0c\u6765\u963b\u6b62\u603b\u7ebf\u4e0a\u7684\u5176\u4ed6\u4e8b\u52a1\uff0c\u76f4\u5230\u8fd9\u4e2a\u9501\u5b9a\u7684\u4e8b\u52a1\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u662f\u5bf9\u8fd9\u4e2a\u4e3b\u9898\u5185\u5bb9\u7684\u4e00\u4e2a\u9ad8\u5c42\u6b21\u4ecb\u7ecd\u3002\u6709\u5173\u88ab\u9501\u5b9a\u4e8b\u52a1\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u9644\u5f55D\uff0c\u201cAppendix D\uff1aLocked Transactions\u201d\u3002</p> <p>\u56de\u987e\u4e00\u4e0b\u5386\u53f2\uff0c\u5728PCI\u7684\u65e9\u671f\uff0c\u534f\u8bae\u89c4\u8303\u7684\u5236\u5b9a\u8005\u4eec\u9884\u671f\u5230PCI\u5c06\u4f1a\u5b9e\u9645\u53d6\u4ee3\u5904\u7406\u5668\u603b\u7ebf\u3002\u56e0\u6b64\uff0cPCI\u534f\u8bae\u89c4\u8303\u4e2d\u8981\u6c42\u603b\u7ebf\u8981\u80fd\u652f\u6301\u5904\u7406\u5668\u8981\u5b8c\u6210\u7684\u4e8b\u60c5\uff0c\u6bd4\u5982\u9501\u5b9a\u4e8b\u52a1\u3002\u7136\u800c\uff0cPCI\u5f88\u5c11\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528\uff0c\u6700\u7ec8\uff0c\u8fd9\u79cd\u5904\u7406\u5668\u603b\u7ebf\u652f\u6301\u7684\u4e1c\u897f\u5927\u90e8\u5206\u90fd\u88ab\u4e22\u5f03\u4e86\u3002\u4e0d\u8fc7\uff0c\u9501\u5b9a\u5468\u671f\u4f9d\u7136\u5b58\u5728\uff0c\u7528\u4ee5\u652f\u6301\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0c\u5728\u66f4\u8fdb\u4e00\u6b65\u7684PCIe\u7684\u53d1\u5c55\u4e2d\u4e5f\u4fdd\u7559\u4e86\u5b83\uff0c\u4ee5\u5b9e\u73b0\u5bf9\u4e00\u4e9b\u9057\u7559\u4e8b\u52a1\u7684\u652f\u6301\u3002\u4e5f\u8bb8\u662f\u4e3a\u4e86\u52a0\u901f\u5411PCIe\u7684\u8fc1\u79fb\uff0c\u5728\u65b0\u7684PCIe\u8bbe\u5907\u4e2d\u8fdb\u5236\u63a5\u6536\u9501\u5b9a\u8bf7\u6c42\uff08locked request\uff09\uff0c\u53ea\u6709\u90a3\u4e9b\u9057\u7559\u8bbe\u5907\u624d\u80fd\u591f\u4f7f\u7528\u5b83\u3002\u5728\u56fe 2\u201119\u6240\u793a\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e00\u4e2aRequester\u53d1\u51fa\u4e86\u4e00\u4e2aMRdLk\uff08Memory Read Locked\uff09\u6765\u53d1\u8d77\u4e8b\u52a1\u3002\u6839\u636e\u5b9a\u4e49\u8fd9\u6837\u7684\u8bf7\u6c42\u4ec5\u5141\u8bb8\u6765\u81eaCPU\uff0c\u56e0\u6b64\u5728PCIe\u4e2d\u4ec5\u6709RC\u7684\u7aef\u53e3\u53ef\u4ee5\u53d1\u8d77\u8fd9\u79cd\u4e8b\u52a1\u3002</p> <p>\u8fd9\u4e2alocked request\u4f7f\u7528\u76ee\u6807memory\u5730\u5740\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\uff0c\u5e76\u6700\u7ec8\u5230\u8fbe\u4e86\u9057\u7559\u8bbe\u5907EP\uff08Legacy Endpoint\uff09\u3002\u5f53\u6570\u636e\u5305\u7ecf\u8fc7\u6cbf\u9014\u7684\u6bcf\u4e2a\u8def\u7531\u8bbe\u5907\u65f6\uff08\u79f0\u4e3a\u670d\u52a1\u70b9\uff09\uff0c\u6570\u636e\u5305\u7684\u51fa\u53e3\u7aef\u53e3\u88ab\u9501\u5b9a\uff0c\u8fd9\u610f\u5473\u7740\u5728\u88ab\u89e3\u9501\u4e4b\u524d\u8fd9\u6761\u8def\u5f84\u90fd\u4e0d\u80fd\u901a\u8fc7\u5176\u4ed6\u7684\u6570\u636e\u5305\u3002</p> <p></p> <p>\u56fe 2\u201119 Non-Posted Locked Read\u4e8b\u52a1\u534f\u8bae</p> <p>\u5f53Completer\u63a5\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\u5305\u5e76\u5c06\u5176\u5185\u5bb9\u8fdb\u884c\u8bd1\u7801\uff0c\u5b83\u5c06\u6536\u96c6\u8bf7\u6c42\u6240\u9700\u8981\u7684\u6570\u636e\uff0c\u5e76\u4f7f\u7528\u8fd9\u4e9b\u6570\u636e\u4ea7\u751f\u4e00\u4e2a\u6216\u591a\u4e2aLocked\u5b8c\u6210\u5305\u3002\u8fd9\u4e9b\u5b8c\u6210\u5305\u5c06\u4f1a\u88ab\u8def\u7531\u56de\u5230Requester\uff0c\u4f7f\u7528\u7684\u8def\u7531\u4fe1\u606f\u662fRequester ID\uff0c\u5b8c\u6210\u5305\u8def\u5f84\u4e0a\u7684\u51fa\u53e3\u7aef\u53e3\u4e5f\u4f1a\u88ab\u9501\u5b9a\u3002</p> <p>\u5982\u679cCompleter\u9047\u5230\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u65e0\u6cd5\u6b63\u5e38\u54cd\u5e94\u8bf7\u6c42\uff0c\u90a3\u4e48\u5b83\u5c06\u5411Requester\u8fd4\u56de\u4e00\u4e2a\u4e0d\u542b\u6709\u6570\u636e\u7684Lock\u5b8c\u6210\u5305\uff08\u6b63\u5e38\u7684\u8bfb\u8bf7\u6c42\u5b8c\u6210\u5305\u5e94\u8be5\u542b\u6709\u8981\u8fd4\u56de\u7684\u6570\u636e\uff0c\u800c\u8fd9\u91cc\u4e0d\u5305\u542b\u6570\u636e\u90a3\u4e48\u6211\u4eec\u5c31\u77e5\u9053\u51fa\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898\uff09\uff0c\u5e76\u4f7f\u7528\u5b8c\u6210\u5305\u7684\u72b6\u6001\u6307\u793a\u533a\u57df\u6765\u6807\u8bc6\u53d1\u751f\u7684\u9519\u8bef\u7684\u4e00\u4e9b\u4fe1\u606f\u3002Requester\u63a5\u6536\u5230\u8fd9\u6837\u7684\u5b8c\u6210\u5305\u5c31\u660e\u767d\u4e86\u8fd9\u4e2aLock Request\u5931\u8d25\u4e86\uff0c\u5b83\u5c31\u4f1a\u53d6\u6d88\u8fd9\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\uff0c\u7136\u540e\u7531\u8f6f\u4ef6\u6765\u51b3\u5b9a\u63a5\u4e0b\u6765\u8981\u505a\u4ec0\u4e48\u3002</p>"},{"location":"pcie/all/#l-ioio-and-configuration-writes","title":"l IO\u548c\u914d\u7f6e\u5199\uff08IO and Configuration Writes\uff09","text":"<p>\u5982\u56fe 2\u201120\u4e2d\u5c55\u793a\u4e86\u4e00\u4e2aNon-Posted IO\u5199\u4e8b\u52a1\u3002\u4e0eLocked request\u76f8\u7c7b\u4f3c\uff0c\u8fd9\u6837\u7684\u4e00\u5957IO\u64cd\u4f5c\u6d41\u7a0b\u7684\u76ee\u7684\u8bbe\u5907\u53ea\u80fd\u662f\u4e00\u4e2a\u9057\u7559EP\u3002\u8bf7\u6c42\u5305\u4f7f\u7528IO\u5730\u5740\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u5728Switch\u4e2d\u88ab\u8def\u7531\u8f6c\u53d1\uff0c\u76f4\u5230\u5b83\u5230\u8fbe\u76ee\u6807EP\u3002\u5f53Completer\u63a5\u6536\u5230\u8fd9\u4e2a\u5199\u8bf7\u6c42\u5305\uff0c\u5b83\u63a5\u6536\u8bf7\u6c42\u5305\u5185\u7684\u6570\u636e\u5e76\u8fd4\u56de\u4e00\u4e2a\u5355\u72ec\u7684\u4e0d\u542b\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff0c\u4ee5\u6b64\u6765\u786e\u8ba4\u81ea\u5df1\u6536\u5230\u4e86\u8fd9\u4e2a\u5199\u8bf7\u6c42\u5305\u3002\u5b8c\u6210\u5305\u4e2d\u7684\u72b6\u6001\u6807\u8bc6\u533a\u57df\u5c06\u4f1a\u6307\u793a\u51fa\u662f\u5426\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u5982\u679c\u53d1\u751f\u4e86\u9519\u8bef\uff0cRequester\u7684\u8f6f\u4ef6\u9700\u8981\u5bf9\u9519\u8bef\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u5982\u679c\u5b8c\u6210\u5305\u4e2d\u663e\u793a\u5e76\u672a\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u4e48Requester\u5c31\u8ba4\u4e3a\u5199\u6570\u636e\u88ab\u6210\u529f\u7684\u9001\u8fbe\u76ee\u6807\u8bbe\u5907\u5e76\u6210\u529f\u5199\u5165\uff0c\u53ef\u4ee5\u5141\u8bb8\u9488\u5bf9\u8fd9\u4e00\u4e2aCompleter\u7684\u6307\u4ee4\u5e8f\u5217\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728Requester\u4e2d\u6709\u4e00\u7cfb\u5217\u7684\u9488\u5bf9Completer\u7684\u6307\u4ee4\uff0c\u5f53\u77e5\u9053\u8fd9\u4e00\u4e2aIO\u5199\u8bf7\u6c42\u5b8c\u6210\u4e86\u4e4b\u540e\uff0c\u5141\u8bb8\u6267\u884c\u6307\u4ee4\u5e8f\u5217\u4e2d\u7684\u4e0b\u4e00\u4e2a\u6307\u4ee4\uff0c\u5373\u60f3\u8868\u8fbe\u7684\u662f\u9700\u8981\u786e\u8ba4\u8fd9\u4e2a\u5199\u8bf7\u6c42\u6210\u529f\u4e86\u624d\u5141\u8bb8\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\u3002\u8fd9\u5f88\u597d\u7684\u603b\u7ed3\u4e86Non-Posted\u5199\u7684\u76ee\u7684\uff1a\u4e0d\u540c\u4e8e\u4e00\u4e2aMemory\u5199\uff08MWr\u662fPosted\u7684\uff09\uff0cNon-Posted\u5199\u4e0d\u80fd\u4ec5\u4ec5\u77e5\u9053\u6570\u636e\u88ab\u9001\u5f80\u4e86\u76ee\u7684\u65b9\uff0c\u8fd8\u5fc5\u987b\u8981\u77e5\u9053\u6570\u636e\u771f\u7684\u5230\u8fbe\u4e86\u76ee\u7684\u65b9\u624d\u884c\uff0c\u5426\u5219\u5728\u903b\u8f91\u4e0a\u4e0d\u80fd\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u6b65\u3002\u53c8\u5982\u540cLocked\u64cd\u4f5c\u4e00\u6837\uff0cNon-Posted\u5199\u8bf7\u6c42\u53ea\u80fd\u7531\u5904\u7406\u5668\u53d1\u51fa\u3002</p> <p></p> <p>\u56fe 2\u201120 Non-Posted Write\u4e8b\u52a1\u534f\u8bae</p>"},{"location":"pcie/all/#2223-posted","title":"2.2.2.3   Posted\u5199\u4e8b\u52a1","text":""},{"location":"pcie/all/#l-memorymemory-writes","title":"l Memory\u5199\uff08Memory Writes\uff09","text":"<p>Memory\u5199\u8bf7\u6c42\u5fc5\u7136\u662fPosted\u7c7b\u578b\u7684\uff0c\u5b83\u4e0d\u9700\u8981\u8fd4\u56de\u5b8c\u6210\u5305\u3002\u4e00\u65e6\u8fd9\u79cd\u5199\u8bf7\u6c42\u5305\u88ab\u53d1\u51fa\uff0cRequester\u4e0d\u9700\u8981\u7b49\u5230\u4efb\u4f55\u53cd\u9988\u5c31\u53ef\u4ee5\u7ee7\u7eed\u53bb\u8fdb\u884c\u4e0b\u4e00\u6761\u8bf7\u6c42\uff0c\u4e0d\u9700\u8981\u5728\u8fd4\u56de\u5b8c\u6210\u5305\u8fd9\u4ef6\u4e8b\u60c5\u4e0a\u82b1\u8d39\u65f6\u95f4\u548c\u5e26\u5bbd\u3002\u56e0\u6b64\uff0cPosted\u5199\u4f1a\u6bd4Non-Posted\u5199\u66f4\u52a0\u5feb\u901f\u4e14\u9ad8\u6548\uff0c\u5e76\u5f88\u597d\u7684\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u3002\u5982\u56fe 2\u201121\u6240\u793a\uff0c\u8bf7\u6c42\u5305\u4f7f\u7528memory\u5730\u5740\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u5728\u7cfb\u7edf\u4e2d\u8fdb\u884c\u8def\u7531\u8f6c\u53d1\uff0c\u5e76\u6700\u7ec8\u5230\u8fbeCompleter\u3002\u4e00\u65e6\u94fe\u8def\u6210\u529f\u7684\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u53d1\u9001\u8fc7\u53bb\uff08\u8fd9\u91cc\u7684\u6210\u529f\u662f\u6307\u628a\u6570\u636e\u5305\u4f20\u8f93\u4e86\u8fc7\u53bb\uff0c\u800c\u4e0d\u9700\u8981\u5f97\u5230Completer\u7684\u6210\u529f\u786e\u8ba4\uff09\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u5728\u94fe\u8def\u4e0a\u5c31\u5df2\u7ecf\u7ed3\u675f\u4e86\uff0c\u94fe\u8def\u4e0a\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f20\u8f93\u5176\u4ed6\u7684\u6570\u636e\u5305\u4e86\u3002\u6700\u7ec8\uff0cCompleter\u63a5\u6536\u5199\u8bf7\u6c42\u5305\u4e2d\u7684\u6570\u636e\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u624d\u771f\u6b63\u5b8c\u6210\u3002\u5f53\u7136\uff0c\u8fd9\u79cd\u4e8b\u52a1\u6267\u884c\u65b9\u6cd5\u5728\u63d0\u5347\u6548\u7387\u7684\u540c\u65f6\u4e5f\u820d\u5f03\u4e86\u4e00\u4e9b\u4e1c\u897f\uff0c\u56e0\u4e3aCompleter\u4e0d\u9700\u8981\u53d1\u9001\u5b8c\u6210\u5305\uff0c\u6240\u4ee5\u8fd9\u4e5f\u610f\u5473\u7740\u5b83\u65e0\u6cd5\u5c06\u9519\u8bef\u62a5\u544a\u7ed9Requester\u3002\u5982\u679cCompleter\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u9519\u8bef\uff0c\u5e76\u5411RC\u53d1\u4e00\u4e2aMessage\u6765\u901a\u77e5\u7cfb\u7edf\u8f6f\u4ef6\u8fd9\u4e9b\u60c5\u51b5\uff0c\u4f46\u662fRequester\u5bf9\u8fd9\u4e9b\u662f\u5b8c\u5168\u4e0d\u77e5\u60c5\u7684\u3002</p> <p></p> <p>\u56fe 2\u201121 Posted Memory Write\u4e8b\u52a1\u534f\u8bae</p>"},{"location":"pcie/all/#l-messagemessage-writes","title":"l Message\u5199\uff08Message Writes\uff09","text":"<p>\u5341\u5206\u6709\u8da3\u7684\u662f\uff0cMessage\u4e0d\u540c\u4e8e\u6211\u4eec\u524d\u9762\u6240\u8bf4\u7684\u90a3\u4e9b\u8bf7\u6c42\u4e8b\u52a1\uff0c\u5b83\u6709\u597d\u51e0\u79cd\u8def\u7531\u65b9\u6cd5\uff08\u524d\u9762\u7684\u90fd\u662f\u901a\u8fc7memory\u5730\u5740\u3001IO\u5730\u5740\u4e2d\u7684\u4e00\u79cd\uff09\uff0c\u5728Message\u5185\u90e8\u4e13\u95e8\u6709\u4e00\u4e2a\u533a\u57df\u6765\u6807\u8bc6\u4f7f\u7528\u7684\u662f\u54ea\u4e00\u79cd\u8def\u7531\u65b9\u5f0f\u3002\u4f8b\u5982\uff0c\u6709\u4e00\u4e9bMessage\u662fPosted\u5199\u8bf7\u6c42\uff0c\u5176\u76ee\u7684\u65b9\u4e3a\u7279\u5b9a\u7684Completer\uff1b\u6709\u4e00\u4e9b\u662fRC\u5411\u6240\u6709EP\u5e7f\u64ad\u7684\u8bf7\u6c42\uff1b\u8fd8\u6709\u4e00\u4e9b\u662fEP\u53d1\u51fa\u7684\u8981\u81ea\u52a8\u8def\u7531\u5230RC\u7684\u8bf7\u6c42\u3002\u60f3\u8981\u5b66\u4e60\u66f4\u591a\u5173\u4e8e\u4e0d\u540c\u7684\u8def\u7531\u7c7b\u578b\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605Chapter 4\u201cAddress Space &amp; Transaction Routing\u201d\u3002</p> <p>Message\u5728PCIe\u4e2d\u5f88\u6709\u7528\uff0c\u5b83\u53ef\u4ee5\u4f7f\u5f97PCIe\u8fbe\u5230\u51cf\u5c11\u5f15\u811a\u6570\u91cf\u7684\u8bbe\u8ba1\u76ee\u6807\u3002\u5b83\u4f7f\u5f97PCIe\u4e0d\u518d\u9700\u8981\u8fb9\u5e26\u4fe1\u53f7\uff08side-band signals\uff09\uff0c\u800c\u5728PCI\u4e2d\u5219\u662f\u9700\u8981\u7528\u8fb9\u5e26\u4fe1\u53f7\u6765\u62a5\u544a\u4e2d\u65ad\u3001\u529f\u8017\u7ba1\u7406\u4e8b\u9879\u4ee5\u53ca\u9519\u8bef\u4fe1\u606f\uff0c\u800c\u5728PCIe\u4e2d\u4f7f\u7528Message\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u4fe1\u606f\u4f7f\u7528\u6570\u636e\u5305\u6765\u8fdb\u884c\u62a5\u544a\uff0c\u6570\u636e\u5305\u662f\u76f4\u63a5\u5728\u4e00\u822c\u6570\u636e\u8def\u5f84\u4e0a\u4f20\u8f93\u7684\uff0c\u56e0\u6b64\u4e0d\u518d\u9700\u8981\u989d\u5916\u7684\u8fb9\u5e26\u4fe1\u53f7\u3002</p>"},{"location":"pcie/all/#2224-qosquality-of-service","title":"2.2.2.4   QoS\u670d\u52a1\u8d28\u91cf\uff08Quality of Service\uff09","text":"<p>PCIe\u4ece\u4e00\u5f00\u59cb\u5c31\u88ab\u8bbe\u8ba1\u4e3a\u80fd\u591f\u652f\u6301\u65f6\u95f4\u654f\u611f\u4e8b\u52a1\uff0c\u4f8b\u5982\u6d41\u89c6\u9891\u3001\u97f3\u9891\u5e94\u7528\u7a0b\u5e8f\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\u6570\u636e\u5fc5\u987b\u88ab\u53ca\u65f6\u4f20\u8f93\u624d\u80fd\u4fdd\u8bc1\u6570\u636e\u6709\u6548\u3002\u8fd9\u88ab\u79f0\u4e3a\u63d0\u4f9b\u4e86QoS\uff0c\u5b83\u662f\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e9b\u4e1c\u897f\u6765\u5b9e\u73b0\u7684\u3002\u9996\u5148\uff0c\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u88ab\u8f6f\u4ef6\u5206\u914d\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8fd9\u4e2a\u4f18\u5148\u7ea7\u662f\u901a\u8fc7\u8bbe\u7f6e\u6570\u636e\u5305\u5185\u7684\u4e00\u4e2a3bit\u7684\u5b57\u6bb5\u533a\u57df\u6765\u8fdb\u884c\u6807\u8bc6\u7684\uff0c\u79f0\u4e4b\u4e3a\u6d41\u91cf\u7c7b\u578bTraffic Class\uff08TC\uff09\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u7ed9\u4e00\u4e2a\u6570\u636e\u5305\u5206\u914d\u4e00\u4e2a\u7f16\u53f7\u8f83\u5927\u7684TC\u8868\u793a\u5e0c\u671b\u7ed9\u4e0e\u8fd9\u4e2a\u6570\u636e\u5305\u4e00\u4e2a\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002\u7b2c\u4e8c\uff0c\u4f7f\u7528\u591a\u7f13\u51b2\u533a\uff0c\u79f0\u4e3a\u865a\u62df\u901a\u9053Virtual Channels\uff08VC\uff09\uff0c\u5c06\u5176\u6784\u5efa\u5728\u786c\u4ef6\u7684\u6bcf\u4e00\u4e2a\u7aef\u53e3\u4e2d\uff0c\u6570\u636e\u5305\u4f1a\u6839\u636e\u5176TC\u503c\u4e5f\u5c31\u662f\u4f18\u5148\u7ea7\uff0c\u6765\u88ab\u653e\u5165\u54cd\u5e94\u7684\u865a\u62df\u901a\u9053\u4e2d\uff08\u76f8\u5e94\u7684\u7f13\u5b58\u533a\u4e2d\uff09\u3002\u7b2c\u4e09\uff0c\u7531\u4e8e\u73b0\u5728\u5bf9\u4e8e\u4e00\u4e2a\u7aef\u53e3\u6765\u8bf4\uff0c\u5728\u4e00\u4e2a\u65f6\u523b\u5c06\u4f1a\u6709\u591a\u4e2a\u7f13\u51b2\u533a\u90fd\u5b58\u5728\u53ef\u4ee5\u8fdb\u884c\u4f20\u8f93\u7684\u6570\u636e\u5305\uff0c\u56e0\u6b64\u9700\u8981\u6709\u5bf9VC\u8fdb\u884c\u9009\u62e9\u7684\u4ef2\u88c1\u903b\u8f91\u3002\u6700\u540e\uff0cSwitch\u5fc5\u987b\u5728\u76f8\u7ade\u4e89\u7684\u5404\u4e2a\u8f93\u5165\u7aef\u53e3\u95f4\u505a\u51fa\u9009\u62e9\uff0c\u4ee5\u4fbf\u8bbf\u95ee\u76f8\u5e94\u7aef\u53e3\u7684VC\u3002\u8fd9\u4e00\u6b65\u88ab\u79f0\u4e3a\u7aef\u53e3\u4ef2\u88c1\uff0c\u5b83\u53ef\u4ee5\u7531\u786c\u4ef6\u6765\u8fdb\u884c\u5206\u914d\u6216\u662f\u7531\u8f6f\u4ef6\u6765\u8fdb\u884c\u7f16\u7a0b\u914d\u7f6e\u3002\u8fd9\u4e0e\u7b2c\u4e09\u70b9\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u7b2c\u4e09\u70b9\u662f\u5728\u4e00\u4e2a\u7aef\u53e3\u5185\u5bf9\u591a\u4e2aVC\u8fdb\u884c\u4ef2\u88c1\u9009\u62e9\uff0c\u800c\u7aef\u53e3\u4ef2\u88c1\u662f\u6307\u5404\u4e2a\u7aef\u53e3\u5df2\u7ecf\u9009\u62e9\u597d\u4e86\u6b64\u6b21\u8bbf\u95ee\u7684VC\uff0c\u9700\u8981\u7531Switch\u4ef2\u88c1\u9009\u62e9\u8bbf\u95ee\u54ea\u4e00\u4e2a\u7aef\u53e3\u3002\u6240\u6709\u7684\u8fd9\u4e9b\u786c\u4ef6\u90e8\u4ef6\u90fd\u5fc5\u987b\u8981\u80fd\u591f\u652f\u6301\u7cfb\u7edf\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u4f18\u5148\u7ea7\u6392\u5e8f\u3002\u5982\u679c\u4e00\u4e2a\u8fd9\u6837\u7684\u7cfb\u7edf\u88ab\u6b63\u786e\u7684\u7f16\u7a0b\u914d\u7f6e\uff0c\u5b83\u53ef\u4ee5\u4e3a\u7ed9\u5b9a\u7684\u8def\u5f84\u63d0\u4f9b\u6709\u4fdd\u969c\u7684\u670d\u52a1\u3002</p> <p>\u4e3a\u4e86\u7528\u56fe\u7247\u6765\u89e3\u91ca\u8fd9\u4e2a\u6982\u5ff5\uff0c\u8bf7\u89c1\u56fe 2\u201122\uff0c\u5176\u4e2d\u7684\u89c6\u9891\u6444\u50cf\u5934\u4ee5\u53caSCSI\u8bbe\u5907\u90fd\u9700\u8981\u5411\u7cfb\u7edfDRAM\u53d1\u9001\u6570\u636e\u3002\u8fd9\u4e8c\u8005\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u6444\u50cf\u5934\u662f\u5bf9\u65f6\u6548\u6027\u8981\u6c42\u4e25\u683c\u7684\uff0c\u5982\u679c\u4f20\u8f93\u8def\u5f84\u65e0\u6cd5\u6ee1\u8db3\u6444\u50cf\u5934\u7684\u5e26\u5bbd\uff0c\u90a3\u4e48\u5c06\u51fa\u73b0\u4e22\u5e27\u7684\u73b0\u8c61\u3002\u56e0\u6b64\u7cfb\u7edf\u9700\u8981\u4fdd\u969c\u6444\u50cf\u5934\u6240\u9700\u8981\u7684\u6700\u5c0f\u5e26\u5bbd\uff0c\u5426\u5219\u5b83\u6355\u6349\u7684\u89c6\u9891\u753b\u9762\u5c06\u4f1a\u51fa\u73b0\u4e0d\u7a33\u5b9a\u3002\u4e0e\u6b64\u540c\u65f6\uff0cSCSI\u6570\u636e\u9700\u8981\u6b63\u786e\u65e0\u8bef\u7684\u8fdb\u884c\u4f20\u8f93\uff0c\u4f46\u662f\u5bf9\u4e8e\u5b83\u6765\u8bf4\u4f20\u8f93\u9700\u8981\u7684\u65f6\u95f4\u957f\u77ed\u5e76\u4e0d\u662f\u90a3\u4e48\u91cd\u8981\u3002\u663e\u7136\uff0c\u5f53\u89c6\u9891\u6570\u636e\u548cSCSI\u6570\u636e\u540c\u65f6\u9700\u8981\u88ab\u53d1\u9001\u65f6\uff0c\u89c6\u9891\u6570\u636e\u6d41\u5e94\u5f53\u5177\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002QoS\u6307\u7684\u662f\u7cfb\u7edf\u7684\u4e00\u79cd\u80fd\u529b\uff0c\u662f\u7cfb\u7edf\u4e3a\u6570\u636e\u5305\u5206\u914d\u4e0d\u540c\u4f18\u5148\u7ea7\u5e76\u5c06\u8fd9\u4e9b\u6570\u636e\u5305\u6309\u7167\u786e\u5b9a\u6027\u7684\u5ef6\u65f6\u3001\u5e26\u5bbd\u5728\u7cfb\u7edf\u62d3\u6251\u4e2d\u8fdb\u884c\u8def\u7531\u7684\u80fd\u529b\u3002\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8eQoS\u7684\u7ec6\u8282\uff0c\u8bf7\u53c2\u9605Chapter 7\u201cQuality of Service\u201d\u3002</p> <p></p> <p>\u56fe 2\u201122 QoS\u793a\u4f8b</p>"},{"location":"pcie/all/#2225-transaction-ordering","title":"2.2.2.5   \u4e8b\u52a1\u6392\u5e8f\uff08Transaction Ordering\uff09","text":"<p>\u5728\u4e00\u4e2a\u865a\u62df\u901a\u9053VC\u5185\uff0c\u6570\u636e\u5305\u4e00\u822c\u5168\u90fd\u6309\u7167\u5b83\u4eec\u5230\u8fbe\u7684\u5148\u540e\u987a\u5e8f\u8fdb\u884c\u6392\u5e8f\u548c\u79fb\u52a8\uff0c\u4f46\u662f\u4e5f\u6709\u4f8b\u5916\u60c5\u51b5\u3002PCIe\u534f\u8bae\u7ee7\u627f\u4e86PCI\u7684\u4e8b\u52a1\u6392\u5e8f\u6a21\u578b\uff0c\u5305\u62ec\u652f\u6301PCI-X\u4e2d\u52a0\u5165\u7684\u5bbd\u677e\u6392\u5e8f\uff08relaxed-ordering\uff09\u3002\u8fd9\u4e9b\u6392\u5e8f\u89c4\u5219\u4fdd\u8bc1\u4e86\u4f7f\u7528\u76f8\u540cTC\uff08Traffic Class\uff09\u7684\u6570\u636e\u5305\u90fd\u4f1a\u6309\u7167\u6b63\u786e\u7684\u987a\u5e8f\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u88ab\u8def\u7531\u8f6c\u53d1\uff0c\u9632\u6b62\u6f5c\u5728\u7684\u6b7b\u9501\u6216\u8005\u6d3b\u9501\u60c5\u51b5\u3002\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u7531\u4e8e\u6392\u5e8f\u89c4\u5219\u4ec5\u5e94\u7528\u4e8eVC\uff0c\u4e14\u4f7f\u7528\u4e0d\u540cTC\u7684\u6570\u636e\u5305\u4e00\u822c\u4e0d\u4f1a\u88ab\u5212\u5206\u8fdb\u540c\u4e00\u4e2aVC\uff0c\u56e0\u6b64\u4f7f\u7528\u4e0d\u540c\u7684TC\u7684\u6570\u636e\u5305\u5728\u8f6f\u4ef6\u770b\u6765\u5c31\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u3002\u8fd9\u79cd\u6392\u5e8f\u5728\u4e8b\u52a1\u5c42\u4e2d\u7684VC\u4e2d\u7ef4\u62a4\u3002</p>"},{"location":"pcie/all/#2226-flow-control","title":"2.2.2.6   \u6d41\u91cf\u63a7\u5236\uff08Flow Control\uff09","text":"<p>\u4e32\u884c\u4f20\u8f93\u6240\u4f7f\u7528\u7684\u4e00\u4e2a\u5178\u578b\u534f\u8bae\u662f\uff0c\u8981\u6c42\u53d1\u9001\u65b9\u4ec5\u5728\u5bf9\u7aef\u6709\u8db3\u591f\u7684\u7f13\u51b2\u533a\u63a5\u6536\u65f6\u624d\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u6837\u7684\u89c4\u5b9a\u5220\u53bb\u4e86\u603b\u7ebf\u4e0a\u7684\u6027\u80fd\u6d6a\u8d39\u64cd\u4f5c\u4e8b\u4ef6\uff0c\u6bd4\u5982PCI\u4e2d\u5141\u8bb8\u8fdb\u884c\u7684\u65ad\u5f00\uff08disconnect\uff09\u4e0e\u91cd\u8bd5\uff08retry\uff09\uff0c\u8fd9\u4f7f\u5f97\u8fd9\u7c7b\u95ee\u9898\u5728\u4f20\u8f93\u4e2d\u5f97\u5230\u6d88\u9664\u3002\u8fd9\u6837\u505a\u7684\u4ee3\u4ef7\u662f\uff0c\u63a5\u6536\u65b9\u5fc5\u987b\u8db3\u591f\u9891\u7e41\u7684\u62a5\u544a\u5b83\u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u6765\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u4f20\u8f93\u505c\u987f\uff0c\u800c\u4e14\u8fd9\u6837\u7684\u62a5\u544a\u4e5f\u9700\u8981\u5360\u7528\u63a5\u6536\u65b9\u81ea\u5df1\u7684\u4e00\u70b9\u5e26\u5bbd\u3002\u5728PCIe\u4e2d\uff0c\u8fd9\u4e2a\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u7684\u62a5\u544a\u662f\u7531DLLP\uff08Data Link Layer Packet\uff09\u6765\u5b8c\u6210\u7684\uff0c\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u8bb2\u5230DLLP\u3002\u8fd9\u91cc\u4e0d\u4f7f\u7528TLP\u7684\u539f\u56e0\u662f\u4e3a\u4e86\u907f\u514d\u53ef\u80fd\u51fa\u73b0\u7684\u6b7b\u9501\u73b0\u8c61\uff0c\u5982\u679c\u4f7f\u7528TLP\u5219\u53ef\u80fd\u51fa\u73b0\uff0c\u4f8b\u5982\u4e00\u4e2a\u8bbe\u5907A\u4f5c\u4e3a\u53d1\u9001\u65b9\u9700\u8981\u5bf9\u63a5\u6536\u65b9B\u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u8fdb\u884c\u66f4\u65b0\uff0c\u4f46\u662f\u5f53A\u7684\u63a5\u6536\u7f13\u51b2\u533a\u6ee1\u5bfc\u81f4\u5b83\u53c8\u65e0\u6cd5\u63a5\u6536\u6765\u81eaB\u7684\u53ef\u7528\u7f13\u51b2\u533a\u62a5\u544a\uff0c\u8fd9\u6837\u5c31\u51fa\u73b0\u4e86\u4e00\u4e2a\u6b7b\u5faa\u73af\u3002\u800cDLLP\u53ef\u4ee5\u4e0d\u7ba1\u7f13\u51b2\u533a\u72b6\u6001\u5c31\u8fdb\u884c\u6536\u53d1\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u6b7b\u9501\u7684\u95ee\u9898\u3002\u8fd9\u6837\u7684\u6d41\u91cf\u63a7\u5236\u534f\u8bae\u7531\u786c\u4ef6\u7ea7\u8fdb\u884c\u81ea\u52a8\u7ba1\u7406\uff0c\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u662f\u900f\u660e\u7684\u3002</p> <p></p> <p>\u56fe 2\u201123\u6d41\u91cf\u63a7\u5236\u57fa\u7840\u64cd\u4f5c</p> <p>\u5982\u56fe 2\u201123\u6240\u793a\uff0c\u63a5\u6536\u65b9\u5185\u7684VC Buffer\u5185\u7f13\u5b58\u4e86\u63a5\u6536\u5230\u7684TLP\u3002\u63a5\u6536\u65b9\u5c06\u81ea\u5df1\u7684\u7f13\u51b2\u533a\u5927\u5c0f\u901a\u8fc7Flow Control DLLP\uff08\u6d41\u91cf\u63a7\u5236DLLP\uff09\u6765\u544a\u77e5\u53d1\u9001\u65b9\u3002\u53d1\u9001\u65b9\u5c06\u4f1a\u8ddf\u8e2a\u63a5\u6536\u65b9\u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u7684\u503c\uff0c\u5e76\u4e14\u4e0d\u5141\u8bb8\u53d1\u51fa\u5927\u4e8e\u8fd9\u4e2a\u53ef\u7528\u7a7a\u95f4\u7684\u6570\u636e\u5305\u3002\u5f53\u63a5\u6536\u65b9\u5bf9\u7f13\u51b2\u533a\u4e2d\u7684TLP\u8fdb\u884c\u4e86\u5904\u7406\uff0c\u5e76\u5c06\u8fd9\u4e2aTLP\u79fb\u51fa\u4e86\u7f13\u51b2\u533a\uff0c\u6b64\u65f6\u7f13\u51b2\u533a\u4e2d\u5c31\u7a7a\u95f2\u51fa\u4e86\u65b0\u7684\u53ef\u7528\u7a7a\u95f4\uff0c\u90a3\u4e48\u63a5\u6536\u65b9\u5c06\u4f1a\u5b9a\u671f\u7684\u53d1\u9001Flow Control Update DLLP\uff08\u6d41\u91cf\u63a7\u5236\u66f4\u65b0DLLP\uff09\u6765\u4fdd\u6301\u53d1\u9001\u65b9\u80fd\u591f\u83b7\u53d6\u5230\u6700\u65b0\u7684\u53ef\u7528\u7a7a\u95f4\u7684\u503c\u3002\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u8fd9\u65b9\u9762\u7684\u5185\u5bb9\uff0c\u8bf7\u89c1Chapter 6\u201cFlow Control\u201d\u3002</p>"},{"location":"pcie/all/#223-data-link-layer","title":"2.2.3     \u6570\u636e\u94fe\u8def\u5c42\uff08Data Link Layer\uff09","text":"<p>\u6570\u636e\u94fe\u8def\u5c42\u8fd9\u4e00\u5c42\u7684\u903b\u8f91\u662f\u7528\u6765\u8d1f\u8d23\u94fe\u8def\u7ba1\u7406\u7684\uff0c\u5b83\u4e3b\u8981\u8868\u73b0\u4e3a3\u4e2a\u529f\u80fd\uff1aTLP\u9519\u8bef\u7ea0\u6b63\u3001\u6d41\u91cf\u63a7\u5236\u4ee5\u53ca\u4e00\u4e9b\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u3002\u5b83\u662f\u901a\u8fc7\u5982\u56fe 2\u201124\u6240\u793a\u7684DLLP\uff08Data Link Layer Packet\uff09\u6765\u5b8c\u6210\u8fd9\u4e9b\u529f\u80fd\u7684\u3002</p>"},{"location":"pcie/all/#2231-dllpsdata-link-layer-packet","title":"2.2.3.1   DLLPs\u6570\u636e\u94fe\u8def\u5c42\u5305\uff08Data Link Layer Packet\uff09","text":"<p>DLLP\u662f\u4e00\u79cd\u5728\u4f4d\u4e8e\u540c\u4e00\u6761\u94fe\u8def\u4e0a\u7684\u672c\u7aef\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e0e\u5bf9\u7aef\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u4e4b\u95f4\u4f20\u8f93\u7684\u6570\u636e\u5305\u3002\u4e8b\u52a1\u5c42\u5bf9\u8fd9\u4e9b\u6570\u636e\u5305\u5e76\u65e0\u611f\u77e5\uff0c\u5b83\u4eec\u53ea\u5728\u4e24\u4e2a\u76f8\u4e34\u8fd1\u7684\u8bbe\u5907\u4e4b\u95f4\u4f20\u8f93\uff0c\u4e0d\u4f1a\u88ab\u8def\u7531\u5230\u4efb\u4f55\u5176\u4ed6\u5730\u65b9\u3002DLLP\u901a\u5e38\u8981\u5c0f\u4e8eTLP\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0bDLLP\u53ea\u67098Bytes\uff0c\u8fd9\u662f\u4e00\u4ef6\u597d\u4e8b\uff0c\u56e0\u4e3aDLLP\u7684\u5927\u5c0f\u4e5f\u53cd\u5e94\u7740\u7ef4\u62a4\u94fe\u8def\u6240\u9700\u8981\u7684\u5f00\u9500\u3002</p> <p></p> <p>\u56fe 2\u201124 DLLP\u7684\u8d77\u59cb\u5730\u548c\u76ee\u7684\u5730</p>"},{"location":"pcie/all/#l-dllpdllp-assembly","title":"l DLLP\u7ec4\u5305\uff08DLLP Assembly\uff09","text":"<p>\u5982\u56fe 2\u201124\u6240\u793a\uff0c\u4e00\u4e2aDLLP\u8d77\u6e90\u4e8e\u53d1\u9001\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5e76\u7ed3\u675f\u4e8e\u63a5\u6536\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u3002\u5728\u8fd9\u4e2aDLLP\u4e2d\u7531\u53d1\u9001\u65b9\u7ed9DLLP Core\u52a0\u4e0a\u4e86\u4e00\u4e2a16bit CRC\uff0c\u7528\u6765\u4f9b\u63a5\u6536\u65b9\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002\u5728\u52a0\u5b8cCRC\u4e4b\u540e\uff0c\u8fd9\u4e2aDLLP\u88ab\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\uff0c\u5728\u8fd9\u4e00\u5c42\u91cc\u7ed9DLLP\u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff08\u8fd9\u79cd\u65b9\u6cd5\u662fGen1\u548cGen2\u7684\u65b9\u6cd5\uff0cGen3\u4e0d\u518d\u4f7f\u7528\uff09\uff0c\u5e76\u5bf9\u52a0\u5b8c\u4e24\u79cd\u5b57\u7b26\u7684DLLP\u8fdb\u884c\u7f16\u7801\uff0c\u7136\u540e\u901a\u8fc7\u94fe\u8def\u4e0a\u7684\u6240\u6709\u901a\u9053\uff08Lane\uff09\u8fdb\u884c\u5dee\u5206\u4f20\u8f93\u3002</p>"},{"location":"pcie/all/#l-dllpdllp-disassembly","title":"l DLLP\u62c6\u5305\uff08DLLP Disassembly\uff09","text":"<p>\u5f53\u63a5\u6536\u65b9\u7684\u7269\u7406\u5c42\u63a5\u6536\u5230\u4e86\u4e00\u4e2aDLLP\uff0c\u8fd9\u4e2aDLLP\u7684\u6bd4\u7279\u6d41\u5c06\u88ab\u8bd1\u7801\u5e76\u5265\u53bb\u5305\u8d77\u59cb\u5b57\u7b26\u4e0e\u5305\u7ed3\u675f\u5b57\u7b26\u3002\u5269\u4f59\u7684DLLP\u90e8\u5206\u88ab\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5728\u8fd9\u91cc\u8fdb\u884cCRC\u9519\u8bef\u6821\u9a8c\uff0c\u5e76\u6839\u636e\u5305\u7684\u5185\u5bb9\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002\u63a5\u6536\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u5c31\u5df2\u7ecf\u662fDLLP\u7684\u6700\u7ec8\u76ee\u7684\u5730\uff0c\u5b83\u4e0d\u4f1a\u88ab\u7ee7\u7eed\u5411\u4e0a\u5448\u4ea4\u7ed9\u4e8b\u52a1\u5c42\u3002</p>"},{"location":"pcie/all/#2232-acknakacknak-protocol","title":"2.2.3.2   Ack/Nak\u534f\u8bae\uff08Ack/Nak Protocol\uff09","text":"<p>\u5982\u56fe 2\u201125\u6240\u793a\u662f\u4e00\u79cd\u57fa\u4e8e\u786c\u4ef6\u7684\u81ea\u52a8\u91cd\u8bd5\u673a\u5236\uff08hardware-based automatic retry mechanism\uff09\u3002\u5982\u56fe 2\u201126\u6240\u793a\uff0c\u6bcf\u4e00\u4e2a\u88ab\u53d1\u9001\u65b9\u53d1\u51fa\u7684TLP\u90fd\u88ab\u52a0\u4e0a\u4e86LCRC\u4e0e\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\uff0c\u5728\u63a5\u6536\u65b9\u4f1a\u5bf9\u8fd9\u4e24\u4e2a\u4fe1\u606f\u8fdb\u884c\u68c0\u67e5\u3002\u53d1\u9001\u65b9\u7684\u91cd\u4f20Buffer\uff08replay buffer\uff09\u4fdd\u5b58\u7740\u6bcf\u4e2a\u88ab\u53d1\u9001\u7684TLP\u7684\u526f\u672c\uff0c\u76f4\u5230\u5bf9\u7aef\u786e\u8ba4\u6210\u529f\u6536\u5230\u4e86\u8fd9\u4e2aTLP\u3002\u8fd9\u4e2a\u786e\u8ba4\u6210\u529f\u6536\u5230\u7684\u8fc7\u7a0b\u662f\u901a\u8fc7\u63a5\u6536\u65b9\u53d1\u9001Ack DLLP\u6765\u5b9e\u73b0\u7684\uff0c\u5728\u8fd9\u4e2aAck DLLP\u4e2d\u5305\u542b\u6709\u63a5\u6536\u65b9\u6210\u529f\u63a5\u6536\u7684\u4e0a\u4e00\u4e2aTLP\u7684\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3002\u5f53\u53d1\u9001\u65b9\u6536\u5230\u8fd9\u4e2aAck DLLP\uff0c\u5b83\u5c06\u4f1a\u628a\u91cc\u9762Sequence Number\u6240\u5bf9\u5e94\u7684TLP\u3001\u4ee5\u53ca\u8fd9\u4e2aTLP\u4e4b\u524d\u7684\u6240\u6709TLP\uff0c\u90fd\u4ece\u91cd\u4f20Buffer\u5185\u6e05\u9664\u3002</p> <p>\u5982\u679c\u63a5\u6536\u65b9\u68c0\u6d4b\u5230\u4e86\u4e00\u4e2aTLP\u9519\u8bef\uff0c\u5b83\u5c06\u4f1a\u628a\u8fd9\u4e2aTLP\u4e22\u5f03\uff0c\u5e76\u5411\u53d1\u9001\u65b9\u8fd4\u56de\u4e00\u4e2aNak DLLP\uff0c\u4ee5\u671f\u671b\u53d1\u9001\u65b9\u80fd\u5bf9\u672a\u786e\u8ba4\u6210\u529f\u63a5\u6536\u7684TLP\u8fdb\u884c\u91cd\u4f20\uff0c\u5e76\u901a\u8fc7\u91cd\u4f20\u83b7\u5f97\u4e00\u4e2a\u5b8c\u597d\u7684TLP\u3002\u7531\u4e8e\u9519\u8bef\u68c0\u6d4b\u901a\u5e38\u662f\u5341\u5206\u8fc5\u901f\u7684\u64cd\u4f5c\uff0c\u56e0\u6b64\u4ece\u9519\u8bef\u68c0\u6d4b\u5f00\u59cb\u5230\u53d1\u8d77\u91cd\u4f20\u7684\u65f6\u95f4\u4e5f\u6bd4\u8f83\u77ed\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u8f83\u77ed\u7684\u65f6\u95f4\u5185\u7ea0\u6b63\u53d1\u751f\u7684\u9519\u8bef\u3002\u8fd9\u4e00\u64cd\u4f5c\u8fc7\u7a0b\u88ab\u79f0\u4e3aAck/Nak\u534f\u8bae\uff08Acknowledge/NotAcknowledge\uff09\u3002</p> <p></p> <p>\u56fe 2\u201125 \u6570\u636e\u94fe\u8def\u5c42\u91cd\u4f20\u673a\u5236</p> <p></p> <p>\u56fe 2\u201126 \u5728\u6570\u636e\u94fe\u8def\u5c42\u4e2d\u7684TLP\u4e0eDLLP\u7684\u5305\u7ed3\u6784</p> <p>\u4e00\u4e2aDLLP\u7684\u57fa\u7840\u5f62\u5f0f\u5982\u56fe 2\u201126\u6240\u793a\uff0c\u5b83\u75314Byte\u7684DLLP\u7c7b\u578b\u57df\uff08DLLP Type field\uff09\u4ee5\u53ca2Byte CRC\u7ec4\u6210\uff0c\u5176\u4e2dDLLP\u7c7b\u578b\u57df\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u5176\u4ed6\u7684\u4fe1\u606f\u3002</p> <p>\u5982\u56fe 2\u201127\u6240\u793a\uff0c\u5b83\u5c55\u793a\u4e86\u4e00\u4e2amemory read TLP\u901a\u8fc7Switch\u7684\u793a\u4f8b\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <p>1. \u6b65\u9aa41a**\uff1a**Requester\u53d1\u9001\u4e00\u4e2amemory read\u8bf7\u6c42\uff0c\u5e76\u5728\u81ea\u8eab\u7684\u91cd\u4f20Buffer\uff08replay buffer\uff09\u4e2d\u4e5f\u4fdd\u5b58\u4e00\u4e2a\u8bf7\u6c42\u5305\u7684\u526f\u672c\u3002Switch\u63a5\u6536\u8fd9\u4e2aMRd TLP\uff08Memory Read TLP\uff0c\u4ee5\u540e\u7b80\u5199\u4e3aMRd TLP\uff09\uff0c\u5e76\u6821\u9a8cLCRC\u4ee5\u53ca\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3002</p> <p>\u6b65\u9aa41b**\uff1a**\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64Switch\u5411Requester\u8fd4\u56de\u4e00\u4e2aAck DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0cRequester\u5c06\u5176\u91cd\u4f20Buffer\u4e2d\u4fdd\u5b58\u7684\u8fd9\u4e2aMRd TLP\u7684\u526f\u672c\u4e22\u5f03\u3002</p> <p>2. \u6b65\u9aa42a**\uff1a**Switch\u5c06\u8fd9\u4e2aMRd TLP\u8f6c\u53d1\u5230\u6b63\u786e\u7684\u8f93\u51fa\u7aef\u53e3\uff0c\u4f7f\u7528\u7684\u8def\u7531\u4fe1\u606f\u662f\u8fd9\u4e2aMRd TLP\u7684memory\u5730\u5740\uff0c\u5728\u8f6c\u53d1\u51fa\u53bb\u7684\u540c\u65f6\uff0cSwitch\u4f1a\u5728\u8fd9\u4e2a\u8f93\u51fa\u7aef\u53e3\u7684\u91cd\u4f20Buffer\u5185\u4fdd\u5b58\u4e00\u4efd\u8fd9\u4e2aTLP\u7684\u526f\u672c\u3002Completer\u63a5\u6536\u5230\u8fd9\u4e2aMRd TLP\u5e76\u5bf9\u5176\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002</p> <p>\u6b65\u9aa42b**\uff1a**\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64Completer\u5411Switch\u8fd4\u56de\u4e00\u4e2aAck DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0cSwitch\u4e4b\u524d\u8f93\u51fa\u8fd9\u4e2aTLP\u7684\u8f93\u51fa\u7aef\u53e3\u4f1a\u5c06\u5176\u91cd\u4f20Buffer\u4e2d\u4fdd\u5b58\u7684\u8fd9\u4e2aMRd TLP\u7684\u526f\u672c\u4e22\u5f03\u3002</p> <p>3. \u6b65\u9aa43a**\uff1a**\u4f5c\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u6700\u7ec8\u76ee\u7684\u5730\uff0cCompleter\u5c06\u4f1a\u6821\u9a8cMRd TLP\u4e2d\u7684ECRC\u5b57\u6bb5\u57df\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u57df\u662f\u53ef\u9009\u7684\u4e0d\u662f\u5fc5\u9700\u7684\u3002\u82e5\u6821\u9a8c\u672a\u51fa\u9519\uff0c\u5219\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u5448\u4ea4\u7ed9Device Core\u3002\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u8bf7\u6c42\u547d\u4ee4\u4e2d\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u8bbe\u5907\u5c06\u4f1a\u6536\u96c6\u88ab\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u5e76\u5411Requester\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff08Completion with Data TLP\uff0cCplD\uff09\uff0c\u540c\u65f6\u5b83\u4e5f\u5c06\u5728\u81ea\u5df1\u7684\u91cd\u4f20Buffer\u4e2d\u4fdd\u5b58\u8fd9\u4e2aCplD TLP\u7684\u526f\u672c\u3002\u5f53Switch\u63a5\u6536\u5230\u8fd9\u4e2aCplD TLP\u65f6\u5c06\u4f1a\u5bf9\u5176\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002</p> <p>\u6b65\u9aa43b**\uff1a**\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64Switch\u5411Completer\u8fd4\u56de\u4e00\u4e2aAck DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0cCompleter\u5c06\u5176\u91cd\u4f20Buffer\u4e2d\u4fdd\u5b58\u7684\u8fd9\u4e2aCplD TLP\u7684\u526f\u672c\u6e05\u9664\u3002</p> <p>4. \u6b65\u9aa44a**\uff1a**Switch\u5bf9\u8fd9\u4e2aCplD TLP\u4e2d\u7684Requester ID\u8fdb\u884c\u8bd1\u7801\uff0c\u5e76\u901a\u8fc7\u8fd9\u4e2a\u4fe1\u606f\u5c06CplD TLP\u8def\u7531\u81f3\u6b63\u786e\u7684\u8f93\u51fa\u7aef\u53e3\uff0c\u8f93\u51fa\u7684\u540c\u65f6\u5728\u8fd9\u4e2a\u8f93\u51fa\u7aef\u53e3\u7684\u91cd\u4f20Buffer\u5185\u4fdd\u5b58CplD TLP\u7684\u526f\u672c\u3002\u5f53Requester\u63a5\u6536\u5230\u8fd9\u4e2aCplD TLP\u65f6\u5c06\u4f1a\u5bf9\u5176\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\u3002</p> <p>\u6b65\u9aa44b**\uff1a**\u6821\u9a8c\u672a\u53d1\u73b0\u51fa\u9519\uff0c\u56e0\u6b64Requester\u5411Switch\u8fd4\u56de\u4e00\u4e2aAck DLLP\u3002\u4f5c\u4e3a\u54cd\u5e94\uff0cSwitch\u4e4b\u524d\u8f93\u51fa\u8fd9\u4e2aCplD TLP\u7684\u8f93\u51fa\u7aef\u53e3\u4f1a\u5c06\u5176\u91cd\u4f20Buffer\u4e2d\u4fdd\u5b58\u7684\u8fd9\u4e2aCplD TLP\u7684\u526f\u672c\u4e22\u5f03\u3002Requester\u5c06\u6821\u9a8cECRC\u5b57\u6bb5\u57df\uff08\u8fd9\u4e2a\u5b57\u6bb5\u662f\u53ef\u9009\u7684\uff0c\u4e0d\u662f\u5fc5\u9700\u7684\uff09\uff0c\u6821\u9a8c\u672a\u51fa\u9519\u5219\u5c06\u5b8c\u6210\u5305\u91cc\u7684\u6570\u636e\u5411\u4e0a\u5448\u4ea4\u7ed9Device Core\u903b\u8f91\u3002</p> <p></p> <p>\u56fe 2\u201127\u4f7f\u7528Ack/Nak\u534f\u8bae\u7684Non-Posted\u4e8b\u52a1</p>"},{"location":"pcie/all/#2233-flow-control","title":"2.2.3.3   \u6d41\u91cf\u63a7\u5236\uff08Flow Control\uff09","text":"<p>\u6570\u636e\u94fe\u8def\u5c42\u7684\u7b2c\u4e8c\u4e2a\u4e3b\u8981\u529f\u80fd\u5c31\u662f\u6d41\u91cf\u63a7\u5236\u3002\u5728\u7cfb\u7edf\u4e0a\u7535\u548c\u590d\u4f4d\u4e4b\u540e\uff0c\u6d41\u91cf\u63a7\u5236\u673a\u5236\u88ab\u6570\u636e\u94fe\u8def\u5c42\u7684\u786c\u4ef6\u81ea\u52a8\u521d\u59cb\u5316\uff0c\u5e76\u5728\u6574\u4e2a\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u66f4\u65b0\u3002\u5173\u4e8e\u8fd9\u4e9b\u5185\u5bb9\u7684\u6982\u8ff0\u5df2\u7ecf\u5728TLP\u7684\u90a3\u4e00\u8282\u7ed9\u51fa\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\u60f3\u8981\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u8fd9\u4e00\u4e3b\u9898\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605Chapter 6\u201cFlow Control\u201d\u3002</p>"},{"location":"pcie/all/#2234-power-management","title":"2.2.3.4   \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09","text":"<p>\u6700\u540e\u8981\u4ecb\u7ecd\u7684\u4e00\u70b9\uff0c\u6570\u636e\u94fe\u8def\u5c42\u4e5f\u53c2\u4e0e\u4e86\u7535\u6e90\u7ba1\u7406\uff0c\u56e0\u4e3a\u94fe\u8def\u4e0e\u7cfb\u7edf\u7535\u6e90\u72b6\u6001\u76f8\u5173\u7684\u8bf7\u6c42\u548c\u63e1\u624b\u4e5f\u53ef\u4ee5\u901a\u8fc7DLLP\u6765\u8fdb\u884c\u3002\u60f3\u4e86\u89e3\u5173\u4e8e\u8fd9\u4e00\u4e3b\u9898\u7684\u66f4\u8be6\u7ec6\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605Chapter 16\u201cPower Management\u201d\u3002</p>"},{"location":"pcie/all/#224-physical-layer","title":"2.2.4     \u7269\u7406\u5c42\uff08Physical Layer\uff09","text":""},{"location":"pcie/all/#2241-general","title":"2.2.4.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u7269\u7406\u5c42\u65f6PCIe\u534f\u8bae\u5c42\u6b21\u91cc\u7684\u6700\u5e95\u5c42\uff0c\u5982\u56fe 2\u201114\u3002TLP\u548cDLLP\u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u6570\u636e\u5305\u90fd\u9700\u8981\u4ece\u6570\u636e\u94fe\u8def\u5c42\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\uff0c\u8fd9\u6837\u624d\u80fd\u901a\u8fc7\u94fe\u8def\u4f20\u8f93\u81f3\u5bf9\u7aef\u63a5\u6536\u65b9\u8bbe\u5907\uff0c\u5e76\u4ece\u63a5\u6536\u65b9\u7684\u7269\u7406\u5c42\u5411\u4e0a\u8f6c\u53d1\u81f3\u5b83\u7684\u6570\u636e\u94fe\u8def\u5c42\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u5c06\u5173\u4e8e\u7269\u7406\u5c42\u7684\u8ba8\u8bba\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\u903b\u8f91\u90e8\u5206\u548c\u7535\u6c14\u90e8\u5206\u3002\u6211\u4eec\u8fd9\u91cc\u4e5f\u5c06\u4fdd\u7559\u8fd9\u79cd\u5212\u5206\u65b9\u5f0f\u3002\u903b\u8f91\u7269\u7406\u5c42\uff08Logical Physical Layer\uff09\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u7684\u6570\u5b57\u903b\u8f91\uff0c\u8fd9\u4e9b\u6570\u5b57\u903b\u8f91\u662f\u5173\u4e8e\u51c6\u5907\u5c06\u6570\u636e\u5305\u5728\u94fe\u8def\u4e0a\u8fdb\u884c\u4e32\u884c\u4f20\u8f93\u7684\u903b\u8f91\u4ee5\u53ca\u76f8\u53cd\u7684\u8f93\u5165\u6570\u636e\u5305\u7684\u5904\u7406\u903b\u8f91\u3002\u7535\u6c14\u7269\u7406\u5c42\uff08Electrical Physical Layer\uff09\u662f\u7269\u7406\u5c42\u7684\u6a21\u62df\u7535\u8def\u63a5\u53e3\uff0c\u5b83\u4e0e\u94fe\u8def\u76f4\u63a5\u76f8\u8fde\uff0c\u5b83\u4e3a\u6bcf\u4e2a\u901a\u9053\uff08Lane\uff09\u63d0\u4f9b\u5dee\u5206\u9a71\u52a8\u5668\uff08differential driver\uff09\u4ee5\u53ca\u5dee\u5206\u63a5\u6536\u5668\uff08differential receiver\uff09\u3002</p>"},{"location":"pcie/all/#2242-physical-layer-logical","title":"2.2.4.2   \u903b\u8f91\u7269\u7406\u5c42\uff08Physical Layer-Logical\uff09","text":"<p>\u7531\u6570\u636e\u94fe\u8def\u5c42\u8f6c\u53d1\u6765\u7684TLP\u4e0eDLLP\u88ab\u7269\u7406\u5c42\u4e2d\u7684buffer\u6240\u8bb0\u5f55\uff0c\u5728\u8fd9\u4e2abuffer\u4e2d\u4f1a\u5bf9\u8fd9\u4e9b\u6570\u636e\u5305\u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u8fd9\u4e24\u4e2a\u5b57\u7b26\u5c06\u6709\u52a9\u4e8e\u63a5\u6536\u7aef\u7528\u6765\u68c0\u6d4b\u6570\u636e\u5305\u7684\u8fb9\u754c\u3002\u7531\u4e8e\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\u5206\u522b\u51fa\u73b0\u5728\u6570\u636e\u5305\u7684\u4e24\u7aef\uff08\u5934\u548c\u5c3e\uff09\uff0c\u56e0\u6b64\u4ed6\u4eec\u4e5f\u88ab\u79f0\u4f5c\u201c\u7ec4\u5e27\uff08framing\uff09\u201d\u5b57\u7b26\u3002\u5982\u56fe 2\u201128\u5c55\u793a\u4e86\u7ec4\u5e27\u5b57\u7b26\u88ab\u6dfb\u52a0\u5728TLP\u548cDLLP\u4e0a\uff0c\u5b83\u4e5f\u5c55\u793a\u4e86\u8fd9\u4e24\u79cd\u5b57\u7b26\u7684\u5b57\u6bb5\u957f\u5ea6\u3002</p> <p></p> <p>\u56fe 2\u201128\u7269\u7406\u5c42\u4e2d\u7684TLP\u4e0eDLLP\u7684\u7ed3\u6784</p> <p>\u5728\u7269\u7406\u5c42\u4e2d\uff0c\u6570\u636e\u5305\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u8282\u90fd\u5c06\u88ab\u5206\u5272\u5230\u94fe\u8def\u6240\u4f7f\u7528\u7684\u6240\u6709\u901a\u9053\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u5b57\u8282\u6761\u5e26\u5316\uff08Byte Striping\uff09\u3002\u5b9e\u9645\u4e0a\uff0c\u6bcf\u4e2a\u901a\u9053\u5728\u94fe\u8def\u4e0a\u90fd\u626e\u6f14\u7740\u4e00\u4e2a\u72ec\u7acb\u7684\u4e32\u884c\u4f20\u8f93\u8def\u5f84\uff0c\u8fd9\u4e9b\u901a\u9053\u4eec\u5404\u81ea\u4f20\u8f93\u7684\u6570\u636e\u4f1a\u5728\u63a5\u6536\u7aef\u88ab\u805a\u5408\u3002\u6bcf\u4e2a\u5b57\u8282\u90fd\u8fdb\u884c\u4e86\u6270\u7801\uff0c\u4ee5\u6b64\u6765\u51cf\u5c11\u5728\u4f20\u8f93\u7ebf\u4e0a\u4f20\u8f93\u8fde\u7eed\u91cd\u590d\u7684\u201c0\u201d\u6216\u201c1\u201d\uff0c\u8fd9\u6709\u52a9\u4e8e\u51cf\u5c11\u94fe\u8def\u4e0a\u7684EMI\uff08electro-magnetic interference\uff0c\u7535\u78c1\u5e72\u6270\uff09\u3002\u5bf9\u4e8e\u524d\u4e24\u4ee3\u7684PCIe\uff08Gen1\u548cGen2\uff09\uff0c8bit\u7684\u5b57\u7b26\u5c06\u88ab\u7f16\u7801\u4e3a10bit\u201c\u7b26\u53f7\uff08symbol\uff09\u201d\uff0c\u6240\u4f7f\u7528\u7684\u7f16\u7801\u65b9\u5f0f\u88ab\u79f0\u4e3a8b/10b\u7f16\u7801\u3002\u8fd9\u79cd\u7f16\u7801\u589e\u52a0\u4e86\u8f93\u51fa\u6570\u636e\u6d41\u7684\u989d\u5916\u5f00\u9500\uff0c\u4f46\u662f\u4e5f\u5e26\u6765\u4e86\u4e0d\u5c11\u6709\u7528\u7684\u7279\u6027\uff08\u5173\u4e8e\u8fd9\u91cc\u7684\u66f4\u591a\u5185\u5bb9\u8bf7\u89c1\u201c8b/10b Encoding\u201d\u4e00\u8282\uff09\u3002PCIe Gen3\u7684\u7269\u7406\u5c42\u903b\u8f91\u5728\u4f7f\u7528Gen3\u901f\u7387\u8fdb\u884c\u4f20\u8f93\u65f6\uff08\u56e0\u4e3a\u4e5f\u53ef\u4ee5\u5411\u4e0b\u517c\u5bb9Gen1\u3001Gen2\u901f\u7387\uff09\uff0c\u4e0d\u518d\u4f7f\u75288b/10b\u7f16\u7801\u65b9\u5f0f\uff0c\u800c\u662f\u91c7\u7528\u4e86\u53e6\u4e00\u79cd\u88ab\u79f0\u4e3a128b/130b\u7684\u7f16\u7801\uff0c\u5b83\u4f1a\u5c06\u6570\u636e\u5305\u7684\u5b57\u8282\u6270\u7801\u540e\u8fdb\u884c\u4f20\u8f93\u3002\u6bcf\u4e2a\u901a\u9053\uff08Lane\uff09\u768410b\u7b26\u53f7\uff08\u5bf9\u4e8eGen1 Gen2\uff09\u6216\u8005\u6bcf\u4e2a\u901a\u9053\u7684\u6570\u636e\u5305\u7684\u5b57\u8282\uff08\u5bf9\u4e8eGen3\uff09\u968f\u540e\u5c31\u4f1a\u5728\u94fe\u8def\u7684\u6bcf\u4e2a\u901a\u9053\u4e0a\u4ee5\u4e32\u884c\u5dee\u5206\u7684\u5f62\u5f0f\u88ab\u4f20\u8f93\uff0c\u5bf9\u5e94\u7684\u901f\u7387\u4e3aGen1 2.5GT/s\uff0cGen2 5GT/s\uff0cGen3 8GT/s\u3002</p> <p>\u5f53\u6570\u636e\u5305\u7684bit\u5230\u8fbe\u63a5\u6536\u7aef\u65f6\uff0c\u63a5\u6536\u7aef\u4ee5\u8bad\u7ec3\u5b8c\u6210\u7684\u65f6\u949f\u901f\u7387\u5bf9\u8fd9\u4e9b\u6570\u636e\u5305\u7684bit\u8fdb\u884c\u63a5\u6536\u3002\u5982\u679c\u4f7f\u7528\u7684\u662f8b/10b\u7f16\u7801\uff0c\u90a3\u4e48\u8f93\u5165\u7684\u6bd4\u7279\u6d41\u5c06\u88ab\u4e32\u5e76\u8f6c\u6362\u5668\u8f6c\u6362\u621010bit\u7b26\u53f7\uff0c\u7136\u540e\u51c6\u5907\u7528\u6765\u505a8b/10b\u89e3\u7801\u3002\u7136\u800c\uff0c\u5728\u89e3\u7801\u4e4b\u524d\uff0c10bit\u7b26\u53f7\u5c06\u4f1a\u7ecf\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\uff08elastic buffer\uff09\uff0c\u8fd9\u662f\u4e00\u4e2a\u806a\u660e\u7684\u8bbe\u5907\uff0c\u5b83\u53ef\u4ee5\u5bf9\u4e24\u4e2a\u76f8\u8fde\u63a5\u8bbe\u5907\u5404\u81ea\u5185\u90e8\u65f6\u949f\u4e4b\u95f4\u7684\u5fae\u5c0f\u9891\u7387\u5dee\u5f02\u8fdb\u884c\u8865\u507f\u3002\u63a5\u4e0b\u6765\uff0c10bit\u7b26\u53f7\u88ab8b/10b\u89e3\u7801\u5668\u89e3\u7801\uff0c\u6b63\u786e\u5730\u6062\u590d\u62108bit\u5b57\u7b26\u3002PCIe Gen3\u4e0e\u524d\u9762\u6240\u8ff0\u7684\u8fd9\u4e2a\u8fc7\u7a0b\u4e0d\u540c\uff0c\u5bf9\u4e8eGen3\u7684\u7269\u7406\u5c42\u903b\u8f91\u6765\u8bf4\uff0c\u5f53\u63a5\u6536\u5230\u4ee5Gen3\u901f\u7387\u4f20\u8f93\u7684\u6570\u636e\u5305\u4e32\u884c\u6bd4\u7279\u6d41\u65f6\uff0c\u5c06\u4f7f\u7528\u4e32\u5e76\u8f6c\u6362\u5668\u5c06\u8fd9\u4e2a\u6bd4\u7279\u6d41\u8f6c\u6362\u4e3a\u5b57\u8282\u6d41\uff0c\u8fd9\u4e2a\u4e32\u5e76\u8f6c\u6362\u5668\u5df2\u7ecf\u5efa\u7acb\u4e86\u5757\u9501\u5b9a\uff08Block Lock\uff0c\u8fd9\u662f\u94fe\u8def\u8bad\u7ec3\u4e2d\u7684\u4e00\u4e2a\u8981\u7d20\uff09\u3002\u968f\u540e\u5b57\u8282\u6d41\u4f1a\u901a\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\u8fdb\u884c\u65f6\u949f\u5bb9\u5fcd\u5ea6\u8865\u507f\uff08clock tolerance compensation\uff09\u3002\u5728Gen3\u901f\u7387\u4e0b\u6570\u636e\u5305\u6570\u636e\u5e76\u6ca1\u6709\u4f7f\u75288b/10b\u7f16\u7801\uff0c\u56e0\u6b64\u53ef\u4ee5\u8df3\u8fc78b/10b\u89e3\u7801\u8fd9\u4e00\u6b65\u3002\u6700\u7ec8\uff0c\u6bcf\u4e2a\u901a\u9053\u4e2d\u76848bit\u5b57\u7b26\u90fd\u5c06\u7ecf\u8fc7\u89e3\u6270\uff0c\u7136\u540e\u7ecf\u8fc7\u53cd\u6761\u5e26\u5316\uff08un-striped\uff09\u4e4b\u540e\u5c06\u6240\u6709\u901a\u9053\u5185\u7684\u5b57\u8282\u805a\u5408\u91cd\u65b0\u6062\u590d\u6210\u5355\u7b26\u53f7\u6d41\uff08single character stream\uff09\uff0c\u8fd9\u6837\u5c31\u5728\u63a5\u6536\u7aef\u6062\u590d\u51fa\u4e86\u53d1\u9001\u7aef\u6240\u53d1\u51fa\u7684\u6570\u636e\u6d41\u3002</p>"},{"location":"pcie/all/#2243-link-training-and-initialization","title":"2.2.4.3   \u94fe\u8def\u8bad\u7ec3\u548c\u521d\u59cb\u5316\uff08Link Training and Initialization\uff09","text":"<p>\u7269\u7406\u5c42\u7684\u53e6\u4e00\u4e2a\u4efb\u52a1\u5c31\u662f\u8d1f\u8d23\u94fe\u8def\u7684\u521d\u59cb\u5316\u4ee5\u53ca\u8bad\u7ec3\u8fc7\u7a0b\u3002\u5728\u8fd9\u4e2a\u5168\u81ea\u52a8\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e3a\u4e86\u8ba9\u94fe\u8def\u51c6\u5907\u597d\u8fdb\u884c\u6b63\u5e38\u5de5\u4f5c\uff0c\u6211\u4eec\u91c7\u7528\u4e86\u51e0\u4e2a\u6b65\u9aa4\uff0c\u4e3b\u8981\u4e3a\u786e\u5b9a\u51e0\u4e2a\u53ef\u9009\u6761\u4ef6\u7684\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u94fe\u8def\u5bbd\u5ea6\u53ef\u4ee5\u4ece1\u901a\u9053\u523032\u901a\u9053\uff0c\u5e76\u4e14\u53ef\u4ee5\u63d0\u4f9b\u591a\u79cd\u901f\u5ea6\u3002\u94fe\u8def\u8bad\u7ec3\u8fc7\u7a0b\u5c06\u4f1a\u53d1\u73b0\u8fd9\u4e9b\u53ef\u9009\u9879\u5e76\u901a\u8fc7\u4e00\u4e2a\u72b6\u6001\u673a\u6765\u5bfb\u6c42\u4e00\u4e2a\u5efa\u7acb\u6700\u4f73\u8fde\u63a5\u7684\u7ec4\u5408\uff0c\u4e5f\u5c31\u662f\u8bf4\u94fe\u8def\u8bad\u7ec3\u5c06\u4f1a\u786e\u8ba4\u8fd9\u4e9b\u53ef\u9009\u9879\u5177\u4f53\u7684\u503c\uff08\u94fe\u8def\u5bbd\u5ea6\u3001\u901f\u7387\u7b49\uff09\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u4e3a\u4e86\u786e\u4fdd\u6267\u884c\u6b63\u786e\u4ee5\u53ca\u6700\u4f18\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u68c0\u67e5\u6216\u8005\u5efa\u7acb\u4e00\u4e9b\u4e1c\u897f\uff0c\u4f8b\u5982\uff1a</p> <p>u \u94fe\u8def\u5bbd\u5ea6\uff08Link width\uff09</p> <p>u \u94fe\u8def\u6570\u636e\u7387\uff08Link data rate\uff09</p> <p>u \u901a\u9053\u8c03\u8f6c\uff08Lane reversal\uff09\u2014\u2014\u901a\u9053\u6536\u53d1\u8fde\u63a5\u76f8\u53cd\u4e86\uff0c\u672c\u5e94TX\u8fde\u5bf9\u7aefRX\uff0c\u82e5\u76f8\u53cd\u5219\u53d8\u6210TX\u8fde\u4e86\u5bf9\u7aefTX\u3002</p> <p>u \u6781\u6027\u53cd\u8f6c\uff08Polarity inversion\uff09\u2014\u2014\u901a\u9053\u6781\u6027\u8fde\u63a5\u76f8\u53cd\uff0cTX_P\u5e94\u5f53\u8fde\u63a5\u5bf9\u7aef\u7684RX_P\uff0c\u82e5\u76f8\u53cd\u5219\u53d8\u6210\u4e86TX_P\u8fde\u63a5\u4e86\u5bf9\u7aef\u7684RX_N\u3002</p> <p>u \u6bcf\u4e2a\u901a\u9053\u7684\u4f4d\u9501\u5b9a\uff08bit lock\uff09\u2014\u2014\u6062\u590d\u51fa\u53d1\u9001\u65b9\u7684\u65f6\u949f\u3002</p> <p>u \u6bcf\u4e2a\u901a\u9053\u7684\u7b26\u53f7\u9501\u5b9a\uff08symbol lock\uff09\u2014\u2014\u5728\u6bd4\u7279\u6d41\u4e2d\u627e\u5230\u4e00\u4e2a\u53ef\u8fa8\u8ba4\u7684\u4f4d\u7f6e\u3002</p> <p>u \u591a\u901a\u9053\u94fe\u8def\u4e2d\u7684Lane-to-Lane\u6b6a\u659c\u53bb\u9664\uff08de-skew\uff09\u3002</p>"},{"location":"pcie/all/#2244-physical-layer-electrical","title":"2.2.4.4   \u7535\u6c14\u7269\u7406\u5c42\uff08Physical Layer-Electrical\uff09","text":"<p>\u7269\u7406\u7684\u53d1\u9001\u5668\u548c\u63a5\u6536\u5668\u662f\u901a\u8fc7\u4e00\u4e2aAC\u8026\u5408\u94fe\u8def\u76f8\u8fde\u63a5\uff0c\u5982\u56fe 2\u201129\u6240\u793a\u3002\u6240\u8c13\u201cAC\u8026\u5408\uff08\u4ea4\u6d41\u8026\u5408\uff09\u201d\uff0c\u610f\u601d\u662f\u4e24\u4e2a\u8bbe\u5907\u76f8\u8fde\u63a5\u7684\u7269\u7406\u8def\u5f84\u4e0a\u653e\u7f6e\u6709\u7535\u5bb9\uff0c\u5b83\u7528\u4e8e\u8ba9\u4fe1\u53f7\u7684\u9ad8\u9891\u90e8\u5206\uff08AC\u4ea4\u6d41\uff09\u901a\u8fc7\uff0c\u800c\u963b\u585e\u4f4e\u9891\uff08DC\u76f4\u6d41\uff09\u90e8\u5206\u3002\u8bb8\u591a\u4e32\u884c\u4f20\u8f93\u65b9\u5f0f\u4e2d\u90fd\u4f7f\u7528\u4e86\u8fd9\u79cd\u65b9\u6cd5\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u7684\u5171\u6a21\u7535\u538b\u4e0d\u540c\uff08\u5171\u6a21\u7535\u538b\u6307\u7684\u662f0\u30011\u7535\u5e73\u4ea4\u754c\u5904\u7684\u7535\u538b\uff09\uff0c\u8fd9\u610f\u5473\u7740\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u53c2\u8003\u7535\u538b\u3002\u5f53\u4e24\u4e2a\u8bbe\u5907\u7684\u7269\u7406\u8fde\u63a5\u8ddd\u79bb\u5f88\u8fd1\u65f6\uff0c\u8fd9\u4e00\u7279\u6027\u4f18\u52bf\u5e76\u4e0d\u660e\u663e\uff0c\u800c\u82e5\u5b83\u4eec\u8ddd\u79bb\u8f83\u8fdc\u4f8b\u5982\u5728\u4e0d\u540c\u7684\u697c\u91cc\uff0c\u90a3\u4e48\u5b83\u4eec\u5c06\u5f88\u96be\u4f7f\u7528\u4e00\u4e2a\u5b8c\u5168\u76f8\u540c\u7684\u516c\u5171\u7684\u53c2\u8003\u7535\u538b\u3002</p> <p></p> <p>\u56fe 2\u201129 \u7535\u6c14\u7269\u7406\u5c42</p>"},{"location":"pcie/all/#2245-ordered-sets","title":"2.2.4.5   \u547d\u4ee4\u96c6\uff08Ordered Sets\uff09","text":"<p>\u6700\u540e\u8981\u4ecb\u7ecd\u7684\u4e00\u79cd\u5728\u8bbe\u5907\u4e4b\u95f4\u53d1\u9001\u7684\u6d41\u53ea\u4f7f\u7528\u7269\u7406\u5c42\u3002\u5c3d\u7ba1\u8fd9\u79cd\u4fe1\u606f\u5bf9\u4e8e\u63a5\u6536\u7aef\u6765\u8bf4\u5f88\u5bb9\u6613\u8fdb\u884c\u8bc6\u522b\uff0c\u4f46\u662f\u5b83\u5e76\u6ca1\u6709\u88ab\u505a\u6210\u6570\u636e\u5305\u7684\u5f62\u5f0f\uff0c\u539f\u56e0\u662f\u6bd4\u5982\u5b83\u6ca1\u6709\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\u3002\u56e0\u6b64\u4f5c\u4e3a\u4e00\u79cd\u66ff\u4ee3\u65b9\u6cd5\uff0c\u8fd9\u79cd\u4fe1\u606f\u88ab\u7ec4\u7ec7\u6210\u4e86\u4e00\u79cd\u88ab\u53eb\u505a\u201c\u547d\u4ee4\u96c6\uff08Ordered Sets\uff09\u201d\u7684\u4e1c\u897f\uff0c\u5b83\u8d77\u59cb\u4e8e\u53d1\u9001\u7aef\u7684\u7269\u7406\u5c42\uff0c\u7ec8\u6b62\u4e8e\u63a5\u6536\u7aef\u7684\u7269\u7406\u5c42\uff0c\u5982\u56fe 2\u201130\u6240\u793a\u90a3\u6837\u3002\u5bf9\u4e8eGen1\u548cGen2\u7684\u6570\u636e\u7387\u4e0b\uff0c\u4e00\u4e2a\u547d\u4ee4\u96c6\u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u7684COM\u5b57\u7b26\u4f5c\u4e3a\u8d77\u59cb\uff0c\u7136\u540e\u540e\u9762\u63a5\u77403\u4e2a\u6216\u4ee5\u4e0a\u7684\u5176\u4ed6\u5b57\u7b26\u7528\u4e8e\u5b9a\u4e49\u8981\u53d1\u9001\u7684\u4fe1\u606f\u3002\u5173\u4e8e\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u5b57\u7b26\u5728PCIe\u4e2d\u7684\u547d\u540d\u7684\u66f4\u7ec6\u8282\u7684\u8ba8\u8bba\u8bf7\u89c1\u201cCharacter Notation\u201d\u4e00\u8282\uff0c\u5bf9\u4e8e\u73b0\u9636\u6bb5\u6765\u8bf4\u53ea\u8981\u77e5\u9053COM\u5b57\u7b26\u7684\u7279\u6027\u80fd\u8ba9\u6211\u4eec\u8fbe\u5230\u60f3\u8981\u7684\u8bbe\u8ba1\u76ee\u6807\u5373\u53ef\u3002\u547d\u4ee4\u96c6\u7684\u5927\u5c0f\u603b\u662f4byte\u7684\u6574\u6570\u500d\uff0c\u56fe 2\u201131\u5c55\u793a\u4e86\u4e00\u4e2a\u547d\u4ee4\u96c6\u7684\u4f8b\u5b50\u3002\u5728Gen3\u64cd\u4f5c\u6a21\u5f0f\u4e2d\uff0c\u547d\u4ee4\u96c6\u7684\u683c\u5f0f\u5c31\u4e0d\u540c\u4e8e\u4e0a\u8ff0\u7684Gen1/Gen2\u683c\u5f0f\u4e86\u3002\u66f4\u591a\u8be6\u7ec6\u5185\u5bb9\u8bf7\u89c1Chapter 14\u201cLink Initialization &amp; Training\u201d\u3002\u547d\u4ee4\u96c6\u6c38\u8fdc\u53ea\u4f1a\u7ec8\u6b62\u4e8e\u94fe\u8def\u7684\u5bf9\u7aef\u8bbe\u5907\uff0c\u800c\u4e0d\u4f1a\u88abSwitch\u8def\u7531\u8f6c\u53d1\u81f3PCIe\u7f51\u7edc\u4e2d\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u7aef\u8bbe\u5907\u5982\u679c\u662fSwitch\u90a3\u4e48\u5b83\u7684\u6700\u7ec8\u76ee\u7684\u5730\u5c31\u662fSwitch\u3002</p> <p></p> <p>\u56fe 2\u201130\u547d\u4ee4\u96c6\u7684\u51fa\u53d1\u5730\u548c\u76ee\u7684\u5730</p> <p>\u547d\u4ee4\u96c6\u5728\u94fe\u8def\u8bad\u7ec3\uff08Link Training\uff09\u8fc7\u7a0b\u4e2d\u540c\u6837\u6709\u5e94\u7528\uff0c\u8bf7\u53c2\u9605Chapter 14\u201cLink Initialization &amp; Training\u201d\u3002\u5b83\u4eec\u4e5f\u88ab\u7528\u4e8e\u8865\u507f\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\u5185\u90e8\u65f6\u949f\u7684\u8f7b\u5fae\u5dee\u5f02\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u65f6\u949f\u5bb9\u5fcd\u5ea6\u8865\u507f\uff08clock tolerance compensation\uff09\u3002\u6700\u540e\u4e00\u70b9\uff0c\u547d\u4ee4\u96c6\u8fd8\u53ef\u4ee5\u7528\u4e8e\u6307\u793a\u94fe\u8def\u8fdb\u5165\u6216\u8005\u9000\u51fa\u4f4e\u529f\u8017\u72b6\u6001\u3002</p> <p></p> <p>\u56fe 2\u201131\u547d\u4ee4\u96c6\u7ed3\u6784</p>"},{"location":"pcie/all/#23-protocol-review-example","title":"2.3 \u534f\u8bae\u56de\u987e\uff08Protocol Review Example\uff09","text":"<p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u793a\u4f8b\u6765\u56de\u987e\u6574\u4e2a\u94fe\u8def\u534f\u8bae\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u5c06\u4eceRequester\u53d1\u8d77\u4e00\u4e2aMemory Read\u8bf7\u6c42\uff08MRd\uff09\u5f00\u59cb\uff0c\u76f4\u5230Requester\u4eceCompleter\u83b7\u5f97\u6240\u8bf7\u6c42\u7684\u6570\u636e\u4e3a\u6b62\uff0c\u8bb2\u89e3\u8fd9\u8fc7\u7a0b\u4e2d\u6240\u53d1\u751f\u7684\u64cd\u4f5c\u6b65\u9aa4\u3002</p>"},{"location":"pcie/all/#231-memory-read-requestmrd","title":"2.3.1     Memory Read Request\uff08MRd\u8bf7\u6c42\uff09","text":"<p>\u5173\u4e8e\u6211\u4eec\u5f00\u59cb\u8ba8\u8bba\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u8bf7\u53c2\u8003\u56fe 2\u201132\u3002Requester\u7684Device Core\u6216\u8005\u8bf4\u662f\u8f6f\u4ef6\u5c42\u5c06\u4f1a\u5411\u4e8b\u52a1\u5c42\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u4e2d\u5305\u542b\u4e86\u8fd9\u4e9b\u4fe1\u606f\uff1a32bit\u621664bit\u7684memory\u5730\u5740\u3001\u4e8b\u52a1\u7c7b\u578b\u3001\u9700\u8981\u8bfb\u53d6\u7684\u6570\u91cf\u603b\u91cf\uff08\u4ee5dw\u4e3a\u5355\u4f4d\u8ba1\u6570\uff09\u3001\u6d41\u91cf\u7c7b\u578b\u3001\u5b57\u8282\u4f7f\u80fd\u3001\u5c5e\u6027\u7b49\u7b49\u3002</p> <p></p> <p>\u56fe 2\u201132 Memory Read\u8bf7\u6c42\u7684\u5404\u9636\u6bb5</p> <p>\u4e8b\u52a1\u5c42\u4f7f\u7528\u4e0a\u9762\u6240\u8ff0\u7684\u90a3\u4e9b\u4fe1\u606f\u6765\u6784\u5efa\u4e00\u4e2aMRd TLP\u3002\u5173\u4e8eTLP\u5185\u90e8\u683c\u5f0f\u7684\u7ec6\u8282\u6211\u4eec\u7a0d\u540e\u518d\u8fdb\u884c\u63cf\u8ff0\uff0c\u76ee\u524d\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053TLP\u7684Header\u5927\u5c0f\u4e3a3DW\u62164DW\uff0c\u8fd9\u53d6\u51b3\u4e8e\u5b83\u7684\u5730\u5740\u5b57\u6bb5\u7684\u5927\u5c0f\uff0832bit\u5730\u5740\u5bf9\u5e943DW Header\uff0c64bit\u5730\u5740\u5bf9\u5e944DW Header\uff09\u3002\u6b64\u5916\uff0c\u5728Header\u4e2d\u8fd8\u6709\u4e8b\u52a1\u5c42\u52a0\u5165\u7684Requester ID\u5b57\u6bb5\uff08bus#\uff0cdevice#\uff0cfunction#\uff09\uff0cCompleter\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2aRequester ID\u5b57\u6bb5\u6765\u8fd4\u56de\u5b8c\u6210\u5305\u3002TLP\u968f\u540e\u88ab\u7f6e\u5165\u76f8\u5e94\u4f18\u5148\u7ea7\u7684\u865a\u62df\u901a\u9053buffer\u4e2d\uff0c\u7b49\u5f85\u8f6e\u5230\u5b83\u88ab\u53d1\u9001\u3002\u4e00\u65e6\u8fd9\u4e2aTLP\u88ab\u9009\u4e2d\uff0c\u6d41\u91cf\u63a7\u5236\u903b\u8f91\u5c06\u4f1a\u786e\u8ba4\u5bf9\u7aef\u8bbe\u5907\u7684\u63a5\u6536buffer\uff08VC\uff0c\u865a\u62df\u901a\u9053\uff09\u6709\u8db3\u591f\u7684\u53ef\u7528\u7a7a\u95f4\u6765\u63a5\u6536\u8fd9\u4e2aTLP\uff0c\u7136\u540eMRd TLP\u5c31\u88ab\u5411\u4e0b\u53d1\u9001\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u5728\u6570\u636e\u94fe\u8def\u5c42\u4e2d\uff0c\u6570\u636e\u5305\u88ab\u52a0\u4e0a12bit\u7684\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u4ee5\u53ca32bit\u7684LCRC\u3002\u5e76\u5728\u91cd\u4f20Buffer\uff08Replay Buffer\uff09\u4e2d\u4fdd\u5b58\u8fd9\u4e2aTLP\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u7136\u540e\u8fd9\u4e2a\u6570\u636e\u5305\u5c31\u88ab\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\u3002</p> <p>\u5728\u7269\u7406\u5c42\u4e2d\uff0c\u6570\u636e\u5305\u88ab\u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u4ee5\u53ca\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u7136\u540e\u5728\u6240\u6709\u53ef\u7528\u7684\u901a\u9053\u4e0a\u8fdb\u884c\u5b57\u8282\u6761\u5e26\u5316\uff08byte striping\uff09\uff0c\u518d\u8fdb\u884c\u6270\u7801\uff08Scramble\uff09\u30018b/10b\u7f16\u7801\u3002\u6700\u7ec8\u8fd9\u4e2a\u6570\u636e\u5305\u7684\u6bd4\u7279\u5728\u94fe\u8def\u4e0a\u7684\u6bcf\u4e2a\u901a\u9053\u5185\u4ee5\u4e32\u884c\u5dee\u5206\u7684\u5f62\u5f0f\u4f20\u8f93\u5230\u5bf9\u7aef\u3002</p> <p>Completer\u63a5\u6536\u5230\u8f93\u5165\u7684\u6bd4\u7279\u6d41\uff0c\u5b83\u5c06\u8fd9\u4e2a\u6bd4\u7279\u6d41\u5148\u8fdb\u884c\u4e32\u5e76\u8f6c\u6362\u5c06\u6bd4\u7279\u6d41\u6062\u590d\u621010bit\u7b26\u53f7\uff0c\u7136\u540e\u8ba9\u5b83\u4eec\u901a\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\u3002\u968f\u540e10bit\u7b26\u53f7\u88ab\u89e3\u7801\u540e\u6062\u590d\u6210\u5b57\u8282\uff0c\u7136\u540e\u6bcf\u4e2a\u901a\u9053\u4e0a\u7684\u5b57\u8282\u90fd\u88ab\u89e3\u6270\uff08de-scramble\uff09\u4ee5\u53ca\u53cd\u6761\u5e26\u5316\uff08un-striped\uff09\u3002\u63a5\u4e0b\u6765Completer\u7269\u7406\u5c42\u68c0\u6d4b\u5230\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u5e76\u5c06\u5b83\u4eec\u4eceTLP\u4e2d\u5265\u9664\u3002\u5269\u4f59\u7684TLP\u88ab\u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>Completer\u7684\u6570\u636e\u94fe\u8def\u5c42\u5c06\u5bf9\u63a5\u6536\u5230\u7684TLP\u8fdb\u884cLCRC\u9519\u8bef\u6821\u9a8c\uff0c\u5e76\u68c0\u67e5TLP\u5e8f\u5217\u53f7\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728TLP\u4e22\u5931\u6216TLP\u5931\u5e8f\u3002\u82e5\u8fd9\u4e9b\u6b65\u9aa4\u90fd\u65e0\u9519\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c06\u751f\u6210\u4e00\u4e2aAck\u4fe1\u606f\uff0c\u91cc\u9762\u5305\u542b\u4e86\u4e0e\u8fd9\u4e2aMRd TLP\u4e2d\u76f8\u540c\u7684\u5e8f\u5217\u53f7\u3002\u7136\u540e\u518d\u7ed9\u8fd9\u4e2aAck\u4fe1\u606f\u52a0\u4e0a16bit\u7684CRC\uff0c\u8fd9\u6837\u5c31\u7ec4\u6210\u4e86\u4e00\u4e2aAck DLLP\uff0c\u5c06\u8fd9\u4e2aAck DLLP\u9001\u56de\u7269\u7406\u5c42\uff0c\u7531\u7269\u7406\u5c42\u52a0\u4e0a\u76f8\u5e94\u7684\u7ec4\u5e27\u7b26\u53f7\uff08framing symbol\uff09\uff0c\u5e76\u628aAck DLLP\u4f20\u8f93\u7ed9Requester\u3002</p> <p>Requester\u7684\u7269\u7406\u5c42\u63a5\u6536\u5230Ack DLLP\u540e\uff0c\u5bf9\u5176\u7ec4\u5e27\u7b26\u53f7\u8fdb\u884c\u68c0\u67e5\u548c\u5265\u9664\uff0c\u7136\u540e\u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002\u5982\u679c\u6570\u636e\u94fe\u8def\u5c42\u5bf9\u5176CRC\u6821\u9a8c\u65e0\u9519\uff0c\u5b83\u5c06\u4f1a\u7528Ack DLLP\u5185\u7684\u5e8f\u5217\u53f7\u4e0e\u91cd\u4f20Buffer\u4e2d\u4fdd\u5b58\u7684TLP\u526f\u672c\u7684\u5e8f\u5217\u53f7\u8fdb\u884c\u6bd4\u8f83\uff0c\u5e76\u5c06\u4e0eAck DLLP\u4e2d\u5e8f\u5217\u53f7\u76f8\u5339\u914d\u7684TLP\u526f\u672c\u4ece\u91cd\u4f20Buffer\u4e2d\u6e05\u9664\u3002\u76f8\u53cd\u5730\uff0c\u82e5Requester\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2aNak DLLP\uff0c\u90a3\u4e48\u5b83\u5c06\u628a\u5e8f\u5217\u53f7\u5339\u914d\u7684\u8fd9\u4e2aMRd TLP\u8fdb\u884c\u91cd\u4f20\u3002\u7531\u4e8eDLLP\u4ec5\u5bf9\u6570\u636e\u94fe\u8def\u5c42\u6709\u610f\u4e49\uff0c\u6240\u4ee5\u5728\u8fd9\u4e9bDLLP\u7684\u64cd\u4f5c\u4e2d\u5c06\u4e0d\u4f1a\u6709\u4e1c\u897f\u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002</p> <p>\u9664\u4e86\u4e0a\u8ff0\u7684\u4ea7\u751fAck DLLP\u4e4b\u5916\uff0cCompleter\u7684\u6570\u636e\u94fe\u8def\u5c42\u8fd8\u5c06\u628aTLP\u5411\u4e0a\u8f6c\u53d1\u7ed9\u4e8b\u52a1\u5c42\u3002\u5728Completer\u7684\u4e8b\u52a1\u5c42\u4e2d\uff0cTLP\u88ab\u7f6e\u4e8e\u4e0e\u5176\u4f18\u5148\u7ea7\u76f8\u5bf9\u5e94\u7684\u865a\u62df\u901a\u9053\u63a5\u6536buffer\u4e2d\uff0c\u7b49\u5f85\u88ab\u5904\u7406\u3002\u7136\u540e\u53ef\u4ee5\u5bf9TLP\u8fdb\u884cECRC\u6821\u9a8c\uff08ECRC\u4e3a\u53ef\u9009\u9879\uff09\uff0c\u82e5\u6821\u9a8c\u65e0\u9519\uff0c\u90a3\u4e48TLP Header\u7684\u5185\u5bb9\uff08\u5730\u5740\u3001Requester ID\u3001MRd\u4e8b\u52a1\u7c7b\u578b\u3001\u8bf7\u6c42\u6570\u636e\u603b\u91cf\u3001\u6d41\u91cf\u7c7b\u578b\u7b49\uff09\u5c06\u88ab\u5411\u4e0a\u8f6c\u53d1\u81f3Completer\u7684\u8f6f\u4ef6\u5c42\u3002</p>"},{"location":"pcie/all/#232-completion-with-datacpld","title":"2.3.2     Completion with Data\uff08CplD\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff09","text":"<p>\u4e0b\u9762\u5f00\u59cb\u4ecb\u7ecd\u6b64\u6b21\u4e3e\u4f8b\u56de\u987ePCIe\u534f\u8bae\u7684\u53e6\u4e00\u534a\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003\u56fe 2\u201133\u3002\u4e3a\u4e86\u670d\u52a1MRd\u8bf7\u6c42\uff0cCompleter\u7684Device Core/\u8f6f\u4ef6\u5c42\u5c06\u4f1a\u5411\u5b83\u7684\u4e8b\u52a1\u5c42\u53d1\u9001\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\uff08Completion with Data\uff0cCplD\uff09\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u5b8c\u6210\u5305\u8bf7\u6c42\u4e2d\u5305\u542b\u4e86\u4e0eMRd\u8bf7\u6c42\u4e2d\u76f8\u540c\u7684Requester ID\u3001Tag\uff0c\u8fd8\u5305\u542b\u4e86\u4e8b\u52a1\u7c7b\u578b\u4ee5\u53ca\u53e6\u5916\u7684\u5b8c\u6210\u5305\u5934\u5185\u5bb9\uff0c\u5e76\u4e14\u5b8c\u6210\u5305\u4e2d\u8fd8\u5305\u542b\u4e86\u88ab\u8bf7\u6c42\u7684\u6570\u636e\u3002</p> <p></p> <p>\u56fe 2\u201133\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\u7684\u5404\u9636\u6bb5</p> <p>\u4e8b\u52a1\u5c42\u4f7f\u7528CplD\u8bf7\u6c42\u4e2d\u7684\u8fd9\u4e9b\u4fe1\u606f\u6765\u6784\u5efa\u4e00\u4e2aCplD TLP\uff0c\u8fd9\u79cdTLP\u7684Header\u56fa\u5b9a\u4e3a3DW\uff08\u8fd9\u662f\u7531\u4e8eCplD TLP\u4f7f\u7528Requester ID\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\uff0c\u56e0\u6b64\u4e0d\u4f1a\u9700\u8981\u7528\u523064bit\u7684\u5730\u5740\uff09\u3002\u4e8b\u52a1\u5c42\u4e5f\u4f1a\u5c06\u81ea\u8eab\u7684Completer ID\u6dfb\u52a0\u5230CplD TLP Header\u4e2d\u3002\u8fd9\u4e2a\u6570\u636e\u5305\u968f\u540e\u88ab\u653e\u7f6e\u5165\u4e00\u4e2a\u5408\u9002\u7684\u865a\u62df\u901a\u9053\u7684\u53d1\u9001Buffer\u4e2d\uff0c\u4e00\u65e6\u8fd9\u4e2a\u865a\u62df\u901a\u9053\u88ab\u4ef2\u88c1\u9009\u4e2d\u5e76\u8981\u53d1\u9001\u8fd9\u4e2aCplD TLP\uff0c\u6d41\u91cf\u63a7\u5236\u903b\u8f91\u5c06\u4f1a\u786e\u8ba4\u5bf9\u7aef\u8bbe\u5907\u6709\u8db3\u591f\u7684\u53ef\u7528\u7f13\u51b2\u533a\u7a7a\u95f4\u6765\u63a5\u6536\u5b83\uff0c\u5f53\u786e\u8ba4\u8db3\u591f\u540e\u5219\u5c06\u8fd9\u4e2aCplD TLP\u5411\u4e0b\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u5982\u524d\u6587\u6240\u8ff0\u90a3\u6837\uff0c\u6570\u636e\u94fe\u8def\u5c42\u7ed9\u6570\u636e\u5305\u52a0\u4e0a12bit\u7684\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u548c32bit\u7684LCRC\u3002\u7136\u540e\u5c06\u6dfb\u52a0\u5b8c\u8fd9\u4e9b\u4fe1\u606f\u7684TLP\u4fdd\u5b58\u4e00\u4efd\u526f\u672c\u5728\u91cd\u4f20Buffer\uff08Replay Buffer\uff09\u4e2d\uff0c\u4e4b\u540e\u53d8\u5c06\u6570\u636e\u5305\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\u3002</p> <p>\u4f9d\u7136\u5982\u524d\u6587\u6240\u8ff0\u90a3\u6837\uff0c\u7269\u7406\u5c42\u7ed9\u6570\u636e\u5305\u52a0\u4e0a\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u5e76\u5c06\u5176\u5728\u6240\u6709\u53ef\u7528\u901a\u9053\u4e0a\u8fdb\u884c\u5b57\u8282\u6761\u5e26\u5316\uff0c\u518d\u8fdb\u884c\u6270\u7801\u30018b/10b\u7f16\u7801\u3002\u6700\u7ec8\uff0c\u8fd9\u4e2aCplD TLP\u6570\u636e\u5305\u5728\u94fe\u8def\u7684\u6240\u6709\u901a\u9053\u4e0a\u4ee5\u4e32\u884c\u5dee\u5206\u7684\u5f62\u5f0f\u88ab\u4f20\u8f93\u81f3\u5bf9\u7aef\u3002</p> <p>\u5f53Requester\u63a5\u6536\u5230\u8fd9\u4e2aCplD TLP\u7684\u8f93\u5165\u6bd4\u7279\u6d41\u65f6\uff0c\u5b83\u5c06\u6bd4\u7279\u6d41\u8f6c\u6362\u6062\u590d\u621010bit\u7b26\u53f7\uff0810bit symbol\uff09\uff0c\u5e76\u8ba910bit symbol\u6d41\u901a\u8fc7\u4e00\u4e2a\u5f39\u6027\u7f13\u5b58\u3002\u968f\u540e10bit\u7b26\u53f7\u88ab\u89e3\u7801\u6062\u590d\u4e3a\u5b57\u8282\uff0c\u5e76\u8fdb\u884c\u89e3\u6270\u548c\u5b57\u8282\u53cd\u6761\u5e26\u5316\uff08un-striped\uff09\u3002\u7136\u540e\u7269\u7406\u5c42\u5c31\u80fd\u68c0\u6d4b\u5230\u8fd9\u4e2aCplD TLP\u7684\u5305\u8d77\u59cb\u5b57\u7b26\u548c\u5305\u7ed3\u675f\u5b57\u7b26\uff0c\u5e76\u5c06\u8fd9\u4e24\u4e2a\u5b57\u7b26\u5265\u53bb\u3002\u4e4b\u540e\u4fbf\u5c06\u5269\u4f59\u7684CplD TLP\u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\u548c\u4e4b\u524d\u4e00\u6837\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5bf9CplD TLP\u8fdb\u884cLCRC\u6821\u9a8c\uff0c\u5e76\u68c0\u67e5\u5e8f\u5217\u53f7\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728TLP\u4e22\u5931\u6216\u51fa\u73b0TLP\u5931\u5e8f\u3002\u5982\u679c\u5e76\u672a\u51fa\u73b0\u9519\u8bef\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c06\u4ea7\u751f\u4e00\u4e2aAck DLLP\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e0eCplD TLP\u4e2d\u76f8\u540c\u7684\u5e8f\u5217\u53f7\uff0c\u5e76\u7ed9\u8fd9\u4e2aAck DLLP\u52a0\u4e0a16bit CRC\uff0c\u7136\u540e\u5c06\u5176\u9001\u56de\u7ed9\u7269\u7406\u5c42\u52a0\u4e0a\u76f8\u5e94\u7684\u7ec4\u5e27\u5b57\u7b26\uff08framing symbol\uff09\u5e76\u5c06\u8fd9\u4e2aAck DLLP\u4f20\u8f93\u7ed9Completer\u3002</p> <p>Completer\u7684\u7269\u7406\u5c42\u5c06\u4f1a\u68c0\u6d4b\u5e76\u5265\u9664Ack DLLP\u7684\u7ec4\u5e27\u5b57\u7b26\uff0c\u5e76\u5c06\u5269\u4f59\u7684\u90e8\u5206\u5411\u4e0a\u8f6c\u53d1\u7ed9\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5728\u8fd9\u91cc\u5bf9Ack DLLP\u7684CRC\u8fdb\u884c\u6821\u9a8c\u3002\u82e5\u6821\u9a8c\u65e0\u9519\uff0cCompleter\u7684\u6570\u636e\u94fe\u8def\u5c42\u5c06Ack DLLP\u4e2d\u7684\u5e8f\u5217\u53f7\u4e0e\u91cd\u4f20Buffer\u4e2d\u7684TLP\u7684\u5e8f\u5217\u53f7\u8fdb\u884c\u5bf9\u6bd4\u3002\u4e0eAck DLLP\u5e8f\u5217\u53f7\u76f8\u5339\u914d\u7684TLP\u5c06\u88ab\u4ece\u91cd\u4f20Buffer\u4e2d\u6e05\u9664\u3002\u53cd\u4e4b\uff0c\u82e5Completer\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2aNak DLLP\uff0c\u90a3\u4e48\u5b83\u5c06\u4f7f\u7528\u91cd\u4f20Buffer\u4e2d\u5b58\u50a8\u7684CplD TLP\u526f\u672c\u6765\u8fdb\u884c\u91cd\u4f20\u3002</p> <p>\u4e0e\u6b64\u540c\u65f6\uff0cRequester\u7684\u4e8b\u52a1\u5c42\u5728\u67d0\u4e2a\u865a\u62df\u901a\u9053\u7684\u7f13\u5b58\u4e2d\u63a5\u6536\u5230\u4e86\u8fd9\u4e2aCplD TLP\u3002\u4f5c\u4e3a\u4e00\u4e2a\u53ef\u9009\u64cd\u4f5c\uff0c\u4e8b\u52a1\u5c42\u53ef\u4ee5\u6821\u9a8c\u8fd9\u4e2aTLP\u7684ECRC\u3002\u82e5\u6821\u9a8c\u65e0\u9519\uff0c\u4e8b\u52a1\u5c42\u5c06\u8fd9\u4e2aCplD TLP\u7684Header\u5185\u5bb9\u3001\u6570\u636e\u8377\u8f7d\u4ee5\u53ca\u8bf7\u6c42\u5b8c\u6210\u72b6\u6001\u4fe1\u606f\u5411\u4e0a\u5448\u4ea4\u7ed9Requester\u7684\u8f6f\u4ef6\u5c42\u3002\u81f3\u6b64\uff0c\u5927\u529f\u544a\u6210\u3002</p>"},{"location":"pcie/all/#chapter-3-configuration-overview-pcie","title":"Chapter 3      Configuration Overview //PCIe\u914d\u7f6e\u6982\u8ff0","text":""},{"location":"pcie/all/#_6","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u524d\u4e00\u7ae0\u8282\u5bf9PCIe\u4f53\u7cfb\u7ed3\u6784\u8fdb\u884c\u4e86\u5168\u9762\u4ecb\u7ecd\uff0c\u6211\u4eec\u5c06\u5176\u770b\u4f5c\u662f\u4e00\u79cd\u201c\u6267\u884c\u5c42\uff08executive level\uff09\u201d\u6982\u8ff0\u3002\u5b83\u5bf9\u534f\u8bae\u4e2d\u63cf\u8ff0PCIe\u7aef\u53e3\u5206\u5c42\u8bbe\u8ba1\u65b9\u6cd5\u8fdb\u884c\u4e86\u4ecb\u7ecd\u3002\u5728\u4ecb\u7ecd\u4e8b\u52a1\u534f\u8bae\u65f6\u4e5f\u4e00\u5e76\u4ecb\u7ecd\u4e86\u5404\u79cd\u6570\u636e\u5305\u7684\u79cd\u7c7b\u3002</p>"},{"location":"pcie/all/#_7","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u5bf9\u5982\u4f55\u5bf9PCIe\u73af\u5883\u8fdb\u884c\u914d\u7f6e\u6765\u5c55\u5f00\u4ecb\u7ecd\u3002\u5185\u5bb9\u5305\u62ec\u4e86\u5b9e\u73b0Function\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u7a7a\u95f4\u3001\u5982\u4f55\u53d1\u73b0\u4e00\u4e2aFunction\u3001\u5982\u4f55\u4ea7\u751f\u5e76\u8def\u7531\u8f6c\u53d1\u914d\u7f6e\u4e8b\u52a1\u3001 PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\uff08PCI-compatible configuration space\uff09\u4e0ePCIe\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u7684\u4e0d\u540c\u70b9\uff08PCIe extended configuration space\uff09\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u662f\u5982\u4f55\u533a\u5206\u5f00EP\u548cBridge\u7684\u3002</p>"},{"location":"pcie/all/#_8","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u7684\u5185\u5bb9\u5c06\u63cf\u8ff0Function\u5982\u4f55\u901a\u8fc7\u57fa\u5740\u5bc4\u5b58\u5668\uff08Base Address Register\uff0cBARs\uff09\u6765\u8bf7\u6c42memory\u6216\u8005IO\u5730\u5740\u7a7a\u95f4\uff0c\u4ee5\u53ca\u8fd9\u79cd\u8bf7\u6c42\u7684\u76ee\u7684\u4e0e\u4f5c\u7528\uff0c\u5e76\u4e14\u5c06\u4ecb\u7ecd\u8f6f\u4ef6\u662f\u5982\u4f55\u521d\u59cb\u5316\u8fd9\u4e24\u79cd\u5730\u5740\u7a7a\u95f4\u7684\u3002\u53e6\u5916\u5728\u4e0b\u4e00\u7ae0\u8fd8\u4f1a\u63cf\u8ff0Bridge\u7684Base/Limit\u5bc4\u5b58\u5668\uff08\u57fa/\u8fb9\u754c\u5bc4\u5b58\u5668\uff09\u662f\u5982\u4f55\u88ab\u521d\u59cb\u5316\u7684\uff0c\u56e0\u4e3a\u53ea\u6709\u5f53Base/Limit\u5bc4\u5b58\u5668\u521d\u59cb\u5316\u540eSwitch\u624d\u80fd\u5728PCIe\u7f51\u7edc\u4e2d\u8def\u7531\u8f6c\u53d1TLP\u3002</p>"},{"location":"pcie/all/#31-definition-of-busdevice-and-function","title":"3.1 \u603b\u7ebf/\u8bbe\u5907/\u529f\u80fd/\u7684\u5b9a\u4e49\uff08Definition of Bus,Device and Function\uff09","text":"<p>\u6b63\u5982PCI\u4e00\u6837\uff0c\u6bcf\u4e2aPCIe\u529f\u80fd\uff08Function\uff09\u5728\u5176\u6240\u5728\u7684\u8bbe\u5907\u5185\uff0c\u4ee5\u53ca\u8fd9\u4e2a\u8bbe\u5907\u6240\u8fde\u63a5\u7684\u603b\u7ebf\u5185\uff0c\u90fd\u662f\u88ab\u552f\u4e00\u6807\u8bc6\u7684\u3002\u8fd9\u4e2a\u552f\u4e00\u7684\u6807\u8bc6\u7b26\u4e00\u822c\u88ab\u79f0\u4e3a\u201cBDF\u201d\u3002\u914d\u7f6e\u8f6f\u4ef6\u8d1f\u8d23\u5728\u4e00\u4e2a\u7ed9\u51fa\u7684PCIe\u62d3\u6251\u4e2d\u68c0\u6d4b\u51fa\u6bcf\u4e2aBus\u3001Device\u548cFunction\uff0c\u8fd9\u5c31\u662fBDF\u3002\u63a5\u4e0b\u6765\u7684\u51e0\u8282\u5c06\u4f1a\u7ed3\u5408\u4e00\u4e2aPCIe\u62d3\u6251\u793a\u4f8b\u7684\u4e0a\u4e0b\u6587\uff0c\u6765\u8ba8\u8bbaBDF\u7684\u4e3b\u8981\u7279\u5f81\u3002\u56fe 3\u20111\u5c55\u793a\u4e86\u4e00\u4e2aPCIe\u62d3\u6251\u7ed3\u6784\uff0c\u56fe\u4e2d\u7740\u91cd\u6807\u8bc6\u4e86\u793a\u4f8b\u7cfb\u7edf\u4e2d\u7684Buses\u3001Devices\u548cFunctions\u3002\u5728\u672c\u7ae0\u7684\u540e\u9762\uff0c\u5c06\u89e3\u91ca\u5982\u4f55\u5206\u914d\u603b\u7ebf\u53f7\u548c\u8bbe\u5907\u53f7\u3002</p> <p></p> <p>\u56fe 3\u20111\u793a\u4f8b\u7cfb\u7edf</p>"},{"location":"pcie/all/#32-pciepcie-buses","title":"3.2 PCIe\u603b\u7ebf\uff08PCIe Buses\uff09","text":"<p>\u8f6f\u4ef6\u603b\u8235\u53ef\u4ee5\u5206\u914d256\u4e2a\u603b\u7ebf\u53f7\u3002\u6700\u521d\u7684\u603b\u7ebf\u53f7\uff0cBus 0\uff0c\u901a\u5e38\u7531\u786c\u4ef6\u5206\u914d\u7ed9RC\uff08Root Complex\uff09\u3002Bus 0\u7531\u4e00\u4e2a\u5e26\u6709\u5185\u90e8\u96c6\u6210EP\u7684\u865a\u62dfPCI\u603b\u7ebf\uff0c\u4e00\u4e9b\u865a\u62dfPCI-to-PCI Bridges\uff08P2P\uff09\u7ec4\u6210\uff0c\u8fd9\u5176\u4e2d\u7684P2P Bridges\u62e5\u6709\u786e\u5b9a\u5199\u6b7b\uff08hard-coded\uff09\u7684\u8bbe\u5907\u53f7\u548c\u529f\u80fd\u53f7\u3002\u6bcf\u4e2aP2P Bridge\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u603b\u7ebf\uff0c\u989d\u5916\u7684PCIe\u8bbe\u5907\u53ef\u4ee5\u8fde\u63a5\u5728\u8fd9\u4e9b\u603b\u7ebf\u4e0a\u9762\u3002\u6bcf\u4e2a\u603b\u7ebf\u90fd\u5fc5\u987b\u88ab\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684\u603b\u7ebf\u53f7\u3002\u914d\u7f6e\u8f6f\u4ef6\u5206\u914d\u603b\u7ebf\u53f7\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7b2c\u4e00\u4ef6\u4e8b\u60c5\u5c31\u662f\u4eceBus 0/Device 0/Function 0\u5f00\u59cb\u641c\u7d22\u5176\u4ed6\u7684Bridges\u3002\u5f53\u627e\u5230\u4e00\u4e2aBridge\u4e4b\u540e\uff0c\u8f6f\u4ef6\u5c31\u7ed9\u8fd9\u4e2aBridge\u4ea7\u751f\u7684\u65b0\u603b\u7ebf\u5206\u914d\u4e00\u4e2a\u603b\u7ebf\u53f7\uff0c\u65b0\u603b\u7ebf\u7684\u603b\u7ebf\u53f7\u4f1a\u6bd4Bridge\u6240\u5c5e\u7684\u4e0a\u4e00\u7ea7\u603b\u7ebf\u7684\u603b\u7ebf\u53f7\u8981\u5927\u3002\u4e00\u65e6\u65b0\u603b\u7ebf\u88ab\u5206\u914d\u4e86\u4e00\u4e2a\u603b\u7ebf\u53f7\u4e4b\u540e\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u5728\u8fd9\u4e2a\u65b0\u603b\u7ebf\u4e0a\u5f00\u59cb\u641c\u7d22Bridges\uff0c\u800c\u4e0d\u662f\u5728\u4e0a\u4e00\u7ea7\u603b\u7ebf\u4e0a\u7ee7\u7eed\u641c\u7d22\u3002\u8fd9\u88ab\u79f0\u4e3a\u201c\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\uff08depth first search\uff09\u201d\uff0c\u5173\u4e8e\u8fd9\u79cd\u641c\u7d22\u7684\u7ec6\u8282\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cEnumeration \u2013 Discovering the Topology\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/all/#33-pciepcie-devices","title":"3.3 PCIe\u8bbe\u5907\uff08PCIe Devices\uff09","text":"<p>PCIe\u5141\u8bb8\u5728\u5355\u4e2aPCI\u603b\u7ebf\u4e0a\u6700\u591a\u6302\u8f7d32\u4e2a\u8bbe\u5907\uff0c\u7136\u800cPCIe\u70b9\u5bf9\u70b9\uff08point-to-point\uff09\u7684\u6027\u8d28\u610f\u5473\u7740\u53ea\u6709\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u76f4\u63a5\u8fde\u63a5\u5728PCIe\u94fe\u8def\u4e0a\uff0c\u8be5\u8bbe\u5907\u53ea\u80fd\u662fDevice 0\u3002RC\u548cSwitches\u90fd\u542b\u6709\u865a\u62dfPCI\u603b\u7ebf\uff0c\u8fd9\u4e9b\u865a\u62df\u603b\u7ebf\u4f7f\u5f97\u53ef\u4ee5\u8ba9\u66f4\u591a\u7684\u8bbe\u5907\u201c\u8fde\u63a5\u201d\u5728\u603b\u7ebf\u4e0a\u3002\u6bcf\u4e2a\u8bbe\u5907\u90fd\u5fc5\u987b\u5b9e\u73b0Function 0\uff0c\u5176\u6700\u591a\u53ef\u4ee5\u67098\u4e2a\u529f\u80fd\uff08Function\uff09\u3002\u5f53\u4e00\u4e2a\u8bbe\u5907\u62e5\u67092\u4e2a\u6216\u4ee5\u4e0a\u7684Function\u65f6\uff0c\u4fbf\u628a\u8fd9\u4e2a\u8bbe\u5907\u6210\u4e3a\u591a\u529f\u80fd\u8bbe\u5907\uff08Multi-Function Device\uff09\u3002</p>"},{"location":"pcie/all/#34-pciepcie-functions","title":"3.4 PCIe\u529f\u80fd\uff08PCIe Functions\uff09","text":"<p>\u6b63\u5982\u6b64\u524d\u6240\u8ba8\u8bba\u7684\u4e00\u6837\uff0cFunction\u662f\u88ab\u8bbe\u8ba1\u5728\u6bcf\u4e2a\u8bbe\u5907\u4e2d\u7684\u3002\u8fd9\u4e9bFunction\u53ef\u80fd\u5305\u542b\u786c\u76d8\u9a71\u52a8\u63a5\u53e3\u3001\u663e\u793a\u63a7\u5236\u5668\u3001\u4ee5\u592a\u7f51\u63a7\u5236\u5668\u3001USB\u63a7\u5236\u5668\u7b49\u7b49\u3002\u5177\u6709\u591aFunction\u7684\u8bbe\u5907\u4e0d\u9700\u8981\u4f9d\u6b21\u6765\u9010\u4e2a\u5b9e\u73b0\u5b83\u4eec\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u5b9e\u73b0Function 0\u30012\u30017\u3002\u56e0\u6b64\uff0c\u5f53\u914d\u7f6e\u8f6f\u4ef6\u68c0\u6d4b\u5230\u4e86\u4e00\u4e2a\u591aFunction\u8bbe\u5907\u65f6\uff0c\u5fc5\u987b\u68c0\u67e5\u6240\u6709\u53ef\u80fd\u7684Function\uff0c\u4ee5\u4e86\u89e3\u5f53\u524dDevice\u5b58\u5728\u54ea\u4e9bFunction\u3002\u6bcf\u4e2aFunction\u90fd\u6709\u5b83\u4eec\u81ea\u5df1\u7684\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u7528\u4e8e\u8bbe\u7f6e\u4e0eFunction\u76f8\u5173\u7684\u8d44\u6e90\u3002</p>"},{"location":"pcie/all/#35-configuration-address-space","title":"3.5 \u914d\u7f6e\u5730\u5740\u7a7a\u95f4\uff08Configuration Address Space\uff09","text":"<p>\u521d\u671f\u7684PC\u9700\u8981\u7528\u6237\u8bbe\u7f6e\u5f00\u5173\u548c\u8df3\u7ebf\u6765\u7ed9\u6bcf\u4e2a\u5b89\u88c5\u4e0a\u53bb\u7684\u677f\u5361\u5206\u914d\u8d44\u6e90\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u7ecf\u5e38\u4f1a\u5bfc\u81f4memory\u3001IO\u548c\u4e2d\u65ad\u7684\u8bbe\u7f6e\u51fa\u73b0\u51b2\u7a81\u3002\u8fd9\u4e4b\u540e\u51fa\u73b0\u7684\u4e24\u79cdIO\u67b6\u6784\u2014\u2014\u6269\u5c55ISA\uff08EISA\uff0cExtended ISA\uff09\u548cIBM PS2\u7cfb\u7edf\uff0c\u8fd9\u4e8c\u8005\u662f\u521d\u6b21\u5b9e\u73b0\u4e86\u5373\u63d2\u5373\u7528\uff08plug and play\uff09\u7684\u67b6\u6784\u3002\u5728\u8fd9\u4e9b\u67b6\u6784\u4e2d\uff0c\u914d\u7f6e\u6587\u4ef6\u968f\u6bcf\u4e2a\u63d2\u4ef6\u5361\u4e00\u8d77\u88ab\u63d0\u4f9b\uff0c\u5141\u8bb8\u7cfb\u7edf\u8f6f\u4ef6\u5206\u914d\u57fa\u672c\u8d44\u6e90\u3002PCI\u6269\u5c55\u4e86\u8fd9\u79cd\u80fd\u529b\uff0c\u5b83\u901a\u8fc7\u5b9e\u73b0\u6807\u51c6\u5316\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\uff0c\u5141\u8bb8\u901a\u7528\u7684Shrink-Wrapped\uff08\u538b\u7f29\u5305\u88c5\uff09\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u51e0\u4e4e\u6240\u6709\u7684\u7cfb\u7edf\u8d44\u6e90\u3002\u5f53\u62e5\u6709\u4e86\u4e00\u4e2a\u6807\u51c6\u5316\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u9519\u8bef\u62a5\u544a\u7684\u5f00\u542f\u4e0e\u5173\u95ed\u3001\u4f20\u9001\u4e2d\u65ad\u3001\u8fdb\u884c\u5730\u5740\u6620\u5c04\u4ee5\u53ca\u66f4\u591a\u5176\u4ed6\u7684\u64cd\u4f5c\u4e4b\u540e\uff0c\u5c31\u4f7f\u5f97\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u5b9e\u4f53\u2014\u2014\u914d\u7f6e\u8f6f\u4ef6\uff0c\u6765\u8fdb\u884c\u7cfb\u7edf\u8d44\u6e90\u7684\u5206\u914d\u548c\u914d\u7f6e\uff0c\u8fd9\u6837\u505a\u5c31\u53ef\u4ee5\u6d88\u9664\u51e0\u4e4e\u6240\u6709\u7684\u8d44\u6e90\u51b2\u7a81\u3002</p> <p>PCI\u4e3a\u6bcf\u4e2aFunction\u90fd\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4e13\u7528\u7684\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u5757\u3002\u6620\u5c04\u5165\u8fd9\u4e2a\u914d\u7f6e\u7a7a\u95f4\u7684\u5bc4\u5b58\u5668\u4eec\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2aFunction\u7684\u5b58\u5728\uff0c\u5e76\u5bf9\u8fd9\u4e2aFunction\u8fdb\u884c\u4e00\u822c\u7684\u64cd\u4f5c\u548c\u68c0\u67e5\u72b6\u6001\u3002\u5927\u591a\u6570\u9700\u8981\u6807\u51c6\u5316\u7684\u57fa\u672c\u529f\u80fd\u90fd\u5b58\u5728\u4e8e\u914d\u7f6e\u5bc4\u5b58\u5668\u5757\u7684Header\u4e2d\uff0c\u4f46\u662fPCI\u67b6\u6784\u5e08\u610f\u8bc6\u5230\u82e5\u5c06\u53ef\u9009\u529f\u80fd\uff08option feature\uff0c\u533a\u522b\u4e8e\u524d\u9762\u7684\u57fa\u672c\u529f\u80fd\uff09\u4e5f\u6807\u51c6\u5316\u53ef\u4ee5\u5e26\u6765\u5f88\u591a\u597d\u5904\uff0c\u79f0\u8fd9\u4e9b\u53ef\u9009\u529f\u80fd\u6807\u51c6\u5316\u540e\u7684\u7ed3\u6784\u4e3a\u201c\u80fd\u529b\u7ed3\u6784capability structures\u201d\uff0c\uff08\u4f8b\u5982\u7535\u6e90\u7ba1\u7406\u3001\u70ed\u63d2\u62d4\u7b49\u7b49\uff09\u3002\u5bf9\u4e8e\u6bcf\u4e2aFunction\uff0c\u90fd\u542b\u6709256byte\u7684PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\uff08PCI-Compatible configuration space\uff09\u3002</p>"},{"location":"pcie/all/#351-pcipci-compatible-space","title":"3.5.1     PCI\u517c\u5bb9\u7a7a\u95f4\uff08PCI-Compatible Space\uff09","text":"<p>\u5728\u9605\u8bfb\u4e0b\u9762\u7684\u8ba8\u8bba\u5185\u5bb9\u65f6\uff0c\u8bf7\u540c\u65f6\u53c2\u9605\u56fe 3\u20112\u3002\u4e4b\u6240\u4ee5\u5c06\u8fd9256Byte\u547d\u540d\u4e3aPCI-compatible configuration space\uff08PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\uff09\uff0c\u662f\u56e0\u4e3a\u8fd9\u4e9b\u914d\u7f6e\u7a7a\u95f4\u539f\u672c\u5c31\u662f\u4e3aPCI\u6240\u8bbe\u8ba1\u7684\u3002\u8fd9\u4e2a\u914d\u7f6e\u7a7a\u95f4\u7684\u524d16DW\uff0864bytes\uff09\u5c31\u662f\u914d\u7f6e\u5934\u90e8\uff08header\uff09\uff0c\u6709\u4e24\u79cd\u7c7b\u578b\u7684Header\uff0c\u5206\u522b\u4e3aType 0\u548cType 1\u3002Type 0 Header\u5bf9\u4e8e\u6bcf\u4e2aFunction\u90fd\u662f\u5fc5\u987b\u542b\u6709\u7684\uff0c\u9664\u4e86Bridge\uff0c\u5bf9\u4e8eBridge Function\u6765\u8bf4\u5b83\u4f7f\u7528\u7684\u662fType 1 Header\u3002\u5269\u4f59\u768448DW\u662f\u4e00\u4e9b\u53ef\u9009\u5bc4\u5b58\u5668\uff0c\u5305\u62ecPCI\u80fd\u529b\u7ed3\u6784\uff08capability structure\uff09\u3002\u5bf9\u4e8ePCIe Functions\uff0c\u4e5f\u9700\u8981capability structure\u4e2d\u7684\u4e00\u90e8\u5206\u3002\u4f8b\u5982PCIe Function\u5c31\u5fc5\u987b\u5b9e\u73b0\u5982\u4e0b\u7684\u80fd\u529b\u7ed3\u6784\uff1a</p> <p>u PCI Express\u80fd\u529b\uff08PCI Express Capability\uff09</p> <p>u \u7535\u6e90\u7ba1\u7406</p> <p>u MSI\u3001MSI-X</p> <p></p> <p>\u56fe 3\u20112 PCI\u517c\u5bb9\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4</p>"},{"location":"pcie/all/#352-extended-configuration-space","title":"3.5.2     \u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\uff08Extended Configuration Space\uff09","text":"<p>\u5728\u9605\u8bfb\u4e0b\u9762\u7684\u8ba8\u8bba\u5185\u5bb9\u65f6\uff0c\u8bf7\u540c\u65f6\u53c2\u9605\u56fe 3\u20113\u3002\u5f53\u5f15\u5165PCIe\u4e4b\u540e\uff0c\u6700\u521d\u59cb\u7684256byte\u914d\u7f6e\u7a7a\u95f4\u5df2\u7ecf\u4e0d\u8db3\u4ee5\u653e\u4e0b\u6240\u6709\u7684\u65b0\u7684\u9700\u8981\u7684Capability Structure\u4e86\u3002\u56e0\u6b64\u914d\u7f6e\u7a7a\u95f4\u7684\u5927\u5c0f\u4ece\u539f\u5148\u7684\u6bcf\u4e2aFunction 256Byte\u6269\u5c55\u81f3\u4e86\u6bcf\u4e2aFunction 4KByte\u3002\u65b0\u589e\u52a0\u51fa\u6765\u7684960DW\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u53ea\u80fd\u901a\u8fc7\u589e\u5f3a\u914d\u7f6e\u673a\u5236\uff08Enhanced configuration mechanism\uff09\u6765\u8fdb\u884c\u8bbf\u95ee\uff0c\u56e0\u6b64\u8fd9\u90e8\u5206\u533a\u57df\u5bf9\u4e8e\u4f20\u7edf\u7684PCI\u8f6f\u4ef6\u662f\u4e0d\u53ef\u89c1\u7684\uff0c\u56e0\u4e3a\u5b83\u65e0\u6cd5\u53d1\u73b0\u8fd9\u4e2a\u533a\u57df\u5e76\u8fdb\u884c\u8bbf\u95ee\u3002\u5728\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u5185\u5305\u542b\u4e86\u65b0\u589e\u52a0\u7684PCIe\u53ef\u9009\u6269\u5c55\u80fd\u529b\u5bc4\u5b58\u5668\uff08Extended Capability register\uff09\uff0c\u901a\u8fc7\u56fe 3\u20113\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e9b\u88ab\u7f57\u5217\u51fa\u6765\u7684\u6269\u5c55\u80fd\u529b\u5bc4\u5b58\u5668\uff08\u5217\u51fa\u6765\u7684\u5e76\u975e\u5168\u90e8\uff09\u3002</p> <p></p> <p>\u56fe 3\u20113\u6bcf\u4e2aPCIe Function\u6240\u62e5\u6709\u76844KB\u914d\u7f6e\u7a7a\u95f4</p>"},{"location":"pcie/all/#36-host-to-pci-bridge","title":"3.6 Host-to-PCI Bridge\u914d\u7f6e\u5bc4\u5b58\u5668","text":""},{"location":"pcie/all/#361-general","title":"3.6.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5bf9Host-to-Bridge\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u8bbf\u95ee\u4e0d\u5fc5\u4f7f\u7528\u524d\u9762\u7684\u7ae0\u8282\u6240\u63d0\u5230\u7684\u914d\u7f6e\u673a\u5236\uff0c\u5b83\u901a\u5e38\u4f5c\u4e3a\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\u5728\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u4e2d\u88ab\u5b9e\u73b0\uff0c\u8fd9\u662f\u5e73\u53f0\u56fa\u4ef6\u672c\u8eab\u5c31\u77e5\u9053\u7684\u3002\u7136\u800c\uff0c\u5b83\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u683c\u5f0f\u6392\u5e03\u548c\u7528\u6cd5\u90fd\u5fc5\u987b\u9075\u4ecePCI 2.3\u534f\u8bae\u89c4\u8303\u4e2d\u6240\u5b9a\u4e49\u7684Type 0\u6a21\u677f\u3002</p>"},{"location":"pcie/all/#362-rconly-the-root-sends-configuration-request","title":"3.6.2     \u53ea\u6709RC\u53d1\u9001\u914d\u7f6e\u8bf7\u6c42\uff08Only the Root Sends Configuration Request\uff09","text":"<p>\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u58f0\u660e\u4e86\uff0c\u53ea\u6709RC\u53ef\u4ee5\u53d1\u8d77\u914d\u7f6e\u8bf7\u6c42\u3002RC\u4f5c\u4e3a\u4e86\u7cfb\u7edf\u5904\u7406\u5668\u7684\u8054\u7edc\u5458\uff0c\u5c06\u8bf7\u6c42\u5305\u4f20\u5165\u7f51\u7edc\u4e2d\u5e76\u6536\u56de\u5b8c\u6210\u5305\u3002\u4e4b\u6240\u4ee5\u4ec5\u9650\u4e8e\u5904\u7406\u5668\u901a\u8fc7RC\u53d1\u8d77\u914d\u7f6e\u4e8b\u52a1\uff0c\u662f\u56e0\u4e3a\u8981\u662f\u5176\u4ed6\u8bbe\u5907\u4e5f\u6709\u8fd9\u79cd\u80fd\u529b\uff0c\u90a3\u4e48\u8fd9\u4e9b\u8bbe\u5907\u53ef\u80fd\u4f1a\u6539\u53d8\u914d\u7f6e\u5185\u5bb9\uff0c\u8fd9\u6837\u5c31\u4f1a\u5e26\u6765\u6df7\u4e71\u3002</p> <p>\u7531\u4e8e\u53ea\u6709RC\u80fd\u53d1\u8d77\u8fd9\u4e9b\u914d\u7f6e\u8bf7\u6c42\uff0c\u6240\u4ee5\u8fd9\u4e9b\u914d\u7f6e\u8bf7\u6c42\u53ea\u80fd\u5728\u62d3\u6251\u4e2d\u5411\u4e0b\u8f6c\u53d1\uff0c\u4e5f\u5c31\u662f\u5b83\u4eec\u65e0\u6cd5\u4ece\u62d3\u6251\u4f4e\u5c42\u88ab\u5411\u4e0a\u8f6c\u53d1\u56de\u5230RC\uff0c\u8fd9\u5c31\u610f\u5473\u7740Peer-to-Peer\u7684\u914d\u7f6e\u8bf7\u6c42\u662f\u88ab\u7981\u6b62\u7684\u3002\u8bf7\u6c42\u5305\u4f7f\u7528\u76ee\u7684\u8bbe\u5907ID\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u8fdb\u884c\u8def\u7531\u8f6c\u53d1\uff0c\u8fd9\u4e2a\u76ee\u7684\u8bbe\u5907ID\u5c31\u662f\u5b83\u7684BDF\uff08\u62d3\u6251\u4e2d\u7684Bus\u7f16\u53f7\uff0cBus\u4e0a\u7684Device\u7f16\u53f7\uff0cDevice\u4e2d\u7684Function\u7f16\u53f7\uff09\u3002</p>"},{"location":"pcie/all/#37-generating-configuration-transactions","title":"3.7 \u751f\u6210\u914d\u7f6e\u4e8b\u52a1\uff08Generating Configuration Transactions\uff09","text":"<p>\u5904\u7406\u5668\u4e00\u822c\u65e0\u6cd5\u76f4\u63a5\u5b8c\u6210\u8bfb\u8bf7\u6c42\u548c\u5199\u8bf7\u6c42\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53ea\u80fd\u4ea7\u751fmemory\u8bf7\u6c42\u548cIO\u8bf7\u6c42\u3002\u8fd9\u610f\u5473\u7740RC\u9700\u8981\u5c06\u67d0\u4e9b\u8bbf\u95ee\u8f6c\u6362\u6210\u914d\u7f6e\u8bf7\u6c42\uff0c\u8fd9\u6837\u624d\u80fd\u652f\u6301\u8fdb\u884c\u914d\u7f6e\u7684\u64cd\u4f5c\u8fc7\u7a0b\u3002\u914d\u7f6e\u7a7a\u95f4\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u673a\u5236\u8fdb\u884c\u8bbf\u95ee\uff1a</p> <p>u \u4f20\u7edf\u7684PCI\u914d\u7f6e\u673a\u5236\uff0c\u4f7f\u7528IO\u95f4\u63a5\u8bbf\u95ee\uff08IO-indirect access\uff09</p> <p>u \u589e\u5f3a\u578b\u914d\u7f6e\u673a\u5236\uff0c\u4f7f\u7528\u5185\u5b58\u6620\u5c04\u8bbf\u95ee\uff08memory-mapped access\uff09</p>"},{"location":"pcie/all/#371-pcilegacy-pci-mechanism","title":"3.7.1     \u4f20\u7edfPCI\u673a\u5236\uff08Legacy PCI Mechanism\uff09","text":"<p>\u5728PCI\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u4e86IO-indirect\u65b9\u6cd5\uff0c\u7528\u6765\u6307\u793a\u7cfb\u7edf\uff08RC\u6216\u5176\u7b49\u6548\u7cfb\u7edf\uff09\u8fdb\u884cPCI\u914d\u7f6e\u8bbf\u95ee\u3002\u5728\u5f53\u65f6\u7684\u5386\u53f2\u80cc\u666f\u4e0b\uff0c\u5360\u4e3b\u5bfc\u5730\u4f4d\u7684PC\u5904\u7406\u5668\uff08Intel x86\uff09\u88ab\u8bbe\u8ba1\u4e3a\u4ec5\u5bfb\u574064KB\u7684IO\u5730\u5740\u7a7a\u95f4\u3002\u5f53PCI\u88ab\u5b9a\u4e49\u51fa\u6765\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6709\u9650\u7684IO\u7a7a\u95f4\u5df2\u7ecf\u53d8\u5f97\u975e\u5e38\u6df7\u4e71\uff0c\u53ea\u6709\u51e0\u4e2a\u5730\u5740\u8303\u56f4\u4ecd\u7136\u53ef\u7528\uff1a0800h-08FFh\uff0c\u548c0C00h-0CFFh\u3002\u56e0\u6b64\uff0c\u5c06\u6240\u6709\u53ef\u80fd\u7684Function\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u90fd\u6620\u5c04\u5230IO\u7a7a\u95f4\u662f\u4e0d\u53ef\u884c\u7684\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u4e5f\u5341\u5206\u6709\u9650\uff0c\u5c06\u8fd9\u4e9b\u914d\u7f6e\u7a7a\u95f4\u90fd\u6620\u5c04\u8fdb\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u4e5f\u5e76\u4e0d\u662f\u4e00\u4e2a\u597d\u65b9\u6cd5\u3002\u4e8e\u662f\uff0c\u534f\u8bae\u89c4\u8303\u7684\u4f5c\u8005\u4f7f\u7528\u4e86\u4e00\u79cd\u5e38\u7528\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f7f\u7528\u95f4\u63a5\u5730\u5740\u6620\u5c04\uff08indirect address mapping\uff09\u3002\u4e3a\u6b64\uff0c\u9700\u8981\u4e00\u4e2a\u5bc4\u5b58\u5668\u4fdd\u5b58\u4f4f\u76ee\u6807\u5730\u5740\uff0c\u540c\u65f6\u7528\u7b2c\u4e8c\u4e2a\u5bc4\u5b58\u5668\u4fdd\u5b58\u4f4f\u6765\u81ea\u6216\u662f\u53d1\u5f80\u76ee\u6807\u7684\u6570\u636e\u3002\u5148\u5bf9\u5730\u5740\u5bc4\u5b58\u5668\u8fdb\u884c\u5199\u5165\uff0c\u968f\u540e\u518d\u5bf9\u6570\u636e\u5bc4\u5b58\u5668\u8fdb\u884c\u8bfb\u53d6\u6216\u5199\u5165\uff0c\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u5bf9\u76ee\u6807Function\u6b63\u786e\u7684\u5185\u90e8\u5730\u5740\u7684\u4e00\u6b21\u8bfb\u4e8b\u52a1\u6216\u662f\u5199\u4e8b\u52a1\u3002\u8fd9\u5f88\u597d\u7684\u89e3\u51b3\u4e86\u5730\u5740\u7a7a\u95f4\u6709\u9650\u7684\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u610f\u5473\u7740\u4ea7\u751f\u4e00\u6b21\u914d\u7f6e\u8bbf\u95ee\u9700\u8981\u4e24\u6b21IO\u8bbf\u95ee\u3002</p> <p>PCI\u517c\u5bb9\u673a\u5236\u4f7f\u7528RC\u7684Host Bridge\u4e2d\u7684\u4e24\u4e2a32bit\u7684IO\u7aef\u53e3\u3002\u5b83\u4eec\u5206\u522b\u662f\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09\uff0c\u4f4d\u4e8eIO\u5730\u5740\u533a\u57df0CF8h-0CFBh\uff0c\u548c\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08Configuration Data Port\uff09\uff0c\u4f4d\u4e8eIO\u5730\u5740\u533a\u57df0CFCh-0CFFh\u3002</p> <p>\u8981\u8bbf\u95ee\u4e00\u4e2aFunction\u7684PCI\u517c\u5bb9\u914d\u7f6e\u5bc4\u5b58\u5668\uff0c\u9996\u5148\u8981\u5c06\u76ee\u6807\u7684Bus\u3001Device\u3001Function\u548cDW\u53f7\u5199\u5165\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff0c\u5e76\u5c06\u5176\u4f7f\u80fdbit\u7f6e\u4e3a\u6709\u6548\u3002\u7136\u540e\u7b2c\u4e8c\u6b65\uff0c\u4e00\u4e2a1\u62162\u62164Byte\u7684IO\u8bfb\u6216\u5199\u5c06\u4f1a\u53d1\u9001\u5230\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u3002RC\u7684Host Bridge\u5c06\u5bf9\u7ed9\u5b9a\u7684\u76ee\u6807\u603b\u7ebf\u548c\u5728Bridge\u4e0b\u73b0\u5b58\u7684\u603b\u7ebf\u8303\u56f4\u8fdb\u884c\u6bd4\u8f83\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u5728\u8fd9\u4e2a\u8303\u56f4\u5185\uff0c\u8fd9\u4e2aBridge\u5219\u4f1a\u53d1\u8d77\u914d\u7f6e\u8bfb\u8bf7\u6c42\u6216\u8005\u914d\u7f6e\u5199\u8bf7\u6c42\uff08\u8fd9\u53d6\u51b3\u4e8e\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684IO\u8bbf\u95ee\u662f\u8bfb\u64cd\u4f5c\u8fd8\u662f\u5199\u64cd\u4f5c\uff09\u3002</p>"},{"location":"pcie/all/#3711-configuration-address-port","title":"3.7.1.1   \u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09","text":"<p>\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u4ec5\u5728\u5904\u7406\u5668\u5bf9\u5176\u5b8c\u6210\u4e00\u4e2a\u5b8c\u6574\u768432bit\u5199\u64cd\u4f5c\u65f6\uff0c\u9501\u5b58\u4f4f\u5199\u5165\u7684\u4fe1\u606f\uff0c\u5982\u56fe 3\u20114\uff0c\u82e5\u5bf9\u8fd9\u4e2a\u7aef\u53e3\u8fdb\u884c\u8bfb\u64cd\u4f5c\u5219\u4f1a\u8fd4\u56de\u5b83\u7684\u8fd9\u4e9b\u5185\u5bb9\u3002\u5199\u5165\u914d\u7f6e\u5730\u5740\u7a7a\u95f4\u7684\u4fe1\u606f\u5fc5\u987b\u9075\u7167\u4e0b\u9762\u6240\u63cf\u8ff0\u7684\u6a21\u677f\uff08\u56fe 3\u20114\uff09\u3002</p> <p></p> <p>\u56fe 3\u20114\u5730\u5740\u4f4d\u4e8e0CF8h\u7684\u914d\u7f6e\u5730\u5740\u7aef\u53e3</p> <p>u Bits[1:0]\u662f\u5199\u6b7b\u4e0d\u53d8\u7684\u4e14\u53ea\u8bfb\u7684\uff0c\u5728\u8bfb\u53d6\u65f6\u53ea\u80fd\u8fd4\u56de0\u3002\u5b83\u7684\u4f4d\u7f6e\u662fDW\u5bf9\u9f50\u7684\uff0c\u4e0d\u5141\u8bb8\u5b57\u8282\u7279\u5b9a\uff08byte-specific\uff09\u7684\u504f\u79fb\u91cf\u3002</p> <p>u Bits[7:2]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Function\u7684PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\u5185\u7684\u76ee\u6807DW\uff08target dword\uff0c\u5176\u4e5f\u88ab\u79f0\u4f5c\u5bc4\u5b58\u5668\u53f7\uff09\uff0c\u4e5f\u5c31\u662f\u7528\u6765\u6807\u8bc6Function\u5185\u7684\u5bc4\u5b58\u5668\u53f7\uff0c\u8981\u6c42\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5fc5\u987b\u4f4d\u4e8e\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\u4e2d\u3002\u8fd9\u79cd\u673a\u5236\u4ec5\u9650\u4e8e\u517c\u5bb9\u7684\u914d\u7f6e\u7a7a\u95f4\u4e2d\u4f7f\u7528\u3002\uff08\u4f8b\u5982\u4e00\u4e2aFunction\u914d\u7f6e\u7a7a\u95f4\u7684\u524d64DW\uff09\u3002</p> <p>u Bits[10:8]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Device\u5185\u7684\u76ee\u6807Function\u53f7(0-7)\u3002</p> <p>u Bits[15:11]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Device\u53f7(0-31)\u3002</p> <p>u Bits[23:16]\u7528\u4e8e\u6807\u8bc6\u76ee\u6807Bus\u53f7(0-255)\u3002</p> <p>u Bits[30:24]\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a0\u3002</p> <p>u Bit[31]\u4e3a\u4f7f\u80fd\u4f4d\uff0c\u82e5\u8981\u5c06\u968f\u540e\u7684\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684IO\u8bbf\u95ee\u8f6c\u6362\u4e3a\u914d\u7f6e\u8bbf\u95ee\u5219\u5fc5\u987b\u8981\u5c06\u8be5bit\u7f6e\u4e3a1\u3002\u5f53\u8be5bit\u4e3a0\u65f6\uff0c\u82e5\u6709IO\u8bfb\u6216\u8005IO\u5199\u88ab\u53d1\u9001\u5230\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff0c\u90a3\u4e48\u8fd9\u4e9b\u4e8b\u52a1\u90fd\u4f1a\u88ab\u5f53\u6210\u666e\u901a\u7684IO\u8bf7\u6c42\u6765\u5904\u7406\u3002</p>"},{"location":"pcie/all/#3712-bus-compare-and-data-port-usage","title":"3.7.1.2   \u603b\u7ebf\u6bd4\u8f83\u548c\u6570\u636e\u7aef\u53e3\u7684\u4f7f\u7528\uff08Bus Compare and Data Port Usage\uff09","text":"<p>\u5982\u56fe 3\u20115\uff0cRC\u5185\u7684Host Bridge\u5b9e\u73b0\u4e86\u4e00\u4e2a\u201c\u6b21\u7ea7\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Secondary Bus Number\uff09\u201d\u548c\u4e00\u4e2a\u201c\u4ece\u5c5e\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Subordinate Bus Number\uff09\u201d\u3002\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08\u56fe 3\u20115\u4e2dRC\u7684Sec=0\u4e2d\u7684Sec\uff09\u6307\u7684\u662f\u5f53\u524dBridge\u4e0b\u76f4\u63a5\u7d27\u6328\u7684\u603b\u7ebf\u7684\u7f16\u53f7\uff0c\u4f8b\u5982\u56fe\u4e2dRC\u7684Host/PCI Bridge\u4ea7\u751f\u4e86Bus 0\uff0c\u56e0\u6b64Host/PCI Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5c31\u662f0\u3002\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08\u56fe 3\u20115\u4e2dRC\u7684Sub=9\u4e2d\u7684Sub\uff09\u6307\u7684\u662fBridge\u4e4b\u4e0b\u7684\u53ef\u4f5c\u4e3a\u76ee\u6807\u603b\u7ebf\u7684\u603b\u7ebf\u53f7\uff0c\u4f8b\u5982\u56fe\u4e2dDevice 1\u7684Sub=9\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u5728Device 1\u4e4b\u4e0b\u4ece\u5c5e\u7684\u603b\u7ebf\u53f7\u6700\u5927\u5230Bus 9\uff0c\u800c\u5b83\u7684Sec=5\u5219\u8bf4\u660e\u5176\u4e0b\u7684\u603b\u7ebf\u53f7\u4eceBus 5\u5f00\u59cb\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662fSec\u548cSub\u5171\u540c\u6307\u5b9a\u51fa\u4e86\u8fd9\u4e2a\u8bbe\u5907\u4e0b\u53ef\u8bbf\u95ee\u603b\u7ebf\u7684\u8303\u56f4\uff08\u5bf9\u4e8eDevice 1\u6765\u8bf4\u5c31\u662f5-9\uff09\u3002</p> <p>\u5728\u4e00\u4e2a\u5355RC\u7684\u7cfb\u7edf\u4e2d\uff0cHost-Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5e94\u8be5\u88ab\u56fa\u5b9a\u4e3a0\uff0c\u4e5f\u5c31\u662f\u5b83\u7684\u53ef\u8bfb\u53ef\u5199\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u4ece\u4e00\u590d\u4f4d\u5c31\u88ab\u5f3a\u5236\u7f6e\u4e3a0\uff0c\u6216\u8005\u8bf4\uff0cHost-Bridge\u77e5\u9053\u5b83\u8bbf\u95ee\u5230\u7684\u7b2c\u4e00\u4e2a\u603b\u7ebf\u4e00\u5b9a\u662fBus 0\u3002\u82e5\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff0c\u89c1\u56fe 3\u20114\uff09\u7684bit 31\u88ab\u7f6e\u4e3a1\uff0c\u90a3\u4e48Bridge\u5c31\u4f1a\u5c06\u76ee\u6807\u603b\u7ebf\u53f7\u4e0eBridge\u4e4b\u4e0b\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u6b64\u6765\u68c0\u67e5\u8fd9\u4e2a\u76ee\u6807\u603b\u7ebf\u662f\u5426\u4ece\u5c5e\u4e8e\u5f53\u524dBridge\u4e4b\u4e0b\u3002</p> <p>\u5f53Bridge\u6536\u5230\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5b83\u5c06\u4f1a\u8bc4\u4f30\u76ee\u6807\u603b\u7ebf\u53f7\u662f\u5426\u5728\u5176\u4e0b\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u8303\u56f4\u5185\uff0c\u8fd9\u4e2a\u8303\u56f4\u662f\u4ece\u6b21\u7ea7\u603b\u7ebf\u53f7\u5230\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08\u5305\u62ec\u4e24\u4e2a\u8fb9\u754c\uff09\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u53f7\u4e0e\u5f53\u524d\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u8bf4\u660e\u5f53\u524d\u7684\u6b21\u7ea7\u603b\u7ebf\u5c31\u662f\u76ee\u6807\u603b\u7ebf\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5c31\u4f1a\u88ab\u4f5c\u4e3a\u4e00\u4e2aType 0\u914d\u7f6e\u8bf7\u6c42\u6765\u4f20\u8f93\u3002\u5f53\u8bbe\u5907\u4eec\u6536\u5230\u4e00\u4e2aType 0\u8bf7\u6c42\uff0c\u5b83\u4eec\u5c31\u77e5\u9053\u81ea\u5df1\u6240\u5c5e\u7684\u672c\u5730\u603b\u7ebf\u4e0a\u7684\u67d0\u4e2a\u8bbe\u5907\u5c31\u662f\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\uff08\u76ee\u6807\u8bbe\u5907\u4e0d\u5728\u518d\u5f80\u4e0b\u7ea7\u7684\u4ece\u5c5e\u603b\u7ebf\u4e0a\uff09\u3002</p> <p>\u82e5\u76ee\u6807\u603b\u7ebf\u53f7\u8981\u5927\u4e8eBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff0c\u4f46\u662f\u5c0f\u4e8e\u6216\u8005\u7b49\u4e8eBridge\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bf7\u6c42\u5c06\u4f1a\u4f5c\u4e3aType 1\u914d\u7f6e\u8bf7\u6c42\u88ab\u8f6c\u53d1\u5230Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\u3002\u5bf9\u4e8e\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\uff0c\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\u5b83\uff1a\u5c3d\u7ba1\u8fd9\u4e2a\u8bf7\u6c42\u9700\u8981\u7ecf\u8fc7\u8fd9\u6761\u603b\u7ebf\uff0c\u4f46\u662f\u5b83\u7684\u76ee\u6807\u8bbe\u5907\u5e76\u4e0d\u5728\u8fd9\u4e00\u7ea7\u603b\u7ebf\u4e0a\uff0c\u76f8\u53cd\u5730\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5c06\u4f1a\u7531\u5f53\u524d\u603b\u7ebf\u4e0a\u7684Bridge\u4eec\u5411\u4e0b\u8f6c\u53d1\u5230\u5404\u81ea\u7684\u4e0b\u4e00\u7ea7\u603b\u7ebf\u4e0a\uff0c\u5f53\u7136\u8fd9\u4e9b\u8f6c\u53d1\u8fd9\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u7684Bridge\u5fc5\u987b\u662f\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5305\u542b\u4e86\u76ee\u6807\u603b\u7ebf\u7684\u3002\u57fa\u4e8e\u8fd9\u6837\u7684\u539f\u56e0\uff0cType 1\u914d\u7f6e\u8bf7\u6c42\u53ea\u5bf9Bridge\u8bbe\u5907\u6709\u4f5c\u7528\u3002\u66f4\u591a\u5173\u4e8eType 0\u548cType 1\u914d\u7f6e\u8bf7\u6c42\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201cConfiguration Request\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/all/#3713-hostsingle-host-system","title":"3.7.1.3   \u5355Host\u7cfb\u7edf\uff08Single Host System\uff09","text":"<p>RC\u4e2d\u7684Host/PCI Bridge\u4f1a\u5c06\u5199\u5165\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09\u7684\u4fe1\u606f\u9501\u5b58\u8d77\u6765\uff0c\u5982\u56fe 3\u20111\u3002\u82e5bit 31\u88ab\u7f6e\u4e3a1\u4e14\u76ee\u6807\u603b\u7ebf\u5728\u5f53\u524dBridge\u4e0b\u65b9\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u90a3\u4e48Bridge\u5c06\u628a\u63a5\u4e0b\u6765\u7684\u5904\u7406\u5668\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08Configuration Data Port\uff09\u7684\u8bbf\u95ee\u8f6c\u6362\u6210\u9488\u5bf9Bus 0\u7684\u914d\u7f6e\u8bf7\u6c42\u3002\u5904\u7406\u5668\u5c06\u4f1a\u5411\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff080CFCh\uff09\u53d1\u8d77\u4e00\u4e2aIO\u8bfb\u8bf7\u6c42\u6216\u8005\u4e00\u4e2aIO\u5199\u8bf7\u6c42\u3002\u8fd9\u4fc3\u4f7fBridge\u751f\u6210\u4e00\u4e2a\u914d\u7f6e\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u662f\u8bfb\u8bf7\u6c42\u8fd8\u662f\u5199\u8bf7\u6c42\u53d6\u51b3\u4e8eIO\u8bbf\u95ee\u662f\u8bfb\u8fd8\u662f\u5199\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u4e3aBus 0\uff0c\u90a3\u4e48\u5b83\u5c06\u662f\u4e00\u4e2aType 0\u914d\u7f6e\u8bf7\u6c42\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u662f\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\u7684\u5176\u4ed6\u603b\u7ebf\uff0c\u90a3\u4e48\u5b83\u5c06\u662f\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u3002\u82e5\u76ee\u6807\u603b\u7ebf\u4e0d\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u8fd9\u4e2aBridge\u5c06\u4e0d\u4f1a\u5bf9\u8fd9\u4e2a\u8bf7\u6c42\u8fdb\u884c\u8f6c\u53d1\u64cd\u4f5c\u3002</p> <p></p> <p>\u56fe 3\u20115 \u5355Root\u7cfb\u7edf</p>"},{"location":"pcie/all/#3714-hostmulti-host-system","title":"3.7.1.4   \u591aHost\u7cfb\u7edf\uff08Multi-Host System\uff09","text":"<p>\u82e5\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u5b58\u5728\u591a\u4e2aRC\uff0c\u5982\u56fe 3\u20116\u6240\u793a\uff0c\u90a3\u4e48\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u548c\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u5c06\u88ab\u8fd9\u4e24\u4e2aRC\u5404\u81ea\u7684Host/PCI Bridge\u590d\u7528\uff0c\u4e14\u4e24\u79cd\u914d\u7f6e\u7aef\u53e3\u5404\u81ea\u7684IO\u5730\u5740\u5728\u4e24\u4e2aHost/PCI Bridge\u4e2d\u76f8\u540c\uff0c\u4e5f\u5c31\u662f\u4e24\u4e2aRC\u4f7f\u7528\u76f8\u540c\u7684\u4e00\u4e2aIO\u5730\u5740\u6765\u8bbf\u95ee\u5404\u81ea\u914d\u7f6e\u5730\u5740\u5bc4\u5b58\u5668\uff0c\u540c\u7406\u8bbf\u95ee\u914d\u7f6e\u6570\u636e\u5bc4\u5b58\u5668\u4e5f\u662f\u3002\u4e3a\u4e86\u9632\u6b62\u4e89\u7528\uff0c\u5728\u4e24\u4e2aHost/PCI Bridge\u4e2d\u4ec5\u6709\u4e00\u4e2a\u4f1a\u54cd\u5e94\u5904\u7406\u5668\u5bf9\u914d\u7f6e\u7aef\u53e3\u7684\u8bbf\u95ee\u3002</p> <p>\\1.    \u5f53\u5904\u7406\u5668\u53d1\u8d77\u5bf9\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684IO\u5199\u64cd\u4f5c\u65f6\uff0c\u4e24\u4e2aHost Bridge\u662f\u7ecf\u8fc7\u914d\u7f6e\u7684\uff0c\u56e0\u6b64\u4ec5\u6709\u4e00\u4e2aHost Bridge\u4f1a\u5904\u4e8e\u6d3b\u8dc3\u5e76\u53c2\u4e0e\u5230\u6b64\u6b21\u4e8b\u52a1\u4e2d\u6765\u3002</p> <p>\\2.    \u5728\u679a\u4e3e\u8fc7\u7a0b\u671f\u95f4\uff08Enumeration\uff09\uff0c\u8f6f\u4ef6\u5c06\u641c\u7d22\u5230\u6240\u6709\u6d3b\u8dc3Bridge\u4e4b\u4e0b\u7684\u6240\u6709\u603b\u7ebf\uff0c\u5e76\u5bf9\u8fd9\u4e9b\u603b\u7ebf\u8fdb\u884c\u7f16\u53f7\u3002\u5f53\u8fd9\u4e00\u603b\u7ebf\u641c\u7d22\u8fc7\u7a0b\u5b8c\u6210\u540e\uff08\u4e0d\u662f\u679a\u4e3e\u8fc7\u7a0b\u5b8c\u6210\uff09\uff0c\u8f6f\u4ef6\u5c06\u4f7f\u80fd\u90a3\u4e2a\u4e0d\u6d3b\u8dc3\u7684Host Bridge\uff0c\u5e76\u7ed9\u5b83\u8d4b\u4e88\u4e00\u4e2a\u603b\u7ebf\u7f16\u53f7\uff0c\u8fd9\u4e2a\u603b\u7ebf\u7f16\u53f7\u4f1a\u5728\u4e4b\u524d\u90a3\u4e9b\u6d3b\u8dc3Bridge\u7684\u603b\u7ebf\u7f16\u53f7\u8303\u56f4\u4e4b\u5916\uff0c\u7136\u540e\u8f6f\u4ef6\u7ee7\u7eed\u8fdb\u884c\u679a\u4e3e\u8fc7\u7a0b\u3002\u8fd9\u4e24\u4e2aHost Bridge\u90fd\u4f1a\u770b\u89c1\u8bf7\u6c42\uff0c\u4f46\u662f\u7531\u4e8e\u5b83\u4eec\u4e8c\u8005\u62e5\u6709\u76f8\u4e92\u4e0d\u91cd\u53e0\u7684\u603b\u7ebf\u7f16\u53f7\u8303\u56f4\uff0c\u800c\u5b83\u4eec\u5404\u81ea\u53c8\u53ea\u4f1a\u5bf9\u81ea\u5df1\u7684\u8303\u56f4\u5185\u7684\u8bf7\u6c42\u4f5c\u51fa\u54cd\u5e94\uff0c\u56e0\u6b64\u5e76\u4e0d\u4f1a\u5b58\u5728\u51b2\u7a81\u7684\u60c5\u51b5\u3002</p> <p>\\3.    \u5728\u4e0a\u9762\u7684\u8fc7\u7a0b\u4e4b\u540e\uff0c\u4e24\u4e2aHost Bridge\u90fd\u4f1a\u6536\u5230\u5bf9\u5404\u81ea\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684\u8bbf\u95ee\uff0c\u800c\u968f\u540e\u8fdb\u884c\u7684\u7684\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684\u8bfb\u8bbf\u95ee\u6216\u5199\u8bbf\u95ee\uff0c\u5219\u4ec5\u4f1a\u88ab\u5305\u542b\u76ee\u6807\u603b\u7ebf\u7684Host/PCI Bridge\u6240\u63a5\u6536\u3002\u63a5\u6536\u8bbf\u95ee\u7684Bridge\u5c06\u4f1a\u54cd\u5e94\u5904\u7406\u5668\u7684\u4e8b\u52a1\uff0c\u800c\u53e6\u4e00\u4e2aBridge\u5219\u4f1a\u5ffd\u7565\u8fd9\u4e2a\u4e8b\u52a1\u3002</p> <p>\u00a1 \u82e5\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u6b21\u7ea7\u603b\u7ebf\uff0c\u90a3\u4e48Bridge\u5c06\u628a\u8fd9\u4e2a\u8bbf\u95ee\u8f6c\u6362\u6210Type 0\u914d\u7f6e\u8bbf\u95ee\u3002</p> <p>\u00a1 \u5426\u5219\uff0c\u8fd9\u4e2a\u8bbf\u95ee\u5c06\u88ab\u8f6c\u6362\u6210Type 1\u914d\u7f6e\u8bbf\u95ee\u3002</p> <p></p> <p>\u56fe 3\u20116\u591aRoot\u7cfb\u7edf</p>"},{"location":"pcie/all/#372-enhanced-configuration-access-mechanism","title":"3.7.2     \u589e\u5f3a\u578b\u914d\u7f6e\u8bbf\u95ee\u673a\u5236\uff08Enhanced Configuration Access Mechanism\uff09","text":""},{"location":"pcie/all/#3721-general","title":"3.7.2.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5f53\u534f\u8bae\u5236\u5b9a\u8005\u5728\u9009\u62e9PCI-X\u548c\u4e4b\u540e\u7684PCIe\u8be5\u5982\u4f55\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u65f6\uff0c\u4e00\u822c\u6709\u4e24\u4e2a\u8003\u8651\u3002\u7b2c\u4e00\u4e2a\uff0c\u6bcf\u4e2aFunction\u7684256Byte\u7a7a\u95f4\u9650\u5236\u4e86\u90a3\u4e9b\u60f3\u8981\u5728\u8fd9\u4e2a\u7a7a\u95f4\u5185\u653e\u4e00\u4e9b\u4e13\u6709\u4fe1\u606f\u7684\u5382\u5546\uff0c\u800c\u4e14\u672a\u6765\u7684\u534f\u8bae\u5236\u5b9a\u8005\u53ef\u80fd\u4e5f\u9700\u8981\u66f4\u591a\u7684\u7a7a\u95f4\u6765\u653e\u7f6e\u66f4\u591a\u7684\u80fd\u529b\u7ed3\u6784\uff08capability structure\uff09\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u7a7a\u95f4\u4ece\u6bcf\u4e2aFunction 256Bytes\u6269\u5c55\u81f34Kbytes\u3002\u7b2c\u4e8c\u4e2a\u8981\u8003\u8651\u7684\u662f\uff0c\u5728PCI\u88ab\u5f00\u53d1\u5e94\u7528\u7684\u65f6\u5019\uff0c\u591a\u5904\u7406\u5668\u7cfb\u7edf\u8fd8\u6bd4\u8f83\u5c11\u88ab\u4f7f\u7528\u3002\u5bf9\u4e8e\u65e7\u7684\u6a21\u578b\u6765\u8bf4\uff0c\u5f53\u7cfb\u7edf\u4e2d\u4ec5\u6709\u4e00\u4e2aCPU\u4e14\u5176\u53ea\u6709\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u65f6\uff0c\u4f7f\u75282\u6b65\u6765\u751f\u6210\u4e00\u6b21\u8bbf\u95ee\u7684\u8fd9\u79cd\u65b9\u6cd5\u5e76\u4e0d\u4f1a\u6709\u4ec0\u4e48\u95ee\u9898\u3002\u4f46\u662f\u5bf9\u4e8e\u65b0\u578b\u7684\u4f7f\u7528\u591a\u6838\u591a\u7ebf\u7a0b\u7684CPU\u7684\u8ba1\u7b97\u673a\u6765\u8bf4\uff0c\u4f7f\u7528IO\u95f4\u63a5\u8bbf\u95ee\u6a21\u578b\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e9b\u95ee\u9898\uff0c\u56e0\u4e3a\u5e76\u6ca1\u6709\u4e1c\u897f\u6765\u963b\u6b62\u591a\u7ebf\u7a0b\u540c\u4e00\u65f6\u95f4\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u3002\u56e0\u6b64\uff0c\u5728\u6ca1\u6709\u9501\u5b9a\u8bed\u610f\uff08lock semantics\uff09\u65f6\u4e0d\u518d\u4f7f\u7528\u201c2\u6b65\u201d\u6a21\u578b\uff08IO\u95f4\u63a5\u8bbf\u95ee\uff09\u3002\u5728\u6ca1\u6709\u9501\u5b9a\u8bed\u610f\uff08lock semantics\uff09\u7684\u60c5\u51b5\u4e0b\uff0c\u5f53\u7ebf\u7a0bA\u5f80\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08CF8h\uff09\u5199\u5165\u4e00\u4e2a\u503c\u540e\uff0c\u5728\u5b83\u7ee7\u7eed\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u505a\u76f8\u5e94\u7684\u64cd\u4f5c\u4e4b\u524d\uff0c\u5e76\u6ca1\u6709\u4e00\u4e2a\u673a\u5236\u6765\u9632\u6b62\u7ebf\u7a0bB\u5c06\u8fd9\u4e2a\u503c\u8986\u76d6\u6389\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u65b0\u95ee\u9898\uff0c\u534f\u8bae\u5236\u5b9a\u8005\u51b3\u5b9a\u91c7\u7528\u4e00\u4e2a\u4e0d\u540c\u4e8eIO\u95f4\u63a5\u8bbf\u95ee\u7684\u65b9\u6cd5\u3002\u4ed6\u4eec\u4e0d\u518d\u5c1d\u8bd5\u53bb\u4fdd\u7559\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u662f\u901a\u8fc7\u5c06\u6240\u6709\u914d\u7f6e\u7a7a\u95f4\u90fd\u6620\u5c04\u5230\u5185\u5b58\u5730\u5740\uff0c\u4ee5\u6b64\u6765\u521b\u9020\u51fa\u4e00\u4e2a\u5355\u6b65\uff08single-step\uff09\u3001\u4e0d\u53ef\u4e2d\u65ad\uff08uninterruptable\uff09\u7684\u8bbf\u95ee\u8fc7\u7a0b\u3002\u7531\u4e8e\u4e00\u4e2a\u9488\u5bf9\u7279\u5b9a\u5730\u5740\u8303\u56f4\u7684memory\u8bf7\u6c42\u4f1a\u5728\u603b\u7ebf\u4e0a\u4ea7\u751f\u4e00\u4e2a\u914d\u7f6e\u8bf7\u6c42\uff0c\u6240\u4ee5\u8fd9\u79cd\u8bbf\u95ee\u65b9\u5f0f\u53ea\u9700\u8981\u4e00\u4e2a\u547d\u4ee4\u5e8f\u5217\u5373\u53ef\u3002\u5728\u8fd9\u79cd\u65b9\u5f0f\u4e2d\u8fdb\u884c\u7684\u6298\u4e2d\uff08trade-off\uff09\u662f\u5730\u5740\u5927\u5c0f\u3002\u5bf9\u6240\u6709\u5b9e\u73b0\u7684\u6bcf\u4e2aFunction\u90fd\u6620\u5c044KB\uff0c\u8fd9\u9700\u8981256MB\u7684memory\uff08\u5185\u5b58\uff09\u5730\u5740\u7a7a\u95f4\u3002\u5728\u8fd9\u65b9\u9762\uff0c\u73b0\u4ee3\u4f53\u7cfb\u7ed3\u6784\u4e00\u822c\u652f\u630136\u523048\u4f4d\u7684\u7269\u7406\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u3002\u56e0\u6b64\u76f8\u8f83\u4e8e\u73b0\u5728\u7684\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u7684\u603b\u5927\u5c0f\uff0c256MB\u7684\u7a7a\u95f4\u5360\u7528\u5f88\u5c11\u3002</p> <p>\u4e3a\u4e86\u5904\u7406\u8fd9\u4e2a\u6620\u5c04\uff0c\u6bcf\u4e2aFunction\u76844KB\u914d\u7f6e\u7a7a\u95f4\u90fd\u4ee5\u4e00\u4e2a4KB\u5bf9\u9f50\u7684\u5730\u5740\u4f5c\u4e3a\u8d77\u59cb\u5730\u5740\uff0c\u4e14\u8fd9\u4e9b4KB\u914d\u7f6e\u7a7a\u95f4\u6240\u6620\u5c04\u7684\u5730\u5740\u90fd\u8981\u4f4d\u4e8e\u90a3\u6bb5\u4e3a\u4e86\u914d\u7f6e\u8bbf\u95ee\u800c\u9884\u7559\u7684256MB\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u5185\u3002\u5e76\u4e14\u73b0\u5728\u7684\u5730\u5740\u4e2d\u7684bit\u8fd8\u643a\u5e26\u4e86\u8bc6\u522b\u4fe1\u606f\uff08identifying information\uff09\uff0c\u7528\u4e8e\u8868\u793a\u54ea\u4e00\u4e2aFunction\u662f\u8bbf\u95ee\u76ee\u6807\uff08\u89c1\u8868 3\u20111\uff09\u3002</p> <p></p> <p>\u8868 3\u20111\u589e\u5f3a\u578b\u914d\u7f6e\u673a\u5236\u7684\u5185\u5b58\u6620\u5c04\u5730\u5740\u8303\u56f4</p>"},{"location":"pcie/all/#3722-some-rules","title":"3.7.2.2   \u4e00\u4e9b\u89c4\u5219\uff08Some Rules\uff09","text":"<p>\u5982\u679c\u4e00\u4e2a\u8bbf\u95ee\u8de8\u4e86dword\u5730\u5740\u8fb9\u754c\uff08\u8de8\u8d8a\u4e86\u76f8\u90bb\u7684\u4e24\u4e2a\u5185\u5b58DW\u7684\u8fb9\u754c\uff0c\u5373\u64cd\u4f5c\u957f\u5ea6\u5927\u4e8e\u4e86\u4e00\u4e2aDW\uff0c\u6216\u8005\u662f\u64cd\u4f5c\u957f\u5ea6\u7b49\u4e8e\u4e00\u4e2aDW\u4f46\u662f\u8d77\u59cb\u5730\u5740\u6ca1\u6709\u4f4d\u4e8eDW\u5bf9\u9f50\u7684\u5730\u5740\uff09\uff0c\u90a3\u4e48RC\u53ef\u4ee5\u4e0d\u652f\u6301\u5b83\u8bbf\u95ee\u589e\u5f3a\u578b\u914d\u7f6e\u5185\u5b58\u7a7a\u95f4\u3002RC\u4eec\u4e5f\u4e0d\u9700\u8981\u652f\u6301\u67d0\u4e9b\u603b\u7ebf\u9501\u5b9a\u534f\u8bae\uff08bus locking protocol\uff09\uff0c\u8fd9\u4e9b\u603b\u7ebf\u9501\u5b9a\u534f\u8bae\u4e2d\u7684\u4e00\u4e9b\u5904\u7406\u5668\u5178\u578b\u7528\u4e8e\u539f\u5b50\u64cd\u4f5c\u6216\u662f\u4e0d\u53ef\u4e2d\u65ad\u7684\u4e00\u7cfb\u5217\u547d\u4ee4\u3002\u8f6f\u4ef6\u5728\u8bbf\u95ee\u914d\u7f6e\u7a7a\u95f4\u65f6\uff0c\u9700\u8981\u907f\u514d\u4e0a\u8ff0\u8fd9\u4e24\u79cd\u60c5\u51b5\uff0c\u9664\u975e\u8f6f\u4ef6\u77e5\u9053RC\u53ef\u4ee5\u652f\u6301\u5b83\u4eec\u3002</p>"},{"location":"pcie/all/#38-configuration-requests","title":"3.8 \u914d\u7f6e\u8bf7\u6c42\uff08Configuration Requests\uff09","text":"<p>Bridge\u4e3a\u4e86\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\uff0c\u5c06\u4f1a\u4ea7\u751f\u4e24\u79cd\u7c7b\u578b\u7684\u914d\u7f6e\u8bf7\u6c42\uff0c\u5206\u522b\u4e3aType 0\u548cType 1\u3002\u5177\u4f53\u4ea7\u751f\u54ea\u4e00\u79cd\u7c7b\u578b\u7684\u914d\u7f6e\u8bf7\u6c42\u5219\u662f\u53d6\u51b3\u4e8e\u76ee\u6807\u603b\u7ebf\u53f7\u662f\u5426\u4e0e\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09\u76f8\u5339\u914d\u3002\u4e0b\u9762\u5c06\u8fdb\u884c\u8bb2\u89e3\u3002</p>"},{"location":"pcie/all/#381-type-0type-0-configuration-request","title":"3.8.1     Type 0\u914d\u7f6e\u8bf7\u6c42\uff08Type 0 Configuration Request\uff09","text":"<p>\u5982\u679c\u76ee\u6807\u603b\u7ebf\u53f7\u4e0e\u6b21\u7ea7\u603b\u7ebf\u53f7\u76f8\u5339\u914d\uff0cBridge\u5c06\u4ea7\u751f\u4e00\u4e2aType 0\u914d\u7f6e\u8bfb/\u5199\uff0c\u5e76\u8f6c\u53d1\u5230\u5b83\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\uff0c\u5e76\uff1a</p> <p>\\1.    \u603b\u7ebf\u4e0a\u7684\u8bbe\u5907\u4eec\u68c0\u67e5\u914d\u7f6e\u8bf7\u6c42\u4e2d\u7684Device Number\uff08\u8bbe\u5907\u53f7\uff09\uff0c\u770b\u8c01\u624d\u662f\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5916\u90e8\u94fe\u8def\uff08external Link\uff09\u4e0a\u7684EP\u603b\u662fDevice 0\u3002</p> <p>\\2.    \u88ab\u9009\u4e2d\u7684\u8bbe\u5907\u68c0\u67e5Function Number\uff0c\u770b\u770b\u8bbe\u5907\u5185\u7684\u54ea\u4e2aFunction\u88ab\u9009\u4e2d\u3002</p> <p>\\3.    \u88ab\u9009\u4e2d\u7684Function\u4f7f\u7528Register Number\u5b57\u6bb5\u57df\u6765\u9009\u62e9\u5b83\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684DW\uff0c\u8fd9\u4e2aDW\u5c31\u662f\u76ee\u6807DW\uff0c\u5e76\u4f7f\u7528First Dword Byte Enable\u5b57\u6bb5\u57df\u6765\u9009\u51fa\u8fd9\u4e2aDW\u4e2d\u8981\u88ab\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u7684\u5b57\u8282\u4eec\u3002</p> <p>\u5982\u56fe 3\u20117\u4e2d\u7ed9\u51fa\u4e86Type 0\u914d\u7f6e\u5199\u8bf7\u6c42\u548c\u8bfb\u8bf7\u6c42\u7684Header\u683c\u5f0f\u3002\u5728\u8bfb\u5199\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0cType\u5b57\u6bb5\u90fd\u662f00100\uff0c\u800cFormat\uff08Fmt\uff09\u5b57\u6bb5\u5219\u7528\u4e8e\u6307\u793a\u662f\u8bfb\u8bf7\u6c42\u8fd8\u662f\u5199\u8bf7\u6c42\u3002</p> <p></p> <p>\u56fe 3\u20117 Type 0\u914d\u7f6e\u8bfb\u8bf7\u6c42\u548c\u5199\u8bf7\u6c42\u7684Header</p>"},{"location":"pcie/all/#382-type-1type-1-configuration-request","title":"3.8.2     Type 1\u914d\u7f6e\u8bf7\u6c42\uff08Type 1 Configuration Request\uff09","text":"<p>\u5f53Bridge\u5f97\u5230\u7684\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u5e76\u4e0d\u662f\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff0c\u4f46\u662f\u76ee\u6807\u603b\u7ebf\u53f7\u53c8\u5728\u4ece\u5c5e\u603b\u7ebf\uff08Subordinate Bus\uff09\u7684\u8303\u56f4\u5185\uff0c\u90a3\u4e48Bridge\u5c06\u5411\u6b21\u7ea7\u603b\u7ebf\u8f6c\u53d1\u4e00\u4e2aType 1\u8bf7\u6c42\u5305\u3002\u6b21\u7ea7\u603b\u7ebf\u4e0a\u7684\u975eBridge\u7684\u8bbe\u5907\uff08EP\uff09\u5c06\u4f1a\u5ffd\u7565Type 1\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\u5e76\u4e0d\u662f\u5f53\u524d\u603b\u7ebf\u3002\u4f46\u662f\u6b21\u7ea7\u603b\u7ebf\u4e0a\u7684Bridge\u770b\u5230Type 1\u8bf7\u6c42\u5219\u5c06\u4f1a\u8fdb\u884c\u4e0e\u4e0a\u4e00\u7ea7Bridge\u76f8\u540c\u7684\u5bf9\u6bd4\u64cd\u4f5c\uff0c\u5f53\u76ee\u6807\u603b\u7ebf\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\u65f6\uff1a</p> <p>n \u5982\u679c\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5305\u5c06\u4eceType 1\u88ab\u8f6c\u6362\u6210Type 0\uff0c\u5e76\u8f6c\u53d1\u5230\u6b21\u7ea7\u603b\u7ebf\u4e0a\u3002\u6b21\u7ea7\u603b\u7ebf\u4e0a\u7684\u672c\u5730\u8bbe\u5907\u5c06\u4f1a\u50cf\u6b64\u524d\u63cf\u8ff0\u7684\u4e00\u6837\u68c0\u67e5\u8bf7\u6c42\u5305\u7684Header\u3002</p> <p>n \u82e5\u76ee\u6807\u603b\u7ebf\u53f7\u4e0d\u662f\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u4f46\u662f\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u8bf7\u6c42\u5305\u5c06\u4f1a\u7ee7\u7eed\u4ee5Type 1\u8bf7\u6c42\u7684\u683c\u5f0f\u88ab\u8f6c\u53d1\u5230\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\u3002</p> <p>\u5982\u5c55\u793a\u4e86Type 1\u914d\u7f6e\u8bfb\u8bf7\u6c42\u548c\u5199\u8bf7\u6c42\u7684Header\u683c\u5f0f\u3002\u5728\u8bfb\u5199\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0cType\u5b57\u6bb5\u57df\u90fd\u662f00101\uff0c\u800cFormat\uff08Fmt\uff09\u5b57\u6bb5\u5219\u7528\u6765\u6307\u793a\u8fd9\u662f\u8bfb\u8fd8\u662f\u5199\u3002</p> <p></p> <p>\u56fe 3\u20118 Type 1\u914d\u7f6e\u8bfb\u8bf7\u6c42\u548c\u5199\u8bf7\u6c42\u7684Header</p>"},{"location":"pcie/all/#39-pciexample-pci-compatible-configuration-access","title":"3.9 PCI\u517c\u5bb9\u914d\u7f6e\u8bbf\u95ee\u793a\u4f8b\uff08Example PCI-Compatible Configuration Access\uff09","text":"<p>\u8bf7\u53c2\u9605\u56fe 3\u20119\uff0c\u5728\u6b64\u56fe\u4e2d\u7ea0\u6b63\u4e86\u539f\u4e66\u7248\u672c\u7684\u4e00\u4e2a\u9519\u8bef\uff08\u8be5\u9519\u8bef\u4e3aerrata\u4e2d\u7684\u7b2c1\u6761\uff09\uff0cBus 6\u7684\u4e2d\u95f4\u7684Bridge\u7684Sub\u5e94\u8be5\u4e3a9\u800c\u4e0d\u662f8\uff0c\u539f\u56fe\u4e2d\u4e3a8\u3002</p> <p>\u4e3a\u4e86\u66f4\u597d\u7684\u5bf9\u4f7f\u7528\u4f20\u7edf\u7684CF8h/CFCh\u673a\u5236\u6765\u4ea7\u751f\u914d\u7f6e\u8bf7\u6c42\u8fdb\u884c\u8bf4\u660e\uff0c\u8bf7\u53c2\u8003\u4e0b\u9762\u7684x86\u6c47\u7f16\u4ee3\u7801\uff0c\u8fd9\u6bb5\u4ee3\u7801\u4f7f\u5f97RC\u6267\u884c\u4e00\u4e2a2byte\u7684\u8bfb\u64cd\u4f5c\uff0c\u64cd\u4f5c\u76ee\u6807\u4e3aBus 4\uff0cDevice 0\uff0cFunction 0\uff0cRegister 0\uff08\u8fd9\u4e2aRegister 0\u5c31\u662f\u5382\u5546Vendor ID\uff09\u3002</p> <p>mov  dx,0CF8h   ;\u5c06dx\u8bbe\u7f6e\u4e3a\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684\u5730\u5740</p> <p>mov  eax,8004000h ;enable bit=1\uff0cbus 4\uff0cdev 0\uff0cfunc 0\uff0cDW 0</p> <p>out  dx,eax    ;IO\u5199\u6765\u8bbe\u7f6e\u5730\u5740\u7aef\u53e3</p> <p>mov  dx,0CFCh   ;\u5c06dx\u8bbe\u7f6e\u4e3a\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684\u5730\u5740</p> <p>in   ax,dx    ;\u4ece\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u8bfb\u51fa2byte\u6570\u636e</p> <p>\\1.    \u4ee3\u7801\u4e2d\u7684out\u6307\u4ee4\u5c06\u4ea7\u751f\u4e00\u4e2aIO\u5199\u64cd\u4f5c\uff0c\u4ece\u5904\u7406\u5668\u5199\u5165\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff0c\u8fd9\u4e2a\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u4f4d\u4e8eRC\u7684Host Bridge\uff080CF8h\uff09\uff0c\u5982\u56fe 3\u20114\u3002</p> <p>\\2.    Host Bridge\u5c06\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u4e2d\u7684\u76ee\u6807\u603b\u7ebf\u53f7\uff08\u8fd9\u91cc\u662f4\uff09\u4e0eBridge\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\uff08\u8fd9\u91cc\u662f0\u523010\uff09\u8fdb\u884c\u6bd4\u8f83\u3002\u5f88\u660e\u663e\u76ee\u6807\u603b\u7ebf\u53f7\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u56e0\u6b64Bridge\u5c31\u51c6\u5907\u597d\u4e86\u63a5\u4e0b\u6765\u4ea7\u751f\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u7684\u5730\u3002</p> <p>\\3.    \u4ee3\u7801\u4e2d\u7684in\u6307\u4ee4\u5c06\u4ea7\u751f\u4e00\u4e2aIO\u8bfb\u4e8b\u52a1\uff0c\u8bfb\u4e8b\u52a1\u4ea7\u751f\u81ea\u5904\u7406\u5668\u5e76\u53d1\u5f80RC Host Bridge\u4e2d\u7684\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u3002\u8fd9\u662f\u4e00\u4e2a\u5bf9\u914d\u7f6e\u6570\u636e\u7aef\u53e3\u7684\u524d\u4e24\u4e2abyte\u8fdb\u884c\u8bfb\u53d6\u7684\u8bfb\u4e8b\u52a1\u3002</p> <p>\\4.    \u7531\u4e8e\u76ee\u6807\u603b\u7ebf\u53f7\u4e0d\u662fbus 0\uff0c\u6240\u4ee5Host/PCI Bridge\u5bf9bus 0\u53d1\u8d77\u4e00\u4e2aType 1\u914d\u7f6e\u8bfb\u8bf7\u6c42\u3002</p> <p>\\5.    bus 0\u4e0a\u7684\u6240\u6709\u8bbe\u5907\u90fd\u4f1a\u9501\u5b58\u8fd9\u4e2a\u4e8b\u52a1\u8bf7\u6c42\uff0c\u5e76\u53d1\u73b0\u5b83\u662f\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u3002\u56e0\u6b64RC\u4e2d\u7684\u4e24\u4e2a\u865a\u62dfPCI-to-PCI Bridges\u5404\u81ea\u90fd\u5c06Type 1\u8bf7\u6c42\u4e2d\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u4e0e\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u8fdb\u884c\u6bd4\u8f83\u3002</p> <p>\\6.    \u76ee\u7684\u5730bus 4\u4f4d\u4e8e\u5de6\u4fa7Bridge\u7684\u4e0b\u65b9\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u4e2d\uff0c\u6240\u4ee5\u5de6\u4fa7Bridge\u5c06\u628a\u8fd9\u4e2a\u8bf7\u6c42\u6570\u636e\u5305\u53d1\u9001\u5230\u5b83\u7684\u6b21\u7ea7\u603b\u7ebf\u4e0a\uff0c\u4f46\u662f\u8fd9\u4e2a\u8bf7\u6c42\u4ecd\u7136\u662f\u4e00\u4e2aType 1\u8bf7\u6c42\uff0c\u56e0\u4e3a\u76ee\u6807\u603b\u7ebf\u5e76\u4e0d\u662f\u8fd9\u4e2a\u5de6\u4fa7Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u3002</p> <p>\\7.    \u56fe\u5de6\u4fa7\u7684Switch\u7684\u4e0a\u65b9\u7aef\u53e3\u5c06\u63a5\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u5c06\u5b83\u4f20\u9001\u7ed9Switch\u4e2d\u9760\u4e0a\u65b9\u7684PCI-to-PCI Bridge\u3002</p> <p>\\8.    \u8fd9\u4e2aSwitch\u4e2d\u9760\u4e0a\u65b9\u7684PCI-to-PCI Bridge\u786e\u5b9a\u76ee\u6807\u603b\u7ebf\u5728\u81ea\u5df1\u4e0b\u65b9\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u56e0\u6b64\u5b83\u5c06\u8bf7\u6c42\u6570\u636e\u5305\u7ee7\u7eed\u4ee5Type 1\u8bf7\u6c42\u7684\u683c\u5f0f\u8f6c\u53d1\u5230bus 2\u4e0a\u3002</p> <p>\\9.    bus 2\u4e0a\u7684\u4e24\u4e2aBridge\u90fd\u63a5\u6536\u5230\u4e86Type 1\u8bf7\u6c42\u5305\u3002\u504f\u53f3\u4fa7\u7684Bridge\u786e\u5b9a\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\u3002</p> <p>\\10.  bus 2\u4e0a\u504f\u53f3\u4fa7\u7684Bridge\u5c06\u8fd9\u4e2a\u914d\u7f6e\u8bfb\u8bf7\u6c42\u53d1\u9001\u5230bus 4\u4e0a\uff0c\u800c\u4e14\u8fd9\u6b21\u4f1a\u5c06\u539f\u672c\u4e3aType 1\u7684\u8bf7\u6c42\u8f6c\u6362\u6210Type 0\u914d\u7f6e\u8bfb\u8bf7\u6c42\u6765\u53d1\u9001\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\u5c31\u662f\u5f53\u524dBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u3002</p> <p>\\11.  bus 4\u4e0a\u7684Device 0\u63a5\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\u5305\uff0c\u5e76\u5bf9\u6570\u636e\u5305\u4e2d\u7684\u76ee\u6807Device\u53f7\u3001Function\u53f7\u3001Register\u53f7\u7684\u5b57\u6bb5\u8fdb\u884c\u8bd1\u7801\uff0c\u4ee5\u6b64\u6765\u9009\u4e2d\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684\u76ee\u6807DW\u3002\uff08\u5982\u56fe 3\u20113\uff09</p> <p>\\12.  First Dword Byte Enable\u5b57\u6bb5\u4e2d\u7684bit 0\u548cbit 1\u90fd\u88ab\u7f6e\u4e3a\u6709\u6548\uff0c\u56e0\u6b64Function\u5c06\u5728\u5b8c\u6210\u5305\u4e2d\u8fd4\u56de\u5b83\u7684\u524d\u4e24\u4e2a\u5b57\u8282\uff08\u524d\u4e24\u4e2a\u5b57\u8282\u4e5f\u5c31\u662fVendor ID\uff09\u3002\u7136\u540e\u5b8c\u6210\u5305\u4f7f\u7528\u4eceType 0\u8bf7\u6c42\u5305\u4e2d\u83b7\u5f97\u7684Requester ID\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\uff0c\u901a\u8fc7\u8def\u7531\u8f6c\u53d1\uff0c\u6700\u7ec8\u56de\u5230Host Bridge\u3002</p> <p>\\13.  \u8bfb\u51fa\u6765\u76842byte\u6570\u636e\u5c06\u4f1a\u5448\u4ea4\u7ed9\u5904\u7406\u5668\uff0c\u4ee5\u6b64\u6765\u5b8c\u6210in\u6307\u4ee4\u7684\u6267\u884c\u3002Vendor ID\u7684\u503c\u88ab\u653e\u7f6e\u5728\u5904\u7406\u5668\u7684AX\u5bc4\u5b58\u5668\u4e2d\u3002</p>"},{"location":"pcie/all/#310-example-enhanced-configuration-access","title":"3.10     \u589e\u5f3a\u578b\u914d\u7f6e\u8bbf\u95ee\u793a\u4f8b\uff08Example Enhanced Configuration Access\uff09","text":"<p>\u8bf7\u53c2\u9605\u56fe 3\u20119\u3002</p> <p>\u4e0b\u9762\u7684x86\u6c47\u7f16\u4ee3\u7801\u5c06\u4f7f\u5f97RC\u6267\u884c\u4e00\u4e2a2byte\u7684\u8bfb\u64cd\u4f5c\uff0c\u64cd\u4f5c\u76ee\u6807\u4e3aBus 4\uff0cDevice 0\uff0cFunction 0\uff0cRegister 0\uff08\u8fd9\u4e2aRegister 0\u5c31\u662f\u5382\u5546Vendor ID\uff09\u3002\u5728\u8fd9\u6bb5\u4ee3\u7801\u5de5\u4f5c\u4e4b\u524d\uff0cHost Bridge\u5fc5\u987b\u5df2\u7ecf\u88ab\u5206\u914d\u4e86\u4e00\u4e2a\u57fa\u5730\u5740\uff08base address value\uff09\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5047\u8bbe\u589e\u5f3a\u578b\u914d\u7f6e\u5185\u5b58\u6620\u5c04\u8303\u56f4\uff08Enhanced Configuration memory-mapped range\uff09\u7684256MB\u5bf9\u9f50\u57fa\u5740\u4e3aE0000000h\u3002</p> <p>mov  ax,[E0400000h] ;\u5185\u5b58\u6620\u5c04\u914d\u7f6e\u7684\u8bfb\u64cd\u4f5c</p> <p>n \u5730\u5740[63:28]\u8868\u793a\u6574\u4f53\u589e\u5f3a\u578b\u914d\u7f6e\u5730\u5740\u8303\u56f4\u7684256MB\u5bf9\u9f50\u7684\u57fa\u5730\u5740\u7684\u9ad836bit\uff0c\u5728\u672c\u4f8b\u4e2d\uff0c\u8fd9\u4e2a\u6574\u4f53\u589e\u5f3a\u578b\u914d\u7f6e\u5730\u5740\u8303\u56f4\u4e3a00000000 E0000000h\uff0c\u5730\u5740[63:28]\u5219\u662f\u8868\u793a\u8fd9\u4e2a\u8303\u56f4\u4e2d256MB\u5bf9\u9f50\u57fa\u5730\u5740\u7684\u9ad836bit\u3002</p> <p>n \u5730\u5740[27:20]\u7528\u4e8e\u9009\u62e9\u76ee\u6807bus\uff08\u672c\u4f8b\u4e2d\u4e3abus 4\uff09</p> <p>n \u5730\u5740[19:15]\u7528\u4e8e\u9009\u62e9bus\u4e0a\u7684\u76ee\u6807device\uff08\u672c\u4f8b\u4e2d\u4e3adevice 0\uff09</p> <p>n \u5730\u5740[14:12]\u7528\u4e8e\u9009\u62e9device\u5185\u7684\u76ee\u6807function\uff08\u672c\u4f8b\u4e2d\u4e3afunction 0\uff09</p> <p>n \u5730\u5740[11:2]\u7528\u4e8e\u9009\u62e9function\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684\u76ee\u6807DW\uff08\u672c\u4f8b\u4e2d\u4e3aDW 0\uff09</p> <p>n \u5730\u5740[1:0]\u7528\u4e8e\u5b9a\u4e49\u9009\u4e2d\u7684DW\u4e2d\u7684\u8d77\u59cbbyte\u7684\u4f4d\u7f6e\uff08\u672c\u4f8b\u4e2d\u4e3abyte 0\uff09</p> <p>\u5904\u7406\u5668\u53d1\u8d77\u4e00\u4e2a2byte\u7684memory read\uff0c\u8bfb\u53d6\u7684\u8d77\u59cb\u5730\u5740\u4e3aE0400000h\uff0c\u8fd9\u4e2a\u5730\u5740\u4f1a\u88abRC\u4e2d\u7684Host Bridge\u9501\u5b58\u4e0b\u6765\u3002Host Bridge\u8bc6\u522b\u5230\u8fd9\u4e2a\u5730\u5740\u4f4d\u4e8e\u7528\u6765\u8fdb\u884c\u914d\u7f6e\u7684\u533a\u57df\u4e4b\u5185\uff0c\u5b83\u5c06\u4ea7\u751f\u4e00\u4e2a\u914d\u7f6e\u8bfb\u8bf7\u6c42\uff0c\u8bfb\u53d6\u7684\u4f4d\u7f6e\u4e3aBus 4\u2014Device 0\u2014Function 0\u2014dword 0\u2014\u9996\u4e24\u4e2a\u5b57\u8282\u3002\u5269\u4e0b\u7684\u64cd\u4f5c\u5c31\u8ddf\u524d\u9762\u7684\u5c0f\u8282\u4e2d\u6240\u8bb2\u7684\u4e00\u6837\u4e86\uff0c\u4e5f\u5c31\u662f\u5982\u4f55\u628a\u8bfb\u51fa\u6765\u7684\u4fe1\u606f\u901a\u8fc7\u5b8c\u6210\u5305\u8fd4\u56de\u7ed9Host\u3002</p> <p></p> <p>\u56fe 3\u20119\u914d\u7f6e\u8bfb\u8bbf\u95ee\u793a\u4f8b</p>"},{"location":"pcie/all/#311-enumeration-discovering-the-topology","title":"3.11     \u679a\u4e3e\u2014\u2014\u641c\u7d22\u53d1\u73b0\u62d3\u6251\uff08Enumeration-Discovering the Topology\uff09","text":"<p>\u5728\u5b8c\u6210\u4e86\u7cfb\u7edf\u4e0a\u7535\u6216\u662f\u590d\u4f4d\u4e4b\u540e\uff0c\u914d\u7f6e\u8f6f\u4ef6\u9700\u8981\u626b\u63cfPCIe\u7f51\u7edc\u7ed3\u6784\uff0c\u6765\u641c\u7d22\u53d1\u73b0\u6574\u4e2a\u673a\u5668\u7684\u62d3\u6251\uff0c\u5e76\u5b66\u4e60\u8fd9\u4e2a\u7f51\u7edc\u7ed3\u6784\u662f\u5982\u4f55\u88ab\u586b\u5145\u7684\uff08\u4f8b\u5982\u91cc\u9762\u90fd\u6709\u591a\u5c11\u603b\u7ebf\u3001\u591a\u5c11\u8bbe\u5907\u4ee5\u53ca\u5b83\u4eec\u7684\u7f16\u53f7\u7b49\u7b49\uff09\u3002\u5728\u8fd9\u8fdb\u884c\u4e4b\u524d\uff0c\u5982\u56fe 3\u201110\u6240\u793a\uff0c\u8f6f\u4ef6\u552f\u4e00\u77e5\u9053\u7684\u5c31\u662f\u62d3\u6251\u4e2d\u6709\u4e00\u4e2aHost/PCI Bridge\u4ee5\u53ca\u8fd9\u4e2aBridge\u7684\u6b21\u7ea7\u603b\u7ebfBus 0\u3002\u9700\u8981\u6ce8\u610f\uff0c\u4e00\u4e2aBridge\u81ea\u8eab\u4e0a\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u79f0\u4e3a\u4e3b\u603b\u7ebf\uff08Primary Bus\uff09\uff0c\u800c\u8fd9\u4e2aBridge\u81ea\u8eab\u4e0b\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u79f0\u4e3a\u6b21\u7ea7\u603b\u7ebf\uff08Secondary Bus\uff09\u3002\u626b\u63cfPCIe\u7ed3\u6784\u6765\u53d1\u73b0\u6574\u4f53\u62d3\u6251\u7ed3\u6784\u7684\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u679a\u4e3e\u8fc7\u7a0b\u3002</p> <p></p> <p>\u56fe 3\u201110\u521a\u542f\u52a8\u65f6\u8f6f\u4ef6\u6240\u8ba4\u4e3a\u7684\u62d3\u6251\u7ed3\u6784</p>"},{"location":"pcie/all/#3111-functiondiscovering-the-presence-or-absence-of-a-function","title":"3.11.1    \u641c\u7d22\u67d0\u4e2aFunction\u662f\u5426\u5b58\u5728\uff08Discovering the Presence or Absence of a Function\uff09","text":"<p>\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u7684\u914d\u7f6e\u8f6f\u4ef6\u53d1\u73b0\u4e00\u4e2aFunction\u7684\u65b9\u5f0f\u4e00\u822c\u662f\u8bfb\u53d6\u8fd9\u4e2aFunction\u7684Vendor ID\u5bc4\u5b58\u5668\u3002PCI-SIG\u7ed9\u6bcf\u4e2a\u5382\u5546\u90fd\u5206\u914d\u4e86\u4e00\u4e2a\u552f\u4e00\u7684Vendor ID\uff0c\u6bcf\u4e2a\u5382\u5546\u90fd\u4f1a\u5c06\u81ea\u5df1\u8bbe\u8ba1\u7684Function\u4e2d\u7684Vendor ID\u5bc4\u5b58\u5668\u7684\u503c\u56fa\u5b9a\u4e3a\u81ea\u5df1\u7684Vendor ID\u3002\u901a\u8fc7\u8bfb\u53d6\u6574\u4e2a\u7cfb\u7edf\u4e2d\u7684Bus\u2014Device\u2014Function\u8fd9\u4e09\u8005\u6240\u6709\u7ec4\u5408\u4e2d\u7684Vendor ID\u5bc4\u5b58\u5668\uff0c\u679a\u4e3e\u8f6f\u4ef6\u53ef\u4ee5\u641c\u7d22\u904d\u6574\u4e2a\u62d3\u6251\uff0c\u5e76\u5f97\u77e5\u6709\u54ea\u4e9b\u8bbe\u5907\u5b58\u5728\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u76f8\u5f53\u7684\u7b80\u5355\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e24\u4e2a\u95ee\u9898\uff1a\u76ee\u6807\u8bbe\u5907\u53ef\u80fd\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u5b83\u867d\u7136\u5b58\u5728\u4f46\u662f\u6ca1\u6709\u51c6\u5907\u597d\u54cd\u5e94\u4e8b\u52a1\u8bf7\u6c42\u3002\u4e0b\u9762\u5c06\u4ecb\u7ecd\u5982\u4f55\u5904\u7406\u8fd9\u4e24\u79cd\u60c5\u51b5\u3002</p>"},{"location":"pcie/all/#31111-device-not-present","title":"3.11.1.1 \u8bbe\u5907\u4e0d\u5b58\u5728\uff08Device not Present\uff09","text":"<p>\u76ee\u6807\u8bbe\u5907\u5728\u7cfb\u7edf\u4e2d\u4e0d\u5b58\u5728\u7684\u8fd9\u4e2a\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u5728\u679a\u4e3e\u641c\u7d22\u8fc7\u7a0b\u4e2d\u53d1\u751f\u5f88\u591a\u6b21\u3002\u5f53\u5b83\u53d1\u751f\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u5b83\u6709\u6b63\u786e\u7684\u7406\u89e3\u3002\u5728PCI\u4e2d\uff0c\u914d\u7f6e\u8bfb\u8bf7\u6c42\uff08Configuration Read Request\uff09\u6709\u53ef\u80fd\u5728\u603b\u7ebf\u4e0a\u6267\u884c\u8d85\u65f6\uff08timeout\uff09\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e3b\u8bbe\u5907\u653e\u5f03\uff08Master Abort\uff09\u7684\u9519\u8bef\u60c5\u51b5\u3002\u7531\u4e8e\u6ca1\u6709\u8bbe\u5907\u6765\u9a71\u52a8\u603b\u7ebf\uff0c\u6240\u6709\u7684\u4fe1\u53f7\u90fd\u662f\u62c9\u9ad8\u7684\uff0c\u90a3\u4e48\u6570\u636e\u4f4d\u5728\u603b\u7ebf\u4e0a\u5c31\u662f\u5168\u4e3a1\u7684\uff0c\u8fd9\u4e2a\u5168\u4e3a1\u7684\u503c\u5c06\u6210\u4e3a\u603b\u7ebf\u4e0a\u88ab\u770b\u89c1\u7684\u6570\u636e\u503c\u3002\u8fd9\u4f7f\u5f97\u503c\u4e3aFFFFh\u7684Vendor ID\u5e76\u6ca1\u6709\u88ab\u5206\u914d\u51fa\u53bb\uff0c\u800c\u662f\u4f5c\u4e3a\u4e00\u4e2a\u4fdd\u7559\u503c\u3002\u5982\u679c\u679a\u4e3e\u8f6f\u4ef6\u6536\u5230\u7684\u8bfb\u53d6Vendor ID\u7684\u7ed3\u679c\u662fFFFFh\uff0c\u90a3\u4e48\u5b83\u5c31\u77e5\u9053\u5b83\u8bfb\u53d6\u7684\u8bbe\u5907\u4e0d\u5b58\u5728\u3002\u7531\u4e8e\u8fd9\u79cd\u60c5\u51b5\u5176\u5b9e\u5e76\u4e0d\u662f\u4e00\u79cd\u9519\u8bef\u60c5\u51b5\uff0c\u56e0\u6b64\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\uff0cMaster Abort\u5e76\u4e0d\u4f1a\u88ab\u5f53\u505a\u662f\u4e00\u4e2a\u9519\u8bef\u6765\u8fdb\u884c\u62a5\u544a\u3002</p> <p>\u5bf9\u4e8ePCIe\u6765\u8bf4\uff0c\u9488\u5bf9\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8bbe\u5907\u7684\u914d\u7f6e\u8bfb\u8bf7\u6c42\u5c06\u4f7f\u5f97\u76ee\u6807\u8bbe\u5907\u4e0a\u65b9\u8fde\u63a5\u7684Bridge\u8fd4\u56de\u4e00\u4e2a\u4e0d\u643a\u5e26\u6570\u636e\u7684\u5b8c\u6210\u5305\uff0c\u8fd9\u4e2a\u5b8c\u6210\u5305\u7684\u72b6\u6001\u5b57\u6bb5\u5c06\u88ab\u7f6e\u4e3aUR\uff08Unsupported Request\uff0c\u4e0d\u88ab\u652f\u6301\u7684\u8bf7\u6c42\uff09\u3002\u4e3a\u4e86\u5411\u540e\u517c\u5bb9\u4f20\u7edf\u7684\u679a\u4e3e\u6a21\u578b\uff0c\u82e5RC\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u6536\u5230\u8fd9\u6837\u7684\u5b8c\u6210\u5305\uff0c\u5b83\u5c06\u4f1a\u7ed9\u5904\u7406\u5668\u8fd4\u56de\u6570\u636eFFFFh\u3002\u6ce8\u610f\uff0c\u679a\u4e3e\u8f6f\u4ef6\u662f\u4f9d\u8d56\u4e8e\u63a5\u6536\u5230\u4e00\u4e2a\u8fd4\u56de\u503c\u4e3a\u51681\uff08FFFFh\uff09\u7684\u914d\u7f6e\u8bfb\u8bf7\u6c42\u6765\u5224\u5b9a\u76ee\u6807\u8bbe\u5907\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u800c\u7cfb\u7edf\u4e2d\u7684\u5728\u8bfb\u53d6\u8fd9\u6837\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8bbe\u5907Function\u7684Vendor ID\u65f6\uff0c\u5176\u5b9e\u662f\u8fd4\u56de\u4e86\u4e00\u4e2a\u72b6\u6001\u4e3aUnsupported Request\u7684\u4e0d\u643a\u5e26\u6570\u636e\u7684\u5b8c\u6210\u5305\u3002</p> <p>\u5f53\u51fa\u73b0\u8bbe\u5907\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u65f6\uff0c\u4e5f\u9700\u8981\u907f\u514d\u610f\u5916\u5730\u53d1\u9001\u9519\u8bef\u62a5\u544a\uff0c\u8fd9\u5f88\u91cd\u8981\u3002\u5c3d\u7ba1\u8fd9\u79cd\u8d85\u65f6\u6216\u8005UR\u7684\u7ed3\u679c\u5728\u7cfb\u7edf\u6b63\u5e38\u8fd0\u884c\u662f\u786e\u5b9e\u662f\u51fa\u9519\u7684\u60c5\u51b5\uff0c\u4f46\u662f\u5728\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u5b83\u5e76\u4e0d\u80fd\u88ab\u8ba4\u4e3a\u662f\u9519\u8bef\uff0c\u5b83\u662f\u4e00\u79cd\u6b63\u5e38\u7684\u53ef\u4ee5\u9884\u6599\u5230\u7684\u7ed3\u679c\u3002\u4e3a\u4e86\u80fd\u66f4\u7b80\u5355\u7684\u907f\u514d\u8fd9\u79cd\u6df7\u4e71\uff0c\u8bbe\u5907\u4eec\u4e00\u822c\u5728\u8fd9\u8fc7\u7a0b\u4e2d\u90fd\u4e0d\u542f\u7528\u9519\u8bef\u4fe1\u53f7\uff0c\u76f4\u5230\u679a\u4e3e\u5b8c\u6210\u624d\u542f\u7528\u3002\u5bf9\u4e8ePCIe\u6765\u8bf4\uff0c\u8bb0\u5f55\u8fd9\u79cd\u4e8b\u4ef6\uff08\u76ee\u6807\u8bbe\u5907\u4e0d\u5b58\u5728\uff09\u4ecd\u7136\u662f\u6709\u4f5c\u7528\u7684\uff0c\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48PCIe\u80fd\u529b\u5bc4\u5b58\u5668\u5757\uff08PCIe Capability register block\uff09\u4e2d\u5b58\u5728\u7b2c4\u4e2a\u201c\u9519\u8bef\u201d\u72b6\u6001\u4f4d\uff0c\u88ab\u79f0\u4e3aUnsupported Request Status\u4e0d\u53d7\u652f\u6301\u7684\u8bf7\u6c42\u72b6\u6001\uff08\u66f4\u591a\u5173\u4e8e\u8fd9\u90e8\u5206\u7684\u5185\u5bb9\u8bf7\u89c1\u201cEnabling/Disabling Error Reporting\u201d\u4e00\u8282\uff09\u3002\u7531\u4e8e\u6709\u8fd9\u4e2a\u72b6\u6001\u4f4d\u7684\u5b58\u5728\uff0c\u53d1\u751f\u76ee\u6807\u8bbe\u5907\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u5c31\u53ef\u4ee5\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u800c\u4e14\u4e0d\u4f1a\u88ab\u5f53\u505a\u662f\u4e00\u4e2a\u9519\u8bef\uff0c\u8fd9\u4e00\u70b9\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u82e5\u68c0\u6d4b\u5230\u4e00\u4e2a\u9519\u8bef\u90a3\u4e48\u679a\u4e3e\u8fc7\u7a0b\u5c06\u88ab\u505c\u6b62\u5e76\u8c03\u7528\u7cfb\u7edf\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u3002\u5728\u679a\u4e3e\u8fd8\u6ca1\u8fdb\u884c\u5b8c\u7684\u8fd9\u4e2a\u65f6\u95f4\u6bb5\uff0c\u9519\u8bef\u5904\u7406\u8f6f\u4ef6\u7684\u80fd\u529b\u53ef\u80fd\u5341\u5206\u6709\u9650\uff0c\u4f7f\u5f97\u95ee\u9898\u65e0\u6cd5\u88ab\u89e3\u51b3\u3002\u8fd9\u5c06\u9020\u6210\u679a\u4e3e\u8f6f\u4ef6\u8fd0\u884c\u5931\u8d25\uff0c\u56e0\u4e3a\u901a\u5e38\u662f\u5728\u64cd\u4f5c\u7cfb\u7edf\uff08OS\uff09\u6216\u8005\u5176\u4ed6\u9519\u8bef\u5904\u7406\u8f6f\u4ef6\u53ef\u7528\u4e4b\u524d\u5c31\u5df2\u7ecf\u6267\u884c\u679a\u4e3e\u8f6f\u4ef6\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u98ce\u9669\uff0c\u5728\u679a\u4e3e\u671f\u95f4\uff0c\u901a\u5e38\u4e0d\u5e94\u8be5\u62a5\u544a\u9519\u8bef\u3002</p>"},{"location":"pcie/all/#31112-device-not-ready","title":"3.11.1.2 \u8bbe\u5907\u672a\u51c6\u5907\u597d\uff08Device not Ready\uff09","text":"<p>\u524d\u9762\u63d0\u5230\u7684\u53ef\u80fd\u4f1a\u53d1\u751f\u7684\u53e6\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u76ee\u6807\u8bbe\u5907\u867d\u7136\u5b58\u5728\uff0c\u4f46\u662f\u53ef\u80fd\u5e76\u672a\u51c6\u5907\u597d\u54cd\u5e94\u914d\u7f6e\u8bbf\u95ee\u3002\u5bf9\u4e8e\u914d\u7f6e\u64cd\u4f5c\u6765\u8bf4\uff0c\u9700\u8981\u8003\u8651\u53d1\u8d77\u914d\u7f6e\u7684\u65f6\u95f4\u70b9\uff0c\u56e0\u4e3a\u8bbe\u5907\u51c6\u5907\u597d\u88ab\u8bbf\u95ee\u662f\u9700\u8981\u65f6\u95f4\u7684\u3002\u5982\u679c\u6570\u636e\u901f\u7387\u5c0f\u4e8e\u7b49\u4e8e5.0GT/s\uff0c\u8f6f\u4ef6\u5fc5\u987b\u5728\u590d\u4f4d\u540e\u7b49\u5f85100ms\u518d\u53d1\u8d77\u914d\u7f6e\u8bf7\u6c42\u3002\u5982\u679c\u6570\u636e\u901f\u7387\u9ad8\u4e8e5.0GT/s\uff08Gen3\u901f\u7387\uff09\uff0c\u8f6f\u4ef6\u5fc5\u987b\u5728\u94fe\u8def\u8bad\u7ec3\uff08Link Training\uff09\u5b8c\u6210100ms\u4e4b\u540e\u518d\u5c1d\u8bd5\u53d1\u8d77\u914d\u7f6e\u64cd\u4f5c\u3002\u4e4b\u6240\u4ee5\u66f4\u9ad8\u7684\u901f\u7387\u9700\u8981\u66f4\u591a\u7684\u5ef6\u65f6\uff08Gen3\u9700\u8981\u5728\u94fe\u8def\u8bad\u7ec3\u5b8c\u6210\u540e\u7b49\u5f85100ms\u800c\u4e0d\u662f\u590d\u4f4d\u5b8c\u6210\u7b49\u5f85100ms\uff09\uff0c\u8fd9\u662f\u56e0\u4e3aGen3\u7684\u94fe\u8def\u8bad\u7ec3\u4e2d\u7684\u5747\u8861\u8fc7\u7a0b\uff08Equalization Process\uff09\u53ef\u80fd\u9700\u8981\u6bd4\u8f83\u957f\u7684\u65f6\u95f4\uff08\u7ea650ms\uff0c\u5173\u4e8e\u8fd9\u91cc\u7684\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cLink Equalization Overview\u201d\u4e00\u8282\uff09\u3002</p> <p>\u5728PCI 2.3\u4e2d\u5b9a\u4e49\u4e86\u521d\u59cb\u5316\u65f6\u95f4\uff08Initialization Time\uff0cTrhfa-\u4ece\u590d\u4f4d\u88ab\u7f6e\u4e3a\u9ad8\u91ca\u653e\u5230\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u6240\u7ecf\u5386\u7684\u65f6\u95f4\uff09\uff0c\u521d\u59cb\u5316\u65f6\u95f4\u8d77\u59cb\u4e8eRST#\u88ab\u7f6e\u4e3a\u65e0\u6548\uff0c\u7ed3\u675f\u4e8e225\u4e2aPCI\u65f6\u949f\u5468\u671f\u4e4b\u540e\u3002\u8fd9\u76f8\u5f53\u4e8e\u6574\u6574\u4e00\u79d2\u949f\uff0c\u5728\u8fd9\u4e00\u79d2\u5185\uff0cFunction\u6b63\u5728\u4e3a\u54cd\u5e94\u5b83\u7684\u7b2c\u4e00\u6b21\u914d\u7f6e\u8bbf\u95ee\u505a\u51c6\u5907\uff0c\u5e76\u4e14\u8fd9\u4e2a\u65f6\u95f4\u503c\u4e5f\u88abPCIe\u6240\u4f7f\u7528\uff0c\u5728PCIe\u4e2d\u4e3a1.0s\uff08+50%/-0%\uff09\u3002\u4e00\u4e2aFunction\u53ef\u4ee5\u5229\u7528\u8fd9\u6bb5\u65f6\u95f4\u6765\u586b\u5145\u81ea\u5df1\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\uff0c\u4f8b\u5982\u8fd9\u4e00\u8fc7\u7a0b\u53ef\u4ee5\u901a\u8fc7\u52a0\u8f7d\u4e00\u4e2a\u5916\u6302\u7684\u4e32\u884cEEPROM\u7684\u5185\u5bb9\u6765\u5b9e\u73b0\u3002\u52a0\u8f7dEEPROM\u5185\u5bb9\u9700\u8981\u82b1\u8d39\u4e00\u70b9\u65f6\u95f4\uff0c\u5728\u8fd9\u6bb5\u65f6\u95f4\u5185Function\u90fd\u6ca1\u6709\u51c6\u5907\u597d\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\uff0c\u76f4\u5230\u52a0\u8f7d\u5b8c\u6210\u3002\u5728PCI\u4e2d\uff0c\u82e5\u5728Function\u51c6\u5907\u597d\u4e4b\u524d\u5c31\u6536\u5230\u4e86\u4e00\u4e2a\u914d\u7f6e\u8bbf\u95ee\uff0c\u90a3\u4e48\u5b83\u6709\u4e09\u4e2a\u9009\u62e9\uff1a\u5ffd\u7565\u8fd9\u4e2a\u8bf7\u6c42\u3001\u91cd\u8bd5\uff08Retry\uff09\u8fd9\u4e2a\u8bf7\u6c42\u3001\u63a5\u6536\u8fd9\u4e2a\u8bf7\u6c42\u4f46\u662f\u5ef6\u671f\u54cd\u5e94\u76f4\u5230Function\u81ea\u8eab\u5b8c\u5168\u51c6\u5907\u597d\u4e3a\u6b62\u3002\u6700\u540e\u4e00\u79cd\u9009\u62e9\u7684\u54cd\u5e94\u53ef\u80fd\u4f1a\u7ed9\u70ed\u63d2\u62d4\uff08Hot-plug\uff09\u7cfb\u7edf\u5e26\u6765\u9ebb\u70e6\uff0c\u56e0\u4e3a\u5ef6\u671f\u54cd\u5e94\u7684\u65f6\u957f\u53ef\u80fd\u4f1a\u8fbe\u52301s\uff0c\u5728\u8fd91s\u4e2d\u603b\u7ebf\u90fd\u662f\u505c\u6b62\u7684\uff0c\u76f4\u5230\u8fd9\u4e2a\u8bf7\u6c42\u88ab\u6267\u884c\u5b8c\uff0c\u603b\u7ebf\u624d\u91cd\u65b0\u6d3b\u52a8\u8d77\u6765\u3002</p> <p>\u5728PCIe\u4e2d\u6211\u4eec\u4e5f\u9762\u4e34\u7740\u76f8\u540c\u7684\u95ee\u9898\uff0c\u4f46\u662f\u95ee\u9898\u7684\u8fc7\u7a0b\u6709\u4e00\u70b9\u4e0d\u540c\u3002\u9996\u5148\uff0cPCIe Function\u5728\u4e34\u65f6\u65e0\u6cd5\u54cd\u5e94\u914d\u7f6e\u8bbf\u95ee\u65f6\u5fc5\u987b\u8981\u7ed9\u51fa\u4e00\u4e2a\u5b8c\u6210\u5305\uff0c\u8fd9\u4e2a\u5b8c\u6210\u5305\u4e5f\u8981\u88ab\u7f6e\u4e3a\u6307\u5b9a\u7684\u72b6\u6001\uff0c\u8fd9\u4e2a\u72b6\u6001\u4e3aConfiguration Request Retry Status\uff08CRS\uff0c\u914d\u7f6e\u8bf7\u6c42\u91cd\u8bd5\u72b6\u6001\uff09\u3002\u8fd9\u4e2a\u72b6\u6001\u53ea\u6709\u5728\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\u7684\u65f6\u5019\u624d\u662f\u5408\u6cd5\u7684\uff0c\u5982\u679c\u5176\u4ed6\u7684\u8bf7\u6c42\u6536\u5230\u4e86\u8fd9\u4e2a\u72b6\u6001\u7684\u5b8c\u6210\u5305\uff0c\u5219\u53ef\u80fd\u4f1a\u8ba4\u4e3a\u6570\u636e\u5305\u683c\u5f0f\u9519\u8bef\uff08Malformed Packet error\uff09\u3002\u8fd9\u79cd\u72b6\u6001\u7684\u54cd\u5e94\u4e5f\u53ea\u5728\u590d\u4f4d\u540e\u76841\u79d2\u540e\u6709\u6548\uff0c\u56e0\u4e3a\u57281\u79d2\u4e4b\u540eFunction\u5c31\u88ab\u8ba4\u4e3a\u662f\u53ef\u4ee5\u6b63\u5e38\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\u4e86\uff0c\u5982\u679c1\u79d2\u4e4b\u540e\u8fd9\u4e2aFunction\u90fd\u8fd8\u65e0\u6cd5\u6b63\u5e38\u54cd\u5e94\u914d\u7f6e\u8bf7\u6c42\u90a3\u4e48\u5c31\u8ba4\u4e3a\u5b83\u5df2\u7ecf\u635f\u574f\u4e86\u3002</p> <p>\u9664\u4e86\u7cfb\u7edf\u590d\u4f4d\u4e4b\u540e\u7684\u90a3\u4e00\u6bb5\u65f6\u95f4\u4e4b\u5916\uff0cRC\u5904\u7406\u914d\u7f6e\u8bfb\u8bf7\u6c42\u7684CRS\uff08\u914d\u7f6e\u91cd\u8bd5\u72b6\u6001\uff09\u5b8c\u6210\u5305\u7684\u65b9\u5f0f\u662f\u7279\u5b9a\u5b9e\u73b0\u7684\u800c\u4e0d\u662f\u901a\u7528\u7684\u3002\u800c\u5728\u7cfb\u7edf\u590d\u4f4d\u540e\u7684\u90a3\u4e00\u5c0f\u6bb5\u65f6\u95f4\u91cc\uff0cRC\u6709\u4e24\u4e2a\u53ef\u4ee5\u8fdb\u884c\u7684\u64cd\u4f5c\u4f9b\u9009\u62e9\uff0c\u9009\u62e9\u54ea\u4e00\u79cd\u5219\u53d6\u51b3\u4e8eRoot\u63a7\u5236\u5bc4\u5b58\u5668\uff08Root Control Register\uff09\u4e2dCRS Software Visibility\u8fd9\u4e00bit\u7684\u503c\uff08\u5982\u56fe 3\u201111\uff09\u3002</p> <p></p> <p>\u56fe 3\u201111 PCIe\u80fd\u529b\u5757\u4e2d\u7684Root\u63a7\u5236\u5bc4\u5b58\u5668</p> <p>n \u5982\u679c\u8fd9\u4e2abit\u88ab\u7f6e\u4e3a1\uff0c\u800c\u4e14\u53d1\u51fa\u7684\u8bf7\u6c42\u662f\u914d\u7f6e\u8bfb\u8bf7\u6c42\uff0c\u8981\u8bfb\u53d6Vendor ID\u5bc4\u5b58\u5668\u7684\u5168\u90e8\u4e24\u4e2abyte\uff08\u679a\u4e3e\u8fc7\u7a0b\u901a\u8fc7\u8fd9\u6837\u7684\u64cd\u4f5c\u6765\u641c\u7d22\u53d1\u73b0\u4e00\u4e2aFunction\u662f\u5426\u5b58\u5728\uff09\uff0c\u90a3\u4e48\u5728\u63a5\u6536\u5230CRS\u5b8c\u6210\u5305\u65f6RC\u9700\u8981\u7ed9Host\u8fd4\u56de\u4f2a\u9020\u76840001h\u4f5c\u4e3a\u8bfb\u53d6\u7684\u5bc4\u5b58\u5668\u503c\uff0c\u5e76\u5c06\u5176\u4ed6\u7684\u6240\u6709\u5b57\u8282\u90fd\u7f6e\u4e3a\u51681\u3002\u8fd9\u4e2aVendor ID\u5e76\u6ca1\u6709\u88ab\u4efb\u4f55\u771f\u5b9e\u7684\u8bbe\u5907\u6240\u4f7f\u7528\uff0c\u8f6f\u4ef6\u5c06\u628a\u8fd9\u4e2a0001h\u7684Vendor ID\u7406\u89e3\u4e3a\u8bbf\u95ee\u8fd9\u4e2a\u8bbe\u5907\u53ef\u80fd\u9700\u8981\u5f88\u957f\u7684\u5ef6\u8fdf\u3002\u8fd9\u4e2a\u4fe1\u606f\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u9009\u62e9\u53bb\u6267\u884c\u5176\u4ed6\u7684\u4efb\u52a1\uff0c\u66f4\u5145\u5206\u7684\u5229\u7528\u8fd9\u6bb5\u7b49\u5f85\u8bbe\u5907\u54cd\u5e94\u7684\u65f6\u95f4\uff0c\u7a0d\u540e\u518d\u8fd4\u56de\u6765\u67e5\u8be2\u8fd9\u4e2a\u8bbe\u5907\u3002\u8981\u8fdb\u884c\u8fd9\u6837\u5b50\u7684\u64cd\u4f5c\uff0c\u8f6f\u4ef6\u5fc5\u987b\u786e\u4fdd\u5176\u5728\u590d\u4f4d\u540e\u5bf9Function\u7684\u7b2c\u4e00\u6b21\u8bbf\u95ee\u5c31\u662f\u8bfb\u53d62 byteVendor ID\u7684\u914d\u7f6e\u8bfb\u8bbf\u95ee\u3002</p> <p>n \u5bf9\u4e8e\u914d\u7f6e\u5199\u8bbf\u95ee\u6216\u8005\u662f\u5176\u4ed6\u7684\u914d\u7f6e\u8bfb\u8bbf\u95ee\uff08\u5e76\u4e0d\u662f\u8bfb2byte Vendor ID\uff09\uff0cRC\u5fc5\u987b\u81ea\u52a8\u5730\u4ee5\u4e00\u4e2a\u65b0\u8bf7\u6c42\u7684\u5f62\u5f0f\u5bf9\u4e4b\u524d\u7684\u914d\u7f6e\u8bf7\u6c42\u8fdb\u884c\u91cd\u65b0\u4e0b\u8fbe\u3002</p>"},{"location":"pcie/all/#3112-functionepbridge","title":"3.11.2    \u786e\u8ba4\u67d0\u4e2aFunction\u662fEP\u8fd8\u662fBridge","text":"<p>\u679a\u4e3e\u8fc7\u7a0b\u7684\u4e00\u4e2a\u5173\u952e\u90e8\u5206\u5c31\u662f\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2aFunction\u662fBridge\u8fd8\u662fEP\u3002\u5982\u56fe 3\u201112\u6240\u793a\uff0cHeader\u7c7b\u578b\u5bc4\u5b58\u5668\uff08Header Type Register\uff0c\u4f4d\u4e8e\u914d\u7f6e\u7a7a\u95f4Header\u7684\u504f\u79fb\u5730\u57400Eh\uff09\u7684\u4f4e7bit\u7528\u4e8e\u6807\u8bc6\u8fd9\u4e2aFunction\u7684\u57fa\u672c\u79cd\u7c7b\uff0c\u603b\u5171\u5b9a\u4e49\u4e86\u4e09\u79cd\u4e0d\u540c\u7684\u503c\uff1a</p> <p>n 0 = \u4e0d\u662f\u4e00\u4e2aBridge\uff08\u90a3\u4e5f\u5c31\u662f\u4e00\u4e2aPCIe EP\uff09</p> <p>n 1 = PCI-to-PCI Bridge\uff08\u7f29\u5199\u4e3aP2P\uff09\uff0c\u7528\u4e8e\u8fde\u63a5\u4e24\u6761\u603b\u7ebf</p> <p>n 2 = \u63d2\u4ef6\u5361Bridge\uff08CardBus Bridge\uff0c\u73b0\u5728\u5f88\u5c11\u4f7f\u7528\u7684\u9057\u7559\u63a5\u53e3\uff09</p> <p>\u5728\u56fe 3\u20111\u4e2d\uff0c\u6bcf\u4e2a\u865a\u62dfP2P\u7684Header Type\u5b57\u6bb5\uff08DW3\uff0cbyte2\uff09\u7684\u8fd4\u56de\u503c\u90fd\u4e3a1\uff0c\u4e14PCI Express-to-PCI Bridge\uff08Bus 8\uff0cDevice 0\uff09\u7684Header Type\u5b57\u6bb5\u4e5f\u5c06\u8fd4\u56de1\u3002\u4f46\u662f\u5bf9\u4e8eEP\u6765\u8bf4\uff0c\u5b83\u8fd4\u56de\u7684Header Type\u5b57\u6bb5\u662f0\u3002</p> <p></p> <p>\u56fe 3\u201112 Header\u7c7b\u578b\u5bc4\u5b58\u5668</p>"},{"location":"pcie/all/#312-rcsingle-root-enumeration-example","title":"3.12     \u5355RC\u679a\u4e3e\u793a\u4f8b\uff08Single Root Enumeration Example\uff09","text":"<p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u4f8b\u5b50\u6765\u8ba8\u8bba\u4e00\u4e0b\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u7684\u57fa\u672c\u8981\u7d20\u3002\u5982\u56fe 3\u201113\u5c55\u793a\u4e86\u4e00\u4e2a\u7ecf\u8fc7\u603b\u7ebf\u3001\u8bbe\u5907\u679a\u4e3e\u540e\u7684\u7cfb\u7edf\u793a\u4f8b\u3002\u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u57fa\u4e8e\u8fd9\u6837\u7684\u5047\u8bbe\uff1a\u914d\u7f6e\u8f6f\u4ef6\u5c06\u4f7f\u7528\u672c\u7ae0\u8282\u5b9a\u4e49\u7684\u4e24\u79cd\u914d\u7f6e\u8bbf\u95ee\u673a\u5236\u4e2d\u7684\u4e00\u79cd\u6765\u5b8c\u6210\u679a\u4e3e\u8fc7\u7a0b\u3002\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0c\u5904\u7406\u5668\u4e0a\u6267\u884c\u7684\u914d\u7f6e\u8f6f\u4ef6\u5c06\u5982\u63a5\u4e0b\u6765\u6240\u8bb2\u8ff0\u7684\u90a3\u6837\u6765\u8fdb\u884c\u679a\u4e3e\u8fc7\u7a0b\u3002</p> <p>\\1.    \u8f6f\u4ef6\u5c06Host/PCI Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09\u66f4\u65b0\u4e3a0\uff0c\u5e76\u5c06\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09\u66f4\u65b0\u4e3a255\u3002\u4e4b\u6240\u4ee5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u6700\u5927\u503c\u662f\u56e0\u4e3aSub Num\u53ef\u4ee5\u8fd9\u6837\u4e00\u76f4\u4fdd\u6301\u4e0d\u53d8\uff0c\u76f4\u5230Host/PCI Bridge\u4e0b\u65b9\u7684\u6240\u6709\u603b\u7ebf\u90fd\u88ab\u8bc6\u522b\u51fa\u6765\uff0c\u7136\u540e\u518d\u66f4\u65b0\u6210\u51c6\u786e\u7684\u503c\u3002\u5728\u6b64\u65f6\u6b64\u523b\uff0c\u6682\u4e14\u8ba4\u4e3a\u5728Host/PCI Bridge\u4e0b\u65b9\u8bc6\u522b\u5230\u7684\u603b\u7ebf\u8303\u56f4\u4e3aBus 0\u5230255\u3002</p> <p>\\2.    \u4eceDevice 0\u5f00\u59cb\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4f1a\u5c1d\u8bd5\u53bb\u8bfb\u53d6Bus 0\u4e0a\u768432\u4e2a\u53ef\u80fd\u5b58\u5728\u7684Device\uff0c\u8bfb\u53d6\u7684\u5185\u5bb9\u4e3a\u5b83\u4eec\u5404\u81ea\u7684Function\u4e2d\u7684Vendor ID\u3002\u5982\u679cBus 0\u2014Device 0\u2014Function 0\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u90a3\u4e48\u5c31\u8ba4\u4e3a\u8fd9\u4e2a\u8bbe\u5907\u5b58\u5728\u5e76\u81f3\u5c11\u542b\u6709\u4e00\u4e2aFunction\u3002\u82e5Bus 0\u2014Device 0\u2014Function 0\u6ca1\u6709\u8fd4\u56de\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u5219\u7ee7\u7eed\u53bb\u63a2\u6d4bBus 0\u2014Device 1\u2014Function 0\u3002</p> <p>\\3.    \u5728\u672c\u4f8b\u4e2d\u7684\u503c\u4e3a1\u7684Header Type\u5b57\u6bb5\uff08\u5982\u56fe 3\u201112\uff09\u8868\u793a\u8fd9\u662f\u4e00\u4e2aPCI-to-PCI Bridge\u3002Header Type\u5bc4\u5b58\u5668\u4e2d\u7684Multifunction\u4f4d\uff08bit 7\uff09\u4e3a0\uff0c\u8fd9\u8868\u793aFunction 0\u5c31\u662f\u8fd9\u4e2aBridge\u4e2d\u552f\u4e00\u7684Function\u3002\u534f\u8bae\u89c4\u8303\u5176\u5b9e\u5e76\u6ca1\u6709\u963b\u6b62\u5728Bridge\u8fd9\u6837\u7684\u8bbe\u5907\u4e2d\u53bb\u5b9e\u73b0\u591a\u4e2aFunction\uff0c\u76f8\u53cd\u5730\uff0c\u5f53\u6709\u591a\u4e2aFunction\u65f6\u6bcf\u4e2aFunction\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u53c8\u4e00\u4e2a\u865a\u62dfPCI-to-PCI Bridge\uff0c\u751a\u81f3\u8fd8\u53ef\u4ee5\u662f\u4e00\u4e2a\u975eBridge\u7684Function\u3002</p> <p>\\4.    \u73b0\u5728\u8f6f\u4ef6\u5df2\u7ecf\u627e\u5230\u4e86\u4e00\u4e2aBridge\uff0c\u5e76\u6267\u884c\u4e86\u4e00\u7cfb\u5217\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=0</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=1</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\u73b0\u5728\uff0c\u8fd9\u4e2aBridge\u5c31\u8ba4\u4e3a\u5728\u5b83\u4e0b\u65b9\u76f4\u63a5\u76f8\u8fde\u7684\u603b\u7ebf\u7684\u7f16\u53f7\u4e3a1\uff08\u6b21\u7ea7\u603b\u7ebf\u53f7=1\uff09\uff0c\u5b83\u4e0b\u65b9\u4ece\u5c5e\u7684\u6700\u5927\u603b\u7ebf\u53f7\u662f255\uff08\u4ece\u5c5e\u603b\u7ebf\u53f7=255\uff09\u3002</p> <p>\\5.    \u679a\u4e3e\u8f6f\u4ef6\u5fc5\u987b\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\uff08depth-first\uff09\u7684\u641c\u7d22\u3002\u5728\u7ee7\u7eed\u53d1\u73b0Bus 0\u4e0a\u7684\u5176\u4ed6Device/Function\u4e4b\u524d\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5fc5\u987b\u5148\u641c\u7d22Bus 1\u3002</p> <p>\\6.    \u8f6f\u4ef6\u8bfb\u53d6Bus 1\u2014Device 0\u2014Function 0\u7684Vendor ID\uff0c\u8fd9\u4e2a\u76ee\u6807\u8bbe\u5907\u5728\u6211\u4eec\u7684\u793a\u4f8b\u56fe 3\u201113\u4e2d\u4e3aBridge C\u3002\u8fd9\u6b21\u8bfb\u53d6\u5c06\u8fd4\u56de\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8fd9\u8868\u793a\u5728Bus 1\u4e0a\u5b58\u5728Device 0\u2014Function 0\u3002</p> <p>\\7.    \u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a1\uff080000001b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u53c8\u4e00\u4e2aPCI-to-PCI Bridge\u3002\u50cf\u4e4b\u524d\u4e00\u6837\uff0cbit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2aBridge C\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> <p>\\8.    \u8f6f\u4ef6\u73b0\u5728\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge C\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=1</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=2</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\9.    \u8f6f\u4ef6\u7ee7\u7eed\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\u7684\u641c\u7d22\uff08depth-first search\uff09\uff0c\u8bfb\u53d6Bus 2\u2014Device 0\u2014Function 0\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 2\u4e0a\u7684Device 0\u2014Function 0\u662fBridge D\u3002</p> <p>\\10.  \u8bfb\u8bf7\u6c42\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 2\u2014Device 0\u2014Function 0\u5b58\u5728\u3002</p> <p>\\11.  \u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a1\uff080000001b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u53c8\u4e00\u4e2aPCI-to-PCI Bridge\uff0c\u4e14bit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2aBridge D\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> <p>\\12.  \u8f6f\u4ef6\u73b0\u5728\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge D\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=2</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=3</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\13.  \u7ee7\u7eed\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\u7684\u641c\u7d22\uff08depth-first search\uff09\uff0c\u8bfb\u53d6Bus 3\u2014Device 0\u2014Function 0\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 2\u4e0a\u7684Device 0\u2014Function 0\u662fBridge D\u3002</p> <p>\\14.  \u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 3\u2014Device 0\u2014Function 0\u5b58\u5728\u3002</p> <p>\\15.  \u8fd9\u6b21\u6709\u4e86\u4e0d\u540c\uff0c\u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a0\uff080000000b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u4e00\u4e2aEndpoint Function\uff08EP\uff09\u3002\u7531\u4e8e\u8fd9\u4e2aFunction\u662f\u4e00\u4e2aEP\u800c\u4e0d\u662f\u4e00\u4e2aBridge\uff0c\u5b83\u6709\u4e00\u4e2aType 0 Header\uff0c\u4e14\u5728\u8fd9\u4e2aEP\u4e4b\u4e0b\u5c31\u6ca1\u6709\u522b\u7684PCI\u517c\u5bb9\u603b\u7ebf\u4e86\uff08PCI-Compatible Bus\uff09\u3002\u8fd9\u4e2aEP\u7684bit 7\u7684\u503c\u4e3a1\uff08Multifunction bit=1\uff09\uff0c\u8868\u793a\u8fd9\u4e2aEP\u662f\u4e00\u4e2a\u591aFunction\u8bbe\u5907\u3002</p> <p>\\16.  \u679a\u4e3e\u8f6f\u4ef6\u5bf9Bus 3\u2014Device 0\u4e0a\u7684\u5168\u90e8\u53ef\u80fd\u76848\u4e2aFunction\u8fdb\u884c\u8bbf\u95ee\uff0c\u8bbf\u95ee\u5b83\u4eec\u5404\u81ea\u7684Vendor ID\uff0c\u7136\u540e\u8f6f\u4ef6\u786e\u8ba4\u9664\u4e86Function 0\u4e4b\u5916\u53ea\u5b58\u5728Function 1\u3002Function 1\u4e5f\u662f\u4e00\u4e2aEP\uff08Type 0 Header\uff09\uff0c\u56e0\u6b64\u5728\u8fd9\u4e2a\u8bbe\u5907\uff08Bus 3\u2014Device 0\uff09\u4e4b\u4e0b\u5e76\u4e0d\u5b58\u5728\u4e00\u4e2a\u9644\u52a0\u7684\u603b\u7ebf\u3002</p> <p>\\17.  \u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 3\u4e0a\u8fdb\u884c\u626b\u63cf\uff0c\u5bfb\u627eDevice 1\u5230Device 31\u4e0a\u6709\u6548\u7684Function\uff0c\u7136\u800c\u5e76\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u5176\u4ed6\u7684Function\u3002</p> <p>\\18.  \u679a\u4e3e\u8f6f\u4ef6\u5b8c\u6210\u4e86\u5bfb\u627eBridge D\u4e4b\u4e0b\u6240\u6709Function\u7684\u4efb\u52a1\u4e4b\u540e\uff0c\u5c31\u4f1a\u66f4\u65b0Bridge D\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u5c06\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c3\u3002\u7136\u540e\uff0c\u679a\u4e3e\u8f6f\u4ef6\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 2\uff09\uff0c\u5e76\u7ee7\u7eed\u5728\u8fd9\u4e2a\u603b\u7ebf\u4e0a\u626b\u63cf\uff0c\u5bfb\u627e\u6709\u6548\u7684Function\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 3\u4e0a\u7684Device 1\u2014Function 0\u662fBridge E\u3002</p> <p>\\19.  \u914d\u7f6e\u8bfb\u8bf7\u6c42\u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 2\u2014Device 1\u2014Function 0\u5b58\u5728\u3002</p> <p>\\20.  \u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a1\uff080000001b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u53c8\u4e00\u4e2aPCI-to-PCI Bridge\uff0c\u4e14bit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2aBridge E\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> <p>\\21.  \u8f6f\u4ef6\u73b0\u5728\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge E\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=2</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=4</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\22.  \u8f6f\u4ef6\u7ee7\u7eed\u8fdb\u884c\u6df1\u5ea6\u4f18\u5148\u7684\u641c\u7d22\uff08depth-first search\uff09\uff0c\u8bfb\u53d6Bus 4\u2014Device 0\u2014Function 0\u7684Vendor ID\u3002</p> <p>\\23.  \u8fd4\u56de\u4e86\u4e00\u4e2a\u6709\u6548\u7684Vendor ID\uff0c\u8868\u793aBus 4\u2014Device 0\u2014Function 0\u5b58\u5728\u3002</p> <p>\\24.  \u5728Header\u5bc4\u5b58\u5668\u4e2d\u7684Header Type\u5b57\u6bb5\u7684\u503c\u4e3a0\uff080000000b\uff09\uff0c\u8fd9\u8868\u793a\u5b83\u662f\u4e00\u4e2aEP\u8bbe\u5907\uff0c\u4e14bit 7\u7684\u503c\u4e3a0\uff08Multifunction bit=0\uff09\uff0c\u8868\u793a\u8fd9\u4e2a\u8bbe\u5907\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002</p> <p>\\25.  \u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 4\u4e0a\u8fdb\u884c\u626b\u63cf\uff0c\u5bfb\u627eDevice 1\u5230Device 31\u4e0a\u6709\u6548\u7684Function\uff0c\u7136\u800c\u5e76\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u5176\u4ed6\u7684Function\u3002</p> <p>\\26.  \u679a\u4e3e\u8f6f\u4ef6\u5df2\u7ecf\u5230\u8fbe\u4e86\u8fd9\u4e2a\u641c\u7d22\u5206\u652f\u7684\u5e95\u90e8\uff0c\u56e0\u6b64\u5b83\u4f1a\u66f4\u65b0\u5f53\u524d\u603b\u7ebf\u4e4b\u4e0a\u76f8\u8fde\u7684Bridge\uff0c\u5728\u8fd9\u91cc\u4e3aBridge E\uff0c\u5c06\u5176\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c4\u3002\u7136\u540e\uff0c\u679a\u4e3e\u8f6f\u4ef6\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 2\uff09\uff0c\u5e76\u7ee7\u7eed\u8bfb\u53d6\u8be5\u603b\u7ebf\u4e0a\u7684\u4e0b\u4e00\u4e2a\u8bbe\u5907\uff08Device 2\uff09\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 2\u4e0a\u5e76\u6ca1\u6709\u5b9e\u73b0Device 2\u5230Device 31\uff0c\u56e0\u6b64\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4e0d\u4f1a\u53d1\u73b0Bus 2\u4e0a\u8fd8\u6709\u5176\u4ed6\u7684\u8bbe\u5907\uff0c\u4ec5\u6709Device 0\u548cDevice 1\u3002</p> <p>\\27.  \u679a\u4e3e\u8f6f\u4ef6\u66f4\u65b0Bus 2\u4e4b\u4e0a\u76f8\u8fde\u7684Bridge\uff0c\u5728\u8fd9\u91cc\u4e3aBridge C\uff0c\u5c06\u5176\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c4\uff0c\u5e76\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 1\uff09\uff0c\u7ee7\u7eed\u53bb\u8bfb\u53d6\u8be5\u603b\u7ebf\u4e0a\u7684\u4e0b\u4e00\u4e2a\u8bbe\u5907\uff08Device 1\uff09\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 1\u4e0a\u5e76\u6ca1\u6709\u5b9e\u73b0Device 1\u5230Device 31\uff0c\u56e0\u6b64\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4e0d\u4f1a\u53d1\u73b0Bus 1\u4e0a\u8fd8\u6709\u5176\u4ed6\u7684\u8bbe\u5907\uff0c\u4ec5\u6709Device 0\u3002</p> <p>\\28.  \u679a\u4e3e\u8f6f\u4ef6\u66f4\u65b0Bus 1\u4e4b\u4e0a\u76f8\u8fde\u7684Bridge\uff0c\u5728\u8fd9\u91cc\u4e3aBridge A\uff0c\u5c06\u5176\u4ece\u5c5e\u603b\u7ebf\u53f7\u4ece\u9884\u7559\u7684255\u66f4\u65b0\u4e3a\u771f\u5b9e\u503c4\uff0c\u5e76\u56de\u5230\u4e0a\u4e00\u4e2a\u603b\u7ebf\u5c42\u7ea7\uff08Bus 0\uff09\uff0c\u7ee7\u7eed\u53bb\u8bfb\u53d6\u8be5\u603b\u7ebf\u4e0a\u7684\u4e0b\u4e00\u4e2a\u8bbe\u5907\uff08Device 1\uff09\u7684Vendor ID\u3002\u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201113\uff09\uff0cBus 0\u4e0a\u7684Device 1\u2014Function 0\u662fBridge B\u3002</p> <p>\\29.  \u5982\u524d\u9762\u6240\u8ff0\u7684\u76f8\u540c\u7684\u8fc7\u7a0b\uff0c\u679a\u4e3e\u8f6f\u4ef6\u53d1\u73b0Bridge B\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge B\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=0</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=5</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\30.  \u7136\u540e\u679a\u4e3e\u8f6f\u4ef6\u53c8\u5728Bus 5\u4e0a\u53d1\u73b0Bridge F\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge F\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=5</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=6</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\31.  \u63a5\u7740\u679a\u4e3e\u8f6f\u4ef6\u53c8\u5728Bus 6\u4e0a\u53d1\u73b0Bridge G\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge G\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=6</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=7</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\32.  \u5f53\u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 7\u4e0a\u641c\u7d22\uff0c\u5b83\u53d1\u73b0\u4e86\u4e00\u4e2a\u5355Function\u7684EP\u8bbe\u5907\uff0cBus 7\u2014Device 0\u2014Function 0\uff0c\u56e0\u6b64\u5c06Bridge G\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u66f4\u65b0\u4e3a7\u3002</p> <p>\\33.  \u679a\u4e3e\u8f6f\u4ef6\u5411\u4e0a\u56de\u5230Bus 6\u7ee7\u7eed\u8fdb\u884c\u641c\u7d22\uff0c\u7136\u540e\u5b83\u53d1\u73b0\u4e86Bridge H\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge H\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=6</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=8</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\34.  \u7136\u540e\u679a\u4e3e\u8f6f\u4ef6\u53c8\u5728Bus 8\u4e0a\u53d1\u73b0Bridge J\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge J\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=8</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=9</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\35.  Bus 9\u4e0a\u7684\u6240\u6709\u8bbe\u5907\u4ee5\u53ca\u4e0e\u5b83\u4eec\u76f8\u5173\u7684Function\u90fd\u5df2\u7ecf\u5168\u90e8\u88ab\u641c\u7d22\u5b8c\u6210\uff0c\u5b83\u4eec\u90fd\u4e0d\u662fBridge\uff0c\u56e0\u6b64\u4e0b\u65b9\u4e5f\u5c31\u6ca1\u6709\u9644\u52a0\u7684\u603b\u7ebf\uff0c\u6240\u4ee5\u5c06Bridge H\u548cBridge J\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u66f4\u65b0\u4e3a9\u3002</p> <p>\\36.  \u679a\u4e3e\u8f6f\u4ef6\u5411\u4e0a\u56de\u5230Bus 6\u7ee7\u7eed\u8fdb\u884c\u641c\u7d22\uff0c\u7136\u540e\u5b83\u53d1\u73b0\u4e86Bridge I\uff0c\u5e76\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge I\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=6</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=10</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\\37.  \u5f53\u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus 10\u4e0a\u641c\u7d22\uff0c\u5b83\u53d1\u73b0\u4e86\u4e00\u4e2a\u5355Function\u7684EP\u8bbe\u5907\uff0cBus 10\u2014Device 0\u2014Function 0\u3002</p> <p>\\38.  \u7531\u4e8e\u679a\u4e3e\u8f6f\u4ef6\u5df2\u7ecf\u5230\u8fbe\u4e86\u8fd9\u4e2a\u641c\u7d22\u5206\u652f\u7684\u5e95\u90e8\uff0c\u8fd9\u4e2a\u5e95\u90e8\u662f\u4e5f\u662f\u6574\u4e2aPCIe\u62d3\u6251\u6811\u72b6\u7ed3\u6784\u7684\u5e95\u90e8\uff0c\u56e0\u6b64Bridge B\u3001F\u3001I\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u4f1a\u88ab\u66f4\u65b0\u4e3a10\uff0c\u800cHost/PCI Bridge\u4e5f\u4f1a\u5c06\u4ece\u5c5e\u603b\u7ebf\u5bc4\u5b58\u5668\u66f4\u65b0\u4e3a\u8fd9\u4e2a\u6570\u503c\u3002</p> <p>\u6bcf\u4e2aBridge\u4e2d\u6700\u7ec8\u7684\u4e3b\u603b\u7ebf\u53f7\u3001\u6b21\u7ea7\u603b\u7ebf\u53f7\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u53ef\u4ee5\u53c2\u9605\u56fe 3\u20119\u3002</p> <p></p> <p>\u56fe 3\u201113\u5355Root\u7cfb\u7edf</p>"},{"location":"pcie/all/#313-rcmulti-root-enumeration-example","title":"3.13     \u591aRC\u679a\u4e3e\u793a\u4f8b\uff08Multi-Root Enumeration Example\uff09","text":""},{"location":"pcie/all/#3131-general","title":"3.13.1    \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u8003\u8651\u5982\u56fe 3\u201114\u6240\u793a\u7684\u591aRC\u7cfb\u7edf\u3002\u5728\u8fd9\u4e2a\u7cfb\u7edf\u4e2d\uff0c\u6bcf\u4e2aRC\uff1a</p> <p>n \u5b9e\u73b0\u4e86\u5404\u81ea\u7684\u914d\u7f6e\u5730\u5740\u7aef\u53e3\uff08Configuration Address Port\uff09\u548c\u914d\u7f6e\u6570\u636e\u7aef\u53e3\uff08Configuration Data Port\uff09\uff0c\u5e76\u4e14\u5404\u4e2aRC\u4e2d\u7684\u8fd9\u4e9b\u76f8\u5e94\u7684\u7aef\u53e3\u7684IO\u5730\u5740\u662f\u76f8\u540c\u7684\uff0c\u6bd4\u5982RC 0\u548cRC 1\u7684\u914d\u7f6e\u5730\u5740\u7aef\u53e3\u7684IO\u5730\u5740\u76f8\u540c\u3002</p> <p>n \u90fd\u5b9e\u73b0\u4e86\u589e\u5f3a\u578b\u914d\u7f6e\u673a\u5236\u3002</p> <p>n \u90fd\u5305\u542b\u4e00\u4e2aHost/PCI Bridge</p> <p>n \u5b9e\u73b0\u4e86\u5404\u81ea\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff0c\u4f46\u662f\u4e0d\u540cRC\u7684\u8fd9\u4e24\u4e2a\u5bc4\u5b58\u5668\u5bf9\u4e8e\u914d\u7f6e\u8f6f\u4ef6\u6765\u8bf4\u662f\u4e0d\u540c\u7684\u64cd\u4f5c\u5730\u5740\u3002</p> <p>\u5728\u56fe\u793a\u4e2d\uff0c\u6bcf\u4e2aRC\u90fd\u662f\u4e00\u4e2a\u82af\u7247\u7ec4\u6210\u5458\uff0c\u8fd9\u5176\u4e2d\u7684\u4e00\u4e2aRC\u88ab\u8bbe\u8ba1\u4e3a\u4e3bRC\uff0c\u5b83\u7684Bridge\u4e0b\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u4e3aBus 0\uff0c\u5b83\u88ab\u79f0\u4e3a\u4e3bRC\uff08Primary Root Complex\uff09\u3002\u800c\u53e6\u4e00\u4e2aRC\u7684Bridge\u4e0b\u65b9\u76f8\u8fde\u7684\u603b\u7ebf\u5219\u662f\u88ab\u6682\u65f6\u8ba4\u4e3a\u662fBus 255\uff0c\u5b83\u88ab\u79f0\u4e3a\u6b21\u7ea7RC\uff08Secondary Root Complex\uff09\u3002</p>"},{"location":"pcie/all/#3132-rcmulti-root-enumeration-process","title":"3.13.2    \u591aRC\u679a\u4e3e\u8fc7\u7a0b\uff08Multi-Root Enumeration Process\uff09","text":"<p>\u5728\u5bf9\u56fe 3\u201114\u4e2d\u5de6\u4fa7\u7684\u6811\u72b6\u7ed3\u6784\u8fdb\u884c\u679a\u4e3e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6b21\u7ea7RC\u7684Host/PCI Bridge\u5c06\u4f1a\u5ffd\u7565\u6240\u6709\u7684\u914d\u7f6e\u8bbf\u95ee\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u4e2d\u6700\u5927\u7684\u4e5f\u4e0d\u4f1a\u8d85\u8fc79\u3002\u9700\u8981\u6ce8\u610f\uff0c\u867d\u7136Bus 8\u88ab\u68c0\u6d4b\u5230\u4e86\u5e76\u4e14\u4e5f\u88ab\u7f16\u4e86\u53f7\uff0c\u4f46\u662f\u8fd9\u6761\u603b\u7ebf\u4e0a\u5e76\u6ca1\u6709\u8fde\u63a5\u8bbe\u5907\u3002\u4e00\u65e6\u5de6\u4fa7\u6811\u72b6\u7ed3\u6784\u7684\u679a\u4e3e\u8fc7\u7a0b\u5b8c\u6210\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5c31\u4f1a\u8fdb\u884c\u5982\u4e0b\u7684\u8fd9\u4e9b\u6b65\u9aa4\u6765\u5bf9\u6b21\u7ea7RC\u8fdb\u884c\u679a\u4e3e\uff1a</p> <p>\\1.    \u5728\u672c\u4f8b\u4e2d\uff08\u56fe 3\u201114\uff09\uff0c\u679a\u4e3e\u8f6f\u4ef6\u5c06\u4f1a\u628a\u6b21\u7ea7RC\u4e2dHost/PCI Bridge\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u90fd\u66f4\u6539\u4e3a64\u3002\uff0864\u548c128\u8fd9\u4e24\u4e2a\u503c\u5728\u591aRC\u7cfb\u7edf\u4e2d\u88ab\u7ecf\u5e38\u7528\u6765\u4f5c\u4e3a\u8d77\u59cb\u603b\u7ebf\u5730\u5740\uff0c\u4f46\u662f\u8fd9\u53ea\u662f\u8f6f\u4ef6\u7684\u4e00\u4e2a\u4e60\u60ef\uff0c\u5728PCI\u6216\u8005PCIe\u7684\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u5bf9\u8fd9\u79cd\u914d\u7f6e\u65b9\u5f0f\u6709\u786c\u6027\u89c4\u5b9a\u3002\u6bd4\u5982\u5728\u672c\u4f8b\u4e2d\u5373\u4f7f\u7ed9\u6b21\u7ea7RC\u7684\u8d77\u59cb\u603b\u7ebf\u5730\u5740\u8bbe\u7f6e\u4e3a10\uff0c\u4e5f\u4e0d\u4f1a\u5f15\u8d77\u4efb\u4f55\u9519\u8bef\u3002\uff09</p> <p>\\2.    \u679a\u4e3e\u8f6f\u4ef6\u5f00\u59cb\u5728Bus 64\u4e0a\u8fdb\u884c\u641c\u7d22\uff0c\u5e76\u53d1\u73b0\u4e86\u4e0eRC\u4e0b\u65b9\u7aef\u53e3\u76f8\u8fde\u7684Bridge\u3002</p> <p>\\3.    \u7136\u540e\u679a\u4e3e\u8f6f\u4ef6\u6267\u884c\u4e00\u7cfb\u5217\u7684\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u8fd9\u4e2aBridge\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u8bbe\u7f6e\u4e3a\u5982\u4e0b\u503c\uff1a</p> <p>n \u4e3b\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Primary Bus Number Register\uff09=64</p> <p>n \u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09=65</p> <p>n \u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09=255</p> <p>\u73b0\u5728\uff0c\u8fd9\u4e2aBridge\u5c31\u8ba4\u4e3a\u5728\u5b83\u4e0b\u65b9\u4e0e\u5b83\u76f4\u63a5\u76f8\u8fde\u7684\u603b\u7ebf\u7f16\u53f7\u4e3a65\uff08\u6b21\u7ea7\u603b\u7ebf\u53f7=65\uff09\uff0c\u5e76\u4e14\u5b83\u4e0b\u65b9\u6700\u5927\u7684\u603b\u7ebf\u53f7\u4e3a255\uff08\u4ece\u5c5e\u603b\u7ebf\u53f7=255\uff09\u3002\uff08\u8fd9\u91cc\u539f\u4e66\u6709\u8bef\uff0c\u539f\u4e66\u5199\u5176\u4e0b\u65b9\u7684\u6700\u5927\u603b\u7ebf\u53f7\u4e3a65\uff0c\u4f46\u662f\u5e94\u8be5\u662f255\uff0c\u53ea\u4e0d\u8fc7\u4e4b\u540e\u8fd9\u4e2a\u53f7\u4f1a\u88ab\u66f4\u65b0\u4e3a65\uff09</p> <p>\\4.    \u679a\u4e3e\u8f6f\u4ef6\u7ee7\u7eed\u5728Bus65\u4e0a\u8fdb\u884c\u641c\u7d22\uff0c\u5e76\u53d1\u73b0\u4e86Device 0\uff0c\u4e14\u5b83\u4ec5\u6709\u4e00\u4e2aFunction 0\u3002\u8fdb\u4e00\u6b65\u641c\u7d22\u7684\u7ed3\u679c\u663e\u793a\uff0c\u5728Bus 65\u4e0a\u5e76\u6ca1\u6709\u5176\u4ed6\u7684Device\u4e86\uff0c\u56e0\u6b64\u641c\u7d22\u8fc7\u7a0b\u8fd4\u56de\u5230\u4e0a\u4e00\u7ea7\u603b\u7ebf\u3002</p> <p>\\5.    \u679a\u4e3e\u8f6f\u4ef6\u56de\u5230Bus 64\u7ee7\u7eed\u8fdb\u884c\uff0c\u7136\u800c\u4e5f\u6ca1\u6709\u53d1\u73b0\u4efb\u4f55\u5176\u4ed6\u7684\u8bbe\u5907\uff0c\u56e0\u6b64\u5c31\u5c06Host/PCI Bridge\u7684\u4ece\u5c5e\u603b\u7ebf\u53f7\u66f4\u65b0\u4e3a65\u3002</p> <p>\\6.    \u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u6b21\u7ea7RC\u7684\u679a\u4e3e\u8fc7\u7a0b\u3002</p> <p></p> <p>\u56fe 3\u201114\u591aRoot\u7cfb\u7edf</p>"},{"location":"pcie/all/#3133-hot-plug-considerations","title":"3.13.3    \u70ed\u63d2\u62d4\u6ce8\u610f\u4e8b\u9879\uff08Hot-Plug Considerations\uff09","text":"<p>\u70ed\u63d2\u62d4\uff0c\u6307\u7684\u662f\u4e00\u4e2a\u63d2\u4ef6\u5361\uff08add-in card\uff09\u53ef\u4ee5\u5728\u7cfb\u7edf\u8fd0\u884c\u65f6\u63d2\u5165\u6216\u62d4\u51fa\u3002\u5728\u8fd9\u79cd\u70ed\u63d2\u62d4\u73af\u5883\u4e2d\uff0c\u5bf9\u4e8e\u56fe 3\u201114\u4e2d\u7684Bus 8\u6765\u8bf4\uff0c\u53ef\u80fd\u5e26\u6765\u6f5c\u5728\u7684\u9ebb\u70e6\u3002\u82e5\u7cfb\u7edf\u5df2\u7ecf\u5b8c\u6210\u679a\u4e3e\uff0c\u5e76\u5df2\u7ecf\u6b63\u5e38\u7684\u5f00\u59cb\u8fd0\u884c\u4e86\uff0c\u8fd9\u65f6\u5c06\u4e00\u4e2a\u542b\u6709Bridge\u7684\u63d2\u4ef6\u5361\u63d2\u5230Bus 8\u4e0a\uff0c\u5219\u6709\u53ef\u80fd\u4f1a\u5f15\u53d1\u95ee\u9898\u3002\u8fd9\u4e2a\u63d2\u4ef6\u5361\u5185\u7684Bridge\u5206\u914d\u7ed9\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\u53f7\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\u5c06\u4f1a\u6bd4\u81ea\u5df1\u7684\u4e3b\u603b\u7ebf\u4e0a\u7684\u5176\u4ed6\u4ece\u5c5e\u603b\u7ebf\u7684\u7f16\u53f7\u8fd8\u8981\u5927\uff0c\u5e76\u4e14\u5c06\u5b8c\u5168\u5305\u542b\u8fd9\u4e9b\u603b\u7ebf\u53f7\uff0c\u610f\u601d\u5c31\u662f\u8bf4\uff0cBus 8\u4e0b\u65b9\u82e5\u51fa\u73b0\u4e86\u65b0\u603b\u7ebf\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b0\u603b\u7ebf\u53ef\u80fd\u8981\u88ab\u5206\u914d\u4e3aBus 9\uff0c\u800c\u8fd9\u5c31\u4e0e\u5df2\u7ecf\u5b58\u5728\u7684Bus 9\u4ea7\u751f\u4e86\u51b2\u7a81\u3002\u8fd9\u662f\u56e0\u4e3a\u65b0\u7684\u603b\u7ebf\u53f7\u5fc5\u987b\u5728\u63d2\u4ef6\u5361\u4e0a\u65b9\u7684Bridge\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u5bf9\u4e8e\u672c\u4f8b\uff08\u56fe 3\u201114\uff09\u6765\u8bf4\u4e5f\u5c31\u662f\u57286-9\u7684\u8303\u56f4\u5185\u3002</p> <p>\u4e00\u79cd\u7528\u6765\u5206\u914dBus 8\u4e0b\u65b9\u8fd9\u4e9b\u65b0\u589e\u7684\u603b\u7ebf\u53f7\u7684\u65b9\u6cd5\u662f\uff0c\u5c06\u5f53\u524d\u7684Bus 9\u7684\u7f16\u53f7\u589e\u5927\uff0c\u4e3aBus 8\u4e0b\u7684\u65b0\u589e\u603b\u7ebf\u53f7\u817e\u51fa\u7f16\u53f7\u7684\u7a7a\u95f4\u3002\u5c3d\u7ba1\u5728\u7cfb\u7edf\u8fd0\u884c\u65f6\u8c03\u6574\u603b\u7ebf\u53f7\u662f\u53ef\u4ee5\u505a\u5230\u7684\uff0c\u4f46\u662f\u636e\u6709\u7ecf\u9a8c\u7684\u4eba\u8bf4\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u5f88\u96be\u5de5\u4f5c\u7684\u5f88\u597d\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u7b80\u5355\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u6f5c\u5728\u7684\u95ee\u9898\uff1a\u53ea\u9700\u8981\u5728\u53d1\u73b0\u672a\u586b\u5145\u7684\u63d2\u4ef6\u5361\u63d2\u69fd\u65f6\uff0c\u7b80\u5355\u5730\u7559\u51fa\u4e00\u6bb5\u603b\u7ebf\u7f16\u53f7\u95f4\u9694\uff08bus number gap\uff09\u5373\u53ef\u3002\u4f8b\u5982\uff0c\u5f53Bus 8\u88ab\u5206\u914d\u4e86\u603b\u7ebf\u53f78\uff0c\u4f46\u662f\u5728\u5b83\u4e0b\u65b9\u53d1\u73b0\u4e86\u4e00\u4e2a\u7a7a\u7684\u63d2\u4ef6\u5361\u63d2\u69fd\uff0c\u90a3\u4e48\u5c31\u7ed9\u4e0b\u4e00\u4e2a\u88ab\u53d1\u73b0\u7684\u603b\u7ebf\u4e00\u4e2a\u66f4\u9ad8\u7684\u603b\u7ebf\u53f7\uff0c\u6bd4\u5982\u7ed9\u5b83\u7f16\u53f719\u800c\u4e0d\u662f9\uff0c\u8fd9\u6837\u5c31\u4e3aBus 8\u4e4b\u4e0b\u4ee5\u540e\u53ef\u80fd\u7684\u65b0\u589e\u603b\u7ebf\u7559\u51fa\u4e86\u7f16\u53f7\u7a7a\u95f4\u3002\u7136\u540e\uff0c\u5982\u679c\u4e00\u4e2a\u5e26\u6709Bridge\u7684\u63d2\u4ef6\u5361\u88ab\u63d2\u5165\uff0c\u90a3\u4e48\u65b0\u589e\u7684\u603b\u7ebf\u5c31\u53ef\u4ee5\u4eceBus 9\u5f00\u59cb\u7f16\u53f7\uff0c\u800c\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u95ee\u9898\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u7559\u51fa\u8fd9\u6837\u7684\u603b\u7ebf\u7f16\u53f7\u95f4\u9694\u5e76\u4e0d\u4f1a\u5f15\u53d1\u95ee\u9898\uff0c\u56e0\u4e3a\u7cfb\u7edf\u603b\u5171\u53ef\u4ee5\u5206\u914d256\u4e2a\u603b\u7ebf\u53f7\uff0c\u7f16\u53f7\u8d44\u6e90\u8f83\u4e3a\u5145\u8db3\u3002</p>"},{"location":"pcie/all/#314-mindshare-arbor","title":"3.14     MindShare Arbor\uff1a\u8c03\u8bd5/\u9a8c\u8bc1/\u5206\u6790\u548c\u5b66\u4e60\u7684\u8f6f\u4ef6\u5de5\u5177","text":""},{"location":"pcie/all/#3141-general","title":"3.14.1    \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>MindShare Arbor\u662f\u4e00\u4e2a\u8ba1\u7b97\u673a\u7cfb\u7edf\u8c03\u8bd5\uff08Debug\uff09\u3001\u9a8c\u8bc1\uff08Validation\uff09\u3001\u5206\u6790\uff08Analysis\uff09\u548c\u5b66\u4e60\u7684\u5de5\u5177\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u5bf9\u4efb\u610f\u7684memory\u3001IO\u6216\u8005\u914d\u7f6e\u7a7a\u95f4\u7684\u5730\u5740\u8fdb\u884c\u8bfb\u53d6\u6216\u8005\u5199\u5165\u3002\u8bfb\u53d6\u8fd9\u4e9b\u5730\u5740\u8fd4\u56de\u56de\u6765\u7684\u6570\u636e\u5c06\u4ee5\u4e00\u4e2a\u7b80\u6d01\u660e\u4e86\u4e14\u4fe1\u606f\u4e30\u5bcc\u7684\u6837\u5f0f\u8fdb\u884c\u67e5\u770b\u3002</p> <p>\u672c\u4e66\u7684\u4f5c\u8005\u51b3\u5b9a\u4e0d\u5728\u67d0\u4e00\u4e2a\u6807\u5fd7\u6027\u7684\u7279\u5b9a\u7ae0\u8282\u4e2d\u5bf9\u6240\u6709\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u90fd\u8fdb\u884c\u8be6\u7ec6\u63cf\u8ff0\u3002\u76f8\u53cd\u5730\uff0c\u5404\u4e2a\u5bc4\u5b58\u5668\u5c06\u5206\u6563\u5728\u5168\u4e66\u4e2d\uff0c\u5728\u4e0e\u5b83\u4eec\u5404\u81ea\u76f8\u5173\u7684\u7ae0\u8282\u4e2d\u8fdb\u884c\u8be6\u7ec6\u8bb2\u8ff0\u3002</p> <p>MindShare Arbor\u662f\u4e00\u4e2a\u5f88\u68d2\u7684\u53c2\u8003\u5b66\u4e60\u5de5\u5177\uff0c\u53ef\u4ee5\u7528\u5b83\u6765\u4ee3\u66ff\u4e66\u4e2d\u6ca1\u6709\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7a7a\u95f4\u7684\u4e13\u7528\u63cf\u8ff0\u7ae0\u8282\u3002\u901a\u8fc7MindShare Arbor\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u7684\u7406\u89e3PCI\u3001PCI-X\u4ee5\u53caPCI Express\u4e2d\u5b9e\u73b0\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u548c\u7ed3\u6784\u3002\u6240\u6709\u7684\u5bc4\u5b58\u5668\u548c\u5b57\u6bb5\u5b9a\u4e49\u90fd\u662f\u6309\u7167\u6700\u65b0\u7248\u672c\u7684PCI Express\u534f\u8bae\u8fdb\u884c\u66f4\u65b0\u7684\u3002\u4e00\u4e9b\u5176\u4ed6\u79cd\u7c7b\u7684\u7ed3\u6784\uff08\u4f8b\u5982x86 MSRs\u3001ACPI\u3001USB\u3001NVM Express\uff09\u4e5f\u53ef\u4ee5\u5728MindShare Arbor\u4e2d\u8fdb\u884c\u67e5\u770b\uff08\u4e00\u4e9b\u6682\u65f6\u6ca1\u6709\u7684\u4e5f\u4f1a\u5f88\u5feb\u5c31\u53ef\u4ee5\u652f\u6301\u67e5\u770b\uff09\u3002</p> <p>\u8bbf\u95eewww.mindshare.com/arbor\u5373\u53ef\u514d\u8d39\u4e0b\u8f7dMindShare Arbor\u7684\u8bd5\u7528\u7248\u3002</p> <p></p> <p>\u56fe 3\u201115 MindShare Arbor\u7684\u90e8\u5206\u622a\u56fe</p>"},{"location":"pcie/all/#3142-mindshare-arbor","title":"3.14.2    MindShare Arbor\u529f\u80fd\u5217\u8868","text":"<p>n \u5305\u542bPCIe 3.0\u534f\u8bae\u4e2d\u7684\u6240\u6709\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u63cf\u8ff0\u5185\u5bb9\u3002</p> <p>n \u53ef\u4ee5\u626b\u63cf\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u6240\u6709PCI\u53ef\u89c1Function\u7684\u914d\u7f6e\u7a7a\u95f4\uff0c\u5e76\u4ee5\u53ef\u8bfb\u6027\u6781\u5f3a\u7684\u683c\u5f0f\u5c06\u6bcf\u4e2a\u5bc4\u5b58\u5668\u7684\u8bb2\u89e3\u90fd\u5c55\u793a\u51fa\u6765\u3002</p> <p>n \u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u4efb\u4f55\u7684memory\u6216\u8005IO\u5730\u5740\u3002</p> <p>n \u53ef\u4ee5\u5199\u5165\u4efb\u610f\u7684\u914d\u7f6e\u7a7a\u95f4\u4f4d\u7f6e\u3001memory\u5730\u5740\u6216\u662fIO\u5730\u5740\u3002</p> <p>n \u53ef\u4ee5\u5728\u4e00\u4e2a\u5df2\u7ecf\u89e3\u7801\u7684\u683c\u5f0f\u4e2d\u67e5\u770b\u6807\u51c6\u6216\u975e\u6807\u51c6\u7684\u7ed3\u6784\u4f53</p> <p>o \u89e3\u7801\u4fe1\u606f\u53ef\u4ee5\u7ed9\u6807\u51c6\u7684PCI\u3001PCI-X\u3001PCI Express\u7ed3\u6784\u4f53\u8fdb\u884c\u89e3\u7801\u3002</p> <p>o \u89e3\u7801\u4fe1\u606f\u53ef\u4ee5\u7ed9\u4e00\u4e9b\u57fa\u4e8ex86\u7684\u7ed3\u6784\u4f53\u548c\u8bbe\u5907\u7279\u522b\u7684\u5bc4\u5b58\u5668\u8fdb\u884c\u89e3\u7801\u3002</p> <p>n \u53ef\u4ee5\u521b\u5efa\u81ea\u5df1\u5b9a\u4e49\u7684\u57fa\u4e8eXML\u7684\u8bd1\u7801\u6587\u4ef6\uff0c\u6765\u9a71\u52a8Arbor\u7684\u4fe1\u606f\u663e\u793a\u3002</p> <p>o \u53ef\u4ee5\u521b\u5efa\u8bd1\u7801\u6587\u4ef6\uff0c\u6765\u5bf9\u914d\u7f6e\u7a7a\u95f4\u3001\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u548cIO\u7a7a\u95f4\u5185\u7684\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p> <p>n \u53ef\u4ee5\u4fdd\u5b58\u7cfb\u7edf\u626b\u63cf\u7684\u7ed3\u679c\uff0c\u5e76\u4e4b\u540e\u518d\u5728\u5176\u4ed6\u7cfb\u7edf\u4e0a\u67e5\u770b\u8fd9\u4e2a\u7ed3\u679c\u3002</p> <p>o \u4fdd\u5b58\u7684\u7cfb\u7edf\u626b\u63cf\u7ed3\u679c\u662f\u57fa\u4e8eXML\u7684\u5f00\u6e90\u683c\u5f0f\u7684\u6587\u4ef6\u3002</p> <p>n \u5df2\u7ecf\u62e5\u6709\u6216\u8005\u5373\u5c06\u62e5\u6709\u7684\u65b0\u529f\u80fd\u7279\u6027</p> <p>o \u53ef\u4ee5\u68c0\u67e5\u51e0\u6b21\u626b\u63cf\u7ed3\u679c\u4e4b\u95f4\u7684\u5dee\u5f02\u3002</p> <p>o \u53ef\u4ee5\u4e3a\u626b\u63cf\u4e2d\u7684\u8fdd\u89c4\u6216\u8005\u975e\u6700\u4f73\u7684\u8bbe\u7f6e\u8fdb\u884c\u540e\u671f\u5904\u7406\u3002</p> <p>o \u53ef\u4ee5\u652f\u6301\u811a\u672c\u6765\u8fbe\u5230\u81ea\u52a8\u5316\u3002</p> <p>o \u53ef\u4ee5\u5bf9x86\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\uff08MSRs\u3001paging\u3001segmentation\u3001interrupt tables\u7b49\u7b49\uff09\u3002</p> <p>o \u53ef\u4ee5\u5bf9ACPI\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p> <p>o \u53ef\u4ee5\u5bf9USB\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p> <p>o \u53ef\u4ee5\u5bf9NVM Express\u7ed3\u6784\u4f53\u8fdb\u884c\u8bd1\u7801\u3002</p>"},{"location":"pcie/all/#chapter-4-address-space-transaction-routing","title":"Chapter 4      Address Space &amp; Transaction Routing//\u5730\u5740\u7a7a\u95f4\u4e0e\u4e8b\u52a1\u8def\u7531","text":""},{"location":"pcie/all/#_9","title":"\u5173\u4e8e\u524d\u4e00\u7ae0","text":"<p>\u524d\u4e00\u7ae0\u8282\u5bf9PCIe\u73af\u5883\u4e2d\u7684\u914d\u7f6e\u64cd\u4f5c\u8fdb\u884c\u4e86\u4ecb\u7ecd\u3002\u8fd9\u5305\u62ec\u90a3\u4e2a\u7528\u6765\u5b9e\u73b0Function\u914d\u7f6e\u5bc4\u5b58\u5668\u7684\u7a7a\u95f4\u3001\u4e00\u4e2aFunction\u662f\u5982\u4f55\u88ab\u641c\u7d22\u53d1\u73b0\u7684\u3001\u914d\u7f6e\u4e8b\u52a1\u662f\u5982\u4f55\u88ab\u751f\u6210\u5e76\u8def\u7531\u8f6c\u53d1\u7684\u3001PCI\u517c\u5bb9\u914d\u7f6e\u7a7a\u95f4\u548cPCIe\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u7684\u4e0d\u540c\u70b9\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u662f\u5982\u4f55\u8fa8\u8ba4\u533a\u5206\u5f00EP\u548cBridge\u7684\u3002</p>"},{"location":"pcie/all/#_10","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u5bf9\u63cf\u8ff0\u4e00\u4e2aFunction\u901a\u8fc7Base Address Registers\uff08BARs\uff0c\u57fa\u5730\u5740\u5bc4\u5b58\u5668\uff09\u6765\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\uff08memory\u5730\u5740\u7a7a\u95f4\u6216IO\u5730\u5740\u7a7a\u95f4\uff09\u7684\u76ee\u7684\u548c\u65b9\u6cd5\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u5fc5\u987b\u600e\u6837\u8bbe\u7f6e\u6240\u6709\u7684Bridge\u5185\u7684Base/Limit\u5bc4\u5b58\u5668\u6765\u4f7f\u5f97TLPs\u80fd\u4ece\u4e00\u4e2a\u6e90\u7aef\u53e3\u88ab\u8def\u7531\u8f6c\u53d1\u81f3\u6b63\u786e\u7684\u76ee\u7684\u7aef\u53e3\u3002\u53e6\u5916\uff0c\u4e5f\u5c06\u4f1a\u8ba8\u8bbaPCIe\u4e2dTLP\u8def\u7531\u7684\u4e00\u822c\u6982\u5ff5\uff0c\u5305\u62ec\u57fa\u4e8e\u5730\u5740\u7684\u8def\u7531\u3001\u57fa\u4e8eID\u7684\u8def\u7531\u548c\u9690\u5f0f\u8def\u7531\uff08implicit routing\uff09\u3002</p>"},{"location":"pcie/all/#_11","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u7684\u5c06\u8be6\u7ec6\u7684\u5bf9TLP\uff08Transaction Layer Packet\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\u7684\u5185\u5bb9\u8fdb\u884c\u63cf\u8ff0\u3002\u6211\u4eec\u5c06\u63cf\u8ff0\u5b83\u7684\u7528\u9014\u3001\u683c\u5f0f\u3001TLP Type\u7684\u5b9a\u4e49\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9b\u76f8\u5173\u5b57\u6bb5\u7684\u8be6\u7ec6\u5185\u5bb9\u3002</p>"},{"location":"pcie/all/#41-i-need-an-address","title":"4.1 \u6211\u9700\u8981\u4e00\u4e2a\u5730\u5740\uff08I Need An Address\uff09","text":"<p>\u51e0\u4e4e\u6240\u6709\u7684\u8bbe\u5907\u4e2d\u90fd\u6709\u80fd\u591f\u8ba9\u8f6f\u4ef6\uff08\u6216\u662f\u5176\u4ed6\u6f5c\u5728\u7684\u8bbe\u5907\uff09\u8bbf\u95ee\u7684\u5185\u90e8\u5bc4\u5b58\u5668\u6216\u662f\u5b58\u50a8\u7a7a\u95f4\u4f4d\u7f6e\u3002\u8fd9\u4e9b\u5185\u90e8\u4f4d\u7f6e\u6709\u53ef\u80fd\u7528\u6765\u63a7\u5236\u8bbe\u5907\u7684\u884c\u4e3a\u3001\u62a5\u544a\u8bbe\u5907\u7684\u72b6\u6001\uff0c\u6216\u8005\u53ef\u80fd\u7528\u6765\u4fdd\u6301\u4f4f\u8bbe\u5907\u8981\u8fdb\u884c\u5904\u7406\u7684\u6570\u636e\u3002\u8fd9\u91cc\u5148\u4e0d\u7ba1\u8fd9\u4e9b\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u7684\u76ee\u7684\uff0c\u6211\u4eec\u8fd9\u91cc\u66f4\u770b\u91cd\u7684\u4e00\u70b9\u662f\u8981\u53ef\u4ee5\u4ece\u8bbe\u5907\u5916\u90e8\u6765\u5bf9\u5b83\u4eec\u8fdb\u884c\u8bbf\u95ee\u3002\u8fd9\u610f\u5473\u7740\u8fd9\u4e9b\u5185\u90e8\u4f4d\u7f6e\u9700\u8981\u662f\u53ef\u5bfb\u5740\u7684\uff08addressable\uff09\u3002\u8f6f\u4ef6\u5fc5\u987b\u8981\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a\u5e26\u6709\u5730\u5740\u7684\u8bfb\u6216\u8fd9\u5199\u64cd\u4f5c\uff0c\u4ee5\u6b64\u6765\u8bbf\u95ee\u76ee\u6807\u8bbe\u5907\u5185\u76f8\u5e94\u7684\u5185\u90e8\u4f4d\u7f6e\u3002\u4e3a\u4e86\u8ba9\u8fd9\u79cd\u65b9\u5f0f\u53ef\u884c\uff0c\u8fd9\u4e9b\u5185\u90e8\u4f4d\u7f6e\u90fd\u9700\u8981\u88ab\u5206\u914d\u5730\u5740\uff0c\u5e76\u4e14\u6240\u5206\u914d\u7684\u5730\u5740\u4e5f\u9700\u8981\u6765\u81ea\u7cfb\u7edf\u6240\u652f\u6301\u7684\u5730\u5740\u7a7a\u95f4\u3002</p> <p>PCIe\u652f\u6301\u4e09\u4e2a\u5730\u5740\u7a7a\u95f4\uff0c\u5b83\u4eec\u4e0ePCI\u4e2d\u7684\u4e09\u4e2a\u5730\u5740\u7a7a\u95f4\u5b8c\u5168\u76f8\u540c\uff1a</p> <p>n \u914d\u7f6e\u7a7a\u95f4\uff08Configuration\uff09</p> <p>n \u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08Memory\uff09</p> <p>n IO\u5730\u5740\u7a7a\u95f4\uff08IO\uff09</p>"},{"location":"pcie/all/#411-configuration-space","title":"4.1.1     \u914d\u7f6e\u7a7a\u95f4\uff08Configuration Space\uff09","text":"<p>\u5982\u6211\u4eec\u5728Chapter 1\u4e2d\u6240\u89c1\u5230\u7684\uff0c\u914d\u7f6e\u7a7a\u95f4\u662f\u7531PCI\u5f15\u5165\u7684\uff0c\u8f6f\u4ef6\u901a\u8fc7\u914d\u7f6e\u7a7a\u95f4\u5c31\u53ef\u4ee5\u7528\u4e00\u79cd\u6807\u51c6\u5316\u7684\u65b9\u6cd5\u6765\u5bf9\u8bbe\u5907\u7684\u72b6\u6001\u8fdb\u884c\u63a7\u5236\u548c\u68c0\u67e5\u3002PCIe\u5bf9PCI\u8f6f\u4ef6\u5177\u6709\u5411\u540e\u517c\u5bb9\u6027\uff0c\u6240\u4ee5PCIe\u4e2d\u4ecd\u7136\u652f\u6301\u914d\u7f6e\u7a7a\u95f4\uff0c\u5e76\u4e14\u652f\u6301\u5b83\u7684\u539f\u56e0\u4e5f\u548cPCI\u4e2d\u4e00\u6837\uff0c\u5373\u7528\u4e00\u79cd\u6807\u51c6\u5316\u7684\u65b9\u6cd5\u6765\u5bf9\u8bbe\u5907\u7684\u72b6\u6001\u8fdb\u884c\u63a7\u5236\u548c\u68c0\u67e5\u3002\u66f4\u591a\u5173\u4e8e\u914d\u7f6e\u7a7a\u95f4\u7684\u4fe1\u606f\uff08\u76ee\u7684\u3001\u5982\u4f55\u8bbf\u95ee\u3001\u5927\u5c0f\u3001\u5185\u5bb9\u7b49\u7b49\uff09\u8bf7\u53c2\u9605Chapter 3\u3002</p> <p>\u5c3d\u7ba1\u914d\u7f6e\u7a7a\u95f4\u51fa\u73b0\u7684\u610f\u4e49\u662f\u6765\u653e\u7f6e\u548c\u4fdd\u6301\u4e00\u4e9b\u6807\u51c6\u5316\u7684\u7ed3\u6784\uff08PCI-defined Header\u3001Capability Structure\u80fd\u529b\u7ed3\u6784\u7b49\u7b49\uff09\uff0c\u4f46\u662fPCIe\u8bbe\u5907\u4e5f\u4f1a\u7ecf\u5e38\u7684\u5c06\u4e00\u4e9b\u8bbe\u5907\u7279\u5b9a\uff08device-specific\uff09\u7684\u5bc4\u5b58\u5668\u6620\u5c04\u5230\u8bbe\u5907\u81ea\u8eab\u7684\u914d\u7f6e\u7a7a\u95f4\u4e2d\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6620\u5c04\u5230\u914d\u7f6e\u7a7a\u95f4\u7684\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\u5e38\u7528\u6765\u4f5c\u4e3a\u63a7\u5236\u5bc4\u5b58\u5668\uff08control\uff09\u3001\u72b6\u6001\u5bc4\u5b58\u5668\uff08status\uff09\u6216\u8005\u6307\u9488\u5bc4\u5b58\u5668\uff08pointer\uff09\uff0c\u800c\u4e0d\u662f\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\u3002</p>"},{"location":"pcie/all/#412-iomemory-and-io-address-spaces","title":"4.1.2     \u5185\u5b58\u548cIO\u5730\u5740\u7a7a\u95f4\uff08Memory and IO Address Spaces\uff09","text":""},{"location":"pcie/all/#4121-general","title":"4.1.2.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5728PC\u7684\u65e9\u671f\u9636\u6bb5\uff0cIO\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u662f\u901a\u8fc7IO\u5730\u5740\u7a7a\u95f4\uff08IO Address\uff0c\u5b83\u662f\u7531intel\u5b9a\u4e49\u7684\uff09\u6765\u8bbf\u95ee\u7684\u3002\u7136\u800c\uff0c\u7531\u4e8eIO\u5730\u5740\u7a7a\u95f4\u7684\u4e00\u4e9b\u9650\u5236\u548c\u4e0d\u826f\u5f71\u54cd\uff08\u5728\u8fd9\u91cc\u6211\u4eec\u6682\u4e0d\u8ba8\u8bba\uff09\uff0c\u8fd9\u79cd\u5730\u5740\u7a7a\u95f4\u5f88\u5feb\u5c31\u5931\u53bb\u4e86\u8f6f\u4ef6\u548c\u786c\u4ef6\u5382\u5546\u7684\u9752\u7750\u3002\u8fd9\u4f7f\u5f97IO\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u88ab\u6620\u5c04\u5230\u4e86memory\u5730\u5740\u7a7a\u95f4\uff08Memory Address Space\uff0c\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff09\uff0c\u4e00\u822c\u88ab\u79f0\u4f5c\u5185\u5b58\u6620\u5c04IO\u6216\u8005\u7b80\u79f0MMIO\uff08Memory-Mapped IO\uff09\u3002\u7136\u800c\uff0c\u56e0\u4e3a\u65e9\u671f\u7684\u8f6f\u4ef6\u662f\u4f7f\u7528IO\u5730\u5740\u7a7a\u95f4\u6765\u8bbf\u95eeIO\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u7684\uff0c\u6240\u4ee5\u5b9e\u9645\u4e2d\u5e38\u7528\u7684\u505a\u6cd5\u662f\u5c06\u4e00\u5957\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\u65e2\u6620\u5c04\u5230\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u4e5f\u6620\u5c04\u5230IO\u5730\u5740\u7a7a\u95f4\u3002\u8fd9\u4f7f\u5f97\u65b0\u7684\u8f6f\u4ef6\u53ef\u4ee5\u4f7f\u7528\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7MMIO\uff0c\u6765\u5bf9\u8bbe\u5907\u7684\u5185\u90e8\u4f4d\u7f6e\u8fdb\u884c\u8bbf\u95ee\u3002\u800c\u4f20\u7edf\uff08\u65e7\uff09\u7684\u8f6f\u4ef6\u4e5f\u4f9d\u7136\u53ef\u4ee5\u8fd0\u884c\uff0c\u56e0\u4e3a\u5b83\u4f9d\u7136\u53ef\u4ee5\u901a\u8fc7IO\u5730\u5740\u7a7a\u95f4\u6765\u8bbf\u95ee\u8bbe\u5907\u7684\u5185\u90e8\u5bc4\u5b58\u5668\u3002</p> <p>\u5bf9\u4e8e\u66f4\u52a0\u65b0\u578b\u7684\u8bbe\u5907\uff0c\u5982\u679c\u5b83\u4eec\u4e0d\u518d\u4f9d\u8d56\u8001\u65e7\u7684\u4f20\u7edf\u8f6f\u4ef6\u5e76\u4e14\u4e5f\u4e0d\u9700\u8981\u8003\u8651\u5bf9\u4f20\u7edf\u64cd\u4f5c\u7684\u517c\u5bb9\u95ee\u9898\uff0c\u90a3\u4e48\u5b83\u4eec\u4e00\u822c\u53ea\u8981\u5c06\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u6620\u5c04\u5230\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08MMIO\uff09\u5373\u53ef\uff0c\u800c\u4e0d\u9700\u8981\u8bf7\u6c42IO\u5730\u5740\u7a7a\u95f4\u6765\u8fdb\u884c\u6620\u5c04\u3002\u5b9e\u9645\u4e0a\uff0cPCIe\u534f\u8bae\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528IO\u5730\u5740\u7a7a\u95f4\uff0c\u5b83\u4ec5\u4ec5\u662f\u53d7\u4e00\u4e9b\u4f20\u7edf\u9057\u7559\u539f\u56e0\u7684\u652f\u6301\uff0c\u5e76\u6709\u53ef\u80fd\u5728\u672a\u6765\u65b0\u7248\u672c\u7684\u534f\u8bae\u4e2d\u88ab\u5f03\u7528\u3002</p> <p>\u5982\u56fe 4\u20111\u6240\u793a\uff0c\u56fe\u4e2d\u5c55\u793a\u4e86\u4e00\u79cd\u901a\u7528\u7684\u5185\u5b58\u548cIO\u7684\u6620\u5c04\u3002\u5185\u5b58\u6620\u5c04\u7684\u5927\u5c0f\u662f\u8fd9\u4e2a\u7cfb\u7edf\u53ef\u4f7f\u7528\u5730\u5740\u8303\u56f4\uff08\u901a\u5e38\u7531CPU\u7684\u53ef\u5bfb\u5740\u8303\u56f4\u51b3\u5b9a\uff09\u7684\u4e00\u4e2a\u51fd\u6570\u3002PCIe\u4e2dIO\u6620\u5c04\u7684\u5927\u5c0f\u88ab\u9650\u5236\u4e3a32bits\uff084GB\uff09\uff0c\u867d\u7136\u5176\u5b9e\u5f88\u591a\u4f7f\u7528Intel\u517c\u5bb9\uff08x86\uff09\u5904\u7406\u5668\u7684\u8ba1\u7b97\u673a\u4e2d\u4ec5\u6709\u4f4e16bit\uff0864KB\uff09\u88ab\u4f7f\u7528\u3002PCIe\u53ef\u4ee5\u652f\u6301\u7684\u5185\u5b58\u5730\u5740\u5927\u5c0f\u8fbe\u523064bit\u3002</p> <p>\u56fe 4\u20111\u7ed9\u51fa\u7684\u6620\u5c04\u793a\u4f8b\u4ec5\u5c55\u793a\u4e86EP\u6240\u58f0\u660e\u4f7f\u7528\u7684MMIO\u548cIO\uff0c\u4f46\u662f\u8fd9\u79cd\u80fd\u529b\u5e76\u4e0d\u662fEP\u6240\u72ec\u6709\u7684\u3002\u5b83\u5bf9\u4e8eSwitch\u548cRC\u6765\u8bf4\u4e5f\u662f\u4e00\u79cd\u5f88\u666e\u901a\u7684\u80fd\u529b\uff0cSwitch\u548cRC\u5185\u90e8\u4e5f\u5b58\u5728\u7740\u53ef\u4ee5\u901a\u8fc7MMIO\u548cIO\u5730\u5740\u6765\u8fdb\u884c\u8bbf\u95ee\u7684\u8bbe\u5907\u7279\u5b9a\u5bc4\u5b58\u5668\u3002</p>"},{"location":"pcie/all/#4122-prefetchable-vs-non-prefetchable-memory-space","title":"4.1.2.2   \u53ef\u9884\u53d6\u7684\u4e0e\u4e0d\u53ef\u9884\u53d6\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u5bf9\u6bd4\uff08Prefetchable vs. Non-Prefetchable Memory Space\uff09","text":"<p>\u56fe 4\u20111\u5c55\u793a\u4e86\u88abPCIe\u8bbe\u5907\u58f0\u660e\u7684\u4e24\u79cd\u4e0d\u540c\u7c7b\u578b\u7684MMIO\uff1a\u53ef\u9884\u53d6MMIO\uff08Prefetchable MMIO\uff0cP-MMIO\uff09\u548c\u4e0d\u53ef\u9884\u53d6MMIO\uff08Non-Prefetchable MMIO\uff0cNP-MMIO\uff09\u3002\u4e86\u89e3\u8fd9\u4e24\u79cd\u5185\u5b58\u7a7a\u95f4\u4e4b\u95f4\u7684\u533a\u522b\u662f\u5341\u5206\u91cd\u8981\u7684\u3002\u53ef\u9884\u53d6\u7a7a\u95f4\u6709\u4e24\u4e2a\u610f\u4e49\u5341\u5206\u660e\u786e\u7684\u5c5e\u6027\uff1a</p> <p>n \u8bfb\u64cd\u4f5c\u4e0d\u5b58\u5728\u526f\u4f5c\u7528\u3002\uff08Reads do not have side effects\uff09</p> <p>n \u5141\u8bb8\u5199\u5408\u5e76\uff08Write merging is allowed\uff09</p> <p>\u5c06MMIO\u7684\u4e00\u4e2a\u533a\u57df\u5b9a\u4e49\u4e3a\u53ef\u9884\u53d6\u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u63a8\u6d4b\u6027\u7684\u63d0\u524d\u83b7\u53d6\u8be5\u533a\u57df\u4e2d\u7684\u6570\u636e\uff0c\u4ee5\u9884\u6d4bRequester\u5728\u4e0d\u4e45\u7684\u5c06\u6765\u53ef\u80fd\u9700\u8981\u6bd4\u5f53\u524d\u5b9e\u9645\u8bf7\u6c42\u66f4\u591a\u7684\u6570\u636e\u3002\u4e4b\u6240\u4ee5\u8fd9\u79cd\u5c0f\u578b\u7684Caching\uff08Minor Caching\uff09\u6570\u636e\u64cd\u4f5c\u662f\u5b89\u5168\u7684\uff0c\u662f\u56e0\u4e3a\u8bfb\u53d6\u8fd9\u4e9b\u6570\u636e\u5e76\u4e0d\u4f1a\u6539\u53d8\u76ee\u6807\u8bbe\u5907\u7684\u4efb\u4f55\u72b6\u6001\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u8bf4\u8bfb\u53d6\u67d0\u4e2a\u4f4d\u7f6e\u5e76\u4e0d\u4f1a\u5e26\u6765\u526f\u4f5c\u7528\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aRequester\u8bf7\u6c42\u4ece\u4e00\u4e2a\u5730\u5740\u4e2d\u8bfb\u53d6128byte\u6570\u636e\uff0c\u90a3\u4e48Completer\u53ef\u4ee5\u5728\u7ed9\u51fa\u6b64\u6b21\u8bf7\u6c42\u7684128byte\u4e4b\u540e\u4e5f\u9884\u53d6\u51fa\u4e0b\u4e00\u4e2a128byte\uff0c\u800c\u5f53\u4e0b\u4e00\u4e2a128byte\u88ab\u8bf7\u6c42\u65f6\u6570\u636e\u65e9\u5df2\u7ecf\u88abCompleter\u4ece\u5185\u5b58\u7a7a\u95f4\u4e2d\u9884\u53d6\u51fa\u6765\u4e86\uff0c\u8fd9\u6837\u5c31\u63d0\u9ad8\u4e86\u6027\u80fd\u3002\u7136\u800c\u5982\u679cRequester\u518d\u4e5f\u6ca1\u6709\u8bf7\u6c42\u989d\u5916\u7684\u6570\u636e\uff0c\u90a3\u4e48Completer\u5c31\u9700\u8981\u5c06\u9884\u53d6\u7684\u6570\u636e\u6e05\u9664\u6389\uff0c\u91ca\u653e\u81ea\u8eab\u7684Buffer\u7a7a\u95f4\u3002\u5982\u679c\u8bfb\u53d6\u6570\u636e\u7684\u884c\u4e3a\u6539\u53d8\u4e86\u5bf9\u5e94\u5730\u5740\u4e0a\u7684\u6570\u503c\uff08\u6216\u8005\u6709\u5176\u4ed6\u7684\u4ec0\u4e48\u526f\u4f5c\u7528\uff09\uff0c\u90a3\u4e48\u5c31\u5c06\u4f1a\u65e0\u6cd5\u6062\u590d\u88ab\u6e05\u9664\u7684\u6570\u636e\u4e86\u3002\u7136\u800c\u5bf9\u4e8e\u53ef\u9884\u53d6\u7a7a\u95f4\u6765\u8bf4\uff0c\u8bfb\u53d6\u884c\u4e3a\u5e76\u6ca1\u6709\u4efb\u4f55\u526f\u4f5c\u7528\uff0c\u56e0\u6b64\u5b83\u603b\u662f\u53ef\u4ee5\u56de\u9000\u5e76\u4e14\u5728\u7a0d\u540e\u4e5f\u80fd\u83b7\u5f97\u539f\u59cb\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u539f\u59cb\u7684\u6570\u636e\u4e00\u76f4\u90fd\u4e0d\u53d8\u7684\u5b58\u653e\u5728\u90a3\u91cc\u3002</p> <p>\u4f60\u4e5f\u8bb8\u4f1a\u60f3\u77e5\u9053\u4ec0\u4e48\u6837\u7684\u5185\u5b58\u7a7a\u95f4\u4f1a\u5b58\u5728\u8bfb\u53d6\u64cd\u4f5c\u7684\u526f\u4f5c\u7528\u3002\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u4e00\u4e2a\u5185\u5b58\u6620\u5c04\u7684\u72b6\u6001\u5bc4\u5b58\u5668\uff0c\u5b83\u88ab\u8bbe\u8ba1\u6210\u5728\u8bfb\u53d6\u65f6\u81ea\u52a8\u6e05\u9664\u81ea\u5df1\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u7a0b\u5e8f\u5458\u5728\u8bfb\u53d6\u8fd9\u4e2a\u72b6\u6001\u540e\u8fd8\u9700\u8981\u989d\u5916\u6b65\u9aa4\u6765\u6e05\u9664\u8fd9\u4e9b\u6bd4\u7279\u7684\u64cd\u4f5c\u3002</p> <p>\u505a\u8fd9\u79cd\u53ef\u9884\u53d6\u548c\u4e0d\u53ef\u9884\u53d6\u7684\u533a\u5206\uff0c\u5bf9\u4e8ePCI\u7684\u610f\u4e49\u8981\u5927\u4e8ePCIe\uff0c\u56e0\u4e3aPCI\u603b\u7ebf\u534f\u8bae\u4e2d\u7684\u4e8b\u52a1\u5e76\u6ca1\u6709\u5305\u542b\u4f20\u8f93\u91cf\u5927\u5c0f\u7684\u4fe1\u606f\u3002\u5982\u679c\u8bbe\u5907\u90fd\u5728\u540c\u4e00\u6761\u603b\u7ebf\u4e0a\u4ea4\u6362\u6570\u636e\uff0c\u90a3\u4e48\u6ca1\u6709\u4f20\u8f93\u91cf\u5927\u5c0f\u7684\u4fe1\u606f\u4e5f\u4e0d\u662f\u4ec0\u4e48\u95ee\u9898\uff0c\u56e0\u4e3a\u5728\u540c\u4e00\u603b\u7ebf\u4e0a\u4f1a\u6709\u5b9e\u65f6\u7684\u63e1\u624b\u4fe1\u53f7\u6765\u6307\u793aRequester\u4ec0\u4e48\u65f6\u5019\u6536\u5230\u4e86\u8db3\u591f\u7684\u6570\u636e\u5b8c\u6210\u4e86\u4e8b\u52a1\u3002\u4f46\u662f\u5982\u679c\u6570\u636e\u7684\u4f20\u8f93\u9700\u8981\u8de8\u8fc7\u4e00\u4e2aBridge\u6765\u5230\u53e6\u4e00\u6761\u603b\u7ebf\uff0c\u90a3\u4e48\u60c5\u51b5\u5c31\u4e0d\u50cf\u521a\u624d\u4e00\u6837\u7b80\u5355\u4e86\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8de8\u5230\u4e0d\u540c\u603b\u7ebf\u7684\u8bfb\u64cd\u4f5c\u6765\u8bf4\uff0cBridge\u5728\u6536\u96c6\u53e6\u4e00\u6761\u603b\u7ebf\u4e0a\u7684\u6570\u636e\u65f6\u9700\u8981\u53bb\u731c\u6d4b\u4f20\u8f93\u6570\u636e\u603b\u91cf\u3002\u5982\u679c\u731c\u9519\u4e86\u4f20\u8f93\u91cf\u7684\u5927\u5c0f\u5219\u4f1a\u589e\u52a0\u5ef6\u65f6\u800c\u964d\u4f4e\u6027\u80fd\uff0c\u56e0\u6b64\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u82e5\u62e5\u6709\u9884\u53d6\u7684\u6743\u9650\u5219\u5bf9\u63d0\u5347\u6027\u80fd\u4f1a\u6709\u4e0d\u5c0f\u7684\u5e2e\u52a9\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u5c06\u5185\u5b58\u7a7a\u95f4\u6307\u5b9a\u4e3a\u53ef\u9884\u53d6\u7684\u6982\u5ff5\u5728PCI\u4e2d\u5f88\u6709\u597d\u5904\u3002\u7531\u4e8ePCIe\u8bf7\u6c42\u4e2d\u5305\u542b\u4e86\u4f20\u8f93\u91cf\u5927\u5c0f\u7684\u4fe1\u606f\uff0c\u6240\u4ee5\u53ef\u9884\u53d6\u7a7a\u95f4\u5e76\u4e0d\u50cf\u4ee5\u524d\u5728PCI\u4e2d\u90a3\u6837\u5f15\u4eba\u5173\u6ce8\u4e86\uff0c\u4f46\u662f\u4e3a\u4e86\u5411\u540e\u517c\u5bb9\u6027\uff0cPCIe\u8fd8\u662f\u7ee7\u627f\u4e86\u8fd9\u79cd\u6982\u5ff5\u3002</p> <p></p> <p>\u56fe 4\u20111\u901a\u7528\u7684Memory\u4e0eIO\u7684\u5730\u5740\u6620\u5c04</p>"},{"location":"pcie/all/#42-barsbase-address-registers","title":"4.2 \u57fa\u5730\u5740\u5bc4\u5b58\u5668BARs\uff08Base Address Registers\uff09","text":""},{"location":"pcie/all/#421-general","title":"4.2.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u7684\u6bcf\u4e2a\u8bbe\u5907\u5bf9\u5730\u5740\u7a7a\u95f4\u7684\u6570\u91cf\u548c\u7c7b\u578b\u53ef\u80fd\u90fd\u6709\u4e0d\u540c\u7684\u8981\u6c42\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u8bbe\u5907\u53ef\u80fd\u6709256byte\u5927\u5c0f\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u9700\u8981\u901a\u8fc7IO\u5730\u5740\u7a7a\u95f4\u6765\u8bbf\u95ee\uff0c\u800c\u53e6\u4e00\u4e2a\u8bbe\u5907\u4e2d\u53ef\u80fd\u670916KB\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u9700\u8981\u901a\u8fc7MMIO\u6765\u8bbf\u95ee\u3002</p> <p>\u57fa\u4e8ePCI\u7684\u8bbe\u5907\u4e0d\u5141\u8bb8\u81ea\u5df1\u6765\u51b3\u5b9a\u54ea\u4e9b\u5730\u5740\u53ef\u4ee5\u7528\u6765\u8bbf\u95ee\u5b83\u4eec\u5185\u90e8\u7684\u4f4d\u7f6e\uff0c\u8fd9\u7cfb\u7edf\u8f6f\u4ef6\u8d1f\u8d23\u7684\u5de5\u4f5c\uff08\u4f8b\u5982BIOS\u548c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff09\u3002\u56e0\u6b64\u8bbe\u5907\u5fc5\u987b\u4e3a\u7cfb\u7edf\u8f6f\u4ef6\u63d0\u4f9b\u4e00\u4e2a\u9014\u5f84\u7528\u6765\u786e\u5b9a\u8bbe\u5907\u5bf9\u5730\u5740\u7a7a\u95f4\u7684\u9700\u6c42\u3002\u4e00\u65e6\u8f6f\u4ef6\u77e5\u9053\u4e86\u8bbe\u5907\u5bf9\u5730\u5740\u7a7a\u95f4\u7684\u9700\u6c42\u662f\u4ec0\u4e48\u6837\u7684\u5e76\u5047\u8bbe\u8fd9\u4e2a\u9700\u6c42\u662f\u53ef\u4ee5\u88ab\u6ee1\u8db3\u7684\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u7ed9\u5bf9\u5e94\u7684\u8bbe\u5907\u5206\u914d\u4e00\u6bb5\u53ef\u7528\u7684\u5730\u5740\u8303\u56f4\u548c\u76f8\u5e94\u7684\u5730\u5740\u7a7a\u95f4\u7c7b\u578b\uff08IO\u3001NP-MMIO\u3001P-MMIO\uff09\u3002</p> <p>\u8fd9\u4e9b\u90fd\u662f\u901a\u8fc7\u914d\u7f6e\u7a7a\u95f4Header\u4e2d\u7684\u57fa\u5730\u5740\u5bc4\u5b58\u5668BARs\uff08Base Address Registers\uff09\u6765\u5b8c\u6210\u7684\u3002\u5982\u56fe 4\u20112\u6240\u793a\uff0c\u4e00\u4e2aType 0 Header\u62e5\u67096\u4e2a\u53ef\u7528\u7684BAR\uff08\u6bcf\u4e2a\u5927\u5c0f\u4e3a32bit\uff09\uff0c\u800c\u4e00\u4e2aType 1 Header\u53ea\u62e5\u67092\u4e2aBAR\u3002Type 1 Header\u662f\u5b58\u5728\u4e8e\u6240\u6709\u7684Bridge\u8bbe\u5907\u4e2d\u7684\uff0c\u8fd9\u610f\u5473\u7740\u6bcf\u4e2aSwitch\u7aef\u53e3\u548cRC\u7aef\u53e3\u90fd\u4f1a\u62e5\u67091\u4e2aType 1 Header\u3002Type 0 Header\u53ea\u5b58\u5728\u4e8e\u975eBridge\u8bbe\u5907\u4e2d\uff0c\u4f8b\u5982EP\u3002\u5173\u4e8e\u8fd9\u91cc\u7684\u4e00\u4e2a\u4f8b\u5b50\u53ef\u4ee5\u53c2\u9605\u56fe 4\u20113\u3002</p> <p></p> <p>\u56fe 4\u20112\u914d\u7f6e\u7a7a\u95f4\u4e2d\u7684BARs</p> <p>\u7cfb\u7edf\u8f6f\u4ef6\u5fc5\u987b\u9996\u5148\u786e\u5b9a\u8bbe\u5907\u6240\u9700\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u77e5\u9053\u8bbe\u5907\u4e2d\u897f\u836f\u901a\u8fc7IO\u6216\u8005MMIO\u8bbf\u95ee\u7684\u5185\u90e8\u5bc4\u5b58\u5668/\u5b58\u50a8\u7684\u603b\u4f53\u5927\u5c0f\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u8fd8\u77e5\u9053\u5f53\u8fd9\u4e9b\u5bc4\u5b58\u5668\u88ab\u8bbf\u95ee\u65f6\u8bbe\u5907\u5c06\u4f1a\u5982\u4f55\u5de5\u4f5c\uff08\u4f8b\u5982\u8bfb\u53d6\u64cd\u4f5c\u662f\u5426\u6709\u526f\u4f5c\u7528\uff09\u3002\u8fd9\u5c06\u51b3\u5b9a\u8bbe\u5907\u6240\u9700\u8981\u7684\u662f\u53ef\u9884\u53d6MMIO\uff08\u8bfb\u53d6\u64cd\u4f5c\u65e0\u526f\u4f5c\u7528\uff09\u8fd8\u662f\u4e0d\u53ef\u9884\u53d6MMIO\uff08\u8bfb\u53d6\u64cd\u4f5c\u6709\u526f\u4f5c\u7528\uff09\u3002\u77e5\u9053\u4e86\u8fd9\u4e2a\u4fe1\u606f\u4e4b\u540e\uff0c\u8bbe\u5907\u8bbe\u8ba1\u8005\u5c06BARs\u7684\u4f4e\u4f4dbit\u56fa\u5b9a\u4e3a\u67d0\u4e2a\u503c\uff0c\u4ee5\u6b64\u6765\u6307\u793a\u9700\u8981\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002</p> <p>BARs\u7684\u9ad8\u4f4dbit\u662f\u8f6f\u4ef6\u53ef\u8fdb\u884c\u5199\u5165\u7684\u3002\u4e00\u65e6\u7cfb\u7edf\u8f6f\u4ef6\u901a\u8fc7\u68c0\u67e5BARs\u7684\u4f4e\u4f4dbit\u786e\u5b9a\u4e86\u8bbe\u5907\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\uff0c\u7cfb\u7edf\u8f6f\u4ef6\u5c31\u4f1a\u5c06\u5206\u914d\u7ed9\u8fd9\u4e2a\u8bbe\u5907\u7684\u5730\u5740\u8303\u56f4\u7684\u57fa\u5730\u5740\u5199\u5165BAR\u4e2d\u3002\u7531\u4e8e\u4e00\u4e2aEP\uff08\u4f7f\u7528Type 0 Header\uff09\u62e5\u67096\u4e2aBARs\uff0c\u5b83\u6700\u591a\u53ef\u4ee5\u8bf7\u6c426\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u7a7a\u95f4\u3002\u7136\u800c\uff0c\u4e00\u822c\u5b9e\u9645\u4e2d\u8bf7\u6c426\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u7a7a\u95f4\u5e76\u4e0d\u5e38\u89c1\u3002\u7edd\u5927\u591a\u6570\u8bbe\u5907\u4f1a\u8bf7\u6c421\u52303\u4e2a\u4e0d\u540c\u7684\u5730\u5740\u8303\u56f4\u3002</p> <p>\u5e76\u4e0d\u662f\u6240\u6709\u7684BARs\u90fd\u9700\u8981\u88ab\u5b9e\u73b0\u3002\u5982\u679c\u4e00\u4e2a\u8bbe\u5907\u5e76\u4e0d\u9700\u8981\u4f7f\u7528\u6240\u6709\u7684BAR\u6765\u6620\u5c04\u81ea\u5df1\u7684\u5185\u90e8\u5bc4\u5b58\u5668\uff0c\u90a3\u4e48\u591a\u4f59\u7684BARs\u5c06\u4f1a\u88ab\u56fa\u5b9a\u4e3a\u51680\uff0c\u4ee5\u6b64\u6765\u901a\u77e5\u8f6f\u4ef6\u8fd9\u4e9bBARs\u5e76\u6ca1\u6709\u88ab\u5b9e\u73b0\u3002</p> <p>\u4e00\u65e6BARs\u88ab\u7f16\u7a0b\u5199\u5165\uff08programmed\uff09\uff0c\u8bbe\u5907\u5185\u7684\u5185\u90e8\u5bc4\u5b58\u5668\u6216\u8005\u672c\u5730\u5185\u5b58\uff08local memory\uff09\u5c31\u53ef\u4ee5\u901a\u8fc7BARs\u4e2d\u6240\u5199\u5165\u7684\u5730\u5740\u8303\u56f4\u8fdb\u884c\u8bbf\u95ee\u3002\u4efb\u4f55\u65f6\u5019\uff0c\u5f53\u8bbe\u5907\u53d1\u73b0\u4e00\u4e2a\u8bf7\u6c42\u4e8b\u52a1\u7684\u5730\u5740\u662f\u6620\u5c04\u5230\u81ea\u5df1\u7684\u4e00\u4e2aBAR\u65f6\uff0c\u5b83\u5c31\u4f1a\u63a5\u6536\u8fd9\u4e2a\u8bf7\u6c42\u4e8b\u52a1\uff0c\u56e0\u4e3a\u5b83\u81ea\u5df1\u5c31\u662f\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\u3002</p> <p></p> <p>\u56fe 4\u20113 PCIe\u8bbe\u5907\u4e2d\u5bf9Type 0\u3001Type 1 Header\u7684\u7528\u6cd5</p>"},{"location":"pcie/all/#422-bar132bit","title":"4.2.2     BAR\u793a\u4f8b1\u2014\u201432bit\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42","text":"<p>\u56fe 4\u20114\u5c55\u793a\u4e86\u8bbe\u7f6e\u5efa\u7acb\u4e00\u4e2aBAR\u7684\u57fa\u7840\u6b65\u9aa4\uff0c\u5728\u672c\u4f8b\u4e2d\uff0c\u8981\u8bf7\u6c42\u4e00\u4e2a4KB\u5927\u5c0f\u7684\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\uff08NP-MMIO\uff0cnon-prefetchable memory\uff09\u3002\u5728\u56fe\u4e2d\uff0c\u5c55\u793a\u4e86BAR\u5728\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u7684\u4e09\u4e2a\u8282\u70b9\uff1a</p> <p>\\1.    \u5728\u56fe 4\u20114\u4e2d\u7684\uff081\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230BAR\u5904\u4e8e\u672a\u521d\u59cb\u5316\u7684\u72b6\u6001\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u5df2\u7ecf\u5c06\u4f4e\u4f4dbit\u56fa\u5b9a\u4e3a\u4e00\u4e2a\u6570\u503c\uff0c\u6765\u6307\u793a\u9700\u8981\u7684memory\u7684\u5927\u5c0f\u548c\u7c7b\u578b\uff0c\u4f46\u662f\u9ad8\u4f4dbit\uff08\u53ef\u5199\u53ef\u8bfb\u7684\uff09\u5219\u4ecd\u7136\u662f\u7528X\u6765\u8868\u793a\uff0c\u8fd9\u4ee3\u8868\u5b83\u4eec\u7684\u503c\u8fd8\u672a\u77e5\u3002\u7cfb\u7edf\u8f6f\u4ef6\u5c06\u4f1a\u9996\u5148\u628a\u6bcf\u4e2aBAR\u90fd\u901a\u8fc7\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u53ef\u5199\u5165\u7684bit\u5199\u4e3a\u51681\uff08\u5f53\u7136\uff0c\u88ab\u56fa\u5b9a\u7684\u4f4e\u4f4dbit\u4e0d\u4f1a\u53d7\u5230\u914d\u7f6e\u5199\u64cd\u4f5c\u7684\u5f71\u54cd\uff09\u3002\u5728\u56fe 4\u20114\u7684\uff082\uff09\u4e2d\u5c55\u793a\u7684BAR\u5c31\u662f\u5904\u4e8e\u7b2c\u4e8c\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u9664\u4e86\u88ab\u56fa\u5b9a\u7684\u4f4e\u4f4dbit\u4ee5\u5916\uff0c\u6240\u6709\u7684bit\u90fd\u88ab\u5199\u4e3a1\u3002</p> <p>\u5199\u4e3a\u51681\u8fd9\u4e2a\u64cd\u4f5c\u662f\u4e3a\u4e86\u786e\u5b9a\u6700\u4f4e\u4f4d\u7684\u53ef\u5199\u5165\u7684bit\uff08least-significant writable bit\uff09\u662f\u54ea\u4e00\u4f4d\uff0c\u8fd9\u4e2abit\u7684\u4f4d\u7f6e\u6307\u793a\u4e86\u9700\u8981\u88ab\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6700\u4f4e\u4f4d\u7684\u53ef\u5199\u5165\u7684bit\u4e3abit 12\uff0c\u56e0\u6b64\u8fd9\u4e2aBAR\u9700\u8981\u8bf7\u6c42212\uff08\u6216\u8005\u8bf4\u662f4KB\uff09\u7684\u5730\u5740\u7a7a\u95f4\u3002\u5982\u679c\u6700\u4f4e\u4f4d\u7684\u53ef\u5199\u5165\u7684bit\u4e3abit 20\uff0c\u90a3\u4e48\u8fd9\u4e2aBAR\u5c31\u8981\u8bf7\u6c42220\uff081MB\uff09\u7684\u5730\u5740\u7a7a\u95f4\u3002</p> <p>\\2.    \u5728\u8f6f\u4ef6\u5c06BARs\u4e2d\u6240\u6709\u53ef\u5199bit\u90fd\u5199\u4e3a1\u540e\uff0c\u8f6f\u4ef6\u5c06\u4eceBAR0\u5f00\u59cb\uff0c\u4f9d\u6b21\u8bfb\u53d6\u6bcf\u4e2aBAR\u7684\u6570\u503c\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u5404\u4e2aBAR\u8981\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u8868 4\u20111\u4e2d\u603b\u7ed3\u4e86\u672c\u4f8b\u4e2d\u5bf9BAR0\u8fdb\u884c\u914d\u7f6e\u8bfb\u7684\u7ed3\u679c\u3002</p> <p>\\3.    \u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u7684\u6700\u540e\u4e00\u6b65\u5c31\u662f\u7cfb\u7edf\u8f6f\u4ef6\u4e3aBAR 0\u5206\u914d\u4e00\u4e2a\u5730\u5740\u8303\u56f4\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86BAR 0\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u56fe 4\u20114\u7684\uff083\uff09\u4e2d\u5c55\u793a\u4e86BAR\u5904\u4e8e\u7b2c\u4e09\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u6b64\u65f6\u7cfb\u7edf\u8f6f\u4ef6\u5df2\u7ecf\u5c06\u4e00\u5757\u5730\u5740\u533a\u57df\u7684\u8d77\u59cb\u5730\u5740\u5199\u5165\u4e86BAR 0\u4e2d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u8fd9\u4e2a\u8d77\u59cb\u5730\u5740\u4e3aF900_0000h\u3002</p> <p>\u5230\u8fd9\u91cc\u4e3a\u6b62\uff0c\u5bf9BAR 0\u7684\u914d\u7f6e\u5c31\u5b8c\u6210\u4e86\u3002\u4e00\u65e6\u8f6f\u4ef6\u542f\u7528\u4e86\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command register\uff0c\u504f\u79fb\u5730\u574004h\uff09\u4e2d\u7684\u5185\u5b58\u5730\u5740\u8bd1\u7801\uff08memory address decoding\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bbe\u5907\u5c31\u4f1a\u63a5\u53d7\u6240\u6709\u5730\u5740\u5728F900_0000h-F900_0FFFh\uff084KB\u5927\u5c0f\uff09\u8303\u56f4\u5185\u7684memory\u8bf7\u6c42\u3002</p> <p></p> <p>\u8868 4\u20111\u5bf9BAR 0\u5199\u5165\u51681\u540e\u518d\u8bfb\u53d6BAR 0\u65f6\u7684\u7ed3\u679c</p> <p></p> <p>\u56fe 4\u20114\u8bbe\u7f6e\u5efa\u7acb32bit\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7684BAR</p>"},{"location":"pcie/all/#423-bar264bit","title":"4.2.3     BAR\u793a\u4f8b2\u2014\u201464bit\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42","text":"<p>\u5728\u4e0a\u4e00\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u770b\u5230\u4e86\u901a\u8fc7BAR 0\u6765\u8bf7\u6c42\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08NP-MMIO\uff09\u3002\u5728\u5f53\u524d\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u56fe 4\u20115\u6240\u793a\uff0cBAR 1\u548cBAR 2\u88ab\u7528\u6765\u8bf7\u6c42\u4e00\u575764MB\u7684\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u3002\u8fd9\u91cc\u4f7f\u7528\u4e86\u4e24\u4e2a\u8fde\u7eed\u76f8\u8fde\u7684BAR\u662f\u56e0\u4e3a\u8fd9\u4e2a\u8bbe\u5907\u652f\u6301\u8fd9\u4e2a\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u7684\u8bf7\u6c42\u4f7f\u752864bit\u5730\u5740\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c\u8f6f\u4ef6\u7ed9\u5b83\u5206\u914d\u7684\u5730\u5740\u7a7a\u95f4\u53ef\u4ee5\u8d85\u8fc74GB\u5730\u5740\u8fb9\u754c\uff08\u5e76\u975e\u5fc5\u8981\uff09\u3002\u7531\u4e8e\u5730\u5740\u53ef\u4ee5\u662f64bit\u4f4d\u5bbd\uff0c\u56e0\u6b64\u5fc5\u987b\u5c06\u4e24\u4e2a\u8fde\u7eed\u76f8\u8fde\u7684BAR\u4e00\u8d77\u4f7f\u7528\u3002</p> <p>\u8ddf\u4e0a\u9762\u4e00\u6837\uff0c\u5c06BAR\u5728\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u5206\u4e3a3\u4e2a\u8282\u70b9\uff1a</p> <p>\\1.    \u5728\u56fe 4\u20115\u4e2d\u7684\uff081\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u5bf9BAR\u90fd\u5904\u4e8e\u672a\u521d\u59cb\u5316\u7684\u72b6\u6001\u3002\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u5df2\u7ecf\u5c06\u4f4e\u4f4dBAR\uff08\u5728\u672c\u4f8b\u4e2d\u4e3aBAR 1\uff09\u4e2d\u7684\u4f4e\u4f4dbit\u56fa\u5b9a\u4e3a\u4e00\u4e2a\u6570\u503c\uff0c\u6765\u6307\u793a\u9700\u8981\u7684memory\u7684\u5927\u5c0f\u548c\u7c7b\u578b\uff0c\u4f46\u662f\u9ad8\u4f4dBAR\uff08BAR 2\uff09\u4e2d\u7684bit\u5219\u90fd\u662f\u53ef\u8bfb\u53ef\u5199\u7684\uff0c\u6ca1\u6709\u88ab\u56fa\u5b9a\u3002\u7cfb\u7edf\u8f6f\u4ef6\u7684\u7b2c\u4e00\u6b65\u5c31\u662f\u628a\u6bcf\u4e2aBAR\u90fd\u901a\u8fc7\u914d\u7f6e\u5199\u64cd\u4f5c\u6765\u5c06\u53ef\u5199\u5165\u7684bit\u5199\u4e3a\u51681\u3002\u5728\u56fe 4\u20115\u7684\uff082\uff09\u4e2d\u5c55\u793a\u7684BAR\u5c31\u662f\u5904\u4e8e\u7b2c\u4e8c\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u9664\u4e86BAR 1\u4e2d\u88ab\u56fa\u5b9a\u7684\u4f4e\u4f4dbit\u4ee5\u5916\uff0c\u6240\u6709\u7684bit\u90fd\u88ab\u5199\u4e3a1\u3002</p> <p>\\2.    \u5982\u4e0a\u4e00\u4e2a\u4f8b\u5b50\u6240\u8ff0\uff0c\u7cfb\u7edf\u8f6f\u4ef6\u5df2\u7ecf\u8bc4\u4f30\u8fc7BAR 0\u3002\u56e0\u6b64\u8f6f\u4ef6\u7684\u4e0b\u4e00\u6b65\u5c31\u662f\u8bfb\u53d6\u4e0b\u4e00\u4e2aBAR\uff08BAR 1\uff09\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u8bc4\u4f30\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u8bbe\u5907\u662f\u5426\u6b63\u5728\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\u3002\u4e00\u65e6BAR 1\u88ab\u8bfb\u53d6\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u53d1\u73b0\u8bbe\u5907\u6b63\u5728\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u5e76\u4e14\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7c7b\u578b\u4e3a\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08P-MMIO\uff09\uff0c\u8fd9\u4e2a\u5730\u5740\u7a7a\u95f4\u53ef\u4ee5\u88ab\u5206\u914d\u4e3a64bit\u5730\u5740\u8303\u56f4\u7684\u4efb\u4f55\u4e00\u4e2a\u4f4d\u7f6e\u3002\u7531\u4e8e\u8fd9\u4e2a\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42\u652f\u630164bit\u5730\u5740\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u8fde\u7eed\u76f8\u8fde\u7684BAR\uff08\u672c\u4f8b\u4e2d\u4e3aBAR 2\uff09\u5c31\u4f1a\u88ab\u5f53\u505a\u662fBAR 1\u7684\u9ad832bit\u3002\u56e0\u6b64\u8f6f\u4ef6\u4e5f\u4f1a\u8bfb\u53d6BAR 2\u7684\u5185\u5bb9\u3002\u7136\u800c\uff0c\u8f6f\u4ef6\u5e76\u4e0d\u4f1a\u5bf9BAR 2\u8fdb\u884c\u50cf\u5bf9BAR 1\u4e00\u6837\u7684\u4f4e\u4f4dbit\u7684\u8bc4\u4f30\uff0c\u56e0\u4e3a\u8f6f\u4ef6\u4ec5\u4ec5\u662f\u5c06BAR 2\u7b80\u5355\u7684\u5f53\u505aBAR 1\u53d1\u8d77\u768464bit\u5730\u5740\u8bf7\u6c42\u7684\u9ad832bit\u3002\u8868 4\u20112\u4e2d\u603b\u7ed3\u4e86\u672c\u4f8b\u4e2d\u5bf9\u4e24\u4e2aBAR\u90fd\u5199\u5165\u51681\u540e\u518d\u8fdb\u884c\u914d\u7f6e\u8bfb\u7684\u8bfb\u53d6\u7ed3\u679c\u3002</p> <p>\\3.    \u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u7684\u6700\u540e\u4e00\u6b65\u5c31\u662f\u7cfb\u7edf\u8f6f\u4ef6\u4e3a\u8fd9\u4e00\u5bf9BAR\u5206\u914d\u4e00\u4e2a\u5730\u5740\u8303\u56f4\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86\u8fd9\u4e00\u5bf9BAR\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u56fe 4\u20115\u7684\uff083\uff09\u4e2d\u5c55\u793a\u4e86\u8fd9\u4e24\u4e2aBAR\u5904\u4e8e\u7b2c\u4e09\u9636\u6bb5\u7684\u6837\u5b50\uff0c\u8f6f\u4ef6\u5df2\u7ecf\u901a\u8fc7\u4e24\u6b21\u914d\u7f6e\u5199\u64cd\u4f5c\u5c06\u5206\u914d\u7684\u5730\u5740\u533a\u57df\u768464bit\u8d77\u59cb\u5730\u5740\u5199\u5165BAR 1\u4e0eBAR 2\u7684\u7ec4\u5408\u4f53\u4e2d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u9ad8\u4f4dBAR\u7684bit 1\uff08BAR pair\u7684bit 33\uff09\u88ab\u7f6e\u4e3a1\uff0c\u4f4e\u4f4dBAR\u7684bit 30\uff08\u4e5f\u662fBAR pair\u7684bit 30\uff09\u4e5f\u88ab\u7f6e\u4e3a1\uff0c\u8fd9\u8868\u793a\u5176\u5b9e\u5730\u5740\u4e3a2_4000_0000h\u3002\u4e24\u4e2aBAR\u4e2d\u6240\u6709\u5176\u4ed6\u7684\u53ef\u5199bit\u90fd\u5df2\u88ab\u6e05\u96f6\u3002</p> <p>\u5230\u8fd9\u91cc\u4e3a\u6b62\uff0cBAR Pair\uff08BAR 1\u548cBAR 2\uff09\u7684\u914d\u7f6e\u5c31\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002\u4e00\u65e6\u8f6f\u4ef6\u542f\u7528\u4e86\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command register\uff0c\u504f\u79fb\u5730\u574004h\uff09\u4e2d\u7684\u5185\u5b58\u5730\u5740\u8bd1\u7801\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bbe\u5907\u5c31\u4f1a\u63a5\u53d7\u6240\u6709\u5730\u5740\u57282_4000_0000h-2_4300_0000h\uff0864MB\u5927\u5c0f\uff09\u8fd9\u4e2a\u8303\u56f4\u5185\u7684memory\u8bf7\u6c42\u3002</p> <p></p> <p>\u56fe 4\u20115\u8bbe\u7f6e\u5efa\u7acb64bit\u53ef\u9884\u53d6\u5185\u5b58\u7684BAR</p> <p></p> <p>\u8868 4\u20112\u5c06\u4e24\u4e2aBAR\u90fd\u5199\u5165\u4e3a\u51681\u540e\u7684\u8bfb\u53d6\u7ed3\u679c</p>"},{"location":"pcie/all/#424-bar3io","title":"4.2.4     BAR\u793a\u4f8b3\u2014\u2014IO\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42","text":"<p>\u8ba9\u6211\u4eec\u5728\u524d\u9762\u4e24\u4e2a\u4f8b\u5b50\u7684\u57fa\u7840\u4e0a\u7ee7\u7eed\uff0c\u6211\u4eec\u5047\u8bbe\u5f53\u524d\u7684Function\u8fd8\u9700\u8981\u8bf7\u6c42IO\u7a7a\u95f4\uff0c\u5982\u56fe 4\u20116\u6240\u793a\u3002\u5728\u56fe\u4e2d\uff0c\u8fdb\u884c\u8bf7\u6c42\u7684BAR\uff08\u672c\u4f8b\u4e2d\u4e3aBAR 3\uff09\u5728\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u5206\u4e3a3\u4e2a\u8282\u70b9\uff1a</p> <p>\\1.    \u5728\u56fe 4\u20116\u4e2d\u7684\uff081\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230BAR 3\u5904\u4e8e\u672a\u521d\u59cb\u5316\u7684\u72b6\u6001\u3002\u7cfb\u7edf\u8f6f\u4ef6\u6b64\u524d\u5df2\u7ecf\u5c06\u6bcf\u4e00\u4e2aBAR\u90fd\u5199\u5165\u4e86\u51681\uff08\u5199\u5165BAR\u4e2d\u53ef\u5199\u7684bit\uff0c\u4e0d\u53ef\u5199\u7684\u4e0d\u53d7\u5f71\u54cd\uff09\uff0c\u5e76\u4e14\u5df2\u7ecf\u5bf9BAR 0\u3001BAR 1 BAR 2\u7ec4\u6210\u7684BAR Pair\u8fdb\u884c\u4e86\u8bc4\u4f30\u3002\u73b0\u5728\u8f6f\u4ef6\u8981\u7ee7\u7eed\u770b\u770b\u8bbe\u5907\u662f\u5426\u8fd8\u9700\u8981\u901a\u8fc7BAR 3\u6765\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\u3002\u56fe 4\u20116\u4e2d\u7684\u72b6\u6001\uff082\uff09\u5c55\u793a\u4e86BAR 3\u88ab\u5199\u5165\u51681\u540e\u7684\u6837\u5b50\u3002</p> <p>\\2.    \u8f6f\u4ef6\u73b0\u5728\u5c06\u4f1a\u8bfb\u53d6BAR 3\u7684\u5185\u5bb9\uff0c\u4ee5\u6b64\u6765\u8bc4\u4f30\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\u548c\u7c7b\u578b\u3002\u8868 4\u20113\u4e2d\u603b\u7ed3\u4e86\u672c\u6b21\u914d\u7f6e\u8bfb\u7684\u8bfb\u53d6\u7ed3\u679c\u3002</p> <p>\\3.    \u8bfb\u53d6BAR 3\u7684\u5185\u5bb9\u4e4b\u540e\uff0c\u8f6f\u4ef6\u5c31\u77e5\u9053\u4e86\u8fd9\u4e2a\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42\u662f\u8981\u8bf7\u6c42256byte\u5927\u5c0f\u7684IO\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u8f6f\u4ef6\u7684\u6700\u540e\u4e00\u6b65\u64cd\u4f5c\u5c31\u662f\u8981\u4e3a\u8bbe\u5907\u5206\u914d\u4e00\u4e2aIO\u5730\u5740\u7a7a\u95f4\u8303\u56f4\uff0c\u5e76\u5c06\u8fd9\u4e2a\u5730\u5740\u8303\u56f4\u7684\u8d77\u59cb\u5730\u5740\u5199\u5165BAR 3\u3002\u56fe 4\u20116\u4e2d\u7684\u72b6\u6001\uff083\uff09\u6240\u5c55\u793a\u7684BAR 3\u5c31\u662f\u5b8c\u6210\u4e86\u5199\u5165\u8d77\u59cb\u5730\u5740\u7684\u6837\u5b50\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u8fd9\u4e2a\u8bbe\u5907\u7684\u8d77\u59cb\u5730\u5740\u4e3a16KB\uff0c\u6240\u4ee5bit 14\u662f\u88ab\u7f6e\u4e3a1\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u57fa\u5730\u5740\u4e3a4000h\uff0c\u6240\u6709\u7684\u9ad8\u4f4dbit\u90fd\u662f\u6e050\u7684\u3002</p> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5bf9BAR 3\u7684\u914d\u7f6e\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002\u4e00\u65e6\u8f6f\u4ef6\u542f\u7528\u4e86\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command register\uff0c\u504f\u79fb\u5730\u574004h\uff09\u4e2d\u7684IO\u5730\u5740\u8bd1\u7801\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bbe\u5907\u5c31\u4f1a\u63a5\u53d7\u5e76\u54cd\u5e94\u6240\u6709\u5730\u5740\u57284000h-40FFh\uff08256Byte\u5927\u5c0f\uff09\u8fd9\u4e2a\u8303\u56f4\u5185\u7684IO\u4e8b\u52a1\u3002</p> <p></p> <p>\u56fe 4\u20116 IO BAR\u7684\u8bbe\u7f6e\u5efa\u7acb</p> <p></p> <p>\u8868 4\u20113 IO BAR\u88ab\u5199\u5165\u51681\u540e\u518d\u8bfb\u53d6\u7684\u8bfb\u53d6\u7ed3\u679c</p>"},{"location":"pcie/all/#425-bars","title":"4.2.5     \u6240\u6709\u7684BARs\u90fd\u5fc5\u987b\u6309\u987a\u5e8f\u88ab\u8bc4\u4f30","text":"<p>\u5728\u8bb2\u89e3\u4e86\u524d\u9762\u7684\u4e09\u4e2a\u793a\u4f8b\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u660e\u663e\u7684\u53d1\u73b0\uff0c\u8f6f\u4ef6\u5fc5\u987b\u6309\u987a\u5e8f\u6765\u5bf9BARs\u8fdb\u884c\u8bc4\u4f30\uff0c\u5373BAR 0\u2014BAR 1\u2014BAR 2\u2014BAR 3\u8fd9\u6837\u7684\u987a\u5e8f\u3002</p> <p>\u5927\u591a\u6570\u65f6\u5019\uff0cFunction\u5e76\u4e0d\u9700\u8981\u542f\u7528\u5168\u90e8\u76846\u4e2aBAR\u3002\u5373\u4f7f\u662f\u5728\u6211\u4eec\u4e0a\u9762\u4e3e\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e5f\u4ec5\u4ec5\u662f\u4f7f\u7528\u4e866\u4e2aBAR\u4e2d\u76844\u4e2a\u3002\u5982\u679c\u4e0a\u9762\u4f8b\u5b50\u7684\u57fa\u7840\u4e0a\u5e76\u4e0d\u9700\u8981\u7ee7\u7eed\u8bf7\u6c42\u66f4\u591a\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u9700\u8981\u5c06BAR 4\u548cBAR 5\u7684\u6240\u6709bit\u90fd\u5f3a\u5236\u56fa\u5b9a\u4e3a\u51680\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u5373\u4f7f\u8f6f\u4ef6\u4e5f\u5bf9BAR 4\u548cBAR 5\u7528\u914d\u7f6e\u5199\u6765\u5199\u5165\u51681\uff0cBAR 4\u548cBAR 5\u7684\u503c\uff08\u51680\uff09\u4e5f\u4e0d\u4f1a\u53d7\u5230\u914d\u7f6e\u5199\u7684\u5f71\u54cd\u3002\u5728\u5bf9BAR 3\u8fdb\u884c\u5b8c\u8bc4\u4f30\uff08evaluate\uff09\u4e4b\u540e\uff0c\u8f6f\u4ef6\u9700\u8981\u7ee7\u7eed\u53bb\u8bc4\u4f30BAR 4\u3002\u4e00\u65e6\u8f6f\u4ef6\u68c0\u6d4b\u5230BAR 4\u4e2d\u6ca1\u6709bit\u88ab\u7f6e\u4e3a1\uff08\u56e0\u4e3aBAR 4\u7684\u6240\u6709bit\u90fd\u88ab\u5f3a\u5236\u56fa\u5b9a\u4e3a0\uff09\uff0c\u8f6f\u4ef6\u5c31\u77e5\u9053\u8fd9\u4e2aBAR\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u7136\u540e\u7ee7\u7eed\u53bb\u8bc4\u4f30\u4e0b\u4e00\u4e2aBAR\uff08\u4e5f\u5c31\u662fBAR 5\uff09\u3002</p> <p>\u5373\u4f7f\u8f6f\u4ef6\u53d1\u73b0\u4e86\u4e00\u4e2aBAR\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u6240\u6709\u7684BAR\u4e5f\u90fd\u5fc5\u987b\u88ab\u8bc4\u4f30\u3002\u5728PCI\u6216\u8005PCIe\u4e2d\uff0c\u5e76\u6ca1\u6709\u89c4\u5b9a\u8bf4\u4e00\u5b9a\u8981\u4ee5BAR 0\u6765\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7528\u6765\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u7684BAR\u3002\u5982\u679c\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u9700\u8981\u7684\u8bdd\uff0c\u4ed6\u4eec\u4e5f\u53ef\u4ee5\u9009\u62e9\u6bd4\u5982\u8bf4BAR 4\u6765\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u7684BAR\uff0c\u5e76\u5c06BAR 0\u3001BAR 1\u3001BAR 2\u3001BAR 3\u3001BAR 5\u7684\u6240\u6709bit\u90fd\u5f3a\u5236\u56fa\u5b9a\u4e3a0\u3002\u8fd9\u4e5f\u518d\u4e00\u6b21\u8bf4\u660e\u4e86\u8f6f\u4ef6\u5fc5\u987b\u6309\u7167\u987a\u5e8f\u5bf9Header\u4e2d\u7684\u6bcf\u4e00\u4e2aBAR\u90fd\u8fdb\u884c\u8bc4\u4f30\u3002</p>"},{"location":"pcie/all/#426-barsresizable-bars","title":"4.2.6     \u5927\u5c0f\u53ef\u53d8\u7684BARs\uff08Resizable BARs\uff09","text":"<p>\u5728PCIe\u534f\u8bae\u76842.1\u7248\u672c\u4e2d\u65b0\u52a0\u5165\u7684\u4e00\u4e2a\u7279\u6027\uff0c\u652f\u6301\u6539\u53d8BAR\u4e2d\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u8fd9\u79cd\u7279\u6027\u662f\u901a\u8fc7\u5728\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\u5185\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u80fd\u529b\u7ed3\u6784\uff08Capability Structure\uff09\u6765\u5b9e\u73b0\u7684\u3002\u65b0\u7684Capability Structure\u4f7f\u5f97Function\u80fd\u591f\u516c\u5e03\u5b83\u53ef\u4ee5\u64cd\u4f5c\u7684\u5730\u5740\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u7136\u540e\u8ba9\u8f6f\u4ef6\u6839\u636e\u5b9e\u9645\u53ef\u7528\u7684\u7cfb\u7edf\u8d44\u6e90\u6765\u9009\u7528Function\u6240\u516c\u5e03\u7684\u5730\u5740\u7a7a\u95f4\u5927\u5c0f\u4e2d\u7684\u67d0\u4e00\u79cd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aFunction\u7406\u60f3\u60c5\u51b5\u4e0b\u8981\u62e5\u67092GB\u7684\u53ef\u9884\u53d6\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08Prefetchable Memory Address Space\uff09\uff0c\u4f46\u662f\u5b83\u4e5f\u53ef\u4ee5\u53ea\u4f7f\u75281GB\u3001512MB\u6216\u8005256MB\u7684P-MMIO\u8fdb\u884c\u64cd\u4f5c\uff0c\u5047\u5982\u8bf4\u7cfb\u7edf\u8f6f\u4ef6\u65e0\u6cd5\u5bb9\u7eb3\u66f4\u5927\u7684\u3001\u5927\u4e8e256MB\u7684\u5730\u5740\u7a7a\u95f4\u8bf7\u6c42\uff0c\u90a3\u4e48\u7cfb\u7edf\u8f6f\u4ef6\u5e94\u8be5\u5c31\u53ea\u80fd\u4f7fFunction\u8bf7\u6c42256MB\u7684\u5730\u5740\u7a7a\u95f4\u3002</p>"},{"location":"pcie/all/#43-baselimitbase-and-limit-registers","title":"4.3 Base\u5bc4\u5b58\u5668\u548cLimit\u5bc4\u5b58\u5668\uff08Base and Limit Registers\uff09","text":""},{"location":"pcie/all/#431-general","title":"4.3.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u4e00\u65e6\u4e00\u4e2aFunction\u7684BAR\u4eec\u90fd\u88ab\u7f16\u7a0b\u5199\u5165\u4e86\uff0c\u8fd9\u4e2aFunction\u5c31\u77e5\u9053\u81ea\u5df1\u6240\u62e5\u6709\u7684\u5730\u5740\u8303\u56f4\u4e86\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2aFunction\u5c06\u4f1a\u628a\u4efb\u4f55\u76ee\u7684\u5730\u5740\u5728\u8fd9\u4e00\u8303\u56f4\u5185\u7684\u4e8b\u52a1\u90fd\u58f0\u660e\u4e3a\u81ea\u5df1\u7684\uff0c\u8fd9\u4e2a\u5730\u5740\u8303\u56f4\u5c31\u662f\u88ab\u5199\u5165\u5b83\u7684\u67d0\u4e00\u4e2aBAR\u7684\u5730\u5740\u8303\u56f4\u3002\u8fd9\u6ca1\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u662f\u66f4\u91cd\u8981\u7684\u662f\u8981\u8ba4\u8bc6\u5230\uff0cFunction\u8981\u201c\u770b\u5230\u201d\u5b83\u5e94\u8be5\u58f0\u660e\u7684\u4e8b\u52a1\u7684\u552f\u4e00\u529e\u6cd5\u662f\uff0c\u5b83\u4e0a\u65b9\u7684Bridge\u9700\u8981\u5c06\u8fd9\u4e9b\u4e8b\u52a1\u5411\u4e0b\u8f6c\u53d1\u5230\u8fd9\u4e2a\u76ee\u6807Function\u6240\u8fde\u63a5\u7684\u76f8\u5e94\u7684\u94fe\u8def\u3002\u56e0\u6b64\uff0c\u6bcf\u4e2aBridge\uff08\u4f8b\u5982Switch\u7684\u7aef\u53e3\u548cRC\u7aef\u53e3\uff09\u90fd\u9700\u8981\u77e5\u9053\u5b83\u4e0b\u65b9\u6240\u5b58\u5728\u7684\u53ef\u7528\u5730\u5740\u8303\u56f4\uff0c\u8fd9\u6837Bridge\u624d\u80fd\u786e\u5b9a\u54ea\u4e9b\u8bf7\u6c42\u9700\u8981\u4ece\u5b83\u7684\u4e3b\u63a5\u53e3\uff08Primary interface\uff0c\u5b83\u5728\u4e0a\u65b9\uff09\u88ab\u8f6c\u53d1\u5230\u5b83\u7684\u6b21\u7ea7\u63a5\u53e3\uff08Secondary interface\uff0c\u5b83\u5728\u4e0b\u65b9\uff09\u3002\u5982\u679c\u4e00\u4e2a\u8bf7\u6c42\u7684\u76ee\u6807\u5730\u5740\u662f\u8fd9\u4e2aBridge\u4e0b\u65b9Function\u7684BAR\u4e2d\u7684\u5730\u5740\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bf7\u6c42\u5c31\u5e94\u8be5\u88ab\u8f6c\u53d1\u5230Bridge\u7684\u6b21\u7ea7\u63a5\u53e3\u3002</p> <p>\u5728Bridge\u7684Type 1 Header\u4e2d\u6709Base\u5bc4\u5b58\u5668\u548cLimit\u5bc4\u5b58\u5668\uff0c\u800cBridge\u4e0b\u65b9\u7684\u5730\u5740\u8303\u56f4\u5c06\u4f1a\u88ab\u7f16\u7a0b\u5199\u5165\u8fd9\u4e24\u79cd\u5bc4\u5b58\u5668\u3002\u5728\u6bcf\u4e2aType 1 Header\u4e2d\u53ef\u4ee5\u770b\u5230\u67093\u5957Base\u3001Limit\u5bc4\u5b58\u5668\u3002\u4e4b\u6240\u4ee5\u9700\u8981\u4e09\u5957\u662f\u56e0\u4e3a\u4e00\u4e2aBridge\u4e0b\u7684\u5730\u5740\u8303\u56f4\u53ef\u4ee5\u88ab\u5206\u6210\u4e09\u7c7b\uff1a</p> <p>n \u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\uff08P-MMIO\uff09</p> <p>n \u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\uff08NP-MMIO\uff09</p> <p>n IO\u7a7a\u95f4\uff08IO\uff09</p> <p>\u4e3a\u4e86\u89e3\u91ca\u8fd9\u4e9bBase\u548cLimit\u5bc4\u5b58\u5668\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u8ba9\u6211\u4eec\u5728\u4e0a\u4e00\u8282\u7684\u4f8b\u5b50\u4e0a\u7ee7\u7eed\u8fdb\u884c\u8bb2\u89e3\uff0c\u5e76\u5c06\u4e0a\u4e00\u8282\u4f8b\u5b50\u4e2d\u90a3\u4e2a\u5df2\u7ecf\u5b8c\u6210BAR\u914d\u7f6e\u7684EP\u653e\u5728\u4e00\u4e2aSwitch\u7684\u4e0b\u65b9\uff0c\u5982\u56fe 4\u20117\u6240\u793a\u3002\u56fe\u4e2d\u4e5f\u5217\u51fa\u4e86\u8fd9\u4e2aFunction\u4e2d\u5404\u4e2aBAR\u6240\u62e5\u6709\u7684\u5730\u5740\u8303\u56f4\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u4e0b\u65b9\u5b58\u5728EP\u7684Bridge\u6765\u8bf4\uff0c\u5b83\u7684Base\u548cLimit\u5bc4\u5b58\u5668\u90fd\u9700\u8981\u88ab\u7f16\u7a0b\u5199\u5165\uff0c\u4f46\u5728\u5f00\u59cb\u8fd9\u4e2a\u5199\u5165\u8fc7\u7a0b\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u5173\u6ce8\u4e00\u4e0b\u8fde\u63a5\u5230\u6211\u4eec\u793a\u4f8bEP\u7684Bridge\uff0c\u4e5f\u5c31\u662fSwitch\u7684Port B\u3002</p> <p></p> <p>\u56fe 4\u20117\u8bbe\u7f6e\u5efa\u7acbBase\u548cLimit\u5bc4\u5b58\u5668\u503c\u7684\u793a\u4f8b\u7684\u62d3\u6251</p>"},{"location":"pcie/all/#432-p-mmioprefetchable-range","title":"4.3.2     P-MMIO\u53ef\u9884\u53d6\u8303\u56f4\uff08Prefetchable Range\uff09","text":"<p>Type 1 Header\u6709\u4e24\u5bf9\u53ef\u9884\u53d6\u5185\u5b58base/limit\u5bc4\u5b58\u5668\u3002\u88ab\u79f0\u4e3aPrefetchable Memory Base/Limit\u7684\u5bc4\u5b58\u5668\u8981\u50a8\u5b58\u53ef\u9884\u53d6\u5730\u5740\u8303\u56f4\u7684\u4f4e32bit\u5730\u5740\u4fe1\u606f\u3002\u5982\u679c\u8fd9\u4e2aBridge\u652f\u6301\u5bf964bit\u5730\u5740\u8fdb\u884c\u8bd1\u7801\uff0c\u90a3\u4e48\u53e6\u4e00\u4e2a\u88ab\u79f0\u4e3aPrefetchable Memory Base/Limit Upper 32bits\u5bc4\u5b58\u5668\u5c31\u4e5f\u9700\u8981\u88ab\u542f\u7528\uff0c\u8981\u7528\u5b83\u6765\u50a8\u5b58\u5730\u5740\u8303\u56f4\u7684\u9ad832bit\uff0c\u4e5f\u5c31\u662fbit[63:32]\u3002\u56fe 4\u20118\u4e2d\u5c55\u793a\u4e86\u8f6f\u4ef6\u5e94\u8be5\u5199\u5165\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4ee5\u6b64\u6765\u6307\u793a\u8fd9\u4e2aBridge\uff08Switch\u7684Port B\uff09\u4e0b\u65b9\u7684\u53ef\u9884\u53d6\u5730\u5740\u8303\u56f4\u4e3a2_4000_0000h-2_43FF_FFFFh\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\u90fd\u88ab\u603b\u7ed3\u5728\u4e86\u8868 4\u20114\u4e2d\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20114\u4e2d\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <p>n Prefetchable Memory Base\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a4001h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit BASE\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Base\u5730\u5740\u4e2d\u7684\u4f4e20bit\u5168\u662f0\uff0c\u8fd9\u610f\u5473\u7740Base\u5730\u5740\u603b\u662f\u57281MB\u8fb9\u754c\u4e0a\u5bf9\u9f50\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u7528\u4e8e\u6307\u793aBridge\u4e2d\u662f\u5426\u652f\u630164bit\u5730\u5740\u8bd1\u7801\uff0c\u8fd94bit\u503c\u4e3a1\u5219\u610f\u5473\u7740Upper Base/Limit\u5bc4\u5b58\u5668\u8981\u88ab\u542f\u7528\u3002</p> <p>n Prefetchable Memory Limit\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a43F1h\u3002</p> <p>n \u7528\u6cd5\u4e0eBase\u5bc4\u5b58\u5668\u76f8\u4f3c\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit LIMIT\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Limit\u5730\u5740\u7684\u4f4e20bit\u4e3a\u51681\uff0816\u8fdb\u5236\u4e0b\u90fd\u662fF\uff09\u3002\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u548cbase\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u542b\u4e49\u76f8\u540c\u3002</p> <p>n Prefetchable Memory Base Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a00000002h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9\u53ef\u9884\u53d6\u5185\u5b58\u768464bit BASE\u5730\u5740\u7684\u9ad832bit\u3002</p> <p>n Prefetchable Memory Limit Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a00000002h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9\u53ef\u9884\u53d6\u5185\u5b58\u768464bit Limit\u5730\u5740\u7684\u9ad832bit\u3002</p> <p></p> <p>\u56fe 4\u20118\u793a\u4f8b\u4e2dPrefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u503c</p> <p></p> <p>\u8868 4\u20114\u793a\u4f8b\u4e2dPrefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u542b\u4e49</p>"},{"location":"pcie/all/#433-np-mmionon-prefetchable-range","title":"4.3.3     NP-MMIO\u4e0d\u53ef\u9884\u53d6\u8303\u56f4\uff08Non-Prefetchable Range\uff09","text":"<p>\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\u53ea\u652f\u630132bit\u5730\u5740\uff0c\u8fd9\u4e00\u70b9\u4e0d\u540c\u4e8e\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\u8303\u56f4\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e0d\u53ef\u9884\u53d6\u5185\u5b58\u7a7a\u95f4\u6765\u8bf4\uff0c\u53ea\u67091\u4e2abase\u5bc4\u5b58\u5668\u548c1\u4e2alimit\u5bc4\u5b58\u5668\u3002\u6309\u7167\u56fe 4\u20117\u7684\u793a\u4f8b\uff0cPort B\u7684Bridge\u4e2d\u7684Non-Prefetchable Memory Base/Limit\u5bc4\u5b58\u5668\u5e94\u8be5\u88ab\u5199\u5165\u7684\u503c\u88ab\u5c55\u793a\u5728\u56fe 4\u20119\u4e2d\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\u90fd\u88ab\u603b\u7ed3\u5728\u4e86\u8868 4\u20115\u4e2d\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20115\u4e2d\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <p>n Non-Prefetchable Memory Base\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3aF900h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit BASE\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Base\u5730\u5740\u4e2d\u7684\u4f4e20bit\u5168\u662f0\uff0c\u8fd9\u610f\u5473\u7740Base\u5730\u5740\u603b\u662f\u57281MB\u8fb9\u754c\u4e0a\u5bf9\u9f50\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u5fc5\u987b\u8981\u4e3a0\u3002</p> <p>n Non-Prefetchable Memory Limit\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3aF900h\u3002</p> <p>n \u7528\u6cd5\u4e0eBase\u5bc4\u5b58\u5668\u76f8\u4f3c\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u9ad812bit\u7528\u6765\u5b58\u653e32bit LIMIT\u5730\u5740\u7684\u9ad812bit\uff0c\u4e5f\u5c31\u662f[31:20]\u3002Limit\u5730\u5740\u7684\u4f4e20bit\u4e3a\u51681\uff0816\u8fdb\u5236\u4e0b\u90fd\u662fF\uff09\u3002\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u548cbase\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u542b\u4e49\u76f8\u540c\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u5fc5\u987b\u8981\u4e3a0\u3002</p> <p></p> <p>\u56fe 4\u20119\u793a\u4f8b\u4e2dNon-Prefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u503c</p> <p></p> <p>\u8868 4\u20115\u793a\u4f8b\u4e2dNon-Prefetchable Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u542b\u4e49</p> <p>\u8fd9\u4e2a\u4f8b\u5b50\u5c55\u793a\u4e86\u4e00\u4e2a\u5f88\u6709\u8da3\u7684\u60c5\u51b5\uff0c\u90a3\u5c31\u662f\u5b9e\u9645\u4e0aPort B\u4e0b\u65b9\u7684EP\u6240\u62e5\u6709\u7684NP-MMIO\u8303\u56f4\u5927\u5c0f\u4e3a4KB\uff0c\u4f46\u662fPort B\u7684\u914d\u7f6e\u7a7a\u95f4\u5374\u8868\u793a\u51fa\u4e861MB\u7684\u8303\u56f4\uff0c\u8fd9\u8fdc\u5927\u4e8e4KB\u3002\u8fd9\u662f\u56e0\u4e3aType 1 Header\u4e2d\u7684base/limit\u5bc4\u5b58\u5668\u53ea\u80fd\u7528\u6765\u8868\u793a\u5730\u5740\u7684[31:20]\u3002\u4f4e20bit\u4e5f\u5c31\u662f[19:0]\uff0c\u5219\u4f1a\u88ab\u9690\u53bb\u3002\u56e0\u6b64\u5185\u5b58\u7a7a\u95f4base/limit\u5bc4\u5b58\u5668\u6240\u80fd\u6807\u5fd7\u7684\u6700\u5c0f\u8303\u56f4\u5c31\u662f1MB\u3002</p> <p>\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0cEP\u8bf7\u6c42\u5e76\u88ab\u6388\u4e88\u4e864KB\u7684NP-MMIO\uff08F900_0000h-F900_0FFFh\uff09\u3002\u800cPort B\u4e2dNP-MMIO\u7684base/limit\u5bc4\u5b58\u5668\u88ab\u5199\u5165\u7684\u503c\u5219\u6307\u793a\u4e86\u8fd9\u4e2aPort\u4e0b\u5b58\u5728\u7684NP-MMIO\u5927\u5c0f\u4e3a1MB\uff08F900_0000h-F90F_FFFFh\uff09\uff0c\u6216\u8005\u8bf4\u662f1024KB\u3002\u8fd9\u610f\u5473\u7740\u67091020KB\u7684\u5185\u5b58\u5730\u5740\u7a7a\u95f4\uff08F900_1000h-F90F_FFFFh\uff09\u88ab\u6d6a\u8d39\u4e86\u3002\u5373\u4f7f\u8fd9\u6837\uff0c\u8fd9\u4e9b\u88ab\u6d6a\u8d39\u7684\u5730\u5740\u7a7a\u95f4\u4e5f**\u4e00\u5b9a\u4e0d\u80fd**\u88ab\u5206\u914d\u7ed9\u5176\u4ed6\u7684EP\uff0c\u5426\u5219\u8fd9\u4f1a\u5bfc\u81f4\u5bf9\u6570\u636e\u5305\u7684\u8def\u7531\u673a\u5236\u65e0\u6cd5\u5de5\u4f5c\u3002</p>"},{"location":"pcie/all/#434-ioio-range","title":"4.3.4     IO\u8303\u56f4\uff08IO Range\uff09","text":"<p>\u7c7b\u4f3c\u4e8e\u53ef\u9884\u53d6\u5185\u5b58\u8303\u56f4\uff0cType 1 Header\u4e2dIO base/limit\u5bc4\u5b58\u5668\u4e5f\u6709\u4e24\u5bf9\u3002\u88ab\u79f0\u4e3aIO Base/Limit\u7684\u5bc4\u5b58\u5668\u7528\u4e8e\u5b58\u653eIO\u5730\u5740\u8303\u56f4\u7684\u4f4e16bit\u5730\u5740\u4fe1\u606f\u3002\u82e5\u8fd9\u4e2aBridge\u652f\u630132bit IO\u5730\u5740\u7684\u8bd1\u7801\u64cd\u4f5c\uff08\u73b0\u5b9e\u8bbe\u5907\u4e2d\u5f88\u5c11\u89c1\uff09\uff0c\u90a3\u4e48\u5c31\u8981\u542f\u7528IO Base/Limit Upper 16Bits\u5bc4\u5b58\u5668\u6765\u5b58\u653e\u5730\u5740\u4fe1\u606f\u7684\u9ad816bit\uff0c\u4e5f\u5c31\u662fIO\u5730\u5740\u8303\u56f4\u7684[31:16]\u3002\u6309\u7167\u6211\u4eec\u7684\u524d\u9762\u7684\u793a\u4f8b\uff0c\u5728\u56fe 4\u201110\u4e2d\u7ed9\u51fa\u4e86\u8f6f\u4ef6\u8981\u5199\u5165\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4ee5\u6b64\u6765\u8868\u793a\u8fd9\u4e2aBridge\uff08Port B\uff09\u4e4b\u4e0b\u5b58\u5728\u7684IO\u5730\u5740\u8303\u56f4\u4e3a4000h-4FFFh\u3002\u8fd9\u4e9b\u5bc4\u5b58\u5668\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u542b\u4e49\u90fd\u88ab\u603b\u7ed3\u5728\u4e86\u8868 4\u20116\u4e2d\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20116\u4e2d\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <p>n IO Base\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a40h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u5bc4\u5b58\u5668\u7684\u9ad84bit\u7528\u6765\u5b58\u653e16bit BASE\u5730\u5740\u7684\u9ad84bit\uff0c\u4e5f\u5c31\u662f[15:12]\u3002Base\u5730\u5740\u4e2d\u7684\u4f4e12bit\u5168\u662f0\uff0c\u8fd9\u610f\u5473\u7740Base\u5730\u5740\u603b\u662f\u57284KB\u8fb9\u754c\u4e0a\u5bf9\u9f50\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u7528\u4e8e\u6307\u793aBridge\u4e2d\u662f\u5426\u652f\u630132bit\u5730\u5740\u8bd1\u7801\uff0c\u8fd94bit\u503c\u4e3a1\u5219\u610f\u5473\u7740Upper Base/Limit\u5bc4\u5b58\u5668\u8981\u88ab\u542f\u7528\u3002</p> <p>n IO Limit\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a40h\u3002</p> <p>n \u7528\u6cd5\u4e0eBase\u5bc4\u5b58\u5668\u76f8\u4f3c\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u9ad84bit\u7528\u6765\u5b58\u653e16bit LIMIT\u5730\u5740\u7684\u9ad84bit\uff0c\u4e5f\u5c31\u662f[15:12]\u3002Limit\u5730\u5740\u7684\u4f4e12bit\u4e3a\u51681\uff0816\u8fdb\u5236\u4e0b\u90fd\u662fF\uff09\u3002\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u548cbase\u5bc4\u5b58\u5668\u7684\u4f4e4bit\u542b\u4e49\u76f8\u540c\u3002</p> <p>n IO Base Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a0000h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9IO\u5730\u5740\u7a7a\u95f4\u768432bit BASE\u5730\u5740\u7684\u9ad816bit\u3002</p> <p>n IO Limit Upper 32bits\u5bc4\u5b58\u5668\uff1a</p> <p>n \u503c\u4e3a0000h\u3002</p> <p>n \u7528\u6cd5\u4e3a\uff0c\u8fd9\u4e2a\u5bc4\u5b58\u5668\u7528\u6765\u5b58\u653e\u8fd9\u4e2a\u7aef\u53e3\u4e0b\u65b9IO\u5730\u5740\u7a7a\u95f4\u768432bit Limit\u5730\u5740\u7684\u9ad816bit\u3002</p> <p></p> <p>\u56fe 4\u201110\u793a\u4f8b\u4e2dIO Memory Base/Limit \u5bc4\u5b58\u5668\u7684\u503c</p> <p></p> <p>\u8868 4\u20116\u793a\u4f8b\u4e2dIO Base/Limit \u5bc4\u5b58\u5668\u7684\u542b\u4e49</p> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53c8\u770b\u5230\u4e86\u4e00\u79cd\u60c5\u51b5\uff0cBridge\u88ab\u7f16\u7a0b\u5199\u5165\u7684\u5730\u5740\u7a7a\u95f4\u8981\u8fdc\u5927\u4e8e\u5176\u4e0b\u65b9\u7684Function\u6240\u62e5\u6709\u7684\u7684\u5b9e\u9645IO\u5730\u5740\u7a7a\u95f4\u3002\u4f8b\u5b50\u4e2dEP\u62e5\u6709\u7684\u5730\u5740\u7a7a\u95f4\u4e3a256Byte\uff084000h-40FFh\uff09\u3002\u800cPort B\u88ab\u7f16\u7a0b\u5199\u5165\u7684\u503c\u5374\u8868\u793a\u5176\u4e0b\u65b9\u5b58\u5728\u7684IO\u5730\u5740\u7a7a\u95f4\u4e3a4KB\uff084000h-4FFFh\uff09\u3002\u540c\u524d\u9762\u8ba8\u8bbaMMIO\u65f6\u4e00\u6837\uff0c\u8fd9\u4e5f\u662fType 1 Header\u7684\u4e00\u79cd\u5c40\u9650\u3002\u5bf9\u4e8e\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u6765\u8bf4\uff0c\u4f4e12bit\uff08bit[11:0]\uff09\u7684\u503c\u662f\u88ab\u9690\u53bb\u7684\uff0c\u56e0\u6b64\u80fd\u88ab\u6307\u5b9a\u7684IO\u5730\u5740\u8303\u56f4\u7684\u6700\u5c0f\u503c\u5c31\u662f4KB\u3002\u8fd9\u79cd\u5c40\u9650\u6bd4\u5185\u5b58\u8303\u56f4\u4e2d\u76841MB\u6700\u5c0f\u7a97\u53e3\uff081MB minimum window\uff09\u8981\u66f4\u52a0\u4e25\u91cd\u3002\u5728\u57fa\u4e8ex86\uff08Intel\u517c\u5bb9\uff09\u7684\u7cfb\u7edf\u4e2d\uff0c\u5904\u7406\u5668\u4ec5\u652f\u630116bit\u7684IO\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u7531\u4e8eIO\u5730\u5740\u4fe1\u606f\u4ec5\u6709bit[15:12]\u662f\u53ef\u4ee5\u88ab\u6307\u5b9a\u5728Bridge\u4e2d\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u6700\u591a\u5c31\u53ea\u80fd\u670916\u4e2a\uff0824\uff09\u4e0d\u540c\u7684IO\u5730\u5740\u8303\u56f4\u3002</p>"},{"location":"pcie/all/#435-baselimit","title":"4.3.5     \u672a\u88ab\u4f7f\u7528\u7684Base\u548cLimit\u5bc4\u5b58\u5668","text":"<p>\u5e76\u4e0d\u662f\u6bcf\u4e2aPCIe\u8bbe\u5907\u90fd\u4f1a\u4f7f\u7528\u5168\u90e8\u76843\u79cd\u5730\u5740\u7a7a\u95f4\uff08P-MMIO\u3001NP-MMIO\u3001IO\uff09\u3002\u5b9e\u9645\u4e0a\uff0cPCIe\u534f\u8bae\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528IO\u5730\u5740\u7a7a\u95f4\uff0c\u5b83\u4ec5\u4ec5\u662f\u53d7\u4e00\u4e9b\u4f20\u7edf\u9057\u7559\u539f\u56e0\u7684\u652f\u6301\uff0c\u5e76\u6709\u53ef\u80fd\u5728\u672a\u6765\u65b0\u7248\u672c\u7684\u534f\u8bae\u4e2d\u88ab\u5f03\u7528\u3002</p> <p>\u6211\u4eec\u6765\u5047\u8bbe\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e00\u4e2aEP\u4e2d\u5e76\u6ca1\u6709\u8bf7\u6c42\u4f7f\u7528\u6240\u6709\u76843\u79cd\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u6837\u7684\u8bbe\u5907\u4e0a\u65b9\u7684Bridge\u6765\u8bf4\uff0c\u5b83\u7684base\u548climit\u5bc4\u5b58\u5668\u5e94\u8be5\u88ab\u914d\u6210\u4ec0\u4e48\u503c\u5462\uff1f\u9996\u5148\uff0c\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u7b80\u5355\u5730\u5c31\u628a\u5b83\u4eec\u5199\u5165\u51680\uff0c\u56e0\u4e3a\u4f4e\u4f4d\u7684\u88ab\u9690\u53bb\u7684\u5730\u5740bit\u4f9d\u7136\u662f\u4e0d\u540c\u7684\uff08base\u4e2d\u4f4e\u4f4dbit\u8ba4\u4e3a\u51680\uff0climit\u4e2d\u4f4e\u4f4dbit\u8ba4\u4e3a\u5168F\uff09\uff0c\u8fd9\u4f9d\u7136\u4f1a\u8868\u793a\u51fa\u4e00\u4e2a\u6709\u6548\u7684\u5730\u5740\u8303\u56f4\u3002\u6240\u4ee5\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u60c5\u51b5\uff0c\u5c31\u5fc5\u987b\u4ee4base\u5bc4\u5b58\u5668\u4e2d\u7684\u5199\u5165\u503c\u5927\u4e8elimit\u5bc4\u5b58\u5668\u7684\u5199\u5165\u503c\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aEP\u5e76\u6ca1\u6709\u8bf7\u6c42IO\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u8fd9\u4e2aFunction\u4e0a\u65b9\u76f4\u63a5\u76f8\u8fde\u7684Bridge\u5c06\u4f1a\u628aIO Limit\u5bc4\u5b58\u5668\u5199\u4e3a00h\uff0c\u5c06IO Base\u5bc4\u5b58\u5668\u5199\u4e3aF0h\u3002\u7531\u4e8eBase\u5730\u5740\u5927\u4e8eLimit\u5730\u5740\uff0cBridge\u4f1a\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u65e0\u6548\u7684\u8bbe\u7f6e\uff0c\u5e76\u4ee5\u6b64\u6765\u8ba4\u5b9a\u5176\u4e0b\u65b9\u6ca1\u6709Function\u62e5\u6709IO\u5730\u5740\u7a7a\u95f4\u3002\uff08\u8fd9\u91cc\u539f\u4e66\u4e2d\u6709\u8bef\uff0c\u5199\u6210\u4e86\u5c06limit\u914d\u7f6e\u4e3a\u5927\u4e8ebase\uff0c\u8fd9\u4e2a\u9519\u8bef\u5728errata\u4e2d\u5df2\u7ecf\u5217\u51fa\uff09</p> <p>\u8fd9\u79cd\u4f7fbase\u548climit\u5bc4\u5b58\u5668\u65e0\u6548\u5316\u914d\u7f6e\u7684\u65b9\u6cd5\u5bf9\u4e8e\u6240\u6709\u76843\u79cdbase/limit\u5bc4\u5b58\u5668\u90fd\u662f\u53ef\u884c\u7684\uff0c\u800c\u4e0d\u53ea\u662f\u9488\u5bf9IO base/limit\u5bc4\u5b58\u5668\u3002</p>"},{"location":"pcie/all/#44-sanity-checkregisters-used-for-address-routing","title":"4.4 \u5b8c\u6574\u6027\u68c0\u67e5\uff1a\u5bf9\u6240\u6709\u7528\u4e8e\u5730\u5740\u8def\u7531\u7684\u5bc4\u5b58\u5668\uff08Sanity Check\uff1aRegisters Used For Address Routing\uff09","text":"<p>\u4e3a\u4e86\u786e\u4fdd\u4f60\u5df2\u7ecf\u7406\u89e3\u4e86\u8bbe\u7f6e\u5efa\u7acbBARs\u548cBase/Limit\u5bc4\u5b58\u5668\u7684\u89c4\u5219\u548c\u65b9\u6cd5\uff0c\u8bf7\u4ed4\u7ec6\u67e5\u770b\u56fe 4\u201111\uff0c\u4ee5\u4fdd\u8bc1\u4f60\u5bf9\u5b83\u4eec\u7684\u6b63\u786e\u8ba4\u77e5\u3002\u6211\u4eec\u5df2\u7ecf\u7b80\u5355\u7684\u5bf9\u793a\u4f8b\u7cfb\u7edf\u8fdb\u884c\u4e86\u6269\u5c55\uff0c\u5728Switch\u7684Port A\u4e0b\u65b9\u52a0\u5165\u4e86\u53e6\u4e00\u4e2aEP\u4ee5\u53ca\u5b83\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\u3002\u8981\u8bb0\u5f97\uff0cType 1 Header\u4e2d\u4e5f\u542b\u67092\u4e2aBAR\uff0c\u5b83\u4eec\u4e5f\u53ef\u4ee5\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\u3002\u800c\u4e00\u4e2aBridge\u7684Base/Limit\u5bc4\u5b58\u5668\u8868\u793a\u7684\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u5e76\u4e0d\u5305\u62ecBridge\u81ea\u8eab\u7684BAR\u6240\u8bf7\u6c42\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u4e5f\u5c31\u662f\u8bf4Base/Limit\u5bc4\u5b58\u5668\u53ea\u8868\u793aBridge\u4e0b\u65b9\u5b58\u5728\u7684\u5730\u5740\u7a7a\u95f4\u3002</p> <p></p> <p>\u56fe 4\u201111\u6700\u7ec8\u7684\u5730\u5740\u8def\u7531\u793a\u4f8b\u5efa\u7acb</p>"},{"location":"pcie/all/#45-tlptlp-routing-basics","title":"4.5 TLP\u8def\u7531\u57fa\u7840\uff08TLP Routing Basics\uff09","text":"<p>\u5728\u524d\u51e0\u4e2a\u5c0f\u8282\u4e2d\u6240\u8bb2\u8ff0\u7684\u8bbe\u7f6e\u5efa\u7acbBARs\u548cBase/Limit\u5bc4\u5b58\u5668\u7684\u76ee\u7684\uff0c\u662f\u4e3a\u4e86\u786e\u4fdd\u6d41\u91cf\uff08traffic\uff09\u53ef\u4ee5\u88ab\u6b63\u786e\u7684\u8def\u7531\u5230\u5b83\u7684\u76ee\u7684Function\uff0c\u8fd9\u6837\u5b50\u8fd9\u4e2a\u76ee\u7684Function\u5c31\u53ef\u4ee5\u770b\u89c1\u8fd9\u4e9b\u6d41\u91cf\u4e2d\u7684\u4e8b\u52a1\u5e76\u58f0\u660e\u5bf9\u8fd9\u4e9b\u4e8b\u52a1\u7684\u6240\u6709\u6743\u3002\u5728\u4f8b\u5982PCI\u7684\u8fd9\u79cd\u5171\u4eab\u603b\u7ebf\uff08Share-Bus\uff09\u7ed3\u6784\u4e2d\uff0c\u6240\u6709\u7684\u6d41\u91cf\u5bf9\u4e8e\u603b\u7ebf\u4e0a\u7684\u6bcf\u4e2a\u8bbe\u5907\u90fd\u662f\u53ef\u89c1\u7684\u3002\u53ea\u6709\u5f53\u6d41\u91cf\u7684\u76ee\u7684\u5730\u5728\u53e6\u4e00\u6761\u603b\u7ebf\uff0c\u4e5f\u5c31\u662f\u5fc5\u987b\u8de8\u8d8a\u4e00\u4e2aBridge\u65f6\uff0c\u624d\u4f1a\u5bf9\u8bf7\u6c42\u8fdb\u884c\u8def\u7531\u3002\u7531\u4e8ePCIe\u94fe\u8def\u662f\u70b9\u5bf9\u70b9\u7684\uff08point-to-point\uff09\uff0c\u90a3\u4e48\u5728\u8bbe\u5907\u95f4\u53d1\u9001\u4e8b\u52a1\u65f6\u5c31\u9700\u8981\u66f4\u591a\u7684\u8def\u7531\u64cd\u4f5c\u4e86\u3002</p> <p></p> <p>\u56fe 4\u201112\u591a\u7aef\u53e3\u7684PCIe\u8bbe\u5907\u6709\u8fdb\u884c\u8def\u7531\u7684\u804c\u8d23</p> <p>\u5982\u56fe 4\u201112\u6240\u5c55\u73b0\u7684\u8fd9\u6837\uff0c\u4e00\u4e2aPCIe\u62d3\u6251\u4f7f\u7528\u72ec\u7acb\u7684\u3001\u70b9\u5bf9\u70b9\u7684\u94fe\u8def\u6765\u5c06\u5404\u4e2a\u8bbe\u5907\u4e0e\u5b83\u4eec\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u90bb\u8bbe\u5907\uff08neighbors\uff09\u76f8\u8fde\u63a5\u3002\u5f53\u6d41\u91cf\u5230\u8fbe\u94fe\u8def\u63a5\u53e3\u7684\u5165\u7ad9\u7aef\uff08inbound side\uff0c\u6216\u79f0\u4e3aingress port\u5165\u53e3\u7aef\u53e3\uff09\uff0c\u8fd9\u4e2a\u7aef\u53e3\u5c06\u4f1a\u8fdb\u884c\u9519\u8bef\u6821\u9a8c\uff0c\u7136\u540e\u505a\u51fa\u5982\u4e0b\u7684\u4e09\u4e2a\u51b3\u5b9a\u4e2d\u7684\u4e00\u4e2a\uff1a</p> <p>\\1.    \u63a5\u6536\u8fd9\u4e2a\u6d41\u91cf\u5e76\u5728\u81ea\u8eab\u5185\u90e8\u4f7f\u7528\u5b83\u3002</p> <p>\\2.    \u5c06\u8fd9\u4e2a\u6d41\u91cf\u8f6c\u53d1\u81f3\u76f8\u5e94\u7684\u51fa\u7ad9\uff08outbound\uff0c\u6216\u8005egress\u51fa\u53e3\uff09\u7aef\u53e3\u3002</p> <p>\\3.    \u62d2\u7edd\u8fd9\u4e2a\u6d41\u91cf\uff0c\u56e0\u4e3a\u5165\u53e3\u7aef\u53e3\u81ea\u8eab\u65e2\u4e0d\u662f\u8fd9\u4e2a\u6d41\u91cf\u7684\u9884\u671f\u7684\u76ee\u6807\uff0c\u4e5f\u4e0d\u662f\u4e00\u4e2a\u7528\u6765\u5bf9\u5b83\u8fdb\u884c\u8f6c\u53d1\u7684\u63a5\u53e3\u3002\uff08\u6ce8\u610f\uff0c\u8fd8\u5b58\u5728\u5176\u4ed6\u53ef\u80fd\u7684\u539f\u56e0\u5bfc\u81f4\u6d41\u91cf\u88ab\u62d2\u7edd\uff09</p>"},{"location":"pcie/all/#451-3recievers-check-for-three-types-of-traffic","title":"4.5.1     \u63a5\u6536\u5668\u68c0\u67e53\u79cd\u7c7b\u578b\u7684\u6d41\u91cf\uff08Recievers Check For Three Types of Traffic\uff09","text":"<p>\u5047\u8bbe\u4e00\u6761\u94fe\u8def\u5904\u4e8e\u5b8c\u5168\u53ef\u5de5\u4f5c\u72b6\u6001\uff0c\u90a3\u4e48\u6bcf\u4e2a\u8bbe\u5907\u7684\u63a5\u6536\u63a5\u53e3\uff08\u5165\u53e3\u7aef\u53e3ingress port\uff09\u5fc5\u987b\u5bf9\u5230\u8fbe\u7684\u4e09\u79cd\u94fe\u8def\u6d41\u91cf\u8fdb\u884c\u68c0\u6d4b\u548c\u8bc4\u4f30\uff1aOrdered Sets\uff08\u547d\u4ee4\u96c6\uff09\u3001DLLPs\uff08Data Link Layer Packets\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u4ee5\u53caTLPs\uff08Transaction Layer Packets\u4e8b\u52a1\u5c42\u5305\uff09\u3002Ordered Sets\u548cDLLPs\u5bf9\u4e8e\u94fe\u8def\u6765\u8bf4\u662f\u672c\u5730\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u4e0d\u7528\u88ab\u8def\u7531\u5230\u53e6\u4e00\u6761\u94fe\u8def\u3002TLP\u53ef\u4ee5\u5e76\u4e14\u4e5f\u6709\u53ef\u80fd\u9700\u8981\u88ab\u4ece\u4e00\u6761\u94fe\u8def\u642c\u79fb\u5230\u53e6\u4e00\u6761\u94fe\u8def\uff0c\u8fd9\u5176\u4e2d\u6240\u57fa\u4e8e\u7684\u8def\u7531\u4fe1\u606f\u5b58\u5728\u4e8e\u6570\u636e\u5305\u7684Header\u4e2d\u3002</p>"},{"location":"pcie/all/#452-routing-elements","title":"4.5.2     \u8def\u7531\u5143\u4ef6\uff08Routing Elements\uff09","text":"<p>\u5bf9\u4e8e\u50cfRC\u548cSwitch\u8fd9\u6837\u5177\u6709\u591a\u4e2a\u7aef\u53e3\u7684\u8bbe\u5907\u6765\u8bf4\uff0c\u5b83\u4eec\u53ef\u4ee5\u5728\u7aef\u53e3\u4e4b\u95f4\u8f6c\u53d1TLPs\uff0c\u5b83\u4eec\u6709\u65f6\u4e5f\u88ab\u79f0\u4f5cRouting Agent\uff08\u8def\u7531\u5a92\u4ecb\uff09\u6216\u662fRouting Element\uff08\u8def\u7531\u5143\u4ef6\uff09\u3002\u5b83\u4eec\u4f1a\u63a5\u53d7\u76ee\u6807\u4e3a\u81ea\u8eab\u5185\u90e8\u8d44\u6e90\u7684TLP\uff0c\u4e5f\u4f1a\u5c06TLP\u5728\u81ea\u8eab\u5165\u53e3\u7aef\u53e3\u548c\u51fa\u53e3\u7aef\u53e3\u4e4b\u95f4\u8fdb\u884c\u8f6c\u53d1\u3002</p> <p>\u6709\u8da3\u7684\u662f\uff0cSwitch\u9700\u8981\u652f\u6301Peer-to-Peer\u7684\u8def\u7531\uff0c\u4f46\u662f\u5bf9\u4e8eRC\u6765\u8bf4\u8fd9\u9879\u529f\u80fd\u662f\u53ef\u9009\u7684\u3002Peer-to-Peer\u6d41\u91cf\u901a\u5e38\u662f\u4e00\u4e2aEP\u5411\u53e6\u4e00\u4e2aEP\u53d1\u9001\u6570\u636e\u5305\u3002</p> <p>EP\u53ea\u6709\u4e00\u6761\u94fe\u8def\uff0c\u5e76\u4e14\u5b83\u6c38\u8fdc\u4e0d\u5e0c\u671b\u770b\u5230\u4e00\u4e2a\u76ee\u7684\u5730\u4e0d\u662fEP\u81ea\u5df1\u7684\u6d41\u91cf\uff0c\u5bf9\u4e8e\u5b83\u6765\u8bf4\u53ea\u4f1a\u7b80\u5355\u5730\u63a5\u53d7\u6216\u8005\u62d2\u7edd\u8f93\u5165\u7684TLPs\uff0c\u800c\u4e0d\u4f1a\u8fdb\u884c\u8f6c\u53d1\u3002</p>"},{"location":"pcie/all/#453-tlpthree-methods-of-tlp-routing","title":"4.5.3     TLP\u8def\u7531\u7684\u4e09\u79cd\u65b9\u6cd5\uff08Three Methods of TLP Routing\uff09","text":""},{"location":"pcie/all/#4531-general","title":"4.5.3.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>TLP\u53ef\u4ee5\u88ab\u57fa\u4e8e\u5730\u5740\u8def\u7531\uff08Memory\u6216IO\uff09\uff0c\u53ef\u4ee5\u88ab\u57fa\u4e8eID\u8def\u7531\uff08Bus\u2014Device\u2014Function\uff09\uff0c\u6216\u8005\u8fd8\u53ef\u4ee5\u88ab\u9690\u5f0f\u8def\u7531\uff08routed implicitly\uff09\u3002\u5177\u4f53\u4f7f\u7528\u7684\u8def\u7531\u529e\u6cd5\u8981\u6839\u636eTLP\u7c7b\u578b\u6765\u51b3\u5b9a\u3002\u8868 4\u20117\u603b\u7ed3\u4e86TLP\u7c7b\u578b\u548c\u8def\u7531\u65b9\u6cd5\u7684\u5bf9\u5e94\u5173\u7cfb\u3002</p> <p></p> <p>\u8868 4\u20117 PCIe TLP\u7c7b\u578b\u5bf9\u5e94\u7684\u8def\u7531\u65b9\u6cd5</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0cMessage\u662f\u552f\u4e00\u4e00\u79cd\u652f\u6301\u591a\u79cd\u8def\u7531\u65b9\u6cd5\u7684TLP\u7c7b\u578b\u3002PCIe\u534f\u8bae\u4e2d\u5b9a\u4e49\u7684\u5927\u591a\u6570message\u4f7f\u7528\u7684\u662f\u9690\u5f0f\u8def\u7531\uff0c\u7136\u800c\u7531\u5382\u5546\u5b9a\u4e49\u7684message\u5219\u6839\u636e\u9700\u8981\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5730\u5740\u8def\u7531\u6216\u8005ID\u8def\u7531\u3002</p>"},{"location":"pcie/all/#4532-messagepurpose-of-implicit-routing-and-message","title":"4.5.3.2   \u9690\u5f0f\u8def\u7531\u548cMessage\u7684\u76ee\u7684\uff08Purpose of Implicit Routing and Message\uff09","text":"<p>\u5728\u9690\u5f0f\u8def\u7531\u4e2d\uff0c\u4e0d\u4f7f\u7528\u5730\u5740\u6216\u8005ID\u8fd9\u79cd\u8def\u7531\u4fe1\u606f\uff1b\u76f8\u53cd\uff0c\u8fd9\u4e2a\u6570\u636e\u5305\u662f\u6839\u636e\u5305\u5934\u4e2d\u7684\u4e00\u4e2a\u4ee3\u7801\uff08code\uff09\u6765\u8fdb\u884c\u8def\u7531\u7684\uff0c\u8fd9\u4e2a\u4ee3\u7801\u6307\u793a\u7684\u76ee\u7684\u5730\u662f\u62d3\u6251\u7ed3\u6784\u4e2d\u4e00\u4e2a\u5df2\u77e5\u7684\u4f4d\u7f6e\uff0c\u4f8b\u5982RC\u3002\u8fd9\u79cd\u65b9\u6cd5\u7b80\u5316\u4e86\u4f7f\u7528\u9690\u5f0f\u8def\u7531\u7684message\u8def\u7531\u3002</p>"},{"location":"pcie/all/#l-messagewhy-messages","title":"l \u4e3a\u4ec0\u4e48\u662fMessage\uff1f\uff08Why Messages\uff1f\uff09","text":"<p>Message\u4e8b\u52a1\u5728PCI\u548cPCI-X\u4e2d\u5e76\u6ca1\u6709\u88ab\u5b9a\u4e49\uff0c\u4f46\u662f\u5728PCIe\u4e2d\u88ab\u5f15\u5165\u3002\u52a0\u5165Message\u4f5c\u4e3a\u4e00\u79cd\u6570\u636e\u5305\u7c7b\u578b\u7684\u4e3b\u8981\u7684\u539f\u56e0\u662f\uff0c\u4e3a\u4e86\u7ee7\u7eed\u8fdb\u884cPCIe\u7684\u8bbe\u8ba1\u76ee\u6807\u4e4b\u4e00\uff0c\u4e5f\u5c31\u662f\u5927\u5e45\u5ea6\u5730\u51cf\u5c11\u4ee5\u524dPCI\u4e2d\u7684\u8fb9\u5e26\u4fe1\u53f7\uff08sideband signals\uff09\u7684\u4f7f\u7528\uff0c\u4f8b\u5982\u4e2d\u65adpins\u3001\u9519\u8befpins\u3001\u7535\u6e90\u7ba1\u7406\u4fe1\u53f7\u7b49\u7b49\u3002\u56e0\u6b64\uff0c\u5927\u591a\u6570\u7684\u8fb9\u5e26\u4fe1\u53f7\u90fd\u88ab\u5e26\u5185\uff08in-band\uff09\u6570\u636e\u5305\u6240\u66ff\u4ee3\uff0c\u8fd9\u4e9b\u6570\u636e\u5305\u7684\u5f62\u5f0f\u5c31\u662fMessage TLP\u3002</p>"},{"location":"pcie/all/#l-how-implicit-routing-helps","title":"l \u9690\u5f0f\u8def\u7531\u662f\u600e\u4e48\u63d0\u4f9b\u5e2e\u52a9\u7684\uff1f\uff08How Implicit Routing Helps\uff1f\uff09","text":"<p>\u8981\u4f7f\u7528\u5e26\u5185Message\u6765\u66ff\u4ee3\u8fb9\u5e26\u4fe1\u53f7\uff0c\u5c31\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u5c06\u8fd9\u4e9bMessage\u8def\u7531\u5230\u6b63\u786e\u7684\u6536\u4ef6\u65b9\uff08recipient\uff09\u90a3\u91cc\u53bb\uff0c\u800cMessage\u7684\u6536\u4ef6\u65b9\u4f4d\u4e8e\u4e00\u4e2a\u7531\u6570\u91cf\u4f17\u591a\u7684\u70b9\u5230\u70b9\u94fe\u8def\u7ec4\u6210\u7684\u62d3\u6251\u7ed3\u6784\u4e2d\u3002\u9690\u5f0f\u8def\u7531\u5229\u7528\u4e86\u8fd9\u6837\u4e00\u4e2a\u4e8b\u5b9e\uff1aSwitch\u548c\u5176\u4ed6\u7684\u8def\u7531\u5143\u4ef6\u662f\u53ef\u4ee5\u7406\u89e3\u4e0a\u884c\uff08upstream\uff09\u548c\u4e0b\u884c\uff08downstream\uff09\u7684\u6982\u5ff5\u7684\uff0c\u4e14RC\u662f\u4f4d\u4e8e\u6574\u4e2a\u62d3\u6251\u7ed3\u6784\u7684\u6700\u9876\u7aef\uff0c\u800cEP\u5219\u662f\u4f4d\u4e8e\u62d3\u6251\u7ed3\u6784\u7684\u5e95\u90e8\u3002\u56e0\u6b64\u4e3e\u4f8b\u6765\u8bf4\uff0c\u4e00\u4e2aMessage\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u4ee3\u7801\u6765\u8868\u793a\u5b83\u5e94\u8be5\u88ab\u9001\u5f80RC\uff0c\u6216\u8005\u662f\u8981\u88ab\u9001\u5f80\u4e0b\u884c\u7684\u6240\u6709\u8bbe\u5907\u3002\u4e0a\u8ff0\u7684\u8fd9\u79cd\u80fd\u529b\u80fd\u591f\u6709\u6548\u7684\u51cf\u5c11\u5bf9\u5b9a\u4e49\u5730\u5740\u8303\u56f4\u6216\u662fID\u5217\u8868\u7684\u9700\u8981\uff0c\u800c\u539f\u672c\u662f\u9700\u8981\u9488\u5bf9\u4e0d\u540c\u7684Message\u6765\u5b9a\u4e49\u7279\u5b9a\u7684\u5730\u5740\u8303\u56f4\u6216\u662fID\u5217\u8868\u624d\u80fd\u5b8c\u6210\u8def\u7531\u3002</p> <p>\u4e0d\u540c\u7c7b\u578b\u7684\u9690\u5f0f\u8def\u7531\u7684\u76f8\u5173\u5185\u5bb9\u53ef\u4ee5\u53c2\u9605\u201cImplicit Routing\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/all/#454-split-transaction-protocol","title":"4.5.4     \u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff08Split Transaction Protocol\uff09","text":"<p>\u50cf\u5927\u591a\u6570\u5176\u4ed6\u4e32\u884c\u4f20\u8f93\u6280\u672f\u4e00\u6837\uff0cPCIe\u4f7f\u7528\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\uff08Split Transaction Protocol\uff09\uff0c\u5b83\u5141\u8bb8\u4e00\u4e2a\u76ee\u6807\u8bbe\u5907\u63a5\u6536\u4e00\u4e2a\u6216\u591a\u4e2a\u8bf7\u6c42\uff0c\u7136\u540e\u518d\u4f7f\u7528\u5355\u72ec\u7684\u5b8c\u6210\u5305\u6765\u5bf9\u8fd9\u4e9b\u8bf7\u6c42\u8fdb\u884c\u54cd\u5e94\u3002\u76f8\u6bd4\u4e8e\u5728PCI\u4e2d\u4f7f\u7528\u7b49\u5f85\u6001\uff08wait-state\uff09\u6216\u662f\u5ef6\u8fdf\u4f20\u8f93\uff08retry\uff09\u6765\u5904\u7406\u8bbf\u95ee\u76ee\u6807\u65f6\u51fa\u73b0\u7684\u5ef6\u8fdf\uff0c\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\u662f\u4e00\u79cd\u663e\u8457\u7684\u8fdb\u6b65\u3002\u62c6\u5206\u4e8b\u52a1\u534f\u8bae\u4e0d\u518d\u4f7f\u7528\u901a\u8fc7\u8bd5\u63a2\u76ee\u6807\u662f\u5426\u5904\u4e8eready\u624d\u8fdb\u884c\u8bbf\u95ee\u7684\u9ad8\u5ef6\u8fdf\u4f20\u8f93\u673a\u5236\uff0c\u800c\u662f\u4f7f\u7528\u76ee\u6807\u8bbe\u5907\u81ea\u5df1\u53d1\u8d77\u54cd\u5e94\u7684\u65b9\u5f0f\uff0c\u65e0\u8bba\u4f55\u65f6\u53ea\u8981\u76ee\u6807\u8bbe\u5907\u5904\u4e8eready\uff0c\u5b83\u90fd\u80fd\u81ea\u5df1\u53d1\u8d77\u54cd\u5e94\uff0c\u800c\u8fd9\u4e2a\u54cd\u5e94\u6240\u5bf9\u5e94\u7684\u8bf7\u6c42\u662f\u6b64\u524d\u5c31\u5df2\u7ecf\u7ed9\u5230\u76ee\u6807\u8bbe\u5907\u7684\u4e86\u3002\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u5f97\u6bcf\u4e2a\u4e8b\u52a1\u7684\u5b8c\u6210\u90fd\u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u5355\u72ec\u7684TLP\u2014\u2014Request\uff08\u8bf7\u6c42\u5305\uff09\u548cCompletion\uff08\u5b8c\u6210\u5305\uff09\uff0c\u800c\u6211\u4eec\u540e\u9762\u5c06\u4f1a\u8bb2\u5230\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5355\u72ec\u7684\u8bfb\u8bf7\u6c42\uff0c\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u5b8c\u6210\u5305\u8fd4\u56de\u3002\u56fe 4\u201113\u5c55\u793a\u4e86\u4e00\u4e2a\u62c6\u5206\u4e8b\u52a1\u4e2d\u7684Request-Completion\u7684\u7ec4\u6210\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u7684\u573a\u666f\u662f\u8f6f\u4ef6\u4eceEP\u8bfb\u53d6\u6570\u636e\u3002</p> <p></p> <p>\u56fe 4\u201113 PCIe\u4e8b\u52a1\u4e2d\u7684\u8bf7\u6c42TLP\u548c\u5b8c\u6210TLP</p>"},{"location":"pcie/all/#455-postednon-posted","title":"4.5.5     Posted\u4e0eNon-Posted","text":"<p>\u4e3a\u4e86\u51cf\u5c11Request-Completion\u5ef6\u8fdf\u6240\u5e26\u6765\u7684\u5f00\u9500\u548c\u635f\u5931\uff0cMWr\uff08Memory Write\uff09\u4e8b\u52a1\u662fPosted\u7684\uff0c\u8fd9\u610f\u5473\u7740\u4eceRequester\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u5f53\u8fd9\u4e2aPosted\u4e8b\u52a1\u521a\u4eceRequester\u53d1\u51fa\u53bb\uff0c\u5c31\u8ba4\u4e3a\u5b83\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002\u5982\u679c\u60f3\u5e2e\u52a9\u7406\u89e3\uff0c\u53ef\u4ee5\u5c06\u672f\u8bed\u201cPosting\uff08\u90ae\u5bc4\uff09\u201d\u548c\u90ae\u653f\u7cfb\u7edf\uff08postal system\uff09\u8054\u7cfb\u5230\u4e00\u8d77\uff0c\u56e0\u4e3a\u201c\u90ae\u5bc4\u201d\u4e00\u4e2aMWr\u548c\u90ae\u5bc4\u4e00\u5c01\u4fe1\u5341\u5206\u76f8\u4f3c\u3002\u4e00\u65e6\u4f60\u5c06\u8981\u90ae\u5bc4\u7684\u4fe1\u653e\u5165\u90ae\u5c40\u90ae\u7bb1\uff0c\u4f60\u5c31\u4f1a\u76f8\u4fe1\u90ae\u653f\u7cfb\u7edf\u4f1a\u628a\u5b83\u9001\u51fa\u53bb\uff0c\u800c\u4e0d\u5fc5\u53bb\u7b49\u5f85\u6295\u9012\u7684\u786e\u8ba4\u3002\u8fd9\u79cd\u65b9\u6cd5\u6bd4\u7b49\u5f85\u6574\u4e2aRequest-Completion\u4f20\u8f93\u5b8c\u6210\u8981\u5feb\u7684\u591a\u3002\u4f46\u662f\uff0c\u5728\u6240\u6709\u7684\u90ae\u5bc4\u65b9\u6848\u4e2d\u90fd\u4f1a\u5b58\u5728\u4e0d\u786e\u5b9a\u6027\uff0c\u4e8b\u52a1\u662f\u5426\u3001\u4f55\u65f6\u5728\u6700\u7ec8\u7684\u63a5\u6536\u65b9\u88ab\u6210\u529f\u5b8c\u6210\uff0c\u8fd9\u662f\u4e0d\u786e\u5b9a\u7684\u3002</p> <p>\u5728PCIe\u4e2d\uff0c\u5c3d\u7ba1\u6240\u6709\u7684Posted MWr\u4f1a\u5e26\u6765\u4e0d\u786e\u5b9a\u6027\uff0c\u4f46\u662f\u76f8\u6bd4\u4e8e\u8fd9\u79cd\u65b9\u6cd5\u83b7\u5f97\u7684\u6536\u76ca\u6765\u8bf4\uff0c\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\u662f\u6bd4\u8f83\u5c11\u91cf\u4e14\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5bf9IO\u548c\u914d\u7f6e\u7a7a\u95f4\u7684\u5199\u64cd\u4f5c\u51e0\u4e4e\u90fd\u4f1a\u5f71\u54cd\u8bbe\u5907\u7684\u884c\u4e3a\uff0c\u4e14\u8fd9\u79cd\u5f71\u54cd\u8fd8\u662f\u5b9e\u65f6\u4e0e\u8fd9\u4e24\u79cd\u5199\u64cd\u4f5c\u76f8\u5173\u8054\u7684\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u8fd9\u6837\u7684\u5199\u8bf7\u6c42\u6765\u8bf4\uff0c\u975e\u5e38\u6709\u5fc5\u8981\u77e5\u9053\u5b83\u4eec\u662f\u5426\u5b8c\u6210\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u5b8c\u6210\u3002\u57fa\u4e8e\u8fd9\u6837\u7684\u539f\u56e0\uff0cIO\u5199\u548c\u914d\u7f6e\u5199\u5fc5\u987b\u8981\u662fNon-Posted\u7684\uff0c\u5b83\u4eec\u603b\u662f\u9700\u8981\u6536\u5230\u4e00\u4e2a\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u6765\u62a5\u544a\u81ea\u8eab\u64cd\u4f5c\u7684\u72b6\u6001\u3002</p> <p>\u603b\u7ed3\u6765\u8bf4\uff0cNon-Posted\u4e8b\u52a1\u9700\u8981\u5b8c\u6210\u5305\uff0cPosted\u4e8b\u52a1\u4e0d\u9700\u8981\u5b8c\u6210\u5305\u800c\u4e14\u4e5f\u6c38\u8fdc\u4e0d\u5e94\u8be5\u6536\u5230\u4e00\u4e2a\u5b8c\u6210\u5305\u3002\u8868 4\u20118\u5217\u51fa\u4e86\u54ea\u4e9bPCIe\u4e8b\u52a1\u662fPosted\u7684\uff0c\u54ea\u4e9b\u662fNon-Posted\u7684\u3002</p> <p>\u4e0b\u9762\u5bf9\u8868 4\u20118\u7684\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\uff1a</p> <p>n Memory Write\uff1a</p> <p>\u6240\u6709\u7684Memory Write****\u8bf7\u6c42\u90fd\u662fPosted****\u7684\u3002\u4e0d\u9700\u8981\u8fd4\u56de\u5b8c\u6210\u5305\uff08Completion\uff09\u3002</p> <p>n Memory Read\u548cMemory Read Lock\uff1a</p> <p>\u6240\u6709\u7684Memory Read****\u8bf7\u6c42\u90fd\u662fNon-Posted****\u7684\u3002\u9700\u8981\u7531Completer\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\uff08\u8fd9\u4e2aCompletion\u7531\u4e00\u4e2a\u6216\u591a\u4e2aTLP\u7ec4\u6210\uff09\uff0cCompleter\u901a\u8fc7Completion\u6765\u4f20\u9012Requester\u6240\u8bf7\u6c42\u7684\u6570\u636e\u4ee5\u53ca\u5f53\u524dMemory Read\u4e8b\u52a1\u7684\u72b6\u6001\u3002\u82e5\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u7528\u4e8e\u62a5\u544a\u9519\u8bef\u72b6\u6001\u7684Completion\u5c06\u4e0d\u542b\u6709\u6570\u636e\u3002</p> <p>n AtomicOP\uff1a</p> <p>\u6240\u6709\u7684AtomicOP****\u8bf7\u6c42\u90fd\u662fNon-Posted****\u7684\u3002\u9700\u8981\u7531Completer\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\uff0c\u8fd9\u4e2aCompletion\u4e2d\u5305\u542b\u4e86\u76ee\u6807\u4f4d\u7f6e\u7684\u539f\u59cb\u503c\u3002</p> <p>n IO Read\u548cIO Write\uff1a</p> <p>\u6240\u6709\u7684IO****\u8bf7\u6c42\u90fd\u662fNon-Posted****\u7684\u3002\u5bf9\u4e8eIO Write\u548c\u5931\u8d25\u7684Read\u6765\u8bf4\uff0c\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u4e0d\u542b\u6709\u6570\u636e\u7684Completion\u3002\u800c\u5bf9\u4e8e\u6210\u529f\u7684Read\u6765\u8bf4\uff0c\u5219\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\u3002</p> <p>n Configuration Read\u548cConfiguration Write\uff1a</p> <p>\u6240\u6709\u7684Configuration****\u8bf7\u6c42\u90fd\u662fNon-Posted****\u7684\u3002\u4e0eIO\u8bf7\u6c42\u7c7b\u4f3c\uff0c\u5bf9\u4e8eConfiguration Write\u548c\u5931\u8d25\u7684Read\u6765\u8bf4\uff0c\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u4e0d\u542b\u6709\u6570\u636e\u7684Completion\u3002\u800c\u5bf9\u4e8e\u6210\u529f\u7684Read\u6765\u8bf4\uff0c\u5219\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6570\u636e\u7684Completion\u3002</p> <p>n Message\uff1a</p> <p>\u6240\u6709\u7684Message****\u8bf7\u6c42\u90fd\u662fPosted****\u7684\u3002\u867d\u7136\u8def\u7531\u65b9\u6cd5\u662f\u53d6\u51b3\u4e8eMessage\u7c7b\u578b\u7684\uff0c\u4f46\u662fMessage\u90fd\u88ab\u8ba4\u4e3a\u662fposted\u8bf7\u6c42\u3002</p> <p>\u7b80\u5355\u603b\u7ed3\u6765\u8bf4\uff0c\u53ea\u6709Memory Write\u548cMessage\u662f Posted\u7684\u3002</p> <p></p> <p>\u8868 4\u20118 Posted\u548cNon-Posted\u4e8b\u52a1</p>"},{"location":"pcie/all/#456-header","title":"4.5.6     Header\u4e2d\u5b9a\u4e49\u6570\u636e\u5305\u683c\u5f0f\u548c\u7c7b\u578b\u7684\u5b57\u6bb5","text":""},{"location":"pcie/all/#4561-general","title":"4.5.6.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5982\u56fe 4\u201114\u6240\u793a\uff0c\u6bcf\u4e2aTLP\u90fd\u542b\u6709\u4e00\u4e2a3\u4e2a\u62164\u4e2aDW\uff0812\u621616byte\uff09\u7684Header\u3002\u5728TLP Header\u4e2d\u542b\u6709Format\u548cType\u8fd9\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5b83\u4eec\u7528\u6765\u5b9a\u4e49\u5269\u4f59\u7684Header\u7684\u5185\u5bb9\uff0c\u5e76\u51b3\u5b9a\u51fa\u8fd9\u4e2aTLP\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u6e38\u8d70\u65f6\u4f7f\u7528\u7684\u8def\u7531\u65b9\u6cd5\u3002</p> <p></p> <p>\u56fe 4\u201114 TLP\u901a\u7528\u76843DW\u548c4DW Header</p>"},{"location":"pcie/all/#4562-headerformattype","title":"4.5.6.2   Header\u4e2dFormat/Type\u5b57\u6bb5\u7684\u7f16\u7801\u542b\u4e49","text":"<p>\u4e0b\u65b9\u7684\u8868 4\u20119\u4e2d\u603b\u7ed3\u4e86TLP Header\u4e2d\u7684Format\u548cType\u5b57\u6bb5\u7684\u7f16\u7801\u542b\u4e49\u3002</p> <p></p> <p>\u8868 4\u20119 TLP Header\u4e2dFormat\u548cType\u5b57\u6bb5\u7f16\u7801\u542b\u4e49</p>"},{"location":"pcie/all/#457-tlp-header","title":"4.5.7     TLP Header\u6982\u8ff0","text":"<p>\u5f53TLP\u5728\u5165\u53e3\u7aef\u53e3\uff08ingress port\uff09\u88ab\u63a5\u6536\u5230\uff0c\u9996\u5148\u8981\u5728\u7269\u7406\u5c42\u548c\u6570\u636e\u94fe\u8def\u5c42\u5bf9TLP\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\u3002\u5982\u679c\u68c0\u67e5\u65e0\u9519\uff0c\u90a3\u4e48\u518d\u7531\u4e8b\u52a1\u5c42\u6765\u68c0\u67e5\u5f53\u524dTLP\u4f7f\u7528\u7684\u662f\u54ea\u79cd\u8def\u7531\u65b9\u6cd5\u3002\u57fa\u7840\u7684\u6b65\u9aa4\u4e3a\uff1a</p> <p>\\1.    Format\u548cType\u5b57\u6bb5\u786e\u5b9a\u4e86TLP Header\u7684\u5927\u5c0f\u3001\u6570\u636e\u5305\u7684\u683c\u5f0f\u548c\u7c7b\u578b\u3002</p> <p>\\2.    \u6839\u636eTLP\u6240\u4f7f\u7528\u7684\u8def\u7531\u65b9\u6cd5\uff08\u4e0eType\u76f8\u5173\uff09\uff0c\u8bbe\u5907\u5c06\u786e\u5b9a\u8fd9\u4e2aTLP\u7684\u9884\u671f\u63a5\u6536\u8005\u662f\u5426\u5c31\u662f\u81ea\u5df1\u3002\u5982\u679c\u786e\u5b9e\u5c31\u662f\u81ea\u5df1\uff0c\u90a3\u4e48\u8bbe\u5907\u5c06\u63a5\u53d7\uff08\u6216\u8005\u8bf4\u662f\u6d88\u8017\uff09\u8fd9\u4e2aTLP\uff0c\u5426\u5219\u8bbe\u5907\u5c06\u4f1a\u628a\u8fd9\u4e2aTLP\u8f6c\u53d1\u5230\u76f8\u5e94\u7684\u51fa\u53e3\u7aef\u53e3\uff08egress port\uff09\u2014\u2014\u6839\u636e\u8be5\u51fa\u53e3\u7684\u6392\u5e8f\u548c\u6d41\u63a7\u89c4\u5219\u3002</p> <p>\\3.    \u5982\u679c\u8bbe\u5907\u65e2\u4e0d\u662fTLP\u7684\u9884\u671f\u63a5\u6536\u65b9\uff0c\u4e14\u8bbe\u5907\u4e5f\u5e76\u4e0d\u4f4d\u4e8e\u524d\u5f80\u9884\u671f\u63a5\u6536\u65b9\u7684\u8def\u5f84\u4e0a\uff0c\u90a3\u4e48\u5b83\u901a\u5e38\u4f1a\u901a\u8fc7\u4e00\u4e2a\u72b6\u6001\u5b57\u6bb5\u4e3aUnsupported Request\uff08UR\uff09\u7684\u5b8c\u6210\u5305\u6765\u62d2\u7edd\u8fd9\u4e2aTLP\u3002</p>"},{"location":"pcie/all/#46-applying-routing-mechanisms","title":"4.6 \u8def\u7531\u673a\u5236\u7684\u5e94\u7528\u65b9\u6cd5\uff08Applying Routing Mechanisms\uff09","text":"<p>\u4e00\u65e6\u914d\u7f6e\u5b8c\u4e86\u7cfb\u7edf\u5730\u5740\u5e76\u4e14\u4e5f\u5141\u8bb8\u5f00\u59cb\u6267\u884c\u4e8b\u52a1\uff0c\u8bbe\u5907\u5c06\u4f1a\u68c0\u67e5\u8f93\u5165\u7684TLP\u5e76\u4f7f\u7528\u76f8\u5e94\u7684\u914d\u7f6e\u5b57\u6bb5\u57df\u6765\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u8def\u7531\u3002\u4e0b\u9762\u7684\u5c0f\u8282\u5c06\u4f1a\u5bf9PCIe\u7ed3\u6784\u4e2d\u7684TLP\u8def\u7531\u673a\u5236\u57fa\u7840\u7279\u70b9\u548c\u529f\u80fd\u8fdb\u884c\u63cf\u8ff0\u3002</p>"},{"location":"pcie/all/#461-idid-routing","title":"4.6.1     ID\u8def\u7531\uff08ID Routing\uff09","text":"<p>ID\u8def\u7531\u662f\u7528\u6765\u6307\u5411\u4e00\u4e2a\u903b\u8f91\u4f4d\u7f6e\u2014\u2014Bus Num\uff0cDevice Num\uff0cFunction Num\uff0c\u6216\u8005\u4e00\u822c\u79f0\u4e3aBDF\uff0c\u8fd9\u4e2a\u903b\u8f91\u4f4d\u7f6e\u4e00\u822c\u662f\u62d3\u6251\u7ed3\u6784\u4e2d\u7684\u4e00\u4e2aFunction\u3002ID\u8def\u7531\u8fd9\u79cd\u673a\u5236\u5bf9PCI\u548cPCI-X\u534f\u8bae\u4e2d\u7528\u4e8e\u914d\u7f6e\u4e8b\u52a1\u8def\u7531\u7684\u65b9\u6cd5\u662f\u517c\u5bb9\u7684\u3002\u5728PCIe\u4e2d\uff0cID\u8def\u7531\u4ecd\u7136\u4f1a\u88ab\u7528\u6765\u8def\u7531\u914d\u7f6e\u5305\uff0c\u540c\u65f6\u5b83\u8fd8\u53ef\u4ee5\u7528\u6765\u8def\u7531\u5b8c\u6210\u5305\u548c\u4e00\u4e9bMessage\u3002</p>"},{"location":"pcie/all/#4611-busdevicefunction","title":"4.6.1.1   Bus\u53f7\uff0cDevice\u53f7\uff0cFunction\u53f7\u7684\u4f7f\u7528\u4e0a\u9650","text":"<p>PCIe\u652f\u6301\u7684\u62d3\u6251\u7ed3\u6784\u7684\u4e0a\u9650\u4e0ePCI\u548cPCI-X\u4e00\u6837\uff1a</p> <p>\\1.    \u4e00\u4e2a\u7cfb\u7edf\u4e2d\u53ef\u4ee5\u5b58\u5728\u7684\u6700\u5927\u603b\u7ebf\u6570\u91cf\u4e3a256\uff0c\u56e0\u4e3aBus\u53f7\u662f8bit\u4f4d\u5bbd\u7684\u3002\u8fd9\u4e2a\u603b\u7ebf\u6570\u91cf\u5305\u62ec\u4e86Switch\u4ea7\u751f\u7684\u5185\u90e8\u603b\u7ebf\u3002</p> <p>\\2.    \u6bcf\u6761\u603b\u7ebf\u4e0a\u6700\u591a\u53ef\u4ee5\u670932\u4e2a\u8bbe\u5907\uff0c\u56e0\u4e3aDevice\u53f7\u662f5bit\u4f4d\u5bbd\u7684\u3002\u4e00\u4e2a\u8001\u5f0f\u7684PCI\u603b\u7ebf\u6216\u662fSwitch\u3001RC\u7684\u5185\u90e8\u603b\u7ebf\u7684\u4e0b\u65b9\u53ef\u4ee5\u6302\u8f7d\u4e0d\u6b62\u4e00\u4e2a\u8bbe\u5907\uff0c\u7136\u800c\u5916\u90e8\u7684PCIe\u94fe\u8def\uff08external PCIe Links\uff09\u5c31\u5fc5\u987b\u8981\u662f\u70b9\u5230\u70b9\u7684\uff08point-to-point\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5916\u90e8PCIe\u94fe\u8def\u4e0b\u65b9\u53ea\u80fd\u6302\u8f7d\u4e00\u4e2a\u8bbe\u5907\u3002\u4e0b\u884c\u7aef\u53e3\uff08Switch\u6216RC\u7684\u4e0b\u884c\u7aef\u53e3\uff09\u4f1a\u5f3a\u5236\u5c06\u5916\u90e8\u94fe\u8def\u7684Device\u53f7\u5b9a\u4e3aDevice 0\uff0c\u56e0\u6b64\u6bcf\u4e2a\u5916\u90e8EP\u90fd\u603b\u4f1a\u662fDevice 0\u3002\u9664\u975e\u4f7f\u7528\u4e86\u66ff\u4ee3\u8def\u7531ID\u89e3\u91ca\uff08Alternative Routing-ID Interpretation\uff0cARI\uff09\uff0c\u82e5\u4f7f\u7528\u4e86ARI\u90a3\u4e48\u8fd9\u4e2a\u5916\u90e8Device\u5c06\u6ca1\u6709Device\u53f7\uff0c\u5173\u4e8eARI\u7684\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cIDO\uff08ID-based Ordering\uff09\u201d\u4e00\u8282\u3002</p> <p>\\3.    \u6bcf\u4e2a\u8bbe\u5907\u4e2d\u6700\u591a\u53ef\u4ee5\u67098\u4e2a\u5185\u90e8Function\uff0c\u56e0\u4e3aFunction\u53f7\u662f3bit\u4f4d\u5bbd\u7684\u3002</p>"},{"location":"pcie/all/#4612-tlp-headerid","title":"4.6.1.2   TLP Header\u4e2d\u6709\u5173ID\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5","text":"<p>\u5982\u679c\u4e00\u4e2a\u6536\u5230\u7684TLP\u4e2d\u7684Type\u5b57\u6bb5\u8868\u793a\u4e86\u8fd9\u4e2aTLP\u8981\u4f7f\u7528ID\u8def\u7531\uff0c\u90a3\u4e48TLP Header\u4e2d\u7684ID\u5b57\u6bb5\uff08Bus\uff0cDevice\uff0cFunction\uff09\u5c31\u8981\u7528\u6765\u6267\u884c\u8def\u7531\u68c0\u67e5\uff08routing check\uff09\u3002\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\u4f7f\u75283DW Header\u6765\u8fdb\u884cID\u8def\u7531\uff0c\u4f7f\u75284DW Header\u6765\u8fdb\u884cID\u8def\u7531\uff08\u8fd9\u53ea\u53ef\u80fd\u51fa\u73b0\u5728Message\u8def\u7531\u4e2d\uff09\u3002\u56fe 4\u201115\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u7528\u4e8eID\u8def\u7531\u76843DW Header\uff0c\u56fe 4\u201116\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u7528\u4e8eID\u8def\u7531\u76844DW Header\u3002</p> <p></p> <p>\u56fe 4\u201115 3DW TLP Header\u4e2d\u7684ID\u8def\u7531\u5b57\u6bb5</p> <p></p> <p>\u56fe 4\u201116 4DW TLP Header\u4e2d\u7684ID\u8def\u7531\u5b57\u6bb5</p>"},{"location":"pcie/all/#4613-ependpointone-check","title":"4.6.1.3   EP\u8fdb\u884c\u4e00\u6b21\u68c0\u67e5\uff08Endpoint\uff1aOne Check\uff09","text":"<p>\u5bf9\u4e8eID\u8def\u7531\uff0c\u4e00\u4e2aEP\u53ea\u4f1a\u7b80\u5355\u5730\u6839\u636e\u81ea\u5df1\u7684BDF\u6765\u68c0\u67e5TLP Header\u4e2d\u7684ID\u5b57\u6bb5\u3002\u6bcf\u5f53Function\u5728\u81ea\u5df1\u7684\u94fe\u8def\u4e0a\u63a5\u6536\u5230\u4e00\u4e2aType 0\u914d\u7f6e\u5199\u65f6\uff0cFunction\u5c06\u4f1a\u4ece\u914d\u7f6e\u5199\u4e8b\u52a1\u7684TLP Header\u7684byte8-9\u4e2d\u201c\u6355\u83b7Capture\u201d\u5230\u81ea\u5df1\u7684Bus\u53f7\u548cDevice\u53f7\u3002Function\u5fc5\u987b\u5c06Bus\u53f7\u548cDevice\u53f7\u5b58\u50a8\u4e0b\u6765\uff0c\u800c\u5177\u4f53\u662f\u5b58\u5728\u4ec0\u4e48\u5730\u65b9\u5728\u534f\u8bae\u4e2d\u5e76\u6ca1\u6709\u7279\u522b\u6307\u5b9a\u3002\u4fdd\u5b58\u4e0b\u6765\u7684Bus\u548cDevice\u53f7\u88ab\u53ef\u4ee5\u88ab\u7528\u4f5cRequester ID\uff0c\u4f8b\u5982\u5f53\u8fd9\u4e2aEP\u53d1\u8d77\u8bf7\u6c42\u540e\uff0c\u8bf7\u6c42\u7684Completer\u53ef\u4ee5\u5c06\u8fd9\u4e2aRequester ID\u653e\u8fdb\u5b8c\u6210\u5305\u5185\u6765\u8ba9\u5b8c\u6210\u5305\u88ab\u987a\u5229\u8def\u7531\u8fd4\u56de\uff0cRequester ID\u5c31\u662f\u8fd9\u4e2a\u5b8c\u6210\u5305\u7528\u6765\u8def\u7531\u7684\u4fe1\u606f\u3002</p>"},{"location":"pcie/all/#4614-switchesbridges","title":"4.6.1.4   Switches\uff08Bridges\uff09\u6bcf\u4e2a\u7aef\u53e3\u8fdb\u884c\u4e24\u6b21\u68c0\u67e5","text":"<p>\u56fe 4\u201117\u4e00\u4e2a\u4f7f\u7528ID\u8def\u7531\u7684\u5165\u7ad9TLP\u5728\u8fdb\u884cSwitch\u7684\u8def\u7531\u68c0\u67e5</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u4f7f\u7528ID\u8def\u7531\u7684TLP\u6765\u8bf4\uff0c\u4e00\u4e2aSwitch\u7aef\u53e3\u9996\u5148\u8981\u68c0\u67e5\u8fd9\u4e2aTLP\u7684\u9884\u671f\u76ee\u7684\u5730\u662f\u4e0d\u662f\u7aef\u53e3\u81ea\u8eab\uff0c\u8fd9\u79cd\u68c0\u67e5\u662f\u901a\u8fc7\u5c06\u7aef\u53e3\u81ea\u8eab\u7684BDF\u4e0eTLP Header\u4e2d\u7684\u76ee\u6807ID\u8fdb\u884c\u6bd4\u8f83\u6765\u8fdb\u884c\u7684\uff0c\u5982\u56fe 4\u201117\u4e2d\u7684\uff081\uff09\u6240\u793a\u3002\u4e0eEP\u4e00\u6837\uff0c\u6bcf\u4e2aSwitch\u7aef\u53e3\u5c06\u4f1a\u4ece\u4e0a\u884c\u7aef\u53e3\u53d1\u73b0\u7684\u6bcf\u6b21\u914d\u7f6e\u5199\uff08Type 0\uff09\u4e8b\u52a1\u4e2d\u6355\u83b7\u5230\u81ea\u5df1\u7684Bus\u53f7\u548cDevice\u53f7\u3002\u5982\u679cTLP\u4e2d\u7684\u76ee\u6807ID\u4e0eSwitch\u7aef\u53e3\u7684ID\u76f8\u540c\uff0c\u90a3\u4e48Switch\u7aef\u53e3\u5c31\u4f1a\u6d88\u8017\u6389\uff08consume\uff09\u8fd9\u4e2aTLP\uff0c\u4e5f\u5c31\u662f\u4e0d\u518d\u8f6c\u53d1\u5230\u5176\u4ed6\u5730\u65b9\u800c\u662f\u81ea\u5df1\u4f7f\u7528\u3002\u5982\u679c\u8fd9\u4e24\u4e2aID\u5b57\u6bb5\u5e76\u4e0d\u76f8\u540c\uff0c\u90a3\u4e48Switch\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u4f4d\u7f6e\u662f\u5426\u5728\u81ea\u5df1\u7684\u4e0b\u65b9\u3002\u8fd9\u4e2a\u68c0\u67e5\u7684\u65b9\u5f0f\u662f\uff0c\u901a\u8fc7\u68c0\u67e5\u6b21\u7ea7\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\uff08Secondary Bus Number Register\uff09\u548c\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number Register\uff09\u6765\u67e5\u770bTLP\u7684\u76ee\u6807\u603b\u7ebf\u53f7\u662f\u5426\u5728Switch\u7aef\u53e3\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff08\u5305\u62ec\u8303\u56f4\u8fb9\u754c\uff09\u3002\u5982\u679c\u5728\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u5c31\u5c06\u8fd9\u4e2aTLP\u5411\u4e0b\u8f6c\u53d1\u3002\u56fe 4\u201117\u4e2d\u7684\uff082\uff09\u6240\u8868\u793a\u7684\u5c31\u662f\u8fd9\u9879\u68c0\u67e5\u3002\u5982\u679c\u6570\u636e\u5305\u5230\u8fbeSwitch\u7684\u4e0a\u884c\u7aef\u53e3\uff0c\u4f46\u662f\u6ca1\u6709\u4e0e\u7aef\u53e3\u7684BDF\u76f8\u5339\u914d\uff0c\u4e14\u4e5f\u4e0d\u5728\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u88ab\u4f5c\u4e3a\u4e0a\u884c\u7aef\u53e3\u7684UR\uff08Unsupported Request\uff09\u6765\u5904\u7406\u3002</p> <p>\u5982\u679c\u4e0a\u884c\u7aef\u53e3\u786e\u5b9a\u4e86\u6240\u63a5\u6536\u5230\u7684TLP\u7684\u76ee\u7684\u5730\u662f\u5176\u4e0b\u65b9\u7684\u4e00\u4e2a\u8bbe\u5907\uff08\u4e5f\u5c31\u662f\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u603b\u7ebf\u5728\u4e0a\u884c\u7aef\u53e3\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u5185\uff09\uff0c\u90a3\u4e48\u4e0a\u884c\u7aef\u53e3\u5c31\u4f1a\u5c06TLP\u5411\u4e0b\u8f6c\u53d1\uff0cSwitch\u6240\u6709\u7684\u4e0b\u884c\u7aef\u53e3\u90fd\u4f1a\u5bf9\u8fd9\u4e2aTLP\u505a\u8ddf\u4e0a\u9762\u4e00\u6837\u7684\u68c0\u67e5\u3002\u6bcf\u4e2a\u4e0b\u884c\u7aef\u53e3\u90fd\u4f1a\u68c0\u67e5\u81ea\u5df1\u662f\u4e0d\u662fTLP\u7684\u76ee\u7684\u5730\uff0c\u5982\u679c\u662f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7aef\u53e3\u5c06\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\u800c\u5176\u4ed6\u7aef\u53e3\u5c06\u4f1a\u5ffd\u7565\u8fd9\u4e2aTLP\u3002\u5982\u679cTLP\u7684\u76ee\u7684\u5730\u5e76\u4e0d\u662f\u4efb\u4f55\u4e00\u4e2a\u4e0b\u884c\u7aef\u53e3\uff0c\u90a3\u4e48\u4e0b\u884c\u7aef\u53e3\u4eec\u90fd\u4f1a\u518d\u53bb\u68c0\u67e5TLP\u7684\u76ee\u6807\u8bbe\u5907\u662f\u5426\u5728\u81ea\u5df1\u4e0b\u65b9\u7684\u4ece\u5c5e\u603b\u7ebf\u8303\u56f4\u4e2d\u3002\u5982\u679c\u6709\u4e00\u4e2a\u4e0b\u884c\u7aef\u53e3\u68c0\u67e5\u5230\u4e86\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u8bbe\u5907\u5728\u81ea\u5df1\u7684\u4e0b\u65b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7aef\u53e3\u5c31\u4f1a\u5c06TLP\u8f6c\u53d1\u81f3\u81ea\u5df1\u7684\u6b21\u7ea7\u603b\u7ebf\uff0c\u4e14\u5176\u4ed6\u4e0b\u884c\u7aef\u53e3\u5c06\u4f1a\u5ffd\u7565\u8fd9\u4e2aTLP\u3002</p> <p>\u5728\u8fd9\u4e00\u8282\u4e2d\uff0c\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u662f\u8981\u8bb0\u4f4fSwitch\u4e2d\u7684\u6bcf\u4e00\u4e2a\u7aef\u53e3\uff08Port\uff09\u90fd\u662f\u4e00\u4e2aBridge\uff0c\u56e0\u6b64\u5b83\u4eec\u90fd\u6709\u81ea\u5df1\u7684\u914d\u7f6e\u7a7a\u95f4\uff0c\u5e76\u4e14\u5b83\u4eec\u7684\u914d\u7f6e\u7a7a\u95f4Header\u5fc5\u7136\u662fType 1 Header\u3002\u5c3d\u7ba1\u5728\u4e2d\u53ea\u5c55\u793a\u9664\u4e86\u4e0a\u884c\u7aef\u53e3\u7684Type 1 Header\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u7aef\u53e3\uff08\u6bcf\u4e2aP2P Bridge\uff09\u90fd\u6709\u81ea\u5df1\u7684Type 1 Header\uff0c\u5e76\u4e14\u5728\u6bcf\u4e2a\u7aef\u53e3\u6536\u5230TLP\u65f6\u90fd\u4f1a\u6267\u884c\u4e0a\u9762\u6240\u8ff0\u7684\u4e24\u6b21\u68c0\u67e5\u3002</p>"},{"location":"pcie/all/#462-address-routing","title":"4.6.2     \u5730\u5740\u8def\u7531\uff08Address Routing\uff09","text":"<p>\u4f7f\u7528\u5730\u5740\u8def\u7531\u7684TLP\u5f15\u7528\u7684\u5185\u5b58\uff08\u7cfb\u7edf\u5185\u5b58\u548c\u5185\u5b58\u6620\u5c04IO\uff09\u548cIO\u5730\u5740\u6620\u5c04\u548cPCI/PCI-X\u4e2d\u4e8b\u52a1\u5f15\u7528\u7684\u662f\u4e00\u6837\u7684\u3002\u5982\u679c\u4e00\u4e2aMemory\u8bf7\u6c42\u7684\u76ee\u6807\u5730\u5740\u5c0f\u4e8e4GB\uff08\u5373\u4e00\u4e2a32bit\u5730\u5740\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5fc5\u987b\u4f7f\u75283DW Header\u3002\u800c\u5982\u679c\u5b83\u7684\u76ee\u6807\u5730\u5740\u5927\u4e8e4GB\uff08\u5373\u4e00\u4e2a64bit\u5730\u5740\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c31\u5fc5\u987b\u4f7f\u75284DW Header\u3002IO\u8bf7\u6c42\u7684\u5730\u5740\u88ab\u9650\u5236\u4e3a32bit\uff0c\u5e76\u4e14\u4ec5\u5f53\u4e3a\u4e86\u652f\u6301\u4f20\u7edf\u7684\u65e7\u529f\u80fd\u65f6\u624d\u80fd\u4f7f\u7528\u6838\u5b9e\u73b0IO\u8bf7\u6c42\u3002</p>"},{"location":"pcie/all/#4621-tlp-header","title":"4.6.2.1   TLP Header\u4e2d\u6709\u5173\u5730\u5740\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5","text":"<p>\u5f53TLP Header\u4e2d\u7684Type\u5b57\u6bb5\u8868\u793a\u8fd9\u4e2aTLP\u4f7f\u7528\u5730\u5740\u8def\u7531\u65f6\uff0c\u90a3\u4e48\u5c31\u8981\u7528Header\u4e2d\u7684Address\u5b57\u6bb5\u6765\u6267\u884c\u8def\u7531\u68c0\u67e5\u3002Address\u5b57\u6bb5\u53ef\u4ee5\u662f32bit\u4e5f\u53ef\u4ee5\u662f64bit\u3002</p>"},{"location":"pcie/all/#l-32bittlp","title":"l \u4f7f\u752832bit\u5730\u5740\u7684TLP","text":"<p>\u5bf9\u4e8eIO\u548c32bit\u7684Memory\u8bf7\u6c42\uff0c\u5b83\u4eec\u6240\u4f7f\u7528\u76843DW Header\u5982\u56fe 4\u201118\u6240\u793a\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9bTLP\u7684\u76ee\u6807\u5185\u5b58\u6620\u5c04\u5bc4\u5b58\u5668\uff08Memory-Mapped Registers\uff09\u4f1a\u5b58\u5728\u4e8e4GB\u5185\u5b58\u8fb9\u754c\u4ee5\u4e0b\u3002</p>"},{"location":"pcie/all/#l-64bittlp","title":"l \u4f7f\u752864bit\u5730\u5740\u7684TLP","text":"<p>\u5bf9\u4e8e64bit\u7684Memory\u8bf7\u6c42\uff0c\u5b83\u4eec\u6240\u4f7f\u7528\u76844DW Header\u5982\u56fe 4\u201119\u6240\u793a\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9bTLP\u7684\u76ee\u6807\u5185\u5b58\u6620\u5c04\u5bc4\u5b58\u5668\uff08Memory-Mapped Registers\uff09\u4f1a\u5b58\u5728\u4e8e4GB\u5185\u5b58\u8fb9\u754c\u4e4b\u4e0a\u3002</p> <p></p> <p>\u56fe 4\u201118 3DW TLP Header\u4e2d\u7684\u5730\u5740\u8def\u7531\u76f8\u5173\u5b57\u6bb5</p> <p></p> <p>\u56fe 4\u201119 4DW TLP Header\u4e2d\u7684\u5730\u5740\u8def\u7531\u76f8\u5173\u5b57\u6bb5</p>"},{"location":"pcie/all/#4622-ep","title":"4.6.2.2   EP\u5bf9\u5730\u5740\u7684\u68c0\u67e5","text":"<p>\u5982\u679c\u4e00\u4e2aEP\u6536\u5230\u4e86\u4e00\u4e2a\u5730\u5740\u8def\u7531\u7684TLP\uff0c\u90a3\u4e48EP\u5c06\u4f1a\u7528\u5176\u81ea\u8eab\u914d\u7f6eHeader\u4e2d\u7684\u6bcf\u4e00\u4e2aBAR\uff08Base Address Register\u57fa\u5730\u5740\u5bc4\u5b58\u5668\uff09\u4e0eTLP Header\u4e2d\u7684Address\u5b57\u6bb5\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5982\u56fe 4\u201120\u6240\u793a\u3002\u7531\u4e8eEP\u53ea\u6709\u4e00\u4e2a\u94fe\u8def\u63a5\u53e3\uff0c\u56e0\u6b64\u5b83\u53ea\u4f1a\u63a5\u53d7\u6216\u8005\u62d2\u7edd\u6570\u636e\u5305\uff0c\u800c\u4e0d\u4f1a\u5bf9\u5176\u8fdb\u884c\u8f6c\u53d1\u3002\u5982\u679cTLP Header\u4e2d\u7684Address\u5b57\u6bb5\u4e0eEP\u7684\u67d0\u4e00\u4e2aBAR\u6240\u6307\u793a\u7684\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48EP\u5c31\u4f1a\u63a5\u53d7\u8fd9\u4e2aTLP\u3002\u66f4\u591a\u7684\u5173\u4e8eBARs\u662f\u600e\u4e48\u6837\u88ab\u4f7f\u7528\u7684\u5185\u5bb9\u8bf7\u53c2\u9605\u201c\u57fa\u5730\u5740\u5bc4\u5b58\u5668BARs\uff08Base Address Registers\uff09\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 4\u201120 EP\u5bf9\u8f93\u5165TLP\u7684\u5730\u5740\u8fdb\u884c\u68c0\u67e5</p>"},{"location":"pcie/all/#4623-switchswitch-routing","title":"4.6.2.3   Switch\u8fdb\u884c\u8def\u7531\uff08Switch Routing\uff09","text":"<p>\u5bf9\u4e8eSwitch\u7aef\u53e3\u6765\u8bf4\uff0c\u5982\u679c\u4e00\u4e2a\u8f93\u5165\u7684TLP\u4f7f\u7528\u7684\u662f\u5730\u5740\u8def\u7531\uff0c\u90a3\u4e48\u7aef\u53e3\u4f1a\u9996\u5148\u68c0\u67e5\u8fd9\u4e2aTLP\u7684\u76ee\u6807\u5730\u5740\u662f\u5426\u5c31\u662f\u7aef\u53e3\u672c\u8eab\uff0c\u8fd9\u79cd\u68c0\u67e5\u662f\u901a\u8fc7\u5c06Switch\u7aef\u53e3\u81ea\u8eabType 1 Header\u4e2d\u7684\u4e24\u4e2aBAR\u4e0eTLP Header\u4e2d\u7684Address\u8fdb\u884c\u6bd4\u5bf9\u6765\u5b9e\u73b0\u7684\uff0c\u5982\u56fe 4\u201121\u4e2d\u7684\u6b65\u9aa41\u6240\u793a\u3002\u5982\u679cTLP Header\u4e2d\u7684Address\u5b57\u6bb5\u4e0e\u67d0\u4e2aBAR\u7684\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u8fd9\u4e2aSwitch\u7aef\u53e3\u5c31\u662fTLP\u7684\u76ee\u7684\uff0c\u7aef\u53e3\u5c06\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\u3002\u5982\u679c\u5e76\u672a\u5339\u914d\u4efb\u4f55\u4e00\u4e2aBAR\u7684\u5730\u5740\u8303\u56f4\uff0c\u90a3\u4e48Switch\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5Base/Limit\u5bc4\u5b58\u5668\u5bf9\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u8fd9\u4e2aTLP\u7684\u76ee\u6807Function\u662f\u5426\u5728\u672c\u7aef\u53e3\u4e4b\u4e0b\u3002\u5982\u679cRequest\u7684\u76ee\u6807\u662fIO\u7a7a\u95f4\uff0c\u90a3\u4e48\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5IO Base\u5bc4\u5b58\u5668\u548cIO Limit\u5bc4\u5b58\u5668\uff0c\u5982\u56fe 4\u201121\u4e2d\u6b65\u9aa42a\u6240\u793a\u3002\u800c\u5982\u679cRequest\u7684\u76ee\u6807\u662fMemory\u7a7a\u95f4\uff0c\u90a3\u4e48\u7aef\u53e3\u5c06\u4f1a\u68c0\u67e5\u4e0d\u53ef\u9884\u53d6Base/Limit\u5bc4\u5b58\u5668\u548c\u53ef\u9884\u53d6Base/Limit\u5bc4\u5b58\u5668\uff0c\u5982\u56fe 4\u201121\u4e2d\u6b65\u9aa42b\u6240\u793a\u3002\u66f4\u591a\u5173\u4e8eBase/Limit\u5bc4\u5b58\u5668\u5bf9\u662f\u5982\u4f55\u88ab\u8bc4\u4f30\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201cBase\u5bc4\u5b58\u5668\u548cLimit\u5bc4\u5b58\u5668\uff08Base and Limit Registers\uff09\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 4\u201121 Switch\u68c0\u67e5\u4f7f\u7528\u5730\u5740\u8def\u7531\u7684\u5165\u7ad9TLP\u7684\u8def\u7531\u4fe1\u606f</p> <p>\u4e3a\u4e86\u80fd\u7406\u89e3Switch\u4e2d\u57fa\u4e8e\u5730\u5740\u7684TLP\u8def\u7531\uff0c\u6700\u597d\u8981\u8bb0\u4f4f\u4e00\u70b9\uff0c\u6bcf\u4e2aSwitch\u7aef\u53e3\u81ea\u8eab\u90fd\u662f\u4e00\u4e2aBridge\u3002\u4e0b\u9762\u7684\u6b65\u9aa4\u63cf\u8ff0\u7684\u662f\u4e00\u4e2aBridge\uff08\u4e5f\u5c31\u662fSwitch\u7aef\u53e3\uff09\u63a5\u6536\u4e00\u4e2a\u57fa\u4e8e\u5730\u5740\u8def\u7531\u7684TLP\uff1a</p>"},{"location":"pcie/all/#l-tlpswitch","title":"l TLP\u5411\u4e0b\u884c\u79fb\u52a8\uff08\u7531Switch\u4e3b\u63a5\u53e3\u63a5\u6536\u5e76\u5411\u4e0b\u8f6c\u53d1\uff09","text":"<p>\\1.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u4e0eSwitch\u7aef\u53e3\u7684\u5176\u4e2d\u4e00\u4e2aBAR\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u8fd9\u4e2aBridge\uff08Switch\u7aef\u53e3\uff09\u5c31\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\uff0c\u56e0\u4e3a\u5176\u81ea\u8eab\u5c31\u662f\u8fd9\u4e2aTLP\u7684\u76ee\u7684\u5730\u3002</p> <p>\\2.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u843d\u5728\u7aef\u53e3\u7684\u67d0\u79cdBase/Limit\u5bc4\u5b58\u5668\u6240\u8868\u793a\u7684\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c31\u4f1a\u88ab\u8f6c\u53d1\u5230\u6b21\u7ea7\u63a5\u53e3\uff08Secondary Interface\uff09\uff0c\u4e5f\u5c31\u662f\u5411\u4e0b\u8f6c\u53d1\u3002</p> <p>\\3.    \u82e5\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\u90fd\u4e0d\u7b26\uff0c\u4e14\u4e3b\u63a5\u53e3\uff08Primary Interface\uff09\u4e0a\u6ca1\u6709\u5176\u4ed6\u7684Bridge\u58f0\u660e\u62e5\u6709\u8fd9\u4e2aTLP\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c06\u88abSwitch\u4e3b\u63a5\u53e3\u5f53\u505aUR\uff08Unsupported Request\uff09\u6765\u5904\u7406\u3002</p>"},{"location":"pcie/all/#l-tlp","title":"l TLP\u5411\u4e0a\u884c\u79fb\u52a8\uff08\u7531\u6b21\u7ea7\u63a5\u53e3\u63a5\u6536\u5e76\u5411\u4e0a\u8f6c\u53d1\uff09","text":"<p>\\1.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u4e0e\u5f53\u524dSwitch\u6b21\u7ea7\u63a5\u53e3\uff08Secondary Interface\uff09\u7684\u5176\u4e2d\u4e00\u4e2aBAR\u5730\u5740\u8303\u56f4\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u8fd9\u4e2aBridge\uff08Switch\u7aef\u53e3\uff09\u5c31\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aTLP\uff0c\u56e0\u4e3a\u5176\u81ea\u8eab\u5c31\u662f\u8fd9\u4e2aTLP\u7684\u76ee\u7684\u5730\u3002</p> <p>\\2.    \u5982\u679cTLP\u7684\u76ee\u6807\u5730\u5740\u843d\u5728\u7aef\u53e3\u7684\u67d0\u79cdBase/Limit\u5bc4\u5b58\u5668\u6240\u8868\u793a\u7684\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c06\u88abSwitch\u6b21\u7ea7\u63a5\u53e3\u5f53\u505aUR\uff08Unsupported Request\uff09\u6765\u5904\u7406\uff08\u9664\u975e\u8fd9\u4e2a\u7aef\u53e3\u662fSwitch\u7684\u4e0a\u884c\u7aef\u53e3\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u6570\u636e\u5305\u53ef\u80fd\u662f\u4e00\u4e2aPeer-to-Peer\u7684\u4e8b\u52a1\uff0c\u5b83\u5c06\u4f1a\u88ab\u8f6c\u53d1\u81f3\u4e0b\u884c\u7684\u53e6\u4e00\u4e2a\u7aef\u53e3\u4e0a\uff0c\u800c\u4e0d\u662f\u4e4b\u524d\u63a5\u6536\u8fd9\u4e2aTLP\u7684\u7aef\u53e3\uff09\u3002</p> <p>\\3.    \u82e5\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\u90fd\u4e0d\u7b26\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u5c06\u4f1a\u88ab\u8f6c\u53d1\u81f3\u4e3b\u63a5\u53e3\uff08\u4e0a\u884c\u7aef\u53e3\uff09\uff0c\u56e0\u4e3a\u8fd9\u4e2aTLP\u76ee\u7684\u5730\u65e2\u4e0d\u662f\u5f53\u524d\u7684\u7aef\u53e3Bridge\uff0c\u4e5f\u4e0d\u662f\u8fd9\u4e2aBridge\u4e4b\u4e0b\u7684\u4efb\u4f55\u4e00\u4e2aFunction\u3002</p>"},{"location":"pcie/all/#4624-multicast-capabilities","title":"4.6.2.4   \u591a\u64ad\u80fd\u529b\uff08Multicast Capabilities\uff09","text":"<p>\u5728PCIe 2.1\u7248\u672c\u4e2d\uff0c\u65b0\u52a0\u5165\u4e86\u901a\u8fc7\u6307\u5b9a\u4e00\u4e2a\u5730\u5740\u8303\u56f4\u6765\u8fdb\u884c\u591a\u64ad\u7684\u80fd\u529b\u3002\u4efb\u4f55\u63a5\u6536\u5230\u7684TLP\uff0c\u53ea\u8981\u5176\u5730\u5740\u843d\u5728\u88ab\u6307\u5b9a\u4e3a\u591a\u64ad\u8303\u56f4\u7684\u5730\u5740\u8303\u56f4\u4e4b\u5185\uff0c\u5b83\u7684\u8def\u7531\u6216\u8005\u63a5\u53d7\uff08routed/accepted\uff09\u5c31\u8981\u6839\u636e\u591a\u64ad\u89c4\u5219\u6765\u5904\u7406\u3002\u867d\u7136\u8fd9\u4e2a\u591a\u64ad\u7684\u5730\u5740\u8303\u56f4\u4e0d\u4e00\u5b9a\u4f1a\u88ab\u4fdd\u7559\u5728\u4e00\u4e2aFunction\u7684BARs\u4e2d\uff0c\u4e5f\u4e0d\u4e00\u5b9a\u4f1a\u5b58\u5728\u4e8eBridge\u7684Base/Limit\u5bc4\u5b58\u5668\u5bf9\u4e2d\uff0c\u4f46\u662f\u5b83\u4e5f\u9700\u8981\u901a\u8fc7\u5408\u9002\u7684\u65b9\u5f0f\u88ab\u63a5\u53d7\u6216\u8f6c\u53d1\u3002\u66f4\u591a\u7684\u5173\u4e8e\u591a\u64ad\u529f\u80fd\u7684\u4fe1\u606f\u8bf7\u53c2\u9605\u201cMulticast Capability Register\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/all/#463-implicit-routing","title":"4.6.3     \u9690\u5f0f\u8def\u7531\uff08Implicit Routing\uff09","text":"<p>\u9690\u5f0f\u8def\u7531\u901a\u5e38\u88ab\u4e00\u4e9bMessage\u6570\u636e\u5305\u6240\u4f7f\u7528\uff0c\u5b83\u662f\u57fa\u4e8e\u8def\u7531\u5143\u4ef6\u7684\u611f\u77e5\u80fd\u529b\uff0c\u5373\u8def\u7531\u5143\u4ef6\u77e5\u9053\u62d3\u6251\u7ed3\u6784\u5177\u6709\u4e0a\u884c\u548c\u4e0b\u884c\u65b9\u5411\uff0c\u5e76\u4e14\u62d3\u6251\u7684\u6700\u9876\u90e8\u662fRC\u3002\u8fd9\u4f7f\u5f97\u4e00\u4e9b\u7b80\u5355\u7684\u8def\u7531\u65b9\u6cd5\u53ef\u4ee5\u4e0d\u9700\u8981\u53bb\u5206\u914d\u76ee\u6807\u5730\u5740\u6216\u662fID\u5c31\u80fd\u8fdb\u884c\u8def\u7531\u3002\u7531\u4e8eRC\u4e00\u822c\u90fd\u96c6\u6210\u4e86\u7535\u6e90\u7ba1\u7406\uff08power management\uff09\u3001\u4e2d\u65ad\uff08interrupt\uff09\u548c\u9519\u8bef\u5904\u7406\u903b\u8f91\uff08error handling logic\uff09\uff0c\u8fd9\u4f7f\u5f97RC\u57fa\u672c\u4e0a\u662f\u5927\u591a\u6570PCIe Message\u7684\u53d1\u9001\u8005\u6216\u8005\u63a5\u6536\u8005\u3002</p>"},{"location":"pcie/all/#4631-messageonly-for-messages","title":"4.6.3.1   \u4ec5\u4e3aMessage\u6240\u4f7f\u7528\uff08Only for Messages\uff09","text":"<p>\u6709\u4e9bMessages\u4f7f\u7528\u5730\u5740\u6216\u8005ID\u8def\u7531\uff0c\u800c\u4e0d\u662f\u9690\u5f0f\u8def\u7531\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u4e9bMessage\u6765\u8bf4\uff0c\u5b83\u4eec\u7684\u8def\u7531\u673a\u5236\u5c31\u8ddf\u524d\u9762\u51e0\u8282\u63cf\u8ff0\u7684ID\u8def\u7531\u548c\u5730\u5740\u8def\u7531\u76f8\u540c\u3002\u7136\u800c\uff0c\u5bf9\u4e8e\u7edd\u5927\u591a\u6570Message\u6765\u8bf4\uff0c\u4f7f\u7528\u7684\u8def\u7531\u673a\u5236\u662f\u9690\u5f0f\u8def\u7531\u3002\u9690\u5f0f\u8def\u7531\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u6a21\u4eff\u8fb9\u5e26\u4fe1\u53f7\uff08side-band signal\uff09\u7684\u884c\u4e3a\uff0c\u4e4b\u6240\u4ee5\u8981\u8fd9\u6837\u662f\u56e0\u4e3aPCIe\u7684\u8bbe\u8ba1\u76ee\u6807\u4e4b\u4e00\u5c31\u662f\u8981\u5c3d\u53ef\u80fd\u7684\u628a\u539f\u672cPCI\u4e2d\u7684\u8fb9\u5e26\u4fe1\u53f7\u90fd\u6e05\u9664\u5e72\u51c0\u3002PCI\u4e2d\u7684\u8fd9\u4e9b\u8fb9\u5e26\u4fe1\u53f7\u4e00\u822c\u662f\u7528\u4e8eHost\u5c06\u4e00\u4e2a\u4e8b\u4ef6\u901a\u77e5\u7ed9\u6240\u6709\u7684\u8bbe\u5907\uff0c\u6216\u8005\u662f\u8bbe\u5907\u5c06\u4e00\u4e2a\u4e8b\u4ef6\u901a\u77e5\u7ed9Host\u3002\u5728PCIe\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528Message TLPs\u6765\u4f20\u8f93\u8fd9\u4e9b\u4e8b\u4ef6\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u8fb9\u5e26\u4fe1\u53f7\u3002\u5728PCIe\u4e2d\u88ab\u5b9a\u4e49\u4e86Message\u7684\u4e8b\u4ef6\u7c7b\u578b\u6709\uff1a</p> <p>n \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09</p> <p>n INTx\u4f20\u7edf\u4e2d\u65ad\u4fe1\u53f7\uff08INTx legacy interrupt signaling\uff09</p> <p>n \u9519\u8bef\u4fe1\u53f7\uff08Error signaling\uff09</p> <p>n \u9501\u5b9a\u4e8b\u52a1\u7684\u652f\u6301\uff08Locked Transaction support\uff09</p> <p>n \u70ed\u63d2\u62d4\u4fe1\u53f7\uff08Hot Plug signaling\uff09</p> <p>n \u4f9b\u5e94\u5546\u6307\u5b9a\u4fe1\u53f7\uff08Vendor-specific signaling\uff09</p> <p>n \u63d2\u5165\u5361\u63d2\u69fd\u529f\u8017\u9650\u5236\u8bbe\u7f6e\uff08Slot Power Limit settings\uff09</p>"},{"location":"pcie/all/#4632-tlp-header","title":"4.6.3.2   TLP Header\u4e2d\u6709\u5173\u9690\u5f0f\u8def\u7531\u7684\u5173\u952e\u5b57\u6bb5","text":"<p>\u5bf9\u4e8e\u9690\u5f0f\u8def\u7531\u6765\u8bf4\uff0c\u4f7f\u7528TLP Header\u4e2d\u7684\u5b50\u5b57\u6bb5\uff08sub-field\uff09\u6765\u786e\u5b9aMessage\u7684\u76ee\u7684\u5730\u3002\u56fe 4\u201122\u5c55\u793a\u4e86\u4e00\u4e2a\u4f7f\u7528\u9690\u5f0f\u8def\u7531\u7684Message TLP Header\u3002</p> <p></p> <p>\u56fe 4\u201122 4DW Message TLP Header\u4e2d\u7684\u9690\u5f0f\u8def\u7531\u76f8\u5173\u7684\u5b57\u6bb5</p>"},{"location":"pcie/all/#4633-messagetype","title":"4.6.3.3   Message\u7684Type\u5b57\u6bb5\u603b\u7ed3","text":"<p>\u8868 4\u201110\u5c55\u793a\u4e86\u4e00\u4e2aMessage\u7684TLP Header\u4e2dType\u5b57\u6bb5\u7684\u542b\u4e49\u3002\u5982\u8868\u4e2d\u6240\u793a\uff0c\u6700\u9ad8\u76842bit\u7528\u4e8e\u6307\u793a\u8fd9\u4e2a\u6570\u636e\u5305\u662f\u4e00\u4e2aMessage\uff0c\u5269\u4e0b\u7684\u4f4e3bit\u7528\u4e8e\u6307\u793a\u8fd9\u4e2aMessage\u4f7f\u7528\u7684\u8def\u7531\u65b9\u6cd5\u3002\u9700\u8981\u6ce8\u610f\uff0cMessage TLP\u4e0d\u7ba1\u4f7f\u7528\u54ea\u79cd\u8def\u7531\u64cd\u4f5c\uff0c\u90fd\u53ea\u4f1a\u4f7f\u75284DW Header\u3002\u82e5\u4f7f\u7528\u5730\u5740\u8def\u7531\uff0c\u90a3\u4e48\u5c31\u7528byte8-15\u6765\u7ec4\u621064bit\u5730\u5740\uff1b\u82e5\u4f7f\u7528ID\u8def\u7531\uff0c\u90a3\u4e48\u5c31\u7528byte8\u548c9\u6765\u7ec4\u6210\u76ee\u6807BDF\u3002</p> <p></p> <p>\u8868 4\u201110 Message\u8bf7\u6c42Header\u4e2dType\u5b57\u6bb5\u7684\u7528\u6cd5</p>"},{"location":"pcie/all/#4634-ep","title":"4.6.3.4   EP\u7684\u5904\u7406","text":"<p>\u5bf9\u4e8e\u9690\u5f0f\u8def\u7531\uff0cEP\u4f1a\u7b80\u5355\u7684\u68c0\u67e5\u8def\u7531\u5b50\u5b57\u6bb5\uff08sub-field\uff09\u662f\u5426\u9002\u5408\u5b83\u3002\u4f8b\u5982\uff0cEP\u4f1a\u63a5\u53d7\u4e00\u4e2a\u5e7f\u64adMessage\u6216\u662f\u4e00\u4e2a\u7ec8\u6b62\u4e8eEP\u63a5\u6536\u7aef\u7684Message\uff0c\u4f46\u662f\u4e0d\u4f1a\u63a5\u53d7\u9690\u5f0f\u76ee\u7684\u5730\u4e3aRC\u7684Message\u3002</p>"},{"location":"pcie/all/#4635-switch","title":"4.6.3.5   Switch\u7684\u5904\u7406","text":"<p>\u50cfSwitch\u8fd9\u6837\u7684\u8def\u7531\u5143\u4ef6\uff08Routing Element\uff09\u9700\u8981\u8003\u8651TLP\u5230\u8fbe\u4e86\u54ea\u4e2a\u7aef\u53e3\uff0c\u4ee5\u53caTLP\u7684\u8def\u7531\u5b50\u5b57\u6bb5\u662f\u5426\u5bf9\u8fd9\u4e2a\u7aef\u53e3\u6765\u8bf4\u662f\u5408\u9002\u7684\u3002\u4e3e\u4f8b\u6765\u8bf4\uff1a</p> <p>\\1.    \u4e00\u4e2aSwitch\u7684\u4e0a\u884c\u7aef\u53e3\u53ef\u4ee5\u5408\u6cd5\u7684\u63a5\u6536\u4e00\u4e2a\u5e7f\u64adMessage\u3002\u4e0a\u884c\u7aef\u53e3\u5c06\u4f1a\u628a\u8fd9\u4e2a\u5e7f\u64adMessage\u590d\u5236\u4e00\u4efd\uff0c\u5e76\u5411\u5b83\u7684\u6240\u6709\u4e0b\u884c\u7aef\u53e3\u90fd\u8f6c\u53d1\u3002\u5982\u679c\u4e00\u4e2aSwitch\u7684\u4e0b\u884c\u7aef\u53e3\u63a5\u6536\u4e86\u4e00\u4e2a\u9690\u5f0f\u8def\u7531\u7684\u5e7f\u64adMessage\uff08\u8fd9\u610f\u5473\u7740\u8fd9\u4e2aMessage\u5c06\u4f1a\u5411\u4e0a\u884c\u79fb\u52a8\uff09\uff0c\u8fd9\u662f\u4e00\u79cd\u9519\u8bef\uff0c\u5b83\u5c06\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u6765\u5904\u7406\u3002</p> <p>\\2.    \u4e00\u4e2aSwitch\u7684\u4e0b\u884c\u7aef\u53e3\u53ef\u4ee5\u63a5\u6536\u9690\u5f0f\u8def\u7531\u76ee\u7684\u5730\u4e3aRC\u7684Message\uff0c\u4e0b\u884c\u7aef\u53e3\u5c06\u4f1a\u628a\u8fd9\u4e2aMessage\u8f6c\u53d1\u7ed9\u4e0a\u884c\u7aef\u53e3\uff0c\u56e0\u4e3a\u8def\u7531\u5143\u4ef6\u77e5\u9053RC\u6c38\u8fdc\u5728\u4e0a\u884c\u3002\u800cSwitch\u7684\u4e0a\u884c\u7aef\u53e3\u5e76\u4e0d\u4f1a\u4ece\u5916\u754c\u63a5\u53d7\u4e00\u4e2a\u9690\u5f0f\u8def\u7531\u76ee\u7684\u5730\u4e3aRC\u7684Message\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u5b83\u4f1a\u5411\u4e0b\u8f6c\u53d1\uff0c\u4f46\u662fRC\u5374\u5728\u62d3\u6251\u7ed3\u6784\u7684\u4e0a\u65b9\u3002</p> <p>\\3.    \u5982\u679c\u9690\u5f0f\u8def\u7531Message\u8868\u793a\u5b83\u4f1a\u7ec8\u6b62\u5728\u53ca\u63a5\u6536\u8005\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u63a5\u6536\u5b83\u7684Switch\u7aef\u53e3\u5c06\u4f1a\u6d88\u8017\u6389\u8fd9\u4e2aMessage\uff0c\u800c\u4e0d\u662f\u5c06\u5176\u8f6c\u53d1\u3002</p> <p>\\4.    \u5bf9\u4e8e\u4f7f\u7528\u5730\u5740\u8def\u7531\u6216\u8005ID\u8def\u7531\u7684Message\u6765\u8bf4\uff0cSwitch\u4f1a\u6309\u7167\u4e00\u822c\u5bf9\u5730\u5740\u6216ID\u7684\u68c0\u67e5\u65b9\u5f0f\u6765\u51b3\u5b9a\u662f\u63a5\u6536\u5b83\u4eec\u8fd8\u662f\u8f6c\u53d1\u5b83\u4eec\u3002</p>"},{"location":"pcie/all/#47-dllpordered-set","title":"4.7 DLLP\u548cOrdered Set\u4e0d\u4f1a\u88ab\u8def\u7531","text":"<p>DLLP\u548cOrdered Set\u7684\u6d41\u91cf\u5e76\u4e0d\u4f1a\u88ab\u4eceSwitch\u6216\u8005RC\u7684\u5165\u53e3\u7aef\u53e3\u8def\u7531\u5230\u51fa\u53e3\u7aef\u53e3\u3002\u8fd9\u4e9b\u6570\u636e\u5305\u53ea\u4f1a\u901a\u8fc7\u7269\u7406\u5c42\u5230\u7269\u7406\u5c42\u7684\u94fe\u8def\u8fdb\u884c\u4f20\u8f93\uff0c\u4ece\u4e00\u4e2a\u7aef\u53e3\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u7aef\u53e3\u3002</p> <p>DLLP\u8d77\u6e90\u4e8ePCIe\u7aef\u53e3\u7684\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5148\u7ecf\u8fc7\u7269\u7406\u5c42\uff0c\u63a5\u7740\u79bb\u5f00\u7aef\u53e3\u5e76\u5728\u94fe\u8def\u4e0a\u4f20\u8f93\uff0c\u7136\u540e\u5230\u8fbe\u5bf9\u7aef\u7aef\u53e3\u3002\u5728\u5bf9\u7aef\u7aef\u53e3\u4e0a\uff0cDLLP\u5148\u7ecf\u8fc7\u7269\u7406\u5c42\uff0c\u7136\u540e\u6700\u7ec8\u5230\u8fbe\u6570\u636e\u94fe\u8def\u5c42\uff0cDLLP\u5728\u8fd9\u91cc\u88ab\u5904\u7406\u548c\u6d88\u8017\u3002DLLP\u4e0d\u4f1a\u7ee7\u7eed\u6cbf\u7740\u7aef\u53e3\u5411\u4e0a\u5230\u8fbe\u4e8b\u52a1\u5c42\uff0c\u56e0\u6b64\u5b83\u5e76\u4e0d\u5b58\u5728\u8def\u7531\u3002</p> <p>\u76f8\u4f3c\u7684\uff0cOrdered-Set\u6570\u636e\u5305\u8d77\u6e90\u4e8e\u7269\u7406\u5c42\uff0c\u7136\u540e\u79bb\u5f00\u7aef\u53e3\u5e76\u901a\u8fc7\u94fe\u8def\u4f20\u8f93\uff0c\u6700\u7ec8\u5230\u8fbe\u5bf9\u7aef\u7aef\u53e3\u3002\u5728\u5bf9\u7aef\u7aef\u53e3\u4e0a\uff0cOrdered-Set\u5728\u7269\u7406\u5c42\u5c31\u88ab\u5904\u7406\u548c\u6d88\u8017\u3002\u7531\u4e8eOrdered-Set\u4e5f\u4e0d\u4f1a\u7ee7\u7eed\u6cbf\u7740\u7aef\u53e3\u5411\u4e0a\u5230\u8fbe\u6570\u636e\u94fe\u8def\u5c42\u6216\u8005\u4e8b\u52a1\u5c42\uff0c\u56e0\u6b64\u5b83\u4e5f\u4e0d\u5b58\u5728\u8def\u7531\u3002</p> <p>\u6b63\u5982\u672c\u7ae0\u6240\u8ba8\u8bba\u7684\u90a3\u6837\uff0c\u53ea\u6709TLP\u4f1a\u88abSwitch\u548cRC\u8fdb\u884c\u8def\u7531\uff0c\u5b83\u4eec\u8d77\u6e90\u4e8e\u6e90\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\uff0c\u7ed3\u675f\u4e8e\u76ee\u7684\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\u3002</p>"},{"location":"pcie/all/#part-twotransaction-layer","title":"\u7b2c\u4e8c\u90e8\u5206    Part Two\uff1aTransaction Layer\u4e8b\u52a1\u5c42","text":""},{"location":"pcie/all/#chapter-5-tlp-element-tlp","title":"Chapter 5      TLP Element //TLP\u5143\u7d20","text":""},{"location":"pcie/all/#_12","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u63cf\u8ff0\u4e86\u4e00\u4e2aFunction\u901a\u8fc7BARs\u8bf7\u6c42\u5730\u5740\u7a7a\u95f4\uff08\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u6216IO\u5730\u5740\u7a7a\u95f4\uff09\u7684\u76ee\u7684\u548c\u65b9\u6cd5\uff0c\u8fd8\u63cf\u8ff0\u4e86\u8f6f\u4ef6\u9700\u8981\u600e\u6837\u914d\u7f6eBridge\u7684Base/Limit\u5bc4\u5b58\u5668\u6765\u5c06\u6e90\u7aef\u53e3\u7684TLP\u8def\u7531\u81f3\u6b63\u786e\u7684\u76ee\u7684\u7aef\u53e3\u3002\u6211\u4eec\u8fd8\u8ba8\u8bba\u4e86PCIe\u4e2dTLP\u8def\u7531\u7684\u4e00\u822c\u6982\u5ff5\uff0c\u5305\u62ec\u57fa\u4e8e\u5730\u5740\u7684\u8def\u7531\u3001\u57fa\u4e8eID\u7684\u8def\u7531\uff0c\u4ee5\u53ca\u9690\u5f0f\u8def\u7531\u3002</p>"},{"location":"pcie/all/#_13","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u5728PCIe\u8bbe\u5907\u4e4b\u95f4\uff0c\u4fe1\u606f\u662f\u4ee5\u5305\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u8f93\u7684\u3002\u6709\u4e09\u7c7b\u4e3b\u8981\u7684\u5305\uff1aTLP\uff08Transaction Layer Packet\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\u3001DLLP\uff08Data Link Layer Packet\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u548cOrdered Set\uff08\u547d\u4ee4\u96c6\uff0c\u5b83\u5e94\u7528\u4e8e\u7269\u7406\u5c42\uff09\u3002\u672c\u7ae0\u5c06\u8bb2\u8ff0TLP\u7684\u7528\u6cd5\u3001\u683c\u5f0f\u548c\u4e0d\u540c\u79cd\u7c7b\u7684\u5b9a\u4e49\uff0c\u5e76\u5c06\u8be6\u7ec6\u7684\u8bb2\u89e3TLP\u7684\u76f8\u5173\u5b57\u6bb5\u542b\u4e49\u3002\u5173\u4e8eDLLP\u7684\u5185\u5bb9\u5c06\u4f1a\u5728Chapter 9 \u201cDLLP Element\u201d\u4e2d\u8fdb\u884c\u5355\u72ec\u8bb2\u89e3\u3002</p>"},{"location":"pcie/all/#_14","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u5c06\u8ba8\u8bba\u6d41\u91cf\u63a7\u5236\u534f\u8bae\uff08Flow Control Protocol\uff09\u7684\u76ee\u7684\u548c\u8be6\u7ec6\u64cd\u4f5c\u3002\u6d41\u91cf\u63a7\u5236\u662f\u7528\u6765\u786e\u4fdd\u53d1\u9001\u65b9\u5728\u63a5\u6536\u65b9\u65e0\u6cd5\u63a5\u6536TLP\u65f6\uff0c\u4e0d\u4f1a\u518d\u7ee7\u7eed\u53d1\u9001TLP\u3002\u8fd9\u907f\u514d\u4e86\u63a5\u6536\u7f13\u5b58\u7684\u6ea2\u51fa\uff0c\u4e5f\u6d88\u9664\u4e86\u539f\u672cPCI\u5de5\u4f5c\u65b9\u5f0f\u4e2d\u7684\u4e00\u4e9b\u4f4e\u6548\u884c\u4e3a\uff0c\u6bd4\u5982\u65ad\u5f00\uff08disconnect\uff09\u3001\u91cd\u8bd5\uff08retry\uff09\u548c\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002</p>"},{"location":"pcie/all/#51-introduction-to-packet-based-protocol","title":"5.1 \u57fa\u4e8e\u5305\u7684\u534f\u8bae\u7684\u4ecb\u7ecd\uff08Introduction to Packet-Based Protocol\uff09","text":""},{"location":"pcie/all/#511-general","title":"5.1.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u4e0d\u540c\u4e8e\u5e76\u884c\u603b\u7ebf\uff0cPCIe\u8fd9\u6837\u7684\u4e32\u884c\u603b\u7ebf\u4e0d\u4f7f\u7528\u603b\u7ebf\u4e0a\u7684\u63a7\u5236\u4fe1\u53f7\u6765\u8868\u793a\u67d0\u65f6\u523b\u94fe\u8def\u4e0a\u6b63\u5728\u53d1\u751f\u4ec0\u4e48\u3002\u76f8\u53cd\u5730\uff0cPCIe\u94fe\u8def\u4e0a\u7684\u53d1\u9001\u65b9\u53d1\u51fa\u7684\u6bd4\u7279\u6d41\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u9884\u671f\u7684\u5927\u5c0f\uff0c\u8fd8\u8981\u6709\u4e00\u4e2a\u53ef\u4f9b\u63a5\u6536\u65b9\u8fa8\u8ba4\u7684\u683c\u5f0f\uff0c\u8fd9\u6837\u63a5\u6536\u65b9\u624d\u80fd\u7406\u89e3\u6bd4\u7279\u6d41\u7684\u5185\u5bb9\u3002\u6b64\u5916\uff0cPCIe\u5728\u4f20\u8f93\u6570\u636e\u5305\u65f6\u5e76\u4e0d\u4f7f\u7528\u4efb\u4f55\u76f4\u63a5\u63e1\u624b\u673a\u5236\uff08immediate handshake\uff09\u3002</p> <p>\u9664\u4e86\u903b\u8f91\u7a7a\u95f2\u7b26\u53f7\uff08Logical Idle symbol\uff09\u548c\u7269\u7406\u5c42\u5305\u4e5f\u5c31\u662fOrdered Set\u4e4b\u5916\uff0c\u5728\u6d3b\u8dc3\u7684PCIe\u94fe\u8def\u4e0a\u79fb\u52a8\u4f20\u8f93\u7684\u4fe1\u606f\u7684\u57fa\u672c\u7ec4\u5757\u88ab\u79f0\u4e3aPacket\uff08\u5305\uff09\uff0c\u5305\u662f\u7531\u7b26\u53f7\u7ec4\u6210\u7684\u3002\u94fe\u8def\u4e0a\u4ea4\u6362\u7684\u4e24\u7c7b\u4e3b\u8981\u7684\u6570\u636e\u5305\u4e3a\u9ad8\u5c42\u7684TLP\uff08Transaction Layer Packet\uff0c\u4e8b\u52a1\u5c42\u5305\uff09\uff0c\u548c\u4f4e\u5c42\u7684\u7528\u4e8e\u94fe\u8def\u7ef4\u62a4\u7684\u5305\u79f0\u4e3aDLLP\uff08Data Link Layer Packet\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u3002\u8fd9\u4e9b\u5305\u548c\u5b83\u4eec\u7684\u4f20\u8f93\u6d41\u5982\u56fe 5\u20111\u6240\u793a\u3002\u7269\u7406\u5c42\u7684Ordered Set\u4e5f\u662f\u4e00\u79cd\u5305\uff0c\u4f46\u662f\u5b83\u5e76\u4e0d\u50cfTLP\u548cDLLP\u4e00\u6837\u4f1a\u88ab\u5c01\u88c5\u4e0a\u5305\u8d77\u59cb\u7b26\u53f7\u548c\u5305\u7ed3\u675f\u7b26\u53f7\uff08\u4e5f\u5c31\u662f\u524d\u9762\u7ae0\u8282\u6240\u8bb2\u7684\u7ec4\u5e27\u7b26\u53f7\uff09\uff0c\u5e76\u4e14Ordered Set\u4e5f\u5e76\u6ca1\u6709\u50cfTLP\u548cDLLP\u4e00\u6837\u7684\u5b57\u8282\u6761\u5e26\u5316\u8fc7\u7a0b\uff0c\u76f8\u53cd\u5730\uff0cOrdered Set\u4f1a\u5728\u94fe\u8def\u7684\u6bcf\u4e2a\u901a\u9053\uff08lane\uff09\u4e0a\u90fd\u590d\u5236\u4e00\u4efd\uff0c\u800c\u4e0d\u662f\u50cf\u5b57\u8282\u6761\u5e26\u5316\u4e00\u6837\u628a\u4fe1\u606f\u6309\u5b57\u8282\u5206\u914d\u5230\u5404\u4e2a\u901a\u9053\u4e0a\u3002</p> <p></p> <p>\u56fe 5\u20111 TLP\u548cDLLP\u5305</p>"},{"location":"pcie/all/#512","title":"5.1.2     \u4f7f\u7528\u57fa\u4e8e\u5305\u7684\u534f\u8bae\u7684\u539f\u56e0","text":"<p>\u4f7f\u7528\u57fa\u4e8e\u5305\u7684\u534f\u8bae\uff08Packet-Based Protocol\uff09\u6709\u4e09\u4e2a\u660e\u663e\u7684\u4f18\u70b9\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u6570\u636e\u5b8c\u6574\u6027\uff08data integrity\uff09\u6765\u8bf4\uff1a</p>"},{"location":"pcie/all/#5121","title":"5.1.2.1   \u5305\u683c\u5f0f\u662f\u7cbe\u5fc3\u5b9a\u4e49\u7684","text":"<p>\u50cfPCI\u8fd9\u79cd\u65e9\u671f\u7684\u603b\u7ebf\uff0c\u5b83\u4eec\u5141\u8bb8\u603b\u7ebf\u4e0a\u4f20\u8f93\u4e0d\u786e\u5b9a\u7684\u6570\u636e\u91cf\u5927\u5c0f\uff0c\u8fd9\u4f7f\u5f97\u53ea\u8981\u4f20\u8f93\u6ca1\u6709\u7ed3\u675f\u5c31\u65e0\u6cd5\u8bc6\u522b\u51fa\u6570\u636e\u8377\u8f7d\uff08payload\uff09\u7684\u8fb9\u754c\u3002\u6b64\u5916\uff0c\u4efb\u4f55\u4e00\u4e2a\u8bbe\u5907\u90fd\u53ef\u4ee5\u5728\u6b64\u6b21\u4f20\u8f93\u5b8c\u6210\u524d\u7ec8\u6b62\u8fd9\u4e2a\u4f20\u8f93\uff0c\u8fd9\u4f7f\u5f97\u53d1\u9001\u65b9\u5f88\u96be\u53bb\u8ba1\u7b97\u5e76\u4f20\u8f93\u4e00\u4e2a\u8986\u76d6\u4e86\u6574\u4e2a\u6570\u636e\u8377\u8f7d\u7684\u6821\u9a8c\u548c\u6216\u8005CRC\u3002\u76f8\u53cd\u5730\uff0cPCI\u4f7f\u7528\u4e86\u4e00\u79cd\u7b80\u5355\u7684\u5947\u5076\u6821\u9a8c\u7684\u65b9\u6848\uff0c\u5e76\u5728\u6bcf\u4e2a\u6570\u636e\u9636\u6bb5\uff08data phase\uff09\u8fdb\u884c\u5947\u5076\u6821\u9a8c\u3002\uff08\u8fd9\u91cc\u5982\u679c\u6ca1\u7406\u89e3\u8bf7\u53c2\u9605Chapter 1\u5185\u7684PCI\u76f8\u5173\u5185\u5bb9\uff09</p> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0cPCIe\u5305\u5177\u6709\u4e00\u4e2a\u5df2\u77e5\u7684\u5927\u5c0f\u548c\u683c\u5f0f\u3002\u4f4d\u4e8e\u5305\u7684\u5f00\u5934\u7684\u90e8\u5206\u4e3aHeader\uff0c\u5b83\u7528\u6765\u6307\u793a\u8fd9\u4e2a\u5305\u7684\u7c7b\u578b\uff0c\u5e76\u5305\u542b\u4e86\u5fc5\u9700\u5b57\u6bb5\uff08required field\uff09\u548c\u53ef\u9009\u5b57\u6bb5\uff08optional field\uff09\u3002\u9664\u4e86\u5730\u5740\u5b57\u6bb5\u4ee5\u5916\uff0cHeader\u4e2d\u7684\u5176\u4ed6\u5b57\u6bb5\u957f\u5ea6\u90fd\u662f\u56fa\u5b9a\u7684\uff0c\u5730\u5740\u5b57\u6bb5\u53ef\u4ee5\u4e3a32bit\u4e5f\u53ef\u4ee5\u4e3a64bit\u3002\u4e00\u65e6\u4e00\u6b21\u4f20\u8f93\u5f00\u59cb\uff0c\u63a5\u6536\u65b9\u4e0d\u80fd\u6682\u505c\u6216\u8005\u63d0\u524d\u7ec8\u6b62\u5b83\u3002\u8fd9\u79cd\u7ed3\u6784\u5316\u7684\u683c\u5f0f\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728TLP\u4e2d\u52a0\u5165\u4e00\u4e9b\u4fe1\u606f\u6765\u66f4\u6709\u5229\u4e8e\u8fdb\u884c\u53ef\u9760\u7684\u4f20\u8f93\uff0c\u4f8b\u5982\u52a0\u5165\u7ec4\u5e27\u7b26\u53f7\uff08framing symbol\uff09\u3001CRC\u3001\u4ee5\u53ca\u4e00\u4e2a\u5305\u7684\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3002</p>"},{"location":"pcie/all/#5122","title":"5.1.2.2   \u4f7f\u7528\u7ec4\u5e27\u7b26\u53f7\u5b9a\u4e49\u5305\u7684\u8fb9\u754c","text":"<p>\u5728PCIe Gen1\u548cGen2\u64cd\u4f5c\u6a21\u5f0f\u4e2d\u4f7f\u7528\u7684\u662f8b/10b\u7f16\u7801\uff0c\u56e0\u6b64\u5728\u8fd9Gen1\u548cGen2\u4e2d\u6bcf\u4e2aTLP\u548cDLLP\u5728\u53d1\u9001\u524d\u90fd\u4f1a\u4f7f\u7528\u8d77\u59cb\u7b26\u53f7\uff08Start\uff09\u548c\u7ed3\u675f\u7b26\u53f7\uff08End\uff09\u8fd9\u4e24\u79cd\u63a7\u5236\u7b26\u53f7\u6765\u8fdb\u884c\u7ec4\u5e27\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ed9\u63a5\u6536\u65b9\u6e05\u6670\u5730\u5b9a\u4e49\u51fa\u5305\u7684\u8fb9\u754c\u3002\u8fd9\u662f\u5728PCI\u548cPCI-X\u4e0a\u7684\u91cd\u5927\u6539\u8fdb\uff0c\u5728PCI\u548cPCI-X\u4e2d\u8fd8\u662f\u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u7684FRAME#\u4fe1\u53f7\u6765\u6307\u793a\u4e00\u4e2a\u4e8b\u52a1\u7684\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u5982\u679cFRAME#\u51fa\u73b0\u4e86\u6bdb\u523a\uff0c\u6216\u8005\u5176\u4ed6\u7684\u63a7\u5236\u4fe1\u53f7\u51fa\u73b0\u4e86\u6bdb\u523a\uff0c\u90a3\u4e48\u90fd\u6709\u53ef\u80fd\u9020\u6210\u76ee\u6807\u8bbe\u5907\u5bf9\u603b\u7ebf\u884c\u4e3a\u7684\u8bef\u89e3\u3002\u4e00\u4e2aPCIe\u63a5\u6536\u65b9\u5fc5\u987b\u8981\u80fd\u5728\u6700\u540e\u7684\u94fe\u8def\u6d3b\u52a8\u5f00\u59cb\u6216\u7ed3\u675f\u4e4b\u524d\uff0c\u5c31\u6b63\u786e\u7684\u5b8c\u6210\u4e00\u4e2a\u5b8c\u657410bit\u7b26\u53f7\u7684\u8bd1\u7801\uff0c\u8fd9\u6837\u5b50\u90a3\u4e9b\u4e0d\u671f\u671b\u51fa\u73b0\u6216\u8005\u65e0\u6cd5\u8bc6\u522b\u7684\u7b26\u53f7\u5c31\u80fd\u66f4\u5bb9\u6613\u7684\u88ab\u8bc6\u522b\uff0c\u5e76\u4e14\u88ab\u4f5c\u4e3a\u4e00\u4e2a\u9519\u8bef\u6765\u5904\u7406\u3002</p> <p>\u5bf9\u4e8ePCIe Gen3\u4f7f\u7528\u7684128b/130b\u7f16\u7801\u6765\u8bf4\uff0c\u63a7\u5236\u5b57\u7b26\u4e0d\u518d\u88ab\u4f7f\u7528\uff0c\u5e76\u4e14\u4e5f\u6ca1\u6709\u7ec4\u5e27\u7b26\u53f7\u4e86\u3002\u5bf9\u4e8e\u66f4\u591a\u7684\u5173\u4e8eGen3\u7f16\u7801\u4e0e\u65e9\u671f\u7248\u672c\u7684\u5dee\u5f02\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605Chapter 12\u201cPhysical Layer-Logical\uff08Gen3\uff09\u201d\u3002</p>"},{"location":"pcie/all/#5123-crc","title":"5.1.2.3   \u4f7f\u7528CRC\u4fdd\u969c\u6574\u4e2a\u6570\u636e\u5305\u7684\u6b63\u786e\u4f20\u8f93","text":"<p>\u5728PCI\u4f53\u7cfb\u7ed3\u6784\u4e2d\uff0c\u4f1a\u5728\u5730\u5740\u9636\u6bb5\uff08address phase\uff09\u548c\u6570\u636e\u9636\u6bb5\uff08data phase\uff09\u4e2d\u4f7f\u7528\u5947\u5076\u6821\u9a8c\u8fb9\u5e26\uff08side-band\uff09\u4fe1\u53f7\uff0c\u4f46\u662f\u5728PCIe\u4e2d\u5219\u4e0d\u540c\u3002PCIe\u4e2d\u4f7f\u7528\u5e26\u5185\uff08in-band\uff09\u7684CRC\u503c\u6765\u9a8c\u8bc1\u6574\u4e2a\u6570\u636e\u5305\u662f\u5426\u8fdb\u884c\u4e86\u65e0\u9519\u8bef\u7684\u4f20\u8f93\u3002\u540c\u65f6TLP\u8fd8\u4f1a\u88ab\u53d1\u9001\u65b9\u7684\u6570\u636e\u94fe\u8def\u5c42\u6dfb\u52a0\u4e0a\u4e00\u4e2a\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\uff0c\u8fd9\u4f7f\u5f97\u5f53\u8fd9\u4e2a\u5e8f\u5217\u53f7\u7684\u6570\u636e\u5305\u4f20\u8f93\u51fa\u9519\u65f6\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u5b9a\u4f4d\u5230\u5b83\uff0c\u5e76\u8fdb\u884c\u81ea\u52a8\u7684\u91cd\u4f20\u3002\u53d1\u9001\u65b9\u4f1a\u5728\u81ea\u5df1\u7684Retry Buffer\u5185\u4fdd\u5b58\u6bcf\u4e2aTLP\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u76f4\u5230\u63a5\u6536\u65b9\u786e\u8ba4\u4e86\u8fd9\u4e2aTLP\u6210\u529f\u65e0\u9519\u4f20\u8f93\u540e\u624d\u4f1a\u5c06\u526f\u672c\u6e05\u9664\u3002\u8fd9\u79cdTLP\u7684\u786e\u8ba4\u673a\u5236\u88ab\u79f0\u4e3aAck/Nak\u534f\u8bae\uff08\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605Chapter 10\u201cAck/Nak Protocol\u201d\uff09\uff0c\u5b83\u7528\u6765\u5f62\u6210\u57fa\u7840\u7684\u94fe\u8def\u7ea7TLP\u9519\u8bef\u68c0\u6d4b\u548c\u7ea0\u6b63\u673a\u5236\u3002\u8fd9\u79cdAck/Nak\u534f\u8bae\u63d0\u4f9b\u7684\u9519\u8bef\u6062\u590d\u673a\u5236\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728\u95ee\u9898\u53d1\u751f\u7684\u5730\u65b9\u6216\u8005\u94fe\u8def\u4e0a\u53ca\u65f6\u7684\u89e3\u51b3\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u4e5f\u8981\u6c42\u6709\u4e00\u4e2a\u672c\u5730\u7684\u786c\u4ef6\u89e3\u51b3\u65b9\u6848\u6765\u652f\u6301\u8fd9\u79cd\u534f\u8bae\u3002</p>"},{"location":"pcie/all/#52-tlptlp-details","title":"5.2 TLP\u7ec6\u8282\uff08TLP Details\uff09","text":"<p>\u5728PCIe\u4e2d\uff0c\u9ad8\u5c42\u6b21\u4e8b\u52a1\u8d77\u6e90\u4e8e\u53d1\u9001\u65b9\u7684Device Core\uff0c\u7ec8\u6b62\u4e8e\u63a5\u6536\u65b9\u7684Device Core\u3002\u4e8b\u52a1\u5c42\u4f1a\u5904\u7406\u8fd9\u4e9b\u8bf7\u6c42\uff0c\u5176\u4e2d\uff0c\u53d1\u9001\u7aef\u7684\u4e8b\u52a1\u5c42\u7ec4\u88c5TLP\uff0c\u63a5\u6536\u7aef\u7684\u4e8b\u52a1\u5c42\u89e3\u6790TLP\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u8bbe\u5907\u7684\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u4e5f\u4f1a\u5bf9\u5305\u7684\u7ec4\u88c5\u6709\u4e00\u5b9a\u7684\u8d21\u732e\u3002</p>"},{"location":"pcie/all/#521-tlp","title":"5.2.1     TLP\u7684\u7ec4\u5305\u548c\u62c6\u5305","text":"<p>\u5982\u56fe 5\u20112\u6240\u793a\u7684\u662f\u94fe\u8def\u7684\u53d1\u9001\u7aef\u7ec4\u88c5TLP\u548c\u63a5\u6536\u7aef\u62c6\u89e3TLP\u7684\u4e00\u822c\u6d41\u7a0b\u3002\u73b0\u5728\u8ba9\u6211\u4eec\u8bb2\u4e00\u8bb2\u4ece\u4e00\u4e2a\u5305\u7684\u751f\u6210\uff0c\u5230\u5b83\u88ab\u4f20\u9001\u5230\u63a5\u6536\u7aef\u7684Device Core\u7684\u5404\u4e2a\u6b65\u9aa4\u3002\u4e0b\u9762\u5217\u51fa\u4e86TLP\u7ec4\u5305\u548c\u62c6\u5305\u7684\u5173\u952e\u9636\u6bb5\uff0c\u5217\u51fa\u7684\u7f16\u53f7\u4e0e\u56fe 5\u20112\u4e2d\u7684\u7f16\u53f7\u76f8\u5bf9\u5e94\u3002</p> <p></p> <p>\u56fe 5\u20112 PCIe TLP\u7684\u7ec4\u5305\u4e0e\u62c6\u5305</p> <p>n \u53d1\u9001\u65b9</p> <p>\\1.    \u8bbe\u5907A\u7684Device Core\u5411\u5b83\u7684PCIe\u63a5\u53e3\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\uff08\u5177\u4f53Device Core\u662f\u5982\u4f55\u7ed9PCIe\u63a5\u53e3\u53d1\u9001\u8bf7\u6c42\u7684\uff0c\u8fd9\u5e76\u4e0d\u662fPCIe\u534f\u8bae\u6216\u8005\u672c\u4e66\u7684\u8ba8\u8bba\u8303\u7574\uff09\u3002\u8fd9\u4e2a\u8bf7\u6c42\u4e2d\u5305\u62ec\uff1a</p> <p>\u2014  \u76ee\u6807\u5730\u5740\u6216\u8005ID\uff08\u4e5f\u5c31\u662f\u8def\u7531\u4fe1\u606f\uff09</p> <p>\u2014  \u6e90\u7aef\u4fe1\u606f\uff0c\u4f8b\u5982Requester ID\u548cTag</p> <p>\u2014  \u4e8b\u52a1\u7c7b\u578b/\u5305\u7c7b\u578b\uff08\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4f8b\u5982\u4e00\u4e2aMRd\uff09</p> <p>\u2014  \u6570\u636e\u8377\u8f7d\u5927\u5c0fpayload size\u548c\u6570\u636e\u8377\u8f7d\u5185\u5bb9\uff08\u5982\u679cTLP\u9700\u8981\u5e26\u6570\u636e\uff09</p> <p>\u2014  \u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff0c\u7528\u4e8e\u5206\u914d\u5305\u7684\u4f18\u5148\u7ea7\uff09</p> <p>\u2014  \u8bf7\u6c42\u7684\u81ea\u8eab\u5c5e\u6027\uff08No Snoop\u65e0\u7aa5\u63a2\u3001Relaxed Ordering\u5bbd\u677e\u6392\u5e8f\uff0c\u7b49\u7b49\uff09</p> <p>\\2.    \u57fa\u4e8e\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u4e8b\u52a1\u5c42\u5c06\u4f1a\u7ec4\u5efaTLP Header\uff0c\u5e76\u5728\u5176\u540e\u9644\u4e0a\u6570\u636e\u8377\u8f7d\uff08\u5982\u679c\u6709\uff09\uff0c\u5982\u679c\u9700\u8981\u542f\u7528\u5e76\u652f\u6301\u53ef\u9009\u9879\u7684\u8bdd\u4e5f\u53ef\u4ee5\u518d\u9644\u4e0aECRC\uff08End-to-End CRC\uff09\u3002\u968f\u540eTLP\u5c31\u4f1a\u88ab\u653e\u5165\u4e00\u4e2a\u865a\u62df\u901a\u9053Buffer\u3002\u8fd9\u4e2a\u865a\u62df\u901a\u9053\u4f1a\u6839\u636e\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u6765\u7ba1\u7406TLP\u7684\u987a\u5e8f\uff0c\u5e76\u4e14\u4e5f\u8981\u5728TLP\u88ab\u5411\u4e0b\u8f6c\u53d1\u5230\u6570\u636e\u94fe\u8def\u5c42\u4e4b\u524d\uff0c\u786e\u8ba4\u63a5\u6536\u65b9\u6709\u8db3\u591f\u7684Buffer\u6765\u63a5\u6536\u4e00\u4e2aTLP\u3002</p> <p>\\3.    \u5f53TLP\u5230\u8fbe\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5b83\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\uff0c\u5e76\u57fa\u4e8eTLP\u7684\u5185\u5bb9\u548c\u5e8f\u5217\u53f7\u6765\u8ba1\u7b97\u51fa\u4e00\u4e2aLCRC\uff08Link CRC\uff09\u6765\u9644\u52a0\u5728\u539fTLP\u540e\u3002\u7136\u540e\u4f1a\u5c06\u7ecf\u8fc7\u8fd9\u4e9b\u5904\u7406\u8fc7\u7a0b\u4e4b\u540e\u7684TLP\u4fdd\u5b58\u4e00\u4e2a\u526f\u672c\uff0c\u8fd9\u4e2a\u526f\u672c\u4f1a\u4fdd\u5b58\u5728\u6570\u636e\u94fe\u8def\u5c42\u7684\u91cd\u4f20Buffer\uff08Replay Buffer\uff0c\u4e5f\u53ef\u79f0\u4e3aRetry Buffer\uff09\u4e2d\uff0c\u8fd9\u662f\u4e3a\u4e86\u5e94\u5bf9\u4f20\u8f93\u51fa\u9519\u7684\u60c5\u51b5\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u8fd9\u4e2aTLP\u4e5f\u4f1a\u88ab\u5411\u4e0b\u8f6c\u53d1\u81f3\u7269\u7406\u5c42\u3002</p> <p>\\4.    \u7269\u7406\u5c42\u5c06\u4f1a\u8fdb\u884c\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u6765\u51c6\u5907\u5bf9\u8fd9\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u4e32\u884c\u4f20\u8f93\uff0c\u5305\u62ec\u5b57\u8282\u6761\u5e26\u5316\uff08Byte Striping\uff09\u3001\u6270\u7801\uff08Scrambling\uff09\u3001\u7f16\u7801\uff08Encoding\uff09\u4ee5\u53ca\u5e76\u4e32\u8f6c\u6362\uff08Serializing\uff09\u3002\u5bf9\u4e8eGen1\u548cGen2\u7684\u8bbe\u5907\uff0c\u5f53\u8fdb\u884c8b/10b\u7f16\u7801\u65f6\uff0c\u4f1a\u5c06STP\u548cEND\u8fd9\u4e24\u4e2a\u63a7\u5236\u5b57\u7b26\u5206\u522b\u52a0\u5728TLP\u7684\u9996\u7aef\u548c\u5c3e\u7aef\u3002\u6700\u540e\uff0c\u8fd9\u4e2a\u6570\u636e\u5305\u901a\u8fc7\u94fe\u8def\u8fdb\u884c\u4f20\u8f93\u3002\u5728Gen3\u64cd\u4f5c\u6a21\u5f0f\u4e2d\uff0cSTP\u4ee4\u724c\uff08STP token\uff09\u4f1a\u88ab\u6dfb\u52a0\u5728TLP\u7684\u9996\u7aef\uff0c\u4f46\u662f\u5e76\u4e0d\u4f1a\u5728\u5c3e\u7aef\u52a0\u4e0aEND\uff0c\u800c\u662f\u5728STP\u4ee4\u724c\u4e2d\u5305\u542bTLP\u5927\u5c0f\u7684\u4fe1\u606f\u6765\u5224\u65adTLP\u7684\u5c3e\u90e8\u4f4d\u7f6e\u3002</p> <p>n \u63a5\u6536\u65b9</p> <p>\\5.    \u5728\u63a5\u6536\u65b9\uff08\u672c\u4f8b\u4e2d\u662fDevice B\uff09\uff0c\u4e3a\u4e86\u53d1\u9001\u5305\u6240\u505a\u7684\u4e00\u5207\u51c6\u5907\u73b0\u5728\u90fd\u5fc5\u987b\u64a4\u9500\u3002\u7269\u7406\u5c42\u5c06\u5bf9\u6bd4\u7279\u6d41\u8fdb\u884c\u4e32\u5e76\u8f6c\u6362\uff08deserialize\uff09\u3001\u5bf9\u4e32\u5e76\u8f6c\u6362\u540e\u7684\u7b26\u53f7\u8fdb\u884c\u89e3\u7801\uff0c\u7136\u540e\u518d\u8fdb\u884c\u5b57\u8282\u53cd\u6761\u5e26\u5316\uff08un-stripes\uff09\u3002\u63a7\u5236\u5b57\u7b26\u5c06\u88ab\u79fb\u9664\uff0c\u56e0\u4e3a\u5b83\u4eec\u4ec5\u5728\u7269\u7406\u5c42\u6709\u610f\u4e49\uff0c\u7136\u540e\u8fd9\u4e2a\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5411\u4e0a\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\u3002</p> <p>\\6.    \u6570\u636e\u94fe\u8def\u5c42\u5c06\u4f1a\u8ba1\u7b97CRC\uff08\u5177\u4f53\u4e00\u70b9\u662fLCRC\uff09\u5e76\u4e0eTLP\u4e2d\u7684CRC\u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679cCRC\u6bd4\u8f83\u7ed3\u679c\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u518d\u68c0\u67e5\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3002\u5982\u679c\u90fd\u6ca1\u6709\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u5c31\u628aCRC\u548c\u5e8f\u5217\u53f7\u90fd\u4eceTLP\u5265\u9664\uff0c\u5e76\u968f\u540e\u5c06TLP\u5411\u4e0a\u8f6c\u53d1\u7ed9\u63a5\u6536\u65b9\u4e8b\u52a1\u5c42\uff0c\u4e0e\u6b64\u540c\u65f6\u8981\u901a\u8fc7\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\u4e00\u4e2aAck DLLP\u6765\u901a\u77e5\u53d1\u9001\u65b9\u8fd9\u4e2aTLP\u88ab\u6210\u529f\u63a5\u6536\u3002\u76f8\u53cd\u5730\uff0c\u5982\u679c\u524d\u9762\u7684\u8fc7\u7a0b\u4e2d\u68c0\u67e5\u51fa\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u5c31\u8981\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\u4e00\u4e2aNak DLLP\uff0c\u8fd9\u6837\u53d1\u9001\u65b9\u5c06\u4f1a\u4f7f\u7528\u5b83\u7684\u91cd\u4f20Buffer\u6765\u5bf9TLP\u8fdb\u884c\u91cd\u4f20\u3002</p> <p>\\7.    \u5728\u4e8b\u52a1\u5c42\uff0cTLP\u88ab\u8fdb\u884c\u8bd1\u7801\uff0c\u5e76\u5c06TLP\u5185\u7684\u4fe1\u606f\u4f20\u9012\u7ed9Device Core\u6765\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002\u5982\u679c\u5f53\u524d\u63a5\u6536\u8bbe\u5907\u5c31\u662f\u6570\u636e\u5305\u7684\u6700\u7ec8\u76ee\u7684\u5730\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u68c0\u67e5ECRC\u9519\u8bef\uff0c\u5e76\u5728\u53d1\u73b0\u4efb\u4f55ECRC\u9519\u8bef\u65f6\u62a5\u544a\u7ed9Device Core\u3002</p>"},{"location":"pcie/all/#522-tlp","title":"5.2.2     TLP\u7ed3\u6784","text":"<p>\u4e00\u4e2a\u4e8b\u52a1\u5c42\u5305TLP\u4e2d\u5404\u4e2a\u5b57\u6bb5\u57df\u7684\u57fa\u672c\u7528\u6cd5\u5728\u8868 5\u20111\u4e2d\u8fdb\u884c\u4e86\u5b9a\u4e49\u3002</p> <p></p> <p>\u8868 5\u20111 TLP Header\u7684Type\u5b57\u6bb5\u5b9a\u4e49\u4e86\u4e8b\u52a1\u4e0d\u540c\u79cd\u7c7b</p> <p>\u4e0b\u9762\u5bf9\u8868 5\u20111\u4e2d\u7684\u5185\u5bb9\u8fdb\u884c\u590d\u8ff0\u3002</p> <p>n Header</p> <p>n \u534f\u8bae\u5c42\u6b21\uff1a\u4e8b\u52a1\u5c42</p> <p>n \u8be5\u7ec4\u4ef6\u7528\u6cd5\uff1a\u5927\u5c0f\u4e3a3\u62164DW\uff0812\u621616Bytes\uff09\u3002Header\u7684\u683c\u5f0f\u4f1a\u968f\u7c7b\u578b\u800c\u53d8\u5316\uff0c\u4f46\u662fHeader\u4e5f\u5b9a\u4e49\u4e86\u4e00\u4e9b\u53c2\u6570\uff0c\u5305\u62ec\uff1a</p> <p>o \u4e8b\u52a1\u7c7b\u578b\uff08Transaction Type\uff09</p> <p>o \u76ee\u6807\u5730\u5740\u3001ID\u7b49</p> <p>o \u4f20\u8f93\u6570\u636e\u91cf\u5927\u5c0f\uff08\u5982\u679c\u6709\u6570\u636e\uff09\u3001\u5b57\u8282\u4f7f\u80fd\uff08Byte Enable\uff09</p> <p>o \u5c5e\u6027\uff08Attribute\uff09</p> <p>o \u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff09</p> <p>n Data</p> <p>n \u534f\u8bae\u5c42\u6b21\uff1a\u4e8b\u52a1\u5c42</p> <p>n \u8be5\u7ec4\u4ef6\u7528\u6cd5\uff1a\u53ef\u9009\u76841-1024DW\u5927\u5c0f\u7684\u6570\u636e\u8377\u8f7d\uff0c\u5177\u4f53\u7684\u5927\u5c0f\u7531\u5b57\u8282\u4f7f\u80fd\u6216\u8005\u5b57\u8282\u5bf9\u9f50\u7684\u5f00\u59cb\u548c\u7ed3\u675f\u5730\u5740\u6765\u8fdb\u884c\u63cf\u8ff0\u3002\u9700\u8981\u6ce8\u610f\u6307\u5b9a\u7684\u957f\u5ea6\u4e0d\u80fd\u4e3a0\uff0c\u4f46\u662f\u4e00\u4e2a0\u957f\u5ea6\u7684\u8bfb\u53d6\uff08\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4f1a\u4f7f\u7528\uff09\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u957f\u5ea6\u4e3a1DW\u7136\u540e\u5c06\u5b57\u8282\u4f7f\u80fd\u5168\u90e8\u7f6e\u4e3a0\u6765\u8fdb\u884c\u8fd1\u4f3c\u5904\u7406\u3002\u6765\u81eaCompleter\u7684\u8fd9\u6837\u5b50\u7684\u6570\u636e\u867d\u7136\u662f\u672a\u5b9a\u4e49\u7684\u79cd\u7c7b\uff0c\u4f46\u662fRequester\u5e76\u4e0d\u4f7f\u7528\u5b83\uff0c\u56e0\u6b64\u5c31\u548c\u6307\u5b9a0\u957f\u5ea6\u7684\u76ee\u7684\u7b49\u6548\u4e86\u3002</p> <p>n Digest/ECRC</p> <p>n \u534f\u8bae\u5c42\u6b21\uff1a\u4e8b\u52a1\u5c42</p> <p>n \u8be5\u7ec4\u4ef6\u7528\u6cd5\uff1a\u53ef\u9009\u7684\u529f\u80fd\u3002\u5f53\u9700\u8981\u4f7f\u7528\u65f6\uff0cECRC\u7684\u5927\u5c0f\u6c38\u8fdc\u4e3a1DW\u3002</p>"},{"location":"pcie/all/#523-tlp-headergeneric-tlp-header-format","title":"5.2.3     \u901a\u7528TLP Header\u683c\u5f0f\uff08Generic TLP Header Format\uff09","text":""},{"location":"pcie/all/#5231-general","title":"5.2.3.1   \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5982\u56fe 5\u20113\u4e2d\uff0c\u5c55\u793a\u4e86\u4e00\u4e2a4DW\u7684\u901a\u7528TLP Header\u7684\u683c\u5f0f\u548c\u5185\u5bb9\u3002\u5728\u672c\u8282\u5185\uff0c\u4f1a\u5bf9\u51e0\u4e4e\u6240\u6709\u4e8b\u52a1\u7684TLP Header\u4e2d\u7684\u516c\u5171\u5b57\u6bb5\u8fdb\u884c\u603b\u7ed3\uff0c\u5e76\u4f1a\u5728\u7a0d\u540e\u8ba8\u8bba\u4e0e\u7279\u5b9a\u4e8b\u52a1\u7c7b\u578b\u76f8\u5173Header\u683c\u5f0f\u5dee\u5f02\u3002</p> <p></p> <p>\u56fe 5\u20113\u901a\u7528TLP Header\u7684\u5404\u5b57\u6bb5\u57df</p>"},{"location":"pcie/all/#5232-header","title":"5.2.3.2   \u901a\u7528Header\u5404\u5b57\u6bb5\u603b\u7ed3","text":"<p>\u8868 5\u20112\u4e2d\u5bf9\u901a\u7528TLP Header\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u5927\u5c0f\u548c\u7528\u9014\u8fdb\u884c\u4e86\u603b\u7ed3\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u56fe 5\u20113\u4e2d\u88ab\u6807\u6ce8\u4e3a\u201cR\u201d\u7684\u5b57\u6bb5\u662f\u4fdd\u7559\u5b57\u6bb5\uff08reserve\uff09\uff0c\u5e94\u8be5\u88ab\u7f6e\u4e3a0\u3002</p> Header\u4e2d\u7684\u5b57\u6bb5\u540d Header\u4e2d\u7684\u4f4d\u7f6e \u5b57\u6bb5\u4f5c\u7528 Fmt[2:0]  \u683c\u5f0f  (Format) Byte  0  Bit  7:5 \u8fd9\u51e0\u4e2abit\u7684\u7f16\u7801\u4fe1\u606f\u662f\u5173\u4e8eHeader\u7684\u5927\u5c0f\uff0c\u4ee5\u53ca\u8fd9\u4e2aTLP\u4e2d\u662f\u5426\u5b58\u5728\u6570\u636e\u8377\u8f7d\u90e8\u5206\uff1a  n 000b\uff1a3DW Header\uff0c\u65e0\u6570\u636e\u8377\u8f7d  n 001b\uff1a4DW Header\uff0c\u65e0\u6570\u636e\u8377\u8f7d  n 010b\uff1a3DW Header\uff0c\u6709\u6570\u636e\u8377\u8f7d  n 011b\uff1a4DW Header\uff0c\u6709\u6570\u636e\u8377\u8f7d  n 100b\uff1a1DW\uff0c\u5c5e\u4e8ePrefix TLP  \u4e0d\u96be\u53d1\u73b0\uff0c\u9664\u4e86Prefix TLP\u5916\uff0c\u53ea\u8981Fmt[0]=0\u90a3\u4e48\u5c31\u662f3DW Header\uff0c\u53cd\u4e4b\u5219\u4e3a4DW Header\u3002\u82e5Fmt[1]=0\u90a3\u4e48\u5c31\u65e0\u6570\u636e\u8377\u8f7d\uff0c\u53cd\u4e4b\u5219\u6709\u6570\u636e\u8377\u8f7d\u3002  \u5bf9\u4e8e\u4f4e\u4e8e4GB\u7684\u5730\u5740\uff0c\u5fc5\u987b\u4f7f\u75283DW Header\u3002\u534f\u8bae\u89c4\u5b9a\uff0c\u5982\u679c\u4f7f\u75284DW Header\u4f46\u662f\u5730\u5740\u5c0f\u4e8e4GB\uff0c\u4e5f\u5c31\u662f\u8bf4\u5c0664bit\u5730\u5740\u7684\u9ad832bit\u7f6e\u4e3a0\uff0c\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u4e0b\u63a5\u6536\u65b9\u7684\u884c\u4e3a\u662f\u672a\u8fdb\u884c\u5b9a\u4e49\u7684\uff08undefined\uff09\u3002 Type[4:0]  \u7c7b\u578b Byte  0  Bit  4:0 \u8fd9\u4e9bbit\u7f16\u7801\u7684\u4fe1\u606f\u662fTLP\u7684\u4e0d\u540c\u4e8b\u52a1\u7c7b\u578b\u3002Type\u5b57\u6bb5\u7528\u6765\u8ddfFmt[1:0]\u5b57\u6bb5\u4e00\u8d77\u6307\u5b9a\u4e86\u4e8b\u52a1\u7c7b\u578b\u3001Header\u5927\u5c0f\u3001\u4ee5\u53ca\u662f\u5426\u5b58\u5728\u6570\u636e\u8377\u8f7d\u3002\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u9605\u201cGeneric Header  Field Details\u201d\u4e00\u8282\u3002 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  (Traffic  Class) Byte  1  Bit  6:4 \u8fd9\u4e9bbit\u8868\u793a\u5c06\u5e94\u7528\u4e8e\u8fd9\u4e2aTLP\u4ee5\u53ca\u5176\u5b8c\u6210\u5305\uff08\u5982\u679c\u9700\u8981\u5b8c\u6210\u5305\uff09\u7684\u6d41\u91cf\u7c7b\u578b\uff1a  n 000b\uff1aTraffic Class  0\uff08\u9ed8\u8ba4\uff09  n 001b\uff1aTraffic Class  1  \u2026\u2026  n 111b\uff1aTraffic Class  7  TC 0\u662f\u9ed8\u8ba4\u7c7b\u578b\uff0c\u800cTC 1-7\u662f\u7528\u6765\u63d0\u4f9b\u5dee\u5f02\u5316\u7684\u670d\u52a1\u3002\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u9605\u201cTraffic Class\u201d\u4e00\u8282\u3002 Attr[2]  \u5c5e\u6027  (Attribute) Byte  1  Bit  2 \u8fd9\u4e2a\u7b2c\u4e09\u4f4d\u7684Attribute\u4f4d\uff08\u5b83\u5171\u67093\u4f4d\uff09\u7528\u4e8e\u8868\u793a\u8fd9\u4e2aTLP\u662f\u5426\u4f7f\u7528\u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\u201d\u4e00\u8282\u3002 TH  TLP\u5904\u7406\u63d0\u793a  (TLP  Processing Hints) Byte  1  Bit  0 \u5b83\u7528\u4e8e\u8868\u793a\u4f55\u65f6TLP\u4e2d\u4f1a\u5305\u542bTLP\u63d0\u793a\uff08TLP Hints\uff09\uff0c\u4ee5\u4fbf\u8ba9\u7cfb\u7edf\u4e86\u89e3\u5982\u4f55\u66f4\u597d\u7684\u5904\u7406\u8fd9\u4e2aTLP\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTPH\uff08TLP Processing Hints\uff09\u201d\u3002 TD  TLP\u6458\u8981  (TLP  Digest) Byte  2  Bit  7 \u5982\u679cTD=1\uff0c\u90a3\u4e48\u8fd9\u4e2aTLP\u4e2d\u5c06\u5305\u62ec\u53ef\u9009\u76844Byte TLP Digest\u5b57\u6bb5\uff0c\u4e5f\u5c31\u662fECRC\u503c\u3002  \u5b83\u6709\u4e00\u4e9b\u89c4\u5219\uff1a  n \u6240\u6709\u7684\u63a5\u6536\u8005\u90fd\u5fc5\u987b\u8981\u901a\u8fc7\u8fd9\u4e2abit\u6765\u68c0\u67e5\u662f\u5426\u5b58\u5728Digest\u5b57\u6bb5\u3002  n \u5982\u679c\u4e00\u4e2aTLP\u7684TD=1\uff0c\u4f46\u662f\u5b83\u53c8\u6ca1\u6709Digest\uff0c\u90a3\u4e48\u5b83\u5c06\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u5904\u7406\u3002  n \u5982\u679c\u63a5\u6536\u8bbe\u5907\u652f\u6301ECRC\u6821\u9a8c\uff0c\u4e14\u6b64TLP\u5185TD=1\uff0c\u90a3\u4e48\u8fd9\u4e2a\u63a5\u6536\u8bbe\u5907\u5fc5\u987b\u8fdb\u884c\u6821\u9a8c\u3002  n \u5982\u679c\u4e00\u4e2a\u4f5c\u4e3aTLP\u6700\u7ec8\u76ee\u7684\u5730\u7684\u8bbe\u5907\u5e76\u4e0d\u652f\u6301ECRC\u6821\u9a8c\uff08\u56e0\u4e3a\u8fd9\u662f\u53ef\u9009\u529f\u80fd\uff09\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u8981\u5ffd\u7565Digest\u5b57\u6bb5\u3002  \u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cCRC\u201d\u548c\u201cECRC Generating and Checking\u201d\u8fd9\u4e24\u8282\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  (Poisoned Data) Byte 2  Bit 6 \u5982\u679cEP=1\uff0c\u90a3\u4e48\u5c31\u8ba4\u4e3a\u6240\u6709\u4f34\u968f\u6b64\u6570\u636e\u7684\u6570\u636e\u90fd\u662f\u65e0\u6548\u7684\uff0c\u5c3d\u7ba1\u76f8\u5173\u4e8b\u52a1\u4f9d\u7136\u5141\u8bb8\u6b63\u5e38\u7684\u5b8c\u6210\u3002\u5173\u4e8ePoisoned\u6570\u636e\u5305\u7684\u66f4\u591a\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cData Poisoning\u201d\u4e00\u8282\u3002 Attr[1:0]  \u5c5e\u6027  (Attributes) Byte  2  Bit  5:4 Bit 5 = Relax Ordering\uff08\u5bbd\u677e\u6392\u5e8f\uff09\uff1a\u5f53\u5b83\u88ab\u7f6e\u4e3a1\u65f6\uff0c\u8fd9\u4e2aTLP\u4f1a\u542f\u7528PCI-X\u7684\u5bbd\u677e\u6392\u5e8f\u3002\u5982\u679c\u5b83\u4e3a0\uff0c\u5219\u662f\u7528PCI\u7684\u4e25\u683c\u7684PCI\u6392\u5e8f\uff08strict PCI ordering\uff09\u3002  Bit 4 = No Snoop\uff08\u65e0\u7aa5\u63a2\uff09\uff1a\u5f53\u7f6e\u4e3a1\u65f6\uff0cRequester\u7684\u610f\u601d\u662f\u8fd9\u4e2aTLP\u4e0d\u4f1a\u5b58\u5728host cache\u4e00\u81f4\u6027\u7684\u95ee\u9898\uff08host cache coherency issues\uff09\uff0c\u56e0\u6b64\u7cfb\u7edf\u786c\u4ef6\u53ef\u4ee5\u901a\u8fc7\u8df3\u8fc7\u666e\u901a\u5904\u7406\u5668\u5bf9\u8fd9\u4e2a\u8bf7\u6c42\u7684cache\u7aa5\u63a2\uff0c\u4ee5\u6b64\u6765\u8282\u7701\u65f6\u95f4\u3002\u800c\u5f53\u8fd9\u4e00\u4f4d\u88ab\u7f6e\u4e3a0\u65f6\uff0c\u9700\u8981\u8fdb\u884cPCI-type\u7684cache\u7aa5\u63a2\u4fdd\u62a4\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  (Address  Type) Byte  2  Bit  3:2 \u5bf9\u4e8eMemory\u548cAtomic\u8bf7\u6c42\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u652f\u6301\u865a\u62df\u5316\u7cfb\u7edf\uff08virtualized system\uff09\u7684\u5730\u5740\u7ffb\u8bd1\u3002\u8fd9\u4e2a\u5730\u5740\u7ffb\u8bd1\u534f\u8bae\u7531\u4e00\u4e2a\u5355\u72ec\u7684\u89c4\u8303\u8fdb\u884c\u63cf\u8ff0\uff0c\u88ab\u79f0\u4e3aAddress  Translation Services\uff0c\u53ef\u4ee5\u770b\u5230\u8be5\u5b57\u6bb5\u7684\u7f16\u7801\u4e3a\uff1a  n 00 = \u9ed8\u8ba4/\u672a\u7ffb\u8bd1\uff08Default/Untranslated\uff09  n 01 = \u7ffb\u8bd1\u8bf7\u6c42\uff08Translation Request\uff09  n 10 = \u5df2\u7ffb\u8bd1\uff08Translated\uff09  n 11 = \u4fdd\u7559reserve Length[9:0]  \u957f\u5ea6 Byte  2  Bit  1:0     Byte  3  Bit  7:0 TLP\u6570\u636e\u8377\u8f7d\u4f20\u8f93\u91cf\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aDW\uff0c\u7f16\u7801\u65b9\u5f0f\u4e3a\uff1a  n 00 0000 0001b = 1DW  n 00 0000 0010b = 2DW  \u2026\u2026  n 11 1111 1111b = 1023DW  n 00 0000 0000 = 1024DW Last  DW BE[3:0]  \u672b\u5c3eDW\u7684\u5b57\u8282\u4f7f\u80fd  (Last  DW Byte Enable) Byte  7  Bit  7:4 \u8fd9\u4e2a\u5b57\u6bb5\u4e2d\u76844\u4e2a\u9ad8\u6709\u6548\u7684bit\uff0c\u4e0e\u6570\u636e\u8377\u8f7d\u4e2d\u6700\u540e\u4e00\u4e2aDW\u4e2d\u76844\u4e2aByte\u4e00\u4e00\u5bf9\u5e94\u3002  n Bit 7 = 1\uff1a\u672b\u5c3eDW\u7684Byte 3\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  n Bit 6 = 1\uff1a\u672b\u5c3eDW\u7684Byte 2\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  n Bit 5 = 1\uff1a\u672b\u5c3eDW\u7684Byte 1\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  n Bit 4 = 1\uff1a\u672b\u5c3eDW\u7684Byte 0\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002 1<sup>st</sup>  DW BE[3:0]  \u7b2c\u4e00\u4e2aDW\u7684\u5b57\u8282\u4f7f\u80fd  (First  DW Byte Enable) Byte  7  Bit  3:0 \u8fd9\u4e2a\u5b57\u6bb5\u4e2d\u76844\u4e2a\u9ad8\u6709\u6548\u7684bit\uff0c\u4e0e\u6570\u636e\u8377\u8f7d\u4e2d\u7b2c\u4e00\u4e2aDW\u4e2d\u76844\u4e2aByte\u4e00\u4e00\u5bf9\u5e94\u3002  n Bit 3 = 1\uff1a\u672b\u5c3eDW\u7684Byte 3\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  n Bit 2 = 1\uff1a\u672b\u5c3eDW\u7684Byte 2\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  n Bit 1 = 1\uff1a\u672b\u5c3eDW\u7684Byte 1\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002  n Bit 0 = 1\uff1a\u672b\u5c3eDW\u7684Byte 0\u662f\u6709\u6548\u7684\uff1b\u5426\u5219\u4e3a\u65e0\u6548\u7684\u3002 <p>\u8868 5\u20112\u901a\u7528TLP Header\u7684\u5404\u5b57\u6bb5\u603b\u7ed3</p>"},{"location":"pcie/all/#524-tlp-headergeneric-tlp-header-details","title":"5.2.4     \u901a\u7528TLP Header\u8be6\u7ec6\u8bf4\u660e\uff08Generic TLP Header Details\uff09","text":"<p>\u5728\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u4e2d\uff0c\u6211\u4eec\u5c06\u5bf9\u56fe 5\u20113\u4e2d\u5c55\u793a\u7684TLP Header\u7684\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u90fd\u8fdb\u884c\u7ec6\u8282\u63cf\u8ff0\u3002</p>"},{"location":"pcie/all/#5241-headertypeformat","title":"5.2.4.1   Header\u7684Type/Format\u5b57\u6bb5\u7f16\u7801\u542b\u4e49","text":"<p>\u8868 5\u20113\u4e2d\u603b\u7ed3\u4e86TLP Header\u4e2dType\u5b57\u6bb5\u548cFmt\u5b57\u6bb5\uff08Format\uff09\u7684\u7f16\u7801\u542b\u4e49\u3002</p> TLP\u4e8b\u52a1\u79cd\u7c7b Fmt[2:0] Type[4:0] Memory  Read\u8bf7\u6c42  \uff08MRd\uff09 000=3DW\uff0c\u65e0\u6570\u636e  001=4DW\uff0c\u65e0\u6570\u636e 0 0000 Memory  Read Locked\u8bf7\u6c42  \uff08MRdLk\uff09 000=3DW\uff0c\u65e0\u6570\u636e  001=4DW\uff0c\u65e0\u6570\u636e 0  0001 Memory  Write\u8bf7\u6c42  \uff08MWr\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  0000 IO  Read\u8bf7\u6c42  \uff08IORd\uff09 000=3DW\uff0c\u65e0\u6570\u636e  \uff08IO\u8bf7\u6c42\u4e3a3DW Header\uff09 0  0010 IO  Write\u8bf7\u6c42  \uff08IOWr\uff09 010=3DW\uff0c\u6709\u6570\u636e  \uff08IO\u8bf7\u6c42\u4e3a3DW Header\uff09 0  0010 \u914d\u7f6eType 0 Read\u8bf7\u6c42  \uff08CfgRd0\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  0100 \u914d\u7f6eType 0 Write\u8bf7\u6c42  \uff08CfgWr0\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  0100 \u914d\u7f6eType 1 Read\u8bf7\u6c42  \uff08CfgRd1\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  0101 \u914d\u7f6eType 1 Write\u8bf7\u6c42  \uff08CfgWr1\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  0101 Message\u8bf7\u6c42  \uff08Msg\uff09 001=4DW\uff0c\u65e0\u6570\u636e 1  0 rrr*  \uff08\u89c1\u8868 4\u201110\uff09 Message\u5e26\u6570\u636e\u7684\u8bf7\u6c42  \uff08MsgD\uff09 011=4DW\uff0c\u6709\u6570\u636e 1  0 rrr*  \uff08\u89c1\u8868 4\u201110\uff09 \u5b8c\u6210\u5305Completion  \uff08Cpl\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  1010 \u5b8c\u6210\u5305\u5e26\u6570\u636e  \uff08CplD\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  1010 \u9501\u5b9a\u7684\u5b8c\u6210\u5305  \uff08CplLk\uff09 000=3DW\uff0c\u65e0\u6570\u636e 0  1011 \u9501\u5b9a\u7684\u5b8c\u6210\u5305\u5e26\u6570\u636e  \uff08CplDLk\uff09 010=3DW\uff0c\u6709\u6570\u636e 0  1011 \u83b7\u53d6\u548c\u589e\u52a0\u539f\u5b50\u64cd\u4f5c\u8bf7\u6c42  \uff08Fetch and Add AtomicOP Request\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  1100 \u65e0\u6761\u4ef6\u7684\u4ea4\u6362\u539f\u5b50\u64cd\u4f5c\u8bf7\u6c42  \uff08Unconditional Swap AtomicOP Request\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  1101 \u5bf9\u6bd4\u548c\u4ea4\u6362\u539f\u5b50\u64cd\u4f5c\u8bf7\u6c42  \uff08Compare and Swap AtomicOP Request\uff09 010=3DW\uff0c\u6709\u6570\u636e  011=4DW\uff0c\u6709\u6570\u636e 0  1110 \u672c\u5730TLP\u524d\u7f00  \uff08Local TLP Prefix\uff09 100=TLP  Prefix 0L3L2L1L0 \u7aef\u5230\u7aefTLP\u524d\u7f00  \uff08End-to-End TLP Prefix\uff09 100=TLP  Prefix 1E3E2E1E0 <p>\u8868 5\u20113 TLP Header\u7684Type\u5b57\u6bb5\u548cFmt\u5b57\u6bb5\u7f16\u7801\u542b\u4e49</p>"},{"location":"pcie/all/#5242-digestecrc","title":"5.2.4.2   Digest/ECRC\u5b57\u6bb5","text":"<p>TLP\u7684Digest\u4f4d\u8868\u793a\u662f\u5426\u5b58\u5728ECRC\uff08End-to-End CRC\uff09\u3002\u5982\u679c\u5f53\u524d\u652f\u6301\u8fd9\u4e2a\u53ef\u9009\u7684\u7279\u6027\uff0c\u5e76\u4e14\u8f6f\u4ef6\u4e5f\u542f\u7528\u4e86\u5b83\uff0c\u90a3\u4e48\u8bbe\u5907\u5c06\u4f1a\u7ed9\u81ea\u5df1\u4ea7\u751f\u7684\u6240\u6709TLP\u90fd\u8ba1\u7b97\u5e76\u4e14\u6dfb\u52a0\u4e0a\u4e00\u4e2aECRC\u3002\u9700\u8981\u6ce8\u610f\uff0c\u4f7f\u7528ECRC\u8981\u6c42\u8bbe\u5907\u542b\u6709\u53ef\u9009\u7684Advanced Error Reporting\u5bc4\u5b58\u5668\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u7684\u80fd\u529b\uff08Capability\uff09\u548c\u63a7\u5236\u5bc4\u5b58\u5668\u5c31\u4f4d\u4e8eAdvanced Error Reporting\u5bc4\u5b58\u5668\u4e2d\u3002</p>"},{"location":"pcie/all/#l-ecrc","title":"l ECRC\u7684\u751f\u6210\u548c\u68c0\u67e5","text":"<p>ECRC\u8986\u76d6\u4e86\u6240\u6709\u5728\u8de8Fabric\u8f6c\u53d1\u65f6\u4e0d\u9700\u8981\u66f4\u6539\u7684\u5b57\u6bb5\u3002\u7136\u800c\uff0c\u5f53\u4e00\u4e2a\u6570\u636e\u5305\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u79fb\u52a8\u65f6\uff0c\u6709\u4e24\u4e2abit\u662f\u53ef\u4ee5\u5408\u6cd5\u7684\u8fdb\u884c\u6539\u53d8\u7684\uff1a</p> <p>o Type\u5b57\u6bb5\u7684Bit 0\uff1a\u5728\u4e00\u4e2a\u914d\u7f6e\u4e8b\u52a1\u901a\u8fc7\u4e00\u4e2aBridge\u65f6\uff0c\u8fd9\u4e2a\u914d\u7f6e\u4e8b\u52a1\u6709\u53ef\u80fd\u4eceType 1\u53d8\u6210Type 0\uff0c\u56e0\u4e3a\u8fd9\u4e2aBridge\u7684\u6b21\u7ea7\u603b\u7ebf\u6709\u53ef\u80fd\u5c31\u662f\u914d\u7f6e\u4e8b\u52a1\u7684\u76ee\u6807\u603b\u7ebf\u3002\u5728\u8fd9\u4e2a\u60c5\u51b5\u4e0b\uff0cType\u5730\u6bb5\u7684bit 0\u7684\u503c\u5c31\u4f1a\u4ece1\u53d8\u62100\u3002</p> <p>o EP\uff08Error/Poisoned\uff09bit\uff1a\u5f53\u4e00\u4e2aTLP\u5728\u7f51\u7edc\u7ed3\u6784\u4e2d\u79fb\u52a8\u65f6\uff0c\u5982\u679c\u4e0e\u8fd9\u4e2a\u6570\u636e\u5305\u76f8\u5173\u7684\u6570\u636e\u88ab\u8ba4\u4e3a\u662f\u635f\u574f\u7684\uff0c\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u5f15\u53d1\u8fd9\u4e2abit\u503c\u7684\u6539\u53d8\u3002\u8fd9\u662f\u4e00\u79cd\u53ef\u9009\u7684\u7279\u6027\uff0c\u79f0\u4e3a\u9519\u8bef\u8f6c\u53d1\uff08error forwarding\uff09\u3002</p>"},{"location":"pcie/all/#l-ecrc_1","title":"l \u8c01\u6765\u68c0\u67e5ECRC","text":"<p>ECRC\u7684\u9884\u5b9a\u76ee\u6807\u662fTLP\u7684\u6700\u7ec8\u63a5\u6536\u8005\u3002\u5bf9LCRC\uff08Link CRC\uff09\u7684\u6821\u9a8c\u662f\u7528\u6765\u9a8c\u8bc1\u5728\u5f53\u524d\u7ed9\u5b9a\u94fe\u8def\u4e0a\u7684\u4f20\u8f93\u6ca1\u6709\u51fa\u9519\uff0c\u4f46\u662f\u4f1a\u5728Switch/Bridge\u7684\u51fa\u53e3\u7aef\u53e3\uff08egress port\uff09\u91cd\u65b0\u8ba1\u7b97\u4e00\u4e2aLCRC\uff0c\u7136\u540e\u518d\u8f6c\u53d1\u7ed9\u4e0b\u4e00\u7ea7\u94fe\u8def\uff0c\u4e5f\u5c31\u662f\u8bf4\u540c\u4e00\u4e2aLCRC\u7684\u4f5c\u7528\u8303\u56f4\u4e0d\u4f1a\u8de8Switch/Bridge\uff0c\u90a3\u4e48\u8fd9\u5c06\u4f1a\u4f7f\u5f97Switch/Bridge\u8fd9\u4e9b\u8def\u7531\u5143\u4ef6\u5185\u90e8\u53d1\u751f\u7684\u9519\u8bef\u88ab\u63a9\u76d6\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5c31\u5728TLP\u5728Requester\u5230Completer\u7684\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u90fd\u52a0\u4e0a\u4e00\u4e2a\u4e0d\u4f1a\u6539\u53d8\u7684ECRC\uff08\u4e5f\u5c31\u662f\u8fd9\u4e2a\u8fc7\u7a0b\u4e2dECRC\u90fd\u4e0d\u4f1a\u88ab\u5176\u4ed6\u8bbe\u5907\u91cd\u65b0\u8ba1\u7b97\u548c\u66ff\u6362\uff09\u3002\u5f53\u76ee\u6807\u8bbe\u5907\u68c0\u67e5ECRC\u65f6\uff0c\u4efb\u4f55\u5728\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u53d1\u751f\u7684\u9519\u8bef\u90fd\u4f1a\u6781\u5bb9\u6613\u88ab\u53d1\u73b0\u3002</p> <p>\u5173\u4e8eECRC\u6821\u9a8c\u4e2dSwitch\u7684\u4f5c\u7528\uff0cPCIe\u534f\u8bae\u505a\u4e86\u4e24\u4e2a\u58f0\u660e\uff1a</p> <p>o \u5982\u679c\u4e00\u4e2aSwitch\u652f\u6301ECRC\u6821\u9a8c\uff0c\u90a3\u4e48\u5b83\u9700\u8981\u5bf9TLP\u76ee\u7684\u5730\u4e3aSwitch\u81ea\u8eab\u65f6\uff0c\u5bf9\u8fd9\u4e2aTLP\u4e2d\u7684ECRC\u8fdb\u884c\u6821\u9a8c\u3002\u5982\u679cTLP\u7684\u76ee\u7684\u5730\u5e76\u4e0d\u662fSwitch\u81ea\u8eab\uff0c\u90a3\u4e48Switch\u5fc5\u987b\u5728\u4fdd\u6301ECRC\u4e0d\u53d8\u7684\u524d\u63d0\u4e0b\u5bf9\u5176\u8fdb\u884c\u8f6c\u53d1\uff0c\u628aECRC\u4f5c\u4e3aTLP\u4e0d\u53ef\u5206\u5272\u7684\u4e00\u90e8\u5206\u3002\u201cOn all other TLPs a Switch must preserve the ECRC (forward it untouched) as an integral part of the TLP.\u201d</p> <p>o \u6ce8\u610f\uff0cSwitch\u4e5f\u53ef\u4ee5\u5bf9\u901a\u8fc7\u5b83\u7684TLP\u8fdb\u884cECRC\u68c0\u67e5\u3002\u7531Switch\u53d1\u73b0\u7684ECRC\u9519\u8bef\u7684\u62a5\u544a\u65b9\u6cd5\u548c\u5176\u4ed6\u8bbe\u5907\u4e00\u6837\uff0c\u4f46\u662f\u8fd9\u4e0d\u4f1a\u6539\u53d8TLP\u901a\u8fc7Switch\u7684\u7ee7\u7eed\u4f20\u8f93\u3002\u201cNote that a Switch may perform ECRC checking on TLPs passing through the Switch. ECRC Errors detected by the Switch are reported in the same way any other device would report them, but do not alter the TLPs passage through the Switch.\u201d</p>"},{"location":"pcie/all/#5243-using-byte-enables","title":"5.2.4.3   \u4f7f\u7528\u5b57\u8282\u4f7f\u80fd\uff08Using Byte Enables\uff09","text":""},{"location":"pcie/all/#l","title":"l \u6574\u4f53\u8bf4\u660e","text":"<p>\u7c7b\u4f3cPCI\u4e00\u6837\uff0c\u5bf9\u4e8e\u6709\u65f6\u4f20\u8f93\u5927\u5c0f\u6216\u8005\u8d77\u59cb/\u7ed3\u675f\u5730\u5740\u4e0d\u662fDW\u5bf9\u9f50\u65f6\uff0cPCIe\u4e5f\u9700\u8981\u4e00\u79cd\u673a\u5236\u6765\u6839\u636e\u9700\u8981\u534f\u8c03\u5176DW\u5bf9\u9f50\u5730\u5740\u3002\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0cPCIe\u5229\u7528\u4e862\u4e2a\u5b57\u8282\u4f7f\u80fd\uff08Byte Enable\uff09\u5b57\u6bb5\uff0c\u5982\u56fe 5\u20113\u4e2d\u548c\u8868 5\u20112\u4e2d\u6240\u4ecb\u7ecd\uff0c\u5206\u522b\u662f\u9996DW\u5b57\u8282\u4f7f\u80fd\uff08First DW Byte Enable\uff09\u548c\u5c3eDW\u5b57\u8282\u4f7f\u80fd\uff08Last DW Byte Enable\uff09\uff0c\u5b83\u4eec\u4f7f\u5f97Requester\u53ef\u4ee5\u5bf9\u7b2c\u4e00\u4e2aDW\u548c\u6700\u540e\u4e00\u4e2aDW\u771f\u6b63\u6709\u6548\u4f20\u8f93\u7684\u5b57\u8282\u8fdb\u884c\u9650\u5b9a\u3002</p>"},{"location":"pcie/all/#l_1","title":"l \u5b57\u8282\u4f7f\u80fd\u89c4\u5219","text":"<p>\\1.    \u5b57\u8282\u4f7f\u80fd\u5730\u5404\u4e2abit\u662f\u9ad8\u6709\u6548\u7684\u3002\u5982\u679c\u67d0\u4e2a\u5b57\u8282\u4f7f\u80fdbit\u503c\u4e3a0\uff0c\u90a3\u4e48\u5c31\u8868\u793a\u6570\u636e\u8377\u8f7d\u4e2d\u76f8\u5e94\u7684\u5b57\u8282\u4e0d\u5e94\u8be5\u88abCompleter\u4f7f\u7528\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5b57\u8282\u662f\u65e0\u6548\u7684\u3002\u82e5\u67d0\u4e2a\u5b57\u8282\u4f7f\u80fdbit\u503c\u4e3a1\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u76f8\u5e94\u7684\u5b57\u8282\u5e94\u8be5\u88abCompleter\u4f7f\u7528\u3002</p> <p>\\2.    \u5982\u679c\u6709\u6548\u7684\u6570\u636e\u5168\u90fd\u5728\u4e00\u4e2a\u5355\u72ec\u7684DW\u4e2d\uff0c\u90a3\u4e48\u5c3eDW\u5b57\u8282\u4f7f\u80fd\uff08Last DW Byte Enable\uff09\u5fc5\u987b\u4e3a0000b\u3002</p> <p>\\3.    \u5982\u679cHeader\u4e2d\u7684Length\u5b57\u6bb5\u8868\u793a\u4e86\u8fd9\u6b21\u4f20\u8f93\u6570\u636e\u91cf\u5927\u4e8e1DW\uff0c\u90a3\u4e48\u9996DW\u5b57\u8282\u4f7f\u80fd\uff08First DW Byte Enable\uff09\u81f3\u5c11\u8981\u67091\u4e2abit\u662f\u6709\u6548\u7684\u3002</p> <p>\\4.    \u5982\u679cHeader\u4e2d\u7684Length\u5b57\u6bb5\u8868\u793a\u4e86\u8fd9\u6b21\u4f20\u8f93\u6570\u636e\u91cf\u5927\u4e8e\u7b49\u4e8e3DW\uff0c\u90a3\u4e48\u9996DW\u5b57\u8282\u4f7f\u80fd\u548c\u5c3eDW\u5b57\u8282\u4f7f\u80fd\u90fd\u5fc5\u987b\u662f\u76f8\u8fde\u7684bit\u4e3a1\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e2d\uff0c\u5b57\u8282\u4f7f\u80fd\u4ec5\u80fd\u7528\u6765\u63d0\u4f9b\u6709\u6548\u8d77\u59cb\u5730\u5740\u548c\u7ed3\u675f\u5730\u5740\u4e0eDW\u5bf9\u9f50\u5730\u5740\u7684\u5b57\u8282\u504f\u79fb\u91cf\u3002</p> <p>\\5.    \u5982\u679c\u4f20\u8f93\u6570\u636e\u91cf\u5927\u5c0f\u4e3a1DW\uff0c\u90a3\u4e48\u624d\u80fd\u5141\u8bb8\u53ea\u6709\u9996DW\u5b57\u8282\u4f7f\u80fd\u5185\u662f\u4e0d\u8fde\u7eed\u4e3a1\u7684\u60c5\u51b5\u3002</p> <p>\\6.    \u5982\u679c\u4f20\u8f93\u6570\u636e\u91cf\u5927\u5c0f\u4e3a1-2DW\uff0c\u90a3\u4e48\u624d\u80fd\u5141\u8bb8\u9996DW\u5b57\u8282\u4f7f\u80fd\u548c\u7b2c\u4e8cDW\u5b57\u8282\u4f7f\u80fd\u5185\u90fd\u662f\u4e0d\u8fde\u7eed\u4e3a1\u7684\u60c5\u51b5\u3002</p> <p>\\7.    \u5982\u679c\u4e00\u4e2a\u5199\u8bf7\u6c42\uff0c\u5176Length\u5b57\u6bb5\u8868\u793a\u5176\u6570\u636e\u4f20\u8f93\u957f\u5ea6\u4e3a1DW\uff0c\u4f46\u662f\u5b83\u7684\u5b57\u8282\u4f7f\u80fd\u5747\u4e3a\u65e0\u6548\uff0c\u8fd9\u79cd\u60c5\u51b5\u5bf9Completer\u4e0d\u4f1a\u6709\u5f71\u54cd\u3002</p> <p>\\8.    \u5982\u679c\u4e00\u4e2a\u8bfb\u8bf7\u6c42\uff0c\u5176Length\u5b57\u6bb5\u8868\u793a\u5176\u9700\u8981\u7684\u6570\u636e\u4f20\u8f93\u957f\u5ea6\u4e3a1DW\uff0c\u4f46\u662f\u6ca1\u6709\u5b57\u8282\u4f7f\u80fd\u6709\u6548\uff0c\u90a3\u4e48Completer\u4f1a\u8fd4\u56de\u4e00\u4e2a1DW\u6570\u636e\u8377\u8f7d\uff0c\u8fd9\u79cd\u6570\u636e\u8377\u8f7d\u662f\u672a\u5b9a\u4e49\u6570\u636e\uff08undefined data\uff09\u3002\u8fd9\u79cd\u60c5\u51b5\u53ef\u80fd\u88ab\u7528\u4f5c\u4e00\u79cd\u5237\u65b0\u673a\u5236\uff08Flush mechanism\uff09\uff0c\u5b83\u5229\u7528\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\uff0c\u5728\u8fd9\u4e2aundefine data\u7684\u8bfb\u8bf7\u6c42\u5b8c\u6210\u5305\u8fd4\u56de\u4e4b\u524d\uff0c\u5f3a\u5236\u4e4b\u524d\u53d1\u51fa\u7684\u6240\u6709posted write\u8f93\u51fa\u5230\u5185\u5b58\u4e2d\u3002</p>"},{"location":"pcie/all/#l_2","title":"l \u5b57\u8282\u4f7f\u80fd\u793a\u4f8b","text":"<p>\u5982\u56fe 5\u20114\u5c55\u793a\u4e86\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u662f\u5982\u4f55\u4f7f\u7528\u7684\u3002\u6ce8\u610f\uff0c\u6570\u636e\u4f20\u8f93\u957f\u5ea6\u5fc5\u987b\u4ece\u7b2c\u4e00\u4e2aDW\u4e2d\u7684\u4efb\u4f55\u6709\u6548\u5b57\u8282\u5ef6\u4f38\u81f3\u6700\u540e\u4e00\u4e2aDW\u4e2d\u7684\u4efb\u4f55\u6709\u6548\u5b57\u8282\u3002\u56e0\u4e3a\u6570\u636e\u4f20\u8f93\u91cf\u5927\u4e8e2DW\uff0c\u5b57\u8282\u4f7f\u80fd\u5c31\u53ea\u80fd\u7528\u6765\u6807\u8bc6\u8fd9\u6b21\u4f20\u8f93\u4e2d\u8d77\u59cb\u5730\u5740\u7684\u4f4d\u7f6e\uff082d\uff09\u548c\u7ed3\u675f\u5730\u5740\u7684\u4f4d\u7f6e\uff0834d\uff09\u3002</p> <p></p> <p>\u56fe 5\u20114\u9996DW\u5b57\u8282\u4f7f\u80fd\u548c\u5c3eDW\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u7684\u4f7f\u7528</p>"},{"location":"pcie/all/#5244-transaction-descriptor-fields","title":"5.2.4.4   \u4e8b\u52a1\u63cf\u8ff0\u7b26\u5b57\u6bb5\uff08Transaction Descriptor Fields\uff09","text":"<p>\u5f53\u4e8b\u52a1\u5728Requester\u548cCompleter\u4e4b\u95f4\u79fb\u52a8\u65f6\uff0c\u5fc5\u987b\u8981\u80fd\u591f\u5bf9\u5404\u4e2a\u4e8b\u52a1\u8fdb\u884c\u552f\u4e00\u7684\u6807\u8bc6\uff0c\u56e0\u4e3a\u5728\u4efb\u4f55\u65f6\u523b\u7684Requester\u4e2d\u90fd\u6709\u53ef\u80fd\u6709\u8bb8\u591a\u7684\u62c6\u5206\u4e8b\u52a1\u5728\u6392\u961f\u3002\u4e3a\u4e86\u66f4\u597d\u7684\u8fdb\u884c\u6807\u8bc6\uff0cPCIe\u534f\u8bae\u5728TLP Header\u4e2d\u5b9a\u4e49\u4e86\u591a\u4e2a\u91cd\u8981\u5b57\u6bb5\uff0c\u6765\u7ec4\u6210\u4e00\u4e2a\u552f\u4e00\u7684\u4e8b\u52a1\u63cf\u8ff0\u7b26\uff08Transaction Descriptor\uff09\uff0c\u5982\u56fe 5\u20115\u6240\u793a\u3002</p> <p></p> <p>\u56fe 5\u20115\u4e8b\u52a1\u63cf\u8ff0\u7b26\u5b57\u6bb5</p> <p>\u867d\u7136\u4e8b\u52a1\u63cf\u8ff0\u7b26\u5728TLP Header\u4e2d\u5e76\u4e0d\u662f\u4f4d\u7f6e\u5168\u8fde\u7eed\u7684\u5b57\u6bb5\uff0c\u4f46\u662f\u8fd9\u4e9b\u4e0d\u8fde\u7eed\u5b57\u6bb5\u5408\u8d77\u6765\u53ef\u4ee5\u4e00\u8d77\u63cf\u8ff0\u4e8b\u52a1\u7684\u5173\u952e\u5c5e\u6027\uff0c\u5305\u62ec\uff1a</p>"},{"location":"pcie/all/#l-idtransaction-id","title":"l \u4e8b\u52a1ID\uff08Transaction ID\uff09","text":"<p>\u4e8b\u52a1ID\u7531Requester ID\uff08Requester\u7684BDF\uff09\u548cTLP\u7684Tag\u5b57\u6bb5\u5171\u540c\u7ec4\u6210\u3002</p>"},{"location":"pcie/all/#l-traffic-class","title":"l \u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff09","text":"<p>\u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff0cTC\uff09\u662f\u7531Requester\u7684Device Core\u6765\u6dfb\u52a0\u8fdbTLP\u7684\uff0c\u5e76\u4e14\u5728\u62d3\u6251\u7ed3\u6784\u4e2d\u4eceRequester\u4f20\u8f93\u5230Completer\u7684\u8fc7\u7a0b\u4e2dTC\u90fd\u4e0d\u53d1\u751f\u6539\u53d8\u3002\u5728\u62d3\u6251\u7ed3\u6784\u7684\u6bcf\u4e2a\u94fe\u8def\u4e2d\uff0cTC\u90fd\u6620\u5c04\u5230\u5176\u4e2d\u4e00\u4e2a\u865a\u62df\u901a\u9053\uff08Virtual Channel\uff09\u3002</p>"},{"location":"pcie/all/#l-transaction-attributes","title":"l \u4e8b\u52a1\u5c5e\u6027\uff08Transaction Attributes\uff09","text":"<p>\u7528\u4e8e\u8868\u793a\u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3001\u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09\u4ee5\u53ca\u65e0\u7aa5\u63a2\uff08No Snoop\uff09\u7684bit\u4e5f\u5b58\u5728\u4e8e\u8bf7\u6c42\u5305\u4e2d\uff0c\u88ab\u53d1\u9001\u7ed9Completer\u3002</p>"},{"location":"pcie/all/#5245-tlp","title":"5.2.4.5   \u5e26\u6709\u6570\u636e\u8377\u8f7d\u7684TLP\u7684\u4e00\u4e9b\u989d\u5916\u89c4\u5219","text":"<p>\u5f53\u4e00\u4e2aTLP\u5e26\u6709\u6570\u636e\u8377\u8f7d\u65f6\uff0c\u5c31\u8981\u9075\u4ece\u5982\u4e0b\u89c4\u5219\uff1a</p> <p>\\1.    Length\u5b57\u6bb5\u4ec5\u8868\u793a\u6570\u636e\u8377\u8f7d\u7684\u957f\u5ea6\u3002</p> <p>\\2.    \u6570\u636e\u8377\u8f7d\u7684\u9996\u5b57\u8282\uff08\u7d27\u6328\u7740Header\u7684\u5b57\u8282\uff09\u7684\u5730\u5740\u6c38\u8fdc\u662f\u6700\u4f4e\u4f4d\u7684\u3002</p> <p>\\3.    Length\u5b57\u6bb5\u6c38\u8fdc\u8868\u793a\u7684\u662f\u6574\u6570DW\u7684\u4f20\u8f93\u957f\u5ea6\u3002\u5bf9\u4e8e\u4e0d\u6ee1\u6574\u6570DW\u7684\u60c5\u51b5\u662f\u4f7f\u7528\u9996DW\u5b57\u8282\u4f7f\u80fd\u548c\u5c3eDW\u5b57\u8282\u4f7f\u80fd\u6765\u8fdb\u884c\u8868\u793a\u7684\u3002</p> <p>\\4.    \u5728\u534f\u8bae\u4e2d\u6709\u58f0\u660e\uff0c\u5f53\u4e00\u4e2aCompleter\u5728\u54cd\u5e94\u4e00\u4e2a\u5355\u72ec\u7684Memory\u8bf7\u6c42\u65f6\u5982\u679c\u8fd4\u56de\u4e86\u591a\u4e2aTLP\uff0c\u90a3\u4e48\u4e2d\u95f4\u7684\uff08\u4e5f\u5c31\u662f\u975e\u9996\u5c3e\u7684\uff09TLP\u7684\u6570\u636e\u8377\u8f7d\u7684\u5730\u5740\u5fc5\u987b\u7ed3\u675f\u4e8eRC\u768464byte\u6216128byte\u81ea\u7136\u5bf9\u9f50\u7684\u8fb9\u754c\u4e0a\u3002\u5177\u4f53\u662f\u90a3\u79cd\u8fb9\u754c\u662f\u7531\u4e00\u4e2a\u53ef\u914d\u7f6e\u4f4d\u79f0\u4e3aRCB\uff08\u8bfb\u5b8c\u6210\u8fb9\u754c\uff0cRead Completion Boundary\uff09\u6765\u63a7\u5236\u7684\u3002\u6240\u6709\u7684\u5176\u4ed6\u8bbe\u5907\u9075\u5faaPCI-X\u534f\u8bae\uff0c\u5e76\u4f1a\u5c06\u8fd9\u79cd\u60c5\u51b5\u7684TLP\u622a\u65ad\u5728128byte\u81ea\u7136\u5bf9\u9f50\u8fb9\u754c\u4e0a\u3002</p> <p>\\5.    \u5f53\u53d1\u9001Message\u8bf7\u6c42\u65f6\uff0cLength\u5b57\u6bb5\u662f\u4fdd\u7559\u5b57\u6bb5\uff0c\u9664\u975eMessage\u662f\u5e26\u6709\u6570\u636e\u8377\u8f7d\u7684\uff0c\u4e5f\u5c31\u662fMsgD\u3002</p> <p>\\6.    TLP\u7684\u6570\u636e\u8377\u8f7d\u4e00\u5b9a\u4e0d\u80fd\u5927\u4e8e\u8bbe\u5907\u63a7\u5236\u5bc4\u5b58\u5668\uff08Device Control Register\uff09\u4e2d\u7684\u6700\u5927\u6570\u636e\u8377\u8f7d\u5b57\u6bb5\uff08Max_Payload_Size\uff09\u3002\u56e0\u4e3a\u53ea\u6709\u5199\u4e8b\u52a1\u4f1a\u5e26\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64\u8fd9\u79cd\u9650\u5236\u5e76\u4e0d\u5e94\u7528\u4e8e\u8bfb\u8bf7\u6c42\u3002\u63a5\u6536\u65b9\u9700\u8981\u5728\u88ab\u5199\u5165\u65f6\u68c0\u67e5\u662f\u5426\u5b58\u5728Max_Payload_Size\u7684\u8fdd\u4f8b\uff0c\u5982\u679c\u5b58\u5728\u5219\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\7.    \u63a5\u6536\u65b9\u8fd8\u9700\u8981\u68c0\u67e5Length\u5b57\u6bb5\u548cTLP\u5b9e\u9645\u4f20\u8f93\u7684\u6570\u636e\u8377\u8f7d\u957f\u5ea6\u3002\u5982\u679c\u4e8c\u8005\u4e0d\u76f8\u540c\u5219\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\8.    \u8bf7\u6c42\u5305\u4e2d\u7684\u8d77\u59cb\u5730\u5740\u548c\u4f20\u8f93\u957f\u5ea6\u7684\u7ec4\u5408\u4fe1\u606f\uff0c\u4e00\u5b9a\u4e0d\u80fd\u9020\u6210\u8de84KB\u8fb9\u754c\u7684Memory\u8bbf\u95ee\u3002\u867d\u7136\u8fd9\u79cd\u68c0\u67e5\u662f\u53ef\u9009\u7684\uff0c\u4f46\u662f\u4e00\u65e6\u53d1\u73b0\u4e86\u8de84KB\u8fb9\u754c\u8bbf\u95ee\u7684\u60c5\u51b5\u5c31\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p>"},{"location":"pcie/all/#525-tlptlptlp","title":"5.2.5     \u5177\u4f53\u7684TLP\u683c\u5f0f\uff1a\u8bf7\u6c42TLP\u548c\u5b8c\u6210TLP","text":"<p>\u5728\u672c\u8282\u4e2d\uff0c\u5c06\u4f1a\u63cf\u8ff0\u7528\u6765\u6784\u6210\u5177\u4f53\u7684\u4e00\u4e9b\u4e8b\u7269\u7c7b\u578b\u7684TLP 3DW Header\u548c4DW Header\u3002\u8bb8\u591a\u901a\u7528\u7684\u5b57\u6bb5\u5c31\u5982\u524d\u6587\u6240\u8ff0\uff0c\u56e0\u6b64\u6211\u4eec\u628a\u91cd\u70b9\u653e\u5728\u90a3\u4e9b\u9700\u8981\u6839\u636e\u5177\u4f53\u4e8b\u52a1\u7c7b\u578b\u8fdb\u884c\u5177\u4f53\u5904\u7406\u7684\u5b57\u6bb5\u4e0a\u3002\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u662f\u5173\u4e8eTLP Header\u7684\u8be6\u7ec6\u63cf\u8ff0\uff0c\u76f8\u5173\u7684TLP\u7c7b\u578b\u4e3a\uff1a1\uff09IO Request\uff0c2\uff09Memory Requests\uff0c3\uff09Configuration Requests\uff0c4\uff09Completions\uff0c\u4ee5\u53ca5\uff09Message Request\u3002</p>"},{"location":"pcie/all/#5251-ioio-request","title":"5.2.5.1   IO\u8bf7\u6c42\uff08IO Request\uff09","text":"<p>\u867d\u7136\u534f\u8bae\u4e2d\u4e0d\u9f13\u52b1\u4f7f\u7528IO\u4e8b\u52a1\uff0c\u4f46\u662f\u5bf9\u4e8e\u4f20\u7edf\u9057\u7559\u8bbe\u5907\u8fd8\u662f\u5141\u8bb8\u7684\uff0c\u5e76\u4e14\u5bf9\u4e8e\u8f6f\u4ef6\u6765\u8bf4\u9700\u8981\u901a\u8fc7IO\u4e8b\u52a1\u6765\u517c\u5bb9\u90a3\u4e9b\u5b58\u5728\u7cfb\u7edfIO\u6620\u5c04\u800c\u4e0d\u662f\u5185\u5b58\u6620\u5c04\u7684\u8bbe\u5907\u3002\u867d\u7136IO\u4e8b\u52a1\u4ece\u6280\u672f\u4e0a\u8bb2\u662f\u53ef\u4ee5\u8bbf\u95ee32bit IO\u8303\u56f4\u7684\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8bb8\u591a\u7cfb\u7edf\uff08\u548cCPU\uff09\u90fd\u4f1a\u5c06IO\u8bbf\u95ee\u9650\u5236\u5728\u4f4e16bit\uff0864KB\uff09\u8303\u56f4\u5185\u3002\u56fe 5\u20116\u5c55\u793a\u4e86\u7cfb\u7edfIO\u6620\u5c04\u4ee5\u53ca16bit\u548c32bit\u5730\u5740\u8fb9\u754c\u3002\u81ea\u8eab\u4e0d\u662f\u4f20\u7edf\u9057\u7559\u8bbe\u5907\u7684\u8bbe\u5907\u662f\u4e0d\u5141\u8bb8\u8bbf\u95eeBAR\u4e2d\u7684IO\u5730\u5740\u7a7a\u95f4\u7684\u3002</p> <p></p> <p>\u56fe 5\u20116 \u7cfb\u7edfIO\u6620\u5c04</p>"},{"location":"pcie/all/#l-io-request-header","title":"l IO Request Header\u7684\u683c\u5f0f","text":"<p>\u5982\u56fe 5\u20117\u6240\u793a\u662f\u4e00\u4e2a3DW IO Request Header\uff0c\u5176\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u4f1a\u5728\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u4e2d\u8fdb\u884c\u63cf\u8ff0\u3002</p> <p></p> <p>\u56fe 5\u20117 3DW IO Request Header\u683c\u5f0f</p>"},{"location":"pcie/all/#l-io-request-header_1","title":"l IO Request Header\u5404\u5b57\u6bb5","text":"<p>\u4e00\u4e2aIO Request Header\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20114\u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8eHeader\u4e2d\u7684Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 IO\u8bf7\u6c42\u7684\u5305\u683c\u5f0f\u5b57\u6bb5\uff1a  000b=IO  Read\uff083DW\uff0c\u65e0\u6570\u636e\uff09  010b=IO  Write\uff083DW\uff0c\u6709\u6570\u636e\uff09 Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 0010b=IO\u8bf7\u6c42 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 IO\u8bf7\u6c42\u7684TC\u6c38\u8fdc\u4e3a0\uff0c\u786e\u4fdd\u8fd9\u4e9b\u5305\u6c38\u8fdc\u4e0d\u4f1a\u5e72\u6270\u9ad8\u4f18\u5148\u7ea7\u7684\u5305\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u7531\u4e8eIO\u8bf7\u6c42\u4e0d\u4f7f\u7528\u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 TH  TLP\u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u7531\u4e8eIO\u8bf7\u6c42\u4e0d\u4f7f\u7528TLP\u5904\u7406\u63d0\u793a\uff08TLP Processing Hints\uff09\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 TD  TLP\u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u8868\u793aTLP\u7684\u672b\u5c3e\u662f\u5426\u5b58\u5728Digest\u5b57\u6bb5\uff0c\u4e5f\u5c31\u662fECRC\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u8868\u793aTLP\u7684\u6570\u636e\u8377\u8f7d\uff08\u5982\u679c\u6709\uff09\u662f\u5426\u88ab\u6c61\u67d3\uff08poisoned\uff09\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 \u7531\u4e8eIO\u8bf7\u6c42\u4e0d\u4f7f\u7528\u5bbd\u677e\u6392\u5e8f\uff08Relaxed  Ordering\uff09\u548c\u65e0\u7aa5\u63a2\uff08No Snoop\uff09\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u4e3a0\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u7531\u4e8eIO\u8bf7\u6c42\u4e0d\u4f7f\u7528\u5730\u5740\u7c7b\u578b\u5b57\u6bb5\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a0\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u8be5\u5b57\u6bb5\u7528\u6765\u8868\u793a\u4ee5DW\u4e3a\u5355\u4f4d\u7684\u6570\u636e\u8377\u8f7d\u5927\u5c0f\u3002\u5bf9\u4e8eIO\u8bf7\u6c42\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u4e3a1\uff0c\u56e0\u4e3aIO\u8bf7\u6c42\u4e0d\u80fd\u4f20\u8f93\u8d85\u8fc74Byte\u3002\u7531\u9996DW\u5b57\u8282\u4f7f\u80fd\u6765\u9650\u5b9a\u4f7f\u7528\u54ea\u4e2aByte\u3002 Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u76f8\u5e94\u5b8c\u6210\u5305\u7684\u201c\u8fd4\u56de\u5730\u5740\u201d\u3002  Byte 4,7:0=Bus  Number  Byte 5,7:3=Device  Number  Byte 5,2:0=Function  Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u6765\u6807\u8bc6\u6765\u81eaRequester\u7684\u5177\u4f53\u6bcf\u4e2a\u8bf7\u6c42\u3002\u6bcf\u4e2a\u88ab\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684Tag\u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u4f7f\u7528Tag[4:0]\uff0c\u4f46\u662f\u6269\u5c55Tag\uff08Extended Tag\uff09\u548cPhantom Function\u53ef\u9009\u9879\u53ef\u4ee5\u5c06Tag\u7684\u4f7f\u7528\u6269\u5c55\u4e3aTag[10:0]\uff0c\u8fd9\u6837\u5c31\u5141\u8bb8\u591a\u8fbe2048\u4e2a\u672a\u5b8c\u6210\u7684\u8bf7\u6c42\u540c\u65f6\u8fdb\u884c\u3002 Last  DW BE[3:0]  \u5c3eDW\u5b57\u8282\u4f7f\u80fd Byte  7 Bit 7:4 \u56e0\u4e3aIO\u8bf7\u6c42\u6570\u636e\u5927\u5c0f\u53ea\u80fd\u662f1DW\u4ee5\u5185\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a0000b\u3002 1<sup>st</sup>  DW BE[3:0]  \u9996DW\u5b57\u8282\u4f7f\u80fd Byte  7 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u7b2c\u4e00\u4e2aDW\u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002\u5bf9\u4e8eIO\u8bf7\u6c42\u6765\u8bf4\uff0c\u6240\u6709\u7684bit\u7ec4\u5408\u90fd\u662f\u5141\u8bb8\u7684\uff08\u5305\u62ec0000b\uff09\u3002 Address[31:2]  \u5730\u5740 Byte  8 Bit 7:0  Byte  9 Bit 7:0  Byte  10 Bit 7:0  Byte  11 Bit 7:2 \u8be5\u5b57\u6bb5\u662f32bit\u8d77\u59cb\u5730\u5740\u7684\u9ad830bit\u3002\u800c\u6700\u4f4e2bit\u662f\u4fdd\u7559\u4f4d\uff0800b\uff09\uff0c\u8fd9\u4f7f\u5f9732bit\u8d77\u59cb\u5730\u5740\u4e00\u5b9a\u662fDW\u5bf9\u9f50\u7684\u3002 <p>\u8868 5\u20114 IO Request Header\u5404\u5b57\u6bb5</p>"},{"location":"pcie/all/#5252-memorymemory-request","title":"5.2.5.2   Memory\u8bf7\u6c42\uff08Memory Request\uff09","text":"<p>PCIe\u7684Memory\u4e8b\u52a1\u5305\u542b\u4e24\u79cd\u7c7b\u578b\uff1a\u7b2c\u4e00\u79cd\u662f\u8bfb\u8bf7\u6c42\u53ca\u5176\u76f8\u5bf9\u5e94\u7684\u5b8c\u6210\u5305\uff0c\u7b2c\u4e8c\u79cd\u662f\u5199\u8bf7\u6c42\u3002\u7cfb\u7edf\u5185\u5b58\u6620\u5c04\u5982\u6240\u793a\uff0c\u5c55\u793a\u4e863DW\u4e0e4DW\u7684Memory\u8bf7\u6c42\u5305\u3002\u9700\u8981\u8bb0\u4f4f\u534f\u8bae\u89c4\u8303\u4e2d\u591a\u6b21\u91cd\u7533\u7684\u4e00\u70b9\uff0cMemory\u4f20\u8f93\u7edd\u5bf9\u4e0d\u5141\u8bb8\u8de84KB\u5730\u5740\u8fb9\u754c\u3002</p> <p></p> <p>\u56fe 5\u20118 3DW\u548c4DW\u7684Memory Request Header\u683c\u5f0f</p>"},{"location":"pcie/all/#l-memory-request-header","title":"l Memory Request Header\u5404\u5b57\u6bb5","text":"<p>\u4e00\u4e2a4DW\u7684Memory Request Header\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20115\u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002\u6ce8\u610f\uff0c3DW\u548c4DW Header\u7684\u533a\u522b\u4ec5\u4ec5\u662f\u8d77\u59cb\u5730\u5740\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u5b57\u6bb5\u5927\u5c0f\u4e0d\u540c\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8eHeader\u4e2d\u7684Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 IO\u8bf7\u6c42\u7684\u5305\u683c\u5f0f\u5b57\u6bb5\uff1a  000b=Memory  Read\uff083DW\u65e0\u6570\u636e\uff09  010b=Memory  Write\uff083DW\u6709\u6570\u636e\uff09  001b=Memory  Read\uff084DW\u65e0\u6570\u636e\uff09  011b=Memory  Write\uff084DW\u6709\u6570\u636e\uff09  1xxb=TLP\u524d\u7f00\u5df2\u7ecf\u88ab\u6dfb\u52a0\u5230\u5305\u7684\u5f00\u5934\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTPH\uff08TLP Processing Hints\uff09\u201d\u4e00\u8282 Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 0000b=  Memory Read\u6216Write  0 0001b=  Memory Read Locked  Type\u5b57\u6bb5\u4e0eFmt[1:0]\u5171\u540c\u6307\u5b9a\u4e8b\u52a1\u7c7b\u578b\u3001Header\u5927\u5c0f\u4ee5\u53ca\u662f\u5426\u6709\u6570\u636e\u8377\u8f7d\u3002 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 \u8fd9\u4e2a\u5b57\u6bb5\u7684\u7f16\u7801\u4fe1\u606f\u662f\u8bf7\u6c42\u5305\u53ca\u5176\u5b8c\u6210\u5305\u7684\u6d41\u91cf\u7c7b\u578b\u3002  000b=TC  0\uff08\u9ed8\u8ba4\uff09  \u2026\u2026  111b=TC  7  \u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTraffic Class\uff08TC\uff09\u201d\u4e00\u8282\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u8868\u793a\u8fd9\u4e2aTLP\u662f\u5426\u4f7f\u7528\u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\uff08IDO\uff09\u201d\u4e00\u8282\u3002 TH  TLP\u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u6307\u793a\u662f\u5426\u5305\u542bTLP\u63d0\u793a\u4fe1\u606f\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cTPH\uff08TLP Processing  Hints\uff09\u201d\u4e00\u8282\u3002 TD  TLP\u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u5982\u679c\u4e3a1\uff0c\u5219TLP\u4e2d\u5b58\u5728TLP Digest\u5b57\u6bb5\uff0c\u5373\u5b58\u5728ECRC\u3002  \u4e00\u4e9b\u89c4\u5219\uff1a  \u6240\u6709\u7684\u63a5\u6536\u8005\u90fd\u8981\u4f7f\u7528\u8fd9\u4e2aTD bit\u68c0\u67e5\u662f\u5426\u5b58\u5728Digest\u5b57\u6bb5\u3002  l TD=1\u4f46\u662f\u4e0d\u542b\u6709Digest\u5b57\u6bb5\u7684TLP\u88ab\u5f53\u505a\u7578\u5f62\uff08Malformed\uff09  l \u5982\u679cTD=1\uff0c\u4e14\u63a5\u6536\u8005\u4e5f\u542f\u7528\u4e86ECRC\u68c0\u67e5\uff0c\u90a3\u4e48\u5c31\u5fc5\u987b\u5bf9ECRC\u8fdb\u884c\u68c0\u67e5\u3002  l \u5982\u679c\u63a5\u6536\u8005\u5e76\u4e0d\u652f\u6301\u53ef\u9009\u7684ECRC\u6821\u9a8c\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u8981\u5ffd\u7565TLP\u4e2d\u7684Digest\u5b57\u6bb5\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u5982\u679c\u4e3a1\uff0c\u90a3\u4e48\u4f34\u968f\u8fd9\u4e2aTLP\u7684\u6570\u636e\u8377\u8f7d\u5c31\u90fd\u88ab\u8ba4\u4e3a\u662f\u6709\u9519\u8bef\u7684\uff0c\u5c3d\u7ba1\u8fd9\u4e2a\u4e8b\u52a1\u8fd8\u662f\u53ef\u4ee5\u7167\u5e38\u5b8c\u6210\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 l Bit 5 =\u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09  \u5f53Bit 5=1\uff0c\u8fd9\u4e2aTLP\u5c31\u4f7f\u7528PCI-X\u7684\u5bbd\u677e\u6392\u5e8f\u3002\u5426\u5219\uff0c\u4f7f\u7528\u4e25\u683c\u7684PCI\u6392\u5e8f\u3002  l Bit 6=\u65e0\u7aa5\u63a2\uff08No Snoop\uff09  \u5f53Bit 6=1\uff0c\u7cfb\u7edf\u8f6f\u4ef6\u5c31\u4e0d\u9700\u8981\u8fdb\u884c\u5173\u4e8e\u8fd9\u4e2aTLP\u7684\u5904\u7406\u5668Cache\u4e00\u81f4\u6027\u7aa5\u63a2\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u8fd9\u4e2a\u5b57\u6bb5\u652f\u6301\u865a\u62df\u7cfb\u7edf\uff08virtualized systems\uff09\u7684\u5730\u5740\u7ffb\u8bd1\u3002\u5730\u5740\u7ffb\u8bd1\u534f\u8bae\u662f\u7531\u4e00\u4e2a\u5355\u72ec\u7684\u534f\u8bae\u89c4\u8303\u6765\u63cf\u8ff0\u7684\uff0c\u79f0\u4e3a\u5730\u5740\u7ffb\u8bd1\u670d\u52a1\uff08Address Translation Services\uff09\uff0cAT\u4e2d\u7684\u7f16\u7801\u4fe1\u606f\u4e3a\uff1a  00=\u9ed8\u8ba4/\u672a\u7ffb\u8bd1  01=\u7ffb\u8bd1\u8bf7\u6c42  10=\u5df2\u7ffb\u8bd1  11=\u4fdd\u7559\u4f4d Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 TLP\u6570\u636e\u8377\u8f7d\u7684\u957f\u5ea6\uff0c\u5355\u4f4d\u4e3aDW\u3002\u6700\u5927\u4e3a1024DW\uff084KB\uff09\uff0c\u7f16\u7801\u5982\u4e0b\uff1a  00  0000 0001b=1DW  00  0000 0010b=2DW  \u2026\u2026  11  1111 1111b=1023DW  00  0000 0000b=1024DW Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76f8\u5e94\u5b8c\u6210\u5305\u7684\u201c\u8fd4\u56de\u5730\u5740\u201d\u3002  Byte 4,7:0=Bus  Number  Byte 5,7:3=Device  Number  Byte 5,2:0=Function  Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u6765\u6807\u8bc6\u6765\u81eaRequester\u7684\u5177\u4f53\u6bcf\u4e2a\u8bf7\u6c42\u3002\u6bcf\u4e2a\u88ab\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684Tag\u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u4f7f\u7528Tag[4:0]\uff0c\u5982\u679cControl Register\u4e2d\u7684Extended Tag\u4f4d\u88ab\u7f6e\u4e3a1\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06Tag\u7684\u4f7f\u7528\u6269\u5c55\u4e3aTag[7:0]\uff0c\u8fd9\u6837\u5c31\u5141\u8bb8\u6700\u591a\u4f7f\u7528256\u4e2aTag\u3002 Last  DW BE[3:0]  \u5c3eDW\u5b57\u8282\u4f7f\u80fd Byte  7 Bit 7:4 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u6700\u540e\u4e00\u4e2aDW\u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282 1<sup>st</sup>  DW BE[3:0]  \u9996DW\u5b57\u8282\u4f7f\u80fd Byte  7 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u7b2c\u4e00\u4e2aDW\u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002 Address[63:32]  \u9ad832bit\u5730\u5740 Byte  8 Bit 7:0  Byte  9 Bit 7:0  Byte  10 Bit 7:0  Byte  11 Bit 7:2 \u8be5\u5b57\u6bb5\u662fMemory\u4f20\u8f93\u768464bit\u8d77\u59cb\u5730\u5740\u7684\u9ad832bit\u3002 Address[31:2]  \u4f4e32bit\u5730\u5740 Byte  12 Bit 7:0  Byte  13 Bit 7:0  Byte  14 Bit 7:0  Byte  15 Bit 7:2 \u8be5\u5b57\u6bb5\u662fMemory\u4f20\u8f93\u768464bit\u8d77\u59cb\u5730\u5740\u7684\u4f4e32bit\u3002\u800c\u6700\u4f4e2bit\u662f\u4fdd\u7559\u4f4d\u59cb\u7ec8\u4e3a0\uff0c\u8fd9\u6837\u5c31\u5f3a\u5236\u8d77\u59cb\u5730\u5740\u662fDW\u5bf9\u9f50\u7684\u3002 <p>\u8868 5\u20115 4DW Memory Request Header\u5404\u5b57\u6bb5</p>"},{"location":"pcie/all/#l-memory-request","title":"l Memory Request \u6ce8\u610f\u4e8b\u9879","text":"<p>Memory\u8bf7\u6c42\u7684\u7279\u6027\u5305\u62ec\uff1a</p> <p>\\1.    Memory\u6570\u636e\u4f20\u8f93\u4e0d\u5141\u8bb8\u8de84KB\u8fb9\u754c\u3002</p> <p>\\2.    \u6240\u6709\u7684\u5185\u5b58\u6620\u5c04\u5199\uff08Memory-Mapped Write\uff09\u90fd\u662fPosted\u7684\uff0c\u4ee5\u6b64\u6765\u63d0\u5347\u6027\u80fd\u3002</p> <p>\\3.    \u4f7f\u752832bit\u6216\u800564bit\u5730\u5740\u65b9\u5f0f\u3002</p> <p>\\4.    \u6570\u636e\u8377\u8f7d\u5927\u5c0f\u57280-1024DW\u4e4b\u95f4\uff080-4KB\uff09\u3002</p> <p>\\5.    QoS\uff08Quality of Service\uff09\u7279\u6027\u53ef\u4ee5\u88ab\u4f7f\u7528\uff0c\u6700\u591a\u53ef\u4ee5\u67098\u4e2a\u6d41\u91cf\u7c7b\u578b\u3002</p> <p>\\6.    No Snoop\u5c5e\u6027\u53ef\u4ee5\u5728\u4e8b\u52a1\u8bbf\u95ee\u4e3b\u5b58\u65f6\uff0c\u7528\u6765\u51cf\u8f7b\u7cfb\u7edf\u5bf9\u7aa5\u63a2\u5904\u7406\u5668Cache\u7684\u9700\u6c42\u3002</p> <p>\\7.    Relaxed Ordering\u5c5e\u6027\u53ef\u4ee5\u4f7f\u5f97\u6570\u636e\u5305\u4f20\u8f93\u8def\u5f84\u4e0a\u7684\u8bbe\u5907\u5bf9\u8fd9\u4e2aTLP\u4f7f\u7528\u5bbd\u677e\u6392\u5e8f\u89c4\u5219\uff0c\u4ee5\u6b64\u6765\u63d0\u5347\u6027\u80fd\u3002</p>"},{"location":"pcie/all/#5253-configurationconfiguration-request","title":"5.2.5.3   Configuration\u8bf7\u6c42\uff08Configuration Request\uff09","text":"<p>PCIe\u50cfPCI\u4e00\u6837\u4f7f\u7528Type 0\u548cType 1\u914d\u7f6e\u8bf7\u6c42\uff0c\u4ee5\u6b64\u6765\u4fdd\u6301\u5411\u540e\u517c\u5bb9\u6027\u3002\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u4f1a\u5411\u4e0b\u884c\u4f20\u64ad\uff0c\u76f4\u5230\u4e00\u4e2aBridge\u7684\u6b21\u7ea7\u603b\u7ebf\uff08Secondary Bus\uff09\u6b63\u597d\u662f\u8fd9\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u603b\u7ebf\uff0c\u5728\u8fd9\u65f6\u8fd9\u4e2aBridge\u5c31\u4f1a\u628a\u8fd9\u4e2a\u914d\u7f6e\u4e8b\u52a1\u4eceType 1\u8f6c\u6362\u4e3aType 0\u3002Bridge\u662f\u901a\u8fc7\u6b64\u524d\u7f16\u7a0b\u5199\u5165\u7684\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u6765\u5f97\u77e5\u4f55\u65f6\u5e94\u8be5\u5bf9\u914d\u7f6e\u4e8b\u52a1\u8fdb\u884cType\u8f6c\u6362\u4ee5\u53ca\u7ee7\u7eed\u8f6c\u53d1\uff0c\u5176\u4e2d\u603b\u7ebf\u53f7\u5bc4\u5b58\u5668\u5305\u62ec\u4e3b\u603b\u7ebf\u53f7\uff08Primary Bus Number\uff09\u3001\u6b21\u7ea7\u603b\u7ebf\u53f7\uff08Secondary Bus Number\uff09\u4ee5\u53ca\u4ece\u5c5e\u603b\u7ebf\u53f7\uff08Subordinate Bus Number\uff09\u3002\u5173\u4e8e\u8fd9\u91cc\u7684\u66f4\u591a\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201c\u4f20\u7edfPCI\u673a\u5236\uff08Legacy PCI Mechanism\uff09\u201d\u4e00\u8282\u3002</p> <p>\u5982\u56fe 5\u20119\u4e2d\uff0c\u4e00\u4e2aType 1\u914d\u7f6e\u8bf7\u6c42\u6b63\u5728\u6309\u7167\u89c4\u5219\u5411\u4e0b\u884c\u79fb\u52a8\uff0c\u5b83\u5728Switch\u5de6\u4fa7\u7684\u4e0b\u884c\u7aef\u53e3\u7684Bridge\u88ab\u8f6c\u6362\u6210Type 0\uff0c\u8fd9\u79cd\u8f6c\u6362\u662f\u901a\u8fc7\u6539\u53d8TLP Header\u4e2d\u7684Type\u5b57\u6bb5Bit 0\u6765\u5b8c\u6210\u7684\uff08Type\u4ece0 0101b\u53d8\u4e3a0 0100b\uff09\u3002\u6ce8\u610f\uff0c\u4e0d\u540c\u4e8ePCI\uff0cPCIe\u4e2d\u4e0b\u884c\u7684\u4e00\u6761\u94fe\u8def\u4e0a\u53ea\u80fd\u7531\u4e00\u4e2a\u8bbe\u5907\uff0c\u56e0\u6b64\u94fe\u8def\u4e0a\u4e0d\u9700\u8981\u6709IDSEL\u6216\u8005\u5176\u4ed6\u6307\u793a\u4fe1\u53f7\u6765\u544a\u8bc9\u8bbe\u5907\u9700\u8981\u58f0\u660e\u81ea\u5df1\u5360\u6709Type 0\u914d\u7f6e\u8bf7\u6c42\uff0c\u4e5f\u5c31\u662f\u8bf4\u8bbe\u5907\u53ea\u8981\u4ece\u4e0a\u884c\u6536\u5230\u4e86Type 0\u914d\u7f6e\u8bf7\u6c42\uff0c\u5c31\u77e5\u9053\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u7684\u76ee\u6807\u8bbe\u5907\u5c31\u5fc5\u7136\u662f\u81ea\u5df1\u3002</p> <p></p> <p>\u56fe 5\u20119 3DW\u914d\u7f6e\u8bf7\u6c42\u4ee5\u53caHeader\u683c\u5f0f</p>"},{"location":"pcie/all/#l-configuration-request-header","title":"l Configuration Request Header\u5404\u5b57\u6bb5\u7684\u5b9a\u4e49","text":"<p>\u56fe 5\u20119\u4e2d\u5c55\u793a\u7684Configuration Request Header\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20116\u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8eHeader\u4e2d\u7684Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 \u914d\u7f6e\u8bf7\u6c42\u59cb\u7ec8\u4e3a3DW Header\uff1a  000b=Configuration  Read\uff08\u65e0\u6570\u636e\uff09  010b=  Configuration Write\uff08\u6709\u6570\u636e\uff09 Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 0100b=  Type 0\u914d\u7f6e\u8bf7\u6c42  0 0101b=  Type 1\u914d\u7f6e\u8bf7\u6c42 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 \u914d\u7f6e\u8bf7\u6c42\u7684TC\u5fc5\u987b\u4e3a0\uff0c\u4ee5\u786e\u4fdd\u8fd9\u4e9b\u914d\u7f6e\u5305\u6c38\u8fdc\u4e0d\u4f1a\u5f71\u54cd\u5230\u9ad8\u4f18\u5148\u7ea7\u7684\u5305\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u914d\u7f6e\u8bf7\u6c42\u7684\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a0\u3002 TH  TLP\u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u914d\u7f6e\u8bf7\u6c42\u7684\u8fd9\u4e2a\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a0\u3002 TD  TLP\u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u7528\u4e8e\u6307\u793aTLP\u7684\u672b\u5c3e\u662f\u5426\u67091DW\u7684Digest\u5b57\u6bb5\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u7528\u4e8e\u6307\u793a\u6570\u636e\u8377\u8f7d\u662f\u88ab\u6c61\u67d3\u7684\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 \u914d\u7f6e\u8bf7\u6c42\u7684Relaxed Ordering\u548cNo Snoop\u5b57\u6bb5\u90fd\u4e3a0\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u914d\u7f6e\u8bf7\u6c42\u7684Address Type\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a0\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u914d\u7f6e\u8bf7\u6c42\u7684\u6570\u636e\u8377\u8f7d\u5927\u5c0f\u5b57\u6bb5\u6c38\u8fdc\u4e3a1\uff0c4bit\u5b57\u8282\u4f7f\u80fd\u7684\u6240\u6709\u7ec4\u5408\u90fd\u662f\u5141\u8bb8\u7684\u3002 Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u76f8\u5e94\u5b8c\u6210\u5305\u7684\u201c\u8fd4\u56de\u5730\u5740\u201d\u3002  Byte 4,7:0=Bus  Number  Byte 5,7:3=Device  Number  Byte 5,2:0=Function  Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u6765\u6807\u8bc6\u6765\u81eaRequester\u7684\u5177\u4f53\u6bcf\u4e2a\u8bf7\u6c42\u3002\u6bcf\u4e2a\u88ab\u53d1\u51fa\u7684\u8bf7\u6c42\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684Tag\u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u4f7f\u7528Tag[4:0]\uff08\u4e5f\u5c31\u662f\u540c\u65f6\u53ef\u4ee5\u670932\u4e2a\u672a\u5b8c\u6210\u7684\u4e8b\u52a1\u5728\u8fdb\u884c\uff09\uff0c\u5982\u679cControl Register\u4e2d\u7684Extended Tag\u4f4d\u88ab\u7f6e\u4e3a1\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06Tag\u7684\u4f7f\u7528\u6269\u5c55\u4e3aTag[7:0]\uff0c\u8fd9\u6837\u5c31\u5141\u8bb8\u6700\u591a\u4f7f\u7528256\u4e2aTag\u3002 Last  DW BE[3:0]  \u5c3eDW\u5b57\u8282\u4f7f\u80fd Byte  7 Bit 7:4 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u6700\u540e\u4e00\u4e2aDW\u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002\u7531\u4e8e\u914d\u7f6e\u8bf7\u6c42\u7684\u6570\u636e\u8377\u8f7d\u53ea\u80fd\u4e3a1DW\uff0c\u56e0\u6b64\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a0 1<sup>st</sup>  DW BE[3:0]  \u9996DW\u5b57\u8282\u4f7f\u80fd Byte  7 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u9650\u5b9a\u7b2c\u4e00\u4e2aDW\u6570\u636e\u5185\u7684\u6709\u6548\u5b57\u8282\u3002\u5bf9\u4e8e\u914d\u7f6e\u8bf7\u6c42\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u6240\u6709\u7ec4\u5408\u90fd\u662f\u5141\u8bb8\u7684\uff08\u5305\u62ec\u51680\uff09\u3002 Completer  ID[15:0]  Completer  ID Byte  8 Bit 7:0  Byte  9 Bit 7:0 \u7528\u4e8e\u6307\u793a\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u8981\u8bbf\u95ee\u7684Completer\u3002  Byte 8,7:0=Bus Number  Byte 9,7:3=Device Number  Byte 9,2:0=Function Number Ext  Register Number[3:0]  \u6269\u5c55\u5bc4\u5b58\u5668\u53f7  \uff08Extended Register Number\uff09 Byte  10 Bit 3:0 \u8fd9\u4e2a\u5b57\u6bb5\u63d0\u4f9b\u4e86\u5728\u8bbf\u95ee\u6269\u5c55\u914d\u7f6e\u7a7a\u95f4\uff08Extended Config Space\uff09\u65f6DW\u7a7a\u95f4\u7684\u9ad84bit\uff0c\u5b83\u4e0eRegister Number\u5171\u540c\u7ec4\u5408\u621010bit\u5730\u5740\uff0c\u7528\u4e8e\u8bbf\u95ee1024DW\uff08\u4e5f\u5c31\u662f4096Byte\uff09\u7684\u7a7a\u95f4\u3002\u5bf9\u4e8ePCI-Compatible\u914d\u7f6e\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a0\u3002 Register  Number[3:0]  \u5bc4\u5b58\u5668\u53f7  \uff08Register Number\uff09 Byte  11 Bit 7:0 \u7528\u4e8e\u6307\u793a\u5bc4\u5b58\u5668\u53f7\uff0c\u662f\u914d\u7f6eDW\u7a7a\u95f4\u7684\u4f4e8bit\u3002\u6700\u4f4e\u76842bit\u59cb\u7ec8\u4e3a0\uff0c\u4ee5\u5f3a\u5236\u8fdb\u884cDW\u5bf9\u9f50\u7684\u8bbf\u95ee\u3002 <p>\u8868 5\u20116 \u914d\u7f6e\u8bf7\u6c42Header\u5404\u5b57\u6bb5</p>"},{"location":"pcie/all/#l-configuration-request","title":"l Configuration Request\u6ce8\u610f\u4e8b\u9879","text":"<p>\u914d\u7f6e\u8bf7\u6c42\u7684Header\u603b\u4e3a3DW\u683c\u5f0f\uff0c\u8def\u7531\u4fe1\u606f\u4e3aBus Number\u3001Device Number\u548cFunction Number\u3002\u6240\u6709\u7684\u8bbe\u5907\u90fd\u4f1a\u5728\u63a5\u6536\u5230\u4e00\u4e2aType 0\u914d\u7f6e\u5199\u8bf7\u6c42\u65f6\u4ece\u8bf7\u6c42\u5305\u4e2d\u6355\u83b7\u51fa\u5b83\u4eec\u81ea\u5df1\u7684Bus Number\u548cDevice Number\u3002\u4e4b\u6240\u4ee5\u8fd9\u6837\uff0c\u662f\u56e0\u4e3a\u8fd9\u4e9b\u8bbe\u5907\u4e4b\u540e\u4f1a\u7528\u81ea\u5df1\u6355\u83b7\u5230\u7684Type 0\u914d\u7f6e\u5199\u4e2d\u7684Bus Number\u548cDevice Number\u6765\u4f5c\u4e3aRequester ID\uff0c\u7528\u6765\u5728\u4ee5\u540e\u53d1\u8d77\u8bf7\u6c42\u65f6\u4f7f\u7528\u3002</p>"},{"location":"pcie/all/#5254-completion","title":"5.2.5.4   \u5b8c\u6210\u5305\uff08Completion\uff09","text":"<p>Completion\uff08\u5b8c\u6210\u5305\uff09\u662f\u7528\u6765\u54cd\u5e94Non-Posted\u8bf7\u6c42\u7684\uff0c\u9664\u975e\u6709\u9519\u8bef\u963b\u6b62\u4e86\u53d1\u9001\u5b8c\u6210\u5305\u3002\u4f8b\u5982\uff0cMemory\u3001IO\u3001Configuration Read\u8bf7\u6c42\u901a\u5e38\u5c31\u662f\u7531\u5e26\u6709\u6570\u636e\u7684\u5b8c\u6210\u5305\u6765\u54cd\u5e94\u3002\u53e6\u4e00\u65b9\u9762\uff0cIO\u6216\u8005Configuration\u5199\u8bf7\u6c42\u901a\u5e38\u4e5f\u7531\u65e0\u6570\u636e\u7684\u5b8c\u6210\u5305\u6765\u54cd\u5e94\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u5b8c\u6210\u5305\u4ec5\u4ec5\u662f\u7528\u6765\u62a5\u544a\u4e8b\u52a1\u7684\u72b6\u6001\u3002</p> <p>\u5728\u5b8c\u6210\u5305\u4e2d\u7684\u8bb8\u591a\u5b57\u6bb5\u7684\u503c\uff0c\u90fd\u4e0e\u5b83\u76f8\u5173\u7684\u8bf7\u6c42\u5305\u4e2d\u7684\u5b57\u6bb5\u76f8\u540c\uff0c\u5305\u62ecTC\uff08Traffic Class\uff0c\u6d41\u91cf\u7c7b\u578b\uff09\u3001Attr\uff08Attribute\uff0c\u5c5e\u6027\uff09\u4ee5\u53caRequester ID\uff08\u8bf7\u6c42\u8005ID\uff0c\u7528\u6765\u5c06\u5b8c\u6210\u5305\u8def\u7531\u56de\u5230\u8bf7\u6c42\u8005\u53bb\uff09\u3002\u56fe 5\u201110\u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u54cd\u5e94Non-Posted\u8bf7\u6c42\u7684\u5b8c\u6210\u5305\uff0c\u5e76\u4e14\u8fd8\u5c55\u793a\u4e86\u8fd9\u4e2a\u5b8c\u6210\u5305\u76843DW Header\u3002\u5728\u6b63\u5e38\u64cd\u4f5c\u4e2d\uff0cCompleter ID\u5e76\u6ca1\u6709\u4ec0\u4e48\u989d\u5916\u7684\u7528\u5904\uff0c\u4f46\u82e5\u662f\u5728\u7cfb\u7edf\u8c03\u8bd5\u671f\u95f4\u80fd\u591f\u77e5\u9053\u5b8c\u6210\u5305\u4ece\u54ea\u91cc\u6765\uff0c\u90a3\u4e48\u8fd9\u5bf9\u9519\u8bef\u7684\u8bca\u65ad\u5c31\u6709\u8f83\u5927\u7684\u5e2e\u52a9\u3002</p> <p></p> <p>\u56fe 5\u201110 3DW\u5b8c\u6210\u5305Header\u683c\u5f0f</p>"},{"location":"pcie/all/#l-completion-header","title":"l Completion Header\u5404\u5b57\u6bb5\u7684\u5b9a\u4e49","text":"<p>\u56fe 5\u201110\u4e2d\u5c55\u793a\u7684Completion Header\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4f4d\u7f6e\u548c\u4f5c\u7528\u90fd\u5728\u8868 5\u20117\u4e2d\u8fdb\u884c\u4e86\u63cf\u8ff0\u3002</p> \u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8eHeader\u4e2d\u7684Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 \u5b8c\u6210\u5305\u59cb\u7ec8\u4e3a3DW Header\uff1a  000b=Cpl\uff0c\u65e0\u6570\u636e  010b=CplD\uff0c\u6709\u6570\u636e Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 0 1010b=\u5b8c\u6210\u5305 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 \u5b8c\u6210\u5305\u7684\u8be5\u5b57\u6bb5\u5fc5\u987b\u4e0e\u76f8\u5e94\u7684\u8bf7\u6c42\u5305\u76f8\u540c\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u8868\u793a\u8fd9\u4e2aTLP\u662f\u5426\u4f7f\u7528\u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\uff08IDO\uff09\u201d\u4e00\u8282\u3002 TH  TLP\u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 \u5b8c\u6210\u5305\u4e2d\uff0c\u6b64\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5 TD  TLP\u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u7528\u4e8e\u6307\u793aTLP\u7684\u672b\u5c3e\u662f\u5426\u67091DW\u7684Digest\u5b57\u6bb5\uff0c\u5982\u679c\u4e3a1\u5219\u8bf4\u660e\u5b58\u5728\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u5982\u679c\u4e3a1\uff0c\u5219\u8868\u793a\u6570\u636e\u8377\u8f7d\u662f\u88ab\u6c61\u67d3\u7684\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 \u5b8c\u6210\u5305\u7684\u8be5\u5b57\u6bb5\u5fc5\u987b\u4e0e\u76f8\u5e94\u7684\u8bf7\u6c42\u5305\u76f8\u540c\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 \u5b8c\u6210\u5305\u7684Address Type\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a0\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u7528\u4e8e\u8868\u793a\u5b8c\u6210\u5305\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aDW\u3002 Completer  ID[15:0]  Completer  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793aCompleter\u662f\u8c01\uff0c\u7528\u4e8e\u652f\u6301\u8c03\u8bd5\u3002  Byte 4,7:0=Compl  Bus Number  Byte 5,7:3=Compl  Device Number  Byte 5,2:0=Compl  Function Number Compl.  Status[2:0]  \u5b8c\u6210\u5305\u72b6\u6001  \uff08Completion Status Code\uff09 Byte  6 Bit 7:5 \u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u8868\u793a\u5b8c\u6210\u5305\u7684\u72b6\u6001\u3002  000b=Successful  Completion\uff08SC\uff09\u6210\u529f\u5b8c\u6210  001b=Unsupported  Request\uff08UR\uff09\u4e0d\u652f\u6301\u7684\u8bf7\u6c42  010b=Config  Req Retry Status\uff08CRS\uff09\u914d\u7f6e\u8bf7\u6c42\u91cd\u8bd5\u72b6\u6001  100b=Completer  Abort\uff08CA\uff09\u5b8c\u6210\u8005\u7ec8\u6b62  \u9664\u4e86\u4e0a\u8ff0bit\u7ec4\u5408\u4e4b\u5916\u7684\u90fd\u662f\u4fdd\u7559\u7801\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cSummary of Completion Status Codes\u201d\u4e00\u8282\u3002 BCM  \u5b57\u8282\u6570\u5df2\u4fee\u6539  \uff08Byte Count Modified\uff09 Byte  6 Bit 4 \u8fd9\u4e2a\u5b57\u6bb5\u4ec5\u7531PCI-X\u5b8c\u6210\u5305\u4f7f\u7528\uff0c\u7528\u6765\u8868\u793aByte Count\u5b57\u6bb5\u4ec5\u62a5\u544a\u7b2c\u4e00\u4e2a\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\uff0c\u800c\u4e0d\u662f\u603b\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cUsing The Byte Count Modified Bit\u201d\u4e00\u8282\u3002 Byte  Count[11:0]  \u5b57\u8282\u6570 Byte  6 Bit 3:0  Byte  7 Bit 7:0 Byte Count\u5b57\u6bb5\u662f\u7528\u6765\u670d\u52a1\u8bfb\u8bf7\u6c42\u7684\uff0c\u5b83\u4e5f\u662f\u6765\u6e90\u4e8e\u539f\u59cb\u8bf7\u6c42\u4e2d\u7684Length\u5b57\u6bb5\u3002\u4e00\u4e9b\u7279\u522b\u60c5\u51b5\u4e0b\uff0c\u4f1a\u51fa\u73b0\u4f7f\u7528\u591a\u5b8c\u6210\u5305\u8fd4\u56de\u6570\u636e\u8377\u8f7d\uff0c\u8bf7\u53c2\u9605\u201cData  Returned For Read Request\u201d\u4e00\u8282 Requester  ID[15:0]  Requester  ID Byte  8 Bit 7:0  Byte  9 Bit 7:0 \u8be5\u5b57\u6bb5\u662f\u4ece\u539f\u59cb\u8bf7\u6c42\u4e2d\u590d\u5236\u6765\u7684\uff0c\u7528\u4e8e\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u6765\u5e2e\u52a9\u5b8c\u6210\u5305\u8fd4\u56deRequester\u3002  Byte 4,7:0=Req  Bus Number  Byte 5,7:3=Req  Device Number  Byte 5,2:0=Req  Function Number Tag[7:0]  Tag Byte  10 Bit 7:0 \u5b8c\u6210\u5305\u4e2d\u7684Tag\u5fc5\u987b\u4e0e\u76f8\u5e94\u8bf7\u6c42\u4e2d\u7684Tag\u4e00\u6837\u3002Requester\u6536\u5230\u8fd9\u4e2a\u5b8c\u6210\u5305\u65f6\u662f\u901a\u8fc7Tag\u6765\u5c06\u5b8c\u6210\u5305\u4e0e\u539f\u59cb\u8bf7\u6c42\u5173\u8054\u8d77\u6765\u7684\u3002 Lower  Address[6:0]  \u4f4e\u4f4d\u5730\u5740 Byte  11 Bit 6:0 \u8fd9\u4e2a\u5b57\u6bb5\u662f\u4e00\u4e2a\u8bfb\u8bf7\u6c42\u6240\u8fd4\u56de\u7684\u7b2c\u4e00\u7ec4\u6570\u636e\u7684\u4f4e7bit\u5730\u5740\u3002\u5b83\u662f\u7531\u8bf7\u6c42Length\u548cByte Enable\u5171\u540c\u8ba1\u7b97\u51fa\u6765\u7684\uff0c\u5b83\u53ef\u4ee5\u5c55\u793a\u51fa\u5728\u5230\u8fbe\u4e0b\u4e00\u4e2a\u8bfb\u5b8c\u6210\u5305\u8fb9\u754c\u4e4b\u524d\u8fd8\u80fd\u4f20\u8f93\u591a\u5c11\u5b57\u8282\u6570\u636e\uff0c\u4ee5\u6b64\u6765\u534f\u52a9Buffer\u7ba1\u7406\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cCalculation Lower Address Field\u201d\u4e00\u8282\u3002 <p>\u8868 5\u20117\u5b8c\u6210\u5305Header\u683c\u5f0f</p>"},{"location":"pcie/all/#l-summary-of-completion-status-codes","title":"l \u5b8c\u6210\u5305\u72b6\u6001\u7801\u603b\u7ed3\uff08Summary of Completion Status Codes\uff09","text":"<p>o 000b\uff08SC\uff09Successful Completion\u6210\u529f\u5b8c\u6210\uff1a\u8bf7\u6c42\u88ab\u6b63\u786e\u670d\u52a1\u3002</p> <p>o 001b\uff08UR\uff09Unsupported Request\u4e0d\u652f\u6301\u7684\u8bf7\u6c42\uff1a\u5bf9\u4e8eCompleter\u6765\u8bf4\uff0c\u6b64\u8bf7\u6c42\u662f\u975e\u6cd5\u7684\u6216\u8005\u662f\u65e0\u6cd5\u88ab\u8bc6\u522b\u7684\u3002\u8fd9\u662f\u4e00\u79cd\u51fa\u9519\u7684\u60c5\u51b5\uff0c\u81f3\u4e8eCompleter\u5982\u4f55\u8fdb\u884c\u54cd\u5e94\u5219\u8981\u6839\u636eCompleter\u5bf9\u5e94\u7684PCIe\u534f\u8bae\u7248\u672c\u6765\u3002\u5728PCIe 1.1\u4e4b\u524d\uff0c\u8fd9\u79cd\u60c5\u51b5\u88ab\u89c6\u4e3a\u4e00\u79cd\u4e0d\u53ef\u7ea0\u6b63\u7684\u9519\u8bef\uff0c\u4f46\u662f\u57281.1\u548c\u4e4b\u540e\u7684\u7248\u672c\u4e2d\uff0c\u5b83\u88ab\u4f5c\u4e3a\u4e00\u79cdAdvisory Non-Fatal Error\uff08\u62a5\u544a\u7684\u975e\u81f4\u547d\u9519\u8bef\uff09\u3002\u66f4\u591a\u8be6\u7ec6\u5185\u5bb9\u8bf7\u53c2\u9605\u201cUnsupported Request\uff08UR\uff09 Status\u201d\u4e00\u8282\u3002</p> <p>o 010b\uff08CRS\uff09Configuration Request Retry Status\u914d\u7f6e\u8bf7\u6c42\u91cd\u8bd5\u72b6\u6001\uff1aCompleter\u4e34\u65f6\u7684\u65e0\u6cd5\u670d\u52a1\u4e00\u4e2a\u914d\u7f6e\u8bf7\u6c42\uff0c\u56e0\u6b64\u8fd9\u4e2a\u8bf7\u6c42\u5e94\u8be5\u7a0d\u540e\u518d\u6b21\u5c1d\u8bd5\u3002</p> <p>o 100b\uff08CA\uff09Completer Abort\u5b8c\u6210\u8005\u7ec8\u6b62\uff1aCompleter\u5e94\u8be5\u5df2\u7ecf\u5bf9\u8bf7\u6c42\u4e8b\u52a1\u8fdb\u884c\u4e86\u670d\u52a1\uff0c\u4f46\u662f\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u5bfc\u81f4\u4e86\u670d\u52a1\u5931\u8d25\u3002\u8fd9\u662f\u4e00\u79cd\u4e0d\u53ef\u7ea0\u6b63\u7684\u9519\u8bef\u3002</p>"},{"location":"pcie/all/#l-calculating-the-lower-address-field","title":"l \u8ba1\u7b97\u4f4e\u4f4d\u5730\u5740\u5b57\u6bb5\uff08Calculating the Lower Address Field\uff09","text":"<p>Completer\u8bbe\u7f6e\u8fd9\u4e2a\u5b57\u6bb5\u662f\u7528\u6765\u53cd\u6620\u8fd4\u56de\u7ed9Requester\u7684\u6570\u636e\u8377\u8f7d\u4e2d\uff0c\u7b2c\u4e00\u4e2aenabled\u7684\u5b57\u8282\u7684\u5b57\u8282\u5bf9\u9f50\u5730\u5740\uff08byte-aligned address\uff09\u3002\u786c\u4ef6\u4f1a\u901a\u8fc7\u539f\u59cb\u8bf7\u6c42\u4e2d\u7684DW\u8d77\u59cb\u5730\u5740\u4ee5\u53ca\u9996DW\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\uff081<sup>st</sup> DW Byte Enable\uff09\u4e2d\u7684\u5b57\u8282\u4f7f\u80fd\u60c5\u51b5\uff0c\u6765\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u5730\u5740\u7684\u503c\u3002</p> <p>\u5bf9\u4e8eMRd\uff08Memory Read\uff09\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u5730\u5740\u5c31\u662f\u4eceDW\u8d77\u59cb\u5730\u5740\u5f00\u59cb\u7684\u504f\u79fb\u91cf\uff1a</p> <p>o \u5982\u679c\u9996DW\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a1111b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2aDW\u4e2d\u7684\u6240\u6709\u5b57\u8282\u90fd\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f0\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u4e0eDW\u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740\u76f8\u540c\u3002</p> <p>o \u5982\u679c\u9996DW\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a1110b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2aDW\u4e2d\u7684\u9ad83\u4e2a\u5b57\u8282\u90fd\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f1\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u7b49\u4e8eDW\u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740+1\u3002</p> <p>o \u5982\u679c\u9996DW\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a1100b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2aDW\u4e2d\u7684\u9ad82\u4e2a\u5b57\u8282\u90fd\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f2\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u7b49\u4e8eDW\u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740+2\u3002</p> <p>o \u5982\u679c\u9996DW\u5b57\u8282\u4f7f\u80fd\u5b57\u6bb5\u4e3a1000b\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2aDW\u4e2d\u7684\u4ec5\u6709\u6700\u9ad8\u5b57\u8282\u662f\u6709\u6548\u7684\uff0c\u90a3\u4e48\u504f\u79fb\u91cf\u5c31\u662f3\u3002\u6b64\u65f6\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u7b49\u4e8eDW\u5bf9\u9f50\u7684\u8d77\u59cb\u5730\u5740+3\u3002</p> <p>\u4e00\u65e6\u4e0a\u8ff0\u7684\u8ba1\u7b97\u5b8c\u6210\uff0c\u8ba1\u7b97\u7ed3\u679c\u7684\u4f4e7bit\u5c31\u4f1a\u88ab\u653e\u5165\u5b8c\u6210\u5305Header\u7684Lower Address\u5b57\u6bb5\uff0c\u5f53\u8bfb\u5b8c\u6210\u5305\u5c0f\u4e8e\u6574\u4e2a\u6570\u636e\u8377\u8f7d\u56e0\u800c\u9700\u8981\u505c\u6b62\u5728\u7b2c\u4e00\u4e2aRCB\uff08Read Completion Boundary\uff09\u65f6\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u53ef\u4ee5\u6709\u52a9\u4e8e\u66f4\u597d\u7684\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u3002\u82e5\u60f3\u5c06\u4e00\u4e2a\u4e8b\u52a1\u62c6\u5206\u6210\u591a\u4e2a\u90e8\u5206\uff0c\u5219\u5fc5\u987b\u8981\u5728RCB\u4e0a\u8fdb\u884c\u62c6\u5206\uff0c\u800c\u5230\u8fbe\u7b2c\u4e00\u4e2aRCB\u65f6\u6240\u4f20\u8f93\u7684\u5b57\u8282\u6570\u91cf\u662f\u6839\u636e\u8d77\u59cb\u5730\u5740\u800c\u5b9a\u7684\u3002</p> <p>\u5bf9\u4e8eAtomicOp\uff08\u539f\u5b50\u64cd\u4f5c\uff09\u5b8c\u6210\u5305\uff0cLower Address\u5b57\u6bb5\u662f\u4fdd\u7559\u4f4d\u3002\u5bf9\u4e8e\u6240\u6709\u5176\u4ed6\u5b8c\u6210\u5305\u7c7b\u578b\uff08\u975e\u8bfb\u8bf7\u6c42\u3001\u975e\u539f\u5b50\u64cd\u4f5c\uff09\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u4e3a0\u3002</p>"},{"location":"pcie/all/#l-using-the-byte-count-modified-bit","title":"l \u4f7f\u7528\u5b57\u8282\u6570\u4fee\u6539\u4f4d\uff08Using The Byte Count Modified Bit\uff09","text":"<p>\u8fd9\u4e2abit\u4ec5\u7531PCI-X Completer\u8fdb\u884c\u8bbe\u7f6e\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u7528\u4e86PCIe\u5230PCI-X\u7684Bridge\uff0c\u90a3\u4e48\u8fd9\u4e9bPCI-X Completer\u4eec\u5c31\u4e5f\u53ef\u4ee5\u51fa\u73b0\u5728PCIe\u62d3\u6251\u7ed3\u6784\u4e2d\u3002\u4f7f\u7528\u8fd9\u4e2abit\u7684\u89c4\u5219\u5305\u62ec\uff1a</p> <p>\\1.    \u5f53\u4e00\u4e2a\u8bfb\u8bf7\u6c42\u8981\u62c6\u5206\u6210\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\u65f6\uff0cByte Count Modified\u8fd9\u4e00\u4f4d\u53ea\u80fd\u7531PCI-X Completer\u8fdb\u884c\u7f6e\u4f4d\u3002</p> <p>\\2.    \u4ec5\u6709\u4e00\u7cfb\u5217\u5b8c\u6210\u5305\u4e2d\u7684\u7b2c\u4e00\u4e2a\u53ef\u4ee5\u5c06\u8fd9\u4e2abit\u7f6e\u4e3a1\uff0c\u8fd9\u8868\u793a\u7b2c\u4e00\u4e2a\u5b8c\u6210\u5305\u5185\u5305\u542b\u7684Byte Count\u5b57\u6bb5\u53ea\u53cd\u6620\u8fd9\u4e2a\u5b8c\u6210\u5305\uff08\u7b2c\u4e00\u4e2a\u5b8c\u6210\u5305\uff09\u7684\u6570\u636e\u8377\u8f7d\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u4e8b\u52a1\u7684\u6570\u636e\u8377\u8f7d\uff08\u901a\u5e38\u60c5\u51b5\u4e0b\u662f\u8868\u793a\u6574\u4e2a\u4e8b\u52a1\u7684\u603b\u6570\u636e\u8377\u8f7d\uff09\u3002\u8fd9\u6837Requester\u5c31\u77e5\u9053\uff0c\u5373\u4f7fByte Count\u770b\u8d77\u6765\u4f3c\u4e4e\u8868\u793a\u8fd9\u662f\u8fd9\u4e2a\u8bf7\u6c42\u7684\u6700\u540e\u4e00\u4e2a\u5b8c\u6210\u5305\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u5b8c\u6210\u5305\u4e4b\u540e\u8fd8\u4f1a\u6709\u5b8c\u6210\u5305\uff0c\u4ee5\u6b64\u6765\u6ee1\u8db3\u539f\u59cb\u8bf7\u6c42\u5bf9\u6570\u636e\u91cf\u7684\u9700\u6c42\u3002</p> <p>\\3.    \u5bf9\u4e8e\u968f\u540e\u7684\u4e00\u7cfb\u5217\u5b8c\u6210\u5305\u6765\u8bf4\uff0cBCM\u4f4d\u5fc5\u987b\u7f6e\u4e3a0\uff0c\u4e14Byte Count\u5b57\u6bb5\u8981\u7528\u6765\u53cd\u6620\u5269\u4e0b\u7684\u6240\u6709\u6570\u636e\u8377\u8f7d\u989d\u5b57\u8282\u6570\uff0c\u5c31\u50cf\u5b83\u901a\u5e38\u7684\u542b\u4e49\u4e00\u6837\u3002</p> <p>\\4.    \u5f53\u8bbe\u5907\u63a5\u6536\u5230BCM\u4f4d\u4e3a1\u7684\u5b8c\u6210\u5305\u65f6\uff0c\u5b83\u5fc5\u987b\u8981\u6b63\u786e\u7684\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u3002</p> <p>\\5.    Completer\u8981\u5728\u5e26\u6709\u6570\u636e\u8377\u8f7d\u7684\u5b8c\u6210\u5305\u4e2d\u8bbe\u7f6eLower Address\u5b57\u6bb5\uff0c\u4ee5\u6b64\u6765\u53cd\u6620\u8fd4\u56de\u7684\u7b2c\u4e00\u4e2a\u6709\u6548\u5b57\u8282\u7684\u5730\u5740\u3002</p>"},{"location":"pcie/all/#l-data-returned-for-read-requests","title":"l \u8bfb\u8bf7\u6c42\u6570\u636e\u8fd4\u56de\uff08Data Returned For Read Requests\uff09:","text":"<p>\\1.    \u4e00\u4e2a\u8bfb\u8bf7\u6c42\u53ef\u80fd\u9700\u8981\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\uff0c\u4f46\u662f\u6700\u7ec8\u4f20\u8f93\u7684\u6570\u636e\u603b\u91cf\u5fc5\u987b\u7b49\u4e8e\u539f\u59cb\u8bf7\u6c42\u4e2d\u8981\u6c42\u7684\u5927\u5c0f\uff0c\u5426\u5219\u53ef\u80fd\u5bfc\u81f4\u5b8c\u6210\u5305\u8d85\u65f6\u9519\u8bef\uff08Completion Timeout error\uff09\u3002</p> <p>\\2.    \u4e00\u4e2a\u5b8c\u6210\u5305\u53ea\u80fd\u7528\u4e8e\u670d\u52a1\u4e00\u4e2a\u8bf7\u6c42\u3002</p> <p>\\3.    IO\u548cConfiguration\u8bfb\u8bf7\u6c42\u6240\u8bf7\u6c42\u7684\u6570\u636e\u91cf\u6c38\u8fdc\u662f1DW\uff0c\u5e76\u4e14\u53ea\u80fd\u7531\u4e00\u4e2a\u5355\u72ec\u7684\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\u3002</p> <p>\\4.    \u72b6\u6001\u7801\u4e0d\u662fSC\uff08Successful Completion\uff09\u7684\u5b8c\u6210\u5305\u5c06\u4f1a\u7ec8\u6b62\u5f53\u524d\u4e8b\u52a1\u3002</p> <p>\\5.    \u5728\u4f7f\u7528\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u54cd\u5e94\u8bfb\u8bf7\u6c42\u65f6\uff0c\u5fc5\u987b\u6ce8\u610f\u8bfb\u5b8c\u6210\u5305\u8fb9\u754c\uff08RCB\uff0cRead Completion Boundary\uff09\u3002\u5bf9\u4e8eRC\u6765\u8bf4\uff0cRCB\u4f1a\u662f64Bytes\u6216\u8005128Bytes\uff0c\u8fd9\u662f\u56e0\u4e3aRC\u53ef\u4ee5\u66f4\u6539\u5728\u5176\u7aef\u53e3\u95f4\u79fb\u52a8\u7684\u6570\u636e\u5305\u7684\u5927\u5c0f\uff0c\u5177\u4f53\u7684RCB\u7684\u503c\u53ef\u4ee5\u5728\u914d\u7f6e\u5bc4\u5b58\u5668\u4e2d\u770b\u5230\u3002</p> <p>\\6.    Bridge\u548cEP\u53ef\u4ee5\u7528\u4e00\u4e2abit\u6765\u5b9e\u73b0\u8f6f\u4ef6\u5bf9RCB\u5927\u5c0f\u7684\u9009\u62e9\uff0c64bytes\u6216\u8005128bytes\u3002</p> <p>\\7.    \u5b8c\u5168\u5728\u4e00\u4e2a\u5bf9\u9f50RCB\u8fb9\u754c\u5185\u7684\u5b8c\u6210\u5305\u4eec\u5fc5\u987b\u4e00\u6b21\u5b8c\u6210\u4f20\u8f93\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u4e9bRCB\u8fb9\u754c\u5185\u7684\u5b8c\u6210\u5305\u7684\u4f20\u8f93\u662f\u4e0d\u4f1a\u5230\u8fbeRCB\u7684\uff0c\u800cRCB\u624d\u662f\u5141\u8bb8\u63d0\u524d\u505c\u6b62\u4f20\u8f93\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5c31\u5fc5\u987b\u5bf9\u4e00\u4e2aRCB\u8fb9\u754c\u5185\u7684\u6240\u6709\u5b8c\u6210\u5305\u4e00\u6b21\u5b8c\u6210\u4f20\u8f93\u800c\u4e0d\u80fd\u4e2d\u9014\u505c\u6b62\u3002</p> <p>\\8.    \u5bf9\u4e8e\u4e00\u4e2a\u5355\u72ec\u7684\u8bfb\u8bf7\u6c42\u6765\u8bf4\uff0c\u82e5\u4f7f\u7528\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u8fd4\u56de\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u4e9b\u6570\u636e\u5fc5\u987b\u4ee5\u5730\u5740\u9012\u589e\u7684\u987a\u5e8f\u6765\u8fd4\u56de\u3002</p>"},{"location":"pcie/all/#l-receiver-completion-handling-rules","title":"l \u63a5\u6536\u8005\u5bf9\u5b8c\u6210\u5305\u7684\u5904\u7406\u89c4\u5219\uff08Receiver Completion Handling Rules\uff09:","text":"<p>\\1.    \u5982\u679c\u4e00\u4e2a\u5df2\u7ecf\u88ab\u63a5\u6536\u7684\u5b8c\u6210\u5305\u5e76\u6ca1\u6709\u5339\u914d\u4e0a\u4efb\u4f55\u4e00\u4e2a\u5f85\u5b8c\u6210\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u5b83\u5c31\u662f\u4e00\u4e2aUnexpected Completion\uff08\u610f\u5916\u5b8c\u6210\u5305\uff09\uff0c\u5c06\u88ab\u5f53\u505a\u662f\u4e00\u79cd\u9519\u8bef\u6765\u5904\u7406\u3002</p> <p>\\2.    \u5982\u679c\u5b8c\u6210\u5305\u72b6\u6001\u4e0d\u662fSC\u6216\u8005CRS\uff0c\u90a3\u4e48\u5c31\u5c06\u88ab\u5f53\u505a\u662f\u9519\u8bef\u6765\u5904\u7406\uff0c\u5e76\u4e14\u4f1a\u6e05\u7a7a\u4e0e\u4e4b\u76f8\u5173\u8054\u7684Buffer\u7a7a\u95f4\u3002</p> <p>\\3.    \u5f53RC\u5728\u8fdb\u884c\u914d\u7f6e\u4e8b\u52a1\u65f6\u63a5\u6536\u5230\u4e00\u4e2aCRS\u72b6\u6001\u7684\u5b8c\u6210\u5305\uff0c\u90a3\u4e48\u8fd9\u4e2a\u914d\u7f6e\u8bf7\u6c42\u5c31\u88ab\u7ec8\u6b62\u4e86\u3002\u968f\u540e\u8981\u8fdb\u884c\u7684\u4e8b\u60c5\u662f\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u4e0d\u540c\u7684\uff0c\u4f46\u662f\u5982\u679cRC\u652f\u6301\u8fd9\u79cdCRS\u72b6\u6001\u7684\u5b8c\u6210\u5305\u5904\u7406\uff0c\u90a3\u4e48\u5177\u4f53\u7684\u64cd\u4f5c\u5c06\u7531RC\u63a7\u5236\u5bc4\u5b58\u5668\u4e2d\u7684CRS Software Visibility\u4f4d\u6765\u8fdb\u884c\u5b9a\u4e49\u8bbe\u7f6e\u3002</p> <p>\u2014  \u5982\u679cCRS Software Visibility\u6ca1\u6709\u542f\u7528\uff0c\u90a3\u4e48RC\u5c06\u4f1a\u91cd\u65b0\u53d1\u51fa\u914d\u7f6e\u8bf7\u6c42\uff0c\u76f4\u5230\u91cd\u590d\u4e86\u4e00\u5b9a\u7684\u6b21\u6570\uff08\u5177\u4f53\u5b9e\u73b0\u4e2d\u6307\u5b9a\uff09\u4e4b\u540e\u5c31\u4f1a\u653e\u5f03\u91cd\u53d1\u7684\u64cd\u4f5c\uff0c\u5e76\u8ba4\u4e3a\u8bf7\u6c42\u76ee\u6807\u5b58\u5728\u95ee\u9898\u3002</p> <p>\u2014  \u5982\u679cCRS Software Visibility\u662f\u542f\u7528\u7684\uff0c\u90a3\u4e48\u7528\u6765\u652f\u6301\u5b83\u7684\u8f6f\u4ef6\u90fd\u4f1a\u9996\u5148\u8bfb\u53d6Vendor ID\u5b57\u6bb5\u7684\u4e24\u4e2a\u5b57\u8282\uff0c\u5982\u679c\u786c\u4ef6\u63a5\u6536\u5230\u4e86\u8fd9\u4e2a\u8bfb\u8bf7\u6c42\u7684CRS\u5b8c\u6210\u5305\uff0c\u5b83\u5c06\u7ed9\u8fd4\u56de\u7684Vendor ID\u5c06\u4f1a\u662f0001h\u3002\u8fd9\u4e2a\u503c\u662fPCI-SIG\u89c4\u5b9a\u7684\u4fdd\u7559\u503c\uff0c\u5b83\u5e76\u4e0d\u5bf9\u5e94\u4efb\u4f55\u6709\u6548\u7684Vendor\uff0c\u5e76\u4f1a\u901a\u77e5\u8f6f\u4ef6\u53d1\u751f\u4e86\u8fd9\u6837\u7684\u4e8b\u4ef6\u3002\u8fd9\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u5728\u7b49\u5f85\u76ee\u6807Function\u51c6\u5907\u5c31\u7eea\u7684\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff08\u901a\u5e38\u5728\u590d\u4f4d\u540e\u9700\u89811s\u65f6\u95f4\uff09\uff0c\u53bb\u6267\u884c\u5176\u4ed6\u7684\u4efb\u52a1\uff0c\u800c\u4e0d\u662f\u505c\u6ede\u4e0d\u524d\u3002\u4efb\u4f55\u5176\u4ed6\u7684\u914d\u7f6e\u8bfb\u6216\u8005\u5199\uff08\u9664\u4e86\u6700\u5f00\u59cb\u7684\u914d\u7f6e\u8bfbVendor ID\uff09\u90fd\u4f1a\u88abRC\u81ea\u52a8\u91cd\u8bd5\u91cd\u53d1\uff0c\u76f4\u5230\u8fbe\u5230\u8bbe\u8ba1\u7684\u91cd\u590d\u6b21\u6570\u3002</p> <p>\\4.    \u5982\u679c\u4e00\u4e2a\u8bf7\u6c42\u5e76\u4e0d\u662f\u914d\u7f6e\u8bf7\u6c42\uff0c\u4f46\u662f\u5b83\u7684\u5b8c\u6210\u5305\u51fa\u73b0\u4e86CRS\u72b6\u6001\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b8c\u6210\u5305\u5c06\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\5.    \u5f53\u5b8c\u6210\u5305\u72b6\u6001\u7801\u4e3a\u4fdd\u7559\u7ec4\u5408\u65f6\uff0c\u5e76\u4e0d\u662f\u5b9a\u4e49\u51fa\u7684\u90a3\u51e0\u79cd\uff0c\u5c31\u628a\u5b83\u5f53\u505aUR\uff08Unsupported Request\uff09\u4e00\u6837\u5904\u7406\u3002</p> <p>\\6.    \u5982\u679c\u63a5\u6536\u5230\u7684\u4e00\u4e2a\u8bfb\u5b8c\u6210\u5305\u6216\u8005\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u5b8c\u6210\u5305\u7684\u72b6\u6001\u7801\u4e0d\u662fSC\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b8c\u6210\u5305\u5c31\u4e0d\u4f1a\u643a\u5e26\u6570\u636e\uff0c\u5e76\u4e14Requester\u5fc5\u987b\u8981\u8003\u8651\u7ec8\u6b62\u8fd9\u4e2a\u5b8c\u6210\u5305\u5bf9\u5e94\u7684\u8bf7\u6c42\u3002\u81f3\u4e8eRequester\u5177\u4f53\u5982\u4f55\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u5219\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u5b9a\u3002</p> <p>\\7.    \u5728\u4f7f\u7528\u591a\u4e2a\u5b8c\u6210\u5305\u6765\u54cd\u5e94\u4e00\u4e2a\u8bfb\u8bf7\u6c42\u7684\u60c5\u51b5\u4e0b\uff0c\u4efb\u4f55\u4e00\u4e2a\u5b8c\u6210\u5305\u7684\u72b6\u6001\u53ea\u8981\u4e0d\u662fSC\uff0c\u90a3\u4e48\u5c31\u4f1a\u7ec8\u6b62\u8fd9\u4e2a\u4e8b\u52a1\u3002\u8bbe\u5907\u5982\u4f55\u5904\u7406\u51fa\u9519\u4e4b\u524d\u63a5\u6536\u5230\u7684\u6570\u636e\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u5b9a\u3002</p> <p>\\8.    \u4e3a\u4e86\u4fdd\u6301\u5bf9PCI\u7684\u517c\u5bb9\u6027\uff0cRC\u9700\u8981\u5728\u4e00\u4e2a\u914d\u7f6e\u4e8b\u52a1\u88abUR\u7ed3\u675f\u65f6\uff0c\u5408\u6210\u4e00\u4e2a\u51681\u7684\u8bfb\u53d6\u503c\u3002\u8fd9\u5c31\u7c7b\u540c\u4e8e\u679a\u4e3e\u8f6f\u4ef6\u5c1d\u8bd5\u4ece\u4e0d\u5b58\u5728\u7684\u8bbe\u5907\u4e2d\u8bfb\u53d6\u6570\u636e\u65f6\u7684\u51fa\u73b0\u7684PCI Master Abort\u4e00\u6837\u3002</p>"},{"location":"pcie/all/#5255-message-requests","title":"5.2.5.5   \u6d88\u606f\u8bf7\u6c42\uff08Message Requests\uff09","text":"<p>Message\u8bf7\u6c42\u53d6\u4ee3\u4e86PCI/PCI-X\u4e2d\u4f7f\u7528\u7684\u8bb8\u591a\u4e2d\u65ad\uff08interrupt\uff09\u3001\u9519\u8bef\uff08error\uff09\u548c\u7535\u6e90\u7ba1\u7406\uff08power management\uff09\u7684\u8fb9\u5e26\u4fe1\u53f7\u3002\u6240\u6709\u7684Message\u8bf7\u6c42\u4f7f\u7528\u7684\u90fd\u662f4DW Header\u683c\u5f0f\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u6bcf\u79cdMessage\u90fd\u4f7f\u7528\u4e86Header\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u3002\u5bf9\u4e8eHeader\u4e2d\u7684Byte8-15\u6765\u8bf4\uff0c\u5728\u4e00\u4e9b\u79cd\u7c7b\u7684Message\u4e2d\u5c31\u6ca1\u6709\u5176\u5b9a\u4e49\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5b83\u5c31\u662f\u4fdd\u7559\u5b57\u6bb5\u3002Message\u7684\u5904\u7406\u65b9\u5f0f\u66f4\u50cf\u662fPosted\u7684MWr\u4e8b\u52a1\uff0c\u4f46\u662fMessage\u7684\u8def\u7531\u65b9\u5f0f\u53ef\u4ee5\u662f\u57fa\u4e8e\u5730\u5740\u7684\u3001\u57fa\u4e8eID\u7684\uff0c\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5\u662f\u9690\u5f0f\u8def\u7531\u3002TLP Header\u4e2d\u7684\u8def\u7531\u5b50\u57df\uff08routing subfield\uff09\uff0c\u4e5f\u5c31\u662fByte 0 bit 2:0\uff0c\u5b83\u7528\u6765\u8868\u793a\u4f7f\u7528\u7684\u662f\u54ea\u79cd\u8def\u7531\u65b9\u6cd5\uff0c\u5e76\u4e14\u76f8\u5e94\u7684\u5728Header\u4e2d\u5b9a\u4e49\u4e86\u54ea\u4e9b\u9644\u52a0\u7684\u5b57\u6bb5\uff0c\u4f8b\u5982\u4f7f\u7528\u57fa\u4e8eID\u8def\u7531\u7684Header\u4e2d\u5c31\u4f1a\u6709\u7528\u4e8e\u8def\u7531\u7684BDF\u3002\u901a\u7528\u7684Message\u8bf7\u6c42Header\u683c\u5f0f\u5982\u56fe 5\u201111\u6240\u793a\u3002</p> <p></p> <p>\u56fe 5\u201111 4DW\u7684Message\u8bf7\u6c42Header\u683c\u5f0f</p>"},{"location":"pcie/all/#l-messageheadermessage-request-header-fields","title":"l Message\u8bf7\u6c42Header\u5404\u5b57\u6bb5\uff08Message Request Header Fields\uff09","text":"\u5b57\u6bb5\u540d\u79f0 \u4f4d\u4e8eHeader\u4e2d\u7684Byte/Bit \u529f\u80fd Fmt[2:0]  \u683c\u5f0f  \uff08Format\uff09 Byte  0 Bit 7:5 Message\u59cb\u7ec8\u4e3a4DW Header\uff1a  001b=4DW\uff0c\u65e0\u6570\u636e  011b=4DW\uff0c\u6709\u6570\u636e Type[4:0]  \u7c7b\u578b Byte  0 Bit 4:0 TLP\u5305\u7684Type\u5b57\u6bb5\u3002  o Bit 4:3\uff1a  10b=Msg  o Bit 2:0\uff1a\uff08Message\u8def\u7531\u5b50\u57df\uff09  000b=\u5230RC\u7684\u9690\u5f0f\u8def\u7531\u3002  001b=\u4f7f\u7528\u5730\u5740\u8def\u7531  010b=\u4f7f\u7528ID\u8def\u7531  011b=\u6765\u81eaRC\u7684\u9690\u5f0f\u8def\u7531\u5e7f\u64ad  100b=\u672c\u5730\uff1b\u7ec8\u7ed3\u4e8e\u9996\u7ea7\u63a5\u6536\u8005  101b=\u6536\u96c6\u5e76\u8def\u7531\u81f3RC  \u5176\u4ed6\u503c=\u4fdd\u7559\u503c\uff0c\u4f5c\u4e3a\u672c\u5730\u5904\u7406 TC[2:0]  \u6d41\u91cf\u7c7b\u578b  \uff08Traffic Class\uff09 Byte  1 Bit 6:4 Message\u7684TC\u59cb\u7ec8\u4e3a0\uff0c\u4ee5\u786e\u4fdd\u5b83\u4eec\u4e0d\u4f1a\u5f71\u54cd\u5230\u9ad8\u4f18\u5148\u7ea7\u7684\u6570\u636e\u5305\u3002 Attr[2]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  1 Bit 2 \u8868\u793a\u8fd9\u4e2aTLP\u662f\u5426\u4f7f\u7528\u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID-based Ordering\uff09\u3002\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605\u201cID Based Ordering\uff08IDO\uff09\u201d\u4e00\u8282\u3002 TH  TLP\u5904\u7406\u63d0\u793a  \uff08TLP Processing Hints\uff09 Byte  1 Bit 0 Message\u4e2d\uff0c\u9664\u975e\u53e6\u6709\u6ce8\u660e\uff0c\u7aa6\u6cfd\u6b64\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 TD  TLP\u6458\u8981  \uff08TLP Digest\uff09 Byte  2 Bit 7 \u5982\u679c\u4e3a1\uff0c\u5219\u8bf4\u660eTLP\u7684\u672b\u5c3e\u5b58\u57281DW\u7684Digest\u5b57\u6bb5\uff08\u5728LCRC\u548cEND\u5b57\u7b26\u4e4b\u524d\uff09\u3002 EP  \u53d7\u6c61\u67d3\u7684\u6570\u636e  \uff08Poisoned Data\uff09 Byte  2 Bit 6 \u5982\u679c\u4e3a1\uff0c\u5219\u8868\u793a\u6570\u636e\u8377\u8f7d\u662f\u88ab\u6c61\u67d3\u7684\u3002 Attr[1:0]  \u5c5e\u6027  \uff08Attribute\uff09 Byte  2 Bit 5:4 Message\u4e2d\uff0c\u9664\u975e\u53e6\u6709\u6ce8\u660e\uff0c\u7aa6\u6cfd\u6b64\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002 AT[1:0]  \u5730\u5740\u7c7b\u578b  \uff08Address Type\uff09 Byte  2 Bit 3:2 Message\u7684Address Type\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\uff0c\u5fc5\u987b\u4e3a0\uff0c\u4f46\u662f\u5e76\u4e0d\u8981\u6c42\u751a\u81f3\u4e0d\u9f13\u52b1\u63a5\u6536\u65b9\u5bf9\u8fd9\u4e2a\u5b57\u6bb5\u8fdb\u884c\u68c0\u67e5\u3002 Length[9:0]  \u957f\u5ea6 Byte  2 Bit 1:0  Byte  3 Bit 7:0 \u7528\u4e8e\u8868\u793a\u5b8c\u6210\u5305\u6570\u636e\u8377\u8f7d\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aDW\u3002\u5bf9\u4e8eMessage\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u59cb\u7ec8\u4e3a0\uff08\u65e0\u6570\u636e\uff09\u62161\uff08\u67091DW\u6570\u636e\uff09\u3002 Requester  ID[15:0]  Requester  ID Byte  4 Bit 7:0  Byte  5 Bit 7:0 \u7528\u4e8e\u8868\u793a\u53d1\u9001Message\u7684Requester\u662f\u8c01\u3002  Byte 4,7:0=Requester  Bus Number  Byte 5,7:3=Requester  Device Number  Byte 5,2:0=Requester  Function Number Tag[7:0]  Tag Byte  6 Bit 7:0 \u7531\u4e8e\u6240\u6709\u7684Message\u8bf7\u6c42\u90fd\u662fPosted\u7684\uff0c\u4e0d\u9700\u8981Requester\u63a5\u6536\u5b8c\u6210\u5305\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u7ed9Message\u5206\u914dTag\u3002\u8fd9\u4e2a\u5b57\u6bb5\u5e94\u8be5\u4e3a0\u3002 Message  Code[7:0]  Message\u6807\u8bc6\u7801 Byte  7 Bit 7:0 \u8fd9\u4e2a\u5b57\u6bb5\u5305\u542b\u7684\u6807\u8bc6\u7801\u8868\u793a\u53d1\u9001\u7684Message\u662f\u4ec0\u4e48\u79cd\u7c7b\u3002  o   0000 0000b=\u89e3\u9501Message\uff08Unlock Message\uff09  o   0001 0000b=\u5ef6\u8fdf\u5bb9\u5fcd\u62a5\u544a\uff08Lat. Tolerance Reporting\uff09  o   0001 0010b=\u4f18\u5316\u7684Buffer\u5237\u65b0/\u586b\u6ee1\uff08Optimized Buffer Flush/Fill\uff09  o   0001 xxxxb=\u7535\u6e90\u7ba1\u7406Message\uff08Power Mgt. Message\uff09  o   0010 0xxxb=INTx Message  o   0011 00xxb=\u9519\u8befMessage\uff08Error Message\uff09  o   0100 xxxxb=\u5ffd\u7565Message\uff08Ignored Message\uff09  o   0101 0000b=\u8bbe\u7f6e\u63d2\u69fd\u529f\u8017Message\uff08Set Slot Power Message\uff09  o   0111 111xb=\u5382\u5546\u5b9a\u4e49\u7684Message\uff08Vendor Defined Message\uff09 Address[63:32]  \u9ad832bit\u5730\u5740 Byte  8 Bit 7:0  Byte  9 Bit 7:0  Byte  10 Bit 7:0  Byte  11 Bit 7:0 \u5982\u679cMessage\u9009\u7528\u4e86\u5730\u5740\u8def\u7531\uff08\u89c1\u4e0a\u9762\u4ecb\u7ecd\u7684Type[4:0]\u5b57\u6bb5\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b57\u6bb5\u7684\u5185\u5bb9\u5c31\u662f64bit\u8d77\u59cb\u5730\u5740\u7684\u9ad832bit\u3002\u5982\u679c\u4f7f\u7528\u662fID\u8def\u7531\uff0c\u90a3\u4e48Byte8-9\u5c31\u7ec4\u6210\u76ee\u6807ID\u3002  \u5426\u5219\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u4e0d\u4f7f\u7528\u3002 Address[31:0]  \u4f4e32bit\u5730\u5740 Byte  12 Bit 7:0  Byte  13 Bit 7:0  Byte  14 Bit 7:0  Byte  15 Bit 7:0 \u5982\u679cMessage\u9009\u7528\u4e86\u5730\u5740\u8def\u7531\uff08\u89c1\u4e0a\u9762\u4ecb\u7ecd\u7684Type[4:0]\u5b57\u6bb5\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b57\u6bb5\u7684\u5185\u5bb9\u5c31\u662f64bit\u8d77\u59cb\u5730\u5740\u7684\u4f4e32bit\uff08\u6700\u4f4e\u76842bit\u5fc5\u987b\u4e3a0\uff0c\u4ee5\u4fdd\u6301DW\u5bf9\u9f50\uff09\u3002  \u5426\u5219\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5c31\u4e0d\u4f7f\u7528\u3002 <p>\u8868 5\u20118 Message\u8bf7\u6c42Header\u5404\u5b57\u6bb5</p>"},{"location":"pcie/all/#l-messageusing-the-byte-count-modified-bit","title":"l Message\u6ce8\u610f\u4e8b\u9879\uff08Using The Byte Count Modified Bit\uff09","text":"<p>\u63a5\u4e0b\u6765\u51e0\u4e2a\u5c0f\u8282\u7684\u5217\u8868\u4f1a\u5217\u51fa9\u79cdMessage\u7ec4\uff08\u5982\u8868 5\u20118\u4e2d\u7ed9\u51fa\u7684\uff09\u7684\u5404\u81ea\u4f7f\u7528\u7684\u66f4\u5177\u4f53\u7684Message Code\u3002\u8fd99\u79cdMessage\u7ec4\u4e3a\uff1a</p> <p>\\1.    INTx\u4e2d\u65ad\u4fe1\u53f7\uff08INTx Interrupt Signaling\uff09</p> <p>\\2.    \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09</p> <p>\\3.    \u9519\u8bef\u4fe1\u53f7\uff08Error Signaling\uff09</p> <p>\\4.    \u652f\u6301\u9501\u5b9a\u4e8b\u52a1\uff08Locked Transaction Support\uff09</p> <p>\\5.    \u652f\u6301\u63d2\u69fd\u529f\u8017\u9650\u5236\uff08Slot Power Limit Support\uff09</p> <p>\\6.    \u5382\u5546\u5b9a\u4e49\u7684Message\uff08Vendor-Defined Message\uff09</p> <p>\\7.    \u5ffd\u7565Message\uff08Ignored Message\uff0c\u4e0ePCIe 1.1\u4e2d\u7684\u70ed\u63d2\u62d4\u652f\u6301\u76f8\u5173\uff09</p> <p>\\8.    \u5ef6\u8fdf\u5bb9\u5fcd\u62a5\u544a\uff08Latency Tolerance Reporting\uff0cLTR\uff09</p> <p>\\9.    \u4f18\u5316\u7684Buffer\u5237\u65b0\u548c\u586b\u6ee1\uff08Optimized Buffer Flush and Fill\uff0cOBFF\uff09</p>"},{"location":"pcie/all/#l-intxmessageintx-interrupt-messages","title":"l INTx\u4e2d\u65adMessage\uff08INTx Interrupt Messages\uff09","text":"<p>\u8bb8\u591a\u8bbe\u5907\u90fd\u9002\u7528PCI 2.3\u7684MSI\uff08Message Signaled Interrupt\uff09\u65b9\u6cd5\u6765\u4f20\u8f93\u4e2d\u65ad\uff0c\u4f46\u662f\u5bf9\u4e8e\u8001\u7684\u8bbe\u5907\u6765\u8bf4\u53ef\u80fd\u4f1a\u4e0d\u652f\u6301MSI\u3002\u5bf9\u4e8e\u8fd9\u4e9b\u60c5\u51b5\uff0cPCIe\u5b9a\u4e49\u4e86\u4e00\u4e2a\u201c\u865a\u62df\u7ebfvirtual wire\u201d\u4f5c\u4e3a\u66ff\u4ee3\u65b9\u6848\uff0c\u8bbe\u5907\u901a\u8fc7\u53d1\u9001Message\u6765\u6a21\u62dfPCI\u4e2d\u65ad\u5f15\u811a\uff08INTA-INTD\uff09\u7684\u62c9\u8d77\u4e0e\u91ca\u653e\u3002\u4e2d\u65ad\u8bbe\u5907\u53d1\u51fa\u7b2c\u4e00\u4e2aMessage\u6765\u901a\u77e5\u4e0a\u884c\u8bbe\u5907\u81ea\u5df1\u62c9\u8d77\u4e86\u4e00\u4e2a\u4e2d\u65ad\u3002\u4e00\u65e6\u8fd9\u4e2a\u4e2d\u65ad\u88ab\u670d\u52a1\u4e86\uff0c\u90a3\u4e48\u4e2d\u65ad\u8bbe\u5907\u5c31\u53d1\u51fa\u7b2c\u4e8c\u4e2aMessage\u6765\u8868\u793a\u8fd9\u4e2a\u201c\u865a\u62df\u4e2d\u65ad\u7ebf\u201d\u5df2\u7ecf\u91ca\u653e\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u79cd\u534f\u8bae\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cVirtual INTx Signaling\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u8868 5\u20119 INTx\u4e2d\u65ad\u4fe1\u53f7Message\u7684\u4ee3\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528INTx Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    INTx Message\u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> <p>\\2.    \u5b83\u4eec\u53ea\u4f1a\u7531\u4e0a\u884c\u7aef\u53e3\uff08Upstream Port\uff09\u53d1\u51fa\u3002\u5bf9\u63a5\u6536\u5230\u7684\u6570\u636e\u5305\u8fdb\u884c\u8fd9\u65b9\u9762\u7684\u89c4\u5219\u68c0\u67e5\u662f\u53ef\u9009\u9879\uff0c\u4f46\u662f\u5982\u679c\u8fdb\u884c\u4e86\u68c0\u67e5\uff0c\u90a3\u4e48\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\3.    INTx Message\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\4.    \u94fe\u8def\u4e24\u7aef\u7684\u7ec4\u4ef6\u5fc5\u987b\u8ddf\u8e2a\u56db\u79cd\u865a\u62df\u4e2d\u65ad\uff08virtual interrupt\uff09\u7684\u72b6\u6001\u3002\u5982\u679c\u4e0a\u884c\u7aef\u53e3\u7684\u4e00\u4e2a\u4e2d\u65ad\u7684\u903b\u8f91\u72b6\u6001\u53d1\u751f\u4e86\u6539\u53d8\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u53d1\u51fa\u76f8\u5e94\u7684INTx Message\u3002</p> <p>\\5.    \u5f53\u547d\u4ee4\u5bc4\u5b58\u5668\uff08Command Register\uff09\u4e2d\u7684Interrupt Disable\u4f4d\u88ab\u7f6e\u4e3a1\u65f6\uff0cINTx\u4fe1\u53f7\u662f\u88ab\u7981\u7528\u7684\uff08\u5c31\u50cf\u7269\u7406\u4e2d\u65ad\u7ebf\u7684\u7c7b\u4f3c\u60c5\u51b5\u4e00\u6837\uff09\u3002</p> <p>\\6.    \u5982\u679c\u5728Interrupt Disable\u4f4d\u4e3a1\u65f6\uff0c\u8bbe\u5907\u7684\u4efb\u4f55\u4e00\u4e2a\u865a\u62dfINTx\u4fe1\u53f7\u4ecd\u4e3a\u6fc0\u6d3b\u72b6\u6001\uff0c\u90a3\u4e48\u4e0a\u884c\u7aef\u53e3\u5fc5\u987b\u53d1\u51fa\u5bf9\u5e94\u7684\u91ca\u653eINTx Message\uff08Deassert_INTx Message\uff09\u3002</p> <p>\\7.    Switch\u7684\u5404\u4e2a\u4e0b\u884c\u7aef\u53e3\u5fc5\u987b\u72ec\u7acb\u7684\u8ddf\u8e2a\u56db\u79cdINTx\u4fe1\u53f7\u72b6\u6001\uff0c\u5e76\u7ec4\u5408\u6210\u4e0a\u884c\u7aef\u53e3\u7684\u72b6\u6001\u3002</p> <p>\\8.    RC\u7684\u5404\u4e2a\u4e0b\u884c\u7aef\u53e3\u5fc5\u987b\u72ec\u7acb\u7684\u8ddf\u8e2a\u4e0b\u884c\u7aef\u53e3\u7684INTx\u4fe1\u53f7\u72b6\u6001\uff0c\u5e76\u5c06\u5b83\u4eec\u8f6c\u6362\u6210\u7cfb\u7edf\u4e2d\u65ad\uff0c\u5177\u4f53\u7684\u8f6c\u6362\u65b9\u5f0f\u6839\u636e\u5177\u4f53\u5b9e\u73b0\u800c\u5b9a\u3002</p> <p>\\9.    INTx Message\u4f7f\u7528\u201cLocal-Terminate at Receiver\u5728\u63a5\u6536\u8005\u672c\u5730\u7ed3\u675f\u201d\u7684\u8def\u7531\u7c7b\u578b\u6765\u4f7f\u5f97\u4e00\u4e2aSwitch\u5728\u5fc5\u8981\u65f6\u5bf9\u6307\u5b9a\u7684\u4e2d\u65ad\u5f15\u811a\u8fdb\u884c\u91cd\u6620\u5c04\uff08\u53c2\u9605\u201cMapping and Collapsing INTx Messages\u201d\u4e00\u8282\uff09\u3002\u56e0\u6b64\uff0cINTx Message\u4e2d\u7684Requester ID\u6709\u53ef\u80fd\u662f\u6700\u540e\u4e00\u4e2a\u4f20\u9001\u8005\u6240\u6307\u5b9a\u7684\u3002</p>"},{"location":"pcie/all/#l-messagepower-management-messages","title":"l \u7535\u6e90\u7ba1\u7406Message\uff08Power Management Messages\uff09","text":"<p>PCIe\u5bf9PCI\u7684\u7535\u6e90\u7ba1\u7406\u662f\u517c\u5bb9\u7684\uff0c\u5e76\u4e14\u8fd8\u52a0\u5165\u4e86\u57fa\u4e8e\u786c\u4ef6\u7684\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u3002Message\u662f\u7528\u6765\u4f20\u8fbe\u4e00\u4e9b\u5173\u4e8e\u7535\u6e90\u7ba1\u7406\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u5982\u679c\u60f3\u4e86\u89e3\u5b8c\u6574\u7684PCIe\u7535\u6e90\u7ba1\u7406\u534f\u8bae\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u90a3\u4e48\u8bf7\u53c2\u9605Chapter 16 \u201cPower Management\u201d\u4e00\u7ae0\u3002\u8868 5\u201110\u603b\u7ed3\u4e86\u56db\u79cd\u7535\u6e90\u7ba1\u7406Message\u7c7b\u578b\u3002</p> <p></p> <p>\u8868 5\u201110\u7535\u6e90\u7ba1\u7406Message\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528\u7535\u6e90\u7ba1\u7406Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    \u7535\u6e90\u7ba1\u7406Message\u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> <p>\\2.    \u7535\u6e90\u7ba1\u7406Message\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\3.    \u5f53\u4e00\u4e2a\u4e0b\u884c\u7aef\u53e3\u6536\u5230\u4e86\u4e00\u4e2a\u94fe\u8def\u5bf9\u7aef\u7535\u6e90\u7ba1\u7406\u8bf7\u6c42\uff0c\u8bf7\u6c42\u8981\u5c06\u94fe\u8def\u7535\u6e90\u72b6\u6001\u66f4\u6539\u4e3aL1\uff0c\u4f46\u662f\u4e0b\u884c\u7aef\u53e3\u62d2\u7edd\u8fd9\u79cd\u66f4\u6539\uff0c\u90a3\u4e48\u5b83\u5c31\u8981\u53d1\u51faPM_Active_State_Nak\u8fd9\u79cd\u7535\u6e90\u7ba1\u7406Message\u3002</p> <p>\\4.    \u5f53\u4e00\u4e2a\u7ec4\u4ef6\u8bf7\u6c42\u7535\u6e90\u7ba1\u7406\u4e8b\u4ef6\uff08Power Management Event\uff09\u65f6\uff0c\u5b83\u7684\u4e0a\u884c\u7aef\u53e3\u9700\u8981\u53d1\u51faPM_PME\uff0c\u8fd9\u4e2aMessage\u5c06\u88ab\u9690\u5f0f\u8def\u7531\u81f3RC\u3002</p> <p>\\5.    PM_Turn_Off\u4f1a\u5411\u4e0b\u53d1\u9001\u7ed9\u6240\u6709\u7684EP\uff08\u7531RC\u53d1\u51fa\uff0c\u8fdb\u884c\u9690\u5f0f\u8def\u7531\u7684\u5e7f\u64ad\uff09\u3002</p> <p>\\6.    PME_TO_Ack\u662f\u7531EP\u7684\u4e0a\u884c\u7aef\u53e3\u53d1\u51fa\u7684\u3002\u5bf9\u4e8e\u62e5\u6709\u591a\u4e2a\u4e0b\u884c\u7aef\u53e3\u7684Switch\u6765\u8bf4\uff0c\u53ea\u6709\u5f53\u6240\u6709\u7684\u4e0b\u884c\u7aef\u53e3\u90fd\u6536\u5230\u4e86\u8fd9\u4e2aMessage\uff0c\u624d\u4f1a\u5c06\u5176\u8f6c\u53d1\u81f3\u4e0a\u884c\uff08\u4e5f\u5c31\u662f\u6c47\u805a\u6536\u96c6\uff0c\u5e76\u8def\u7531\u8f6c\u53d1\u7ed9RC\uff09\u3002</p>"},{"location":"pcie/all/#l-messageerror-messages","title":"l \u9519\u8befMessage\uff08Error Messages\uff09","text":"<p>\u5f53\u542f\u7528\u4e86\u9519\u8befMessage\u7684\u7ec4\u4ef6\u68c0\u6d4b\u5230\u4e86\u9519\u8bef\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06\u9519\u8befMessage\u5411\u4e0a\u53d1\u9001\uff08\u9690\u5f0f\u8def\u7531\u81f3RC\uff09\u3002\u4e3a\u4e86\u534f\u52a9\u8f6f\u4ef6\uff0c\u8ba9\u8f6f\u4ef6\u77e5\u9053\u5e94\u8be5\u5982\u4f55\u5904\u7406\u8fd9\u4e2a\u9519\u8bef\uff0c\u5728Error Message\u4e2d\u4f7f\u7528Header\u4e2d\u7684Requester ID\u5b57\u6bb5\u6765\u8868\u793a\u8bf7\u6c42\u8005\u3002\u8868 5\u201111\u603b\u7ed3\u4e86\u4e09\u79cdError Message\u7c7b\u578b\u3002</p> <p></p> <p>\u8868 5\u201111\u9519\u8befMessage\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528Error Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    Error Message\u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> <p>\\2.    Error Message\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\3.    RC\u4f1a\u5c06Error Message\u8f6c\u6362\u6210\u7cfb\u7edf\u6307\u5b9a\u7684\u4e8b\u4ef6\u3002</p>"},{"location":"pcie/all/#l-locked-transaction-support","title":"l \u652f\u6301\u9501\u5b9a\u4e8b\u52a1\uff08Locked Transaction Support\uff09","text":"<p>\u89e3\u9501Message\uff08Unlock Message\uff09\u88ab\u5e94\u7528\u4e8ePCI\u5b9a\u4e49\u7684\u9501\u5b9a\u4e8b\u52a1\u534f\u8bae\u4e2d\uff08Locked Transaction Protocol\uff09\uff0c\u5e76\u4e14\u5728PCIe\u4e2d\u4f9d\u7136\u5bf9\u4f20\u7edfPCI\u9057\u7559\u8bbe\u5907\u53ef\u7528\u3002\u8fd9\u79cd\u534f\u8bae\u8d77\u59cb\u4e8e\u4e00\u4e2aMRd Lock\u8bf7\u6c42\u3002\u5f53\u8fd9\u4e2a\u8bf7\u6c42\u5728\u88ab\u9001\u8fbe\u5230\u76ee\u6807\u8bbe\u5907\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6cbf\u9014\u7684\u7aef\u53e3\u4eec\u90fd\u4f1a\u53d1\u73b0\u5b83\uff0c\u8fd9\u4e9b\u7aef\u53e3\u4f1a\u5b9e\u73b0\u4e00\u4e2a\u539f\u5b50\u201c\u8bfb-\u4fee\u6539-\u5199\u201d\u534f\u8bae\uff08read-modify-write protocol\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u4eec\u5c06\u4f1a\u9501\u5b9aVC0\uff08Virtual Channel 0\uff09\u8ba9\u5176\u4ed6\u7684\u8bf7\u6c42\u4e0d\u80fd\u4f7f\u7528\uff0c\u76f4\u5230\u6536\u5230Unlock Message\u624d\u4f1a\u5bf9VC0\u89e3\u9501\u3002\u8fd9\u79cdUnlock Message\u4f1a\u88ab\u53d1\u9001\u81f3Locked\u4e8b\u52a1\u7684\u76ee\u6807\u8bbe\u5907\uff0c\u4ee5\u6b64\u6765\u91ca\u653e\u4f20\u8f93\u8def\u5f84\u4e2d\u7684\u6240\u6709\u88ab\u9501\u5b9a\u7684\u7aef\u53e3\uff0c\u5e76\u7528\u4e8e\u6700\u7ec8\u5b8c\u6210\u9501\u5b9a\u4e8b\u52a1\u7684\u4e00\u7cfb\u5217\u884c\u4e3a\u3002\u8868 5\u201112\u603b\u7ed3\u4e86Unlock Message\u7684\u6807\u8bc6\u7801\u3002</p> <p></p> <p>\u8868 5\u201112\u89e3\u9501Message\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528Unlock Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    Unlock Message\u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> <p>\\2.    Unlock Message\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p>"},{"location":"pcie/all/#l-messageset-slot-power-limit-message","title":"l \u8bbe\u7f6e\u63d2\u69fd\u529f\u7387\u9650\u5236Message\uff08Set Slot Power Limit Message\uff09","text":"<p>\u8fd9\u79cdMessage\u662f\u7531\u4e0b\u884c\u7aef\u53e3\u53d1\u9001\u7ed9\u63d2\u5728\u63d2\u69fd\u4e0a\u7684\u8bbe\u5907\u7684\u3002\u8fd9\u91cc\u9762\u7684\u529f\u7387\u9650\u5236\u4fe1\u606f\u4f1a\u50a8\u5b58\u5728EP\u7684\u8bbe\u5907\u80fd\u529b\u5bc4\u5b58\u5668\u4e2d\uff08Device Capabilities Register\uff09\u3002\u8868 5\u201112\u603b\u7ed3\u4e86Unlock Message\u7684\u6807\u8bc6\u7801\u3002</p> <p></p> <p>\u8868 5\u201113\u63d2\u69fd\u529f\u7387\u9650\u5236Message\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528Set Slot Power Limit Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    Set Slot Power Limit Message\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\2.    Set Slot Power Limit Message\u7684\u6570\u636e\u8377\u8f7d\u4e3a1DW\uff0c\u56e0\u6b64Length\u5b57\u6bb5\u7684\u503c\u4e3a1\u3002\u800c\u572832bit\u6570\u636e\u8377\u8f7d\u4e2d\u4ec5\u6709\u4f4e10bit\u7528\u4e8e\u8fdb\u884c\u63d2\u69fd\u529f\u7387\u653e\u5927\u6216\u51cf\u5c0f\uff1b\u5269\u4e0b\u7684\u9ad8\u4f4d\u5fc5\u987b\u90fd\u7f6e\u4e3a0\u3002</p> <p>\\3.    \u5f53\u6570\u636e\u94fe\u8def\u5c42\u8f6c\u6362\u4e3aDL-Up\u72b6\u6001\u65f6\uff0c\u8be5\u6d88\u606f\u4f1a\u81ea\u52a8\u53d1\u9001\u3002\u6216\u8005\u662f\u653e\u6570\u636e\u94fe\u8def\u5c42\u5df2\u7ecf\u62a5\u544a\u4e86DL-Up\u72b6\u6001\uff0c\u7136\u540e\u53d1\u751f\u4e86\u4e00\u4e2a\u914d\u7f6e\u5199\u6765\u5199\u5165Slot Capabilities Register\u65f6\uff0c\u8be5\u6d88\u606f\u4e5f\u4f1a\u81ea\u52a8\u53d1\u9001\u3002</p> <p>\\4.    \u5982\u679c\u63d2\u69fd\u4e2d\u7684\u677f\u5361\u6d88\u8017\u7684\u529f\u7387\u5df2\u7ecf\u4f4e\u4e8e\u4e86\u6307\u5b9a\u7684\u529f\u7387\u9650\u5236\uff0c\u90a3\u4e48\u53ef\u4ee5\u5ffd\u7565\u8fd9\u79cdMessage\u3002</p>"},{"location":"pcie/all/#l-message-01vendor-defined-message-0-and-1","title":"l \u5382\u5546\u5b9a\u4e49\u7684Message 0\u548c1\uff08Vendor-Defined Message 0 and 1\uff09","text":"<p>Vendor-Defined Message\u662f\u7528\u4e8e\u8fdb\u884cPCIe Message\u80fd\u529b\u7684\u6269\u5c55\uff0c\u8fd9\u79cd\u6269\u5c55\u65e2\u53ef\u4ee5\u901a\u8fc7\u534f\u8bae\u672c\u8eab\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5382\u5546\u6765\u6307\u5b9a\u7684\u6269\u5c55\u3002\u8fd9\u79cdMessage\u7684Header\u683c\u5f0f\u5982\u56fe 5\u201112\u6240\u793a\uff0cMessage\u6807\u8bc6\u7801\u5982\u8868 5\u201112\u3002</p> <p></p> <p>\u56fe 5\u201112\u5382\u5546\u5b9a\u4e49\u7684Message Header\u683c\u5f0f</p> <p></p> <p>\u8868 5\u201114\u5382\u5546\u5b9a\u4e49\u7684Message\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528Vendor-Defined Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    Vendor-Defined Message 0\u548c1\u53ef\u4ee5\u6709\u4e5f\u53ef\u4ee5\u6ca1\u6709\u6570\u636e\u8377\u8f7d\u3002</p> <p>\\2.    Message\u7528Vendor ID\u6765\u8fdb\u884c\u533a\u5206\u3002</p> <p>\\3.    Attr[2]\u548cAttr[1:0]\u5e76\u4e0d\u662f\u4fdd\u7559\u4f4d\u3002</p> <p>\\4.    \u5982\u679c\u63a5\u6536\u8005\u65e0\u6cd5\u8ba4\u51fa\u8fd9\u79cdMessage\uff1a</p> <p>o Type 1 Message\u53ef\u4ee5\u88ab\u5b89\u9759\u7684\u5ffd\u7565\u4e22\u5f03\u6389\u3002</p> <p>o Type 0 Message\u8981\u88ab\u4f5c\u4e3aUnsupported Request\uff08UR\uff09\u8fd9\u79cd\u9519\u8bef\u60c5\u51b5\u6765\u5904\u7406\u3002</p>"},{"location":"pcie/all/#l-messageignored-message","title":"l \u88ab\u5ffd\u7565\u7684Message\uff08Ignored Message\uff09","text":"<p>\u5982\u679c\u76f4\u63a5\u5217\u51fa\u4e00\u6574\u4e2a\u76ee\u5f55\u7684\u9700\u8981\u88ab\u5ffd\u7565\u7684Message\uff0c\u800c\u4e0d\u53bb\u8bb2\u5ffd\u7565\u7684\u524d\u56e0\u540e\u679c\uff0c\u90a3\u53ef\u80fd\u4f1a\u542c\u8d77\u6765\u6709\u4e00\u4e9b\u5947\u602a\u3002\u8fd9\u4e9bMessage\u5176\u5b9e\u662f\u539f\u6765\u7684\u70ed\u63d2\u62d4\u4fe1\u53f7Message\uff08Hot Plug Signaling Message\uff09\uff0c\u5b83\u4eec\u7528\u4e8e\u652f\u6301\u8bbe\u5907\uff0c\u8fd9\u4e9b\u8bbe\u5907\u4e0a\u5177\u6709\u70ed\u63d2\u62d4\u6307\u793a\u5668\uff0c\u5e76\u4e14\u53ea\u9700\u8981\u6309\u4e0b\u8fd9\u4e2a\u63d2\u5361\u8bbe\u5907\u4e0a\u7684\u6309\u94ae\u800c\u4e0d\u662f\u7cfb\u7edf\u677f\u4e0a\u7684\u6309\u94ae\u3002\u8fd9\u79cdMessage\u7c7b\u578b\u662f\u7531PCIe 1.0a\u7248\u672c\u6240\u5b9a\u4e49\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u9009\u9879\u5728PCIe 1.1\u7248\u672c\u4e2d\u5c31\u5df2\u7ecf\u4e0d\u518d\u652f\u6301\u4e86\uff0c\u56e0\u6b64\u8fd9\u91cc\u6240\u8bb2\u7684\u8fd9\u4e9b\u7ec6\u8282\u5185\u5bb9\u4ec5\u4f5c\u4e3a\u53c2\u8003\u3002\u6b63\u5982\u540d\u5b57\u8981\u8868\u8fbe\u7684\u90a3\u6837\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d1\u9001\u65b9\u4e0d\u8981\u53d1\u9001\u8fd9\u4e9bMessage\uff0c\u5e76\u4e14\u4e5f\u5f3a\u70c8\u5efa\u8bae\u63a5\u6536\u65b9\u5c31\u7b97\u6536\u5230\u5b83\u4eec\u4e5f\u8981\u5ffd\u89c6\u6389\u3002\u5982\u679c\u65e0\u8bba\u5982\u4f55\u4ecd\u8981\u4f7f\u7528\u8fd9\u4e9bMessage\uff0c\u90a3\u4e48\u5b83\u4eec\u5fc5\u987b\u8981\u7b26\u5408PCIe 1.0a\u7684\u534f\u8bae\u7ec6\u8282\u3002</p> <p></p> <p>\u8868 5\u201115\u70ed\u63d2\u62d4Message\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528Hot Plug Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    Hot Plug Message\u7531\u4e0b\u884c\u7aef\u53e3\u53d1\u9001\u7ed9\u63d2\u69fd\u4e2d\u7684\u677f\u5361\u3002</p> <p>\\2.    Attention_Button Message\u662f\u7531\u63d2\u69fd\u4e2d\u7684\u8bbe\u5907\u5411\u4e0a\u884c\u53d1\u9001\u7684\u3002</p>"},{"location":"pcie/all/#l-messagelatency-tolerance-reporting-message","title":"l \u5ef6\u8fdf\u5bb9\u5fcd\u62a5\u544aMessage\uff08Latency Tolerance Reporting Message\uff09","text":"<p>LTR Message\u662f\u7528\u6765\u62a5\u544a\u4e00\u4e2a\u8bbe\u5907\u53ef\u63a5\u53d7\u7684\u8bfb\u5199\u670d\u52a1\u5ef6\u8fdf\uff0c\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u9879\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u79cd\u7535\u6e90\u7ba1\u7406\u6280\u672f\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cLTR\uff08Latency Tolerance Reporting\uff09\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 5\u201113 LTR Message Header\u683c\u5f0f</p> <p></p> <p>\u8868 5\u201116 LTR Message\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528LTR Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    LTR Message\u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> <p>\\2.    LTR Message\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p>"},{"location":"pcie/all/#l-buffermessageoptimized-buffer-flush-and-fill","title":"l \u4f18\u5316\u7684Buffer\u5237\u65b0\u548c\u586b\u5145Message\uff08Optimized Buffer Flush and Fill\uff09","text":"<p>OBFF Message\u7528\u6765\u5411EP\u62a5\u544a\u5e73\u53f0\u7535\u6e90\u60c5\u51b5\uff0c\u4ee5\u6b64\u6765\u4fc3\u8fdb\u66f4\u641e\u7b11\u7684\u7cfb\u7edf\u7535\u6e90\u7ba1\u7406\u3002\u66f4\u591a\u5173\u4e8e\u8fd9\u79cd\u6280\u672f\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u9605\u201cOBBF\uff08Optimized Buffer Flush and Fill\uff09\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 5\u201114 OBBF Message Header\u683c\u5f0f</p> <p></p> <p>\u8868 5\u201117 OBBF Message\u6807\u8bc6\u7801</p> <p>\u5173\u4e8e\u4f7f\u7528OBFF Message\u7684\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>\\1.    OBFF Message\u6ca1\u6709\u6570\u636e\u8377\u8f7d\uff0c\u56e0\u6b64Length\u5b57\u6bb5\u4e3a\u4fdd\u7559\u5b57\u6bb5\u3002</p> <p>\\2.    OBFF Message\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\u91cf\u7c7b\u578bTC 0\u3002\u63a5\u6536\u65b9\u5fc5\u987b\u68c0\u67e5\u8fd9\u4e00\u6761\u89c4\u5219\uff0c\u53d1\u73b0\u8fdd\u4f8b\u7684\u6570\u636e\u5305\u5c31\u4f1a\u88ab\u5f53\u505a\u7578\u5f62TLP\uff08Malformed TLP\uff09\u3002</p> <p>\\3.    Header\u4e2d\u7684Requester ID\u5fc5\u987b\u4e3a\u4f20\u9001\u4e2d\u7684\u7aef\u53e3\u7684ID\u3002</p>"},{"location":"pcie/all/#chapter-6-flow-control","title":"Chapter 6      Flow Control //\u6d41\u91cf\u63a7\u5236","text":""},{"location":"pcie/all/#_15","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u8282\u8ba8\u8bba\u4e86\u4e3b\u8981\u7684\u4e09\u79cd\u7c7b\u578b\u7684\u6570\u636e\u5305\uff1aTLP\u4e8b\u52a1\u5c42\u5305\uff08Transaction Layer Packets\uff09\u3001DLLP\u6570\u636e\u94fe\u8def\u5c42\u5305\uff08Data Link Layer Packets\uff09\u3001Ordered Sets\u547d\u4ee4\u96c6\u3002\u5e76\u4e14\u5728\u4e0a\u4e00\u7ae0\u4e2d\u4e3b\u8981\u8bb2\u8ff0TLP\u7684\u7528\u6cd5\u3001\u683c\u5f0f\u548c\u4e0d\u540c\u79cd\u7c7b\u7684\u5b9a\u4e49\uff0c\u5e76\u5c06\u8be6\u7ec6\u7684\u8bb2\u89e3TLP\u7684\u76f8\u5173\u5b57\u6bb5\u542b\u4e49\u3002\u5173\u4e8eDLLP\u7684\u5185\u5bb9\u5c06\u4f1a\u5728Chapter 9 \u201cDLLP Element\u201d\u4e2d\u8fdb\u884c\u5355\u72ec\u8bb2\u89e3\u3002</p>"},{"location":"pcie/all/#_16","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u8ba8\u8bba\u6d41\u91cf\u63a7\u5236\u534f\u8bae\uff08Flow Control\uff09\u7684\u76ee\u7684\u4ee5\u53ca\u7ec6\u8282\u64cd\u4f5c\u3002\u6d41\u91cf\u63a7\u5236\u662f\u7528\u6765\u786e\u4fdd\u5728\u63a5\u6536\u8005\u65e0\u6cd5\u63a5\u6536TLP\u65f6\uff0c\u53d1\u9001\u65b9\u4e0d\u4f1a\u518d\u7ee7\u7eed\u53d1\u9001TLP\u3002\u8fd9\u907f\u514d\u4e86\u63a5\u6536Buffer\u6ea2\u51fa\uff0c\u4e5f\u6d88\u9664\u4e86\u539f\u672cPCI\u5de5\u4f5c\u65b9\u5f0f\u4e2d\u7684\u4e00\u4e9b\u4f4e\u6548\u884c\u4e3a\uff0c\u6bd4\u5982\u65ad\u5f00\uff08disconnect\uff09\u3001\u91cd\u8bd5\uff08retry\uff09\u548c\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002</p>"},{"location":"pcie/all/#_17","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u5c06\u4f1a\u8ba8\u8bba\u7528\u4e8e\u652f\u6301QoS\uff08Quality of Service\uff09\u7684\u673a\u5236\uff0c\u5e76\u63cf\u8ff0\u5bf9\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u4e0d\u540c\u6570\u636e\u5305\u7684\u4f20\u8f93\u65f6\u95f4\u548c\u5e26\u5bbd\u8fdb\u884c\u63a7\u5236\u7684\u610f\u4e49\u3002\u8fd9\u4e9b\u673a\u5236\u5305\u62ec\uff0c\u7279\u5b9a\u5e94\u7528\u7684\u8f6f\u4ef6\u5c06\u4f1a\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u8bbe\u5907\u5185\u6784\u5efa\u53ef\u9009\u7684\u786c\u4ef6\u6765\u542f\u7528\u4e8b\u52a1\u4f18\u5148\u7ea7\u7ba1\u7406\u3002</p>"},{"location":"pcie/all/#61-flow-control-concept","title":"6.1 \u6d41\u91cf\u63a7\u5236\u6982\u5ff5\uff08Flow Control Concept\uff09","text":"<p>\u6bcf\u6761PCIe\u94fe\u8def\u4e24\u7aef\u7684\u7aef\u53e3\u90fd\u5fc5\u987b\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236\u673a\u5236\u3002\u5728\u4e00\u4e2a\u6570\u636e\u5305\u5141\u8bb8\u88ab\u53d1\u51fa\u4e4b\u524d\uff0c\u6d41\u91cf\u63a7\u5236\u673a\u5236\u5fc5\u987b\u786e\u8ba4\u63a5\u6536\u7aef\u53e3\u62e5\u6709\u8db3\u591f\u7684\u53ef\u7528Buffer\u7a7a\u95f4\u6765\u63a5\u6536\u6570\u636e\u5305\u3002\u800c\u5728\u50cfPCI\u8fd9\u79cd\u5e76\u884c\u603b\u7ebf\u4e2d\uff0c\u5c3d\u7ba1\u4e0d\u77e5\u9053\u76ee\u6807\u65b9\u662f\u5426\u51c6\u5907\u597d\u4e86\u5904\u7406\u6570\u636e\uff0c\u4e8b\u52a1\u4e5f\u4f1a\u5c1d\u8bd5\u53bb\u53d1\u9001\u6267\u884c\uff0c\u5982\u679c\u56e0\u4e3a\u6ca1\u6709\u8db3\u591f\u7684\u53ef\u7528Buffer\u7a7a\u95f4\uff0c\u8bf7\u6c42\u88ab\u62d2\u7edd\u4e86\uff0c\u90a3\u4e48\u4e8b\u52a1\u5c31\u4f1a\u4e00\u76f4\u91cd\u8bd5\uff08Retry\uff09\u76f4\u81f3\u5b8c\u6210\u3002\u8fd9\u5c31\u662fPCI\u7684\u201cDelayed Transaction Model\u5ef6\u8fdf\u7684\u4e8b\u52a1\u6a21\u578b\u201d\uff0c\u7136\u800c\u8fd9\u79cd\u65b9\u5f0f\u7684\u6548\u7387\u5f88\u4f4e\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\u673a\u5236\u53ef\u4ee5\u6539\u5584\u5f53\u591a\u4e2a\u865a\u62df\u901a\u9053\uff08Virtual Channel\uff0cVC\uff09\u88ab\u5360\u7528\u65f6\u7684\u4f20\u8f93\u6548\u7387\u3002\u6bcf\u4e2a\u865a\u62df\u901a\u9053\u81ea\u5df1\u7684\u4e8b\u52a1\u662f\u4e0e\u5176\u4ed6VC\u7684\u4e8b\u52a1\u6d41\u91cf\u76f8\u72ec\u7acb\u7684\uff0c\u56e0\u4e3a\u6d41\u91cf\u63a7\u5236Buffer\u662fVC\u5404\u81ea\u5355\u72ec\u7ef4\u62a4\u7684\u3002\u56e0\u6b64\uff0c\u82e5\u4e00\u4e2aVC\u7684\u6d41\u63a7Buffer\u6ee1\u4e86\uff0c\u5b83\u4e5f\u4e0d\u4f1a\u963b\u585e\u5bf9\u5176\u4ed6VC Buffer\u7684\u8bbf\u95ee\u3002PCIe\u652f\u6301\u6700\u591a8\u6761\u865a\u62df\u901a\u9053\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\u673a\u5236\u4f7f\u7528\u4e00\u79cd\u57fa\u4e8e\u4fe1\u7528\uff08Credit-based\uff09\u7684\u673a\u5236\uff0c\u4f7f\u5f97\u53d1\u9001\u7aef\u53e3\u53ef\u4ee5\u77e5\u9053\u63a5\u6536\u7aef\u53e3\u6709\u591a\u5c11\u53ef\u7528\u7684Buffer\u7a7a\u95f4\u3002\u4f5c\u4e3a\u5b83\u4eec\u521d\u59cb\u5316\u7684\u4e00\u90e8\u5206\uff0c\u6bcf\u4e2a\u63a5\u6536\u8005\u90fd\u8981\u5c06\u81ea\u5df1\u7684Buffer\u5927\u5c0f\u62a5\u544a\u7ed9\u94fe\u8def\u5bf9\u7aef\u7684\u53d1\u9001\u8005\uff0c\u5e76\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f7f\u7528DLLP\u6765\u5b9a\u671f\u5730\u66f4\u65b0\u8fd9\u4e2a\u201c\u4fe1\u7528\u503c\u201d\u3002\u6280\u672f\u4e0a\u6765\u8bf4\uff0c\u660e\u663e\u5730\uff0cDLLP\u662f\u4e00\u79cd\u5f00\u9500\uff0c\u56e0\u4e3a\u5b83\u5e76\u4e0d\u643a\u5e26\u4efb\u4f55\u6570\u636e\u8377\u8f7d\uff0c\u4f46\u662fDLLP\u59cb\u7ec8\u5f88\u5c0f\uff08\u59cb\u7ec8\u4e3a8\u4e2a\u7b26\u53f7\u5927\u5c0f\uff09\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u5176\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u6700\u5c0f\u3002</p> <p>\u6d41\u91cf\u63a7\u5236\u903b\u8f91\u5b9e\u9645\u4e0a\u662f\u4e24\u4e2a\u5c42\u7ea7\u7684\u5171\u540c\u804c\u8d23\uff1a\u4e8b\u52a1\u5c42\u5305\u542b\u4e86\u8ba1\u6570\u5668\u7528\u4e8e\u5bf9\u53ef\u7528Buffer\u7a7a\u95f4\u8fdb\u884c\u8ba1\u6570\uff0c\u4f46\u662f\u6570\u636e\u94fe\u8def\u5c42\u4e5f\u8981\u8d1f\u8d23\u53d1\u9001\u548c\u63a5\u6536\u8fd9\u4e9b\u5305\u542b\u4e86\u53ef\u7528Buffer\u7a7a\u95f4\u4fe1\u606f\u7684DLLP\u3002\u5982\u56fe 6\u20111\u5c55\u793a\u4e86\u8fd9\u79cd\u5171\u540c\u804c\u8d23\u3002\u5728\u6d41\u91cf\u63a7\u5236\u7684\u7684\u5de5\u4f5c\u8fc7\u7a0b\u4e2d\uff1a</p> <p>n \u8bbe\u5907\u62a5\u544a\u53ef\u7528\u7684Buffer****\u7a7a\u95f4\uff1a\u63a5\u6536\u8005\u7684\u6bcf\u4e2a\u7aef\u53e3\u90fd\u8981\u62a5\u544a\u81ea\u5df1\u7684\u6d41\u91cf\u63a7\u5236Buffer\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3acredit\uff08\u4fe1\u7528\uff09\u3002\u4e00\u4e2aBuffer\u4e2dcredit\u7684\u6570\u91cf\u4f1a\u4ece\u81ea\u8eab\u63a5\u6536\u4fa7\u4e8b\u52a1\u5c42\u53d1\u9001\u81f3\u53d1\u9001\u4fa7\u6570\u636e\u94fe\u8def\u5c42\uff08\u5982\u56fe 6\u20111\uff09\u3002\u5728\u5408\u9002\u7684\u65f6\u95f4\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5c06\u4f1a\u4ea7\u751f\u4e00\u4e2a\u6d41\u91cf\u63a7\u5236DLLP\u6765\u5c06\u8fd9\u4e2acredit\u4fe1\u606f\u8f6c\u53d1\u81f3\u6bcf\u4e2a\u6d41\u91cf\u63a7\u5236Buffer\u7684\u94fe\u8def\u5bf9\u7aef\u7684\u63a5\u6536\u8005\u7684\u3002</p> <p>n \u63a5\u6536\u8005\u5bc4\u5b58Credit\uff1a\u63a5\u6536\u8005\u6536\u5230\u6d41\u91cf\u63a7\u5236DLLP\uff0c\u5e76\u5c06credit\u503c\u4f20\u8f93\u81f3\u81ea\u8eab\u53d1\u9001\u4fa7\u4e8b\u52a1\u5c42\u3002\u8fd9\u5c31\u5b8c\u6210\u4e86credit\u4ece\u94fe\u8def\u7684\u4e00\u7aef\u5230\u5bf9\u7aef\u7684\u4f20\u8f93\u3002\u8fd9\u4e9b\u64cd\u4f5c\u662f\u53cc\u5411\u8fdb\u884c\u7684\uff0c\u76f4\u5230\u6240\u6709\u7684\u6d41\u91cf\u63a7\u5236\u4fe1\u606f\u90fd\u5b8c\u6210\u4e86\u4ea4\u6362\u3002</p> <p>n \u53d1\u9001\u8005\u68c0\u67e5Credit\uff1a\u5728\u53d1\u9001\u8005\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2aTLP\u4e4b\u524d\uff0c\u5b83\u9700\u8981\u68c0\u67e5\u6d41\u91cf\u63a7\u5236\u8ba1\u6570\u5668\uff08Flow Control Counter\uff09\uff0c\u4ee5\u6b64\u6765\u77e5\u9053\u5bf9\u65b9\u662f\u5426\u6709\u8db3\u591f\u7684credit\u3002\u5982\u679ccredit\u6570\u91cf\u8db3\u591f\uff0c\u90a3\u4e48\u5c31\u5c06TLP\u8f6c\u53d1\u81f3\u6570\u636e\u94fe\u8def\u5c42\uff0c\u4f46\u662f\u5982\u679ccredit\u4e0d\u8db3\uff0c\u90a3\u4e48TLP\u7684\u53d1\u9001\u64cd\u4f5c\u5c31\u4f1a\u88ab\u963b\u585e\u76f4\u81f3\u83b7\u77e5\u7684\u66f4\u591a\u7684\u8db3\u591f\u7684\u6d41\u91cf\u63a7\u5236credit\u3002</p> <p></p> <p>\u56fe 6\u20111\u6d41\u91cf\u63a7\u5236\u903b\u8f91\u6240\u5904\u7684\u4f4d\u7f6e</p>"},{"location":"pcie/all/#62-buffercreditflow-control-buffer-and-credits","title":"6.2 \u6d41\u91cf\u63a7\u5236Buffer\u548cCredit\uff08Flow Control Buffer and Credits\uff09","text":"<p>\u4e00\u4e2a\u7aef\u53e3\u6240\u652f\u6301\u7684\u6bcf\u4e2aVC\uff08Virtual Channel\uff09\u8d44\u6e90\u90fd\u4f1a\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236Buffer\u3002\u56de\u60f3\u4e00\u4e0b\uff0c\u94fe\u8def\u4e24\u7aef\u7684\u7aef\u53e3\u53ef\u80fd\u652f\u6301\u7684VC\u6570\u91cf\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u6b64\u7531\u8f6f\u4ef6\u8fdb\u884c\u914d\u7f6e\u548c\u542f\u7528\u7684VC\u7684\u6700\u5927\u6570\u91cf\u5c31\u662f\u4e24\u4e2a\u7aef\u53e3\u95f4\u7684\u6700\u5927\u516c\u5171VC\u6570\u91cf\u3002</p>"},{"location":"pcie/all/#621-vcbuffervc-flow-control-buffer-organization","title":"6.2.1     VC\u6d41\u91cf\u63a7\u5236Buffer\u7684\u7ec4\u6210\uff08VC Flow Control Buffer Organization\uff09","text":"<p>\u63a5\u6536\u8005\u7684\u6bcf\u4e2aVC\u6d41\u63a7buffer\u662f\u6309\u7167\u901a\u8fc7VC\u7684\u6bcf\u79cd\u4e8b\u52a1\u7c7b\u522b\u6765\u8fdb\u884c\u7ba1\u7406\u7684\u3002\u8fd9\u4e9b\u7c7b\u522b\u4e3a\uff1a</p> <p>n Posted\u4e8b\u52a1\u2014\u2014MWr\uff08Memory Write\uff09\u548cMessage</p> <p>n Non-Posted\u4e8b\u52a1\u2014\u2014MRd\uff08Memory Read\uff09\u3001\u914d\u7f6e\u8bfb/\u5199\u3001IO\u8bfb/\u5199</p> <p>n \u5b8c\u6210\u5305\u2014\u2014\u8bfb\u548c\u5199\u5b8c\u6210\u5305</p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u6bcf\u4e2a\u65e2\u6709Header\u4e5f\u6709\u6570\u636e\u8377\u8f7d\u7684\u4e8b\u52a1\u7c7b\u522b\uff0c\u90fd\u4f1a\u88ab\u5206\u6210Header\u548c\u6570\u636e\u4e24\u90e8\u5206\u3002\u8fd9\u5c06\u4ea7\u51fa6\u79cd\u4e0d\u540c\u7684Buffer\uff0c\u6bcf\u4e2aBuffer\u90fd\u5b9e\u73b0\u81ea\u5df1\u7684\u6d41\u63a7\u3002\uff08\u89c1\u56fe 6\u20112\uff09\u3002</p> <p></p> <p>\u56fe 6\u20112\u6d41\u63a7Buffer\u7ec4\u6210</p> <p>\u5bf9\u4e8e\u6709\u4e9b\u4e8b\u52a1\uff0c\u4f8b\u5982\u8bfb\u8bf7\u6c42\uff0c\u5b83\u53ea\u7531Header\u7ec4\u6210\uff0c\u800c\u50cf\u5199\u8bf7\u6c42\u5c31\u65e2\u6709Header\u4e5f\u6709\u6570\u636e\u8377\u8f7d\u3002\u53d1\u9001\u8005\u5fc5\u987b\u786e\u8ba4Header\u7684Buffer\u7a7a\u95f4\u548c\u6570\u636e\u8377\u8f7d\u7684Buffer\u7a7a\u95f4\u90fd\u6ee1\u8db3\u4e86\u4e8b\u52a1\u4f20\u8f93\u7684\u9700\u6c42\uff0c\u624d\u80fd\u53d1\u9001\u4e8b\u52a1\u3002\u6ce8\u610f\uff0c\u5f53\u4e8b\u52a1\u88ab\u8f6c\u53d1\u81f3\u8f6f\u4ef6\u6216\u8005\u662f\u5728Switch\u4e2d\u88ab\u8f6c\u53d1\u81f3\u51fa\u53e3\u7aef\u53e3\u65f6\uff0c\u5fc5\u987b\u5728VC\u6d41\u63a7Buffer\u4e2d\u4fdd\u6301\u4e8b\u52a1\u987a\u5e8f\u3002\u56e0\u6b64\uff0c\u63a5\u6536\u8005\u4e5fbiubiu\u8ddf\u8e2aBuffer\u5185\u7684Header\u548c\u6570\u636e\u8377\u8f7d\u7684\u987a\u5e8f\u3002</p>"},{"location":"pcie/all/#622-creditflow-control-credits","title":"6.2.2     \u6d41\u63a7Credit\uff08Flow Control Credits\uff09","text":"<p>\u63a5\u6536\u8005\u9700\u8981\u62a5\u544aBuffer\u7a7a\u95f4\u7684\u5927\u5c0f\uff0c\u4f7f\u7528\u7684\u5355\u4f4d\u662fCredit\uff0c\u6216\u8005\u53eb\u6d41\u91cf\u63a7\u5236Credit\u3002Header\u548c\u6570\u636e\u8377\u8f7dBuffer\u7684\u4e00\u4e2a\u6d41\u63a7Credit\uff08FCC\uff0cFlow Control Credit\uff09\u7684\u5927\u5c0f\u503c\u5206\u522b\u4e3a\uff1a</p> <p>n Header Credit\uff1aHeader\u5927\u5c0f\u7684\u6700\u5927\u503c+digest</p> <p>\u2014  \u5b8c\u6210\u5305\u4e3a4DW</p> <p>\u2014  \u8bf7\u6c42\u5305\u4e3a5DW</p> <p>n \u6570\u636eCredit\uff1a4DW\uff0816byte\u5bf9\u9f50\uff09</p> <p>\u6d41\u91cf\u63a7\u5236DLLP\u4f1a\u4f20\u8fbe\u8fd9\u4e2a\u4fe1\u606f\uff0c\u800cDLLP\u81ea\u8eab\u7684\u4f20\u8f93\u662f\u4e0d\u9700\u8981\u6d41\u63a7Credit\u7684\u3002\u8fd9\u662f\u56e0\u4e3aDLLP\u4ea7\u751f\u548c\u7ec8\u7ed3\u7684\u5730\u65b9\u90fd\u662f\u5728\u6570\u636e\u94fe\u8def\u5c42\uff0c\u5e76\u4e0d\u9700\u8981\u4f7f\u7528\u5230\u4e8b\u52a1\u5c42Buffer\u3002</p>"},{"location":"pcie/all/#63-initial-flow-control-advertisement","title":"6.3 \u521d\u59cb\u6d41\u91cf\u63a7\u5236\u901a\u544a\uff08Initial Flow Control Advertisement\uff09","text":"<p>\u5728\u6d41\u63a7\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\uff0cPCIe\u8bbe\u5907\u4eec\u4f1a\u901a\u8fc7\u5bf9Buffer\u7a7a\u95f4\u7684\u6d41\u63a7Credit\u8fdb\u884c\u201cadvertising\u901a\u544a\u201d\u7684\u65b9\u5f0f\uff0c\u6765\u76f8\u4e92\u4f20\u8fbe\u5404\u81ea\u7684Buffer\u5927\u5c0f\u3002PCIe\u4e5f\u4e13\u95e8\u5b9a\u4e49\u4e86\u4e00\u4e9bBuffer\u9700\u8981\u7684\u6d41\u63a7Credit\u521d\u59cb\u503c\u3002\u4e00\u4e2a\u901a\u544a\u8fc7\u81ea\u5df1\u7684\u521d\u59cbBuffer\u7a7a\u95f4\u7684\u63a5\u53d7\u8005\u53ef\u4ee5\u6709\u6548\u7684\u4fdd\u8bc1\u5b83\u7684Buffer\u7a7a\u95f4\u6c38\u8fdc\u4e0d\u4f1a\u6ea2\u51fa\u3002</p>"},{"location":"pcie/all/#631-minimum-and-maximum-flow-control-advertisement","title":"6.3.1     \u6d41\u63a7\u901a\u544a\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\uff08Minimum and Maximum Flow Control Advertisement\uff09","text":"<p>\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u5404\u79cd\u4e0d\u540c\u7684\u6d41\u63a7Buffer\u7c7b\u578b\u6240\u62a5\u544a\u7684Credit\u6570\u91cf\u7684\u6700\u5c0f\u503c\uff0c\u8868 6\u20111\u5217\u51fa\u4e86\u8fd9\u4e9bBuffer\u7c7b\u578b\u5bf9\u5e94\u7684Credit\u6700\u5c0f\u503c\u3002\u7136\u800c\uff0c\u8bbe\u5907\u4e00\u822c\u901a\u544a\u7684Credit\u6570\u91cf\u4f1a\u8fdc\u5927\u4e8e\u6700\u5c0f\u503c\uff0c\u8868 6\u20112\u5217\u51fa\u4e86\u534f\u8bae\u6240\u5141\u8bb8\u7684Credit\u6570\u91cf\u901a\u544a\u7684\u6700\u5927\u503c\u3002</p> Credit\u7c7b\u578b \u901a\u544a\uff08Advertisement\uff09\u6700\u5c0f\u503c Posted  Request Header  \uff08PH\uff09  Posted\u8bf7\u6c42Header 1\u5355\u4f4d\uff1a  Credit\u503c= 1\u4e2a4DW Header+Digest= 5DW Posted  Request Data  \uff08PD\uff09  Posted\u8bf7\u6c42\u6570\u636e \u8fd9\u4e2a\u503c\u662fMax_Payload_Size\u7684\u6700\u5927\u503c\u7528Credit\u7684\u8868\u793a\u3002  \u4f8b\u5982\uff1a\u5982\u679c\u652f\u6301\u7684\u6700\u5927\u7684Max_Payload_Size\u4e3a1024Byte\uff0c\u90a3\u4e48\u5141\u8bb8\u7684\u6700\u5c0f\u7684\u521d\u59cbCredit\u503c\u5c31\u662f040h\uff0864*16byte\uff09\u3002 Non-Posted  Request Header  \uff08NPH\uff09  Non-Posted\u8bf7\u6c42Header 1\u5355\u4f4d\uff1a  Credit\u503c= 1\u4e2a4DW Header+Digest= 5DW Non-Posted  Request Data  \uff08NPD\uff09  Non-Posted\u8bf7\u6c42\u6570\u636e 1\u5355\u4f4d\uff1a  Credit\u503c= 1\u4e2a4DW Header+Digest= 5DW  2\u5355\u4f4d\uff1a  \u5982\u679c\u63a5\u6536\u65b9\u652f\u6301AtomicOP\u8def\u7531\u6216\u8005\u5177\u6709\u4f5c\u4e3aAtomicOP\u5b8c\u6210\u8005\u7684\u80fd\u529b\uff0c\u90a3\u4e48Credit\u503c\u53ef\u4ee5\u4e3a02h\u3002 Completion  Header  \uff08CplH\uff09  \u5b8c\u6210\u5305Header 1\u5355\u4f4d\uff1a  Credit\u503c= 1\u4e2a3DW Header+Digest= 4DW\u3002\u8fd9\u79cd\u60c5\u51b5\u662f\u5bf9\u4e8e\u652f\u6301Peer-to-Peer\u7684RC\u548cSwitch\u3002  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cbCredit\u503c=\u51680\u3002\u5e94\u7528\u4e8e\u4e0d\u652f\u6301Peer-to-Peer\u7684RC\u548cEP\u3002 Completion  Data  \uff08CplD\uff09  \u5b8c\u6210\u5305\u6570\u636e n\u5355\u4f4d\uff1a  \u8fd9\u4e2a\u503c\u662fMax_Payload_Size\u6216\u8005\u662f\u8bfb\u8bf7\u6c42size\u8fd9\u4e8c\u8005\u53ef\u80fd\u7684\u6700\u5927\u503c\uff08\u4e00\u822c\u8bfb\u8bf7\u6c42size\u4f1a\u6bd4\u524d\u8005\u5c0f\uff09\u9664\u4ee5FC\u5355\u4f4d\u5927\u5c0f\uff084DW\uff09\u3002\u8fd9\u79cd\u60c5\u51b5\u662f\u5bf9\u4e8e\u652f\u6301Peer-to-Peer\u7684RC\u548cSwitch\u3002  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cbCredit\u503c=\u51680\u3002\u5e94\u7528\u4e8e\u4e0d\u652f\u6301Peer-to-Peer\u7684RC\u548cEP\u3002 <p>\u8868 6\u20111\u6d41\u63a7\u901a\u544a\u6700\u5c0f\u503c</p> Credit\u7c7b\u578b \u901a\u544a\uff08Advertisement\uff09\u6700\u5c0f\u503c Posted  Request Header  \uff08PH\uff09  Posted\u8bf7\u6c42Header 128\u5355\u4f4d\uff1a  128 Credits=128*5DW=2560 Bytes Posted  Request Data  \uff08PD\uff09  Posted\u8bf7\u6c42\u6570\u636e 2048\u5355\u4f4d\uff1a  \u503c\u4e3a\u8bbe\u5907\u652f\u6301\u591a\u6709Function\uff088\u4e2a\uff09\u7684Max_Payload_Size\uff084096 bytes\uff09\u603b\u548c,\u603b\u548c\u4e3a8*4096=32768,\u9664\u4ee5Credit\u5927\u5c0f\uff084DW\uff09\u3002  2048 Credits=2048*4DW=32768Bytes Non-Posted  Request Header  \uff08NPH\uff09  Non-Posted\u8bf7\u6c42Header 128\u5355\u4f4d\uff1a  128 Credits=128*5DW=2560 Bytes Non-Posted  Request Data  \uff08NPD\uff09  Non-Posted\u8bf7\u6c42\u6570\u636e \u4f5c\u8005\u65e0\u6cd5\u7ed9Non-Posted\u6570\u636e\u627e\u5230\u4e00\u4e2a\u51c6\u786e\u7684Credit\u6570\u91cf\u6700\u5927\u503c\u3002\u7ed9\u51fa\u7684\u5355\u7eaf\u6570\u636e\u7684Credit\u6570\u91cf\u6700\u5927\u503c\u4e3a2048\u3002\u7136\u800c\uff0c\u4e00\u79cd\u66f4\u5408\u7406\u7684\u8ba1\u7b97\u7684\u65b9\u6cd5\u662f\u4f7f\u7528Non-Posted Header\u6765\u9650\u5236\u5728128 Credits\u5185\uff0c\u56e0\u4e3aNon-Posted\u6570\u636e\u603b\u662f\u4e0eNon-Posted Header\u76f8\u5173\u8054\u3002 Completion  Header  \uff08CplH\uff09  \u5b8c\u6210\u5305Header 128\u5355\u4f4d\uff1a  128 Credits=128*4DW=2048 Bytes\u3002\u8fd9\u662f\u5bf9\u4e0d\u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\u7684\u9650\u5236\uff08\u4f8b\u5982\u652f\u6301Peer-to-Peer\u7684RC\u548cSwitch\uff09\u3002  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cbCredit\u503c=\u51680\u3002\u5e94\u7528\u4e8e\u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\uff08\u4f8b\u5982\u4e0d\u652f\u6301Peer-to-Peer\u7684RC\u548cEP\uff09\u3002 Completion  Data  \uff08CplD\uff09  \u5b8c\u6210\u5305\u6570\u636e 2048\u5355\u4f4d\uff1a  \u503c\u4e3a\u8bbe\u5907\u652f\u6301\u591a\u6709Function\uff088\u4e2a\uff09\u7684Max_Payload_Size\uff084096 bytes\uff09\u603b\u548c,\u603b\u548c\u4e3a8*4096=32768,\u9664\u4ee5Credit\u5927\u5c0f\uff084DW\uff09\u3002  2048 Credits=2048*4DW=32768Bytes  \u65e0\u9650\u6570\u91cf\uff1a\u521d\u59cbCredit\u503c=\u51680\u3002\u5e94\u7528\u4e8e\u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\uff08\u4f8b\u5982\u4e0d\u652f\u6301Peer-to-Peer\u7684RC\u548cEP\uff09\u3002 <p>\u8868 6\u20112\u6d41\u63a7\u901a\u544a\u6700\u5927\u503c</p>"},{"location":"pcie/all/#632-creditinfinite-credits","title":"6.3.2     \u65e0\u9650Credit\uff08Infinite Credits\uff09","text":"<p>\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u5982\u679c\u6d41\u63a7Credit\u503c\u4e3a00h\uff0c\u90a3\u4e48\u5176\u610f\u601d\u5c31\u662f\u62e5\u6709\u65e0\u9650\u591a\u7684Credit\u3002\u5728\u6d41\u63a7\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u4e0d\u4f1a\u518d\u8fdb\u884c\u4efb\u4f55\u7684\u901a\u544a\uff08advertisement\uff09\u3002\u53d1\u8d77\u4e8b\u52a1\u7684\u8bbe\u5907\u5fc5\u987b\u8981\u4fdd\u7559\u8db3\u591f\u7684buffer\u7a7a\u95f4\uff0c\u8fd9\u4e9bbuffer\u7a7a\u95f4\u7528\u6765\u5b58\u653e\u6267\u884c\u62c6\u5206\u4e8b\u52a1\uff08split transaction\uff09\u7684\u8fc7\u7a0b\u4e2d\u8fd4\u56de\u7684\u6570\u636e\u4ee5\u53ca\u72b6\u6001\u4fe1\u606f\u3002\u8fd9\u4e9b\u4e8b\u52a1\u7ec4\u5408\u5305\u62ec\uff1a</p> <p>n Non-Posted\u8bfb\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u6570\u636e</p> <p>n Non-Posted\u8bfb\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u72b6\u6001</p> <p>n Non-Posted\u5199\u8bf7\u6c42\u548c\u8fd4\u56de\u7684\u5b8c\u6210\u5305\u72b6\u6001</p>"},{"location":"pcie/all/#633-credit","title":"6.3.3     \u65e0\u9650Credit\u901a\u544a\u7684\u7279\u6b8a\u7528\u6cd5","text":"<p>\u534f\u8bae\u89c4\u8303\u6307\u51fa\uff0c\u5f53\u4e00\u4e2a\u8bbe\u5907\u53ea\u5b9e\u73b0\u4e86VC0\u65f6\uff0c\u9700\u8981\u6709\u4e00\u4e9b\u7279\u522b\u7684\u8003\u8651\u3002\u4f8b\u5982\uff0c\u4ec5\u6709\u7684\u4e24\u79cdPosted\u5199\u8bf7\u6c42\uff1aIO Write\u4e0eConfiguration Write\uff0c\u4e8c\u8005\u4ec5\u5141\u8bb8\u4f7f\u7528VC0\u3002\u56e0\u6b64\uff0cNon-Posted\u6570\u636ebuffer\u5e76\u4e0d\u4f1a\u88abVC1-VC7\u6240\u4f7f\u7528\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u4e3aVC1-VC7\u5ba3\u544a\u4e00\u4e2a\u65e0\u9650Credit\u503c\u3002\u7136\u800cNon-Posted Header\u4ecd\u7136\u9700\u8981\u8fdb\u884c\u64cd\u4f5c\uff0c\u6240\u4ee5Header Credit\u7684\u503c\u9700\u8981\u7ee7\u7eed\u66f4\u65b0\uff0c\u800c\u5e76\u975e\u4fdd\u6301\u65e0\u9650\u3002</p>"},{"location":"pcie/all/#64-flow-control-initialization","title":"6.4 \u6d41\u91cf\u63a7\u5236\u521d\u59cb\u5316\uff08Flow Control Initialization\uff09","text":""},{"location":"pcie/all/#641-general","title":"6.4.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5728\u53d1\u9001\u4efb\u4f55\u4e8b\u52a1\u4e4b\u524d\uff0c\u90fd\u9700\u8981\u8fdb\u884c\u6d41\u63a7\u521d\u59cb\u5316\uff08flow control initialization\uff09\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5728\u6d41\u63a7\u521d\u59cb\u5316\u6210\u529f\u5b8c\u6210\u4e4b\u524d\uff0cTLP\u662f\u4e0d\u80fd\u5728\u94fe\u8def\u4e0a\u8fdb\u884c\u53d1\u9001\u7684\u3002\u6d41\u63a7\u521d\u59cb\u5316\u4f1a\u53d1\u751f\u4e8e\u7cfb\u7edf\u4e2d\u7684\u6bcf\u4e00\u4e2a\u94fe\u8def\uff0c\u5176\u8fc7\u7a0b\u4e3b\u8981\u4e3a\u94fe\u8def\u4e24\u7aef\u8bbe\u5907\u4e4b\u95f4\u7684\u4e00\u6b21\u63e1\u624b\u3002\u8fd9\u4e00\u8fc7\u7a0b\u4f1a\u5728\u7269\u7406\u5c42\u7684\u94fe\u8def\u8bad\u7ec3\uff08link training\uff09\u5b8c\u6210\u540e\u5c31\u5f00\u59cb\u8fdb\u884c\u3002\u94fe\u8def\u5c42\u4ece\u56fd\u89c2\u5bdfLinkUp\u4fe1\u53f7\u662f\u5426\u6709\u6548\u5c31\u53ef\u4ee5\u77e5\u9053\u7269\u7406\u5c42\u4f55\u65f6\u5904\u4e8eReady\u72b6\u6001\uff0c\u5982\u56fe 6\u20113\u6240\u793a\u3002</p> <p></p> <p>\u56fe 6\u20113\u7269\u7406\u5c42\u62a5\u544a\u81ea\u5df1\u5df2\u7ecfReady</p> <p>\u4e00\u65e6\u6d41\u91cf\u63a7\u5236\u521d\u59cb\u5316\u5f00\u59cb\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8fc7\u7a0b\u4ece\u6839\u672c\u4e0a\u6765\u8bf4\u5728\u5404\u4e2a\u865a\u62df\u901a\u9053\uff08VC\uff09\u4e0a\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5f53\u4e00\u4e2aVC\u88ab\u542f\u7528\u65f6\uff0c\u786c\u4ef6\u5c31\u8d1f\u8d23\u63a7\u5236\u5b83\u7684\u6d41\u91cf\u63a7\u5236\u521d\u59cb\u5316\u8fc7\u7a0b\u3002VC0\u9ed8\u8ba4\u603b\u662f\u542f\u7528\uff0c\u56e0\u6b64\u5b83\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u662f\u81ea\u52a8\u7684\u3002\u8fd9\u4f7f\u5f97\u914d\u7f6e\u4e8b\u52a1\u53ef\u4ee5\u904d\u5386\u6574\u4e2a\u62d3\u6251\u7ed3\u6784\uff0c\u5e76\u8fdb\u884c\u679a\u4e3e\u8fc7\u7a0b\u3002\u5176\u4ed6\u7684VC\u53ea\u6709\u5728\u914d\u7f6e\u8f6f\u4ef6\u5bf9\u94fe\u8def\u4e24\u7aef\u90fd\u8fdb\u884c\u4e86\u8bbe\u7f6e\u5e76\u4e14\u542f\u7528\u5b83\u4eec\u4e4b\u540e\u624d\u4f1a\u8fdb\u884c\u521d\u59cb\u5316\u3002</p>"},{"location":"pcie/all/#642-the-fc-initialization-sequence","title":"6.4.2     \u6d41\u63a7\u521d\u59cb\u5316\u6d41\u7a0b\uff08The FC Initialization Sequence\uff09","text":"<p>\u6d41\u63a7\u521d\u59cb\u5316\u8fc7\u7a0b\u6d89\u53ca\u5230\u94fe\u8def\u5c42\u7684DLCMSM\uff08Data Link Control and Management State Machine\uff0c\u6570\u636e\u94fe\u8def\u63a7\u5236\u4e0e\u7ba1\u7406\u72b6\u6001\u673a\uff09\u3002\u5982\u56fe 6\u20114\u6240\u793a\uff0c\u590d\u4f4d\u540e\u72b6\u6001\u673a\u5c06\u5904\u4e8eDL_Inactive\u72b6\u6001\u3002\u5728DL_Inactive\u72b6\u6001\u4e2d\uff0c\u4f1a\u53d1\u51faDL_Down\u4fe1\u53f7\uff0c\u8fd9\u4e2a\u4fe1\u53f7\u4f1a\u4f5c\u7528\u4e8e\u94fe\u8def\u5c42\u548c\u4e8b\u52a1\u5c42\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u4e5f\u4f1a\u5728\u6b64\u72b6\u6001\u4e2d\u7b49\u5f85\u7269\u7406\u5c42\u7684LinkUp\u4fe1\u53f7\uff0c\u6b64\u4fe1\u53f7\u662f\u7528\u4e8e\u8868\u793aLTSSM\uff08Link Training and Status State Machine\uff0c\u94fe\u8def\u8bad\u7ec3\u548c\u72b6\u6001\u72b6\u6001\u673a\uff09\u5df2\u7ecf\u5b8c\u6210\u4e86\u5de5\u4f5c\uff0c\u4e5f\u5c31\u662f\u7269\u7406\u5c42\u5df2\u7ecf\u5904\u4e8eReady\u72b6\u6001\u3002\u5f53\u7269\u7406\u5c42Ready\u540e\uff0c\u5c06\u4f1a\u4f7f\u5f97DLCMSM\u8df3\u8f6c\u81f3DL_Init\u72b6\u6001\uff0c\u5b83\u5305\u542b\u4e24\u7ea7\u5b50\u72b6\u6001\u7528\u4e8e\u5904\u7406\u6d41\u63a7\u521d\u59cb\u5316\uff1aFC_INIT1\u548cFC_INIT2\u3002</p> <p></p> <p>\u56fe 6\u20114 DLCMSM\u6570\u636e\u94fe\u8def\u63a7\u5236\u4e0e\u7ba1\u7406\u72b6\u6001\u673a</p>"},{"location":"pcie/all/#643-fc_init1fc_init1-details","title":"6.4.3     FC_Init1\u8be6\u7ec6\u8bf4\u660e\uff08FC_Init1 Details\uff09","text":"<p>\u5728FC_Init1\u72b6\u6001\u4e2d\uff0c\u8bbe\u5907\u4f1a\u8fde\u7eed\u7684\u53d1\u9001\u4e00\u7cfb\u5217\u76843\u79cdInitFC1\u6d41\u63a7DLLP\u6765\u901a\u544a\u5b83\u7684\u63a5\u6536Buffer\u5927\u5c0f\uff08\u89c1\u56fe 6\u20115\uff09\u3002\u6839\u636e\u534f\u8bae\u89c4\u8303\uff0c\u6570\u636e\u5305\u5fc5\u987b\u6309\u7167\u8fd9\u6837\u7684\u987a\u5e8f\u6765\u8fdb\u884c\u53d1\u9001\uff1aPosted\uff0cNon-Posted\uff0cCompletion\u5b8c\u6210\u5305\uff0c\u5982\u56fe 6\u20116\u6240\u793a\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u5f3a\u70c8\u5efa\u8bae\u9891\u7e41\u7684\u91cd\u590d\u8fd9\u4e9bDLLP\u7684\u53d1\u9001\uff0c\u8fd9\u4f1a\u4f7f\u63a5\u6536\u8bbe\u5907\u80fd\u591f\u66f4\u5bb9\u6613\u7684\u53d1\u73b0\u5b83\u4eec\uff0c\u7279\u522b\u662f\u5728\u5f53\u524d\u6ca1\u6709TLP\u6216\u8005DLLP\u9700\u8981\u53d1\u9001\u7684\u60c5\u51b5\u4e0b\u3002\u6bcf\u4e2a\u8bbe\u5907\u90fd\u9700\u8981\u4ece\u5bf9\u7aef\u8bbe\u5907\u63a5\u6536\u5230\u8fd9\u4e00\u7cfb\u5217DLLP\uff0c\u8fd9\u6837\u5b83\u624d\u53ef\u4ee5\u5c06\u5bf9\u7aef\u8bbe\u5907\u7684Buffer\u7a7a\u95f4\u5927\u5c0f\u5bc4\u5b58\u4e0b\u6765\u3002\u4e00\u65e6\u8bbe\u5907\u5df2\u7ecf\u53d1\u9001\u51fa\u4e86\u81ea\u8eab\u7684Buffer\u7a7a\u95f4\u5927\u5c0f\u7684\u503c\uff0c\u5e76\u4e14\u63a5\u6536\u5230\u4e86\u8db3\u591f\u6b21\u6570\u7684\u5b8c\u6574\u7684DLLP\u5e8f\u5217\uff0c\u6240\u8c13\u8db3\u591f\u6b21\u6570\u5c31\u662f\u8bbe\u5907\u8db3\u4ee5\u76f8\u4fe1\u63a5\u6536\u5230\u7684\u5bf9\u7aefBuffer\u5927\u5c0f\u7684\u503c\u662f\u6b63\u786e\u7684\uff0c\u90a3\u4e48\u6b64\u65f6\u8bbe\u5907\u5c31\u5df2\u7ecf\u53ef\u4ee5\u8df3\u51faFC_INIT1\u72b6\u6001\u4e86\u3002\u8981\u8fdb\u884c\u8df3\u51fa\u7684\u64cd\u4f5c\uff0c\u8bbe\u5907\u9700\u8981\u5c06\u63a5\u6536\u5230\u7684\u503c\u8bb0\u5f55\u5728\u4f20\u8f93\u8ba1\u6570\u5668\uff08transmit counter\uff09\u4e2d\uff0c\u7f6e\u8d77\u4e00\u4e2a\u5185\u90e8\u7684flag\u4fe1\u53f7\uff08FL1\uff09\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u8df3\u8f6c\u5230FC_INIT2\u72b6\u6001\u6765\u8fdb\u884c\u521d\u59cb\u5316\u64cd\u4f5c\u4e2d\u7684\u7b2c\u4e8c\u6b65\u3002</p> <p></p> <p>\u56fe 6\u20115 INIT1\u6d41\u63a7DLLP\u683c\u5f0f\u53ca\u5185\u5bb9</p> <p></p> <p>\u56fe 6\u20116\u8bbe\u5907\u5728DL_Init\u72b6\u6001\u4e0b\u53d1\u9001InitFC1 DLLP</p>"},{"location":"pcie/all/#644-fc_init2fc_init2-details","title":"6.4.4     FC_Init2\u8be6\u7ec6\u8bf4\u660e\uff08FC_Init2 Details\uff09","text":"<p>\u5728FC_Init2\u8fd9\u4e2a\u72b6\u6001\u4e2d\uff0c\u8bbe\u5907\u9700\u8981\u8fde\u7eed\u7684\u53d1\u9001InitFC2 DLLP\u3002\u53d1\u9001DLLP\u7684\u987a\u5e8f\u548cFC_Init1\u4e2d\u4e00\u6837\uff0c\u5e76\u4e14\u5176\u4e2d\u4e5f\u5305\u542b\u4e86\u76f8\u540c\u7684\u6709\u5173Credit\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u8fd9\u4e9bDLLP\u8fd8\u6709\u4e00\u4e2a\u4f5c\u7528\u5c31\u662f\u53d1\u9001\u65b9\u7528\u6765\u786e\u8ba4\u6d41\u63a7\u521d\u59cb\u5316\uff08FC initialization\uff09\u5df2\u7ecf\u6210\u529f\u3002\u7531\u4e8e\u8bbe\u5907\u5728FC_Init1\u72b6\u6001\u4e2d\u5c31\u5df2\u7ecf\u5bc4\u5b58\u4e86\u5bf9\u7aef\u7684\u53ef\u7528Buffer\u503c\uff0c\u56e0\u6b64\u5b83\u4e0d\u5728\u9700\u8981\u4efb\u4f55\u5173\u4e8eCredit\u6570\u91cf\u7684\u4fe1\u606f\uff0c\u5b83\u5728\u7b49\u5f85InitFC2 DLLP\u65f6\u4f1a\u5ffd\u7565\u4f20\u6765\u7684\u6240\u6709InitFC1 DLLP\u3002\u5c3d\u7ba1\u5bf9\u4e8e\u94fe\u8def\u53e6\u4e00\u7aef\u8bbe\u5907\u6765\u8bf4\u6b64\u65f6\u5e76\u6ca1\u6709\u5b8c\u6210\u521d\u59cb\u5316\uff0c\u521d\u59cb\u5316\u7684\u5b8c\u6210\u4e0e\u5426\u662f\u901a\u8fc7DL_Up\u4fe1\u53f7\u6765\u5bf9\u4e8b\u52a1\u5c42\u8fdb\u884c\u6307\u793a\u7684\uff0c\u4f46\u662f\u8bbe\u5907\u53ef\u4ee5\u5728\u6b64\u65f6\u53d1\u9001TLP\u3002\uff08\u89c1\u56fe 6\u20117\uff09</p> <p>\u4f60\u53ef\u80fd\u4f1a\u6709\u7591\u95ee\uff0c\u521d\u59cb\u5316\u8fc7\u7a0b\u4e3a\u4ec0\u4e48\u8fd8\u9700\u8981\u8fd9\u4e2a\u7b2c\u4e8c\u6b65\u5462\uff1f\u4e00\u4e2a\u7b80\u5355\u7684\u56de\u7b54\u662f\uff1a\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u5728\u5b8c\u6210\u6d41\u63a7\u521d\u59cb\u5316\uff08FC Initialization\uff09\u65f6\u9700\u8981\u7684\u65f6\u95f4\u53ef\u80fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u800c\u8fd9\u6837\u4e24\u6b65\u7684\u65b9\u6cd5\u53ef\u4ee5\u786e\u4fdd\u5728\u8f83\u5feb\u7684\u8bbe\u5907\u5b8c\u6210\u521d\u59cb\u5316\u540e\uff0c\u8f83\u6162\u7684\u90a3\u4e00\u7aef\u4f9d\u7136\u80fd\u591f\u7ee7\u7eed\u63a5\u6536\u5230\u9700\u8981\u7684\u6d41\u63a7\u4fe1\u606f\uff08FC Information\uff09\u3002\u4e00\u65e6\u4e00\u4e2a\u8bbe\u5907\u63a5\u6536\u5230\u4e86\u4efb\u610fBuffer\u79cd\u7c7b\u7684FC_INIT2\u6570\u636e\u5305\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u7f6e\u8d77\u4e00\u4e2a\u5185\u90e8\u7684flag\uff08FL2\uff09\u3002\uff08\u8fd9\u4e2a\u64cd\u4f5c\u4e0d\u9700\u8981\u7b49\u5f85\u63a5\u6536\u5230\u6240\u6709\u79cd\u7c7b\u7684FC_INIT2\u6570\u636e\u5305\uff09\u6ce8\u610f\uff0cFL2\u4e5f\u662f\u5728\u63a5\u6536\u5230\u4e00\u4e2aUpdateFC\u5305\u6216\u8005TLP\u4e4b\u540e\u624d\u88ab\u7f6e\u8d77\u7684\u3002\u5f53\u94fe\u8def\u4e24\u7aef\u7684\u8bbe\u5907\u90fd\u5b8c\u6210\u4e86\u8fd9\u4e9b\u6b65\u9aa4\u5e76\u4e14\u90fd\u53d1\u9001\u51fa\u4e86InitFC2 DLLP\u4e4b\u540e\uff0cDLCMSM\u5c06\u4f1a\u8df3\u8f6c\u81f3DL_Active\u72b6\u6001\uff0c\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u94fe\u8def\u5c42\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u6267\u884c\u5e38\u89c4\u7684\u64cd\u4f5c\uff0c\u94fe\u8def\u5c42\u521d\u59cb\u5316\u5b8c\u6210\u3002</p> <p></p> <p>\u56fe 6\u20117 FC\u503c\u5df2\u7ecf\u5bc4\u5b58-\u63a5\u4e0b\u6765\u53d1\u9001InitFC2\u5e76\u62a5\u544aDL_Up</p>"},{"location":"pcie/all/#645-fc_init1fc_init2rate-of-fc_init1-and-fc_init2-transmission","title":"6.4.5     FC_INIT1\u548cFC_INIT2\u7684\u4f20\u8f93\u901f\u7387\uff08Rate of FC_INIT1 and FC_INIT2 Transmission\uff09","text":"<p>\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u4e86\u53d1\u9001FC_INIT DLLP\u4e4b\u95f4\u7684\u5ef6\u65f6\uff0c\u5982\u4e0b\uff1a</p> <p>n VC0\uff1a\u57fa\u4e8e\u786c\u4ef6\u8fdb\u884c\u6d41\u63a7\u7684VC0\u8981\u6c42FC_INIT1\u5305\u548cFC_INIT2\u5305\u8981 \u201c\u8fde\u7eed\u5730\u4ee5\u5c3d\u53ef\u80fd\u5927\u7684\u901f\u7387\u201d\u8fdb\u884c\u4f20\u8f93\u3002\u4e5f\u5c31\u662f\u8bf4\u91cd\u53d1\u8ba1\u65f6\u5668\uff08resend timer\uff09\u8bbe\u7f6e\u7684\u91cd\u53d1\u95f4\u9694\u503c\u4e3a0\u3002</p> <p>n VC1-VC7\uff1a\u5f53\u8f6f\u4ef6\u542f\u52a8\u4e86\u5176\u4ed6VC\uff08VC0\u4e4b\u5916\uff09\u7684\u6d41\u63a7\u521d\u59cb\u5316\u65f6\uff0cFC_INIT DLLP\u5e8f\u5217\u9700\u8981\u5728\u201c\u5f53\u6ca1\u6709\u5176\u4ed6TLP\u6216\u8005DLLP\u9700\u8981\u4f20\u8f93\u65f6\u201d\u88ab\u91cd\u590d\u53d1\u9001\u3002\u7136\u800c\u9700\u8981\u6ce8\u610f\uff0c\u4e24\u7ec4DLLP\u5e8f\u5217\u53d1\u9001\u7684\u8d77\u59cb\u65f6\u523b\u6700\u591a\u53ea\u80fd\u95f4\u969417us\u3002</p>"},{"location":"pcie/all/#646","title":"6.4.6     \u6d41\u63a7\u521d\u59cb\u5316\u534f\u8bae\u8fdd\u4f8b","text":"<p>\u8bbe\u5907\u5bf9\u6d41\u63a7\u521d\u59cb\u5316\u534f\u8bae\u8fdd\u4f8b\u7684\u68c0\u6d4b\u662f\u53ef\u9009\u7684\u3002\u68c0\u6d4b\u5230\u7684\u9519\u8bef\u53ef\u4ee5\u4f5c\u4e3a\u6570\u636e\u94fe\u8def\u5c42\u534f\u8bae\u9519\u8bef\u8fdb\u884c\u62a5\u544a\u3002</p>"},{"location":"pcie/all/#65-introduction-to-flow-control-mechanism","title":"6.5 \u6d41\u63a7\u673a\u5236\u7684\u4ecb\u7ecd\uff08Introduction to Flow Control Mechanism\uff09","text":""},{"location":"pcie/all/#651-general","title":"6.5.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u6d41\u91cf\u63a7\u5236\u673a\u5236\u6240\u8981\u6c42\u7684\u5bc4\u5b58\u5668\u3001\u8ba1\u6570\u5668\uff0c\u4ee5\u53ca\u4e00\u7cfb\u5217\u7684\u673a\u5236\u7528\u4e8e\u62a5\u544a\uff08reporting\uff09\u3001\u8ffd\u8e2a\uff08tracking\uff09\u548c\u8ba1\u7b97\uff08calculating\uff09\u4e00\u4e2a\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u88ab\u53d1\u51fa\u3002\u8fd9\u4e9b\u5143\u7d20\u5e76\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u5b83\u4eec\u7684\u5b9e\u9645\u5b9e\u73b0\u662f\u7531\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u6765\u51b3\u5b9a\u7684\u3002\u672c\u8282\u5c06\u4ecb\u7ecd\u534f\u8bae\u89c4\u8303\u6a21\u578b\uff0c\u5e76\u89e3\u91ca\u76f8\u5173\u6982\u5ff5\u548c\u5bf9\u9700\u6c42\u8fdb\u884c\u5b9a\u4e49\u3002</p>"},{"location":"pcie/all/#652-the-flow-control-elements","title":"6.5.2     \u6d41\u63a7\u76f8\u5173\u5143\u7d20\uff08The Flow Control Elements\uff09","text":"<p>\u56fe 6\u20118\u8bf4\u660e\u4e86\u7528\u4e8e\u7ba1\u7406\u6d41\u91cf\u63a7\u5236\u7684\u5143\u7d20\u3002\u56fe\u4e2d\u5c55\u793a\u4e86\u5728\u8fde\u8def\u4e0a\u5355\u5411\u4f20\u8f93\u7684\u4e8b\u52a1\uff0c\u800c\u53e6\u4e00\u7ec4\u8fd9\u4e9b\u6d41\u63a7\u5143\u7d20\u5219\u652f\u6301\u76f8\u53cd\u65b9\u5411\u7684\u4f20\u8f93\u3002\u6bcf\u4e2a\u5143\u7d20\u7684\u4e3b\u8981\u529f\u80fd\u90fd\u4f1a\u518d\u4e0b\u9762\u7684\u5185\u5bb9\u4e2d\u5217\u51fa\u3002\u867d\u7136\u5bf9\u4e8e\u5168\u90e8\u76846\u79cd\u63a5\u6536buffer\u90fd\u91cd\u590d\u6709\u8fd9\u4e9b\u6d41\u63a7\u5143\u7d20\uff0c\u4f46\u662f\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u5728\u672c\u4f8b\u5b50\u4e2d\u4ec5\u8003\u8651Non-Posted Header\u6d41\u63a7\u3002</p> <p>\u4e0e\u7ba1\u7406\u6d41\u63a7\u76f8\u5173\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u662f\u6d41\u63a7\u66f4\u65b0DLLP\uff08Flow Control Update\uff09\uff0c\u5b83\u4e5f\u662f\u5728\u94fe\u8def\u6b63\u5e38\u4f20\u8f93\u671f\u95f4\u552f\u4e00\u53ef\u4f7f\u7528\u7684\u6d41\u63a7\u5305\u3002FC Update\u5305\u7684\u683c\u5f0f\u5982\u56fe 6\u20119\u6240\u793a</p> <p></p> <p>\u56fe 6\u20118\u6d41\u63a7\u5143\u7d20</p>"},{"location":"pcie/all/#6521-transmitter-elements","title":"6.5.2.1   \u53d1\u9001\u65b9\u6d41\u63a7\u5143\u7d20\uff08Transmitter Elements\uff09","text":"<p>n \u4e8b\u52a1\u7b49\u5f85\u7f13\u51b2\u533a\uff08Transactions Pending Buffer\uff09\uff1a\u628a\u5c06\u8981\u53d1\u9001\u8fdb\u7edf\u4e00\u865a\u62df\u901a\u9053\u7684\u4e8b\u52a1\u6682\u5b58\u8d77\u6765\u3002</p> <p>n Credit\u6d88\u8017\u8ba1\u6570\u5668\uff08Credits Consumed counter\uff09\uff1a\u8be5\u8ba1\u6570\u5668\u662f\u8bb0\u5f55\u53d1\u9001\u7ed9\u5bf9\u7aef\u5f53\u524d\u7c7b\u578bBuffer\u7684\u6240\u6709\u4e8b\u52a1\u7684Credit\u603b\u548c\uff08\u4e5f\u5c31\u662f\u6d88\u8017\u4e86\u63a5\u6536\u7aef\u591a\u5c11Credit\uff09\uff0c\u8fd9\u4e2a\u8ba1\u6570\u503c\u4e5f\u53ef\u4ee5\u88ab\u7f29\u5199\u6210\u201cCC\u201d\u3002</p> <p>n Credit\u989d\u5ea6\u8ba1\u6570\u5668\uff08Credit Limit count\uff09\uff1a\u8be5\u8ba1\u6570\u5668\u7684\u521d\u59cb\u503c\u7531\u5bf9\u7aef\u63a5\u6536\u8005\u76f8\u5e94\u7c7b\u578b\u7684Buffer\u5927\u5c0f\u800c\u51b3\u5b9a\u3002\u5728\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u5bf9\u7aef\u63a5\u6536\u8005\u4f1a\u5b9a\u671f\u7684\u53d1\u9001\u6d41\u63a7\u66f4\u65b0\u5305\uff08FC Update\uff09\uff0c\u4ee5\u4fbf\u5728\u63a5\u6536\u65b9Buffer\u53ef\u7528\u65f6\u66f4\u65b0\u6d41\u63a7Credit\u3002\u8fd9\u4e2a\u503c\u53ef\u4ee5\u88ab\u7f29\u5199\u4e3a\u201cCL\u201d\u3002</p> <p>n \u6d41\u63a7\u95e8\u63a7\u903b\u8f91\uff08Flow Control Gating Logic\uff09\uff1a\u5b83\u7528\u4e8e\u8fdb\u884c\u8ba1\u7b97\u6765\u786e\u5b9a\u5bf9\u7aef\u63a5\u53d7\u8005\u662f\u5426\u6709\u8db3\u591f\u7684\u6d41\u63a7Credit\u6765\u63a5\u6536\u7b49\u5f85\u53d1\u9001\u4e2d\u7684TLP\uff08Pending TLP\uff0cPTLP\uff09\u3002\u672c\u8d28\u4e0a\u6765\u8bf4\uff0c\u8fd9\u4e2a\u903b\u8f91\u5c31\u662f\u68c0\u67e5CREDITS_CONSUMED\uff08CC\uff09\u52a0\u4e0a\u4e0b\u4e00\u4e2aPTLP\u6240\u9700\u8981\u6d88\u8017\u7684Credit\u662f\u5426\u5927\u4e8eCREDIT_LIMIT\uff08CL\uff09\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u4e86\u4e0b\u9762\u7684\u65b9\u7a0b\uff0c\u4ee5\u6b64\u6765\u5b8c\u6210\u4e0a\u8ff0\u7684\u68c0\u67e5\uff0c\u65b9\u7a0b\u4e2d\u6240\u6709\u7684\u503c\u7684\u5355\u4f4d\u90fd\u662fCredit\u3002</p> <p></p> <p>\u5173\u4e8e\u5e94\u7528\u6b64\u65b9\u7a0b\u5f0f\u7684\u4f8b\u5b50\uff0c\u8bf7\u53c2\u9605\u201cStage 1 \u2013 Flow Control Following Initialization\u201d\u4e00\u8282\u3002</p>"},{"location":"pcie/all/#6522-receiver-elements","title":"6.5.2.2   \u63a5\u6536\u65b9\u6d41\u63a7\u5143\u7d20\uff08Receiver Elements\uff09","text":"<p>n \u6d41\u63a7\u7f13\u51b2\u533a\uff08Flow Control Buffer\uff09\uff1a\u50a8\u5b58\u8f93\u5165\u7684Header\u6216\u8005\u6570\u636e\u3002</p> <p>n Credit\u5206\u914d\u8ba1\u6570\uff08Credit Allocated\uff09\uff1a\u8bb0\u5f55\u5df2\u5206\u914d\uff08\u53ef\u7528\uff09\u7684\u5168\u90e8\u7684\u6d41\u63a7Credit\u6570\u91cf\u3002\u5b83\u662f\u7531\u786c\u4ef6\u8fdb\u884c\u521d\u59cb\u5316\u7684\uff0c\u53cd\u6620\u4e86\u5df2\u5206\u914d\u7684\u6d41\u63a7Buffer\u7684\u5927\u5c0f\u3002\u8fd9\u4e9bBuffer\u4f1a\u5728\u4e8b\u52a1\u5230\u8fbe\u65f6\u88ab\u586b\u5145\uff0c\u4f46\u662f\u586b\u5145\u8fdb\u53bb\u7684\u4e8b\u52a1\u6700\u7ec8\u90fd\u4f1a\u88ab\u63a5\u6536\u7aef\u53d6\u51fa\uff0c\u4e5f\u5c31\u662f\u4eceBuffer\u4e2d\u79fb\u9664\u3002\u5f53\u5b83\u4eec\u88ab\u79fb\u9664\u65f6\uff0c\u8fd9\u90e8\u5206\u7684Buffer\u7a7a\u95f4Credit\u6570\u91cf\u5c06\u4f1a\u88ab\u52a0\u5230CREDIT_ALLOCATED\u8ba1\u6570\u503c\u4e0a\u3002\u56e0\u6b64\u8fd9\u4e2a\u8ba1\u6570\u5668\u4f1a\u8bb0\u5f55\u5e76\u8868\u5f81\u5f53\u524d\u53ef\u7528\u7684Credit\u6570\u91cf\u3002</p> <p>n \u5df2\u63a5\u6536Credit\u8ba1\u6570\u5668\uff08Credit Received counter\uff0coptional\uff09\uff1a\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u9879\uff0c\u5b83\u7528\u4e8e\u8bb0\u5f55\u8fdb\u5165\u6d41\u63a7Buffer\u7684\u6240\u6709TLP\u7684\u603bCredit\u6570\u91cf\u3002\u5f53\u6d41\u63a7\u529f\u80fd\u6b63\u5e38\u65f6\uff0cCREDIT_RECEIVED\u8ba1\u6570\u503c\u5e94\u8be5\u5c0f\u4e8e\u7b49\u4e8eCREDIT_ALLOCTED\u8ba1\u6570\u503c\u3002\u5982\u679c\u5e76\u672a\u6ee1\u8db3\u8fd9\u4e8c\u8005\u7684\u201c\u5c0f\u4e8e\u7b49\u4e8e\u201d\u6761\u4ef6\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d1\u751fbuffer\u6ea2\u51fa\u5e76\u68c0\u6d4b\u5230\u51fa\u9519\u3002\u534f\u8bae\u89c4\u8303\u63a8\u8350\u8bbe\u8ba1\u8005\u5b9e\u73b0\u8fd9\u4e00\u53ef\u9009\u7684\u673a\u5236\uff0c\u5e76\u4e14\u9700\u8981\u6ce8\u610f\u7684\u662f\u8fd9\u91cc\u82e5\u51fa\u73b0\u8fdd\u4f8b\u5219\u5e94\u8be5\u5c06\u5176\u89c6\u4f5c\u662f\u4e00\u4e2aFatal Error\uff0c\u5373\u81f4\u547d\u7684\u9519\u8bef\uff08\u4e5f\u5c31\u662f\u975e\u5e38\u4e25\u91cd\u7684\u9519\u8bef\uff09\u3002</p> <p></p> <p>\u56fe 6\u20119\u6d41\u63a7DLLP\u7684\u7c7b\u578b\u548c\u5305\u683c\u5f0f</p>"},{"location":"pcie/all/#66-flow-control-example","title":"6.6 \u6d41\u63a7\u793a\u4f8b\uff08Flow Control Example\uff09","text":"<p>\u63a5\u4e0b\u6765\u5c06\u4f1a\u4ee5Non-Posted Header\u6d41\u63a7Buffer\u4f5c\u4e3a\u4f8b\u5b50\u8fdb\u884c\u8bb2\u89e3\uff0c\u5e76\u5c1d\u8bd5\u6355\u6349\u51fa\u5728\u591a\u79cd\u60c5\u51b5\u4e0b\u6d41\u63a7\u5b9e\u73b0\u7684\u7ec6\u5fae\u5dee\u522b\u3002\u5bf9\u6d41\u63a7\u7684\u8ba8\u8bba\u5c06\u4f1a\u5206\u4e3a\u5982\u4e0b\u51e0\u4e2a\u57fa\u672c\u9636\u6bb5\uff1a</p> <p>n \u9636\u6bb5\u4e00\uff1a\u5728\u521d\u59cb\u5316\u4e4b\u540e\u7d27\u8ddf\u7740\u4f20\u8f93\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u8ffd\u8e2a\uff0c\u4ee5\u6b64\u6765\u89e3\u91ca\u6d41\u63a7\u5143\u7d20\u4e2d\u7684\u8ba1\u6570\u5668\u548c\u5bc4\u5b58\u5668\u7684\u4e00\u4e9b\u57fa\u672c\u64cd\u4f5c\u3002</p> <p>n \u9636\u6bb5\u4e8c\uff1a\u53d1\u9001\u65b9\u53d1\u9001\u4e8b\u52a1\u7684\u901f\u5ea6\u5927\u4e8e\u63a5\u6536\u65b9\u80fd\u5904\u7406\u4e8b\u52a1\u7684\u901f\u5ea6\uff0c\u4f7f\u5f97\u63a5\u6536\u65b9Buffer\u88ab\u586b\u6ee1\u3002</p> <p>n \u9636\u6bb5\u4e09\uff1a\u5f53\u8ba1\u6570\u5668\u7ffb\u8f6c\u52300\uff08\u6301\u7eed\u589e\u5927\u540e\u56de\u52300\uff09\uff0c\u6d41\u63a7\u673a\u5236\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f46\u662f\u9700\u8981\u8003\u8651\u51e0\u4e2a\u95ee\u9898\u3002</p> <p>n \u9636\u6bb5\u56db\uff1a\u63a5\u6536\u65b9\u53ef\u4ee5\u5bf9Buffer\u6ea2\u51fa\u9519\u8bef\u8fdb\u884c\u68c0\u67e5\uff0c\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u9879\u3002</p>"},{"location":"pcie/all/#661-flow-control-following-initialization","title":"6.6.1     \u9636\u6bb5\u4e00\u2014\u2014\u521d\u59cb\u5316\u540e\u7684\u6d41\u63a7\uff08Flow Control Following Initialization\uff09","text":"<p>\u4e00\u65e6\u6d41\u63a7\u521d\u59cb\u5316\u5b8c\u6210\u540e\uff0c\u8bbe\u5907\u5c31\u5df2\u7ecf\u51c6\u5907\u597d\u8fdb\u884c\u6b63\u5e38\u5de5\u4f5c\u4e86\u3002\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\u7684\u6d41\u63a7Buffer\u5927\u5c0f\u4e3a2KB\uff0c\u4e14\u79cd\u7c7b\u4e3aNon-Posted Header Buffer\uff0c\u56e0\u6b641\u4e2aCredit\u4ee3\u88685dwords\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f20Bytes\u3002\u8fd9\u610f\u5473\u7740\u53ef\u7528\u7684\u6d41\u63a7\u5355\u4f4d\u6570\u91cf\u4e3a102d\uff0866h\uff09\u3002\u56fe 6\u201110\u663e\u793a\u51fa\u4e86\u6d89\u53ca\u5230\u7684\u6d41\u63a7\u5143\u7d20\uff0c\u5305\u62ec\u6d41\u63a7\u521d\u59cb\u5316\u540e\u5404\u8ba1\u6570\u5668\u548c\u5bc4\u5b58\u5668\u7684\u503c\u3002</p> <p>\u5f53\u53d1\u9001\u65b9\u51c6\u5907\u597d\u8981\u53d1\u9001\u4e00\u4e2aTLP\u65f6\uff0c\u5b83\u5fc5\u987b\u9996\u5148\u68c0\u67e5\u6d41\u63a7Credit\u3002\u6211\u4eec\u7ed9\u51fa\u7684\u4f8b\u5b50\u4f1a\u6bd4\u8f83\u7b80\u5355\uff0c\u56e0\u4e3a\u53d1\u51fa\u7684\u6570\u636e\u5305\u6709\u4e14\u4ec5\u6709\u4e00\u4e2aNon-Posted Header\uff0c\u5b83\u6c38\u8fdc\u53ea\u4f1a\u9700\u89811\u4e2aFC Credit\u5373\u53ef\uff0c\u5e76\u4e14\u6211\u4eec\u4e5f\u4e8b\u5148\u5047\u8bbe\u8fd9\u4e2a\u4e8b\u52a1\u4e2d\u4e0d\u5b58\u5728\u6570\u636e\u8377\u8f7d\u3002</p> <p>\u5173\u4e8eHeader Credit\u7684\u68c0\u67e5\u4f7f\u7528\u7684\u662f\u65e0\u7b26\u53f7\u7b97\u672f\uff082\u7684\u8865\u7801\uff0c2\u2019s complement\uff09\uff0c\u5b83\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u516c\u5f0f\uff1a</p> <p></p> <p>\u4ee3\u5165\u56fe 6\u201110\u4e2d\u6240\u793a\u7684\u503c\u5f97\u5230\uff1a</p> <p></p> <p></p> <p>\u56fe 6\u201110\u521d\u59cb\u5316\u540e\u7684\u6d41\u63a7\u5143\u7d20</p> <p>\u5728\u672c\u4f8b\u4e2d\uff0c\u5c06\u5f53\u524dCREDITS_CONSUMED\u8ba1\u6570\u503c\uff08CC\uff09\u52a0\u4e0aPTLP\u6240\u9700\u7684 Credit\uff08Header\u9700\u89811 Credit\uff0c\u4e5f\u5c31\u662fPTLP\u6240\u9700\u7684Credit\u6570\u91cf=01h\uff09\uff0c\u4ee5\u6b64\u6765\u786e\u5b9aCREDITS_REQUIRED\uff08CR\uff09\uff0c\u4e5f\u5c31\u662f00h+01h=01h\u3002\u7136\u540e\u518d\u7528CREDIT_LIMIT\u8ba1\u6570\u503c\uff08CL\uff09\u51cf\u53bbCREDITS_REQUIRED\uff08CR\uff09\uff0c\u8fd9\u6837\u5c31\u80fd\u786e\u5b9a\u662f\u5426\u6709\u8db3\u591f\u7684\u53ef\u7528Credit\u3002</p> <p>\u4e0b\u9762\u7684\u63cf\u8ff0\u5305\u542b\u4e86\u5bf9\u5229\u75282\u7684\u8865\u7801\uff08\u5c31\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u719f\u77e5\u7684\u8865\u7801\uff0c\u53e6\u4e00\u4e2a1\u7684\u8865\u7801\u5176\u5b9e\u662f\u53cd\u7801\uff09\u8fdb\u884c\u51cf\u6cd5\u7684\u7b80\u8981\u56de\u987e\u3002\u5f53\u4f7f\u75282\u7684\u8865\u7801\u8fdb\u884c\u51cf\u6cd5\u8ba1\u7b97\u65f6\uff0c\u5c06\u8981\u51cf\u53bb\u7684\u6570\u5148\u8f6c\u6362\u4e3a\u53cd\u7801\uff081\u7684\u8865\u7801\uff09\u518d\u52a01\uff0c\u8fd9\u8981\u5c31\u5f97\u5230\u4e86\u51cf\u6570\u7684\u8865\u7801\uff082\u7684\u8865\u7801\uff09\u3002\u7136\u540e\u518d\u5c06\u88ab\u51cf\u6570\u4e0e\u51cf\u6570\u7684\u8865\u7801\uff082\u7684\u8865\u7801\uff09\u76f8\u52a0\uff0c\u5e76\u4e22\u5f03\u6700\u9ad8\u4f4d\u8fdb\u4f4d\u3002</p> <p>Credit\u68c0\u67e5\uff1a</p> <p></p> <p>CR\u8f6c\u6362\u4e3a2\u7684\u8865\u7801\uff1a</p> <p></p> <p>CR\u76842\u7684\u8865\u7801\u52a0\u4e0aCL\uff1a</p> <p></p> <p>\u7ed3\u679c\u662f\u5426\u5c0f\u4e8e\u7b49\u4e8e80h\u5462\uff1f\u662f\u7684\u3002\u51cf\u6cd5\u8fd0\u7b97\u540e\u7684\u7ed3\u679c\u5c0f\u4e8e\u7b49\u4e8e\u8ba1\u6570\u5668\u6700\u5927\u503c\u7684\u4e00\u534a\uff0c\u8fd9\u91cc\u662f\u7528\u6a21256\u7684\u8ba1\u6570\u5668\u8fdb\u884c\u8bb0\u5f55\u7684\uff0c\u56e0\u6b64\u6700\u5927\u503c\u7684\u4e00\u534a\u5c31\u662f128\uff0c\u6ee1\u8db3\u6b64\u6761\u4ef6\u6211\u4eec\u5c31\u8ba4\u4e3a\u63a5\u6536Buffer\u6709\u8db3\u591f\u7684\u7a7a\u95f4\uff0c\u53ef\u4ee5\u53d1\u9001\u5f53\u524d\u7684\u6570\u636e\u5305\u3002\u8fd9\u5176\u4e2d\u53ea\u4f7f\u7528\u4e00\u534a\u7684\u8ba1\u6570\u5668\u503c\u7684\u505a\u6cd5\u53ef\u4ee5\u907f\u514d\u6f5c\u5728\u7684\u8ba1\u6570\u9519\u8bef\u7684\u95ee\u9898\uff0c\u53c2\u9605\u201cStage3\u2014Counter Roll Over\u201d\u4e00\u8282\u3002</p> <p></p> <p>\u56fe 6\u201111\u7b2c\u4e00\u4e2aTLP\u53d1\u9001\u540e\u7684\u6d41\u63a7\u5143\u7d20</p>"},{"location":"pcie/all/#662-bufferflow-control-buffer-fills-up","title":"6.6.2     \u9636\u6bb5\u4e8c\u2014\u2014\u6d41\u63a7Buffer\u5df2\u6ee1\uff08Flow Control Buffer Fills Up\uff09","text":"<p>\u5047\u8bbe\u73b0\u5728\u63a5\u6536\u65b9\u5df2\u7ecf\u6709\u4e00\u6bb5\u65f6\u95f4\u6ca1\u6709\u4ece\u6d41\u63a7Buffer\u4e2d\u79fb\u9664\u4e8b\u52a1\u4e86\uff0c\u6216\u8bb8\u662fDevice Core\u7e41\u5fd9\uff0c\u65e0\u6cd5\u5904\u7406\u4e8b\u52a1\u3002\u6700\u7ec8\u6d41\u63a7Buffer\u5b8c\u5168\u88ab\u586b\u6ee1\uff0c\u5982\u56fe 6\u201112\u6240\u793a\u3002\u6b64\u65f6\u5982\u679c\u53d1\u9001\u65b9\u53c8\u5e0c\u671b\u53d1\u9001\u4e00\u4e2aTLP\uff0c\u90a3\u4e48\u5b83\u5148\u8fdb\u884c\u6d41\u63a7Credit\u68c0\u67e5\uff1a</p> <p>Credit Limit\uff08CL\uff09=66h</p> <p>Credits Required\uff08CR\uff09=67h</p> <p>\u8fdb\u884cCL-CR\u65e0\u7b26\u53f7\u51cf\u6cd5\u8fd0\u7b97\uff0c\u4e5f\u5c31\u662f\u51cf\u6570\u8f6c\u6362\u4e3a2\u7684\u8865\u7801\u7684\u52a0\u6cd5\u8fd0\u7b97\uff1a</p> <p></p> <p>\u4e0d\u96be\u53d1\u73b0FFh&lt;=80h\u5e76\u4e0d\u6210\u7acb\uff0c\u56e0\u6b64\u4e0d\u80fd\u53d1\u9001\u6570\u636e\u5305\u3002</p> <p>\u8fd9\u4e2a\u901a\u9053\u4f1a\u4e00\u76f4\u88ab\u963b\u585e\uff0c\u76f4\u5230\u53d1\u9001\u65b9\u63a5\u6536\u5230Update Flow Control DLLP\uff08\u66f4\u65b0\u6d41\u63a7DLLP\uff09\uff0c\u8fd9\u4e2aDLLP\u5c06CREDIT_LIMIT\uff08CL\uff09\u7684\u503c\u66f4\u65b0\u4e3a67h\u6216\u8005\u66f4\u5927\u7684\u503c\u3002\u5f53\u65b0\u7684\u503c\u5b58\u5165CL\u5bc4\u5b58\u5668\u65f6\uff0c\u53d1\u9001\u65b9\u7684Credit\u68c0\u67e5\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e86\uff0c\u4e5f\u5c31\u53ef\u4ee5\u53d1\u9001\u4e0b\u4e00\u4e2aTLP\u4e86\uff08Header\u53ea\u53601\u4e2aCredit\uff09\u3002</p> <p></p> <p>00h&lt;=80h\u6210\u7acb\uff0c\u53ef\u4ee5\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u91cc\u4e4b\u6240\u4ee5CREDIT_LIMIT\u503c\u52a01\u5c31\u591f\u7528\u662f\u56e0\u4e3a\u6211\u4eec\u662f\u4f7f\u7528Non-Posted Header\u6d41\u63a7Buffer\uff0cHeader\u53ea\u53601\u4e2aCredit\u3002</p> <p></p> <p>\u56fe 6\u201112\u6d41\u63a7Buffer\u586b\u6ee1\u540e\u7684\u6d41\u63a7\u5143\u7d20</p>"},{"location":"pcie/all/#663-0counters-roll-over","title":"6.6.3     \u9636\u6bb5\u4e09\u2014\u2014\u8ba1\u6570\u5668\u7ffb\u8f6c\u4e3a0\uff08Counters Roll Over\uff09","text":"<p>\u7531\u4e8eCredit Limit\uff08CL\uff09\u548cCredit Required\uff08CR\uff09\u8ba1\u6570\u53ea\u4f1a\u5411\u4e0a\u589e\u52a0\uff0c\u5b83\u4eec\u6700\u7ec8\u4f1a\u7ffb\u8f6c\u4e3a0\u3002\u5f53CL\u7ffb\u8f6c\u800cCR\u8fd8\u6ca1\u7ffb\u8f6c\u65f6\uff0cCredit\u68c0\u67e5\uff08CL-CR\uff09\u5c31\u4f1a\u51fa\u73b0\u8f83\u5c0f\u503c\u7684CL\u51cf\u53bb\u8f83\u5927\u503c\u7684CR\u7684\u60c5\u51b5\u3002\u7136\u800c\uff0c\u5728\u4f7f\u7528\u65e0\u7b26\u53f7\u7b97\u672f\u65f6\uff0c\u8fd9\u79cd\u60c5\u51b5\u5e76\u4e0d\u4f1a\u5f15\u53d1\u95ee\u9898\u3002\u5982\u524d\u9762\u7684\u4f8b\u5b50\u6240\u63cf\u8ff0\u7684\u90a3\u6837\uff0c\u5f53\u4f7f\u75282\u7684\u8865\u7801\u8fdb\u884c\u51cf\u6cd5\u8fd0\u7b97\u65f6\uff0c\u662f\u53ef\u4ee5\u5f97\u5230\u6b63\u786e\u7684\u5904\u7406\u7ed3\u679c\u7684\u3002\u56fe 6\u201113\u5c55\u793a\u4e86CL\u7ffb\u8f6c\u524d\u540e\uff0cCL\u4e0eCR\u7684\u503c\uff0c\u4ee5\u53caCL-CR\u76842\u7684\u8865\u7801\u51cf\u6cd5\u8fd0\u7b97\u7ed3\u679c\u3002</p> <p></p> <p>\u56fe 6\u201113\u6d41\u63a7\u8ba1\u6570\u5668\u7ffb\u8f6c\u95ee\u9898</p>"},{"location":"pcie/all/#664-bufferfc-buffer-overflow-error-check","title":"6.6.4     \u9636\u6bb5\u56db\u2014\u2014\u6d41\u63a7Buffer\u6ea2\u51fa\u9519\u8bef\u68c0\u67e5\uff08FC Buffer Overflow Error Check\uff09","text":"<p>\u5c3d\u7ba1\u8fd9\u662f\u4e00\u4e2a\u53ef\u9009\u64cd\u4f5c\uff0c\u4f46\u662f\u534f\u8bae\u89c4\u8303\u8fd8\u662f\u63a8\u8350\u5b9e\u73b0\u8fd9\u4e2aFC Buffer\u6ea2\u51fa\u9519\u8bef\u68c0\u67e5\u673a\u5236\u3002\u56fe 6\u201114\u5c55\u793a\u4e86\u548c\u6ea2\u51fa\u9519\u8bef\u68c0\u67e5\u76f8\u5173\u8054\u7684\u6d41\u63a7\u5143\u7d20\uff0c\u5305\u62ec\uff1a</p> <p>n Credits Received\uff08CR\uff09\u8ba1\u6570\u5668\uff08\u6ce8\u610f\u8fd9\u91ccCR\u4e0d\u662f\u524d\u9762\u7684Credit Required\uff09</p> <p>n Credits Allocated\uff08CA\uff09\u8ba1\u6570\u5668</p> <p>n \u9519\u8bef\u68c0\u67e5\u903b\u8f91\uff08Error Check Logic\uff09</p> <p>\u8fd9\u4e9b\u5143\u7d20\u4f7f\u5f97\u63a5\u6536\u65b9\u53ef\u4ee5\u4f7f\u7528\u8ddf\u53d1\u9001\u65b9\u76f8\u540c\u7684\u65b9\u5f0f\u6765\u8bb0\u5f55\u6d41\u63a7Credit\u3002\u5982\u679c\u6d41\u63a7\u673a\u5236\u6b63\u786e\u8fd0\u884c\uff0c\u90a3\u4e48\u53d1\u9001\u65b9\u7684Credits Consumed\u8ba1\u6570\u503c\uff08CC\uff09\u6c38\u8fdc\u4e0d\u4f1a\u8d85\u8fc7\u5b83\u7684Credit Limit\uff08CL\uff09\uff0c\u5e76\u4e14\u63a5\u6536\u65b9\u7684Credits Received\uff08CR\uff09\u4e5f\u6c38\u8fdc\u4e0d\u4f1a\u8d85\u8fc7\u5b83\u7684Credits Allocated\u8ba1\u6570\u503c\uff08CA\uff09\u3002</p> <p>\u82e5\u68c0\u6d4b\u5230\u4e0b\u9762\u7684\u516c\u5f0f\u6210\u7acb\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u51fa\u73b0\u4e86\u6ea2\u51fa\u60c5\u51b5\u3002\u6ce8\u610f\u516c\u5f0f\u4e2d\u7684Field Size\u5bf9Header\u6765\u8bf4\u4e3a8\uff0c\u5bf9\u6570\u636e\u6765\u8bf4\u4e3a12\u3002</p> <p></p> <p>\u5f53\u516c\u5f0f\u6210\u7acb\u65f6\uff0c\u8bf4\u660e\u53d1\u9001\u81f3FC Buffer\u7684Credits\u6570\u91cf\u5df2\u7ecf\u8d85\u8fc7\u4e86\u53ef\u7528\u7684\u6570\u91cf\uff0c\u4e5f\u5c31\u662f\u8bf4\u53d1\u751f\u4e86\u6ea2\u51fa\u3002\u6ce8\u610f\u5728PCIe 1.0a\u7248\u672c\u4e2d\u5b9a\u4e49\u7684\u516c\u5f0f\u4e2d\u4f7f\u7528\u7684\u662f\u2265\u800c\u4e0d\u662f\uff1e\u3002\u8fd9\u662f\u4e00\u4e2a\u9519\u8bef\uff0c\u56e0\u4e3aCA=CR\uff08Credits Received\uff09\u65f6\u5e76\u6ca1\u6709\u53d1\u751f\u6ea2\u51fa\u3002</p> <p></p> <p>\u56fe 6\u201114 Buffer\u6ea2\u51fa\u9519\u8bef\u68c0\u67e5</p>"},{"location":"pcie/all/#67-flow-control-update","title":"6.7 \u6d41\u63a7\u66f4\u65b0\uff08Flow Control Update\uff09","text":"<p>\u5f53\u63a5\u6536\u65b9\u7684Buffer\u5185\u6709\u4e8b\u52a1\u88ab\u79fb\u9664\u65f6\uff0c\u4e5f\u5c31\u8bf4\u660e\u8fd9\u4e00\u90e8\u5206Buffer\u7a7a\u95f4\u53c8\u53d8\u4e3a\u53ef\u7528\u4e86\uff0c\u90a3\u4e48\u63a5\u6536\u65b9\u5c31\u9700\u8981\u5b9a\u671f\u7684\u7528\u6700\u65b0\u7684\u6d41\u63a7Credit\u6570\u91cf\u6765\u66f4\u65b0\u5bf9\u7aef\u8bbe\u5907\u3002\u56fe 6\u201115\u7ed9\u51fa\u4e86\u4e00\u4e2a\u4f8b\u5b50\uff0c\u793a\u4f8b\u4e2d\u53d1\u9001\u65b9\u539f\u672c\u7531\u4e8eBuffer\u5df2\u6ee1\u7684\u539f\u56e0\u963b\u585e\u4e86Header\u4e8b\u52a1\u7684\u53d1\u9001\uff0c\u800c\u540e\u63a5\u6536\u65b9\u4ece\u6d41\u63a7Buffer\u4e2d\u79fb\u9664\u4e863\u4e2aHeader\uff0c\u8fd9\u4f7f\u5f97\u73b0\u5728\u6709\u53ef\u7528\u7684Buffer\u7a7a\u95f4\u4e86\uff0c\u4f46\u662f\u6b64\u65f6\u5bf9\u7aef\u8bbe\u5907\u5e76\u4e0d\u77e5\u9053\u8fd9\u4ef6\u4e8b\u3002\u5f533\u4e2aHeader\u4eceBuffer\u4e2d\u79fb\u9664\u65f6\uff0cCREDITS_ALLOCATED\u8ba1\u6570\u503c\uff08CA\uff09\u4f1a\u4ece66h\u589e\u52a0\u81f369h\uff0c\u8fd9\u4e2a\u65b0\u7684\u8ba1\u6570\u503c\u88ab\u62a5\u544a\u7ed9\u5bf9\u7aef\u8bbe\u5907\uff08\u53d1\u9001\u65b9\uff09\u7684CREDIT_LIMIT\u5bc4\u5b58\u5668\uff0c\u62a5\u544a\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u6d41\u63a7\u66f4\u65b0\u5305\uff08FC Update packet\uff09\u3002\u4e00\u65e6CREDIT_LIMIT\u88ab\u66f4\u65b0\uff0c\u53d1\u9001\u65b9\u5c31\u53ef\u4ee5\u7ee7\u7eed\u53d1\u9001TLP\u4e86\u3002</p> <p>\u9700\u8981\u7279\u522b\u6307\u51fa\u7684\u4e00\u70b9\u662f\uff0c\u8fd9\u91cc\u66f4\u65b0\u62a5\u544a\u7684\u662fCREDITS_ALLOCATED\u5bc4\u5b58\u5668\u7684\u5b9e\u9645\u503c\u3002\u5176\u5b9e\u6211\u4eec\u672c\u53ef\u4ee5\u53ea\u62a5\u544a\u5bc4\u5b58\u5668\u503c\u7684\u53d8\u5316\u91cf\uff0c\u6bd4\u5982\u201cNon-Posted Header +3 Credits\u201d\uff0c\u4f46\u662f\u8fd9\u79cd\u8868\u793a\u4f1a\u5b58\u5728\u4e00\u4e2a\u6f5c\u5728\u7684\u95ee\u9898\u3002\u4e3a\u4e86\u7406\u89e3\u8fd9\u5176\u4e2d\u6240\u542b\u7684\u98ce\u9669\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u5982\u679c\u5305\u542b\u4e86\u5bc4\u5b58\u5668\u53d8\u5316\u589e\u91cf\u4fe1\u606f\u7684DLLP\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u9020\u6210\u4e86\u4e22\u5931\uff0c\u6b64\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u5bf9\u4e8eDLLP\u6765\u8bf4\u662f\u6ca1\u6709replay\u673a\u5236\u7684\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u9519\u8bef\u90a3\u4e48\u5904\u7406\u65b9\u5f0f\u5c31\u662f\u7b80\u5355\u7684\u628aDLLP\u4e22\u5f03\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u589e\u91cf\u4fe1\u606f\u5c06\u4f1a\u4e22\u5931\uff0c\u5e76\u4e14\u6ca1\u6709\u65b9\u6cd5\u6062\u590d\u5b83\u3002</p> <p>\u53cd\u8fc7\u6765\u8bf4\uff0c\u5982\u679c\u62a5\u544a\u7684\u662f\u5bc4\u5b58\u5668\u7684\u5b9e\u9645\u503c\u800c\u4e0d\u662f\u589e\u91cf\uff0c\u90a3\u4e48\u5728DLLP\u4f20\u8f93\u5931\u8d25\u65f6\uff0c\u4e0b\u4e00\u4e2aDLLP\u4f9d\u7136\u53ef\u4ee5\u5b8c\u6210\u8ba1\u6570\u503c\u7684\u540c\u6b65\u66f4\u65b0\u3002\u867d\u7136\u8fd9\u79cd\u60c5\u51b5\u6709\u65f6\u4f1a\u6d6a\u8d39\u4e00\u4e9b\u65f6\u95f4\uff0c\u6bd4\u5982\u53d1\u9001\u65b9\u9700\u8981\u5728\u4e00\u4e2aDLLP\u53d1\u9001\u5931\u8d25\u65f6\u7b49\u5f85\u4e0b\u4e00\u4e2aDLLP\u6765\u66f4\u65b0\u6d41\u63a7Credit\uff0c\u4f46\u662f\u5e76\u4e0d\u4f1a\u6709\u4fe1\u606f\u7684\u4e22\u5931\u51fa\u73b0\u3002</p> <p></p> <p>\u56fe 6\u201115\u6d41\u63a7\u66f4\u65b0\u793a\u4f8b</p>"},{"location":"pcie/all/#671-dllpfc_update-dllp-format-and-content","title":"6.7.1     \u6d41\u63a7\u66f4\u65b0DLLP\u683c\u5f0f\u548c\u5185\u5bb9\uff08FC_Update DLLP Format and Content\uff09","text":"<p>\u56de\u60f3\u4e00\u4e0b\uff0c\u6d41\u63a7\u66f4\u65b0\u5305\u4e0e\u6d41\u63a7\u521d\u59cb\u5316\u5305\u4e00\u6837\uff0c\u5305\u542b\u4e24\u4e2aCredit\u5b57\u6bb5\uff0c\u4e00\u4e2a\u662fHeader Credit\u5b57\u6bb5\uff0c\u4e00\u4e2a\u662fData Credit\u5b57\u6bb5\uff0c\u5982\u56fe 6\u201116\u6240\u793a\u3002\u63a5\u6536\u65b9\u62a5\u544a\u5728HdrFC\u548cDataFC\u5b57\u6bb5\u7684Credit\u503c\u53ef\u80fd\u5df2\u7ecf\u66f4\u65b0\u4e86\u5f88\u591a\u6b21\uff0c\u4e5f\u6709\u53ef\u80fd\u81ea\u4ece\u4e0a\u6b21\u53d1\u9001\u66f4\u65b0\u5305\u540e\u5c31\u6ca1\u6709\u53d8\u8fc7\u3002</p> <p></p> <p>\u56fe 6\u201116\u6d41\u63a7\u66f4\u65b0\u5305\u7684\u683c\u5f0f\u548c\u5185\u5bb9</p>"},{"location":"pcie/all/#672-flow-control-update-frequency","title":"6.7.2     \u6d41\u63a7\u66f4\u65b0\u9891\u7387\uff08Flow Control Update Frequency\uff09","text":"<p>\u9488\u5bf9\u6d41\u63a7\u66f4\u65b0DLLP\u5e94\u8be5\u5982\u4f55\u53d1\u9001\uff0c\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u5404\u79cd\u89c4\u5219\u4ee5\u53ca\u5efa\u8bae\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002\u5b83\u4eec\u662f\u4e3a\u4e86\uff1a</p> <p>n \u5c3d\u53ef\u80fd\u65e9\u7684\u5c06\u6700\u65b0\u7684CREDITS_ALLOCATED\uff08CA\uff09\u544a\u77e5\u7ed9\u53d1\u9001\u65b9\uff0c\u7279\u522b\u662f\u5f53\u6709\u4e8b\u52a1\u5df2\u7ecf\u88ab\u963b\u585e\u7684\u65f6\u5019\u3002</p> <p>n \u786e\u7acbFC\u5305\u4e4b\u95f4\u7684\u5ef6\u65f6\u6700\u574f\u60c5\u51b5\u3002</p> <p>n \u5e73\u8861\u5404\u76f8\u5173\u7684\u6d41\u63a7\u64cd\u4f5c\u7684\u9700\u6c42\uff0c\u4f8b\u5982\uff1a</p> <p>\u2014  \u9700\u8981\u8db3\u591f\u9891\u7e41\u7684\u62a5\u544aCredit\u4fe1\u606f\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u4e8b\u52a1\u963b\u585e</p> <p>\u2014  \u5e0c\u671b\u51cf\u5c11\u6d41\u63a7\u66f4\u65b0DLLP\u6240\u9700\u8981\u7684\u94fe\u8def\u5e26\u5bbd</p> <p>\u2014  \u9009\u62e9\u6700\u4f18\u7684Buffer\u5927\u5c0f</p> <p>\u2014  \u9009\u62e9\u6700\u5927\u7684\u6570\u636e\u8377\u8f7d\u5927\u5c0f</p> <p>n \u68c0\u6d4b\u6d41\u63a7\u5305\u4e4b\u95f4\u5173\u4e8e\u6700\u5927\u65f6\u5ef6\u7684\u8fdd\u4f8b\u60c5\u51b5\u3002</p> <p>\u6d41\u63a7\u66f4\u65b0\u4ec5\u5728\u94fe\u8def\u5904\u4e8e\u6d3b\u8dc3\u72b6\u6001\uff08active state\uff0cL0 or L0s\uff09\u65f6\u624d\u80fd\u4f7f\u7528\u3002\u6240\u6709\u5176\u4ed6\u7684\u94fe\u8def\u72b6\u6001\u8868\u793a\u66f4\u52a0\u79ef\u6781\u7684\u7535\u6e90\u7ba1\u7406\uff0c\u5b83\u5177\u6709\u66f4\u957f\u7684\u6062\u590d\u65f6\u5ef6\u3002</p>"},{"location":"pcie/all/#6721-credits_allocatedimmediate-notification-of-ca","title":"6.7.2.1   \u7acb\u5373\u901a\u544aCREDITS_ALLOCATED\uff08Immediate Notification of CA\uff09","text":"<p>\u5f53\u4e00\u4e2a\u6d41\u63a7Buffer\u5df2\u7ecf\u6ee1\u5230\u65e0\u6cd5\u63a5\u6536\u6700\u5927\u7684\u6570\u636e\u5305\u65f6\uff0c\u534f\u8bae\u89c4\u8303\u8981\u6c42\u8981\u5728Buffer\u51fa\u73b0\u66f4\u591a\u53ef\u7528\u7a7a\u95f4\u65f6\u7acb\u5373\u53d1\u9001\u4e00\u4e2aFC_Update DLLP\u3002\u5b58\u5728\u4e24\u79cd\u60c5\u51b5\uff1a</p> <p>n \u6700\u5927\u6570\u636e\u5305\u5927\u5c0f=1Credit\u3002\u5f53\u6570\u636e\u5305\u7684\u53d1\u9001\u7531\u4e8e\u975e\u65e0\u9650\u7684NPH\uff08Non-Posted Header\uff09\u3001NPD\uff08Non-Posted Data\uff09\u3001PH\uff08Posted Header\uff09\u548cCplH\uff08Completion Header\uff09\u8fd9\u4e9b\u79cd\u7c7b\u7684Buffer\u5df2\u6ee1\u800c\u88ab\u963b\u585e\u65f6\uff0c\u82e5\u6b64\u65f6\u67091\u4e2a\u6216\u591a\u4e2a\u7684Credit\u53d8\u4e3a\u53ef\u7528\uff08\u5df2\u5206\u914d\uff09\uff0c\u90a3\u4e48\u6d41\u63a7\u66f4\u65b0\u5305\uff08UpdataFC Packet\uff09\u5fc5\u987b\u8981\u88ab\u5b89\u6392\u4f20\u8f93\u3002</p> <p>n \u6700\u5927\u6570\u636e\u5305\u5927\u5c0f=Max_Payload_Size\u3002\u5bf9\u4e8e\u975e\u65e0\u9650\u7684PD\u548cCplD\u7684Credit\u7c7b\u578b\uff0c\u6d41\u63a7Buffer\u7a7a\u95f4\u53ef\u80fd\u4f1a\u51cf\u5c0f\u5230\u65e0\u6cd5\u53d1\u9001\u6700\u5927\u6570\u636e\u5305\u7684\u7a0b\u5ea6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f531\u4e2a\u6216\u591a\u4e2a\u7684Credit\u53d8\u4e3a\u53ef\u7528\uff08\u5df2\u5206\u914d\uff09\uff0c\u6d41\u63a7\u66f4\u65b0\u5305\u5fc5\u987b\u8981\u88ab\u5b89\u6392\u4f20\u8f93\u3002</p>"},{"location":"pcie/all/#6722-dllpmaximum-latency-between-updatefc","title":"6.7.2.2   \u6d41\u63a7\u66f4\u65b0DLLP\u95f4\u6700\u5927\u5ef6\u65f6\uff08Maximum Latency Between UpdateFC\uff09","text":"<p>\u6bcf\u79cdFC Credit\u7c7b\u578b\uff08\u975e\u65e0\u9650\uff09\u7684\u6d41\u63a7\u66f4\u65b0\u5305\u5b89\u6392\u53d1\u9001\u7684\u9891\u7387\u81f3\u5c11\u8981\u8fbe\u5230\u6bcf30us\uff08-0%/+50%\uff09\u53d1\u9001\u4e00\u6b21\u3002\u5982\u679c\u8bbe\u7f6e\u4e86\u63a7\u5236\u94fe\u8def\u5bc4\u5b58\u5668\uff08Control Link Register\uff09\u5185\u7684\u6269\u5c55\u540c\u6b65\u4f4d\uff08Extended Sync bit\uff09\uff0c\u90a3\u4e48\u5b89\u6392\u66f4\u65b0\u7684\u9891\u7387\u5fc5\u987b\u4e0d\u4f4e\u4e8e120us\uff08-0%/+50%\uff09\u4e00\u6b21\u3002\u6ce8\u610f\uff0c\u5b9e\u9645\u5b89\u6392\u53d1\u9001\u6d41\u63a7\u66f4\u65b0\u5305\u7684\u9891\u7387\u53ef\u80fd\u8981\u6bd4\u534f\u8bae\u89c4\u8303\u4e2d\u8981\u6c42\u7684\u66f4\u9891\u7e41\u3002</p>"},{"location":"pcie/all/#6723-payload-size","title":"6.7.2.3   \u57fa\u4e8ePayload Size\u548c\u94fe\u8def\u5bbd\u5ea6\u8ba1\u7b97\u66f4\u65b0\u9891\u7387","text":"<p>\u534f\u8bae\u89c4\u8303\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u516c\u5f0f\u7528\u4e8e\u8ba1\u7b97\u66f4\u65b0\u9891\u7387\uff0c\u8fd9\u4e2a\u8ba1\u7b97\u662f\u57fa\u4e8e\u6700\u5927Payload Size\u4ee5\u53ca\u94fe\u8def\u5bbd\u5ea6\u7684\u3002\u5728\u4e0b\u9762\u5c55\u793a\u7684\u516c\u5f0f\u4e2d\uff0c\u4f7f\u7528\u7b26\u53f7\u65f6\u95f4\uff08symbol time\uff09\u6765\u5b9a\u4e49\u6d41\u63a7\u66f4\u65b0\u7684\u53d1\u9001\u95f4\u9694\u3002\u4f5c\u4e3a\u53c2\u8003\uff0c1\u4e2a\u7b26\u53f7\u65f6\u95f4\u7684\u5b9a\u4e49\u4e3a\u4f20\u8f931\u4e2asymbol\u6240\u9700\u8981\u7684\u65f6\u95f4\uff0cGen1\u4e3a4ns\uff0cGen2\u4e3a2ns\uff0cGen3\u4e3a1ns\u3002\u8868 6\u20113\u3001\u8868 6\u20114\u3001\u8868 6\u20115\u5c55\u793a\u4e86\u6bcf\u79cd\u901f\u7387\u4e0b\u7684\u539f\u751f\u672a\u8c03\u6574\u7684\u6d41\u63a7\u66f4\u65b0\u53c2\u6570\u503c\u3002\uff08UF\u610f\u4e3aUpdateFactor\uff0cFC\u5e94\u8be5\u662f\u5199\u9519\u4e86\uff0c\u5e94\u8be5\u4e5f\u662fUF\uff09</p> <p></p> <p>n \u6700\u5927\u8377\u8f7d\u5927\u5c0f\uff08MaxPayloadSize**\uff09**\uff1a\u8fd9\u4e2a\u503c\u5728\u8bbe\u5907\u7684\u63a7\u5236\u5bc4\u5b58\u5668\uff08Control Register\uff09\u4e2d\u7684Max_Payload_Size\u5b57\u6bb5\u3002</p> <p>n TLP****\u5f00\u9500\uff08TLP Overhead**\uff09**\uff1a\u5e38\u6570\u503c\uff0828 symbol\uff09\u8868\u793a\u6d88\u8017\u94fe\u8def\u5e26\u5bbd\u7684\u9644\u52a0TLP\u7ec4\u4ef6\uff08TLP\u524d\u7f00Prefix\u3001\u5e8f\u5217\u53f7Sequence Number\u3001\u5305\u5934Header\u3001LCRC\u3001\u7ec4\u5e27\u7b26\u53f7Framing Symbol\uff09\u3002</p> <p>n \u66f4\u65b0\u56e0\u5b50\uff08UpdateFactor**\uff09**\uff1a\u5728\u4e24\u4e2a\u76f8\u90bb\u6d41\u63a7\u66f4\u65b0\u5305\u88ab\u63a5\u6536\u5230\u7684\u4e2d\u95f4\u95f4\u9694\u7684\u8fd9\u6bb5\u65f6\u95f4\u91cc\uff0c\u6240\u80fd\u53d1\u9001\u7684\u6700\u5927\u5927\u5c0fTLP\u7684\u6570\u91cf\u3002\u8fd9\u4e2a\u6570\u5b57\u662f\u4e3a\u4e86\u5e73\u8861\u94fe\u8def\u5e26\u5bbd\u6548\u7387\u548c\u63a5\u6536Buffer\u5927\u5c0f\u2014\u2014\u56e0\u4e3a\u8fd9\u4e2a\u503c\u4f1a\u968fMax_Payload_Size\u548c\u94fe\u8def\u5bbd\u5ea6\u800c\u53d1\u751f\u53d8\u5316\u3002</p> <p>n \u94fe\u8def\u5bbd\u5ea6\uff08LinkWidth**\uff09**\uff1a\u94fe\u8def\u6240\u4f7f\u7528\u7684\u901a\u9053\uff08Lane\uff09\u6570\u91cf\u3002</p> <p>n \u5185\u90e8\u5ef6\u65f6\uff08InternalDelay**\uff09**\uff1a\u662f\u4e00\u4e2a\u5e38\u6570\u503c\uff0c\u4e3a19\u4e2a\u7b26\u53f7\u65f6\u95f4\uff08symbol time\uff09\uff0c\u8868\u793a\u63a5\u6536\u5230TLP\u5e76\u53d1\u9001DLLP\u6240\u9700\u8981\u7684\u5185\u90e8\u5904\u7406\u5ef6\u8fdf\u3002</p> <p>\u516c\u5f0f\u4e2d\u5b9a\u4e49\u7684\u5173\u7cfb\u8868\u660e\uff0c\u53d1\u9001\u6d41\u63a7\u66f4\u65b0\u5305\u7684\u9891\u7387\u968f\u94fe\u8def\u5bbd\u5ea6\u589e\u52a0\u800c\u51cf\u5c11\uff0c\u5efa\u8bae\u4f7f\u7528\u8ba1\u65f6\u5668\u6765\u89e6\u53d1\u6d41\u63a7\u66f4\u65b0\u5305\u7684\u8c03\u5ea6\u53d1\u9001\u3002\u9700\u8981\u6ce8\u610f\uff0c\u8fd9\u4e2a\u516c\u5f0f\u4e0d\u8003\u8651\u63a5\u6536\u65b9\u6216\u662f\u53d1\u9001\u65b9\u5728L0s\u7535\u6e90\u7ba1\u7406\u72b6\u6001\u65f6\u76f8\u5173\u7684\u5ef6\u65f6\uff08\u524d\u9762\u63d0\u5230\u8fc7\u4ec5\u5728active\u72b6\u6001\u624d\u53ef\u4ee5\u4f7f\u7528\u6d41\u63a7\u66f4\u65b0\uff09\u3002</p> <p></p> <p>\u8868 6\u20113 PCIe Gen1\u539f\u751f\u672a\u8c03\u6574\u7684AckNak_LATENCY_TIMER\u503c\uff08\u5355\u4f4d\u4e3aSymbol time\uff09</p> <p></p> <p>\u8868 6\u20114 PCIe Gen2\u539f\u751f\u672a\u8c03\u6574\u7684AckNak_LATENCY_TIMER\u503c\uff08\u5355\u4f4d\u4e3aSymbol time\uff09</p> <p></p> <p>\u8868 6\u20115 PCIe Gen3\u539f\u751f\u672a\u8c03\u6574\u7684AckNak_LATENCY_TIMER\u503c\uff08\u5355\u4f4d\u4e3aSymbol time\uff09</p> <p>*\u8bd1\u8005\u5bf9\u4e0a\u9762\u4e09\u4e2a\u8868\u683c\u8fdb\u884c\u4e3e\u4f8b\u8bf4\u660e\uff0c\u9009\u53d6PCIe Gen1\uff0cMax Payload=256\uff0cx2 Link\uff0c\u4ee3\u5165\u516c\u5f0f\u5f97\u5230((256+28)*1.4/2)+19=217.8\uff0c\u4e0d\u96be\u53d1\u73b0\u5c31\u662f\u5bf9\u5e94\u8868\u4e2d217\u8fd9\u4e2a\u503c\u3002\u800c\u5bf9\u4e8eGen2\u3001Gen3\u53ef\u80fd\u53d1\u73b0\u4e0d\u7b26\u5408\u516c\u5f0f\uff0c\u5176\u5b9e\u4e0d\u96be\u53d1\u73b0Gen2=Gen1+51\uff0cGen3=Gen2+45\uff0c\u8fd9\u5e94\u8be5\u662f\u4e66\u4e2d\u6ca1\u6709\u63d0\u4f9b\u4e00\u4e9b\u5e38\u6570\u53c2\u6570\u7684\u539f\u56e0\uff0c\u603b\u4e4bGen2\u8868\u683c\u5185\u7684\u503c\u90fd\u7b49\u4e8eGen1\u5bf9\u5e94\u7684\u503c\u52a0\u4e0a51\uff1bGen3\u8868\u683c\u5185\u7684\u503c\u90fd\u7b49\u4e8eGen2\u5bf9\u5e94\u7684\u503c\u52a0\u4e0a45\u3002</p> <p>\u534f\u8bae\u89c4\u8303\u8ba4\u8bc6\u5230\u8fd9\u4e2a\u516c\u5f0f\u5176\u5b9e\u5bf9\u4e8e\u8bb8\u591a\u5e94\u7528\u573a\u666f\u7684\u4f7f\u7528\u662f\u4e0d\u6070\u5f53\u7684\uff0c\u6bd4\u5982\u90a3\u4e9b\u4f7f\u7528\u5927\u5757\u6570\u636e\u7684\u6d41\u7684\u5e94\u7528\u3002\u8fd9\u4e9b\u5e94\u7528\u53ef\u80fd\u4f1a\u8981\u6c42\u5b9e\u9645Buffer\u7684\u5927\u5c0f\u8981\u5927\u4e8e\u89c4\u8303\u4e2d\u7ed9\u51fa\u7684\u5927\u5c0f\uff0c\u4ee5\u53ca\u4f7f\u7528\u66f4\u590d\u6742\u7684\u66f4\u65b0\u7b56\u7565\uff0c\u4ee5\u6b64\u6765\u4f18\u5316\u6027\u80fd\u548c\u964d\u4f4e\u529f\u8017\u3002\u7531\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u7684\u89e3\u51b3\u65b9\u6848\u662f\u4f9d\u8d56\u4e8e\u5177\u4f53\u5e94\u7528\u7684\u7279\u5b9a\u9700\u6c42\u7684\uff0c\u56e0\u6b64\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u63d0\u4f9b\u6b64\u7c7b\u7b56\u7565\u7684\u5b9a\u4e49\u3002</p>"},{"location":"pcie/all/#673-error-detection-timera-pseudo-requirement","title":"6.7.3     \u9519\u8bef\u68c0\u6d4b\u8ba1\u65f6\u5668\u2014\u2014\u4e00\u4e2a\u8f6f\u8981\u6c42\uff08Error Detection Timer\u2014\u2014A Pseudo Requirement\uff09","text":"<p>\u534f\u8bae\u89c4\u8303\u4e2d\u4e3a\u6d41\u63a7\u5305\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53ef\u9009\u7684\u8d85\u65f6\uff08time-out\uff09\u673a\u5236\uff0c\u5e76\u4e14\u5f3a\u70c8\u5efa\u8bae\u5b9e\u73b0\u5b83\uff0c\u76ee\u524d\u5b83\u53ea\u662f\u4e00\u4e2a\u8f6f\u8981\u6c42\uff0c\u4f46\u662f\u5728\u672a\u6765\u7248\u672c\u7684\u534f\u8bae\u4e2d\u5b83\u53ef\u80fd\u4f1a\u6210\u4e3a\u4e00\u4e2a\u786c\u6027\u7684\u8981\u6c42\u3002\u5bf9\u4e8e\u4e00\u79cd\u7ed9\u5b9a\u7684Credit\u7c7b\u578b\uff0c\u5b83\u7684\u4e24\u4e2a\u6d41\u63a7\u5305\u4e4b\u95f4\u7684\u6700\u5927\u5ef6\u65f6\u95f4\u9694\u4e3a120us\uff0c\u800c\u5bf9\u4e8e\u8d85\u65f6\u673a\u5236\u6765\u8bf4\u8d85\u65f6\u754c\u9650\u4e3a200us\u3002\u5bf9\u4e8e\u6bcf\u79cd\u6d41\u63a7Credit\u7c7b\u578b\uff08Posted\u3001Non-Posted\u3001Completion\uff09\uff0c\u90fd\u5404\u81ea\u6709\u5355\u72ec\u7684\u8d85\u65f6\u8ba1\u65f6\u5668\uff0c\u4e14\u6bcf\u4e2a\u8ba1\u65f6\u5668\u90fd\u5728\u6536\u5230\u76f8\u5e94\u7c7b\u578b\u7684\u6d41\u63a7\u66f4\u65b0DLLP\u65f6\u8fdb\u884c\u590d\u4f4d\u3002\u9700\u8981\u6ce8\u610f\uff0c\u4e0e\u65e0\u9650\u6d41\u63a7Credit\u76f8\u5173\u8054\u7684\u8d85\u65f6\u8ba1\u65f6\u5668\u4e00\u5b9a\u4e0d\u80fd\u62a5\u544a\u9519\u8bef\u3002</p> <p>\u9664\u5f00\u65e0\u9650Credit\u7684\u60c5\u51b5\u4e4b\u5916\uff0c\u5176\u4ed6\u60c5\u51b5\u4e0b\u7684\u8d85\u65f6\u610f\u5473\u7740\u94fe\u8def\u5b58\u5728\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\u3002\u5982\u679c\u8d85\u65f6\u53d1\u751f\u4e86\uff0c\u90a3\u4e48\u7269\u7406\u5c42\u5c31\u4f1a\u88ab\u901a\u77e5\u8fdb\u5165\u6062\u590d\u72b6\u6001\uff08Recovery state\uff09\uff0c\u5e76\u91cd\u65b0\u8fdb\u884c\u94fe\u8def\u8bad\u7ec3\uff0c\u4ee5\u671f\u671b\u6e05\u9664\u9519\u8bef\u72b6\u6001\u3002\u8d85\u65f6\u8ba1\u65f6\u5668\u7684\u7279\u6027\u5305\u62ec\uff1a</p> <p>n \u4ec5\u5728\u94fe\u8def\u5904\u4e8eactive\u72b6\u6001\uff08L0 or L0s\uff09\u624d\u8fdb\u884c\u5de5\u4f5c\u3002</p> <p>n \u6700\u5927\u65f6\u95f4\u9650\u4e3a200us\uff08-0%/+50%\uff09</p> <p>n \u5f53\u63a5\u6536\u5230\u521d\u59cb\u5316\uff08Init\uff09\u6216\u8005\u6d41\u63a7\u66f4\u65b0\u5305\uff08Update FCP\uff09\u65f6\uff0c\u8ba1\u65f6\u5668\u5c31\u4f1a\u590d\u4f4d\u3002\u6216\u8005\u53ef\u9009\u7684\uff0c\u4e5f\u53ef\u4ee5\u5728\u63a5\u6536\u5230\u4efb\u4f55DLLP\u65f6\u90fd\u590d\u4f4d\u8ba1\u65f6\u5668\u3002</p> <p>n \u8d85\u65f6\uff08Timeout\uff09\u4f1a\u5f3a\u5236\u7269\u7406\u5c42\u8fdb\u5165LTSSM\uff08\u94fe\u8def\u8bad\u7ec3\u548c\u72b6\u6001\u72b6\u6001\u673a\uff0cLink Training and Status State Machine\uff09\u7684\u6062\u590d\u72b6\u6001\uff08Recovery State\uff09\u3002</p>"},{"location":"pcie/all/#chapter-7-quality-of-service-qos","title":"Chapter 7      Quality of Service //QoS\u670d\u52a1\u8d28\u91cf","text":""},{"location":"pcie/all/#_18","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u8282\u8ba8\u8bba\u4e86\u6d41\u91cf\u63a7\u5236\u534f\u8bae\uff08Flow Control\uff09\u7684\u76ee\u7684\u4ee5\u53ca\u7ec6\u8282\u64cd\u4f5c\u3002\u6d41\u91cf\u63a7\u5236\u662f\u7528\u6765\u786e\u4fdd\u5728\u63a5\u6536\u8005\u65e0\u6cd5\u63a5\u6536TLP\u65f6\uff0c\u53d1\u9001\u65b9\u4e0d\u4f1a\u518d\u7ee7\u7eed\u53d1\u9001TLP\u3002\u8fd9\u907f\u514d\u4e86\u63a5\u6536Buffer\u6ea2\u51fa\uff0c\u4e5f\u6d88\u9664\u4e86\u539f\u672cPCI\u5de5\u4f5c\u65b9\u5f0f\u4e2d\u7684\u4e00\u4e9b\u4f4e\u6548\u884c\u4e3a\uff0c\u6bd4\u5982\u65ad\u5f00\uff08disconnect\uff09\u3001\u91cd\u8bd5\uff08retry\uff09\u548c\u7b49\u5f85\u6001\uff08wait-state\uff09\u3002</p>"},{"location":"pcie/all/#_19","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u4f1a\u8ba8\u8bba\u7528\u4e8e\u652f\u6301QoS\uff08Quality of Service\uff09\u7684\u673a\u5236\uff0c\u5e76\u63cf\u8ff0\u5bf9\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u4e0d\u540c\u6570\u636e\u5305\u7684\u4f20\u8f93\u65f6\u95f4\u548c\u5e26\u5bbd\u8fdb\u884c\u63a7\u5236\u7684\u610f\u4e49\u3002\u8fd9\u4e9b\u673a\u5236\u5305\u62ec\uff0c\u7279\u5b9a\u5e94\u7528\u7684\u8f6f\u4ef6\u5c06\u4f1a\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u8bbe\u5907\u5185\u6784\u5efa\u53ef\u9009\u7684\u786c\u4ef6\u6765\u542f\u7528\u4e8b\u52a1\u4f18\u5148\u7ea7\u7ba1\u7406\u3002</p>"},{"location":"pcie/all/#_20","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u5c06\u4f1a\u8ba8\u8bbaPCIe\u62d3\u6251\u7ed3\u6784\u4e2d\u7684\u4e8b\u52a1\u5bf9\u6392\u5e8f\u7684\u8981\u6c42\u3002\u8fd9\u4e9b\u89c4\u5219\u662f\u7ee7\u627f\u81eaPCI\u7684\uff0c\u5b83\u4eec\u8bb8\u591a\u90fd\u53d7\u5230\u201c\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff08Producer/Consumer\uff09\u201d\u7a0b\u5e8f\u8bbe\u8ba1\u6a21\u578b\u7684\u63a8\u52a8\uff0c\u56e0\u6b64\u5728\u4e0b\u4e00\u7ae0\u5185\u4f1a\u63cf\u8ff0\u8fd9\u4e2a\u6a21\u578b\u7684\u673a\u5236\u539f\u7406\u3002\u539f\u59cb\u7684\u89c4\u5219\u4e2d\u8fd8\u8003\u8651\u4e86\u5fc5\u987b\u8981\u907f\u514d\u7684\u90a3\u4e9b\u6b7b\u9501\u60c5\u51b5\u3002</p>"},{"location":"pcie/all/#71-qosmotivation","title":"7.1 QoS\u7684\u51fa\u53d1\u70b9\uff08Motivation\uff09","text":"<p>\u5982\u4eca\u7684\u8bb8\u591a\u8ba1\u7b97\u673a\u7cfb\u7edf\u5e76\u4e0d\u542b\u6709\u7528\u4e8e\u7ba1\u7406\u5916\u8bbe\u6d41\u91cf\u7684\u673a\u5236\uff0c\u4f46\u662f\u6709\u4e00\u4e9b\u5e94\u7528\u662f\u9700\u8981\u8fd9\u79cd\u673a\u5236\u7684\u3002\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u6d41\u5a92\u4f53\u89c6\u9891\u901a\u8fc7\u4e00\u4e2a\u901a\u7528\u6570\u636e\u603b\u7ebf\uff08General-Purpose data bus\uff09\u8fdb\u884c\u4f20\u8f93\uff0c\u8fd9\u8981\u6c42\u6570\u636e\u8981\u5728\u6b63\u786e\u7684\u65f6\u95f4\u8fdb\u884c\u4f20\u8f93\u3002\u5728\u5d4c\u5165\u5f0f\u5f15\u5bfc\u63a7\u5236\u7cfb\u7edf\u4e2d\uff0c\u53ca\u65f6\u7684\u4f20\u8f93\u89c6\u9891\u6570\u636e\u5bf9\u4e8e\u7cfb\u7edf\u64cd\u4f5c\u6765\u8bf4\u4e5f\u662f\u6781\u4e3a\u5173\u952e\u7684\u3002\u7531\u4e8e\u9884\u89c1\u5230\u4e86\u8fd9\u4e9b\u9700\u6c42\uff0c\u539f\u59cb\u7684PCIe\u534f\u8bae\u89c4\u8303\u4e2d\u5c31\u5305\u542b\u4e86QoS\uff08\u670d\u52a1\u8d28\u91cf\uff09\u673a\u5236\uff0c\u5b83\u53ef\u4ee5\u4f7f\u5f97\u67d0\u4e9b\u6d41\u91cf\u66f4\u4f18\u5148\u88ab\u4f20\u8f93\u6216\u5904\u7406\u3002\u66f4\u5e7f\u4e49\u7684\u8bf4\u6cd5\u662f\uff0c\u8fd9\u662f\u4e00\u79cd\u5dee\u5f02\u5316\u7684\u670d\u52a1\uff08Differentiated Service\uff09\uff0c\u56e0\u4e3a\u6570\u636e\u5305\u4f1a\u6839\u636e\u88ab\u5206\u914d\u5230\u7684\u4f18\u5148\u7ea7\u4e0d\u540c\u800c\u53d7\u5230\u4e0d\u540c\u7684\u5904\u7406\u5bf9\u5f85\uff0c\u5e76\u4e14\u8fd9\u79cd\u673a\u5236\u5141\u8bb8\u6709\u4e00\u4e2a\u8303\u56f4\u8f83\u5e7f\u7684\u670d\u52a1\u504f\u597d\uff08\u4e5f\u5c31\u662f\u5141\u8bb8\u7684\u4f18\u5148\u7ea7\u6bd4\u8f83\u591a\uff09\u3002\u5728\u8fd9\u4e2a\u8303\u56f4\u7684\u9ad8\u7684\u4e00\u7aef\uff0cQoS\u673a\u5236\u53ef\u4ee5\u4e3a\u8fd9\u4e2a\u4f18\u5148\u7ea7\u7684\u5e94\u7528\u63d0\u4f9b\u53ef\u9884\u6d4b\u7684\uff08Predictable\uff09\u4ee5\u53ca\u53ef\u4fdd\u8bc1\u7684\uff08Guaranteed\uff09\u7684\u6027\u80fd\u3002\u8fd9\u79cd\u7ea7\u522b\u7684\u670d\u52a1\u652f\u6301\u88ab\u79f0\u4e3a\u201cIsochronous\uff08\u540c\u6b65\u7684\uff09\u201d\u670d\u52a1\uff08\u53ef\u4ee5\u7c7b\u6bd4\u540c\u6b65\u4ee5\u592a\u7f51\u3001TTE\uff0c\u8fd9\u91cc\u7684Isochronous\u5c31\u662f\u8fd9\u4e2a\u540c\u6b65\u7684\u542b\u4e49\uff09\uff0c\u8fd9\u4e2a\u672f\u8bed\u6765\u6e90\u4e8e\u4e24\u4e2a\u5e0c\u814a\u5355\u8bcd\u201cisos\u201d\uff08\u76f8\u7b49\uff09\u548c\u201cchronos\u201d\uff08\u65f6\u95f4\uff09\uff0c\u5408\u8d77\u6765\u5c31\u8868\u793a\u67d0\u4e2a\u4e8b\u60c5\u4ee5\u76f8\u540c\u7684\u65f6\u95f4\u95f4\u9694\u53d1\u751f\u3002\u8981\u4f7f\u5f97\u8fd9\u6837\u7684\u673a\u5236\u5728PCIe\u4e2d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fd9\u8981\u6c42\u786c\u4ef6\u5143\u7d20\u548c\u8f6f\u4ef6\u5143\u7d20\u7684\u5171\u540c\u4f5c\u7528\u3002</p>"},{"location":"pcie/all/#72-basic-elements","title":"7.2 \u57fa\u672c\u5143\u7d20\uff08Basic Elements\uff09","text":"<p>\u652f\u6301\u9ad8\u7ea7\u522b\u7684\u670d\u52a1\u7ed9\u7cfb\u7edf\u6027\u80fd\u63d0\u51fa\u4e86\u4e00\u4e9b\u8981\u6c42\u3002\u4f8b\u5982\uff0c\u4f20\u8f93\u901f\u7387\u9700\u8981\u8db3\u591f\u7684\u9ad8\uff0c\u8fd9\u6837\u624d\u80fd\u6ee1\u8db3\u5e94\u7528\u5728\u4e00\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u4f20\u8f93\u8db3\u591f\u591a\u7684\u6570\u636e\u7684\u9700\u6c42\uff0c\u540c\u65f6\u8fd9\u4e5f\u4f7f\u5f97\u5e94\u7528\u80fd\u591f\u9002\u5e94\u4e0e\u5176\u4ed6\u6d41\u91cf\u4e4b\u95f4\u7684\u7ade\u4e89\u3002\u53e6\u5916\uff0c\u4f20\u8f93\u65f6\u5ef6\u4e5f\u9700\u8981\u8db3\u591f\u4f4e\uff0c\u8fd9\u6837\u624d\u80fd\u786e\u8ba4\u6570\u636e\u5305\u53ca\u65f6\u4f20\u8f93\u5230\u8fbe\uff0c\u907f\u514d\u51fa\u73b0\u5ef6\u8fdf\u95ee\u9898\u3002\u6700\u540e\uff0c\u5fc5\u987b\u8981\u5bf9\u9519\u8bef\u5904\u7406\u8fdb\u884c\u7ba1\u7406\uff0c\u8fd9\u6837\u5b83\u624d\u4e0d\u4f1a\u5f71\u54cd\u5230\u9700\u8981\u53ca\u65f6\u4f20\u8f93\u7684\u6570\u636e\u5305\u7684\u4f20\u8f93\u3002\u8981\u5b9e\u73b0\u4e0a\u8ff0\u8fd9\u4e9b\u76ee\u6807\uff0c\u9700\u8981\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u786c\u4ef6\u5143\u7d20\uff0c\u5176\u4e2d\u4e00\u79cd\u5c31\u662f\u4e00\u7ec4\u79f0\u4e3aVirtual Channel Capability Block\uff08\u865a\u62df\u901a\u9053\u80fd\u529b\u5757\uff09\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7ec4\uff0c\u5982\u56fe 7\u20111\u6240\u793a\u3002</p> <p></p> <p>\u56fe 7\u20111\u865a\u62df\u901a\u9053\u80fd\u529b\u5bc4\u5b58\u5668</p>"},{"location":"pcie/all/#721-tctraffic-class","title":"7.2.1     \u6d41\u91cf\u7c7b\u578bTC\uff08Traffic Class\uff09","text":"<p>\u6211\u4eec\u6240\u9700\u8981\u7684\u7b2c\u4e00\u4ef6\u4e8b\u60c5\u662f\u8981\u7528\u4e00\u79cd\u65b9\u5f0f\u6765\u533a\u5206\u5404\u79cd\u6d41\u91cf\uff0c\u4e5f\u5c31\u662f\u9700\u8981\u7528\u4e00\u4e9b\u4e1c\u897f\u6765\u533a\u5206\u54ea\u4e9b\u6570\u636e\u5305\u5177\u6709\u9ad8\u4f18\u5148\u7ea7\u3002\u8fd9\u79cd\u9700\u6c42\u662f\u901a\u8fc7\u4e3a\u6570\u636e\u5305\u6807\u660e\u6d41\u91cf\u7c7b\u578b\uff08TC\uff09\u6765\u5b8c\u6210\u7684\uff0c\u6d41\u91cf\u7c7b\u578b\uff08TC\uff09\u4e2d\u5b9a\u4e49\u4e868\u4e2a\u4f18\u5148\u7ea7\uff0c\u5b83\u901a\u8fc7TLP Header\u4e2d\u76843bit TC\u5b57\u6bb5\u6765\u8868\u793a\uff08TC 0-7\uff0c\u6570\u5b57\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff09\u3002\u56fe 7\u20112\u6240\u793a\u768432\u4f4dmemory\u8bf7\u6c42\u7684TLP Header\u4e2d\u6807\u8bc6\u51fa\u4e86TC\u5b57\u6bb5\u7684\u4f4d\u7f6e\u3002\u5728\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\uff0c\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u4e0e\u540c\u6b65\u7ba1\u7406\u8f6f\u4ef6\uff08Isochronous Management software\uff09\u6c9f\u901a\u670d\u52a1\u7684\u7ea7\u522b\uff0c\u540c\u6b65\u7ba1\u7406\u8f6f\u4ef6\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684TC\u503c\u6765\u4f7f\u7528\u5404\u79cd\u6d41\u91cf\u7c7b\u578b\u7684\u6570\u636e\u5305\u3002\u7136\u540e\u9a71\u52a8\u7a0b\u5e8f\u5c31\u4f1a\u7ed9\u6570\u636e\u5305\u5206\u914d\u6b63\u786e\u7684TC\u4f18\u5148\u7ea7\u3002TC\u503c\u9ed8\u8ba4\u4e3a0\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba9\u4e0d\u9700\u8981\u9ad8\u4f18\u5148\u7ea7\u670d\u52a1\u7684\u6570\u636e\u5305\u4e0d\u4f1a\u5e72\u6270\u5230\u90a3\u4e9b\u9700\u8981\u9ad8\u4f18\u5148\u7ea7\u670d\u52a1\u7684\u6570\u636e\u5305\u3002</p> <p></p> <p>\u56fe 7\u20112 TLP Header\u4e2d\u7684\u6d41\u91cf\u7c7b\u578b\uff08TC\uff09\u5b57\u6bb5</p> <p>\u4e0d\u8bc6\u522bPCIe\u7684\u914d\u7f6e\u8f6f\u4ef6\uff08\u6307\u4f20\u7edfPCI\u7684\u914d\u7f6e\u8f6f\u4ef6\uff09\u662f\u65e0\u6cd5\u8bc6\u522b\u51fa\u8fd9\u4e9b\u65b0\u7684\u5bc4\u5b58\u5668\u7684\uff0c\u5b83\u5c31\u4f1a\u4e3a\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u5206\u914d\u9ed8\u8ba4\u7684TC0/VC0\u3002\u53e6\u5916\uff0c\u4e5f\u6709\u4e00\u4e9b\u6570\u636e\u5305\u4e00\u76f4\u88ab\u8981\u6c42\u8981\u4f7f\u7528TC0/VC0\uff0c\u6bd4\u5982\u914d\u7f6e\uff08Configuration\uff09\u3001I/O\u4ee5\u53caMessage\u4e8b\u52a1\u3002\u5982\u679c\u8fd9\u4e9b\u6570\u636e\u5305\u88ab\u8ba4\u4e3a\u662f\u7ef4\u62a4\u5305\u6d41\u91cf\uff0c\u90a3\u4e48\u5c31\u6709\u5fc5\u8981\u5c06\u5b83\u4eec\u9650\u5236\u5728VC0\u4e2d\uff0c\u5e76\u4e14\u8981\u8ba9\u5b83\u4eec\u539f\u7406\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u7684\u4f20\u8f93\u8def\u5f84\uff0c\u907f\u514d\u5f71\u54cd\u5230\u9ad8\u4f18\u5148\u7ea7\u5305\u3002</p>"},{"location":"pcie/all/#722-vcvirtual-channels","title":"7.2.2     \u865a\u62df\u901a\u9053VC\uff08Virtual Channels\uff09","text":"<p>VC\uff08\u865a\u62df\u901a\u9053\uff09\u5b9e\u9645\u4e0a\u662f\u786c\u4ef6Buffer\uff0c\u5b83\u7528\u6765\u4f5c\u4e3a\u8f93\u51fa\u6570\u636e\u5305\u7684\u961f\u5217\u3002\u6bcf\u4e2a\u7aef\u53e3\u90fd\u5fc5\u987b\u8981\u5305\u542b\u9ed8\u8ba4\u7684VC0\uff0c\u5e76\u4e14\u6700\u591a\u53ef\u4ee5\u67098\u4e2aVC\uff08VC0-VC7\uff09\u3002\u6bcf\u4e2a\u901a\u9053\u90fd\u8868\u793a\u53ef\u4f9b\u8f93\u51fa\u6570\u636e\u5305\u4f7f\u7528\u7684\u4e0d\u540c\u4f20\u8f93\u8def\u5f84\u3002\u4f7f\u7528\u591a\u901a\u9053\u8def\u5f84\u7684\u60f3\u6cd5\u7c7b\u4f3c\u4e8e\u6536\u8d39\u516c\u8def\uff0c\u5982\u679c\u53f8\u673a\u8d2d\u4e70\u4e86\u67d0\u79cd\u65e0\u7ebf\u7535\u6807\u7b7e\uff0c\u90a3\u4e48\u6536\u8d39\u7ad9\u5c31\u5141\u8bb8\u4ed6\u4eec\u5728\u9ad8\u4f18\u5148\u7ea7\u8f66\u9053\u884c\u9a76\uff0c\u800c\u5bf9\u4e8e\u90a3\u4e9b\u6ca1\u6709\u8d2d\u4e70\u65e0\u7ebf\u7535\u6807\u7b7e\u7684\u53f8\u673a\u6765\u8bf4\uff0c\u867d\u7136\u4ed6\u4eec\u4ecd\u7136\u53ef\u4ee5\u5728\u8fd9\u6761\u6536\u8d39\u516c\u8def\u884c\u9a76\uff0c\u4f46\u662f\u4ed6\u4eec\u5fc5\u987b\u5728\u6bcf\u4e2a\u6536\u8d39\u7ad9\u90fd\u505c\u4e0b\u6765\uff0c\u4e14\u6bcf\u6b21\u901a\u8fc7\u90fd\u8981\u4ed8\u94b1\uff0c\u8fd9\u4f7f\u5f97\u8fd9\u4e9b\u53f8\u673a\u901a\u8fc7\u6536\u8d39\u7ad9\u9700\u8981\u66f4\u957f\u7684\u65f6\u95f4\u3002\u5982\u679c\u53ea\u6709\u4e00\u6761\u8def\u5f84\uff0c\u90a3\u4e48\u8981\u7ecf\u8fc7\u7684\u6bcf\u4e2a\u4eba\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u5c06\u53d7\u5230\u6700\u6162\u7684\u90a3\u4e2a\u53f8\u673a\u7684\u5f71\u54cd\u548c\u5ef6\u8bef\uff0c\u800c\u5982\u679c\u6709\u591a\u6761\u8def\u5f84\u7684\u8bdd\u5c31\u610f\u5473\u7740\u6709\u9ad8\u4f18\u5148\u7ea7\u7684\u53f8\u673a\u4e0d\u4f1a\u88ab\u5ef6\u8bef\uff08\u53ef\u4ee5\u4f7f\u7528\u9ad8\u4f18\u5148\u7ea7\u901a\u9053\uff09\u3002</p>"},{"location":"pcie/all/#7221-vctcstcvc","title":"7.2.2.1   \u4e3a\u6bcf\u4e2aVC\u5206\u914dTCs\u2014\u2014TC/VC\u6620\u5c04","text":"<p>\u5206\u914d\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u7684TC\u503c\u5728\u6574\u4e2a\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u4f1a\u6539\u53d8\u7684\uff0c\u800c\u4e14\u5fc5\u987b\u5728\u6bcf\u4e2a\u670d\u52a1\u70b9\u90fd\u6709TC\u5bf9VC\u7684\u6620\u5c04\uff0c\u4e5f\u5c31\u662f\u67d0\u79cdTC\u7684\u6570\u636e\u5305\u8981\u4f7f\u7528\u54ea\u6761\u8def\u5f84\u4f20\u8f93\u5230\u76ee\u7684\u5730\u3002VC\u6620\u5c04\u662f\u94fe\u8def\u81ea\u5df1\u6307\u5b9a\u7684\uff0c\u4ece\u4e00\u4e2a\u94fe\u8def\u5230\u53e6\u4e00\u4e2a\u94fe\u8def\u540eVC\u6620\u5c04\u662f\u53ef\u4ee5\u6539\u53d8\u7684\u3002\u914d\u7f6e\u8f6f\u4ef6\u4f1a\u5728\u521d\u59cb\u5316\u65f6\u5efa\u7acb\u8fd9\u79cd\u6620\u5c04\u5173\u7cfb\uff0c\u5b83\u662f\u901a\u8fc7VC\u8d44\u6e90\u63a7\u5236\u5bc4\u5b58\u5668\uff08VC Resource Control Register\uff0c\u56fe 7\u20111\uff09\u4e2d\u7684TC/VC Map\u5b57\u6bb5\u6765\u5b9e\u73b0\u7684\u3002\u8fd9\u4e2a8bit\u7684\u5b57\u6bb5\u4f7f\u5f97\u591a\u4e2aTC\u503c\u53ef\u4ee5\u88ab\u6620\u5c04\u5230\u67d0\u4e00\u4e2aVC\uff0c\u56e0\u4e3a\u5b83\u7684\u6bcf\u4e2abit\u90fd\u4ee3\u8868\u4e86\u4e00\u4e2a\u5bf9\u5e94\u7684TC\u503c\uff08bit 0 = TC0\uff0cbit 1 = TC1\uff0cetc.\uff09\u3002\u5c06\u4e00\u4e2aVC\u76848bit TC/VC Map\u5b57\u6bb5\u4e2d\u7684\u67d0\u4e00\u4f4d\u7f6e\u4e3a1\uff0c\u5c31\u8868\u793a\u5c06\u76f8\u5e94\u7684TC\u5206\u914d\u7ed9\u4e86\u8fd9\u4e2aVC\u3002\u56fe 7\u20113\u5c55\u793a\u4e86\u4e00\u4e2aTC-VC\u7684\u6620\u5c04\u4f8b\u5b50\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2dTC0\u548cTC1\u88ab\u6620\u5c04\u5230\u4e86VC0\uff0c\u800cTC2\u3001TC3\u3001TC4\u5219\u662f\u6620\u5c04\u5230\u4e86VC3\u3002</p> <p>\u8f6f\u4ef6\u5728\u5206\u914dVC ID\u548c\u6620\u5c04TC\u7684\u65b9\u9762\u6709\u5f88\u5927\u7684\u7075\u6d3b\u6027\uff0c\u4f46\u662f\u5728\u8fdb\u884cTC/VC\u6620\u5c04\u65f6\u4e5f\u8981\u9075\u5faa\u4e00\u4e9b\u89c4\u5219\uff1a</p> <p>n \u5bf9\u4e8e\u76f8\u540c\u7684\u4e00\u6761\u94fe\u8def\u7684\u4e24\u7aef\u7684\u4e24\u4e2a\u7aef\u53e3\u6765\u8bf4\uff0c\u5b83\u4eec\u7684TC/VC\u6620\u5c04\u5fc5\u987b\u662f\u76f8\u540c\u7684\u3002</p> <p>n TC0\u81ea\u52a8\u6620\u5c04\u5230VC0\u3002</p> <p>n \u5176\u4ed6\u7684TC\uff08\u9664\u4e86TC0\uff09\u53ef\u4ee5\u6620\u5c04\u5230\u4efb\u4f55\u4e00\u4e2aVC\u3002</p> <p>n \u4e00\u4e2aTC\u53ea\u80fd\u6620\u5c04\u5230\u4e00\u4e2aVC\uff0c\u800c\u53ef\u4ee5\u6709\u591a\u4e2aTC\u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u3002</p> <p>\u6240\u4f7f\u7528\u7684\u865a\u62df\u901a\u9053\u7684\u6570\u91cf\u53d6\u51b3\u4e8e\u94fe\u8def\u4e24\u7aef\u8bbe\u5907\u6240\u80fd\u5171\u4eab\u7684\u6700\u5927\u865a\u62df\u901a\u9053\u8d44\u6e90\u5bb9\u91cf\u3002\u8f6f\u4ef6\u4f1a\u4e3a\u6bcf\u4e2aVC\u5206\u914dID\uff0c\u5e76\u4e14\u4f1a\u5c06TC\u6620\u5c04\u81f3VC\u3002</p> <p></p> <p>\u56fe 7\u20113 TC\u5230VC\u7684\u6620\u5c04\u4e3e\u4f8b</p>"},{"location":"pcie/all/#7222-vc","title":"7.2.2.2   \u786e\u5b9a\u8981\u4f7f\u7528\u7684VC\u7684\u6570\u91cf","text":"<p>\u8f6f\u4ef6\u4f1a\u68c0\u67e5\u8fde\u63a5\u5728\u516c\u5171\u94fe\u8def\u4e0a\u7684\u8bbe\u5907\u6240\u80fd\u652f\u6301\u7684VC\u7684\u6570\u91cf\uff0c\u5e76\u4e14\u4e00\u822c\u4f1a\u9009\u62e9\u94fe\u8def\u4e24\u7aef\u8bbe\u5907\u6240\u80fd\u652f\u6301\u7684\u6700\u5927\u6570\u91cf\u4f5c\u4e3aVC\u7684\u5b9e\u9645\u4f7f\u7528\u6570\u91cf\u3002\u8003\u8651\u5982\u56fe 7\u20114\u6240\u793a\u7684\u62d3\u6251\u793a\u4f8b\uff0c\u5728\u8fd9\u91cc\uff0cSwitch\u4e0a\u7684\u6bcf\u4e2a\u7aef\u53e3\uff08port\uff09\u90fd\u652f\u6301\u5168\u90e8\u76848\u4e2aVC\uff0c\u800c\u8bbe\u5907A\u4ec5\u652f\u6301\u9ed8\u8ba4\u7684VC0\uff0c\u8bbe\u5907B\u652f\u63014\u4e2aVC\uff0c\u8bbe\u5907C\u652f\u63018\u4e2aVC\u3002\u9700\u8981\u6ce8\u610f\uff0c\u867d\u7136Switch\u7684\u7aef\u53e3A\u80fd\u591f\u652f\u63018\u4e2aVC\uff0c\u4f46\u662f\u7531\u4e8e\u8bbe\u5907A\u4ec5\u80fd\u652f\u6301VC0\uff0c\u56e0\u6b64\u7aef\u53e3A\u7684\u5176\u4f597\u4e2aVC\u662f\u65e0\u6cd5\u88ab\u4f7f\u7528\u7684\u3002\u76f8\u4f3c\u5730\uff0cSwitch\u7684\u7aef\u53e3B\u5b9e\u9645\u4e5f\u4ec5\u80fd\u4f7f\u75284\u4e2aVC\u3002</p> <p></p> <p>\u56fe 7\u20114\u4e00\u4e2a\u8bbe\u5907\u652f\u6301\u591a\u4e2a\u865a\u62df\u901a\u9053</p> <p>\u914d\u7f6e\u8f6f\u4ef6\u8981\u786e\u5b9a\u6bcf\u4e2a\u7aef\u53e3\u6240\u80fd\u652f\u6301\u7684\u6700\u5927VC\u6570\u91cf\uff0c\u5b83\u662f\u901a\u8fc7\u8bfb\u53d6\u865a\u62df\u901a\u9053\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\uff08Virtual Channel Capability register\uff0c\u56fe 7\u20111\uff09\u4e2d\u7684Extended VC Count\u5b57\u6bb5\u6765\u5b8c\u6210\u7684\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5982\u56fe 7\u20115\u6240\u793a\u3002</p> <p></p> <p>\u56fe 7\u20115\u6269\u5c55VC\u652f\u6301\u5b57\u6bb5</p>"},{"location":"pcie/all/#7223-vc-id","title":"7.2.2.3   \u5206\u914dVC ID","text":"<p>\u914d\u7f6e\u8f6f\u4ef6\u9700\u8981\u7ed9\u6bcf\u4e2aVC\u90fd\u5206\u914d\u4e00\u4e2aID\u53f7\uff0c\u9664\u4e86VC0\uff08\u56e0\u4e3a\u5b83\u662f\u56fa\u5b9a\u5b58\u5728\u7684\uff09\u3002\u5982\u56fe 7\u20113\u6240\u793a\uff0cVC\u80fd\u529b\u5bc4\u5b58\u5668\u7a7a\u95f4\u4e2d\uff0c\u6bcf\u4e2aVC\u90fd\u6709\u81ea\u5df112Byte\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u7ec4\u3002\u7b2c\u4e00\u7ec4\u5bc4\u5b58\u5668\u603b\u662f\u7531VC0\u4f7f\u7528\u3002\u6269\u5c55VC\u8ba1\u6570\uff08Extended VC Count\uff09\u5b57\u6bb5\u5b9a\u4e49\u4e86\u5f53\u524d\u7aef\u53e3\u5b9e\u73b0\u7684\u989d\u5916VC\u7684\u6570\u91cf\uff08\u9664VC0\u4e4b\u5916\uff09\uff0c\u6bcf\u4e2a\u5b9e\u73b0\u7684VC\u90fd\u6709\u4e00\u7ec4\u914d\u7f6e\u5bc4\u5b58\u5668\u3002\u6ce8\u610f\uff0c\u5b57\u6bb5\u7684\u503c\u201cn\u201d\u8868\u793a\u7684\u662f\u989d\u5916\u5b9e\u73b0\u7684VC\u7684\u6570\u91cf\uff0c\u4f8b\u5982\u6269\u5c55VC\u8ba1\u6570\u5b57\u6bb5\u4e3a3\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u9664\u4e86VC0\u4ee5\u5916\u8fd8\u67093\u4e2aVC\uff0c\u4ee5\u53ca\u5b83\u4eec\u6bcf\u4e2a\u90fd\u6709\u4e00\u7ec4\u81ea\u5df1\u7684\u914d\u7f6e\u5bc4\u5b58\u5668\u3002</p> <p>\u8f6f\u4ef6\u901a\u8fc7\u4f7f\u7528VC ID\u5b57\u6bb5\u4e3a\u6bcf\u4e2a\u989d\u5916\u7684VC\u5206\u914d\u4e00\u4e2a\u7f16\u53f7\uff08\u89c1\u56fe 7\u20113\uff09\u3002\u8fd9\u4e9bID\u53f7\u5e76\u4e0d\u4e00\u5b9a\u8981\u662f\u8fde\u7eed\u7684\uff0c\u4f46\u662f\u5fc5\u987b\u53ea\u80fd\u51fa\u73b0\u4e00\u6b21\u800c\u4e0d\u80fd\u91cd\u590d\u3002</p>"},{"location":"pcie/all/#73-vcvc-arbitration","title":"7.3 VC\u4ef2\u88c1\uff08VC Arbitration\uff09","text":""},{"location":"pcie/all/#731-general","title":"7.3.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>\u5f53\u4e00\u4e2a\u8bbe\u5907\u6709\u591a\u4e2aVC\uff0c\u4e14\u6bcf\u4e2aVC\u90fd\u6709\u5f85\u53d1\u9001\u7684\u6570\u636e\u5305\uff0c\u90a3\u4e48\u5c31\u9700\u8981VC\u4ef2\u88c1\u673a\u5236\u6765\u51b3\u5b9a\u6570\u636e\u5305\u4f20\u8f93\u7684\u987a\u5e8f\u3002\u8f6f\u4ef6\u53ef\u4ee5\u4ece\u786c\u4ef6\u6240\u5b9e\u73b0\u7684\u51e0\u79cd\u9009\u62e9\u65b9\u6848\u4e2d\u9009\u62e9\u4efb\u610f\u7684\u4e00\u79cd\u3002\u8bbe\u8ba1\u7684\u76ee\u6807\u662f\u8981\u5b9e\u73b0\u6240\u9700\u7684\u670d\u52a1\u7b56\u7565\uff0c\u5e76\u4e14\u786e\u4fdd\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u5728\u5411\u524d\u63a8\u8fdb\uff0c\u4ee5\u9632\u6b62\u53d1\u751f\u610f\u5916\u8d85\u65f6\u3002\u53e6\u5916\uff0cVC\u4ef2\u88c1\u4e5f\u4f1a\u53d7\u5230\u6d41\u91cf\u63a7\u5236\uff08flow control\uff09\u548c\u4e8b\u52a1\u6392\u5e8f\uff08Transaction Ordering\uff09\u7684\u76f8\u5173\u9700\u6c42\u7684\u5f71\u54cd\u3002\u8fd9\u4e9b\u4e3b\u9898\u5185\u5bb9\u5c06\u5728\u5176\u4ed6\u7ae0\u8282\u4e2d\u8ba8\u8bba\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u5b83\u4eec\u4e5f\u4f1a\u5f71\u54cd\u4ef2\u88c1\uff0c\u56e0\u4e3a\uff1a</p> <p>n \u6bcf\u4e2a\u53d7\u652f\u6301\u7684VC\u90fd\u6709\u5b83\u81ea\u5df1\u7684Buffer\u548c\u6d41\u63a7\u5904\u7406</p> <p>n \u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u7684\u591a\u4e2a\u4e8b\u52a1\u4e00\u822c\u4f1a\u6309\u7167\u4e25\u683c\u7684\u987a\u5e8f\u8fdb\u884c\u4f20\u8f93\uff08\u5c3d\u7ba1\u4e5f\u6709\u4f8b\u5916\uff0c\u6bd4\u5982\u4e00\u4e2a\u6570\u636e\u5305\u7684\u201c\u5bbd\u677e\u6392\u5e8fRelaxed Ordering\u201d\u8fd9\u4e00\u5c5e\u6027\u6807\u5fd7\u4f4d\u88ab\u7f6e\u4e3a1\u65f6\u3002\uff09</p> <p>n \u4e8b\u52a1\u6392\u5e8f\uff08Transaction Ordering\uff09\u4ec5\u5e94\u7528\u5728\u4e00\u4e2aVC\u5185\uff0c\u56e0\u6b64\u5bf9\u4e8e\u5206\u914d\u7ed9\u4e0d\u540c\u7684VC\u7684\u51e0\u4e2a\u6570\u636e\u5305\u4e4b\u95f4\u662f\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u7684\u3002</p> <p>\u56fe 7\u20116\u4e2d\u7684\u4f8b\u5b50\u4e2d\u542b\u6709\u4e24\u4e2aVC\uff08VC0\u548cVC1\uff09\uff0cVC1\uff1aVC0\u7684\u4f20\u8f93\u4f18\u5148\u7ea7\u662f3:1\u7684\u6bd4\u7387\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4f20\u8f933\u4e2aVC1\u6570\u636e\u5305\u624d\u4f1a\u53d1\u90011\u4e2aVC0\u6570\u636e\u5305\u3002Device Core\u5411TC/VC\u6620\u5c04\u903b\u8f91\u53d1\u9001\u8bf7\u6c42\uff08\u8bf7\u6c42\u5305\u4e2d\u5305\u542bTC\u503c\uff09\u3002\u57fa\u4e8e\u5df2\u7ecf\u89c4\u5212\u597d\u7684\u6620\u5c04\uff0c\u6570\u636e\u5305\u88ab\u653e\u5165\u76f8\u5e94\u7684VC Buffer\u4e2d\u7b49\u5f85\u4f20\u8f93\u3002\u6700\u7ec8\uff0cVC\u4ef2\u88c1\u5668\u51b3\u5b9a\u8fd9\u4e2a\u7531VC\u4f18\u5148\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u4e2a\u4f8b\u5b50\u5c55\u793a\u4e86\u4e00\u4e2a\u5355\u5411\u7684\u6d41\u7a0b\uff0c\u4f46\u662f\u540c\u6837\u7684\u903b\u8f91\u4e5f\u9002\u7528\u4e8e\u540c\u65f6\u8fdb\u884c\u76f8\u53cd\u65b9\u5411\u7684\u4f20\u8f93\u3002</p> <p>VC\u80fd\u529b\u5bc4\u5b58\u5668\u63d0\u4f9b\u4e86\u4e09\u79cd\u57fa\u672c\u7684VC\u4ef2\u88c1\u65b9\u5f0f\uff1a</p> <p>\\1.    \u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff08Strict Priority Arbitration**\uff09**\uff1a\u5728\u6240\u6709\u542b\u6709\u6570\u636e\u5305\u7684VC\u4e2d\uff0c\u62e5\u6709\u6700\u5927\u7f16\u53f7\u7684VC\u6c38\u8fdc\u8d62\u5f97\u4ef2\u88c1\u3002</p> <p>\\2.    \u5206\u7ec4\u4ef2\u88c1\uff08Group Arbitration**\uff09**:VC\u4eec\u88ab\u786c\u4ef6\u5206\u62101\u4e2a\u4f4e\u4f18\u5148\u7ea7\u7ec4\u548c1\u4e2a\u9ad8\u4f18\u5148\u7ea7\u7ec4\u3002\u4f4e\u4f18\u5148\u7ea7\u7ec4\u4f7f\u7528\u7684\u4ef2\u88c1\u65b9\u6cd5\u662f\u7531\u8f6f\u4ef6\u4ece\u53ef\u9009\u65b9\u6cd5\u4e2d\u6765\u9009\u53d6\u7684\uff0c\u800c\u9ad8\u4f18\u5148\u7ea7\u7ec4\u5219\u662f\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff08Strict Priority Arbitration\uff09\u3002</p> <p>\\3.    \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\uff08Hardware Fixed arbitration**\uff09**\uff1a\u4ef2\u88c1\u65b9\u6848\u6784\u5efa\u5728\u786c\u4ef6\u4e2d\u3002</p> <p></p> <p>\u56fe 7\u20116 VC\u4ef2\u88c1\u793a\u4f8b</p>"},{"location":"pcie/all/#732-vcstrict-priority-vc-arbitration","title":"7.3.2     \u4e25\u683c\u4f18\u5148\u7ea7VC\u4ef2\u88c1\uff08Strict Priority VC Arbitration\uff09","text":"<p>\u9ed8\u8ba4\u7684\u4f18\u5148\u7ea7\u65b9\u6848\u662f\u57fa\u4e8eVC ID\u7684\u56fa\u6709\u4f18\u5148\u7ea7\uff08VC0=\u6700\u4f4e\u4f18\u5148\u7ea7\uff0cVC7=\u6700\u9ad8\u4f18\u5148\u7ea7\uff09\u3002\u8fd9\u79cd\u673a\u5236\u662f\u81ea\u52a8\u7684\uff0c\u5e76\u4e0d\u9700\u8981\u4efb\u4f55\u989d\u5916\u914d\u7f6e\u3002\u56fe 7\u20117\u5c55\u793a\u4e86\u4e00\u4e2a\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\u7684\u4f8b\u5b50\uff0c\u5b83\u5305\u542b\u4e86\u6240\u6709\u76848\u4e2aVC\uff0c\u8fd9\u5176\u4e2d\u4f7f\u7528VC ID\u53f7\u6765\u7ba1\u7406\u4e8b\u52a1\u7684\u53d1\u9001\u987a\u5e8f\u3002\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\u7684VC\u7684\u6700\u5927\u7f16\u53f7\u4e0d\u80fd\u5927\u4e8e\u6269\u5c55VC\u8ba1\u6570\uff08Extended VC Count\uff09\u5b57\u6bb5\uff08\u5982\u56fe 7\u20115\uff09\u3002\u6b64\u5916\uff0c\u5982\u679c\u8bbe\u8ba1\u8005\u9009\u62e9\u8ba9\u6240\u6709\u7684VC\u90fd\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff0c\u90a3\u4e48\u56fe 7\u20118\u4e2d\u7684Port VC Capability Register 1\uff08\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56681\uff09\u7684Low Priority Extended VC Count\u5b57\u6bb5\u9700\u8981\u56fa\u5b9a\u4e3a0\u3002</p> <p></p> <p>\u56fe 7\u20117\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1</p> <p>\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\u8981\u6c42\u9ad8\u7f16\u53f7\u7684VC\u6c38\u8fdc\u8981\u4f18\u5148\u4e8e\u4f4e\u7f16\u53f7\u7684VC\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u6240\u6709\u76848\u4e2aVC\u90fd\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\u6765\u7ba1\u7406\uff0c\u90a3\u4e48VC0\u5c31\u53ea\u80fd\u5728\u5176\u4ed6\u6240\u6709VC\u90fd\u4e0d\u9700\u8981\u53d1\u9001\u6570\u636e\u5305\u65f6\u624d\u80fd\u53d1\u9001\u6570\u636e\u5305\u3002\u8fd9\u6837\u7684\u65b9\u5f0f\u53ef\u4ee5\u4f7f\u5f97\u6700\u9ad8\u4f18\u5148\u7ea7\u7684\u6570\u636e\u5305\u5f97\u5230\u5f88\u9ad8\u7684\u5e26\u5bbd\u4ee5\u53ca\u6700\u4f4e\u7684\u5ef6\u65f6\u3002\u4f46\u662f\uff0c\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\u53ef\u80fd\u4f1a\u4f7f\u5f97\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u9053\u5206\u914d\u4e0d\u5230\u5e26\u5bbd\uff08\u4e00\u76f4\u6709\u9ad8\u4f18\u5148\u7ea7\u901a\u9053\u5360\u7528\u6240\u6709\u53ef\u7528\u5e26\u5bbd\uff09\uff0c\u6240\u4ee5\u5fc5\u987b\u8981\u5c0f\u5fc3\u5730\u786e\u4fdd\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002\u534f\u8bae\u89c4\u8303\u4e2d\u8981\u6c42\u8981\u5bf9\u9ad8\u4f18\u5148\u7ea7\u6d41\u91cf\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u514d\u51fa\u73b0\u4f4e\u4f18\u5148\u7ea7\u901a\u9053\u7684\u5e26\u5bbd\u9965\u997f\uff0c\u5e76\u7ed9\u51fa\u4e86\u4e24\u79cd\u5bf9\u9ad8\u4f18\u5148\u7ea7\u6d41\u91cf\u8fdb\u884c\u7ba1\u7406\u7684\u65b9\u6cd5\uff1a</p> <p>n \u53d1\u8d77\u4e8b\u52a1\u7684\u7aef\u53e3\u53ef\u4ee5\u9650\u5236\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u7684\u6ce8\u5165\u901f\u7387\uff0c\u4ece\u800c\u5c31\u53ef\u4ee5\u4e3a\u4f4e\u4f18\u5148\u7ea7\u4e8b\u52a1\u63d0\u4f9b\u66f4\u591a\u5e26\u5bbd\u3002</p> <p>n Switch\u53ef\u4ee5\u5728\u51fa\u53e3\u7aef\u53e3\uff08egress port\uff09\u8c03\u8282\u591a\u4e2a\u6d41\u91cf\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u4f1a\u9650\u5236\u67d0\u4e9b\u5e94\u7528\u548c\u8bbe\u5907\u7684\u541e\u5410\u91cf\uff0c\u901a\u5e38\u8fd9\u4e9b\u5e94\u7528\u8bbe\u5907\u662f\u4e00\u4e9b\u8bd5\u56fe\u8d85\u8fc7\u53ef\u7528\u5e26\u5bbd\u9650\u5236\u7684\u9ad8\u5e26\u5bbd\u5e94\u7528\u548c\u8bbe\u5907\u3002</p> <p>\u8bbe\u5907\u7684\u8bbe\u8ba1\u8005\u53ef\u80fd\u4e5f\u9700\u8981\u9650\u5236\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u7684VC\u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06VC\u4eec\u5206\u4e3a1\u4e2a\u4f4e\u4f18\u5148\u7ea7\u7ec4\u54081\u4e2a\u9ad8\u4f18\u5148\u7ea7\u7ec4\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff0c\u5728\u4e0b\u4e00\u5c0f\u8282\u6211\u4eec\u5c06\u4f1a\u8ba8\u8bba\u8fd9\u79cd\u5206\u7ec4\u65b9\u6cd5\u3002</p>"},{"location":"pcie/all/#733-group-arbitration","title":"7.3.3     \u5206\u7ec4\u4ef2\u88c1\uff08Group Arbitration\uff09","text":"<p>\u56fe 7\u20118\u5c55\u793a\u4e86Port VC Capability Register 1\uff08\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56681 \uff09\u7684Low Priority Extended VC Count\u5b57\u6bb5\u3002\u8fd9\u4e2a\u53ea\u8bfb\uff08read-only\uff09\u5b57\u6bb5\u6307\u5b9a\u4e86\u8be5\u8bbe\u5907\u4f4e\u4f18\u5148\u7ea7\u4ef2\u88c1\u7ec4\u7684VC ID\u4e0a\u9650\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u662f4\uff0c\u90a3\u4e48\u5c31\u8bf4\u660eVC0-VC4\u90fd\u5c5e\u4e8e\u4f4e\u4f18\u5148\u7ea7\u7ec4\uff0c\u800c\u5269\u4e0b\u7684VC5-VC7\u5219\u662f\u9ad8\u4f18\u5148\u7ea7\u7ec4\u3002\u6ce8\u610f\uff0c\u82e5Low Priority Extended VC Count\u7684\u503c\u4e3a7\uff0c\u5219\u8bf4\u660e\u6ca1\u6709VC\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u3002</p> <p></p> <p>\u56fe 7\u20118\u4f4e\u4f18\u5148\u7ea7\u6269\u5c55VC\u8ba1\u6570</p> <p>\u5982\u56fe 7\u201110\u6240\u5c55\u793a\u7684\u90a3\u6837\uff0c\u9ad8\u4f18\u5148\u7ea7\u7ec4\u7684VC\u4f1a\u7ee7\u7eed\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff0c\u4f46\u662f\u4f4e\u4f18\u5148\u7ea7\u4ef2\u88c1\u7ec4\u5219\u4f1a\u4f7f\u7528\u8bbe\u5907\u652f\u6301\u7684\u5176\u4ed6\u7684\u4e00\u79cd\u4ef2\u88c1\u65b9\u6cd5\u3002\u5982\u56fe 7\u20119\u6240\u793a\uff0cPort VC Capability Register 2\uff08\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56682\uff09\u7528\u6765\u8868\u793a\u8bbe\u5907\u53ef\u4ee5\u652f\u6301\u4f4e\u4f18\u5148\u7ea7\u7ec4\u4f7f\u7528\u54ea\u4e9b\u66ff\u4ee3\u4ef2\u88c1\u65b9\u6cd5\uff0c\u800cVC Control Register\uff08VC\u63a7\u5236\u5bc4\u5b58\u5668\uff09\u4f1a\u5141\u8bb8\u5177\u4f53\u9009\u62e9\u4e86\u54ea\u79cd\u4ef2\u88c1\u65b9\u6cd5\u3002\u4f4e\u4f18\u5148\u7ea7\u4ef2\u88c1\u65b9\u6848\u5305\u62ec\uff1a</p> <p>n \u57fa\u4e8e\u786c\u4ef6\u7684\u56fa\u5b9a\u4ef2\u88c1\uff08Hardware Based Fixed Arbitration\uff09</p> <p>n \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1WRR\uff08Weighted Round Robin Arbitration\uff09</p> <p></p> <p>\u56fe 7\u20119 VC\u4ef2\u88c1\u80fd\u529b\u5b57\u6bb5</p> <p></p> <p>\u56fe 7\u201110 VC\u4ef2\u88c1\u4f18\u5148\u7ea7\uff08\u5206\u7ec4\u4ef2\u88c1\uff09</p>"},{"location":"pcie/all/#7331-hardware-fixed-arbitration-scheme","title":"7.3.3.1   \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\u65b9\u6848\uff08Hardware Fixed Arbitration Scheme\uff09","text":"<p>\u8fd9\u4e2a\u65b9\u6848\u5b9a\u4e49\u4e86\u4e00\u79cd\u57fa\u4e8e\u7eaf\u786c\u4ef6\u7684\u4ef2\u88c1\u65b9\u6cd5\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u989d\u5916\u7684\u8f6f\u4ef6\u8bbe\u7f6e\u3002\u8fd9\u79cd\u7eaf\u786c\u4ef6\u7684\u4ef2\u88c1\u65b9\u6cd5\u53ef\u4ee5\u662f\u786c\u4ef6\u8bbe\u8ba1\u8005\u5b9e\u73b0\u7684\u4efb\u4f55\u4e00\u79cd\u65b9\u6cd5\uff0c\u800c\u4e14\u8fd9\u79cd\u65b9\u6cd5\u8fd8\u53ef\u4ee5\u57fa\u4e8e\u9884\u671f\u7684\u8bbe\u5907\u8d1f\u8f7d\u6216\u5e26\u5bbd\u6765\u8fdb\u884c\u8bbe\u8ba1\u3002\u4e3e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u4e00\u4e2a\u666e\u901a\u7684\u8f6e\u8be2\u8c03\u5ea6\u4e2d\uff0c\u6bcf\u4e2aVC\u90fd\u4f1a\u5f97\u5230\u76f8\u540c\u7684\u6b21\u6570\u6765\u5faa\u73af\u8f6e\u6d41\u53d1\u9001\u6570\u636e\u5305\u3002</p>"},{"location":"pcie/all/#7332-weighted-round-robin-arbitration-scheme","title":"7.3.3.2   \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\u65b9\u6848\uff08Weighted Round Robin Arbitration Scheme\uff09","text":"<p>\u5728\u8fd9\u79cd\u65b9\u6cd5\u4e2d\uff0c\u67d0\u4e9bVC\u53ef\u4ee5\u88ab\u7ed9\u4e88\u6bd4\u5176\u4ed6VC\u66f4\u5927\u7684\u6743\u91cd\uff08\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\uff09\uff0c\u8fd9\u4e9b\u9ad8\u6743\u91cdVC\u4f1a\u6bd4\u5176\u4ed6VC\u5f97\u5230\u66f4\u591a\u7684entries\uff08\u6761\u76ee\uff09\uff0c\u4e5f\u5c31\u662f\u66f4\u591a\u7684\u53d1\u9001\u6570\u636e\u5305\u7684\u673a\u4f1a\u3002\u534f\u8bae\u89c4\u8303\u5b9a\u4e49\u4e86\u4e09\u79cdWRR\u9009\u9879\uff0c\u6bcf\u79cd\u9009\u9879\u90fd\u5177\u6709\u4e0d\u540c\u6570\u91cf\u7684entries\uff08\u79f0\u4e3aphase\u201c\u9636\u6bb5\u201d\uff09\u3002\u8868\u9879\u7684\u5927\u5c0f\u901a\u8fc7\u5f80Port VC Control Register\uff08\u7aef\u53e3VC\u63a7\u5236\u5bc4\u5b58\u5668\uff0c\u56fe 7\u20119\uff09\u4e2d\u7684VC Arbitration Select\uff08VC\u4ef2\u88c1\u9009\u62e9\uff09\u5b57\u6bb5\u5199\u5165\u76f8\u5e94\u7684\u503c\u6765\u8fdb\u884c\u9009\u62e9\u3002\u8868\u9879\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u90fd\u4ee3\u8868\u4e00\u4e2a\u8f6f\u4ef6\u4f7f\u7528\u4f4e\u4f18\u5148\u7ea7VC\u7684\u9636\u6bb5\u3002VC\u4ef2\u88c1\u5668\u4f1a\u4ee5\u8fde\u7eed\u7684\u65b9\u5f0f\u53cd\u590d\u7684\u626b\u63cf\u8868\u9879\u7684\u6240\u6709\u6761\u76ee\uff0c\u7136\u540e\u4f1a\u901a\u8fc7\u8868\u9879\u6761\u76ee\u5185\u6307\u5b9a\u7684VC\u6765\u53d1\u9001\u6570\u636e\u5305\u3002\u4e00\u65e6\u4e00\u4e2a\u6570\u636e\u5305\u88ab\u53d1\u51fa\uff0c\u90a3\u4e48\u4ef2\u88c1\u5668\u5c31\u4f1a\u9a6c\u4e0a\u53bb\u626b\u63cf\u4e0b\u4e00\u4e2a\u6761\u76ee\uff08entry\uff09\uff0c\u4e5f\u5c31\u662f\u8fdb\u5165\u4e0b\u4e00\u4e2a\u9636\u6bb5\uff08phase\uff09\u3002\u56fe 7\u201111\u5c55\u793a\u4e86\u4e00\u4e2a\u62e5\u670964\u4e2a\u6761\u76ee\u7684WRR\u4ef2\u88c1\u8868\u3002</p> <p></p> <p>\u56fe 7\u201111 WRR VC\u4ef2\u88c1\u8868</p>"},{"location":"pcie/all/#7333","title":"7.3.3.3   \u5efa\u7acb\u865a\u62df\u901a\u9053\u4ef2\u88c1\u8868","text":"<p>VC Arbitration Table\uff08VAT\uff0cVC\u4ef2\u88c1\u8868\uff09\u4f4d\u4e8e\u914d\u7f6e\u7a7a\u95f4\u4e2d\uff0c\u5b83\u7684\u5177\u4f53\u7684\u4f4d\u7f6e\u7684\u8868\u793a\u65b9\u6cd5\u662f\u4e00\u4e2a\u504f\u79fb\u91cf\uff0c\u5176\u57fa\u5740\u4e3aVC\u80fd\u529b\u7ed3\u6784\uff08VC Capability Structure\uff09\u7684\u5730\u5740\uff0c\u5982\u56fe 7\u201112\u6240\u793a\u3002 </p> <p>\u5982\u56fe 7\u201113\u6240\u793a\uff0cVAT\uff08VC Arbitration Table\uff09\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u90fd\u662f\u4e00\u4e2a4bit\u5b57\u6bb5\uff0c\u5b83\u7528\u6765\u6307\u793a\u8fd9\u4e2a\u9636\u6bb5\u4e2d\u9700\u8981\u53d1\u9001\u6570\u636e\u7684VC\u7684ID\u53f7\u3002\u6574\u4e2aVAT\u8868\u7684\u957f\u5ea6\uff08\u6709\u591a\u5c11\u6761\u76ee\uff09\u662f\u901a\u8fc7\u56fe 7\u20119\u4e2d\u7684\u4ef2\u88c1\u9009\u9879\u6765\u8fdb\u884c\u9009\u62e9\u7684\u3002</p> <p></p> <p>\u56fe 7\u201112 VC\u4ef2\u88c1\u8868\u504f\u79fb\u5b57\u6bb5\u4ee5\u53ca\u52a0\u8f7dVC\u4ef2\u88c1\u8868\u5b57\u6bb5</p> <p>\u8fd9\u4e2a\u8868\u7531\u914d\u7f6e\u8f6f\u4ef6\u52a0\u8f7d\uff0c\u4ee5\u5b9e\u73b0\u865a\u62df\u901a\u9053\u6240\u9700\u8981\u7684\u4f18\u5148\u7ea7\u987a\u5e8f\u3002\u5f53\u8868\u53d1\u751f\u4e86\u4efb\u4f55\u53d8\u5316\u65f6\uff0c\u786c\u4ef6\u4f1a\u8bbe\u7f6eVC Arbitration Table Statue bit\uff08VC\u4ef2\u88c1\u8868\u72b6\u6001\u4f4d\uff09\uff0c\u8fd9\u4e3a\u8f6f\u4ef6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9014\u5f84\u6765\u9a8c\u8bc1\u8868\u9879\u867d\u7136\u53d1\u751f\u7684\u6539\u53d8\u4f46\u662f\u8fd8\u6ca1\u6709\u771f\u6b63\u4f5c\u7528\u5728\u786c\u4ef6\u4e0a\u3002\u4e00\u65e6\u8868\u88ab\u52a0\u8f7d\u5b8c\u6210\uff0c\u8f6f\u4ef6\u5c31\u4f1a\u8bbe\u7f6e\u7aef\u53e3VC\u63a7\u5236\u5bc4\u5b58\u5668\uff08\u56fe 7\u20119\uff09\u4e2d\u7684Load VC Arbitration Table bit\uff08\u52a0\u8f7dVC\u4ef2\u88c1\u8868\u4f4d\uff09\u3002\u8fd9\u4f1a\u4f7f\u5f97\u786c\u4ef6\u5bf9\u65b0\u7684\u8868\u9879\u8fdb\u884c\u52a0\u8f7d\uff0c\u5c06\u65b0\u7684\u503c\u5e94\u7528\u5728VC\u4ef2\u88c1\u5668\u4e2d\u3002\u5f53\u8868\u9879\u88ab\u52a0\u8f7d\u5b8c\u6210\u5e76\u5e94\u7528\u540e\uff0c\u786c\u4ef6\u5c31\u4f1a\u6e05\u9664VC Arbitration Table Statue bit\uff08VC\u4ef2\u88c1\u8868\u72b6\u6001\u4f4d\uff09\uff0c\u8fd9\u4e5f\u5c31\u901a\u77e5\u4e86\u8f6f\u4ef6\u5173\u4e8e\u8868\u9879\u52a0\u8f7d\u7684\u64cd\u4f5c\u5df2\u7ecf\u5b8c\u6210\u3002\u8fd9\u79cd\u8868\u9879\u52a0\u8f7d\u7684\u65b9\u5f0f\u7684\u52a8\u673a\u53ef\u80fd\u662f\u4e3a\u4e86\u5728\u7cfb\u7edf\u8fd0\u884c\u4e2d\u4e5f\u80fd\u66f4\u6539\u8868\u5185\u5bb9\u800c\u4e0d\u4e2d\u65ad\u7cfb\u7edf\u7684\u8fd0\u884c\u3002\u4f46\u662f\u95ee\u9898\u662f\u914d\u7f6e\u5199\u64cd\u4f5c\u4e00\u6b21\u4ec5\u80fd\u66f4\u65b01DW\u7684\u8868\u5185\u5bb9\uff0c\u5b83\u662f\u4e00\u79cd\u76f8\u5bf9\u6162\u901f\u7684\u4e8b\u52a1\uff0c\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u9700\u8981\u4e00\u6bb5\u6bd4\u8f83\u957f\u7684\u65f6\u95f4\u624d\u80fd\u5b8c\u6210\u6574\u4e2a\u8868\u5185\u5bb9\u7684\u66f4\u65b0\uff0c\u800c\u5728\u8fd9\u6bb5\u65f6\u95f4\u91cc\u8fd9\u4e2a\u8868\u4ec5\u4ec5\u8fdb\u884c\u4e86\u90e8\u5206\u66f4\u65b0\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u8fd9\u6709\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8bbe\u5907\u5728\u8fd9\u6bb5\u65f6\u95f4\u91cc\u7ee7\u7eed\u8fd0\u884c\u65f6\u51fa\u73b0\u610f\u6599\u4e4b\u5916\u7684\u884c\u4e3a\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u8fd9\u79cd\u673a\u5236\u5141\u8bb8\u8f6f\u4ef6\u5b8c\u6210\u5bf9\u6574\u4e2a\u8868\u7684\u66f4\u6539\u4e4b\u540e\uff0c\u5728\u7edf\u4e00\u7684\u4e00\u6b21\u5c06\u5b83\u4eec\u5168\u90e8\u5e94\u7528\u5728\u786c\u4ef6\u4ef2\u88c1\u5668\u4e2d\u3002</p> <p></p> <p>\u56fe 7\u201113\u52a0\u8f7dVC\u4ef2\u88c1\u8868\u6761\u76ee</p>"},{"location":"pcie/all/#74-port-arbitration","title":"7.4 \u7aef\u53e3\u4ef2\u88c1\uff08Port Arbitration\uff09","text":""},{"location":"pcie/all/#741-general","title":"7.4.1     \u6574\u4f53\u8bf4\u660e\uff08General\uff09","text":"<p>Switch\u7aef\u53e3\u548cRoot\u7aef\u53e3\u7ecf\u5e38\u63a5\u6536\u5230\u4e00\u4e9b\u9700\u8981\u8f6c\u53d1\u81f3\u5176\u4ed6\u7aef\u53e3\u7684\u6570\u636e\u5305\u3002\u8fd9\u4e9b\u6570\u636e\u5305\u867d\u7136\u7531\u591a\u4e2a\u7aef\u53e3\u8fdb\u884c\u63a5\u6536\uff0c\u4f46\u662f\u5b83\u4eec\u53ef\u80fd\u4f1a\u90fd\u9700\u8981\u8f6c\u53d1\u81f3\u540c\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\u7684\u540c\u4e00\u4e2aVC\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u4ef2\u88c1\u673a\u5236\u6765\u51b3\u5b9a\u8fd9\u4e9b\u4e0d\u540c\u7aef\u53e3\u8f93\u5165\u7684\u6570\u636e\u5305\u5982\u4f55\u4f9d\u6b21\u7684\u653e\u5165\u540c\u4e00\u4e2a\u76ee\u6807VC\u3002\u7c7b\u4f3c\u4e8eVC\u4ef2\u88c1\uff0c\u7aef\u53e3\u4ef2\u88c1\u4e5f\u6709\u591a\u79cd\u53ef\u9009\u65b9\u6848\u4f9b\u914d\u7f6e\u8f6f\u4ef6\u9009\u62e9\u3002TC\u3001VC\u548c\u4ef2\u88c1\u65b9\u6cd5\u7684\u591a\u79cd\u7ec4\u5408\u53ef\u4ee5\u652f\u6301\u4e00\u7cfb\u5217\u7684\u670d\u52a1\u7ea7\u522b\uff0c\u8fd9\u4e9b\u670d\u52a1\u7ea7\u522b\u5206\u4e3a\u4e24\u4e2a\u5927\u7c7b\uff1a</p> <p>\\1.    \u5f02\u6b65\u7c7b\u578b\uff08Asynchronous**\uff09**\uff1a\u6570\u636e\u5305\u4f1a\u5f97\u5230\u201c\u5c3d\u529b\u800c\u4e3aBest Effort\u201d\u7684\u670d\u52a1\uff0c\u5e76\u4e14\u53ef\u80fd\u672c\u8eab\u4e5f\u6ca1\u6709\u6536\u5230\u4efb\u4f55\u7684\u504f\u597d\u9700\u8981\u8003\u8651\u3002\u8bb8\u591a\u8bbe\u5907\u548c\u5e94\u7528\uff0c\u4f8b\u5982\u5927\u5bb9\u91cf\u5b58\u50a8\u8bbe\u5907\uff0c\u5bf9\u5e26\u5bbd\u6216\u8005\u5ef6\u65f6\u5e76\u6ca1\u6709\u5f88\u4e25\u683c\u7684\u8981\u6c42\uff0c\u5e76\u4e0d\u9700\u8981\u7279\u6b8a\u7684\u5b9a\u65f6\u673a\u5236\u3002\u4ece\u53e6\u4e00\u65b9\u9762\u8bf4\uff0c\u901a\u8fc7\u4e3a\u4e0d\u540c\u7684\u6570\u636e\u5305\u5efa\u7acb\u6d41\u91cf\u7c7b\u578b\uff08Traffic Class\uff09\u8fd9\u79cd\u5c42\u6b21\u7ed3\u6784\uff0c\u90a3\u4e9b\u9700\u6c42\u66f4\u591a\u7684\u5e94\u7528\u6240\u4ea7\u751f\u7684\u6570\u636e\u5305\u53ef\u4ee5\u4ecd\u7136\u5212\u5206\u4f18\u5148\u7ea7\u5e76\u4e14\u4fdd\u6301\u5176\u4f18\u5148\u7ea7\u5730\u4f4d\u3002\u5728\u670d\u52a1\u7684\u7ea7\u522b\u9700\u8981\u4fdd\u8bc1\u4e4b\u524d\uff0c\u5373\u4f7f\u662f\u5dee\u5f02\u5316\u670d\u52a1\u4e5f\u4f1a\u88ab\u8ba4\u4e3a\u662f\u5f02\u6b65\u7684\u3002\u5f53\u7136\uff0c\u5f02\u6b65\u670d\u52a1\u5c06\u603b\u662f\u53ef\u7528\u7684\uff0c\u800c\u4e0d\u9700\u8981\u4efb\u4f55\u7279\u522b\u7684\u8f6f\u4ef6\u6216\u8005\u786c\u4ef6\u9009\u9879\u3002</p> <p>\\2.    \u540c\u6b65\u7b49\u65f6\u7c7b\u578b\uff08Isochronous**\uff09**\uff1a\u5f53\u670d\u52a1\u9700\u8981\u4fdd\u8bc1\u5ef6\u65f6\u548c\u5e26\u5bbd\u65f6\uff0c\u6211\u4eec\u5c06\u5b83\u79fb\u52a8\u5230\u540c\u6b65\u7b49\u65f6\u7c7b\u578b\uff08Isochronous\uff09\u8fd9\u4e00\u5927\u7c7b\u4e2d\u3002\u5f53\u4e24\u4e2a\u8bbe\u5907\u4e4b\u95f4\u901a\u5e38\u9700\u8981\u540c\u6b65\u8fde\u63a5\uff08Synchronous connection\uff09\u65f6\uff0c\u8fd9\u5c06\u4f1a\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0c\u5f53\u8033\u673a\u76f4\u63a5\u63d2\u5165\u9a71\u52a8\u5668\u65f6\uff0c\u5b83\u4e0e\u4ece\u97f3\u4e50CD\u4e2d\u83b7\u53d6\u6570\u636e\u7684CD-ROM\u4e4b\u95f4\u4f7f\u7528\u7684\u662f\u540c\u6b65\u8fde\u63a5\u3002\u7136\u800c\uff0c\u5f53\u97f3\u9891\u6570\u636e\u5fc5\u987b\u8981\u901a\u8fc7\u4e00\u4e2a\u50cfPCIe\u4e00\u6837\u7684\u901a\u7528\u603b\u7ebf\u4e4b\u540e\u624d\u80fd\u5230\u8fbe\u5916\u90e8\u626c\u58f0\u5668\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u7684\u8fde\u63a5\u5c31\u4e0d\u662f\u540c\u6b65\u7684\u4e86\uff0c\u56e0\u4e3a\u5176\u4ed6\u7684\u6d41\u91cf\u4e5f\u6709\u53ef\u80fd\u8981\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u6d41\u8def\u5f84\u3002\u4e3a\u4e86\u8fbe\u5230\u76f8\u540c\u7684\u6548\u679c\uff0c\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u5fc5\u987b\u4fdd\u8bc1\u5728\u4e0d\u963b\u6b62\u5176\u4ed6\u6d41\u91cf\u4f7f\u7528\u94fe\u8def\u7684\u540c\u65f6\uff0c\u80fd\u591f\u53ca\u65f6\u6b63\u786e\u7684\u4f20\u8f93\u8fd9\u4e9b\u65f6\u95f4\u654f\u611f\uff08time-sensitive\uff09\u7684\u97f3\u9891\u6570\u636e\u4fe1\u606f\u3002\u6beb\u65e0\u7591\u95ee\uff0c\u8fd9\u5c31\u5fc5\u987b\u8981\u6709\u4e13\u95e8\u7684\u8f6f\u4ef6\u548c\u786c\u4ef6\u8bbe\u8ba1\u6765\u652f\u6301\u5b83\u3002</p> <p>\u5173\u4e8e\u7aef\u53e3\u4ef2\u88c1\u7684\u6982\u5ff5\u5982\u56fe 7\u201114\u6240\u793a\u3002\u9700\u8981\u6ce8\u610f\uff0c\u7aef\u53e3\u4ef2\u88c1\u5728\u7cfb\u7edf\u4e2d\u7684\u591a\u4e2a\u4f4d\u7f6e\u90fd\u4f1a\u51fa\u73b0\uff1a</p> <p>n Switch\u7684\u51fa\u53e3\u7aef\u53e3\uff08egress\uff09</p> <p>n \u652f\u6301Peer-to-Peer\u4e8b\u52a1\u65f6\u7684RC\u7aef\u53e3</p> <p>n \u67d0\u4e9bRC\u51fa\u53e3\u7aef\u53e3\uff0c\u5b83\u4eec\u901a\u5411\u7684\u76ee\u7684\u5730\u662f\u4e3b\u5b58</p> <p>\u7aef\u53e3\u4ef2\u88c1\u901a\u5e38\u9700\u8981\u5bf9Switch\u6216\u8005Root\u7684\u51fa\u53e3\u7aef\u53e3\u7684\u6bcf\u4e2a\u865a\u62df\u901a\u9053\u8fdb\u884c\u8f6f\u4ef6\u914d\u7f6e\u3002\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cRoot\u7aef\u53e32\u652f\u6301\u6765\u81eaRoot\u7aef\u53e31\u548c3\u7684Peer-to-Peer\u4f20\u8f93\uff0c\u56e0\u6b64\u8fd9\u91cc\u9700\u8981\u7aef\u53e3\u4ef2\u88c1\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9\u4e8eRoot\u7aef\u53e3\u95f4\u652f\u6301Peer-to-Peer\u7684\u4f20\u8f93\u662f\u53ef\u9009\u7684\uff0c\u56e0\u6b64\u5e76\u4e0d\u662f\u6bcf\u4e2aRoot\u51fa\u53e3\u7aef\u53e3\u90fd\u9700\u8981\u7aef\u53e3\u4ef2\u88c1\u3002</p> <p>\u4e0e\u7cfb\u7edf\u5185\u5b58\u76f8\u8fde\u63a5\u7684\u8def\u5f84\u662f\u4e00\u6761\u6709\u8da3\u7684\u8def\u5f84\u3002\u8fd9\u91cc\u53ef\u80fd\u4f1a\u6709\u6765\u81ea\u591a\u4e2a\u5165\u53e3\u7aef\u53e3\uff08ingress\uff09\u7684\u6570\u636e\u5305\u5728\u540c\u4e00\u65f6\u95f4\u90fd\u60f3\u8981\u8bbf\u95ee\u8fd9\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\uff0c\u56e0\u6b64\u5b83\u9700\u8981\u652f\u6301\u7aef\u53e3\u4ef2\u88c1\u3002\u7136\u800c\uff0c\u5b83\u6240\u4f7f\u7528\u7684\u5e76\u4e0d\u662f\u4e00\u4e2aPCIe\u7aef\u53e3\uff0c\u56e0\u6b64\u5b83\u5e76\u4e0d\u9700\u8981\u901a\u8fc7\u914d\u7f6e\u6211\u4eec\u63a5\u4e0b\u6765\u8981\u8ba8\u8bba\u7684PCIe\u5bc4\u5b58\u5668\u6765\u5bf9\u7aef\u53e3\u4ef2\u88c1\u8fdb\u884c\u652f\u6301\u3002\u76f8\u53cd\u5730\uff0cRC\u9700\u8981\u63d0\u4f9b\u4f9b\u5e94\u5546\u6307\u5b9a\u7684\uff08vendor-specific\uff09\u7684\u4e00\u7ec4\u5bc4\u5b58\u5668\u6765\u63d0\u4f9b\u8fd9\u65b9\u9762\u7684\u529f\u80fd\uff0c\u5b83\u88ab\u79f0\u4e3aRoot Complex Register Block\uff08RCRB\uff0cRC\u5bc4\u5b58\u5668\u5757\uff09</p> <p>\u56e0\u4e3a\u51fa\u53e3\u7aef\u53e3\u7684\u6bcf\u4e2aVC\u7684\u7aef\u53e3\u4ef2\u88c1\u90fd\u662f\u72ec\u7acb\u7ba1\u7406\u7684\uff0c\u6240\u4ee5\u6bcf\u4e2a\u652f\u6301\u53ef\u7f16\u7a0b\u7684\u7aef\u53e3\u4ef2\u88c1\u7684VC\u90fd\u9700\u8981\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u4ef2\u88c1\u8868\uff0c\u5982\u56fe 7\u201115\u6240\u793a\u3002\u53ea\u6709Switch\u548cRC\u7aef\u53e3\u624d\u652f\u6301\u7aef\u53e3\u4ef2\u88c1\u8868\uff0cEP\u5185\u662f\u4e0d\u5141\u8bb8\u4f7f\u7528\u7aef\u53e3\u4ef2\u88c1\u8868\u7684\u3002</p> <p></p> <p>\u56fe 7\u201114\u7aef\u53e3\u4ef2\u88c1\u6982\u5ff5</p> <p></p> <p>\u56fe 7\u201115\u6bcf\u4e2aVC\u7684\u7aef\u53e3\u4ef2\u88c1\u8868</p> <p>\u5c3d\u7ba1\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u8bf4\u660e\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u9488\u5bf9\u4e0d\u540c\u7684\u6570\u636e\u5305\u6d41\u4e4b\u95f4\u7684\u4ef2\u88c1\u9700\u8981\u5728\u51fa\u53e3\u7aef\u53e3\u4e2d\u4f7f\u7528\u989d\u5916\u7684Buffer\u6765\u79ef\u6512\u6765\u81ea\u591a\u4e2a\u7aef\u53e3\u7684\u6d41\u91cf\uff0c\u5982\u56fe 7\u201116\u6240\u793a\u3002\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u6709\u4e24\u4e2a\u5165\u53e3\u7aef\u53e3\uff08\u7aef\u53e31\u548c2\uff09\uff0c\u5b83\u4eec\u7684\u4e8b\u52a1\u90fd\u88ab\u8def\u7531\u81f3\u540c\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\uff08\u7aef\u53e33\uff09\u3002Switch\u6240\u8fdb\u884c\u7684\u64cd\u4f5c\u5305\u62ec\uff1a</p> <p>\\1.    \u5230\u8fbe\u5165\u53e3\u7aef\u53e3\u7684\u6570\u636e\u5305\u76f4\u63a5\u6839\u636eTC/VC\u6620\u5c04\u88ab\u653e\u5165\u76f8\u5e94\u7684\u6d41\u63a7Buffer\uff08VC\uff09\u3002</p> <p>\\2.    \u6570\u636e\u5305\u4ece\u6d41\u63a7Buffer\u4e2d\u88ab\u8f6c\u53d1\u81f3\u8def\u7531\u903b\u8f91\uff0c\u8def\u6709\u903b\u8f91\u5c06\u51b3\u5b9a\u6570\u636e\u5305\u88ab\u8def\u7531\u81f3\u54ea\u4e2a\u51fa\u53e3\u7aef\u53e3\uff0c\u5e76\u5b8c\u6210\u8def\u7531\u64cd\u4f5c\u3002</p> <p>\\3.    \u88ab\u8def\u7531\u81f3\u51fa\u53e3\u7aef\u53e3\uff08\u7aef\u53e33\uff09\u7684\u6570\u636e\u5305\u901a\u8fc7TC/VC\u6620\u5c04\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u4ed6\u4eec\u5e94\u8be5\u88ab\u653e\u5165\u51fa\u53e3\u7aef\u53e3\u7684\u54ea\u4e00\u4e2aVC\u3002</p> <p>\\4.    \u6bcf\u4e2a\u5165\u53e3\u7aef\u53e3\u90fd\u5b58\u5728\u4e00\u7ec4Buffer\u4e0e\u4e4b\u76f8\u5173\u8054\uff0c\u5141\u8bb8\u5728\u7aef\u53e3\u4ef2\u88c1\u5b8c\u6210\u524d\u90fd\u53ef\u4ee5\u8ffd\u8e2a\u5165\u53e3\u7aef\u53e3\u53f7\u3002</p> <p>\\5.    \u7aef\u53e3\u4ef2\u88c1\u903b\u8f91\u51b3\u5b9a\u6bcf\u7ec4\u5165\u53e3Buffer\u53d1\u9001\u4e8b\u52a1\u7684\u987a\u5e8f\u3002</p> <p></p> <p>\u56fe 7\u201116\u7aef\u53e3\u4ef2\u88c1\u7f13\u51b2</p>"},{"location":"pcie/all/#742-port-arbitration-mechanisms","title":"7.4.2     \u7aef\u53e3\u4ef2\u88c1\u673a\u5236\uff08Port Arbitration Mechanisms\uff09","text":"<p>\u5b9e\u9645\u4e0a\u7aef\u53e3\u4ef2\u88c1\u7684\u673a\u5236\u7684\u5b9a\u4e49\u4e0eVC\u4ef2\u88c1\u6240\u4f7f\u7528\u7684\u6a21\u578b\u6bd4\u8f83\u76f8\u4f3c\u3002\u914d\u7f6e\u8f6f\u4ef6\u901a\u8fc7\u8bfb\u53d6\u56fe 7\u201117\u6240\u793a\u7684\u5bc4\u5b58\u5668\u6765\u786e\u5b9a\u7aef\u53e3\u7684\u80fd\u529b\uff0c\u5e76\u4e3a\u6bcf\u4e2aVC\u9009\u62e9\u7aef\u53e3\u4ef2\u88c1\u65b9\u6848\u3002</p> <p></p> <p>\u56fe 7\u201117\u8f6f\u4ef6\u9009\u62e9\u7aef\u53e3\u4ef2\u88c1\u65b9\u6848</p>"},{"location":"pcie/all/#7421-hardware-fixed-arbitration","title":"7.4.2.1   \u786c\u4ef6\u56fa\u5b9a\u4ef2\u88c1\uff08Hardware-Fixed Arbitration\uff09","text":"<p>\u8fd9\u79cd\u4ef2\u88c1\u673a\u5236\u4e0d\u9700\u8981\u8f6f\u4ef6\u8bbe\u7f6e\u3002\u4e00\u65e6\u5b83\u88ab\u9009\u62e9\u4f7f\u7528\uff0c\u90a3\u4e48\u5c31\u4ec5\u7531\u786c\u4ef6\u6765\u8fdb\u884c\u7ba1\u7406\u3002\u5b9e\u9645\u7684\u4ef2\u88c1\u65b9\u6848\u7531\u786c\u4ef6\u7684\u8bbe\u8ba1\u8005\u9009\u62e9\uff0c\u53ef\u80fd\u4f1a\u57fa\u4e8e\u8bbe\u5907\u7684\u9884\u671f\u9700\u6c42\u6765\u8fdb\u884c\u9009\u62e9\u3002\u5b83\u4e5f\u8bb8\u53ea\u662f\u7b80\u5355\u7684\u4fdd\u8bc1\u4e86\u4ef2\u88c1\u7684\u516c\u5e73\u6027\uff0c\u6216\u8005\u662f\u4f18\u5316\u4e86\u8bbe\u8ba1\u7684\u67d0\u4e9b\u65b9\u9762\uff0c\u4f46\u662f\u5b83\u65e0\u6cd5\u652f\u6301\u5dee\u5f02\u5316\u6216\u540c\u6b65\u670d\u52a1\u3002</p>"},{"location":"pcie/all/#7422-wrr-arbitration","title":"7.4.2.2   \u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\uff08WRR Arbitration\uff09","text":"<p>\u5c31\u50cfVC\u4ef2\u88c1\u4e2d\u7684\u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\u673a\u5236\u7c7b\u4f3c\uff0c\u8f6f\u4ef6\u53ef\u4ee5\u8bbe\u7f6e\u7aef\u53e3\u4ef2\u88c1\u8868\uff0c\u4ee5\u6b64\u6765\u8ba9\u4e00\u4e9b\u7aef\u53e3\u5728\u4ef2\u88c1\u4e2d\u6709\u66f4\u591a\u7684\u88ab\u9009\u4e2d\u7684\u673a\u4f1a\u3002\u8fd9\u79cd\u65b9\u6cd5\u4e3a\u6765\u81ea\u4e0d\u540c\u7aef\u53e3\u7684\u6d41\u91cf\u5206\u914d\u4e86\u4e0d\u540c\u7684\u4ef2\u88c1\u6743\u91cd\u3002</p> <p>\u5728\u626b\u63cf\u4ef2\u88c1\u8868\u65f6\uff0c\u5176\u4e2d\u7684\u6bcf\u4e2a\u9636\u6bb5\uff08Phase\uff09\u90fd\u4f1a\u6307\u5b9a\u4e0b\u4e00\u4e2a\u88ab\u63a5\u6536\u7684\u6570\u636e\u5305\u7684\u5165\u53e3\u7aef\u53e3\u53f7\u3002\u4e00\u65e6\u5f53\u524d\u9636\u6bb5\u7684\u6570\u636e\u5305\u88ab\u53d1\u9001\uff0c\u4ef2\u88c1\u903b\u8f91\u5c31\u4f1a\u7acb\u5373\u8df3\u8f6c\u81f3\u4e0b\u4e00\u4e2a\u9636\u6bb5\u3002\u5982\u679c\u5e76\u6ca1\u6709\u6570\u636e\u5305\u9700\u8981\u53d1\u9001\u7ed9\u88ab\u9009\u4e2d\u7684\u7aef\u53e3\uff0c\u4ef2\u88c1\u5668\u5c31\u5c06\u4f1a\u7acb\u5373\u63a8\u8fdb\u5230\u4e0b\u4e00\u4e2a\u9636\u6bb5\u53bb\u3002\u5bf9\u4e8e\u4ef2\u88c1\u8868\u4e2d\u7684\u8fd9\u4e9b\u6761\u76ee\u5e76\u6ca1\u6709\u4e0e\u5b83\u4eec\u76f8\u5173\u7684\u65f6\u95f4\u503c\u3002</p> <p>\u5bf9\u4e8eWRR\u7aef\u53e3\u4ef2\u88c1\uff0c\u6709\u56db\u79cd\u4ef2\u88c1\u8868\u957f\u5ea6\u53ef\u4ee5\u4f7f\u7528\uff0c\u4ef2\u88c1\u8868\u957f\u5ea6\u786e\u5b9a\u4e86\u5b83\u5305\u542b\u7684\u9636\u6bb5\u6570\u91cf\u3002\u82e5\u4ef2\u88c1\u8868\u4e2d\u7684\u6761\u76ee\u6570\u91cf\u8d8a\u591a\uff0c\u90a3\u4e48\u4e5f\u5c31\u53ef\u4ee5\u4f7f\u7528\u66f4\u590d\u6742\u66f4\u7279\u522b\u7684\u4ef2\u88c1\u9009\u62e9\u6bd4\u7387\u3002\u800c\u4ece\u53e6\u4e00\u65b9\u9762\u6765\u8bf4\uff0c\u4ef2\u88c1\u8868\u6761\u76ee\u6570\u91cf\u8d8a\u5c11\u5219\u4f1a\u4f7f\u7528\u66f4\u5c11\u7684\u5b58\u50a8\u7a7a\u95f4\u4ee5\u53ca\u66f4\u4f4e\u7684\u6210\u672c\u3002</p>"},{"location":"pcie/all/#7423-time-based-wrr-arbitrationtbwrr","title":"7.4.2.3   \u57fa\u4e8e\u65f6\u95f4\u7684\u52a0\u6743\u8f6e\u8be2\u4ef2\u88c1\uff08Time-Based WRR Arbitration\uff0cTBWRR\uff09","text":"<p>\u8981\u5bf9\u540c\u6b65\u7c7b\u578b\u7684\u670d\u52a1\u8fdb\u884c\u652f\u6301\uff0c\u8fd9\u79cd\u673a\u5236\u662f\u5fc5\u9700\u7684\u3002\u50cf\u5b83\u540d\u5b57\u6240\u8ff0\u7684\u90a3\u6837\uff0c\u57fa\u4e8e\u65f6\u95f4\u7684\u52a0\u6743\u8f6e\u8be2\uff08TBWRR\uff09\u4e3a\u6bcf\u4e2a\u4ef2\u88c1\u9636\u6bb5\u90fd\u52a0\u5165\u4e86\u65f6\u95f4\u5143\u7d20\u3002\u5c31\u50cf\u5728WRR\u4e2d\uff0c\u7aef\u53e3\u4ef2\u88c1\u5668\u4ece\u4ef2\u88c1\u8868\u4e2d\u83b7\u5f97\u5f53\u524d\u9636\u6bb5\u6240\u6307\u793a\u7684\u7aef\u53e3\u53f7\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u7aef\u53e3\u53f7\u53bb\u4ece\u76f8\u5e94\u7684\u5165\u53e3\u7aef\u53e3VC Buffer\u4e2d\u53d6\u51fa\u6570\u636e\u5305\u7528\u4e8e\u4f20\u8f93\u3002\u800c\u5bf9\u4e8e\u73b0\u5728\u7684TBWRR\u6765\u8bf4\uff0c\u57fa\u4e8e\u65f6\u95f4\u7684\u4ef2\u88c1\u5668\u5e76\u4e0d\u4f1a\u7acb\u5373\u63a8\u8fdb\u5230\u4e0b\u4e00\u4e2a\u9636\u6bb5\uff0c\u800c\u662f\u8981\u7b49\u5230\u5f53\u524d\u7684\u865a\u62df\u65f6\u9699\uff08timeslot\uff09\u8fc7\u53bb\u4e4b\u540e\u624d\u63a8\u8fdb\u5230\u4e0b\u4e00\u4e2a\u9636\u6bb5\u3002\u8fd9\u786e\u4fdd\u4e86\u4ece\u5165\u53e3\u7aef\u53e3\u63a5\u6536\u4e8b\u52a1\u7684\u65f6\u95f4\u95f4\u9694\u662f\u786e\u5b9a\u7684\u3002\u5982\u679c\u88ab\u9009\u4e2d\u7684\u7aef\u53e3\u5e76\u6ca1\u6709\u9700\u8981\u53d1\u9001\u7684\u4e8b\u52a1\uff0c\u90a3\u4e48\u4e5f\u4f1a\u7b49\u5f85\u81f3\u4e0b\u4e00\u4e2a\u65f6\u9699\uff0c\u800c\u5728\u8fd9\u4e2d\u95f4\u7684\u8fd9\u6bb5\u7b49\u5f85\u65f6\u95f4\u4e0d\u4f1a\u6709\u4efb\u4f55\u4fe1\u606f\u88ab\u53d1\u9001\u3002\u6ce8\u610f\uff0c\u65f6\u9699\u7684\u5e76\u4e0d\u63a7\u5236\u6574\u4e2a\u4f20\u8f93\u6240\u6301\u7eed\u7684\u65f6\u95f4\uff0c\u800c\u662f\u63a7\u5236\u4e24\u6b21\u4f20\u8f93\u4e4b\u95f4\u7684\u95f4\u9694\u3002\u8fd9\u91cc\u7684\u4e8b\u52a1\u4f20\u8f93\u7684\u6700\u5927\u6301\u7eed\u65f6\u95f4\u662f\u5b8c\u6210\u8f6e\u8be2\u5e76\u4e14\u8fd4\u56de\u5230\u521d\u59cb\u65f6\u9699\u4e2d\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u3002\u65f6\u9699\u7684\u957f\u5ea6\u4e5f\u8bb8\u5728\u672a\u6765\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u4f46\u662f\u76ee\u524d\u5b83\u7684\u503c\u4e3a100ns\u3002</p> <p>\u57fa\u4e8e\u65f6\u95f4\u7684WRR\u4ef2\u88c1\u6240\u652f\u6301\u7684\u6700\u5927\u957f\u5ea6\u7684\u4ef2\u88c1\u8868\u542b\u6709128\u4e2a\u9636\u6bb5\uff0c\u4f46\u662f\u4e00\u4e2a\u5177\u4f53\u7684VC\u53ef\u7528\u7684\u4ef2\u88c1\u8868\u6761\u76ee\u5b9e\u9645\u6570\u91cf\u53ef\u80fd\u4f1a\u4f4e\u4e8e\u8fd9\u4e2a\u6570\u503c\u3002\u8fd9\u4e2a\u503c\u662f\u7531\u786c\u4ef6\u521d\u59cb\u5316\uff0c\u5e76\u901a\u8fc7\u6bcf\u4e2a\u652f\u6301TBWRR\u7684VC\u7684Maximum Time Slots\u5b57\u6bb5\u6765\u8fdb\u884c\u8868\u793a\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5982\u56fe 7\u201118\u6240\u793a\u3002</p> <p></p> <p>\u56fe 7\u201118\u6700\u5927\u65f6\u9699\u5bc4\u5b58\u5668</p>"},{"location":"pcie/all/#743-loading-the-port-arbitration-tables","title":"7.4.3     \u8f7d\u5165\u7aef\u53e3\u4ef2\u88c1\u8868\uff08Loading the Port Arbitration Tables\uff09","text":"<p>\u7aef\u53e3\u4ef2\u88c1\u8868\u7684\u5b9e\u9645\u5927\u5c0f\u548c\u683c\u5f0f\uff0c\u662f\u4e00\u4e2a\u548c\u9636\u6bb5\u6570\u91cf\u548c\u5165\u53e3\u7aef\u53e3\u6570\u91cf\u6709\u5173\u7684\u51fd\u6570\uff0c\u8fd9\u91cc\u7684\u5165\u53e3\u7aef\u53e3\u53ef\u4ee5\u662fSwitch\u7aef\u53e3\u3001RCRB\uff08Root Complex Register Block\uff09\u6216\u8005\u662f\u652f\u6301Peer-to-Peer\u4f20\u8f93\u7684RC\u7aef\u53e3\u3002\u7aef\u53e3\u4ef2\u88c1\u8868\u6240\u652f\u6301\u7684\u6700\u5927\u5165\u53e3\u7aef\u53e3\u6570\u91cf\u4e3a256\u4e2a\u3002\u5b9e\u9645\u7684\u4ef2\u88c1\u8868\u4e2d\u6bcf\u4e2a\u6761\u76ee\u7684bit\u6570\u91cf\uff0c\u5176\u8bbe\u8ba1\u8003\u8651\u548c\u7ba1\u7406\u90fd\u4f9d\u8d56\u4e8e\u53ef\u4ee5\u5c06\u4e8b\u52a1\u4f20\u8f93\u81f3\u6b64\u51fa\u53e3\u7aef\u53e3\u7684\u5165\u53e3\u7aef\u53e3\u6570\u91cf\u3002\u6bcf\u4e2a\u4ef2\u88c1\u8868\u6761\u76ee\u7684\u5927\u5c0f\u8868\u793a\u5728\u7aef\u53e3VC\u80fd\u529b\u5bc4\u5b58\u56681\uff08Port VC Capability Register 1\uff09\u4e2d\u7684Port Arbitration Table Entry Size\uff08\u7aef\u53e3\u4ef2\u88c1\u8868\u6761\u76ee\u5927\u5c0f\uff09\u5b57\u6bb5\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u957f\u5ea6\u4e3a2bit\u3002\u5176\u4e2d\u5404\u4e2a\u6570\u503c\u542b\u4e49\u4e3a\uff1a</p> <p>n 00b\uff1a1bit\uff08\u4e5f\u5c31\u662f\u5728\u4e24\u4e2a\u7aef\u53e3\u4e4b\u95f4\u8fdb\u884c\u9009\u62e9\uff09</p> <p>n 01b\uff1a2bits\uff084\u4e2a\u7aef\u53e3\uff09</p> <p>n 10b\uff1a4bits\uff0816\u4e2a\u7aef\u53e3\uff09</p> <p>n 11b\uff1a8bits\uff08256\u4e2a\u7aef\u53e3\uff09</p> <p>\u914d\u7f6e\u8f6f\u4ef6\u901a\u8fc7\u5c06\u5404\u7aef\u53e3\u53f7\u586b\u5165\u4ef2\u88c1\u8868\u6765\u5b8c\u6210\u4ef2\u88c1\u8868\u7684\u52a0\u8f7d\uff0c\u4ee5\u5b9e\u73b0\u652f\u6301\u7684\u6bcf\u4e2aVC\u6240\u9700\u7684\u7aef\u53e3\u4f18\u5148\u7ea7\u529f\u80fd\u3002\u5982\u56fe 7\u201119\u6240\u793a\uff0c\u4ef2\u88c1\u8868\u7684\u683c\u5f0f\u53d6\u51b3\u4e8e\u6bcf\u4e2a\u6761\u76ee\u7684\u5b9e\u9645\u5927\u5c0f\u4ee5\u53ca\u8be5\u8bbe\u8ba1\u4e2d\u6240\u652f\u6301\u7684\u9636\u6bb5\u7684\u6570\u91cf\u3002</p> <p></p> <p>\u56fe 7\u201119\u7aef\u53e3\u4ef2\u88c1\u8868\u683c\u5f0f</p>"},{"location":"pcie/all/#744-switchswitch-arbitration-example","title":"7.4.4     Switch\u4ef2\u88c1\u793a\u4f8b\uff08Switch Arbitration Example\uff09","text":"<p>\u73b0\u5728\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a3\u7aef\u53e3Switch\u7684\u4f8b\u5b50\uff0c\u4ee5\u6b64\u6765\u5bf9\u7aef\u53e3\u4ef2\u88c1\u548cVC\u4ef2\u88c1\u8fdb\u884c\u4e3e\u4f8b\u8bb2\u89e3\u3002\u6211\u4eec\u5728\u793a\u4f8b\u4e2d\u5047\u8bbe\uff0c\u7531\u5165\u53e3\u7aef\u53e30\u548c\u5165\u53e3\u7aef\u53e31\u63a5\u6536\u7684\u6570\u636e\u5305\u4f1a\u5411\u4e0a\u884c\u79fb\u52a8\uff0c\u800c\u7aef\u53e32\u5219\u662f\u9762\u5411\u4e0a\u884c\u7684\u51fa\u53e3\u7aef\u53e3\uff08\u4e5f\u5c31\u662f\u9762\u5411RC\uff09\u3002\u4e0b\u9762\u7684\u5173\u4e8e\u8fd9\u4e2a\u793a\u4f8b\u7684\u8ba8\u8bba\u53ef\u4ee5\u53c2\u7167\u56fe 7\u201120\u3002</p> <p></p> <p>\u56fe 7\u201120 Switch\u4e2d\u7684\u4ef2\u88c1\u793a\u4f8b</p> <p>\\1.    \u5230\u8fbe\u5165\u53e3\u7aef\u53e30\u7684\u6570\u636e\u5305\u6839\u636eTC/VC\u6620\u5c04\u5173\u7cfb\uff0c\u88ab\u7aef\u53e30\u653e\u5165\u76f8\u5e94\u7684\u63a5\u6536VC\u4e2d\u3002\u5982\u56fe\u4e2d\u5c55\u793a\u7684\u4e00\u6837\uff0c\u6d41\u91cf\u7c7b\u578b\u4e3aTC0\u6216\u662fTC1\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e30\u7684VC0 Buffer\uff1b\u6d41\u91cf\u7c7b\u578b\u4e3aTC3\u6216\u662fTC5\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e30\u7684VC1 Buffer\u3002\u5728\u8fd9\u4e2a\u7aef\u53e3\u7684\u94fe\u8def\u4e0a\uff0c\u5176\u4ed6\u7684TC\u90fd\u662f\u4e0d\u5141\u8bb8\u51fa\u73b0\u7684\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u4e00\u4e2a\u6570\u636e\u5305\u800c\u5b83\u7684TC\u65e0\u6cd5\u6b63\u786e\u7684\u6620\u5c04\u5230\u4efb\u4f55\u4e00\u4e2a\u5b58\u5728\u7684VC\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u89c6\u4f5c\u53d1\u751f\u4e86\u4e00\u4e2a\u9519\u8bef\u3002</p> <p>\\2.    \u5230\u8fbe\u5165\u53e3\u7aef\u53e31\u7684\u6570\u636e\u5305\u4e5f\u4f1a\u6839\u636eTC/VC\u6620\u5c04\u5173\u7cfb\u88ab\u653e\u5165\u76f8\u5e94\u7684VC\u4e2d\uff0c\u4f46\u662f\u7aef\u53e31\u7684TC/VC\u6620\u5c04\u5173\u7cfb\u548c\u7aef\u53e30\u7684\u4e0d\u540c\u3002\u5728\u7aef\u53e31\u4e2d\uff0c\u6d41\u91cf\u7c7b\u578b\u4e3aTC0\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e31\u7684VC0 Buffer\uff1b\u6d41\u91cf\u7c7b\u578b\u4e3aTC2-4\uff08TC2\u3001TC3\u3001TC4\uff09\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e31\u7684VC3 Buffer\u3002\u94fe\u8def\u4e0a\u4e0d\u5141\u8bb8\u51fa\u73b0\u5176\u4ed6TC\u7684\u6570\u636e\u5305\u3002</p> <p>\\3.    \u5bf9\u4e8e\u7aef\u53e30\u548c\u7aef\u53e31\u8fd9\u4e24\u4e2a\u7aef\u53e3\u6765\u8bf4\uff0c\u5b83\u4eec\u63a5\u6536\u7684\u6570\u636e\u5305\u7684\u76ee\u7684\u51fa\u53e3\u7aef\u53e3\u662f\u7531\u6bcf\u4e2a\u6570\u636e\u5305\u7684\u8def\u7531\u4fe1\u606f\u6765\u51b3\u5b9a\u7684\u3002\u4f8b\u5982\uff0cMemory\u6216\u662fIO\u8bf7\u6c42TLP\u4f1a\u4f7f\u7528\u5730\u5740\u8def\u7531\u65b9\u5f0f\u3002</p> <p>\\4.    \u6240\u6709\u76ee\u7684\u51fa\u53e3\u7aef\u53e3\u4e3a\u7aef\u53e32\u7684\u6570\u636e\u5305\uff0c\u90fd\u4f1a\u88ab\u5448\u4ea4\u7ed9\u7aef\u53e32\u7684TC/VC\u6620\u5c04\u903b\u8f91\u3002\u5982\u56fe\u4e2d\u6240\u793a\u7684\u90a3\u6837\uff0c\u6d41\u91cf\u7c7b\u578b\u4e3aTC0-2\uff08TC0\u3001TC1\u3001TC2\uff09\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e32\u4e2d\u88ab\u6807\u8bc6\u6709TLP\u5404\u81ea\u5165\u53e3\u7aef\u53e3\u53f7\u7684VC0 Buffer\uff1b\u6d41\u91cf\u7c7b\u578b\u4e3aTC3-7\uff08TC3\u3001TC4\u3001TC5\u3001TC6\u3001TC7\uff09\u7684TLP\u4f1a\u88ab\u653e\u5165\u7aef\u53e32\u4e2d\u88ab\u6807\u8bc6\u6709TLP\u5404\u81ea\u5165\u53e3\u7aef\u53e3\u53f7\u7684VC1 Buffer\u3002</p> <p>\\5.    \u7aef\u53e3\u4ef2\u88c1\u662f\u7aef\u53e32\u4e2d\u7684\u6bcf\u4e2aVC\u72ec\u7acb\u8fdb\u884c\u7684\uff0c\u5404\u4e2aVC\u4f1a\u5c06\u81ea\u5df1\u7684\u4e00\u7ec4\u5e26\u6709\u5404\u5165\u53e3\u7aef\u53e3\u53f7\u6807\u8bc6\u7684Buffer\u4e2d\u7684\u6570\u636e\u5305\u8fdb\u884c\u6392\u961f\uff0c\u4ee5\u6b64\u6765\u51b3\u5b9a\u54ea\u4e2a\u5165\u53e3\u7aef\u53e3\u4f20\u6765\u7684TLP\u5c06\u8981\u6210\u4e3a\u4e0b\u4e00\u4e2a\u771f\u6b63\u88ab\u653e\u5165\u771f\u5b9eVC\u7684\u6570\u636e\u5305\u3002</p> <p>\\6.    \u6700\u540e\uff0c\u7531VC\u4ef2\u88c1\u6765\u786e\u5b9a\u5728\u5404\u771f\u5b9e\u7684VC Buffer\u5b9e\u9645\u5728\u94fe\u8def\u4e0a\u4f20\u8f93\u4e8b\u52a1\u7684\u987a\u5e8f\u662f\u600e\u6837\u7684\u3002</p> <p>\\7.    \u6ce8\u610f\uff0cVC\u4ef2\u88c1\u4ec5\u4f1a\u5728\u6709\u8db3\u591f\u7684\u6d41\u63a7Credit\u65f6\uff0c\u624d\u56de\u53bb\u9009\u62e9\u6570\u636e\u5305\u7528\u4e8e\u4f20\u8f93\u3002</p>"},{"location":"pcie/all/#75-eparbitration-in-multi-function-endpoints","title":"7.5 \u591a\u529f\u80fd EP\u7684\u4ef2\u88c1\uff08Arbitration in Multi-Function Endpoints\uff09","text":"<p>\u6709\u4e00\u7ec4\u5bc4\u5b58\u5668\u79f0\u4e3aMulti-Function Virtual Channel\uff08MFVC\uff09Capability\uff08\u591a\u529f\u80fd\u865a\u62df\u901a\u9053\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\uff09\uff0c\u8fd9\u7ec4\u5bc4\u5b58\u5668\u662f\u4e3a\u4e86\u5728\u5177\u6709\u591a\u79cdFunction\u7684EP\u8bbe\u5907\u4e2d\u5b9e\u73b0QoS\u7684\u8fd9\u79cd\u7279\u5b9a\u60c5\u51b5\u800c\u5b9a\u4e49\u7684\u3002</p> <p>\u5728\u534f\u8bae\u89c4\u8303\u4e2d\u63cf\u8ff0\u4e86\u8fd9\u79cd\u4ef2\u88c1\u7684\u4e24\u79cd\u60c5\u51b5\u3002\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u5982\u56fe 7\u201121\u6240\u793a\uff0cEP\u4e2d\u867d\u7136\u6709\u4e24\u4e2aFunction\uff0c\u4f46\u662f\u53ea\u6709Function 0\u4e2d\u542b\u6709VC\u80fd\u529b\u5bc4\u5b58\u5668\uff08VC Capability Registers\uff09\uff0c\u5e76\u4e14\u6240\u6709\u7684Function\u7684\u4efb\u52a1\u5206\u914d\u90fd\u662f\u76f8\u540c\u7684\u3002\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0cFunction\u4e4b\u95f4\u7684\u4ef2\u88c1\u65b9\u5f0f\u5c06\u6309\u7167\u4e00\u4e9b\u5382\u5546\u6307\u5b9a\uff08Vendor-Specific\uff09\u7684\u65b9\u6cd5\u53bb\u8fdb\u884c\u3002\u8fd9\u662f\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u8fd9\u65e0\u6cd5\u5728\u5185\u90e8\u5305\u542b\u4e00\u4e2a\u6807\u51c6\u7ed3\u6784\u7528\u4e8e\u5b9a\u4e49\u4e0d\u540cFunction\u7684\u8bf7\u6c42\u7684\u4f18\u5148\u7ea7\uff0c\u56e0\u6b64\u5b83\u65e0\u6cd5\u652f\u6301QoS\u3002</p> <p></p> <p>\u56fe 7\u201121\u7b80\u5355\u7684\u591aFunction\u4ef2\u88c1</p> <p>\u5982\u679c\u5e0c\u671b\u652f\u6301QoS\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5728VC0\u4e2d\u5b9e\u73b0\u4e00\u4e2aMFVC\uff08Multi-Function Virtual Channel\uff09\u5bc4\u5b58\u5668\u7ec4\uff0c\u5e76\u4e14\u6bcf\u4e2aFunction\u90fd\u8981\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u4e00\u7ec4VC\u80fd\u529b\u5bc4\u5b58\u5668\u3002\u4e3a\u4e86\u4fdd\u6301\u8f6f\u4ef6\u7684\u5411\u540e\u517c\u5bb9\u6027\uff0c\u534f\u8bae\u89c4\u8303\u4e2d\u58f0\u660e\uff0c\u6240\u6709\u4e0d\u9002\u7528MFVC\u7684\u8bbe\u5907\u7684VC Capability ID\uff08VC\u80fd\u529bID\uff09\u90fd\u5fc5\u987b\u4e3a0002h\uff0c\u800c\u6240\u6709\u5185\u90e8\u5b9e\u73b0\u4e86MFVC\u7684\u8bbe\u5907\u7684VC Capability ID\u90fd\u5fc5\u987b\u4e3a0009h\u3002</p> <p>\u56fe 7\u201122\u5c55\u793a\u4e86MFVC\u5bc4\u5b58\u5668\u7ec4\uff0c\u4ee5\u53ca\u4e00\u4e2a\u793a\u4f8b\u6846\u56fe\uff0c\u793a\u4f8b\u4e2d\u7684EP\u5185\u542b\u6709\u4e24\u4e2aFunction\uff0c\u8fd9\u4e2aEP\u7684\u7aef\u53e3\u652f\u63012\u4e2aVC\u3002\u6bcf\u4e2aFunction\u90fd\u6709\u81ea\u5df1\u7684\u4e8b\u52a1\u5c42\u4ee5\u53caVC\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u5b9e\u73b0\u66f4\u4f4e\u7684\u5c42\u7ea7\u3002\u76f8\u53cd\u5730\uff0c\u5b83\u4eec\u90fd\u8fde\u63a5\u5230\u4e86\u4e8c\u8005\u5171\u4eab\u7684\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\uff0c\u8fd9\u4e2a\u5171\u4eab\u7aef\u53e3\u5177\u6709\u6240\u6709\u7684\u5c42\u7ea7\u3002\u8fd9\u79cd\u5171\u4eab\u786c\u4ef6\u63a5\u53e3\u7684\u65b9\u5f0f\u53ef\u4ee5\u964d\u4f4e\u6210\u672c\u548c\u5f00\u9500\uff0c\u5e76\u4e14\u5404Function\u4e8b\u52a1\u5c42\u79cd\u6dfb\u52a0\u7684MFVC\u5bc4\u5b58\u5668\u7ec4\u4f7f\u5f97Function\u53ef\u4ee5\u5904\u7406\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff08Isochronous Traffic\uff09\u3002</p> <p>\u5728\u56fe 7\u201122\u4e2d\u53ef\u4ee5\u770b\u5230\uff0cMFVC\u5bc4\u5b58\u5668\u4ec5\u5b58\u5728\u4e8eFunction 0\u4e2d\uff0c\u5e76\u5b9a\u4e49\u4e86\u6b64\u63a5\u53e3\u4f7f\u7528\u7684VC\u4ee5\u53ca\u4ef2\u88c1\u65b9\u6cd5\u3002MFVC\u5bc4\u5b58\u5668\u7ec4\u770b\u8d77\u6765\u4e0eVC\u80fd\u529b\u5bc4\u5b58\u5668\u7ec4\u5341\u5206\u76f8\u4f3c\uff0c\u5b83\u53ef\u4ee5\u652f\u6301VC\u4ef2\u88c1\u4e0eFunction\u4ef2\u88c1\u3002\u7531\u4e8e\u6765\u81ea\u591a\u4e2a\u4e0d\u540cFunction\u7684\u6570\u636e\u5305\u6709\u53ef\u80fd\u5728\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u4e2aVC\uff0c\u56e0\u6b64\u5c31\u9700\u8981Function\u4ef2\u88c1\u6765\u51b3\u5b9a\u4e0d\u540cFunction\u6570\u636e\u5305\u4e4b\u95f4\u7684\u4f18\u5148\u7ea7\u3002\u8fd9\u79cd\u65b9\u5f0f\u5728\u73b0\u5728\u770b\u6765\u5e94\u8be5\u662f\u975e\u5e38\u719f\u6089\u7684\uff0c\u56e0\u4e3a\u5b83\u4e0e\u6b64\u524d\u7684\u7aef\u53e3\u4ef2\u88c1\u5176\u5b9e\u662f\u76f8\u540c\u7684\u6982\u5ff5\uff0c\u751a\u81f3\u8fde\u4ef2\u88c1\u65b9\u6cd5\u9009\u9879\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5305\u62ecTBWRR\u3002VC\u4ef2\u88c1\u9009\u9879\u4e5f\u4e0e\u5355Function VC\u5bc4\u5b58\u5668\u4e2d\u7684\u4ef2\u88c1\u9009\u9879\u76f8\u540c\u3002</p> <p></p> <p>\u56fe 7\u201122\u591aFunction\u4ef2\u88c1\u4e2d\u7684QoS\u652f\u6301</p>"},{"location":"pcie/all/#76-isochronous-support","title":"7.6 \u540c\u6b65\u7b49\u65f6\u670d\u52a1\u652f\u6301\uff08Isochronous Support\uff09","text":"<p>\u524d\u9762\u7684\u5185\u5bb9\u4e2d\u63d0\u5230\uff0c\u5e76\u4e0d\u662f\u6bcf\u4e2a\u8bbe\u5907\u6216\u8005\u5e94\u7528\u90fd\u9700\u8981\u652f\u6301\u540c\u6b65\u7b49\u65f6\u670d\u52a1\uff0c\u4f46\u662f\u4e5f\u6709\u4e00\u4e9b\u662f\u5fc5\u987b\u8981\u652f\u6301\u540c\u6b65\u670d\u52a1\u7684\u3002\u7531\u4e8ePCIe\u4ece\u8bbe\u8ba1\u4e4b\u521d\u5c31\u60f3\u8981\u652f\u6301\u540c\u6b65\u7b49\u65f6\u670d\u52a1\uff0c\u56e0\u6b64\u8ba9\u6211\u4eec\u6765\u8003\u8651\u4e00\u4e0b\u8981\u652f\u6301\u5b83\u7684\u8bdd\u4f1a\u6709\u4ec0\u4e48\u6837\u7684\u8981\u6c42\u3002</p>"},{"location":"pcie/all/#761-timing-is-everything","title":"7.6.1     \u65f6\u95f4\u89c4\u5212\u5c31\u662f\u4e00\u5207\uff08Timing is Everything\uff09","text":"<p>\u8003\u8651\u56fe 7\u201123\u4e2d\u5c55\u793a\u7684\u4f8b\u5b50\uff0c\u4f8b\u5b50\u4e2d\u7684\u540c\u6b65\u8fde\u63a5\uff08synchronous connection\uff09\u4f7f\u6211\u4eec\u6240\u671f\u671b\u7684\uff0c\u4f46\u662f\u8fd9\u662f\u65e0\u6cd5\u5b9e\u9645\u5b9e\u73b0\u7684\u3002\u76f8\u53cd\u5730\uff0c\u6211\u4eec\u901a\u8fc7\u901a\u8fc7\u540c\u6b65\u7b49\u65f6\u673a\u5236\u6765\u6a21\u62df\u4e00\u4e2a\u540c\u6b65\u8fde\u63a5\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u7b49\u65f6\u6027\uff08Isochrony\uff09\u5b9a\u4e49\u4e86\u5728\u670d\u52a1\u95f4\u9694\u5185\u9700\u8981\u88ab\u4f20\u8f93\u7684\u7528\u6765\u5b8c\u6210\u670d\u52a1\u9700\u6c42\u7684\u6570\u636e\u91cf\u3002\u4e0b\u9762\u5bf9\u64cd\u4f5c\u6d41\u7a0b\u8fdb\u884c\u4e86\u63cf\u8ff0\uff1a</p> <p>\\1.    \u540c\u6b65\u6e90\uff08\u6444\u50cf\u673a\u548cPCIe\u63a5\u53e3\uff09\u5728\u7b2c\u4e00\u4e2a\u7b49\u65f6\u670d\u52a1\u95f4\u9694\uff08Service Interval,SI 1\uff09\u4e2d\u5728Buffer A\u79ef\u7d2f\u6570\u636e\u3002</p> <p>\\2.    \u6444\u50cf\u673a\u5728\u4e0b\u4e00\u4e2a\u670d\u52a1\u95f4\u9694\uff08SI 2\uff09\u4e2d\u901a\u8fc7\u901a\u7528\u603b\u7ebf\u53d1\u9001\u5b8cBuffer A\u4e2d\u6240\u6709\u88ab\u7f13\u5b58\u79ef\u7d2f\u7684\u6570\u636e\uff0c\u540c\u65f6\u4e5f\u5c06\u4e0b\u4e00\u5757\u65b0\u6570\u636e\u79ef\u7d2f\u5728Buffer B\u4e2d\u3002</p> <p>\u660e\u663e\u5730\uff0c\u7cfb\u7edf\u5fc5\u987b\u8981\u80fd\u4fdd\u8bc1Buffer A\u4e2d\u7684\u5168\u90e8\u5185\u5bb9\u8981\u5728\u8fd9\u4e2a\u670d\u52a1\u95f4\u9694\u5185\u53d1\u9001\uff0c\u4e0d\u7ba1\u94fe\u8def\u4e0a\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u6d41\u91cf\u5728\u4f20\u8f93\u3002\u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u53ef\u4ee5\u7ed9\u8fd9\u4e9b\u65f6\u95f4\u654f\u611f\uff08time-sensitive\uff09\u6570\u636e\u5305\u5206\u914d\u9ad8\u4f18\u5148\u7ea7\uff0c\u5e76\u4e14\u6309\u7167\u9700\u8981\u89c4\u5212\u4ef2\u88c1\u65b9\u6848\u4f7f\u5f97\u8fd9\u4e9b\u6570\u636e\u5305\u5373\u4f7f\u5728\u6709\u5176\u4ed6\u6d41\u91cf\u7ade\u4e89\u7684\u60c5\u51b5\u4e0b\u4e5f\u80fd\u88ab\u4f18\u5148\u5904\u7406\u3002\u8fd8\u9700\u8981\u6ce8\u610f\uff0c\u53ea\u8981\u6240\u6709\u7684\u6570\u636e\u5728\u65f6\u95f4\u7a97\u53e3\u5185\u53d1\u9001\u51fa\u53bb\u5373\u53ef\uff0c\u800c\u81f3\u4e8e\u5b83\u4eec\u5177\u4f53\u4ec0\u4e48\u65f6\u95f4\u5230\u8fbe\u5728\u8fd9\u91cc\u5e76\u4e0d\u5173\u5fc3\uff0c\u5b83\u4eec\u53ef\u80fd\u4f1a\u5728\u670d\u52a1\u95f4\u9694\u4e2d\u5f88\u5206\u6563\u7684\u53d1\u9001\uff0c\u4e5f\u6709\u53ef\u80fd\u96c6\u4e2d\u5728\u670d\u52a1\u95f4\u9694\u7684\u67d0\u4e00\u65f6\u523b\u7d27\u5bc6\u7684\u53d1\u9001\u3002\u53ea\u8981\u5b83\u4eec\u90fd\u5728\u670d\u52a1\u95f4\u9694\u4e2d\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u90a3\u4e48\u5c31\u4f9d\u7136\u53ef\u4ee5\u505a\u5230\u9700\u8981\u7684\u4fdd\u8bc1\u3002</p> <p>\\3.    \u5728SI 2\u4e2d\uff0c\u5f55\u97f3\u673a\u63a5\u6536\u5230\u6570\u636e\uff0c\u5e76\u5c06\u8fd9\u4e9b\u8f93\u5165\u6570\u636e\u7f13\u5b58\u8d77\u6765\uff0c\u968f\u540e\u8fd9\u4e9b\u6570\u636e\u53ef\u4ee5\u5728SI 3\u88ab\u4f20\u9012\u5230\u5b58\u50a8\u4ecb\u8d28\u6765\u5b8c\u6210\u5f55\u5236\u3002\u6444\u50cf\u673a\u4e5f\u4f1a\u5728SI 3\u671f\u95f4\u5c06Buffer B\u4e2d\u7684\u6570\u636e\u5378\u5230\u94fe\u8def\u4e0a\uff0c\u540c\u65f6\u4e5f\u5728SI 3\u5185\u5728Buffer A\u4e2d\u79ef\u7d2f\u65b0\u7684\u6570\u636e\uff0c\u4ee5\u6b64\u5faa\u73af\u8fdb\u884c\u3002</p> <p></p> <p>\u56fe 7\u201123\u540c\u6b65\u4e8b\u52a1\u7684\u793a\u4f8b\u5e94\u7528</p>"},{"location":"pcie/all/#7611-how-timing-defined","title":"7.6.1.1   \u5982\u4f55\u5b9a\u4e49\u65f6\u95f4\u89c4\u5212\uff08How Timing Defined\uff09","text":"<p>PCIe\u4f7f\u7528TBWRR\u7aef\u53e3\u4ef2\u88c1\u673a\u5236\u4e2d\u7684\u65f6\u9699\uff08time slot\uff09\u6765\u5b9a\u4e49\u540c\u6b65\u7b49\u65f6\u65f6\u957f\u3002\u76ee\u524d\uff0c\u6bcf\u4e2a\u65f6\u9699\u662f100ns\uff0c\u5b83\u4ee3\u8868TBWRR\u4ef2\u88c1\u8868\u7684128\u4e2a\u6761\u76ee\u4e2d\u76841\u4e2a\u3002\u4e00\u65e6\u8bbe\u7f6e\u5b8c\u6210\uff0c\u4ef2\u88c1\u5668\u5c31\u4f1a\u6bcf12.8us\u5faa\u73af\u91cd\u590d\u4e00\u6b21\u8fd9\u4e2a\u4ef2\u88c1\u8868\uff0c\u8fd9\u4e5f\u4ee3\u8868\u5168\u90e8\u7684\u670d\u52a1\u95f4\u9694\u3002</p> <p>\u8981\u60f3\u8ba9\u4e00\u4e2a\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u50cf\u9884\u671f\u7684\u4e00\u6837\u5de5\u4f5c\uff0c\u8fd9\u9700\u8981\u6709\u4e00\u5b9a\u7684\u8003\u8651\u3002\u9996\u5148\uff0c\u6570\u636e\u5305\u5fc5\u987b\u5728\u53ef\u4ee5\u6d4b\u7684\u65f6\u95f4\u70b9\u3001\u4ee5\u56fa\u5b9a\u7684\u95f4\u9694\u88ab\u53d1\u9001\u3002\u7b2c\u4e8c\uff0c\u540c\u6b65\u7b49\u65f6\u6570\u636e\u9700\u8981\u88ab\u4f20\u8f93\u7684\u6700\u5927\u6570\u636e\u91cf\u5fc5\u987b\u662f\u8981\u63d0\u524d\u53ef\u4ee5\u83b7\u77e5\u7684\uff0c\u5e76\u4e14\u6570\u636e\u5305\u4e0d\u5141\u8bb8\u8d85\u8fc7\u8fd9\u4e2a\u6700\u5927\u503c\u4e0a\u9650\u3002\u7b2c\u4e09\uff0c\u94fe\u8def\u5fc5\u987b\u8981\u6709\u8db3\u591f\u7684\u5e26\u5bbd\u6765\u652f\u6301\u4e00\u4e2a\u7ed9\u5b9a\u65f6\u9699\u5185\u6240\u8981\u4f20\u8f93\u7684\u6570\u636e\u91cf\u3002</p> <p>\u8003\u8651\u63a5\u4e0b\u6765\u8fd9\u4e2a\u4f8b\u5b50\u3002\u4e00\u4e2a\u5355\u901a\u9053\u94fe\u8def\u5de5\u4f5c\u57282.5Gbps\uff0c\u6bcf4ns\u53d1\u9001\u4e00\u4e2a\u7b26\u53f7\uff0810bit\u7b26\u53f7\uff09\u3002\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e2a100ns\u7684\u65f6\u9699\u53ef\u4ee5\u53d1\u900125\u4e2a\u7b26\u53f7\uff0c\u4f46\u662f\u8fd9\u8db3\u591f\u5417\uff1f\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u8fd9\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a1\u4e2aTLP\u9700\u898128byte\u7ec4\u6210 Header\u3001\u5e8f\u5217\u53f7\uff08Sequence Number\uff09\u3001LCRC\u7b49\u7b49\u7684\u5e38\u89c4\u5f00\u9500\u3002\u8fd9\u610f\u5473\u7740100ns\u6839\u672c\u4e0d\u8db3\u4ee5\u5b8c\u6210\u8fd9\u4e9b\u5e38\u89c4\u5f00\u9500\u7684\u53d1\u9001\uff0c\u66f4\u4e0d\u7528\u8bf4\u53d1\u9001\u6570\u636e\u8377\u8f7d\u4e86\u3002\u5982\u679c\u6211\u4eec\u9700\u8981\u53d1\u9001128byte\u7684\u6570\u636e\uff0c\u90a3\u4e48\u9700\u8981\u7684\u5e26\u5bbd\u5c31\u5c06\u662f128+\u5e38\u89c4\u5f00\u9500=156bytes\u3002\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u4e2a\u9009\u9879\u662f\u5c06\u94fe\u8def\u5bbd\u5ea6\u589e\u52a0\u81f38\u901a\u9053\uff0c\u8fd9\u4f7f\u5f97\u4e00\u6b21\u53ef\u4ee5\u4f20\u8f93\u7684\u6570\u636e\u91cf\u53d8\u4e3a\u539f\u6765\u76848\u500d\u3002\u8fd9\u79cd\u6539\u53d8\u4f1a\u4f7f\u94fe\u8def\u5728100ns\u5185\u53ef\u4ee5\u4f20\u8f93200bytes\uff0c\u90a3\u4e48\u4e5f\u5c31\u53ef\u4ee5\u57281\u4e2a\u65f6\u9699\u4e2d\u53d1\u9001\u6240\u6709\u7684\u540c\u6b65\u7b49\u65f6\u6570\u636e\u3002\u53e6\u4e00\u79cd\u89e3\u51b3\u65b9\u6cd5\u662f\u4f9d\u7136\u4f7f\u7528\u5355\u901a\u9053\u94fe\u8def\uff0c\u4f46\u662f\u53ef\u4ee5\u7ed9\u4e88\u7aef\u53e3\u66f4\u591a\u7684\u65f6\u9699\u7528\u4e8e\u53d1\u9001\u6570\u636e\uff0c\u6bd4\u5982\u5c06\u670d\u52a1\u95f4\u9694\u75311\u4e2a\u65f6\u9699\u589e\u52a0\u52308\u4e2a\u65f6\u9699\uff0c\u90a3\u4e48\u5c31\u4e5f\u53ef\u4ee5\u57281\u4e2a\u670d\u52a1\u95f4\u9694\u4e2d\u4f20\u8f93200byte\u6570\u636e\u4e86\u3002\u5177\u4f53\u7684\u9009\u62e9\u54ea\u79cd\u89e3\u51b3\u65b9\u6cd5\u53d6\u51b3\u4e8e\u6210\u672c\u548c\u6027\u80fd\u7684\u6743\u8861\uff0c\u4f46\u662f\u7cfb\u7edf\u7684\u8bbe\u8ba1\u8005\u5fc5\u987b\u77e5\u9053\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u5bf9\u65f6\u95f4\u89c4\u5212\u548c\u5e26\u5bbd\u7684\u8981\u6c42\uff0c\u8fd9\u6837\u624d\u80fd\u6b63\u786e\u7684\u5efa\u7acb\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u3002</p>"},{"location":"pcie/all/#7612-how-timing-is-enforced","title":"7.6.1.2   \u5982\u4f55\u5b9e\u65bd\u65f6\u95f4\u89c4\u5212\uff08How Timing is Enforced\uff09","text":"<p>\u50cf\u524d\u9762\u7684\u4f8b\u5b50\u4e2d\u6240\u63cf\u8ff0\u7684\uff0c\u4e3a\u4e86\u8981\u4f7f\u4e00\u4e2a\u8bbe\u8ba1\u8fdb\u884c\u6b63\u786e\u7684\u64cd\u4f5c\uff0c\u65f6\u95f4\u89c4\u5212\u5df2\u7ecf\u6210\u4e86\u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u90e8\u5206\uff0c\u5b83\u662f\u7531\u5230\u76ee\u524d\u4e3a\u6b62\u6211\u4eec\u6240\u8ba8\u8bba\u7684\u591a\u79cd\u5143\u7d20\u7684\u7ec4\u5408\u6765\u5b8c\u6210\u6267\u884c\u7684\u3002\u9996\u5148\uff0c\u8f6f\u4ef6\u4e2d\u5fc5\u987b\u9009\u62e9\u9ad8\u4f18\u5148\u7ea7TC\uff0c\u5728\u786c\u4ef6\u4e2d\u914d\u7f6eVC\uff0c\u5e76\u5b9a\u4e49TC\u5230VC\u7684\u6620\u5c04\u5173\u7cfb\uff0c\u4ee5\u6b64\u6765\u8ba9\u6b63\u786e\u7684\u6570\u636e\u5305\u653e\u5165\u9ad8\u4f18\u5148\u7ea7VC\u4e2d\u3002\u7136\u540e\uff0c\u671f\u671b\u7684\u7684\u65f6\u95f4\u89c4\u5212\u5176\u5b9e\u662f\u4e00\u4e2a\u4ef2\u88c1\u65b9\u6848\u89c4\u5212\u95ee\u9898\uff0c\u901a\u8fc7\u8fd9\u4e2a\u89c4\u5212\u6765\u9002\u914d\u7279\u5b9a\u65f6\u95f4\u5185\u6240\u9700\u8981\u7684\u5e26\u5bbd\u3002\u4f8b\u5982\uff0cVC\u4ef2\u88c1\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff0c\u56e0\u4e3a\u8fd9\u662f\u552f\u4e00\u53ef\u4ee5\u786e\u4fdd\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u4e0d\u4f1a\u88ab\u5176\u4ed6\u6570\u636e\u5305\u963b\u585e\u5ef6\u8fdf\u7684\u4ef2\u88c1\u65b9\u5f0f\u3002\u800c\u5bf9\u4e8e\u7aef\u53e3\u4ef2\u88c1\u5219\u5fc5\u987b\u662fTBWRR\uff0c\u8fd9\u6837\u624d\u80fd\u6267\u884c\u786e\u5b9a\u597d\u7684\u65f6\u95f4\u89c4\u5212\u3002</p>"},{"location":"pcie/all/#762-software-support","title":"7.6.2     \u8f6f\u4ef6\u652f\u6301\uff08Software Support\uff09","text":"<p>\u8981\u652f\u6301\u540c\u6b65\u7b49\u65f6\u670d\u52a1\uff0c\u8fd8\u9700\u8981\u7cfb\u7edf\u4e2d\u5404\u4e2a\u8f6f\u4ef6\u5143\u7d20\u4e4b\u95f4\u7684\u534f\u8c03\u5408\u4f5c\u3002\u5728\u4e00\u4e2aPC\u7cfb\u7edf\u4e2d\uff0c\u8bbe\u5907\u9a71\u52a8\u4f1a\u5411OS\uff08\u64cd\u4f5c\u7cfb\u7edf\uff09\u62a5\u544a\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u7684\u9700\u6c42\u548c\u80fd\u529b\uff08Capabilities\uff09\uff0cOS\u4f1a\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5bf9\u6574\u4e2a\u7cfb\u7edf\u7684\u9700\u6c42\u8fdb\u884c\u8bc4\u4f30\uff0c\u5e76\u4e3a\u7cfb\u7edf\u5206\u914d\u5408\u9002\u7684\u8d44\u6e90\u3002\u5d4c\u5165\u5f0f\u7cfb\u7edf\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u8fd9\u4e9b\u5404\u90e8\u5206\u7684\u4fe1\u606f\u5728\u4e00\u5f00\u59cb\u5c31\u662f\u5df2\u77e5\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684\u8f6f\u4ef6\u53ef\u4ee5\u66f4\u7b80\u5355\u4e00\u4e9b\u3002\u5728\u63a5\u4e0b\u6765\u7684\u8ba8\u8bba\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u63cf\u8ff0PC\u7cfb\u7edf\u4e2d\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u5d4c\u5165\u5f0f\u7cfb\u7edf\u7684\u60c5\u51b5\u53ea\u662fPC\u60c5\u51b5\u4e2d\u66f4\u7b80\u5355\u7684\u4e00\u4e2a\u5b50\u96c6\u3002</p>"},{"location":"pcie/all/#7621-device-drivers","title":"7.6.2.1   \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff08Device Drivers\uff09","text":"<p>\u4e00\u4e2a\u8bbe\u5907\u9a71\u52a8\u5fc5\u987b\u80fd\u591f\u5c06\u65f6\u95f4\u89c4\u5212\u7684\u9700\u6c42\u62a5\u544a\u7ed9\u7528\u4e8e\u76d1\u7763\u540c\u6b65\u7b49\u65f6\u64cd\u4f5c\u7684\u8f6f\u4ef6\uff0c\u5e76\u5728\u771f\u6b63\u5c1d\u8bd5\u53d1\u9001\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u6570\u636e\u5305\u4e4b\u524d\uff0c\u5148\u8981\u83b7\u5f97\u8fd9\u4e2a\u8f6f\u4ef6\u7684\u8bb8\u53ef\u3002\u9700\u8981\u6ce8\u610f\u7684\u91cd\u8981\u7684\u4e00\u70b9\u662f\uff0c\u9a71\u52a8\u7ea7\u8f6f\u4ef6\u4e0d\u5e94\u8be5\u81ea\u5df1\u76f4\u63a5\u6539\u53d8\u786c\u4ef6\u914d\u7f6e\u6216\u8005\u662f\u4ef2\u88c1\u7b56\u7565\uff0c\u5373\u4f7f\u5b83\u6709\u8fd9\u4e2a\u80fd\u529b\u4e5f\u4e0d\u884c\uff0c\u56e0\u4e3a\u8fd9\u5c06\u4f1a\u5f15\u8d77\u6df7\u4e71\u3002\u5982\u679c\u591a\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u90fd\u5404\u81ea\u72ec\u7acb\u7684\u5c1d\u8bd5\u66f4\u6539\u786c\u4ef6\u914d\u7f6e\u6216\u4ef2\u88c1\u7b56\u7565\uff0c\u90a3\u4e48\u6700\u540e\u8fdb\u884c\u66f4\u6539\u64cd\u4f5c\u7684\u9a71\u52a8\u7a0b\u5e8f\u5c06\u4f1a\u628a\u4e4b\u524d\u7684\u66f4\u6539\u90fd\u8986\u76d6\u6389\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e00\u79cd\u88ab\u79f0\u4e3a\u540c\u6b65\u7b49\u65f6\u4ee3\u7406\uff08Isochronous Broker\uff09\u7684OS\u7ea7\u7a0b\u5e8f\u5c06\u4f1a\u63a5\u6536\u6765\u81ea\u7cfb\u7edf\u8bbe\u5907\u7684\u65f6\u95f4\u89c4\u5212\u8bf7\u6c42\uff0c\u5e76\u4ee5\u4e00\u79cd\u534f\u8c03\u7684\u65b9\u5f0f\u6765\u5206\u914d\u7cfb\u7edf\u8d44\u6e90\uff0c\u4ee5\u6b64\u6765\u9002\u914d\u6240\u6709\u7684\u8fd9\u4e9b\u8bf7\u6c42\u3002</p>"},{"location":"pcie/all/#7622-isochronous-broker","title":"7.6.2.2   \u540c\u6b65\u7b49\u65f6\u4ee3\u7406\uff08Isochronous Broker\uff09","text":"<p>\u8fd9\u79cd\u7a0b\u5e8f\u7528\u6765\u7ba1\u7406\u7aef\u5230\u7aef\u7684\u540c\u6b65\u7b49\u65f6\u6570\u636e\u5305\u6d41\u3002\u5b83\u4ece\u8bbe\u5907\u9a71\u52a8\u63a5\u6536\u5230\u540c\u6b65\u7b49\u65f6\u65f6\u95f4\u89c4\u5212\u8bf7\u6c42\uff0c\u7528\u4e00\u79cd\u80fd\u9002\u914d\u76ee\u6807\u8def\u5f84\u4e0a\u7684\u5404\u4e2a\u8bf7\u6c42\u7684\u65b9\u5f0f\uff0c\u6765\u534f\u8c03\u5206\u914d\u7cfb\u7edf\u8d44\u6e90\u3002\u5728\u534f\u8bae\u89c4\u8303\u4e2d\uff0c\u8fd9\u88ab\u79f0\u4e3a\u201c\u5728\u4e00\u5bf9Requester/Completer\uff08\u8bf7\u6c42\u8005/\u5b8c\u6210\u8005\uff09\u548cPCIe\u7ed3\u6784\u4e4b\u95f4\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u540c\u6b65\u7b49\u65f6\u5951\u7ea6\uff08Isochronous Contract\uff09\u201d\u3002\u8981\u505a\u5230\u8fd9\u4e9b\uff0c\u9700\u8981\u786e\u5b9a\u671f\u671b\u7684\u8def\u5f84\u4e0a\u786e\u5b9e\u53ef\u4ee5\u652f\u6301\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff0c\u7136\u540e\u5c31\u7f16\u7a0b\u5199\u5165\u5408\u9002\u7684\u4ef2\u88c1\u65b9\u6848\uff0c\u4ee5\u786e\u4fdd\u5b83\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u89c4\u5212\u8981\u6c42\u4e0b\u5de5\u4f5c\u3002</p>"},{"location":"pcie/all/#763-bringing-it-all-together","title":"7.6.3     \u5c06\u4e00\u5207\u7ed3\u5408\u8d77\u6765\uff08Bringing it all together\uff09","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5e94\u8be5\u5df2\u7ecf\u76f8\u5f53\u6e05\u695a\u9700\u8981\u505a\u4e9b\u4ec0\u4e48\u6765\u652f\u6301\u7cfb\u7edf\u4e2d\u7684\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff0c\u4f46\u662f\u8ba9\u6211\u4eec\u6765\u770b\u6700\u540e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u5c06\u4f1a\u628a\u4e4b\u524d\u7684\u5404\u4e2a\u5185\u5bb9\u90e8\u5206\u5168\u90fd\u7ed3\u5408\u8d77\u6765\u3002\u5982\u679c\u6211\u4eec\u7ee7\u7eed\u5bf9\u6b64\u524d\u7684\u89c6\u9891\u6355\u6349\u793a\u4f8b\u8fdb\u884c\u5c55\u5f00\u8be6\u8ff0\uff0c\u4ee5\u6b64\u6765\u5c55\u793a\u4e00\u4e2a\u66f4\u52a0\u590d\u6742\u7684\u7cfb\u7edf\uff0c\u5982\u56fe 7\u201124\u6240\u793a\u7684\u7cfb\u7edf\uff0c\u5f53\u6444\u50cf\u673a\u53ef\u4ee5\u628a\u6355\u6349\u5230\u7684\u89c6\u9891\u6570\u636e\u4f20\u9001\u81f3\u7cfb\u7edf\u5b58\u50a8\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u57fa\u4e8e\u5b83\u6765\u8ba8\u8bba\u8fd9\u4e2a\u7cfb\u7edf\u4e2d\u6240\u5fc5\u9700\u7684\u6bcf\u4e2a\u90e8\u5206\u3002\u8fd9\u5bf9\u4e8e\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u6765\u8bf4\u662f\u4e00\u4e2a\u6bd4\u8f83\u56f0\u96be\u7684\u7cfb\u7edf\u73af\u5883\uff0c\u56e0\u4e3a\u7cfb\u7edf\u4e2d\u5b58\u5728\u8bb8\u591a\u9700\u8981\u7ade\u4e89\u8def\u5f84\u4e0a\u7684\u5e26\u5bbd\u7684\u8bbe\u5907\uff0c\u4f46\u662f\u8fd9\u4e5f\u4f7f\u5f97\u8fd9\u4e2a\u4f8b\u5b50\u975e\u5e38\u9002\u5408\u7528\u6765\u8bb2\u89e3\u8fd9\u4e9b\u8fc7\u7a0b\u4e2d\u9700\u8981\u8003\u8651\u7684\u65b9\u65b9\u9762\u9762\u3002</p>"},{"location":"pcie/all/#7631-endpoints","title":"7.6.3.1   Endpoints","text":"<p>\u8ba9\u6211\u4eec\u4ece\u7cfb\u7edf\u7684\u6700\u5e95\u90e8\u5f00\u59cb\uff0c\u5bf9\u4e8e\u5f55\u50cfEP\u8bbe\u5907\u672c\u8eab\uff0c\u5b83\u7684PCIe\u63a5\u53e3\u4e2d\u9700\u8981\u6709\u4ec0\u4e48\uff1f\u5728\u786c\u4ef6\u4e2d\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u533a\u522b\u4e0d\u540c\u7684\u6570\u636e\u5305\uff0c\u90a3\u4e48\u5c31\u9700\u89811\u4e2a\u4ee5\u4e0a\u7684VC\u3002\u4e3a\u4e86\u7b80\u5316\u4f8b\u5b50\uff0c\u6211\u4eec\u5047\u8bbe\u8fd9\u4e2a\u8bbe\u5907\u662f\u4e00\u4e2a\u5355Function\u8bbe\u5907\u3002\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u9700\u8981\u5411OS\u7ea7\u7684\u540c\u6b65\u7b49\u65f6\u4ee3\u7406\u7a0b\u5e8f\u62a5\u544a\u8bbe\u5907\u7684\u80fd\u529b\uff08Capabilities\uff09\u548c\u540c\u6b65\u7b49\u65f6\u65f6\u95f4\u89c4\u5212\u9700\u6c42\uff0c\u540c\u6b65\u7b49\u65f6\u4ee3\u7406\u7a0b\u5e8f\u5c06\u4f1a\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5bf9\u7cfb\u7edf\u8fdb\u884c\u8bc4\u4f30\uff0c\u5e76\u5411\u8bbe\u5907\u9a71\u52a8\u62a5\u544a\u662f\u5426\u53ef\u80fd\u5efa\u7acb\u540c\u6b65\u7b49\u65f6\u5951\u7ea6\u4ee5\u53ca\u8f6f\u4ef6\u5e94\u8be5\u4f7f\u7528\u54ea\u4e9bTC\u3002</p> <p>\u9a71\u52a8\u7a0b\u5e8f\u5219\u5c06\u4f1a\u5c06\u5bf9VC\u7684\u7f16\u53f7\u548c\u6570\u91cf\u8fdb\u884c\u7f16\u7a0b\u5199\u5165\uff0c\u5e76\u5c06\u76f8\u5e94\u7684TC\u6620\u5c04\u81f3\u5404VC\u3002\u5b83\u4e5f\u5f88\u6709\u53ef\u80fd\u4f1a\u5c06\u9ad8\u4f18\u5148\u7ea7\u901a\u9053\u7684VC\u4ef2\u88c1\u7f16\u7a0b\u4e3a\u4e25\u683c\u4f18\u5148\u7ea7\u4ef2\u88c1\uff08Strict Priority\uff09\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4ef2\u88c1\u5fc5\u987b\u8981\u662f\u201c\u516c\u5e73\u7684\u201d\uff0c\u610f\u601d\u662f\u90a3\u4e9b\u4f4e\u4f18\u5148\u7ea7\u901a\u9053\u4e0d\u80fd\u51fa\u73b0\u8bbf\u95ee\u673a\u4f1a\u532e\u4e4f\uff08Starve\uff09\u3002\u8fd9\u610f\u5473\u7740\u90a3\u4e9b\u9ad8\u4f18\u5148\u7ea7VC\u4e0d\u80fd\u4e00\u76f4\u5360\u7528\u4ef2\u88c1\u8ba9\u81ea\u5df1\u7684\u6d41\u91cf\u5904\u4e8e\u5f85\u53d1\u9001\u72b6\u6001\uff0c\u800c\u662f\u8981\u968f\u65f6\u95f4\u5206\u6279\u7684\u4f20\u8f93\u6570\u636e\u5305\u3002</p> <p>\u5728\u7ed3\u675f\u5bf9EP\u7684\u8ba8\u8bba\u4e4b\u524d\uff0c\u8fd8\u9700\u8981\u6ce8\u610f\u5173\u4e8e\u94fe\u8def\u64cd\u4f5c\u7684\u53e6\u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u6d41\u91cf\u63a7\u5236\u3002\u8bbe\u5907\u5728\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7684\u63a5\u6536Buffer\u5fc5\u987b\u8981\u8db3\u591f\u5927\uff0c\u53ea\u8981\u6570\u636e\u5305\u662f\u6309\u7167\u540c\u6b65\u7b49\u65f6\u5951\u7ea6\uff08Isochronous Contract\uff09\u5747\u5300\u7684\u8f93\u5165\uff0c\u90a3\u4e48\u8fd9\u4e2aBuffer\u5c31\u8981\u5927\u5230\u5728\u4e0d\u9700\u8981\u4efb\u4f55\u53cd\u538b\u7684\u60c5\u51b5\u4e0b\u80fd\u591f\u5904\u7406\u9884\u671f\u7684\u8f93\u5165\u6570\u636e\u5305\u6d41\u3002\u6b64\u5916\uff0c\u6d41\u63a7\u66f4\u65b0DLLP\uff08Flow Control Update\uff09\u7684\u8fd4\u56de\u901f\u5ea6\u5fc5\u987b\u8db3\u591f\u5feb\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u4f20\u8f93\u505c\u6ede\u3002</p> <p></p> <p>\u56fe 7\u201124\u540c\u6b65\u7b49\u65f6\u7cfb\u7edf\u793a\u4f8b</p>"},{"location":"pcie/all/#7632-switches","title":"7.6.3.2   Switches","text":"<p>\u5728\u8ba8\u8bba\u4e86EP\u4e4b\u540e\uff0c\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u5728EP\u4e0eRC\u4e4b\u95f4\u7684Switch\u4e2d\u9700\u8981\u63d0\u4f9b\u4ec0\u4e48\u3002Switch\u901a\u5e38\u662f\u6ca1\u6709\u81ea\u5df1\u7684\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u7684\uff0c\u6240\u4ee5\u53ea\u80fd\u7531OS\u7ea7\u8f6f\u4ef6\uff08\u5982\u540c\u6b65\u7b49\u65f6\u4ee3\u7406Isochronous Broker\uff09\u6765\u8bfb\u53d6\u5b83\u4eec\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u8fd9\u4e9bSwitch\u80fd\u652f\u6301\u600e\u6837\u7684\u670d\u52a1\u3002\u9996\u5148\uff0c\u5728\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7684\u6240\u6709\u7aef\u53e3\u90fd\u5fc5\u987b\u8981\u652f\u6301\u81f3\u5c112\u4e2aVC\uff0c\u4e14\u94fe\u8def\u4e24\u7aef\u7684TC/VC\u6620\u5c04\u5173\u7cfb\u4e5f\u5fc5\u987b\u662f\u76f8\u5339\u914d\u7684\u3002\u8981\u8bb0\u4f4f\uff0c\u4e00\u65e6\u6570\u636e\u5305\u5230\u8fbe\u4e86Switch\u7aef\u53e3\u7684\u4e8b\u52a1\u5c42\uff0c\u90a3\u4e48\u6570\u636e\u5305\u91cc\u53ea\u6709TC\u4fe1\u606f\u800c\u6ca1\u6709VC\u4fe1\u606f\uff0cTC\u5177\u4f53\u5bf9\u5e94\u54ea\u4e2aVC\u662f\u6bcf\u4e2a\u7aef\u53e3\u81ea\u5df1\u6307\u5b9a\u7684\u800c\u4e0d\u4f1a\u5c06\u8fd9\u4e2a\u4fe1\u606f\u643a\u5e26\u5728TLP\u4e2d\u3002Switch 1\u7684\u4e0b\u884c\u7aef\u53e3\u4e0e\u5b83\u4e0b\u65b9\u8fde\u63a5\u7684EP\u7684\u5404\u81eaTC/VC\u6620\u5c04\u5173\u7cfb\u5fc5\u987b\u8981\u76f8\u5339\u914d\uff0c\u4f46\u662f\u81f3\u4e8e\u5176\u4ed6\u7684Switch\u7aef\u53e3\u53ef\u4ee5\u662f\u4e0d\u540c\u7684\u4ee5\u6b64\u6765\u5339\u914d\u5b83\u4eec\u5404\u81ea\u94fe\u8def\u4e0a\u7684EP\u3002</p>"},{"location":"pcie/all/#l-arbitration-issues","title":"l \u4ef2\u88c1\u95ee\u9898\uff08Arbitration Issues\uff09","text":"<p>\u4ef2\u88c1\u65b9\u6cd5\u7684\u9009\u62e9\u662f\u5f88\u76f4\u63a5\u7684\u3002\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u7684\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u627f\u8f7d\u7684\u6d41\u91cf\u662f\u5355\u5411\u7684\u3002\u5bf9\u4e8e\u5728\u5b58\u50a8\u5668\u8bfb\u53d6\u64cd\u4f5c\u4e2d\uff0c\u5176\u5b9e\u662f\u6709\u53ef\u80fd\u51fa\u73b0\u53cc\u5411\u7684\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\u7684\uff0c\u4f46\u662f\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u9009\u53d6\u7684\u662f\u7c7b\u4f3c\u89c6\u9891\u6d41\u7684\u60c5\u51b5\u3002</p> <p>\u540c\u6b65\u7b49\u65f6\u51fa\u53e3\u7aef\u53e3\u4f7f\u7528\u7684VC\u4ef2\u88c1\u901a\u5e38\u662f\u4e25\u683c\u4f18\u5148\u7ea7\u65b9\u6848\uff0c\u539f\u56e0\u4e0eEP\u76f8\u540c\u3002\u7aef\u53e3\u4ef2\u88c1\u5219\u5c06\u4f1a\u4f7f\u7528TBWRR\u65b9\u6848\uff0c\u8fd9\u610f\u5473\u7740\u8f6f\u4ef6\u5fc5\u987b\u4e86\u89e3\u9002\u5f53\u7684\u8bbf\u95ee\u6bd4\u7387\uff0c\u5e76\u5c06\u7aef\u53e3\u4ef2\u88c1\u8868\uff08Port Arbitration Table\uff09\u7f16\u7a0b\u5199\u5165\uff0c\u4ee5\u6b64\u6765\u5b9e\u73b0\u8fd9\u79cd\u7aef\u53e3\u7684\u8bbf\u95ee\u6bd4\u7387\u3002\u5982\u679c\u8def\u5f84\u4e2d\u6709\u591a\u4e2aSwitch\uff0c\u90a3\u4e48\u8981\u505a\u5230\u8fd9\u4e00\u7cfb\u5217\u4e8b\u60c5\u53ef\u80fd\u5e76\u4e0d\u662f\u542c\u8d77\u6765\u7684\u90a3\u4e48\u7b80\u5355\uff0c\u56e0\u4e3a\u5373\u4f7f\u4ed6\u4eec\u4f7f\u7528\u7684\u90fd\u662f\u76f8\u540c\u7684TBWRR\u4ef2\u88c1\u65b9\u6848\uff0c\u4e5f\u65e0\u6cd5\u5f88\u6e05\u6670\u7684\u77e5\u9053\u5b83\u4eec\u5404\u81ea\u7684\u670d\u52a1\u95f4\u9694\uff08service interval\uff0cSI\uff09\u662f\u5982\u4f55\u534f\u540c\u5de5\u4f5c\u7684\u3002\u5982\u679c\u51e0\u4e2aSwitch\u7684SI\u4e4b\u95f4\u5e76\u672a\u5bf9\u9f50\uff0c\u90a3\u4e48\u5c31\u610f\u5473\u7740\u7b49\u65f6\u7684\u65f6\u95f4\u89c4\u5212\u66f4\u52a0\u96be\u4ee5\u5b9e\u73b0\uff0c\u8fd9\u5c06\u53d6\u51b3\u4e8e\u94fe\u8def\u7684\u7e41\u5fd9\u7a0b\u5ea6\u3002\u4f46\u662f\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u8003\u8651SI\u4e4b\u95f4\u7684\u534f\u8c03\u5408\u4f5c\uff0c\u56e0\u6b64\u8fd9\u91cc\u5c31\u5c06\u518d\u6b21\u6d89\u53ca\u5230\u4e00\u4e2a\u975e\u6807\u51c6\u65b9\u6cd5\u3002\u663e\u7136\uff0c\u5982\u679c\u5728\u4e00\u4e2a\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u5e76\u4e0d\u5b58\u5728\u591a\u4e2aSwitch\u800c\u53ea\u67091\u4e2a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u5c06\u4f1a\u88ab\u5927\u5927\u7b80\u5316\u3002</p>"},{"location":"pcie/all/#l-timing-issues","title":"l \u65f6\u95f4\u89c4\u5212\u95ee\u9898\uff08Timing Issues\uff09","text":"<p>\u56fe 7\u201125\u5c55\u793a\u4e86\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u6570\u636e\u5305\u5728\u4e24\u4e2aEP\u95f4\u4f20\u9001\u7684\u65f6\u95f4\u70b9\u3002\u7c97\u7ebf\u6761\u7684\u5927\u7bad\u5934\u662f\u6765\u81ea\u89c6\u9891\u8bbe\u5907\u7684\u6570\u636e\u5305\uff0c\u5b83\u5177\u6709\u5df2\u77e5\u786e\u5b9a\u7684\u5927\u5c0f\uff0c\u5e76\u6309\u7167\u5468\u671f\u6027\u7684\u3001\u786e\u5b9a\u6027\u95f4\u9694\u7684\u8fdb\u884c\u53d1\u9001\u3002\u7ec6\u7ebf\u6761\u7684\u5c0f\u7bad\u5934\u5219\u662f\u4ee3\u8868\u6765\u81eaSCSI\u9a71\u52a8\u5668\u7684\u6570\u636e\u5305\uff0c\u5b83\u5177\u6709\u8f83\u4f4e\u7684\u4f18\u5148\u7ea7\u4e14\u53d1\u9001\u65f6\u95f4\u70b9\u662f\u4e0d\u53ef\u9884\u77e5\u7684\u3002\u5728EP\u4e2d\uff0c\u6570\u636e\u5305\u53ea\u9700\u8981\u7b80\u5355\u7684\u542b\u6709TC\u5373\u53ef\uff0c\u4f46\u662fSwitch\u8fd8\u9700\u8981\u786e\u8ba4\u6267\u884c\u4e86\u5408\u9002\u7684\u65f6\u95f4\u89c4\u5212\u65b9\u6848\u3002\u8fd9\u662f\u901a\u8fc7\u4f7f\u7528TBWRR\u6765\u5b8c\u6210\u7684\uff0c\u5b83\u5c06\u4f1a\u6307\u5b9a\u5728\u4e00\u4e2a\u7ed9\u5b9a\u7684\u65f6\u95f4\u70b9\u4e0a\uff0c\u54ea\u4e2a\u7aef\u53e3\u53ef\u4ee5\u8fdb\u884c\u8bbf\u95ee\uff0c\u4ee5\u53ca\u8bbf\u95ee\u65f6\u95f4\u6709\u591a\u957f\u3002\u7531\u4e8e\u77e5\u9053\u540c\u6b65\u7b49\u65f6\u6570\u636e\u5305\u7684\u5927\u5c0f\u4ee5\u53ca\u4f20\u9001\u9891\u7387\uff0c\u8fd9\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u6b63\u786e\u7684\u5b89\u6392\u65f6\u95f4\u89c4\u5212\uff0c\u4f46\u662f\u4ec0\u4e48\u6837\u7684\u65f6\u95f4\u89c4\u5212\u624d\u662f\u6211\u4eec\u9700\u8981\u7684\u5462\uff1f</p> <p></p> <p>\u56fe 7\u201125\u540c\u6b65\u7b49\u65f6\u6570\u636e\u5305\u7684\u6ce8\u5165</p> <p>\u9996\u5148\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u6765\u56de\u987e\u4e00\u4e0b\u9700\u8981\u6d89\u53ca\u5230\u7684\u53c2\u6570\u3002\u56de\u5fc6\u4e00\u4e0b\uff0cPCIe\u4e2d\u57fa\u4e8e\u53c2\u8003\u65f6\u949f\u5468\u671f\u5b9a\u4e49\u4e86\u65f6\u9699\uff08time slot\uff09\uff0c\u800c\u65f6\u9699\u7684\u957f\u5ea6\u662f\u7531\u7aef\u53e3\u80fd\u529b\u5bc4\u5b58\u56681\uff08Port Capability Register 1\uff09\u4e2d\u7684\u53c2\u8003\u65f6\u949f\u5b57\u6bb5\uff08Reference Clock\uff09\u6240\u7ed9\u5b9a\u7684\u3002\u76ee\u524d\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u53ea\u80fd\u662f100ns\uff0c\u5e76\u4e14TBWRR\u4ef2\u88c1\u8868\u53ea\u80fd\u662f128\u4e2a\u6761\u76ee\u7684\u5927\u5c0f\u3002\u670d\u52a1\u95f4\u9694\uff08Service Interval\uff0cSI\uff09\u7684\u957f\u5ea6\u5c31\u662f\u5b83\u4eec\u7684\u4e58\u79ef\uff0c\u4e5f\u5c31\u662f12.8us\u3002\u4e00\u4e2a\u7ed9\u5b9a\u8bbe\u5907\u7684\u5e26\u5bbd\u53ef\u4ee5\u7528\u4e0b\u9762\u7ed9\u51fa\u7684\u516c\u5f0f\u6765\u8868\u8fbe\uff0c\u5176\u4e2dY\u8868\u793a1\u4e2a\u65f6\u9699\u4e2d\u5c06\u8981\u53d1\u9001\u7684\u6570\u636e\u91cf\uff08\u534f\u8bae\u89c4\u8303\u4e2d\u58f0\u660e\uff0c\u5fc5\u987b\u8981\u5c06\u914d\u7f6e\u8fc7\u7a0b\u4e2d\u7f16\u7a0b\u5199\u5165\u7684Max Payload Size\u503c\u7528\u4e8e\u8fd9\u4e2a\u5e26\u5bbd\u7684\u8ba1\u7b97\u4e2d\uff0c\u4e5f\u5c31\u662f\u5148\u5047\u8bbe1\u4e2a\u65f6\u9699\u5c31\u80fd\u4f20\u8f931\u4e2a\u6570\u636e\u5305\uff09\uff0cM\u8868\u793a\u7684\u662f\u65f6\u9699\u7684\u6570\u91cf\uff0cT\u8868\u793a\u6574\u4e2aSI\u957f\u5ea6\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u9009\u62e9Payload\u4e3a128Byte\uff0c\u53c8\u5df2\u77e5SI\u4e3a12.8us\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5206\u914d\u7684\u6bcf\u4e2a\u65f6\u9699\u6765\u8bf4\uff0cBW=10MB/s\u3002</p> <p></p> <p>\u73b0\u5728\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u66f4\u8d34\u8fd1\u5b9e\u9645\u7684\u4f8b\u5b50\u3002\u5047\u8bbe\u94fe\u8def\u5de5\u4f5c\u5728Gen2\u7684\u901f\u7387\uff0c\u89c6\u9891\u8bbe\u5907\u9700\u8981\u4fdd\u8bc1\u6709100MB/s\u7684\u5e26\u5bbd\uff0c\u4e14\u5b83\u5c06\u4f1a\u53d1\u9001\u6570\u636e\u8377\u8f7d\u4e3a512Byte\u7684\u6570\u636e\u5305\uff0c\u6211\u4eec\u5148\u5047\u8bbe1\u4e2a\u65f6\u9699\u5c31\u80fd\u53d1\u90011\u4e2a\u6570\u636e\u5305\uff0c\u4ee3\u5165\u516c\u5f0f\u4e2d\u5f97\u5230M=2.5\uff0c\u4e5f\u5c31\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8981\u57281\u4e2aSI\u4e2d\u53d1\u90012.5\u4e2a512Byte\u6570\u636e\u5305\u3002</p> <p></p> <p>\u4f46\u662f\u5b9e\u9645\u4e0a1\u4e2a\u65f6\u9699\u4e2d\u53ef\u4ee5\u4f20\u8f93\u591a\u5c11\u6570\u636e\u5462\uff1f\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u5f53\u7136\u4e0e\u94fe\u8def\u901f\u7387\u4ee5\u53ca\u94fe\u8def\u5bbd\u5ea6\u6709\u5173\u3002\u57285.0Gb/s\u7684\u901f\u7387\u4e0b\uff0c\u6bcf\u53d1\u90011\u4e2a10bit\u7b26\u53f7\u5c31\u9700\u89812ns\uff0c\u56e0\u6b64\u5728\u6bcf\u4e2a\u540c\u9053\u4e2d100ns\u5219\u53ef\u4ee5\u4f20\u8f9350\u4e2a\u7b26\u53f7\u3002\u5982\u679c\u6570\u636e\u5305\u7684\u5927\u5c0f\u662f512Byte\u518d\u52a0\u4e0a28Byte\u5de6\u53f3\u7684Header\uff0c\u90a3\u4e48\u4f7f\u7528x1\u94fe\u8def\u4f20\u8f93\u5927\u5c0f\u4e3a550\u4e2a\u7b26\u53f7\u7684\u6570\u636e\u5305\u5219\u9700\u898111\u4e2a\u65f6\u9699\u3002\u5728\u6709\u9700\u8981\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u8ba9\u540c\u4e00\u4e2a\u7aef\u53e3\u5f97\u5230\u8fde\u7eed\u7684\u591a\u4e2a\u65f6\u9699\uff0c\u8fd9\u662f\u4e00\u79cd\u89e3\u51b3\u529e\u6cd5\u3002\u7531\u4e8e\u5c06\u8981\u53d1\u9001\u7684\u6570\u636e\u5305\u7684\u5927\u5c0f\u662f\u786e\u5b9a\u4e00\u81f4\u7684\uff0c\u6211\u4eec\u4e0d\u80fd\u771f\u7684\u5c31\u5c06M\u5b9a\u4e3a2.5\u4e2a512Byte\uff0c\u800c\u662f\u5e94\u8be5\u5c06\u5176\u5b9a\u4e3a3\u3002\u5bf9\u4e8e\u6211\u4eec\u7684\u516c\u5f0f\u6765\u8bf4\uff0c\u57281\u4e2aSI\u4e2d\u53d1\u90013\u4e2a512Byte\u7684\u5e26\u5bbd\u5b9e\u9645\u4e0a\u662f120MB/s\u3002\u8fd9\u867d\u7136\u9ad8\u4e8e\u6211\u4eec\u7684\u9700\u6c42\u5e26\u5bbd\uff0c\u4f46\u662f\u786e\u5b9e\u89e3\u51b3\u4e86\u6211\u4eec\u7684\u95ee\u9898\u3002\u7531\u4e8e\u521a\u624d\u8ba1\u7b97\u8fc7\u4f20\u8f93550\u4e2a\u7b26\u53f7\u9700\u898111\u4e2a\u65f6\u9699\uff0c\u90a3\u4e48\u4f20\u8f933\u4e2a\u5c31\u9700\u898111\u00d73=33\u4e2a\u65f6\u9699\uff0c\u57281\u4e2aSI\u4e2d\u8fd8\u7559\u670995\u4e2a\u65f6\u9699\u7528\u4f5c\u5b83\u7528\u3002\u57281\u4e2aSI\u4e2d\u76843\u4e2a\u65f6\u9699\u7ec4\uff08\u6bcf\u7ec411\u4e2a\uff09\u4e2d\uff0c\u6bcf\u4e00\u7ec4\u5185\u768411\u4e2a\u65f6\u9699\u5fc5\u987b\u662f\u8fde\u7eed\u76f8\u90bb\u7684\uff0c\u4f46\u662f\u7ec4\u4e0e\u7ec4\u4e4b\u95f4\u53ef\u4ee5\u662f\u5206\u5f00\u7684\u3002</p> <p>\u53e6\u5916\u4e00\u4e2a\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u589e\u52a0\u94fe\u8def\u5bbd\u5ea6\u3002\u5c3d\u7ba1\u8fd9\u6837\u7684\u89e3\u51b3\u529e\u6cd5\u4f1a\u589e\u52a0\u786c\u4ef6\u5f00\u9500\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u752811\u901a\u9053\u7684\u94fe\u8def\u5219\u53ef\u4ee5\u771f\u6b63\u7684\u57281\u4e2a\u65f6\u9699\u5185\u5b8c\u6210\u9700\u8981\u7684\u6570\u636e\u7684\u53d1\u9001\u4f46\u662f\u5728CEM\u534f\u8bae\u89c4\u8303\u4e2d\uff08PCIe Card Electromechanical Spec \uff0cPCIe\u5361Spec\uff09\uff0c\u5e76\u6ca1\u6709x11\u7684\u9009\u9879\uff0c\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528\u5176\u4e2d\u7684x12\u9009\u9879\u6765\u5e94\u7528\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u3002\u4f7f\u7528\u66f4\u5bbd\u7684\u94fe\u8def\u610f\u5473\u7740\u8f6f\u4ef6\u53ea\u9700\u8981\u4e3a\u6bcf\u4e2a\u6570\u636e\u5305\u5206\u914d1\u4e2a\u65f6\u9699\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u57281\u4e2aSI\u4e2d\u5206\u914d3\u4e2a\u65f6\u9699\uff0c\u5373\u53ef\u6ee1\u8db3\u672c\u4f8b\u5b50\u4e2d\u8bbe\u5907\u7684\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\u5e26\u5bbd\u9700\u6c42\u3002\u4e0ex1\u7684\u60c5\u51b5\u4e0d\u540c\uff0c\u73b0\u5728\u6211\u4eec\u4e0d\u9700\u8981\u8ba9\u5206\u914d\u7684\u65f6\u9699\u8fde\u7eed\u76f8\u90bb\u3002\u76f8\u53cd\u5730\uff0c\u5b83\u4eec\u53ef\u4ee5\u4ee5\u67d0\u79cd\u66f4\u4f18\u7684\u65b9\u5f0f\u5206\u6563\u5728SI\u4e2d\u3002</p>"},{"location":"pcie/all/#l-bandwidth-allocation-problems","title":"l \u5e26\u5bbd\u5206\u914d\u95ee\u9898\uff08Bandwidth Allocation Problems\uff09","text":"<p>\u5bf9\u4e8e\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\u6765\u8bf4\uff0c\u5fc5\u987b\u8981\u8bbe\u8ba1\u597dTBWRR\u4ef2\u88c1\u8868\u6765\u4fdd\u8bc1\u6709\u8db3\u591f\u7684\u53ca\u65f6\u7684\u5e26\u5bbd\uff0c\u5e76\u4e14\u8fd9\u90e8\u5206\u5e26\u5bbd\u4e0d\u4f1a\u88ab\u5176\u4ed6\u6d41\u91cf\u6240\u5f71\u54cd\u3002\u5982\u56fe 7\u201125\u4e2d\u6240\u793a\uff0cSCSI\u63a7\u5236\u5668\u5728SI 1\u4e2d\u53d1\u9001\u4e861\u4e2a\u6570\u636e\u5305\uff0c\u5728SI 3\u4e2d\u53d1\u9001\u4e86\u53e6\u4e00\u4e2a\u6570\u636e\u5305\u3002\u5982\u679c\u65f6\u95f4\u89c4\u5212\u5c31\u6309\u7167\u8fd9\u6837\uff0c\u5141\u8bb8EP\u6bcf\u4e2aSI\u53d1\u90011\u4e2a\u6570\u636e\u5305\uff0c\u90a3\u4e48\u8fd9\u6837\u7684\u65b9\u5f0f\u662f\u53ef\u884c\u7684\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5047\u8bbeSCSI\u63a7\u5236\u5668\u5c1d\u8bd5\u53d1\u9001\u66f4\u591a\u7684\u6570\u636e\u5305\uff0c\u5176\u6570\u91cf\u5df2\u7ecf\u8d85\u8fc7\u4e86SI 1\u5bf9\u5b83\u7684\u8bb8\u53ef\u6570\u91cf\uff0c\u5982\u56fe 7\u201126\u6240\u793a\u3002\u8fd9\u662f\u534f\u8bae\u89c4\u8303\u4e2d\u63d0\u5230\u7684\u4e24\u4e2a\u5e26\u5bbd\u5206\u914d\u95ee\u9898\u4e2d\u7684\u7b2c\u4e00\u4e2a\uff0c\u5b83\u88ab\u79f0\u4e3a\u201c\u8fc7\u8f7d\uff08oversubscription\uff09\u201d\u3002\u8fd9\u5c06\u4f1a\u5f71\u54cd\u5230\u540c\u6b65\u7b49\u65f6\u6d41\u91cf\uff0c\u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u5408\u7406\u7684\u89c4\u5212TBWRR\u4ef2\u88c1\u8868\u5c31\u80fd\u6bd4\u8f83\u5bb9\u6613\u7684\u907f\u514d\uff0c\u56e0\u4e3a\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u65f6\u95f4\u70b9\u4e0b\uff0c\u53ea\u6709\u88ab\u4ef2\u88c1\u9009\u4e2d\u7684\u7aef\u53e3\u53ef\u4ee5\u53d1\u9001\u6570\u636e\u5305\u3002\u5982\u679c\u8fd9\u4e2a\u7aef\u53e3\u5728\u53d1\u9001\u5b8c\u4ef2\u88c1\u8bb8\u53ef\u7684\u6570\u636e\u5305\u540e\u4f9d\u7136\u6709\u5f88\u591a\u6570\u636e\u5305\u5728\u961f\u5217\u4e2d\u7b49\u5f85\u53d1\u9001\uff0c\u90a3\u4e48\u5b83\u4e5f\u9700\u8981\u7b49\u5230\u4e0b\u4e00\u6b21\u88ab\u4ef2\u88c1\u9009\u4e2d\u624d\u80fd\u7ee7\u7eed\u53d1\u9001\u540e\u7eed\u7684\u90e8\u5206\u6570\u636e\u5305\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u4e5f\u5c31\u662fSCSI\u63a7\u5236\u5668\u60f3\u5728SI 1\u4e2d\u591a\u53d1\u9001\u7684\u90a3\u4e00\u4e2a\u6570\u636e\u5305\u5b9e\u9645\u4e0a\u53ef\u80fd\u4f1a\u653e\u5230SI 2\u4e2d\u53bb\u53d1\u9001\u3002\u6700\u7ec8\uff0c\u8fd9\u79cd\u201c\u8fc7\u8f7d\u201d\u4f1a\u5bfc\u81f4\u53d1\u9001\u5904\u7684\u6d41\u63a7\u53cd\u538b\u3002</p> <p></p> <p>\u56fe 7\u201126\u8d85\u989d\u4f7f\u7528\u5e26\u5bbd</p> <p>\u7b2c\u4e8c\u4e2a\u95ee\u9898\u88ab\u79f0\u4e3a\u201c\u62e5\u585e\uff08congestion\uff09\u201d\uff0c\u5f53\u5728\u4e00\u4e2a\u7ed9\u5b9a\u7684\u65f6\u95f4\u7a97\u53e3\u5185\u5b58\u5728\u4e86\u592a\u591a\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u8bf7\u6c42\u65f6\uff0c\u5c31\u6709\u53ef\u80fd\u4f1a\u53d1\u751f\u8fd9\u79cd\u95ee\u9898\uff0c\u5982\u56fe 7\u201127\u6240\u793a\u3002\u8fd9\u4e2a\u95ee\u9898\u548c\u7b2c\u4e00\u4e2a\u6709\u70b9\u76f8\u4f3c\uff0c\u4f46\u662f\u5b83\u662f\u65e0\u6cd5\u90a3\u4e48\u7b80\u5355\u5c31\u89e3\u51b3\u7684\u3002\u4e0e\u4e4b\u524d\u7684\u60c5\u51b5\u4e0d\u540c\uff0c\u8fd9\u91cc\u4e0d\u80fd\u5c06\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305\u63a8\u8fdf\u5230\u4e0b\u4e00\u4e2a\u65f6\u9699\u53d1\u9001\uff0c\u56e0\u6b64\u7cfb\u7edf\u5fc5\u987b\u8981\u6709\u529e\u6cd5\u6765\u5904\u7406\u5168\u90e8\u7684\u8fd9\u4e9b\u8bf7\u6c42\u3002\u8981\u7ea0\u6b63\u62e5\u585e\u7684\u95ee\u9898\uff0c\u8f6f\u4ef6\u9700\u8981\u6539\u53d8\u53d1\u9001\u6570\u636e\u5305\u65f6\u95f4\u70b9\u7684\u5206\u5e03\uff0c\u4ee5\u4fbf\u5b83\u4eec\u90fd\u80fd\u591f\u5f97\u5230\u53ef\u7528\u786c\u4ef6\u5e26\u5bbd\u7684\u652f\u6301\u3002</p> <p></p> <p>\u56fe 7\u201127\u5e26\u5bbd\u62e5\u585e</p>"},{"location":"pcie/all/#l-latency-issues","title":"l \u5ef6\u65f6\u95ee\u9898\uff08Latency Issues\uff09","text":"<p>\u7ba1\u7406\u6570\u636e\u5305\u53d1\u9001\u7684\u5ef6\u65f6\u4e5f\u662f\u7b49\u65f6\u6027\u5f88\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u4e2a\u5ef6\u65f6\u5305\u62ec\u7f51\u7edc\u7ed3\u6784\u4f20\u64ad\u5ef6\u65f6\u4e0eCompleter\u5ef6\u65f6\u3002\u7f51\u7edc\u7ed3\u6784\u4f20\u64ad\u5ef6\u65f6\u53d6\u51b3\u4e8e\u7cfb\u7edf\u4e2d\u5404\u79cd\u7ec4\u4ef6\u4e4b\u95f4\u7684\u94fe\u8def\u7684\u5168\u90e8\u7279\u6027\uff0c\u7279\u522b\u662f\u94fe\u8def\u5bbd\u5ea6\u548c\u64cd\u4f5c\u9891\u7387\u3002\u4e00\u79cd\u5c06\u8fd9\u4e2a\u7f51\u7edc\u7ed3\u6784\u4f20\u64ad\u5ef6\u65f6\u503c\u6700\u5c0f\u5316\u7684\u7b80\u5355\u65b9\u6cd5\uff0c\u5c31\u662f\u5bf9PCIe\u62d3\u6251\u7ed3\u6784\u7684\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7684\u590d\u6742\u5ea6\u8fdb\u884c\u7ea6\u675f\u3002Completer\u5ef6\u65f6\u53d6\u51b3\u4e8e\u76ee\u7684EP\u5185\u90e8\u7279\u6027\uff0c\u4f8b\u5982\u5b58\u50a8\u901f\u7387\u4ee5\u53ca\u5185\u90e8\u4ef2\u88c1\u65b9\u5f0f\u7b49\u7b49\u3002</p>"},{"location":"pcie/all/#7633-root-complex","title":"7.6.3.3   Root Complex","text":"<p>RC\u7684\u4ef2\u88c1\u548c\u65f6\u95f4\u89c4\u5212\u9700\u6c42\u548cSwitch\u662f\u4e00\u6837\u7684\u3002\u5b83\u4f1a\u4ece\u591a\u4e2a\u4e0b\u884c\u7aef\u53e3\u63a5\u6536\u6570\u636e\u5305\uff0c\u5e76\u901a\u8fc7\u7b26\u5408\u524d\u9762\u6240\u63cf\u8ff0\u7684\u7b49\u65f6\u6027\u89c4\u5219\u7684\u65b9\u6cd5\u5c06\u5b83\u4eec\u8f6c\u53d1\u81f3\u76ee\u7684\u5730\u3002\u7136\u800c\uff0c\u8fd9\u4e9b\u4e8b\u60c5\u7684\u5b8c\u6210\u65b9\u6cd5\u5927\u90fd\u662fVendor\u7279\u5b9a\u7684\uff0c\u56e0\u4e3a\u534f\u8bae\u89c4\u8303\u4e2d\u5e76\u6ca1\u6709\u5b9a\u4e49\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u7684RC\u5de5\u4f5c\u65b9\u5f0f\u6216\u8005\u662f\u5b83\u5e94\u8be5\u5982\u4f55\u88ab\u7f16\u7a0b\u3002</p>"},{"location":"pcie/all/#l-problemsnooping","title":"l \u95ee\u9898\uff1a\u7aa5\u63a2\uff08Problem\uff1aSnooping\uff09","text":"<p>\u5728\u5f71\u54cdRC\u7684\u65f6\u95f4\u89c4\u5212\u548c\u5ef6\u65f6\u7684\u5404\u79cd\u56e0\u7d20\u91cc\uff0c\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u6ca1\u6709\u8fdb\u884c\u8ba8\u8bba\uff0c\u90a3\u5c31\u662f\u7aa5\u63a2\u8fc7\u7a0b\uff08process of snooping\uff09\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5bf9\u7cfb\u7edf\u5185\u5b58\u7684\u8bbf\u95ee\u4f1a\u53d1\u751f\u5728\u5904\u7406\u5668\u8ba4\u4e3a\u53ef\u7f13\u5b58\uff08cacheable\uff09\u7684\u4f4d\u7f6e\uff0c\u8fd9\u610f\u5473\u7740\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u5185\u5b58\u53ef\u4ee5\u5728\u5b83\u7684\u672c\u5730Cache\u4e2d\u4fdd\u5b58\u4e00\u4e2a\u81ea\u5df1\u7684\u4e34\u65f6\u526f\u672c\u3002\u5982\u679c\u5916\u90e8\u8bbe\u5907\u5c1d\u8bd5\u8bbf\u95ee\u8fd9\u4e2a\u5185\u5b58\u533a\u57df\uff0c\u90a3\u4e48\u82af\u7247\u7ec4\u5fc5\u987b\u5148\u68c0\u67e5\u5904\u7406\u5668Cache\uff0c\u7136\u540e\u624d\u80fd\u5141\u8bb8\u6b64\u6b21\u5185\u5b58\u8bbf\u95ee\uff0c\u56e0\u4e3aCache\u4e2d\u7f13\u5b58\u7684\u526f\u672c\u53ef\u80fd\u5df2\u7ecf\u88ab\u66f4\u6539\u8fc7\uff0c\u4e0e\u539f\u5185\u5b58\u533a\u57df\u4e2d\u7684\u6570\u636e\u5df2\u7ecf\u4e0d\u76f8\u540c\u4e86\u3002\u5982\u679cCache\u4e2d\u7f13\u5b58\u7684\u526f\u672c\u786e\u5b9e\u88ab\u66f4\u6539\u8fc7\uff0c\u90a3\u4e48\u5728\u8bbe\u5907\u8bbf\u95ee\u8fd9\u4e2a\u5185\u5b58\u533a\u57df\u4e4b\u524d\uff0c\u5148\u8981\u8ba9Cache\u4e2d\u7684\u6570\u636e\u5199\u56de\u5185\u5b58\uff08Write Back\uff09\u3002\u867d\u7136\u5bf9\u5185\u5b58Cache\u4e00\u81f4\u6027\u7684\u786e\u8ba4\u5de5\u4f5c\u662f\u6709\u5fc5\u8981\u7684\uff0c\u4f46\u662f\u95ee\u9898\u5c31\u662f\u8fd9\u4e2a\u7aa5\u63a2\u8fc7\u7a0b\u662f\u9700\u8981\u82b1\u8d39\u65f6\u95f4\u7684\u3002\u5b83\u9700\u8981\u82b1\u8d39\u7684\u65f6\u95f4\u901a\u5e38\u662f\u5728\u4e00\u4e2a\u8303\u56f4\u5185\u6709\u9650\u7684\uff0c\u4f46\u662f\u662f\u4e0d\u53ef\u9884\u6d4b\u7684\uff0c\u56e0\u4e3a\u5b83\u53d6\u51b3\u4e8eCPU\u5728\u5f53\u65f6\u5177\u4f53\u6b63\u5728\u6267\u884c\u4ec0\u4e48\u5de5\u4f5c\u3002\u7ed3\u5408\u4e0a\u65f6\u95f4\u89c4\u5212\u7684\u65f6\u95f4\u786e\u5b9a\u6027\u9700\u6c42\uff0c\u7aa5\u63a2\u65f6\u95f4\u7684\u4e0d\u786e\u5b9a\u6027\u5f88\u6709\u53ef\u80fd\u4f1a\u7834\u574f\u540c\u6b65\u7b49\u65f6\u6570\u636e\u6d41\u3002</p>"},{"location":"pcie/all/#l-snooping-solution","title":"l \u7aa5\u63a2\u95ee\u9898\u89e3\u51b3\u65b9\u6cd5\uff08Snooping Solution\uff09","text":"<p>\u5bf9\u4e8e\u5916\u90e8\u8bbe\u5907\u6765\u8bf4\uff0c\u4e00\u79cd\u907f\u514d\u7aa5\u63a2\u7684\u65b9\u6cd5\u5c31\u662f\u4ec5\u8bbf\u95ee\u4e0d\u53ef\u7f13\u5b58\uff08Uncacheable\uff09\u7684\u5185\u5b58\u533a\u57df\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u7531\u8f6f\u4ef6\u8bbe\u7f6e\u9ad8\u4f18\u5148\u7ea7\u6570\u636e\u5305Header\u4e2d\u7684\u201cNo Snoop\uff08\u65e0\u7aa5\u63a2\uff09\u201d\u5c5e\u6027\u4f4d\u3002\u8fd9\u79cd\u65b9\u5f0f\u5c06\u4f1a\u5f3a\u5236\u82af\u7247\u7ec4\u8df3\u8fc7\u7aa5\u63a2\u6b65\u9aa4\uff0c\u4e0d\u7ba1\u5185\u5b58\u662f\u5426\u662funcacheable\u90fd\u76f4\u63a5\u53bb\u8bbf\u95ee\u5185\u5b58\uff0c\u8fd9\u9700\u8981\u8f6f\u4ef6\u7528\u4e00\u4e9b\u65b9\u6cd5\u6765\u4fdd\u8bc1\u8fd9\u6837\u505a\u4e0d\u4f1a\u5f15\u53d1\u95ee\u9898\u3002\u4e3a\u4e86\u5c06\u8fd9\u79cd\u65b9\u5f0f\u4f5c\u4e3a\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u7684\u4e00\u4e2a\u9700\u6c42\u6765\u6267\u884c\uff0c\u5bf9\u4e8e\u9ad8\u4f18\u5148\u7ea7VC\u6765\u8bf4\uff0c\u786c\u4ef6\u53ef\u4ee5\u5bf9RC\u7aef\u53e3\u4e2d\u7684\u53e6\u4e00\u4e2abit\u8fdb\u884c\u521d\u59cb\u5316\u914d\u7f6e\uff0c\u5b83\u53eb\u505a\u201c\u62d2\u7edd\u7aa5\u63a2\u4e8b\u52a1\uff08Reject Snoop Transaction\uff09\u201d\uff0c\u5982\u56fe 7\u201117\u4e2d\u6240\u793a\u7684VC\u8d44\u6e90\u80fd\u529b\u5bc4\u5b58\u5668\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\uff0c\u8ba9\u8fd9\u4e2aVC\u53ea\u5141\u8bb8\u4f20\u8f93No Snoop\u7684\u4e8b\u52a1\u3002\u4efb\u4f55\u8f93\u5165\u7684\u6ca1\u6709\u8bbe\u7f6eNo Snoop\u5c5e\u6027\u4f4d\u7684\u6570\u636e\u5305\u8c46\u6d46\u676f\u4e22\u5f03\uff0c\u4ee5\u6b64\u6765\u786e\u4fdd\u65f6\u95f4\u89c4\u5212\u7684\u65f6\u95f4\u786e\u5b9a\u6027\u4e0d\u4f1a\u88ab\u7aa5\u63a2\u8fc7\u7a0b\u82b1\u8d39\u7684\u4e0d\u786e\u5b9a\u65f6\u95f4\u6240\u7834\u574f\u3002</p>"},{"location":"pcie/all/#7634-power-management","title":"7.6.3.4   \u7535\u6e90\u7ba1\u7406\uff08Power Management\uff09","text":"<p>\u7535\u6e90\u7ba1\u7406\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u76d1\u6d4b\u8fc7\u7a0b\uff0c\u4f46\u662f\u5f53PCIe\u4e2d\u7684\u4e00\u6bb5\u8def\u5f84\u662f\u65f6\u95f4\u654f\u611f\u8def\u5f84\u7684\u65f6\u5019\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8def\u5f84\u4e0a\u8bbe\u5907\u7684\u7535\u6e90\u7ba1\u7406\u673a\u5236PM\uff08Power Management\uff09\u5c31\u9700\u8981\u4ed4\u7ec6\u7684\u5904\u7406\u3002\u914d\u7f6e\u8f6f\u4ef6\u53ef\u4ee5\u8bfb\u53d6\u5230\u6bcf\u79cdPM\u6761\u4ef6\u4e0b\u9020\u6210\u7684\u5ef6\u65f6\uff0c\u5e76\u4ece\u4e2d\u9009\u62e9\u4e00\u79cdPM\u6761\u4ef6\u4f7f\u5f97\u5b83\u7684\u5ef6\u65f6\u53ef\u4ee5\u6ee1\u8db3\u65f6\u95f4\u89c4\u5212\u8981\u6c42\u3002\u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u5728\u540c\u6b65\u7b49\u65f6\u8def\u5f84\u4e0a\u7981\u7528PM\u3002\u8bbe\u5907\u53ef\u4ee5\u8fdb\u5165\u8bbe\u5907\u72b6\u6001D0\u7136\u540e\u5c31\u505c\u7559\u5728\u8fd9\u4e2a\u72b6\u6001\uff0c\u540c\u65f6\u7981\u7528\u786c\u4ef6\u63a7\u5236\u7684\u94fe\u8def\u7535\u6e90\u7ba1\u7406\u673a\u5236\uff08\u66f4\u591a\u5173\u4e8ePM\u7684\u5185\u5bb9\u8bf7\u53c2\u9605Chapter 16\u201cPower Management\u201d\uff09\u3002</p>"},{"location":"pcie/all/#7635-error-handling","title":"7.6.3.5   \u9519\u8bef\u5904\u7406\uff08Error Handling\uff09","text":"<p>\u6700\u540e\uff0c\u8fd8\u5269\u4e0b\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff1a\u5f53\u94fe\u8def\u4e0a\u51fa\u73b0\u9519\u8bef\u65f6\u5e94\u8be5\u600e\u4e48\u529e\u3002ACK/NAK\u534f\u8bae\u63d0\u4f9b\u4e86\u4e00\u4e2a\u81ea\u52a8\u5730\u3001\u57fa\u4e8e\u786c\u4ef6\u7684\u91cd\u8bd5\u673a\u5236\uff08Retry\uff09\u6765\u7ea0\u6b63\u51fa\u73b0\u4f20\u8f93\u95ee\u9898\u7684\u6570\u636e\u5305\u3002\u8fd9\u4e2a\u539f\u672c\u8fd8\u4e0d\u9519\u7684\u7279\u6027\u4f1a\u7ed9\u7b49\u65f6\u6027\u5e26\u6765\u4e00\u4e2a\u95ee\u9898\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u82b1\u8d39\u65f6\u95f4\u6765\u5b8c\u6210\uff0c\u5e76\u4e14\u5b83\u7528\u6765\u89e3\u51b3\u51e0\u4e2a\u4f20\u8f93\u9519\u8bef\u82b1\u8d39\u7684\u65f6\u95f4\u4e5f\u4f1a\u6709\u8f83\u5927\u5dee\u5f02\uff0c\u8fd9\u53d6\u51b3\u4e8e\u5177\u4f53\u68c0\u6d4b\u5230\u4e86\u4ec0\u4e48\u6837\u7684\u9519\u8bef\u3002</p> <p>\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u7cfb\u7edf\u80fd\u5bb9\u5fcd\u591a\u5c11\u4e0d\u786e\u5b9a\u7684\u65f6\u95f4\uff0c\u4f7f\u5f97\u7cfb\u7edf\u4ecd\u80fd\u63d0\u4f9b\u540c\u6b65\u7b49\u65f6\u6570\u636e\u4f20\u8f93\u3002\u5982\u679c\u5ef6\u65f6\u65f6\u95f4\u9884\u7b97\u592a\u7d27\u5f20\uff0c\u90a3\u4e48\u663e\u7136\u5c31\u6ca1\u6709\u65f6\u95f4\u53ef\u4ee5\u7528\u6765\u91cd\u8bd5\u4f20\u8f93\u5931\u8d25\u7684\u6570\u636e\u5305\uff0c\u4e5f\u5c31\u9700\u8981\u7981\u7528ACK/NAK\u534f\u8bae\u3002\u6709\u8da3\u7684\u662f\uff0cPCIe\u7684\u534f\u8bae\u89c4\u8303\u5236\u5b9a\u8005\u663e\u7136\u6ca1\u6709\u8003\u8651\u5230\u8fd9\u4e00\u70b9\uff0c\u56e0\u4e3a\u5e76\u6ca1\u6709\u8bbe\u8ba1\u7528\u6765\u7981\u7528ACK/NAK\u534f\u8bae\u7684\u914d\u7f6ebit\uff0c\u4e5f\u6ca1\u6709\u8bbe\u8ba1\u914d\u7f6ebit\u7528\u6765\u51b3\u5b9a\u5982\u4f55\u5904\u7406\u90a3\u4e9b\u672c\u6765\u4f1a\u88ab\u91cd\u4f20\u800c\u73b0\u5728\u4e0d\u4f1a\u88ab\u91cd\u4f20\u7684\u6570\u636e\u5305\u3002\u56e0\u6b64\uff0c\u7981\u7528ACK/NAK\u534f\u8bae\u9700\u8981\u4f7f\u7528\u4e00\u4e9b\u975e\u6807\u51c6\u673a\u5236\uff0c\u4f8b\u5982Vendor-specific\u5bc4\u5b58\u5668\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u8db3\u591f\u7684\u65f6\u95f4\u7528\u4e8e\u91cd\u4f20\uff0c\u90a3\u4e48\u76ee\u7684\u65b9\u53ef\u80fd\u5c31\u4f1a\u7b80\u5355\u7684\u5c06\u635f\u574f\u7684\u6570\u636e\u5305\u4e22\u5f03\u3002\u53e6\u4e00\u4e2a\u9009\u62e9\u662f\u5c31\u76f4\u63a5\u4f7f\u7528\u635f\u574f\u3001\u9519\u8bef\u7684\u6240\u6709\u6570\u636e\u5305\u3002\u5bf9\u4e8e\u4e00\u4e9b\u4f7f\u7528\u540c\u6b65\u7b49\u65f6\u670d\u52a1\u652f\u6301\u7684\u5e94\u7528\u6765\u8bf4\uff0c\u4f7f\u7528\u635f\u574f\u6570\u636e\u5305\u7684\u8fd9\u79cd\u64cd\u4f5c\u5e76\u6ca1\u6709\u542c\u8d77\u6765\u8fd9\u4e48\u4e0d\u53ef\u63a5\u53d7\u3002\u4f8b\u5982\uff0c\u89c6\u9891\u6d41\u4e2d\u7684\u9519\u8bef\u53ef\u80fd\u4f1a\u5bfc\u81f4\u663e\u793a\u5668\u5076\u5c14\u51fa\u73b0\u6545\u969c\u95ea\u70c1\uff0c\u4f46\u662f\u8fd9\u4e2a\u98ce\u9669\u88ab\u8ba4\u4e3a\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002</p> <p>\u4e0d\u540c\u4e8e\u4e0a\u9762\u7684\u60c5\u51b5\uff0c\u5982\u679c\u5728\u670d\u52a1\u95f4\u9694\uff08Service Interval\uff09\u4e2d\uff0c\u6709\u8db3\u591f\u7684\u65f6\u95f4\u7528\u4e8e\u91cd\u4f20\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u8ba1\u65f6\u5668\u7684\u65b9\u5f0f\u6765\u7ed9\u91cd\u8bd5\u5ef6\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u4e0a\u9650\uff0c\u8fd9\u4e2a\u8ba1\u65f6\u5668\u4f1a\u4e00\u76f4\u8bb0\u5f55\u65f6\u95f4\u76f4\u5230\u5f53\u524dSI\u7ed3\u675f\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u51b3\u5b9a\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u91cd\u8bd5\u64cd\u4f5c\u3002\u5f53\u7136\uff0c\u9519\u8bef\u60c5\u51b5\u4e0d\u5e94\u8be5\u5f88\u9891\u7e41\u7684\u51fa\u73b0\uff0c\u6240\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u4e8e\u5076\u5c14\u51fa\u73b0\u7684\u4f20\u8f93\u9519\u8bef\u6765\u8bf4\u662f\u8db3\u591f\u7684\uff0c\u5e76\u4e14\u540c\u65f6\u4e5f\u53ef\u4ee5\u4fdd\u6301\u540c\u6b65\u7b49\u65f6\u7684\u65f6\u95f4\u89c4\u5212\u3002</p>"},{"location":"pcie/all/#chapter-8-transaction-ordering","title":"Chapter 8      Transaction Ordering //\u4e8b\u52a1\u6392\u5e8f","text":""},{"location":"pcie/all/#_21","title":"\u5173\u4e8e\u4e0a\u4e00\u7ae0","text":"<p>\u4e0a\u4e00\u7ae0\u8282\u8ba8\u8bba\u4e86\u7528\u4e8e\u652f\u6301QoS\uff08Quality of Service\uff09\u7684\u673a\u5236\uff0c\u5e76\u63cf\u8ff0\u4e86\u5bf9\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u4e0d\u540c\u6570\u636e\u5305\u7684\u4f20\u8f93\u65f6\u95f4\u548c\u5e26\u5bbd\u8fdb\u884c\u63a7\u5236\u7684\u610f\u4e49\u3002\u8fd9\u4e9b\u673a\u5236\u5305\u62ec\uff0c\u7279\u5b9a\u5e94\u7528\u7684\u8f6f\u4ef6\u5c06\u4f1a\u7ed9\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u5206\u914d\u4f18\u5148\u7ea7\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u8bbe\u5907\u5185\u6784\u5efa\u53ef\u9009\u7684\u786c\u4ef6\u6765\u542f\u7528\u4e8b\u52a1\u4f18\u5148\u7ea7\u7ba1\u7406\u3002</p>"},{"location":"pcie/all/#_22","title":"\u5173\u4e8e\u672c\u7ae0","text":"<p>\u672c\u7ae0\u8282\u5c06\u4f1a\u8ba8\u8bbaPCIe\u62d3\u6251\u7ed3\u6784\u4e2d\u4e8b\u52a1\u5bf9\u6392\u5e8f\u7684\u8981\u6c42\u3002\u8fd9\u4e9b\u89c4\u5219\u662f\u7ee7\u627f\u81eaPCI\u7684\uff0c\u5b83\u4eec\u8bb8\u591a\u90fd\u53d7\u5230\u201c\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff08Producer/Consumer\uff09\u201d\u7a0b\u5e8f\u8bbe\u8ba1\u6a21\u578b\u7684\u63a8\u52a8\uff0c\u56e0\u6b64\u5728\u672c\u7ae0\u5185\u4f1a\u63cf\u8ff0\u8fd9\u4e2a\u6a21\u578b\u7684\u673a\u5236\u539f\u7406\u3002\u539f\u59cb\u7684\u89c4\u5219\u4e2d\u8fd8\u8003\u8651\u4e86\u5fc5\u987b\u8981\u907f\u514d\u7684\u90a3\u4e9b\u6b7b\u9501\u60c5\u51b5\u3002</p>"},{"location":"pcie/all/#_23","title":"\u5173\u4e8e\u4e0b\u4e00\u7ae0","text":"<p>\u4e0b\u4e00\u7ae0\u8282\u5c06\u4f1a\u63cf\u8ff0Data Link Layer Packet\uff08DLLP\uff0c\u6570\u636e\u94fe\u8def\u5c42\u5305\uff09\u3002\u6211\u4eec\u5c06\u4f1a\u63cf\u8ff0\u5176\u7528\u9014\u3001\u683c\u5f0f\u4ee5\u53caDLLP\u6570\u636e\u5305\u7c7b\u578b\u7684\u5b9a\u4e49\uff0c\u4e5f\u5c06\u4f1a\u5bf9\u5176\u76f8\u5173\u5b57\u6bb5\u7684\u7ec6\u8282\u8fdb\u884c\u63cf\u8ff0\u4ecb\u7ecd\u3002DLLP\u53ef\u4ee5\u88ab\u7528\u6765\u652f\u6301Ack/Nak\u534f\u8bae\u3001\u7535\u6e90\u7ba1\u7406\u3001\u6d41\u63a7\u673a\u5236\uff0c\u8fd8\u53ef\u4ee5\u88ab\u7528\u6765\u505a\u4e00\u4e9bvendor\u81ea\u5b9a\u4e49\u7684\u4e8b\u60c5\u3002</p>"},{"location":"pcie/all/#81-introduction","title":"8.1 \u4ecb\u7ecd\uff08Introduction\uff09","text":"<p>\u548c\u5176\u4ed6\u534f\u8bae\u4e00\u6837\uff0c\u5bf9\u4e8e\u540c\u65f6\u8981\u5728\u7f51\u7edc\u7ed3\u6784\u4e2d\u8fdb\u884c\u4f20\u8f93\u7684\u3001\u62e5\u6709\u76f8\u540cTC\uff08Traffic Class\uff0c\u6d41\u91cf\u7c7b\u578b\uff09\u4e8b\u52a1\uff0cPCIe\u89c4\u5b9a\u4e86\u5b83\u4eec\u4e4b\u95f4\u7684\u6392\u5e8f\u89c4\u5219\u3002\u800c\u5bf9\u4e8e\u62e5\u6709\u4e0d\u540cTC\u7684\u4e8b\u52a1\u4e4b\u95f4\u5219\u5e76\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u3002\u5bf9\u76f8\u540cTC\u7684\u4e8b\u52a1\u6307\u5b9a\u6392\u5e8f\u89c4\u5219\u7684\u539f\u56e0\u6709\uff1a</p> <p>n \u7ef4\u6301\u4e0e\u4f20\u7edf\u9057\u7559\u603b\u7ebf\u7684\u517c\u5bb9\u6027\uff0c\u4f8b\u5982PCI\u3001PCI-X\u548cAGP\u3002</p> <p>n \u4fdd\u8bc1\u4e8b\u52a1\u7684\u5b8c\u6210\u662f\u786e\u5b9a\u7684\uff08deterministic\uff09\uff0c\u4e14\u662f\u6309\u7167\u7a0b\u5e8f\u5458\u60f3\u8981\u7684\u987a\u5e8f\u53f7\u8fdb\u884c\u7684\u3002</p> <p>n \u907f\u514d\u6b7b\u9501\u60c5\u51b5\u3002</p> <p>n \u901a\u8fc7\u5c06\u8bfb\u53d6\u5ef6\u65f6\u6700\u5c0f\u5316\u5e76\u7ba1\u7406\u8bfb\u5199\u7684\u987a\u5e8f\uff0c\u6765\u5c06\u6027\u80fd\u548c\u541e\u5410\u91cf\u6700\u5927\u5316\u3002</p> <p>\u5177\u4f53\u7684PCI/PCIe\u4e8b\u52a1\u6392\u5e8f\u7684\u5b9e\u73b0\u57fa\u4e8e\u4ee5\u4e0b\u7684\u7279\u6027\uff1a</p> <p>\\1.    \u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u7f16\u7a0b\u6a21\u578b\uff08Producer/Consumer\uff09\uff0c\u5b83\u662f\u57fa\u672c\u6392\u5e8f\u89c4\u5219\u7684\u57fa\u7840\u3002</p> <p>\\2.    \u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09\uff0c\u5f53\u8bf7\u6c42\u8005\u77e5\u9053\u67d0\u4e2a\u4e8b\u52a1\u4e0e\u5148\u524d\u7684\u4e8b\u52a1\u6ca1\u6709\u4efb\u4f55\u4f9d\u8d56\u5173\u7cfb\u65f6\uff0c\u5219\u5141\u8bb8\u51fa\u73b0\u5bbd\u677e\u6392\u5e8f\u3002</p> <p>\\3.    ID\u6392\u5e8f\uff08ID Ordering\uff09\uff0c\u5728ID\u6392\u5e8f\u89c4\u5219\u4e0b\uff0cSwitch\u53ef\u4ee5\u5141\u8bb8\u6765\u81ea\u67d0\u4e00\u4e2a\u8bbe\u5907\u7684\u8bf7\u6c42\u5148\u4e8e\u53e6\u4e00\u4e2a\u8bbe\u5907\u7684\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u8bbe\u5907\u6b63\u5728\u6267\u884c\u4e0d\u76f8\u5173\u7684\u7ebf\u7a0b\u3002</p> <p>\\4.    \u4e00\u4e9b\u907f\u514d\u6b7b\u9501\u60c5\u51b5\u7684\u65b9\u6cd5\u4ee5\u53ca\u652f\u6301PCI\u4f20\u7edf\u8bbe\u5907\u5b9e\u73b0\u7684\u65b9\u6cd5\u3002</p>"},{"location":"pcie/all/#82-definitions","title":"8.2 \u5b9a\u4e49\uff08Definitions\uff09","text":"<p>\u5728\u6570\u636e\u6d41\u4e2d\u6709\u4e09\u79cd\u901a\u7528\u6a21\u578b\u7528\u4e8e\u4e8b\u52a1\u6392\u5e8f\uff1a</p> <p>\\1.    \u5f3a\u6392\u5e8f\uff08Strong Ordering**\uff09**\uff1a\u5bf9\u4e8e\u5728PCIe\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u62e5\u6709\u76f8\u540cTC\u7684\u591a\u4e2a\u4e8b\u52a1\u6d41\uff0cPCIe\u8981\u6c42\u4f7f\u7528\u5f3a\u6392\u5e8f\u89c4\u5219\u3002\u62e5\u6709\u76f8\u540cTC\u7684\u4e8b\u52a1\u4eec\u4e5f\u4f1a\u88ab\u6620\u5c04\u5230\u540c\u4e00\u4e2a\u7ed9\u5b9aVC\uff0c\u56e0\u6b64\u6bcf\u4e2aVC\u4e2d\u4e5f\u8981\u5e94\u7528\u5f3a\u6392\u5e8f\u89c4\u5219\u3002\u56e0\u6b64\uff0c\u5f53\u591a\u4e2aTC\u90fd\u88ab\u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u65f6\uff0c\u8fd9\u4e9bTC\u7684\u6240\u6709\u4e8b\u52a1\u90fd\u4f1a\u88ab\u5f53\u505a\u540c\u4e00\u4e2aTC\u6765\u8fdb\u884c\u5904\u7406\uff0c\u5373\u4f7f\u4e0d\u540c\u7684TC\u4e4b\u95f4\u4e0d\u5b58\u5728\u6392\u5e8f\u5173\u7cfb\u3002</p> <p>\\2.    \u5f31\u6392\u5e8f\uff08Weak Ordering**\uff09**\uff1a\u9664\u975e\u4e8b\u52a1\u9700\u8981\u91cd\u65b0\u6392\u5e8f\uff0c\u5426\u5219\u5b83\u4eec\u5c06\u7ef4\u6301\u539f\u6765\u7684\u987a\u5e8f\u3002\u7531\u4e8e\u67d0\u4e9b\u7ed9\u5b9a\u7684\u4e8b\u52a1\u6a21\u578b\uff08\u4f8b\u5982Producer/Consumer\u6a21\u578b\uff09\u76f8\u5173\u7684\u4f9d\u8d56\u6027\uff0c\u7ef4\u6301\u4e8b\u7269\u95f4\u7684\u5f3a\u6392\u5e8f\u5173\u7cfb\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u88ab\u963b\u585e\u3002\u800c\u88ab\u963b\u585e\u7684\u4e8b\u52a1\u4e2d\uff0c\u6709\u4e9b\u4e0e\u4f9d\u8d56\u5173\u7cfb\u5e76\u4e0d\u76f8\u5173\u8054\uff0c\u5b83\u4eec\u5c31\u53ef\u4ee5\u5b89\u5168\u5730\u88ab\u91cd\u65b0\u6392\u5728\u963b\u585e\u7684\u4e8b\u52a1\u4e4b\u524d\u3002</p> <p>\\3.    \u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering**\uff09**\uff1a\u5728\u4e14\u4ec5\u5728\u67d0\u4e9b\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u4e8b\u52a1\u53ef\u4ee5\u88ab\u91cd\u65b0\u6392\u5e8f\uff0c\u5b83\u7684\u597d\u5904\u662f\u53ef\u4ee5\u50cf\u5f31\u6392\u5e8f\u6a21\u578b\u4e00\u6837\u63d0\u5347\u6027\u80fd\uff0c\u4f46\u662f\u5b83\u4ec5\u5728\u8f6f\u4ef6\u6307\u5b9a\u662f\u624d\u4f1a\u8fd9\u6837\u505a\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u4f9d\u8d56\u95ee\u9898\u3002\u800c\u5b83\u7684\u7f3a\u70b9\u5219\u662f\u4ec5\u6709\u90e8\u5206\u4e8b\u52a1\u53ef\u4ee5\u5f97\u5230\u6027\u80fd\u4e0a\u7684\u4f18\u5316\u3002\u8f6f\u4ef6\u8981\u542f\u7528\u5bbd\u677e\u6392\u5e8f\uff08RO\uff0cRelaxed Ordering\uff09\u4e5f\u9700\u8981\u4e00\u4e9b\u989d\u5916\u5f00\u9500\u3002</p>"},{"location":"pcie/all/#83-simplified-ordering-rules","title":"8.3 \u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\uff08Simplified Ordering Rules\uff09","text":"<p>PCIe 2.1\u7248\u672c\u4e2d\u4ecb\u7ecd\u4e86\u4e00\u79cd\u7b80\u5316\u7248\u7684\u6392\u5e8f\u89c4\u5219\u8868\uff0c\u5982\u6240\u793a\u3002\u8fd9\u4e2a\u8868\u683c\u53ef\u4ee5\u6309\u4e3b\u9898\u5212\u5206\u5982\u4e0b\uff1a</p> <p>n \u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff08Producer/Consumer\uff09\u89c4\u5219</p> <p>n \u5bbd\u677e\u6392\u5e8f\uff08RO\uff09\u89c4\u5219</p> <p>n \u5f31\u6392\u5e8f\u89c4\u5219</p> <p>n ID\u6392\u5e8f\u89c4\u5219</p> <p>n \u6b7b\u9501\u7684\u907f\u514d</p> <p>\u8fd9\u4e9b\u5c0f\u8282\u4e2d\u4f1a\u7ed9\u51fa\u4e0e\u5404\u4e2a\u6392\u5e8f\u6a21\u578b\u3001\u64cd\u4f5c\u3001\u57fa\u672c\u539f\u7406\u3001\u60c5\u51b5\u4ee5\u53ca\u8981\u6c42\u76f8\u5173\u7684\u7ec6\u8282\u5185\u5bb9\u3002</p>"},{"location":"pcie/all/#831-ordering-rules-and-traffic-classes","title":"8.3.1     \u6392\u5e8f\u89c4\u5219\u4e0e\u6d41\u91cf\u7c7b\u578b\uff08Ordering Rules and Traffic Classes\uff09","text":"<p>PCIe\u4e2d\u7684\u6392\u5e8f\u89c4\u5219\u4f1a\u5e94\u7528\u4e8e\u62e5\u6709\u76f8\u540cTC\uff08\u6d41\u91cf\u7c7b\u578b\uff09\u7684\u4e8b\u52a1\u4e4b\u95f4\u3002\u5bf9\u4e8e\u90a3\u4e9b\u5728\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u7684\u5177\u6709\u4e0d\u540cTC\u7684\u4e8b\u52a1\u6765\u8bf4\uff0c\u5e76\u6ca1\u6709\u9488\u5bf9\u5b83\u4eec\u7684\u6392\u5e8f\u8981\u6c42\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u4eec\u5404\u81ea\u7684\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u662f\u6ca1\u6709\u5173\u8054\u7684\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e0d\u540cTC\u7684\u6570\u636e\u5305\u6765\u8bf4\uff0c\u4e5f\u5c31\u4e0d\u5b58\u5728\u7531\u4e8e\u4e8b\u52a1\u6392\u5e8f\u800c\u5e26\u6765\u7684\u6027\u80fd\u964d\u4f4e\u95ee\u9898\u3002</p> <p>\u5bf9\u4e8e\u62e5\u6709\u76f8\u540cTC\u7684\u6570\u636e\u5305\u6765\u8bf4\uff0c\u5f53\u5b83\u4eec\u5728PCIe\u7f51\u7edc\u7ed3\u6784\u4e2d\u4f20\u8f93\u65f6\uff0c\u6709\u53ef\u80fd\u4f1a\u7ecf\u5386\u6027\u80fd\u964d\u4f4e\u3002\u8fd9\u662f\u56e0\u4e3aSwitch\u548c\u8bbe\u5907\u4eec\u5fc5\u987b\u8981\u652f\u6301\u4e00\u4e9b\u6392\u5e8f\u89c4\u5219\uff0c\u800c\u8fd9\u53ef\u80fd\u4f1a\u8981\u6c42\u5c06\u6570\u636e\u5305\u5ef6\u8fdf\uff0c\u6216\u8005\u5728\u5148\u53d1\u9001\u6765\u7684\u6570\u636e\u5305\u4e4b\u524d\u5c06\u540e\u53d1\u9001\u6765\u7684\u6570\u636e\u5305\u8f6c\u53d1\u51fa\u53bb\u3002</p> <p>\u50cfChapter 7\u201cQuality of Service\u670d\u52a1\u8d28\u91cf\u201d\u4e00\u7ae0\u4e2d\u8ba8\u8bba\u7684\u90a3\u6837\uff0c\u62e5\u6709\u4e0d\u540cTC\u7684\u4e8b\u52a1\u53ef\u80fd\u4f1a\u88ab\u6620\u5c04\u5230\u540c\u4e00\u4e2aVC\u3002TC-to-VC\u6620\u5c04\u5173\u7cfb\u7684\u914d\u7f6e\u51b3\u5b9a\u4e86\u4e00\u4e2a\u7ed9\u5b9a\u4e86TC\u7684\u6570\u636e\u5305\u5c06\u4f1a\u88ab\u6620\u5c04\u5230\u54ea\u4e00\u4e2a\u6307\u5b9a\u7684VC\u53bb\u3002\u5c3d\u7ba1\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u4ec5\u5e94\u7528\u4e8e\u76f8\u540cTC\u7684\u6570\u636e\u5305\u4e4b\u95f4\uff0c\u4f46\u662f\u53ef\u80fd\u4e5f\u53ef\u4ee5\u66f4\u7b80\u5355\u7684\u8bbe\u8ba1EP/Switch/RC\u4ee4\u5b83\u4eec\u5c06\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u5e94\u7528\u5728\u540c\u4e00\u4e2aVC\u4e2d\u7684\u6240\u6709\u6570\u636e\u5305\u4e4b\u95f4\uff0c\u5373\u4f7f\u5728\u4e00\u4e2aVC\u4e2d\u53ef\u80fd\u542b\u6709\u591a\u4e2aTC\u7684\u6570\u636e\u5305\u3002</p> <p>\u663e\u7136\uff0c\u6620\u5c04\u5230\u4e0d\u540cVC\u7684\u6570\u636e\u5305\u4e4b\u95f4\u6ca1\u6709\u6392\u5e8f\u5173\u7cfb\u3002</p>"},{"location":"pcie/all/#832-ordering-rules-based-on-packet-type","title":"8.3.2     \u57fa\u4e8e\u5305\u7c7b\u578b\u7684\u6392\u5e8f\u89c4\u5219\uff08Ordering Rules Based On Packet Type\uff09","text":"<p>PCIe\u534f\u8bae\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684\u6392\u5e8f\u5173\u7cfb\u662f\u57fa\u4e8eTLP\u7c7b\u578b\u7684\u3002TLP\u88ab\u5206\u4e3a\u4e09\u4e2a\u79cd\u7c7b\uff1a</p> <p>\\1)   Posted</p> <p>\\2)   Completion</p> <p>\\3)   Non-Posted</p> <p>Posted\u79cd\u7c7b\u7684TLP\u5305\u62ecMWr\u8bf7\u6c42\uff08Memory Write request\uff09\u4e0eMessage\uff08Msg/MsgD\uff09\u3002Completion\u79cd\u7c7b\u7684TLP\u5305\u62ecCpl\u4e0eCplD\u3002Non-Posted\u79cd\u7c7b\u7684TLP\u5305\u62ecMRd\u3001IORd\u3001IOWr\u3001CfgRd0\u3001CfgRd1\u3001CfgWr0\u4ee5\u53caCFGWr1\u3002</p> <p>\u5728\u4e0b\u4e00\u5c0f\u8282\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e2a\u8868\u683c\uff08\u8868 8\u20111\uff09\u6765\u63cf\u8ff0\u4e8b\u52a1\u7684\u6392\u5e8f\u89c4\u5219\uff0c\u4f60\u5c06\u4f1a\u770b\u5230\u8fd9\u4e2a\u8868\u683c\u4e2d\u5217\u51fa\u4e86\u4e0a\u9762\u63d0\u5230\u7684\u4e09\u4e2a\u79cd\u7c7b\u7684TLP\u4ee5\u53ca\u5b83\u4eec\u6240\u5b9a\u4e49\u7684\u6392\u5e8f\u5173\u7cfb\u3002</p>"},{"location":"pcie/all/#833-the-simplified-ordering-rules-table","title":"8.3.3     \u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\u8868\uff08The Simplified Ordering Rules Table\uff09","text":"<p>\u8be5\u8868\u6309\u7167Row Pass Column\uff08\u884c\u4f20\u9012\u5217\uff09\u7684\u65b9\u5f0f\u5bf9\u5185\u5bb9\u8fdb\u884c\u7ec4\u7ec7\u3002\u6240\u6709\u7684\u6392\u5e8f\u89c4\u5219\u90fd\u5728\u7b80\u5316\u540e\u7684\u6392\u5e8f\u8868\uff08\u8868 8\u20111\uff09\u4e4b\u540e\u8fdb\u884c\u603b\u7ed3\u6982\u62ec\u3002\u6bcf\u79cd\u89c4\u5219\uff0c\u6216\u8005\u6bcf\u7ec4\u89c4\u5219\uff0c\u90fd\u5b9a\u4e49\u4e86\u5b83\u4eec\u8981\u6c42\u7684\u64cd\u4f5c\u5185\u5bb9\u3002</p> <p>\u5728\u8868 8\u20111\u4e2d\uff0c\u52172-5\u4ee3\u8868\u5148\u524d\u5df2\u7ecf\u88abPCIe\u8bbe\u5907\u53d1\u9001\u7684\u4e8b\u52a1\uff0c\u800c\u884cA-D\u5219\u4ee3\u88681\u4e2a\u521a\u521a\u5230\u8fbe\u7684\u65b0\u7684\u4e8b\u52a1\u3002\u5bf9\u4e8e\u51fa\u7ad9\u4e8b\u52a1\uff08outbound transaction\uff09\uff0c\u8be5\u8868\u6307\u5b9a\u4e86\u884c\uff08A-D\uff09\u6240\u4ee3\u8868\u7684\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u8d85\u8fc7\u4e00\u4e2a\u7531\u5217\uff082-5\uff09\u6240\u4ee3\u8868\u7684\u5148\u524d\u7684\u4e8b\u52a1\u3002\u8868\u4e2d\u7684\u201cNo\u201d\u8868\u793a\u884c\u4e8b\u52a1\u4e0d\u5141\u8bb8\u8d85\u8fc7\u5217\u4e8b\u52a1\uff0c\u201cYes\u201d\u8868\u793a\u5fc5\u987b\u5141\u8bb8\u884c\u4e8b\u52a1\u8d85\u8fc7\u5217\u4e8b\u52a1\u4ee5\u6b64\u6765\u907f\u514d\u6b7b\u9501\uff0c\u800c\u201cYes/No\u201d\u5219\u8868\u793a\u884c\u4e8b\u52a1\u53ef\u4ee5\u8d85\u8fc7\u5217\u4e8b\u52a1\u4f46\u662f\u5e76\u4e0d\u8981\u6c42\u4e00\u5b9a\u8981\u8fd9\u4e48\u505a\u3002\u8868\u4e2d\u5404\u4e2a\u6761\u76ee\u5747\u6709\u5176\u542b\u4e49\u3002</p> <p></p> <p>\u8868 8\u20111\u7b80\u5316\u540e\u7684\u6392\u5e8f\u89c4\u5219\u8868</p> <p>n A2a,B2a,C2a,D2a\uff1a\u4e3a\u4e86\u6267\u884c\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\uff0c\u540e\u6765\u7684\u4e8b\u52a1\u4e0d\u5141\u8bb8\u8d85\u8fc7\u8d85\u8fc7\u4e00\u4e2a\u5148\u524d\u7684Posted\u8bf7\u6c42\u3002</p> <p>n D2b\uff1a\u5982\u679c\u8bbe\u7f6e\u4e86RO\uff08Relaxed Ordering\uff09\uff0c\u90a3\u4e48\u4e00\u4e2aRead Completion\u662f\u53ef\u4ee5\u8d85\u8fc7\u4e00\u4e2a\u5148\u524d\u5df2\u6392\u961f\u7684MWr\u6216\u662fMessage\u8bf7\u6c42\u7684\u3002</p> <p>n A2b,B2b,C2b,D2b\uff1a\u5982\u679c\u4f7f\u7528\u4e86\u53ef\u9009\u7684IDO\uff08ID Ordering\uff09\uff0c\u90a3\u4e48\u540e\u6765\u7684\u4e8b\u52a1\u662f\u5141\u8bb8\u8d85\u8fc7\u4e00\u4e2aPosted\u8bf7\u6c42\u7684\uff0c\u53ea\u8981\u5b83\u4eec\u4e24\u4e2a\u7684Requester ID\u4e0d\u540c\u3002</p> <p>n A3,A4\uff1a\u4e00\u4e2aMwr\u6216\u8005Message\u8bf7\u6c42\u5fc5\u987b\u8981\u53ef\u4ee5\u8d85\u8fc7Non-Posted\u8bf7\u6c42\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u6b7b\u9501\u3002</p> <p>n A5a\uff1aPosted\u8bf7\u6c42\u53ef\u4ee5\u4f46\u4e0d\u8981\u4e0d\u8d85\u8fc7Completion\u3002</p> <p>n A5b\uff1a\u907f\u514d\u6b7b\u9501\u7684\u60c5\u51b5\u3002\u5728\u4e00\u4e2aPCIe-to-PCI/PCI-X Bridge\u4e2d\uff0c\u4e3a\u4e86\u8ba9\u4e8b\u52a1\u4ecePCIe\u4f20\u5230PCI\u6216PCI-X\uff0cPosted\u8bf7\u6c42\u5fc5\u987b\u8981\u80fd\u8d85\u8fc7Completion\uff0c\u5426\u5219\u5c06\u6709\u53ef\u80fd\u53d1\u751f\u6b7b\u9501\u3002</p> <p>n B3,B4,B5,C3,C4,C5\uff1a\u8fd9\u4e9b\u60c5\u51b5\u5b9e\u73b0\u5f31\u6392\u5e8f\uff0c\u4e14\u4e0d\u4f1a\u6709\u4efb\u4f55\u4e0e\u6392\u5e8f\u76f8\u5173\u95ee\u9898\u7684\u98ce\u9669\u3002</p> <p>n D3,D4\uff1aCompletion\u5fc5\u987b\u8981\u80fd\u8d85\u8fc7Read\u3001IO\u6216\u8005\u662f\u914d\u7f6e\u5199\u8bf7\u6c42\uff08Non-Posted\u8bf7\u6c42\uff09\uff0c\u4ee5\u6b64\u6765\u907f\u514d\u6b7b\u9501\u3002</p> <p>n D5a\uff1a\u62e5\u6709\u4e0d\u540c\u4e8b\u52a1ID\u7684\u4e24\u4e2aCompletion\u90fd\u53ef\u4ee5\u8d85\u8fc7\u5bf9\u65b9\u3002</p> <p>n D5b\uff1a\u62e5\u6709\u76f8\u540c\u4e8b\u52a1ID\u7684Completion\u4eec\u4e0d\u80fd\u8d85\u8fc7\u5bf9\u65b9\uff0c\u8981\u4fdd\u6301\u539f\u6392\u5e8f\u3002\u8fd9\u662f\u4e3a\u4e86\u4fdd\u8bc1\u5728\u7ed9\u5355\u4e2a\u8bf7\u6c42\u8fd4\u56de\u591a\u4e2aCompletion\u65f6\uff0c\u4ecd\u7136\u53ef\u4ee5\u4fdd\u6301\u5730\u5740\u7684\u9012\u589e\u987a\u5e8f\u3002</p>"},{"location":"pcie/all/#84-producerconsumer-model","title":"8.4 \u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\uff08Producer/Consumer Model\uff09","text":"<p>\u8fd9\u4e00\u8282\u5c06\u4f1a\u63cf\u8ff0Producer/Consumer\uff08\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff09\u6a21\u578b\u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u4ee5\u53ca\u4e3a\u4e86\u6b63\u786e\u6267\u884c\u8fd9\u4e2a\u6a21\u578b\u6240\u9700\u8981\u7684\u6392\u5e8f\u89c4\u5219\u3002\u56fe 8\u20111\u4e2d\u7b80\u5355\u7684\u5c55\u793a\u4e86\u4e00\u4e2a\u7528\u4e8e\u793a\u4f8b\u7684\u62d3\u6251\u7ed3\u6784\u3002\u5728\u63a5\u4e0b\u6765\u7684\u4f7f\u7528\u8fd9\u4e2a\u62d3\u6251\u7ed3\u6784\u7684\u7b2c\u4e00\u4e2a\u793a\u4f8b\u4e2d\u5c06\u4f1a\u63cf\u8ff0Producer/Consumer\u6a21\u578b\u5728\u4f7f\u7528\u5408\u9002\u7684\u6392\u5e8f\u89c4\u5219\u65f6\u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u7136\u540e\u4f1a\u518d\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50\u7528\u4e8e\u63cf\u8ff0Producer/Consumer\u6a21\u578b\u5728\u4f7f\u7528\u4e0d\u5408\u9002\u7684\u6392\u5e8f\u89c4\u5219\u65f6\u5bfc\u81f4\u64cd\u4f5c\u9519\u8bef\u7684\u5931\u8d25\u60c5\u51b5\u3002</p> <p>Producer/Consumer\u6a21\u578b\u662fPCI\u548cPCIe\u4e2d\u6570\u636e\u4f20\u8f93\u65f6\u7684\u5e38\u7528\u65b9\u6cd5\u3002\u8fd9\u4e2a\u6a21\u578b\u7531\u56fe 8\u20111\u4e2d\u6240\u5c55\u793a\u76845\u4e2a\u5143\u7d20\u6240\u7ec4\u6210\uff1a</p> <p>n \u6570\u636e\u7684Producer\uff08\u751f\u4ea7\u8005\uff09</p> <p>n \u5185\u5b58\u6570\u636eBuffer</p> <p>n \u7528\u4e8e\u6307\u793a\u6570\u636e\u5df2\u7ecf\u7531\u751f\u4ea7\u8005\u53d1\u9001\u7684Flag semaphore\uff08\u6807\u5fd7\u4fe1\u53f7\u91cf\uff09</p> <p>n \u6570\u636e\u7684Consumer\uff08\u6d88\u8d39\u8005\uff09</p> <p>n \u7528\u4e8e\u6307\u793a\u6d88\u8d39\u8005\u5df2\u7ecf\u8bfb\u53d6\u4e86\u6570\u636e\u7684Status semaphore\uff08\u72b6\u6001\u4fe1\u53f7\u91cf\uff09</p> <p>\u534f\u8bae\u89c4\u8303\u4e2d\u6307\u51fa\uff0c\u65e0\u8bba\u6240\u6709\u7684\u76f8\u5173\u7684\u5143\u7d20\u662f\u5982\u4f55\u6392\u5217\u653e\u7f6e\u7684\uff0cProducer/Consumer\u6a21\u578b\u90fd\u4f1a\u6267\u884c\u5de5\u4f5c\u3002\u5728\u672c\u4f8b\u4e2d\uff0cFlag\u548cStatus\u5143\u7d20\u90fd\u4f4d\u4e8e\u540c\u4e00\u4e2a\u7269\u7406\u5b9e\u4f53\u8bbe\u5907\uff0c\u4f46\u662f\u5176\u5b9e\u5b83\u4eec\u4e5f\u53ef\u4ee5\u4f4d\u4e8e\u4e0d\u540c\u7684\u8bbe\u5907\u4e2d\u3002</p> <p></p> <p>\u56fe 8\u20111\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u62d3\u6251\u793a\u4f8b</p>"},{"location":"pcie/all/#841-producerconsumer-sequence-no-errors","title":"8.4.1     \u6b63\u786e\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b\uff08Producer/Consumer Sequence-No Errors\uff09","text":"<p>\u4e0b\u5217\u7684\u8ba8\u8bba\u8bf7\u53c2\u7167\u56fe 8\u20112\u3002\u8be5\u793a\u4f8b\u4e2d\u5047\u8bbe\u4ece\u4e00\u5f00\u59cbFlag\u548cStatus\u5143\u7d20\u5c31\u5df2\u7ecf\u6e05\u9664\u590d\u4f4d\u4e86\u3002\u8fd9\u4e24\u79cd\u4fe1\u53f7\u91cf\u5728\u672c\u4f8b\u4e2d\u90fd\u4f4d\u4e8e\u540c\u4e00\u4e2a\u8bbe\u5907\u4e2d\u3002\u4e0b\u9762\u7684\u63cf\u8ff0\u4e2d\u5e26\u6709\u5e8f\u53f7\u7684\u4e8b\u4ef6\u6d41\u7a0b\uff0c\u4ee5\u53ca\u56fe 8\u20112\u6240\u793a\u7684\u6d41\u7a0b\uff0c\u90fd\u53cd\u6620\u4e86\u6b63\u786e\u6392\u5e8f\u89c4\u5219\u6d41\u7a0b\u7684\u7b2c\u4e00\u90e8\u5206\u3002</p> <p>\\1.    \u5728\u793a\u4f8b\u4e2d\uff0c\u4e00\u4e2a\u88ab\u79f0\u4e3a**Producer****\uff08\u751f\u4ea7\u8005\uff09\u7684\u8bbe\u5907\u5c06\u4f1a\u6267\u884c\u4e00\u4e2a\u6216\u591a\u4e2aMwr\u4e8b\u52a1\uff08Memory Write\uff0cPosted\u8bf7\u6c42\uff09\uff0c\u8981\u5199\u5165\u7684\u4f4d\u7f6e\u4e3a\u5185\u5b58\uff08Memory\uff09\u4e2d\u7684\u4e00\u4e2a**\u6570\u636e****Buffer\u3002\u5728\u6570\u636e\u6d41\u901a\u8fc7Posted Buffer\u65f6\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e00\u4e9b\u65f6\u95f4\u5ef6\u8fdf\u3002</p> <p>\\2.    Consumer\uff08\u6d88\u8d39\u8005\uff09\u4f1a\u5468\u671f\u6027\u7684\u901a\u8fc7\u53d1\u8d77MRd\u4e8b\u52a1\uff08Memory Read\uff0cNon-Posted\u8bf7\u6c42\uff09\u6765\u68c0\u67e5Flag\u4fe1\u53f7\u91cf\uff0c\u4ee5\u6b64\u6765\u786e\u5b9a\u6570\u636e\u662f\u5426\u5df2\u7ecf\u88abProducer\u53d1\u51fa\u3002</p> <p>\\3.    Flag\u4fe1\u53f7\u91cf\u88abConsumer\u8bbe\u5907\u8bfb\u53d6\uff0c\u5e76\u4ee5MRd Completion\u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9Consumer\uff0c\u7528\u4e8e\u544a\u77e5Consumer\u6570\u636e\u8fd8\u6ca1\u6709\u88abProducer\u53d1\u9001\u51fa\uff08\u56e0\u4e3a\u6b64\u65f6Flag=0\uff09\u3002</p> <p>\\4.    Producer\u901a\u8fc7\u53d1\u9001\u4e00\u4e2aMWr\uff08Posted\u8bf7\u6c42\uff09\u6765\u5c06Flag\u7684\u503c\u66f4\u65b0\u4e3a1.</p> <p>\\5.    \u53c8\u4e00\u6b21\u5730\uff0cConsumer\u53d1\u8d77\u6b65\u9aa42\u4e2d\u76f8\u540c\u7684\u4e8b\u52a1\uff08MRd\uff0cNon-Posted\uff09\u6765\u8bfb\u53d6Flag\u7684\u503c\u3002</p> <p>\\6.    \u8fd9\u4e00\u6b21\uff0cConsumer\u8bfb\u53d6\u5230\u7684Flag\u7684\u503c\u4e3a1\uff0c\u8fd9\u4e5f\u5c31\u662f\u8bf4Consumer\u901a\u8fc7\u8fd9\u6b21MRd Completion\u5f97\u77e5\u4e86\u6240\u6709\u7684\u6570\u636e\u90fd\u5df2\u7ecf\u88abProducer\u53d1\u5f80\u5185\u5b58\uff08Memory\uff09\u4e86\u3002</p> <p>\\7.    \u7136\u540e\uff0cConsumer\u53d1\u8d77\u4e00\u4e2aMWr\u4e8b\u52a1\uff08Posted\u8bf7\u6c42\uff09\u6765\u5c06Flag\u4fe1\u53f7\u91cf\u6e05\u9664\u4e3a0\u3002</p> <p>\u56fe 8\u20113\u7ee7\u7eed\u5c55\u793a\u4e86\u793a\u4f8b\u7684\u7b2c\u4e8c\u90e8\u5206\u6d41\u7a0b\u3002</p> <p>\\8.    Producer\uff08\u751f\u4ea7\u8005\uff09\u73b0\u5728\u6709\u66f4\u591a\u7684\u6570\u636e\u9700\u8981\u53d1\u9001\uff0c\u5b83\u901a\u8fc7\u53d1\u8d77MRd\u4e8b\u52a1\uff08Non-Posted\u8bf7\u6c42\uff09\u7684\u65b9\u5f0f\u5468\u671f\u6027\u7684\u68c0\u67e5Status\u4fe1\u53f7\u91cf\u3002</p> <p>\\9.    Status\u4fe1\u53f7\u91cf\u88abProducer\u8bbe\u5907\u8bfb\u53d6\uff0c\u5e76\u4ee5MRd Completion\u7684\u5f62\u5f0f\u8fd4\u56de\u7ed9Producer\uff0c\u7528\u4e8e\u544a\u77e5Consumer\u8fd8\u6ca1\u6709\u8bfb\u53d6\u5185\u5b58\u4e2d\u7684\u6570\u636eBuffer\u5e76\u4e14\u4e5f\u6ca1\u6709\u66f4\u65b0Status\u4fe1\u53f7\u91cf\uff0c\u56e0\u4e3aStatus=0\u3002</p> <p>\\10.  \u5bf9\u4e8eConsumer\uff0c\u5b83\u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86\u5185\u5b58Buffer\u4e2d\u6709\u53ef\u7528\u6570\u636e\uff0c\u6240\u4ee5\u5b83\u4f1a\u53d1\u8d77\u4e00\u4e2a\u6216\u591a\u4e2aMRd\uff08Non-Posted\u8bf7\u6c42\uff09\u6765\u4eceBuffer\u4e2d\u83b7\u53d6\u8fd9\u4e9b\u6570\u636e\u3002</p> <p>\\11.  \u5185\u5b58Buffer\u7684\u5185\u5bb9\u88ab\u8bfb\u53d6\u5e76\u8fd4\u56de\u7ed9Consumer\u3002</p> <p>\\12.  \u5728\u5b8c\u6210\u4e86\u5185\u5b58\u5230Consumer\u7684\u6570\u636e\u4f20\u8f93\u540e\uff0cConsumer\u53d1\u8d77\u4e00\u4e2aMWr\uff08Posted\u8bf7\u6c42\uff09\u5c06Status\u4fe1\u53f7\u91cf\u7f6e\u4e3a1\u3002</p> <p>\\13.  \u53c8\u4e00\u6b21\u5730\uff0cProducer\u901a\u8fc7\u53d1\u8d77MRd\uff08Non-Posted\u8bf7\u6c42\uff09\u6765\u68c0\u67e5Status\u4fe1\u53f7\u91cf\u3002</p> <p>\\14.  Producer\u8bbe\u5907\u8bfb\u53d6Status\uff0c\u800c\u6b64\u65f6Status=1\u3002MRd Completion\u8fd4\u56de\u7ed9Producer\uff0c\u4ece\u800cProducer\u4e5f\u5c31\u77e5\u9053\u4e86\u5185\u5b58Buffer\u4e2d\u7684\u6570\u636e\u5df2\u7ecf\u88abConsumer\u8bfb\u51fa\uff0c\u90a3\u4e48Producer\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5411\u5185\u5b58Buffer\u53d1\u9001\u6570\u636e\u4e86\u3002</p> <p>\\15.  Producer\u901a\u8fc7\u53d1\u8d77MWr\u6765\u5c06Status\u4fe1\u53f7\u91cf\u6e05\u9664\u4e3a0\u3002</p> <p>\\16.  Producer\u91cd\u590d\u4ee5\u4e0a\u6309\u987a\u5e8f\u4ece\u6b65\u9aa41\u5f00\u59cb\u7684\u4e00\u7cfb\u5217\u4e8b\u4ef6\u3002</p> <p></p> <p>\u56fe 8\u20112\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b\u793a\u4f8b\u2014\u2014\u7b2c\u4e00\u90e8\u5206</p> <p>\u200b                </p> <p></p> <p>\u56fe 8\u20113\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b\u793a\u4f8b\u2014\u2014\u7b2c\u4e8c\u90e8\u5206</p>"},{"location":"pcie/all/#842-producerconsumer-sequence-errors","title":"8.4.2     \u51fa\u9519\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6392\u5e8f\uff08Producer/Consumer Sequence-Errors\uff09","text":"<p>\u524d\u9762\u7684\u4f8b\u5b50\u5728\u6ca1\u6709\u8ba8\u8bba\u6392\u5e8f\u89c4\u5219\u7684\u60c5\u51b5\u4e0b\u6b63\u786e\u7684\u6267\u884c\u4e86Producer/Consumer\u6a21\u578b\uff0c\u4f46\u662f\u5b83\u6709\u53ef\u80fd\u4f1a\u53d7\u5230\u7ade\u4e89\u60c5\u51b5\u7684\u5f71\u54cd\u800c\u5bfc\u81f4Producer/Consumer\u6a21\u578b\u6267\u884c\u6d41\u7a0b\u5931\u8d25\u3002\u56fe 8\u20114\u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u6d41\u7a0b\u7528\u4e8e\u6f14\u793a\u5728\u6ca1\u6709\u6267\u884c\u6392\u5e8f\u89c4\u5219\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u51fa\u73b0\u7684\u591a\u79cd\u95ee\u9898\u4e2d\u7684\u4e00\u79cd\u3002\u5728\u8fdb\u884c\u4e0b\u5217\u8ba8\u8bba\u65f6\u8bf7\u53c2\u7167\u56fe 8\u20114\u3002</p> <p>\\1.    Producer\u5411\u5185\u5b58Buffer\u53d1\u8d77MWr\u4e8b\u52a1\uff08Posted\u8bf7\u6c42\uff09\u3002\u6211\u4eec\u5047\u8bbe\u8981\u5199\u5165\u7684\u6570\u636e\u88ab\u6682\u65f6\u5730\u963b\u585e\u5728\u4e86Switch\u4e0a\u884c\u7aef\u53e3\u7684Posted\u6d41\u63a7Buffer\u4e2d\u3002</p> <p>\\2.    Producer\u53d1\u9001\u4e00\u4e2aMWr\u4e8b\u52a1\uff08Posted\u8bf7\u6c42\uff09\u6765\u5c06Flag\u66f4\u65b0\u4e3a1\u3002</p> <p>\\3.    Consumer\u53d1\u8d77MRd\u8bf7\u6c42\uff08Non-Posted\u8bf7\u6c42\uff09\u6765\u68c0\u67e5Flag\u662f\u5426\u88ab\u7f6e\u4e3a1\u3002</p> <p>\\4.    Flag\u7684\u503c\u901a\u8fc7\u4e00\u4e2aCompletion\u8fd4\u56de\u7ed9Consumer\u3002</p> <p>\\5.    \u7531\u4e8eFlag=1\uff0cConsumer\u8ba4\u4e3a\u6570\u636e\u5df2\u7ecf\u4eceProducer\u53d1\u9001\u7ed9\u5185\u5b58Buffer\u4e86\uff0c\u56e0\u6b64\u5b83\u5c31\u53d1\u8d77MRd\u8bf7\u6c42\u6765\u83b7\u53d6\u5185\u5b58Buffer\u4e2d\u7684\u6570\u636e\u3002\u7136\u800cConsumer\u5e76\u4e0d\u77e5\u9053\uff0c\u7531\u4e8eSwitch\u4e0a\u884c\u7aef\u53e3\u548cRC\u4e4b\u95f4\u94fe\u8def\u7684\u6d41\u63a7Credit\u4e0d\u8db3\uff0c\u5bfc\u81f4\u6570\u636e\u88ab\u6682\u65f6\u5730\u963b\u585e\u5728Switch\u4e0a\u884c\u7aef\u53e3\u7684Posted\u6d41\u63a7Buffer\u4e2d\u3002\u7ed3\u679c\uff0cConsumer\u4ece\u8fd4\u56de\u7684MRd Completion\u4e2d\u6240\u83b7\u53d6\u5230\u7684\u6570\u636e\u662f\u5185\u5b58Buffer\u4e2d\u539f\u6709\u7684\u65e7\u6570\u636e\u800c\u4e0d\u662fProducer\u6b64\u6b21\u53d1\u51fa\u7684\u65b0\u6570\u636e\u3002</p> <p>\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u62d3\u6251\u7ed3\u6784\u4e2d\u7684Virtual PCI Bridge\u6240\u652f\u6301\u7684\u6392\u5e8f\u89c4\u5219\u6765\u907f\u514d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u5f53Consumer\u5728\u6267\u884c\u6b65\u9aa43\u30014\u7684MRd\u4e8b\u52a1\u65f6\uff0cSwitch\u4e0a\u884c\u7aef\u53e3\u7684Virtual PCI Bridge\u4e0d\u80fd\u8ba9\u542b\u6709Flag\u503c\u7684Completion\u8d85\u524d\u4e8e\u6b64\u524d\u7684Posted MWr\u7684\u6570\u636e\u88ab\u8f6c\u53d1\uff08\u8fd9\u4e2aCompletion\u548cMWr\u4e8b\u52a1\u90fd\u8981\u7ecf\u8fc7Switch\u7684\u4e0a\u884c\u7aef\u53e3\u8f6c\u53d1\uff09\u3002\u8fd9\u79cd\u60c5\u51b5\u5c31\u662f\u8868 8\u20111\u4e2d\u7684D2a\u3002</p> <p></p> <p>\u56fe 8\u20114\u51fa\u9519\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6d41\u7a0b</p>"},{"location":"pcie/all/#85-relaxed-ordering","title":"8.5 \u5bbd\u677e\u6392\u5e8f\uff08Relaxed Ordering\uff09","text":"<p>PCIe\u4e2d\u652f\u6301PCI-X\u5f15\u5165\u7684\u5bbd\u677e\u6392\u5e8f\u673a\u5236\uff08Relaxed Ordering\uff0cRO\uff09\u3002RO\u673a\u5236\u5141\u8bb8Requester\u548cCompleter\u4e4b\u95f4\u8def\u5f84\u4e0a\u7684Switch\u5bf9\u4e00\u4e9b\u4e8b\u52a1\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u6027\u80fd\u3002</p> <p>\u7528\u6765\u652f\u6301Producer/Consumer\u6a21\u578b\u7684\u6392\u5e8f\u89c4\u5219\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u88ab\u963b\u585e\uff0c\u5373\u4f7f\u8fd9\u4e9b\u88ab\u963b\u585e\u7684\u4e8b\u52a1\u4e0eProducer/Consumer\u6a21\u578b\u7684\u5de5\u4f5c\u6d41\u7a0b\u6beb\u65e0\u5173\u7cfb\u3002\u4e3a\u4e86\u51cf\u5c11\u8fd9\u79cd\u95ee\u9898\uff0c\u53ef\u4ee5\u5c06\u4e00\u4e2a\u4e8b\u52a1\u7684RO\u5c5e\u6027\u4f4d\u7f6e\u4e3a1\uff0c\u8fd9\u8868\u793a\u8f6f\u4ef6\u786e\u5b9a\u8fd9\u4e2a\u4e8b\u52a1\u4e0e\u5176\u4ed6\u4e8b\u52a1\u6ca1\u6709\u4efb\u4f55\u5173\u8054\uff0c\u5141\u8bb8\u5b83\u91cd\u65b0\u6392\u5e8f\u5728\u5176\u4ed6\u4e8b\u7269\u4e4b\u524d\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2aPosted\u7684\u5199\u4e8b\u52a1\u56e0\u4e3a\u76ee\u7684Buffer\u7a7a\u95f4\u4e0d\u8db3\u800c\u88ab\u5ef6\u8fdf\u963b\u585e\uff0c\u90a3\u4e48\u5fc5\u987b\u8981\u7b49\u5230\u8fd9\u4e2a\u5199\u4e8b\u52a1\u7684\u963b\u585e\u95ee\u9898\u89e3\u51b3\u5e76\u4e14\u5199\u4e8b\u52a1\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u624d\u80fd\u53d1\u9001\u540e\u7eed\u7684\u4efb\u4f55\u4e8b\u52a1\u3002\u5982\u679c\u5728\u540e\u7eed\u5230\u6765\u7684\u4e8b\u52a1\u4e2d\uff0c\u6709\u4e00\u4e2a\u4e8b\u52a1\u662f\u8f6f\u4ef6\u786e\u5b9a\u5b83\u4e0e\u5176\u4ed6\u6b64\u524d\u7684\u4e8b\u52a1\u6ca1\u6709\u5173\u8054\uff0c\u4e14\u5b83\u7684RO bit\u4e5f\u88ab\u7f6e\u4e3a1\u4ee5\u6b64\u6765\u8868\u793a\u8fd9\u79cd\u65e0\u5173\u8054\u6027\uff0c\u90a3\u4e48\u5728Posted\u5199\u8bf7\u6c42\u89e3\u51b3\u963b\u585e\u95ee\u9898\u4e4b\u524d\u5c31\u53ef\u4ee5\u53d1\u9001\u8fd9\u4e2a\u4e8b\u52a1\uff0c\u800c\u4e0d\u7528\u8ba9\u5b83\u4e5f\u7b49\u5f85\u5199\u8bf7\u6c42\uff0c\u4e14\u8fd9\u6837\u505a\u5e76\u4e0d\u4f1a\u5f15\u53d1\u4efb\u4f55\u95ee\u9898\u3002</p> <p>\u5f53\u8bbe\u5907\u9a71\u52a8\u652f\u6301\u5e76\u542f\u7528RO bit\uff08\u5982\u56fe 8\u20115\u6240\u793a\uff0c\u5b83\u5728TLP Header\u4e2dDW0\u7684Byte2\u4e2d\u7684Bit5\uff09\uff0c\u8bbe\u5907\u624d\u6709\u53ef\u80fd\u4f1a\u4f7f\u7528\u5b83\u3002\u7136\u540e\uff0c\u5f53\u8f6f\u4ef6\u8bf7\u6c42\u53d1\u9001\u4e00\u4e2a\u6570\u636e\u5305\u65f6\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5305\u8981\u6839\u636e\u8f6f\u4ef6\u7684\u6307\u793a\u6765\u4f7f\u7528RO\u8fd9\u4e2a\u5c5e\u6027\u4f4d\u3002\u5f53Switch\u6216\u8005RC\u53d1\u73b0\u4e00\u4e2a\u6570\u636e\u5305\u7684RO bit\u662f\u7f6e\u4e3a1\u7684\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u91cd\u6392\u5e8f\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u5f3a\u5236\u8981\u6c42\u5b83\u4eec\u4e00\u5b9a\u8981\u8fd9\u6837\u505a\u3002</p> <p></p> <p>\u56fe 8\u20115\u5bbd\u677e\u6392\u5e8f\u6807\u5fd7\u4f4d\u572832bit Header\u4e2d\u7684\u4f4d\u7f6e</p>"},{"location":"pcie/all/#851-romwrmessagero-effects-on-mwr-and-message","title":"8.5.1     RO\u5bf9MWr\u548cMessage\u7684\u5f71\u54cd\uff08RO Effects on MWr and Message\uff09","text":"<p>Switch\u548cRC\u5fc5\u987b\u89c2\u5bdf\u4e8b\u52a1\u7684RO\u5c5e\u6027\u4f4d\u7684\u503c\u3002MWr\u548cMessage\u90fd\u662fPosted\u5199\u4e8b\u52a1\uff0c\u90fd\u7531\u540c\u4e00\u4e2aPosted Buffer\u6765\u63a5\u6536\uff0c\u4e5f\u90fd\u9075\u4ece\u540c\u4e00\u4e2a\u6392\u5e8f\u8981\u6c42\u3002\u5f53RO bit\u4e3a1\u65f6\uff0cSwitch\u5904\u7406\u8fd9\u4e9b\u4e8b\u52a1\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a</p> <p>n \u5141\u8bb8Switch\u5bf9\u521a\u4e0b\u53d1\u7684MWr\u4e8b\u52a1\uff08RO bit=1\uff09\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff0c\u4f7f\u5176\u53ef\u4ee5\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684Posted MWr\u6216\u662fMessage\u4e8b\u52a1\u4e4b\u524d\u3002\u7c7b\u4f3c\u5730\uff0c\u521a\u4e0b\u53d1\u7684Message\u4e8b\u52a1\uff08RO bit=1\uff09\u4e5f\u53ef\u4ee5\u53ef\u4ee5\u91cd\u65b0\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684Posted MWr\u6216\u662fMessage\u4e8b\u52a1\u4e4b\u524d\u3002Switch\u5728\u8f6c\u53d1\u4e8b\u52a1\u65f6\u4e5f\u5fc5\u987b\u4fdd\u6301RO bit\u4e0d\u6539\u53d8\u3002PCI-X Bridge\u4f1a\u5ffd\u7565RO bit\uff0c\u5b83\u603b\u662f\u6309\u7167\u539f\u987a\u5e8f\u8f6c\u53d1\u5199\u4e8b\u52a1\uff08PCI-X\u4e2d\u8ba9\u5199\u4e8b\u52a1\u6539\u53d8\u987a\u5e8f\u5e76\u6ca1\u6709\u592a\u5927\u4f5c\u7528\uff0c\u5982\u679c\u4e00\u4e2a\u5199\u4e8b\u52a1\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u88ab\u963b\u585e\u4e86\uff0c\u90a3\u4e48\u5373\u4f7f\u66f4\u6539\u4e86\u987a\u5e8f\uff0c\u88ab\u63d0\u524d\u7684\u90a3\u4e00\u4e2a\u5199\u4e8b\u52a1\u4e5f\u8fd8\u662f\u4f1a\u88ab\u963b\u585e\uff09\u3002\u53e6\u4e00\u4e2a\u4e0d\u540c\u5c31\u662fPCI-X\u4e2d\u5e76\u6ca1\u6709\u5b9a\u4e49Message\u4e8b\u52a1\u3002</p> <p>n \u5141\u8bb8RC\u5bf9Posted\u5199\u4e8b\u52a1\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff08PCI-X\u4e2d\u8fd9\u4e5f\u4f1a\u8d77\u5230\u4f5c\u7528\uff0c\u56e0\u4e3aRC\u53ef\u4ee5\u5411\u4e0d\u540c\u533a\u57df\u7684\u5185\u5b58\u8fdb\u884c\u5199\u5165\uff0c\u56e0\u6b64\u5373\u4f7f\u4e00\u4e2a\u533a\u57df\u6b63\u5fd9RC\u4e5f\u53ef\u4ee5\u5199\u5165\u53e6\u4e00\u4e2a\u4e0d\u540c\u7684\u5185\u5b58\u533a\u57df\uff09\u3002\u540c\u6837\u5730\uff0c\u5f53RC\u63a5\u6536\u5230\u7684\u5199\u4e8b\u52a1RO bit=1\u65f6\uff0c\u5b83\u53ef\u4ee5\u6309\u7167\u4efb\u4f55\u5730\u5740\u987a\u5e8f\u6765\u5199\u5165\u6bcf\u4e00\u4e2aByte\u3002</p>"},{"location":"pcie/all/#852-romrdro-effects-on-mrd-transactions","title":"8.5.2     RO\u5bf9MRd\u4e8b\u52a1\u7684\u5f71\u54cd\uff08RO Effects on MRd Transactions\uff09","text":"<p>PCIe\u4e2d\u6240\u6709\u7684\u8bfb\u4e8b\u52a1\u90fd\u91c7\u7528\u62c6\u5206\u4e8b\u52a1\uff08Split Transaction\uff09\u7684\u65b9\u5f0f\u6765\u5904\u7406\u3002\u5f53\u4e00\u4e2a\u8bbe\u5907\u53d1\u51fa\u4e00\u4e2aRO bit=1\u7684MRd\u8bf7\u6c42\uff0cCompleter\u5c06\u4f1a\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u4e00\u4e2a\u6216\u591a\u4e2aSplit Completion\u4e8b\u52a1\uff08\u62c6\u5206\u5b8c\u6210\u5305\uff09\u6765\u8fd4\u56deRequester\u8bbe\u5907\u6240\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u4e14\u5728\u5b8c\u6210\u5305\u4e2d\u4f7f\u7528\u548c\u5f53\u521d\u8bf7\u6c42\u5305\u76f8\u540c\u7684RO bit\u503c\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0bSwitch\u7684\u5de5\u4f5c\u884c\u4e3a\u5982\u4e0b\uff1a</p> <p>\\1.    \u5f53Switch\u63a5\u6536\u5230\u4e00\u4e2aRO bit=1\u7684MRd\u65f6\uff0c\u5b83\u4f1a\u5c06MRd\u8bf7\u6c42\u6309\u7167\u63a5\u6536\u65f6\u7684\u987a\u5e8f\u6765\u8fdb\u884c\u8f6c\u53d1\uff0c\u4e00\u5b9a\u4e0d\u80fd\u8ba9\u5176\u91cd\u65b0\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684MWr\u4e8b\u52a1\u4e4b\u524d\u3002\u8fd9\u4fdd\u8bc1\u4e86\u6240\u6709\u548c\u8bfb\u8bf7\u6c42\u540c\u65b9\u5411\u4f20\u8f93\u7684\u5199\u4e8b\u52a1\u90fd\u4f1a\u88ab\u63a8\u5230\u8bfb\u8bf7\u6c42\u4e4b\u524d\u3002\u8fd9\u662f\u4e4b\u524d\u7684Producer/Consumer\u4f8b\u5b50\u7684\u4e00\u90e8\u5206\uff0c\u8f6f\u4ef6\u53ef\u80fd\u8981\u4f9d\u8d56\u8fd9\u4e2a\u7c7b\u4f3c\u5237\u65b0\u7684\u4e3e\u52a8\u6765\u8fdb\u884c\u6b63\u786e\u7684\u64cd\u4f5c\u3002Switch\u4e00\u5b9a\u4e0d\u80fd\u66f4\u6539RO bit\u7684\u503c\u3002</p> <p>\\2.    \u5f53Completer\u63a5\u6536\u5230MRd\u8bf7\u6c42\uff0c\u5b83\u5c06\u6536\u96c6\u88ab\u8bf7\u6c42\u7684\u6570\u636e\uff0c\u7136\u540e\u4ee5\u4e00\u4e2a\u6216\u591a\u4e2aCompletion\u5b8c\u6210\u5305\u7684\u5f62\u5f0f\u8fdb\u884c\u53d1\u9001\uff0c\u8fd9\u4e9bCompletion\u90fd\u5177\u6709\u8ddf\u8bf7\u6c42\u5305\u4e2d\u76f8\u540c\u7684RO\u5c5e\u6027\u3002</p> <p>\\3.    Switch\u63a5\u6536\u5230RO bit=1\u7684Completion\u5b8c\u6210\u5305\u65f6\uff0c\u53ef\u4ee5\u5c06\u5b83\u4eec\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\uff0c\u5c06\u8fd9\u4e9bCompletion\u6392\u5728\u5148\u524d\u4e0b\u53d1\u7684\u4e0eCompletion\u540c\u65b9\u5411\u4f20\u8f93\u7684MWr\u4e4b\u524d\u3002\u5982\u679c\u5199\u4e8b\u52a1\u88ab\u963b\u585e\u4e86\uff08\u4f8b\u5982\u88ab\u6d41\u63a7\u963b\u585e\uff09\uff0c\u90a3\u4e48Completion\u5c31\u53ef\u4ee5\u88ab\u6392\u5728\u5199\u4e8b\u52a1\u4e4b\u524d\u53d1\u9001\uff0c\u4e0d\u7528\u7b49\u5f85\u5199\u4e8b\u52a1\u963b\u585e\u7ed3\u675f\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u5bbd\u677e\u6392\u5e8f\uff08RO\uff09keyi \u6539\u8fdb\u8bfb\u64cd\u4f5c\u6027\u80fd\u3002\u4e2d\u603b\u7ed3\u4e86Switch\u5141\u8bb8\u7684\u5bbd\u677e\u6392\u5e8f\u884c\u4e3a\u3002</p> <p></p> <p>\u8868 8\u20112\u5bbd\u677e\u6392\u5e8f\u4e2d\u53ef\u4ee5\u88ab\u91cd\u65b0\u6392\u5e8f\u7684\u4e8b\u52a1</p>"},{"location":"pcie/all/#86-weak-ordering","title":"8.6 \u5f31\u6392\u5e8f\uff08Weak Ordering\uff09","text":"<p>\u5f53\u4e25\u683c\u6267\u884c\u5f3a\u6392\u5e8f\u89c4\u5219\u65f6\u53ef\u80fd\u4f1a\u51fa\u73b0\u6682\u65f6\u7684\u4e8b\u52a1\u963b\u585e\u95ee\u9898\u3002\u5728\u4e0d\u8fdd\u53cdProducer/Consumer\u7f16\u7a0b\u6a21\u578b\u7684\u524d\u63d0\u4e0b\u53ef\u4ee5\u5bf9\u5f3a\u6392\u5e8f\u6a21\u578b\u8fdb\u884c\u4e00\u5b9a\u7684\u4fee\u6539\uff0c\u4f7f\u5176\u53ef\u4ee5\u6d88\u9664\u4e00\u4e9b\u963b\u585e\u4e8b\u52a1\u7684\u60c5\u51b5\uff0c\u4ee5\u6b64\u6765\u63d0\u5347\u94fe\u8def\u6548\u7387\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b9e\u73b0\u5f31\u6392\u5e8f\u6a21\u578b\uff08Weakly-Ordered model\uff09\u662f\u53ef\u4ee5\u7f13\u89e3\u5f3a\u6392\u5e8f\u6a21\u578b\u4e2d\u963b\u585e\u4e8b\u52a1\u7684\u95ee\u9898\u7684\u3002</p>"},{"location":"pcie/all/#861-transaction-ordering-and-flow-control","title":"8.6.1     \u4e8b\u52a1\u7684\u6392\u5e8f\u4e0e\u6d41\u63a7\uff08Transaction Ordering and Flow Control\uff09","text":"<p>\u4e4b\u6240\u4ee5\u8981\u5c06\u7ed9\u5b9a\u6570\u91cf\u7684VC Buffer\u62c6\u5206\u6210\u6d41\u63a7\u5b50Buffer\uff08Posted\u3001Non-Posted\u548cCpl\uff09\uff0c\u662f\u56e0\u4e3a\u5c06TLP\u88ab\u89e3\u6790\u6216\u5f52\u5165\u5404\u81ea\u7684Buffer\u540e\u53ef\u4ee5\u7b80\u5316\u5bf9\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u7684\u5904\u7406\u8fc7\u7a0b\u3002\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\u5904\u7406\u903b\u8f91\u4e4b\u540e\u5c31\u53ea\u9700\u8981\u5728\u8fd9\u4e09\u4e2a\u5b50Buffer\u4e4b\u95f4\u6216\u662f\u6bcf\u4e2a\u5b50Buffer\u53bb\u5e94\u7528\u6392\u5e8f\u89c4\u5219\u5373\u53ef\u3002</p> <p>\u56e0\u4e3aTLP\u88ab\u5f52\u5165\u5404\u81ea\u7c7b\u522b\u7684\u4e09\u4e2a\u5b50Buffer\u6765\u5e94\u7528\u4e8b\u52a1\u6392\u5e8f\u89c4\u5219\uff0c\u90a3\u4e48\u5c31\u5fc5\u987b\u8981\u5b9a\u4e49\u94fe\u8def\u4e24\u7aef\u7aef\u53e3\u4e4b\u95f4\u6bcf\u79cdVC\u5b50Buffer\uff08P\u3001NP\u3001Cpl\uff09\u7684\u6d41\u63a7\u673a\u5236\u3002\u5b9e\u9645\u4e0a\uff0c\u4f60\u53ef\u80fd\u4f1a\u56de\u60f3\u8d77\u6765\u5bf9\u4e8e\u6bcf\u79cdVC\u5b50Buffer\u5927\u7c7b\uff08P\u3001NP\u3001Cpl\uff09\u6765\u8bf4\uff0c\u5b83\u4eec\u5404\u81ea\u7684\u66f4\u7b2c\u4e00\u5c42\u7ea7\u7684Header\uff08Hdr\uff09\u548cData\uff08D\uff09\u8fd9\u4e24\u79cd\u5b50Buffer\u4e4b\u95f4\u62e5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u6d41\u63a7\u673a\u5236\u3002</p>"},{"location":"pcie/all/#862-transaction-stalls","title":"8.6.2     \u4e8b\u52a1\u6682\u505c\uff08Transaction Stalls\uff09","text":"<p>\u5f3a\u6392\u5e8f\u89c4\u5219\u53ef\u80fd\u4f1a\u51fa\u73b0\u7531\u4e8e\u5355\u4e2a\u63a5\u6536Buffer\u6ee1\u800c\u963b\u585e\u6240\u6709\u4e8b\u52a1\u7684\u60c5\u51b5\u3002\u4f8b\u5982\uff0cProducer/Consumer\u6a21\u578b\u76f8\u5173\u4e8b\u52a1\u7684\u6392\u5e8f\u8981\u6c42\u4e0d\u80fd\u53d8\uff0c\u4f46\u662f\u4e0e\u6a21\u578b\u4e0d\u76f8\u5173\u7684\u4e8b\u52a1\u7684\u6392\u5e8f\u89c4\u5219\u662f\u53ef\u4ee5\u6539\u53d8\u7684\uff0c\u82e5\u90fd\u5b8c\u5168\u4f7f\u7528\u5f3a\u6392\u5e8f\u89c4\u5219\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u51fa\u73b0\u963b\u585e\u5176\u4ed6\u4e0d\u76f8\u5173\u4e8b\u52a1\u7684\u60c5\u51b5\u3002\u4e3a\u4e86\u6539\u5584\u6027\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e00\u79cd\u5f31\u6392\u5e8f\u65b9\u6848\uff0c\u8fd9\u662f\u4e00\u79cd\u5bf9\u4e8b\u52a1\u6392\u5e8f\u65bd\u52a0\u6700\u4f4e\u8981\u6c42\u7684\u65b9\u6848\u3002</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff08\u56fe 8\u20116\uff09\u5c55\u793a\u4e86\u5728\u4e00\u4e2aVC\u4e2d\u5355\u5411\u4f20\u8f93\u7684\u4e8b\u52a1\u76f8\u5173\u7684\u53d1\u9001\u548c\u63a5\u6536Buffer\u3002\u56de\u5fc6\u4e00\u4e0b\uff0c\u5728\u540c\u4e00VC\u4e2d\u6bcf\u79cd\u4e8b\u52a1\u7c7b\u578b\uff08P\u3001NP\u3001Cpl\uff09\u90fd\u6709\u72ec\u7acb\u7684\u6d41\u63a7\u673a\u5236\u3002\u53d1\u9001Buffer\u5185\u7684\u6570\u5b57\u8868\u793a\u8fd9\u4e9b\u4e8b\u52a1\u88ab\u5206\u914d\u7684\u53d1\u9001\u987a\u5e8f\uff0c\u5e76\u4e14\u6b64\u65f6Non-Posted\u63a5\u6536Buffer\u5df2\u7ecf\u6ee1\u4e86\u3002</p> <p></p> <p>\u56fe 8\u20116\u5f3a\u6392\u5e8f\u89c4\u5219\u5bfc\u81f4\u7684\u4e8b\u52a1\u4e34\u65f6\u6682\u505c</p> <p>\u8003\u8651\u4e0b\u9762\u7684\u6d41\u7a0b\uff1a</p> <p>\\1.    \u4e8b\u52a11\uff08MRd\uff09\u662f\u4e0b\u4e00\u4e2a\u8981\u88ab\u53d1\u9001\u7684\u4e8b\u52a1\uff0c\u4f46\u662f\u6b64\u65f6\u5e76\u6ca1\u6709\u8db3\u591f\u7684Non-Posted\u6d41\u63a7Credit\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u8981\u7b49\u5f85\u3002</p> <p>\\2.    \u4e8b\u52a12\uff08Posted MWr\uff09\u662f\u7d27\u8ddf\u4e8b\u52a11\u4e4b\u540e\u7684\u5f85\u53d1\u9001\u4e8b\u52a1\u3002\u5982\u679c\u6267\u884c\u7684\u662f\u5f3a\u6392\u5e8f\u89c4\u5219\uff0c\u90a3\u4e48\u8fd9\u4e2aMWr\u4e00\u5b9a\u4e0d\u80fd\u91cd\u6392\u5728\u4e8b\u52a11\u4e4b\u524d\u3002</p> <p>\\3.    \u8fd9\u79cd\u5f3a\u6392\u5e8f\u7684\u7ea6\u675f\u4e5f\u4f1a\u5e94\u7528\u5728\u540e\u9762\u7684\u6240\u6709\u4e8b\u52a1\u4e0a\uff0c\u6240\u4ee5\u5c31\u4f1a\u5bfc\u81f4\u4ed6\u4eec\u90fd\u6682\u505c\u4e86\u4e0b\u6765\uff0c\u8981\u7b49\u5f85\u4e8b\u52a11\u4f20\u8f93\u5b8c\u6210\u3002</p>"},{"location":"pcie/all/#863-vc-buffervc-buffers-offer-an-advantage","title":"8.6.3     VC Buffer\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4f18\u70b9\uff08VC Buffers Offer an Advantage\uff09","text":"<p>\u4e8b\u52a1\u7684\u987a\u5e8f\u662f\u5728VC Buffer\u5185\u8fdb\u884c\u7ba1\u7406\u7684\u3002\u8fd9\u4e9bBuffer\u88ab\u6309\u7167\u4e8b\u52a1\u7c7b\u578bPosted\u3001Non-Posted\u548cCompletion\u8fdb\u884c\u5206\u7c7b\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7c7b\u578b\u7684Buffer\u6765\u8bf4\uff0c\u5b83\u7684\u6d41\u63a7\u662f\u4e0e\u5176\u4ed6\u7c7b\u578b\u76f8\u72ec\u7acb\u7684\u3002\u8fd9\u4f7f\u5f97\u5f31\u6392\u5e8f\u89c4\u5219\u66f4\u52a0\u6709\u7528\uff0c\u6bd4\u5982\u5728\u6211\u4eec\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5373\u4f7f\u4e00\u4e2aBuffer\u6ee1\u4e86\uff0c\u4f46\u662f\u5176\u4ed6\u7684Buffer\u8fd8\u6709\u7a7a\u95f4\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728\u89c4\u5219\u5185\u8ba9\u5176\u4ed6\u4e8b\u52a1\u5148\u4f20\u8f93\u3002</p>"},{"location":"pcie/all/#87-idid-based-orderingido","title":"8.7 \u57fa\u4e8eID\u7684\u6392\u5e8f\uff08ID Based Ordering\uff0cIDO\uff09","text":"<p>\u53e6\u4e00\u79cd\u4f18\u5316\u6392\u5e8f\u5e76\u63d0\u5347\u6027\u80fd\u7684\u65b9\u6cd5\u4e0e\u6d41\u7684\u6027\u8d28\u6709\u5173\u3002\u6765\u81ea\u4e0d\u540cRequester\u7684\u6570\u636e\u5305\u901a\u5e38\u5e76\u6ca1\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u6bd5\u7adf\u4e00\u4e2a\u8bbe\u5907\u5f88\u96be\u6839\u636e\u4f20\u8f93\u987a\u5e8f\u5c31\u77e5\u9053\u53e6\u4e00\u4e2a\u8bbe\u5907\u5728\u4ec0\u4e48\u65f6\u5019\u5b8c\u6210\u4e86\u67d0\u4e9b\u6b65\u9aa4\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u80fd\u6709\u5404\u81ea\u4e0d\u540c\u7684\u8def\u5f84\u6765\u53bb\u5f80\u5b83\u4eec\u5171\u4eab\u7684\u8d44\u6e90\u3002\u8003\u8651\u5230\u8fd9\u4e00\u70b9\uff0cPCIe\u76842.1\u7248\u672c\u534f\u8bae\u89c4\u8303\u4e2d\u5f15\u5165\u4e86\u4e00\u79cd\u88ab\u79f0\u4e3a\u57fa\u4e8eID\u7684\u6392\u5e8f\u89c4\u5219\uff08ID-Based Ordering\uff09\u6765\u63d0\u5347\u6027\u80fd\u3002</p>"},{"location":"pcie/all/#871-the-solution","title":"8.7.1     \u89e3\u51b3\u65b9\u6848\uff08The Solution\uff09","text":"<p>\u5982\u679c\u6570\u636e\u5305\u7684\u6765\u6e90\u5e76\u6ca1\u6709\u8003\u8651\u4e8b\u52a1\u987a\u5e8f\uff0c\u90a3\u4e48\u6027\u80fd\u5c31\u4f1a\u53d7\u5230\u5f71\u54cd\uff0c\u5982\u56fe 8\u20117\u6240\u793a\u3002\u5728\u56fe\u4e2d\uff0c\u4e8b\u52a11\u4ece\u81ea\u5df1\u7684\u4e8b\u52a1\u6e90\u88ab\u4f20\u8f93\u5230Switch\u7684\u4e0a\u884c\u7aef\u53e3\uff0c\u4f46\u662f\u5728\u5b83\u60f3\u7ee7\u7eed\u4f20\u8f93\u81f3RC\u65f6\u5374\u88ab\u963b\u585e\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3aRC\u7aef\u53e3\u4e2d\u4e0e\u4e4b\u5bf9\u5e94\u7684Buffer\u6ee1\u4e86\uff08\u53ef\u4ee5\u901a\u8fc7\u6d41\u63a7Buffer\u4e0d\u8db3\u6765\u8868\u793a\u8fd9\u4e00\u70b9\uff09\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u534f\u8bae\u89c4\u8303\u4e2d\u7684\u672f\u8bed\uff0c\u6765\u81ea\u540c\u4e00\u4e2aRequester\u7684\u591a\u4e2a\u6570\u636e\u5305\u79f0\u4e3a\u4e00\u4e2aTLP\u6d41\uff08TLP Stream\uff09\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u4e8b\u52a11\u6240\u793a\u7684\u4f20\u8f93\u8def\u5f84\u53ef\u80fd\u4f1a\u8981\u4f20\u8f93TLP\u6d41\u4e2d\u7684\u4e00\u7cfb\u5217TLP\u3002\u4e8b\u52a12\u5bf9\u543c\u4e5f\u5230\u8fbe\u4e86\u540c\u4e00\u4e2a\u51fa\u53e3\u7aef\u53e3\uff08Switch\u7684\u4e0a\u884c\u7aef\u53e3\uff09\uff0c\u5e76\u4e14\u5b83\u4e5f\u88ab\u963b\u585e\u4e86\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4fdd\u6301\u4e0e\u4e8b\u52a11\u7684\u76f8\u5bf9\u987a\u5e8f\u3002\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u6570\u636e\u5305\u6765\u81ea\u4e0d\u540c\u7684\u4e8b\u52a1\u6e90\uff08\u5c5e\u4e8e\u4e0d\u540c\u7684TLP\u6d41\uff09\uff0c\u56e0\u6b64\u8fd9\u79cd\u5ef6\u8fdf\u7b49\u5f85\u57fa\u672c\u4e0a\u662f\u6ca1\u5fc5\u8981\u7684\uff0c\u5f88\u5927\u6982\u7387\u8fd9\u4e8c\u8005\u5e76\u6ca1\u6709\u76f8\u4e92\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f46\u662f\u5728\u4e00\u822c\u7684\u6392\u5e8f\u89c4\u5219\u4e2d\u5e76\u6ca1\u6709\u8fdb\u884c\u8fd9\u6837\u7684\u8003\u8651\u3002\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u4e0d\u540c\u7684\u89e3\u51b3\u65b9\u6cd5\u3002</p> <p>\u8fd9\u79cd\u89e3\u51b3\u529e\u6cd5\u5f88\u7b80\u5355\uff1a\u5982\u679c\u6570\u636e\u5305\u5404\u81ea\u7684Requester ID\u4e0d\u540c\uff08\u5bf9\u4e8eCompletion\u6765\u8bf4\u662fCompleter ID\uff09\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u5b83\u4eec\u8fdb\u884c\u91cd\u65b0\u6392\u5e8f\u3002\u8fd9\u79cd\u53ef\u9009\u80fd\u529b\u4f7f\u5f97\u8f6f\u4ef6\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u8bbe\u5907\u4f7f\u7528IDO\uff0c\u8fd9\u6837Switch\u7aef\u53e3\u5c31\u53ef\u4ee5\u8bc6\u522b\u51fa\u4e00\u4e9b\u6570\u636e\u5305\u5c5e\u4e8e\u4e0d\u540c\u7684TLP\u6d41\u3002\u8fd9\u662f\u901a\u8fc7\u7f6e\u4f4d\u8bbe\u5907\u63a7\u52362\u5bc4\u5b58\u5668\uff08Device Control 2 Register\uff09\u7684\u4f7f\u80fd\u4f4d\u6765\u5b9e\u73b0\u7684\u3002</p> <p></p> <p>\u56fe 8\u20117\u4e0d\u540c\u6570\u636e\u6e90\u4e4b\u95f4\u4e00\u822c\u6ca1\u6709\u76f8\u4e92\u4f9d\u8d56\u5173\u7cfb</p>"},{"location":"pcie/all/#872-idowhen-to-use-ido","title":"8.7.2     \u4f55\u65f6\u4f7f\u7528IDO\uff08When to use IDO\uff09","text":"<p>\u8f6f\u4ef6\u53ef\u4ee5\u8ba9\u6765\u81ea\u4e00\u4e2a\u7ed9\u5b9a\u7aef\u53e3\u7684\u8bf7\u6c42\u6216\u5b8c\u6210\u5305\u5e94\u7528IDO\uff0c\u8fd9\u662f\u901a\u8fc7\u8bbe\u7f6eDevice Control 2 Register\u4e2d\u76f8\u5e94\u7684\u4f4d\u6765\u5b9e\u73b0\u7684\u3002\u8ddfRO\u7684\u60c5\u51b5\u4e00\u6837\uff0c\u8bbe\u5907\u4e2d\u5e76\u6ca1\u6709\u80fd\u529b\u4f4d\uff08Capability bit\uff09\u6765\u544a\u8bc9\u8f6f\u4ef6\u8fd9\u4e2a\u8bbe\u5907\u652f\u6301\u4ec0\u4e48\uff0c\u800c\u662f\u53ea\u5b58\u5728\u4f7f\u80fd\u4f4d\uff0c\u56e0\u6b64\u8f6f\u4ef6\u9700\u8981\u901a\u8fc7\u5176\u4ed6\u7684\u4e00\u4e9b\u65b9\u6cd5\u6765\u77e5\u9053\u8fd9\u4e2a\u8bbe\u5907\u53ef\u4ee5\u652f\u6301IDO\uff08\u5426\u5219\u5373\u4f7f\u7f6e\u4f4d\u4e86\u4f7f\u80fd\u4f4d\uff0c\u4f46\u662f\u8bbe\u5907\u5e76\u4e0d\u652f\u6301IDO\uff0c\u90a3\u4e48\u4e5f\u65e0\u6cd5\u4f7f\u7528IDO\uff09\u3002\u8fd9\u4e9bbit\u4f7f\u5f97\u8fd9\u4e9b\u7c7b\u578b\u7684\u6570\u636e\u5305\u53ef\u4ee5\u4f7f\u7528IDO\uff0c\u4f46\u662f\u8f6f\u4ef6\u8fd8\u9700\u8981\u51b3\u5b9a\u662f\u5426\u6bcf\u4e2a\u5355\u72ec\u7684\u6570\u636e\u5305\u90fd\u8981\u5c06\u5b83\u7684IDO bit\u7f6e\u4f4d\u3002TLP Header\u4e2d\u7684\u4e00\u4e2a\u65b0\u7684\u5c5e\u6027\u4f4d\u53ef\u4ee5\u7528\u6765\u6307\u793a\u8fd9\u4e2aTLP\u662f\u5426\u4f7f\u7528IDO\uff0c\u5982\u56fe 8\u20118\u6240\u793a\u3002\u8005\u5e26\u6765\u4e86\u53e6\u4e00\u4e2a\u76f8\u5173\u7684\u70b9\uff1aCompletion\u4e00\u822c\u4f1a\u76f4\u63a5\u7ee7\u627f\u5bf9\u5e94\u8bf7\u6c42\u5305\u4e2d\u6240\u6709\u7684\u5c5e\u6027\u4f4d\uff0c\u4f46\u662f\u5bf9\u4e8eIDO\u6765\u8bf4\u53ef\u80fd\u5c31\u4e0d\u662f\u8fd9\u6837\u4e86\uff0c\u56e0\u4e3aCompleter\u53ef\u4ee5\u72ec\u7acb\u5730\u542f\u7528IDO\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5373\u4f7f\u8bf7\u6c42\u5305\u4e2d\u6ca1\u6709\u4f7f\u7528IDO\uff0c\u5bf9\u5e94\u7684Completion\u4e5f\u662f\u53ef\u4ee5\u4f7f\u7528IDO\u7684\u3002</p> <p></p> <p>\u56fe 8\u20118 64bit Header\u4e2d\u7684IDO\u5c5e\u6027\u4f4d</p>"},{"location":"pcie/all/#88-deadlock-avoidance","title":"8.8 \u6b7b\u9501\u7684\u907f\u514d\uff08Deadlock Avoidance\uff09","text":"<p>\u56e0\u4e3aPCI\u603b\u7ebf\u91c7\u7528\u5ef6\u8fdf\u4e8b\u52a1\uff0c\u4e5f\u56e0\u4e3aPCIe\u7684MRd\u8bf7\u6c42\u53ef\u80fd\u4f1a\u56e0\u4e3a\u7f3a\u5c11\u6d41\u63a7Credit\u800c\u88ab\u963b\u585e\uff0c\u5728\u8fd9\u4e9b\u539f\u56e0\u4e0b\u4ea7\u751f\u51fa\u4e86\u4e00\u7cfb\u5217\u7684\u4f1a\u51fa\u73b0\u6b7b\u9501\u7684\u573a\u666f\u3002\u8fd9\u4e9b\u907f\u514d\u6b7b\u9501\u7684\u89c4\u5219\u88ab\u5305\u542b\u5728\u4e86PCIe\u7684\u6392\u5e8f\u89c4\u5219\u4e2d\uff0c\u4ee5\u6b64\u6765\u786e\u4fdd\u4e0d\u7ba1\u62d3\u6251\u7ed3\u6784\u5982\u4f55\u90fd\u4e0d\u4f1a\u53d1\u751f\u6b7b\u9501\u3002\u9075\u5b88\u6392\u5e8f\u89c4\u5219\u53ef\u4ee5\u9632\u6b62\u7531\u4e8e\u51fa\u73b0\u4e86\u610f\u6599\u4e4b\u5916\u7684\u62d3\u6251\u7ed3\u6784\u800c\u4ea7\u751f\u8fb9\u754c\u6761\u4ef6\u65f6\u51fa\u73b0\u7684\u95ee\u9898\uff08\u4f8b\u5982\uff0c\u4e24\u4e2aPCIe-to-PCI Bridge\u8de8PCIe\u7f51\u7edc\u7ed3\u6784\u76f8\u8fde\uff09\u3002\u53c2\u8003MindShare\u7684\u540d\u4e3a\u300aPCI System Architecture\uff0cFourth Edition\u300b\u7684\u4e66\u7c4d\uff0c\u91cc\u9762\u6709\u5bf9\u5404\u79cd\u573a\u666f\u7684\u8be6\u7ec6\u89e3\u91ca\uff0c\u5b83\u4eec\u662fPCIe\u4e2d\u4e0e\u907f\u514d\u6b7b\u9501\u76f8\u5173\u7684\u6392\u5e8f\u89c4\u5219\u7684\u57fa\u7840\u3002\u8868 8\u20111\u4e2d\u5217\u51fa\u4e86\u7528\u6765\u907f\u514d\u6b7b\u9501\u7684\u6392\u5e8f\u89c4\u5219\uff0c\u5b83\u4eec\u4e3aA3\u3001A4\u3001D3\u3001D4\u548cA5b\u3002\u6ce8\u610f\uff0c\u8868\u4e2d\u8fd9\u4e94\u79cd\u4e3a\u201cYes\u201d\u7684\u6761\u76ee\u90fd\u662f\u7528\u6765\u907f\u514d\u6b7b\u9501\u7684\u3002\u5982\u679c\u8868\u4e2d\u52173\u62164\u76f8\u5173\u7684Non-Posted Buffer\u7531\u4e8e\u7f3a\u5c11\u6d41\u63a7Credit\u800c\u51fa\u73b0\u4e86\u963b\u585e\u73b0\u8c61\uff0c\u90a3\u4e48\u884cA\u76f8\u5173\u8054\u7684Posted\u8bf7\u6c42\u6216\u662f\u884cD\u76f8\u5173\u8054\u7684Completion\u5fc5\u987b\u8981\u79fb\u52a8\u5230Non-Posted\u8bf7\u6c42\u4e4b\u524d\uff0c\u4e0d\u96be\u53d1\u73b0\u5b83\u4eec\u5728\u8868\u4e2d\u7684\u9879\u90fd\u662f\u201cYes\u201d\u3002\u8fd8\u9700\u8981\u6ce8\u610f\uff0cA5b\u4e2d\u7684\u201cYes\u201d\u9879\u4ec5\u5f15\u7528\u4e8ePCIe-to-PCI/PCI-X Bridge\u4e2d\u3002</p> <p>\u672c\u8d28\u4e0a\u6765\u8bf4\uff0c\u8fd9\u4e9b\u7528\u6765\u907f\u514d\u6b7b\u9501\u7684\u89c4\u5219\u53ef\u4ee5\u88ab\u603b\u7ed3\u4e3a\u201c\u5fc5\u987b\u8981\u5141\u8bb8\u540e\u5230\u6765\u7684MWr\u8bf7\u6c42\u6216\u662fCompletion\u5728\u987a\u5e8f\u4e0a\u8d85\u8fc7\u5148\u524d\u5230\u6765\u7684\u4f46\u88ab\u963b\u585e\u7684Non-Posted\u8bf7\u6c42\uff0c\u5426\u5219\u5c31\u6709\u53ef\u80fd\u4f1a\u53d1\u751f\u6b7b\u9501\u3002\u201d</p>"},{"location":"software/atomic_instructions/","title":"\u539f\u5b50\u6307\u4ee4","text":"<p>\u73b0\u5728\u7684\u5904\u7406\u5668\uff0c\u4e00\u822c\u4f1a\u63d0\u4f9b\u5982\u4e0b\u51e0\u79cd\u5f62\u5f0f\u7684\u539f\u5b50\u6307\u4ee4\uff1a</p> <ol> <li>LL(Load-Linked)/SC(Store-Conditional)</li> <li>CAS(Compare And Swap)</li> <li>AMO(Atomic Memory Operation)</li> <li>HTM(Hardware Transactional Memory)</li> </ol> <p>\u5b83\u4eec\u5728\u8f6f\u4ef6\u7684\u4f7f\u7528\u65b9\u5f0f\u548c\u786c\u4ef6\u5b9e\u73b0\u4e0a\u6709\u6240\u533a\u522b\uff0c\u4e0b\u9762\u6765\u8ba8\u8bba\u8fd9\u4e9b\u539f\u5b50\u6307\u4ee4\u3002</p>"},{"location":"software/atomic_instructions/#_2","title":"\u80cc\u666f","text":"<p>\u9996\u5148\u8ba8\u8bba\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u9700\u8981\u6709\u539f\u5b50\u6307\u4ee4\u3002\u5047\u8bbe\u73b0\u5728\u6709\u4e00\u4e2a\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u5728\u591a\u6838\u5904\u7406\u5668\u4e0a\u8fd0\u884c\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u9700\u8981\u5bf9\u5185\u5b58\u4e2d\u540c\u4e00\u4e2a\u5730\u5740\u7684\u6570\u636e\u8fdb\u884c\u52a0\u4e00\u7684\u64cd\u4f5c\u3002\u5728\u5904\u7406\u5668\u4e2d\uff0c\u52a0\u4e00\u7684\u64cd\u4f5c\u5b9e\u9645\u4e0a\u5206\u4e3a\u4e09\u6b65\uff1a</p> <ol> <li>\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u5f53\u524d\u7684\u503c</li> <li>\u6c42\u503c\u52a0\u4e00\u7684\u7ed3\u679c</li> <li>\u628a\u52a0\u4e00\u7684\u7ed3\u679c\u5199\u5165\u5230\u5185\u5b58\u4e2d</li> </ol> <p>\u4f46\u662f\u8fd9\u4e09\u4e2a\u64cd\u4f5c\u662f\u5206\u522b\u8fdb\u884c\u7684\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8fd9\u4e48\u4e00\u79cd\u60c5\u51b5\uff1a</p> <ol> <li>\u7ebf\u7a0b\u4e00\u8bfb\u53d6\u5185\u5b58\u4e2d\u7684\u503c\u7b49\u4e8e 0</li> <li>\u7ebf\u7a0b\u4e8c\u8bfb\u53d6\u5185\u5b58\u4e2d\u7684\u503c\u7b49\u4e8e 0</li> <li>\u7ebf\u7a0b\u4e00\u8ba1\u7b97 0 \u52a0 1 \u7b49\u4e8e 1</li> <li>\u7ebf\u7a0b\u4e8c\u8ba1\u7b97 0 \u52a0 1 \u7b49\u4e8e 1</li> <li>\u7ebf\u7a0b\u4e00\u628a 1 \u5199\u5165\u5185\u5b58</li> <li>\u7ebf\u7a0b\u4e8c\u628a 1 \u5199\u5165\u5185\u5b58</li> </ol> <p>\u4e8e\u662f\u52a0\u6cd5\u7684\u7ed3\u679c\u5c31\u88ab\u4e22\u5f03\u4e86\u3002\u4e0b\u9762\u7528 OpenMP \u7ed9\u51fa\u4e86\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\nint count = 0;\nint main() {\n#pragma omp parallel for\n  for (int i = 0; i &lt; 100000; i++) {\n    count++;\n  }\n\n  printf(\"%d\\n\", count);\n  return 0;\n}\n</code></pre> <p>\u5982\u679c\u7528\u591a\u6838\u6267\u884c\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u4f1a\u662f\u4e00\u4e2a\u8fdc\u5c0f\u4e8e 100000 \u7684\u7ed3\u679c\u3002\u5982\u679c\u628a\u7a0b\u5e8f\u7ed1\u5b9a\u5230\u4e00\u4e2a\u6838\u5fc3\u4e0a\uff08<code>numactl -C 0</code>\uff09\uff0c\u5c31\u4f1a\u5f97\u5230\u6b63\u786e\u7684 100000 \u7684\u7ed3\u679c\u3002\u56e0\u6b64\u9700\u8981\u7528\u539f\u5b50\u6307\u4ee4\u6765\u4fdd\u8bc1\u66f4\u65b0\u7684\u539f\u5b50\u6027\u3002</p> <p>\u5728\u8ba8\u8bba\u539f\u5b50\u6307\u4ee4\u7684\u786c\u4ef6\u5b9e\u73b0\u65f6\uff0c\u4f1a\u6d89\u53ca\u5230\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u7684\u5185\u5bb9\u3002\u5982\u679c\u5bf9\u8fd9\u65b9\u9762\u8fd8\u7f3a\u4e4f\u4e86\u89e3\uff0c\u53ef\u4ee5\u53c2\u8003 \u7f13\u5b58\u4e00\u81f4\u6027 \u7684\u5185\u5bb9\u3002</p>"},{"location":"software/atomic_instructions/#llsc","title":"LL/SC","text":""},{"location":"software/atomic_instructions/#_3","title":"\u5b9a\u4e49","text":"<p>LL/SC \u662f\u4e00\u5bf9\u6307\u4ee4\uff0c\u5176\u4e2d LL \u6307\u4ee4\u4ece\u5185\u5b58\u5730\u5740 read_addr \u4e2d\u8bfb\u53d6\u6570\u636e\u5230\u5bc4\u5b58\u5668 read_data\uff1bSC \u6307\u4ee4\u6267\u884c\u65f6\uff0c\u5982\u679c\u8981\u5199\u5165\u7684\u5185\u5b58\u5730\u5740 write_addr \u548c\u4e4b\u524d\u7528 LL \u6307\u4ee4\u8bfb\u53d6\u7684\u5185\u5b58\u5730\u5740 read_addr \u76f8\u540c\uff0c\u5e76\u4e14\u5728 LL \u6307\u4ee4\u540e\uff0c\u88ab LL \u8bbf\u95ee\u7684\u5185\u5b58\u533a\u57df\uff08\u7c92\u5ea6\u53ef\u80fd\u662f 32 \u4f4d\uff0c\u4e5f\u53ef\u80fd\u66f4\u7c97\uff0c\u4f8b\u5982\u4e00\u4e2a\u7f13\u5b58\u884c\uff09\u6ca1\u6709\u88ab\u4fee\u6539\uff0c\u90a3\u4e48\u5199\u5165\u5bc4\u5b58\u5668 write_data \u7684\u503c\u5230\u540c\u6837\u7684\u5730\u5740 write_addr\uff1b\u5426\u5219\u5c31\u4e0d\u5199\u5165\u3002SC \u6307\u4ee4\u7684\u5199\u5165\u662f\u5426\u6210\u529f\uff0c\u4f1a\u901a\u8fc7\u5411\u76ee\u7684\u5bc4\u5b58\u5668 dest \u5199\u5165\u4e0d\u540c\u7684\u503c\u6765\u533a\u5206\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c SC \u5199\u5165\u6210\u529f\uff0c\u5c31\u4fdd\u8bc1\u4e86\u4ece LL \u5230 SC \u8fd9\u6bb5\u65f6\u95f4\u5185\uff0c\u8fd9\u6bb5\u5185\u5b58\u6ca1\u6709\u88ab\u6539\u53d8\u3002</p>"},{"location":"software/atomic_instructions/#_4","title":"\u5e38\u89c1\u7528\u6cd5","text":"<p>LL/SC \u7684\u901a\u5e38\u7528\u6cd5\u662f\uff0c\u5b9e\u73b0\u4e00\u4e2a\u8bfb - \u6539 - \u5199\uff08read-modify-write\uff09\u64cd\u4f5c\uff1a\u9996\u5148\u7528 LL \u6307\u4ee4\u8bfb\u53d6\u5185\u5b58\uff0c\u7136\u540e\u5bf9\u5bc4\u5b58\u5668\u8fdb\u884c\u8ba1\u7b97\uff0c\u518d\u7528 SC \u6307\u4ee4\u628a\u7ed3\u679c\u5199\u5165\u5185\u5b58\uff1a\u5982\u679c\u4e2d\u9014\u5185\u5b58\u7684\u503c\u88ab\u5176\u4ed6\u5904\u7406\u5668\u6838\u5fc3\u4fee\u6539\u4e86\uff0c\u90a3\u4e48\u7528 LL \u6307\u4ee4\u8bfb\u53d6\u7684\u7ed3\u679c\u662f\u65e7\u7684\uff0c\u7528\u7684\u4e5f\u662f\u65e7\u7684\u503c\u505a\u8ba1\u7b97\uff0c\u8ba1\u7b97\u7ed3\u679c\u5c31\u4e0d\u4f1a\u88ab SC \u5199\u8fdb\u53bb\uff1b\u5426\u5219\uff0c\u8bf4\u660e LL \u6307\u4ee4\u8bfb\u53d6\u7684\u503c\u548c\u5185\u5b58\u4e2d\u7684\u503c\u662f\u76f8\u540c\u7684\uff0cSC \u6307\u4ee4\u628a\u66f4\u65b0\u540e\u7684\u7ed3\u679c\u5199\u5165\u5230\u5185\u5b58\u4e2d\u3002</p> <p>\u56e0\u6b64 LL/SC \u5728\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u901a\u5e38\u4f1a\u548c\u5faa\u73af\u653e\u5728\u4e00\u8d77\u7528\uff1a\u5982\u679c SC \u5931\u8d25\uff0c\u5c31\u91cd\u65b0\u5f00\u59cb\u8bfb - \u6539 - \u5199\u64cd\u4f5c\uff0c\u76f4\u5230 SC \u6210\u529f\u3002\u7528 LL/SC \u5b9e\u73b0\u5bf9\u5185\u5b58\u8fdb\u884c\u539f\u5b50\u52a0\u4e00\u64cd\u4f5c\uff08Atomic Add One\uff09\u7684\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>loop:\n    # Read\n    ll data, addr\n    # Modify\n    add data, data, 1\n    # Write\n    sc result, data, addr\n    # Try again if SC failed\n    goto loop if failed\n</code></pre>"},{"location":"software/atomic_instructions/#_5","title":"\u6307\u4ee4\u96c6\u67b6\u6784\u652f\u6301","text":"<p>\u5728 RISC-V \u7684 A \u6269\u5c55\u4e2d\uff0cLL \u6307\u4ee4\u53eb\u505a LR\uff08Load-Reserved\uff09\uff0cSC \u6307\u4ee4\u8fd8\u662f\u53eb\u505a SC\u3002\u4e0b\u9762\u662f RISC-V \u6307\u4ee4\u96c6\u624b\u518c\u4e2d\u7ed9\u51fa\u7684\u4e00\u6bb5\u7528 LL/SC \u5b9e\u73b0\u539f\u5b50\u6bd4\u8f83\u548c\u5199\u5165\uff08Atomic Compare And Set\uff09\u64cd\u4f5c\u7684\u4ee3\u7801\uff1a</p> <pre><code>    # a0 holds address of memory location\n    # a1 holds expected value\n    # a2 holds desired value\n    # a0 holds return value, 0 if successful, !0 otherwise\ncas:\n    lr.w t0, (a0)        # Load original value.\n    bne t0, a1, fail     # Doesn't match, so fail.\n    sc.w t0, a2, (a0)    # Try to update.\n    bnez t0, cas         # Retry if store-conditional failed.\n    li a0, 0             # Set return to success.\n    jr ra                # Return.\nfail:\n    li a0, 1             # Set return to failure.\n    jr ra                # Return.\n</code></pre> <p>\u4ee3\u7801\u5229\u7528 LL/SC \u6307\u4ee4\uff0c\u628a a0 \u6307\u5411\u7684\u5185\u5b58\u7684\u503c\u548c a1 \u7684\u503c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5c31\u628a a2 \u5199\u5230 a0 \u6307\u5411\u7684\u5185\u5b58\uff0c\u8fd4\u56de\u6210\u529f\uff1b\u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u5219\u4e0d\u4fee\u6539\u5185\u5b58\u7684\u503c\uff0c\u8fd4\u56de\u9519\u8bef\u3002</p> <p>\u9664\u4e86\u5185\u5b58\u88ab\u5176\u4ed6\u5904\u7406\u5668\u6838\u5fc3\u5199\u5165\u4f1a\u5bfc\u81f4 SC \u5931\u8d25\u4ee5\u5916\uff0c\u4e00\u4e9b\u6307\u4ee4\u96c6\u67b6\u6784\u5141\u8bb8\u7a0b\u5e8f\u624b\u52a8\u8ba9 SC \u5931\u8d25\uff0c\u4ee5 LoongArch \u4e3a\u4f8b\uff0c\u6807\u51c6\u8981\u6c42\uff1a</p> <p>LL.{W/D} \u6267\u884c\u65f6\u8bb0\u5f55\u4e0b\u8bbf\u95ee\u5730\u5740\u5e76\u7f6e\u4e0a\u4e00\u4e2a\u6807\u8bb0\uff08LLbit \u7f6e\u4e3a 1\uff09\uff0cSC.{W/D} \u6307\u4ee4\u6267\u884c\u65f6\u4f1a\u67e5\u770b LLbit\uff0c\u4ec5\u5f53 LLbit \u4e3a 1 \u65f6\u624d\u771f\u6b63\u4ea7\u751f\u5199\u52a8\u4f5c\uff0c\u5426\u5219\u4e0d\u5199\u3002\u5728\u914d\u5bf9\u7684 LL-SC \u6267\u884c\u671f\u95f4\uff0c\u4e0b\u5217\u4e8b\u4ef6\u4f1a\u8ba9 LLbit \u6e05 0:</p> <ul> <li>\u6267\u884c\u4e86 ERTN \u6307\u4ee4\u4e14\u6267\u884c\u65f6 CSR.LLBCTL \u4e2d\u7684 KLO \u4f4d\u4e0d\u7b49\u4e8e 1;</li> <li>\u5176\u5b83\u5904\u7406\u5668\u6838\u6216 Cache Coherent master \u5bf9\u8be5 LLbit \u5bf9\u5e94\u7684\u5730\u5740\u6240\u5728\u7684 Cache \u884c\u6267\u884c\u5b8c\u6210\u4e86\u4e00\u4e2a store \u64cd\u4f5c\u3002</li> </ul> <p>\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\uff0c\u5982\u679c\u5728 LL \u548c SC \u4e4b\u95f4\u89e6\u53d1\u4e86\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u628a SC \u81ea\u52a8\u53d6\u6d88\u6389\uff0c\u8be6\u60c5\u53ef\u4ee5\u770b LoongArch \u7684 CSR.LLBCTL \u7684\u5b9a\u4e49\u3002</p> <p>\u5176\u4ed6\u5b9e\u73b0\u4e86 LL/SC \u7684\u6307\u4ee4\u96c6\u67b6\u6784\uff1a</p> <ul> <li>Alpha: ldl_l/stl_c, ldq_l/stq_c</li> <li>PowerPC/Power ISA: lwarx/stwcx, ldarx/stdcx</li> <li>MIPS: ll/sc, llwp/scwp(Double Width)</li> <li>ARM: ldrex/strex(ARMv6 &amp; ARMv7), ldxr/stxr(ARMv8)</li> <li>ARC: llock/scond</li> </ul> <p>\u5b9e\u9645\u5b9e\u73b0\u65f6\uff0c\u6839\u636e\u5904\u7406\u5668\u5b9e\u73b0\u4e0d\u540c\uff0c\u68c0\u6d4b\u5185\u5b58\u8bbf\u95ee\u7684\u7c92\u5ea6\u53ef\u80fd\u4e0d\u540c\u3002</p>"},{"location":"software/atomic_instructions/#_6","title":"\u786c\u4ef6\u5b9e\u73b0","text":"<p>\u5728\u5904\u7406\u5668\u4e2d\uff0cLL/SC \u7684\u5b9e\u73b0\u5e76\u4e0d\u590d\u6742\uff1a\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u4e0b\uff0c\u4fdd\u8bc1\u4e86\u5f53\u4e00\u4e2a\u7f13\u5b58\u884c\u88ab\u66f4\u65b0\u7684\u65f6\uff0c\u6240\u6709\u62e5\u6709\u8be5\u7f13\u5b58\u884c\u7684\u6838\u5fc3\u90fd\u4f1a\u88ab\u901a\u77e5\u5230\u3002\u56e0\u6b64\uff0cLL \u6307\u4ee4\u53ea\u9700\u8981\u5728\u8bfb\u53d6\u7f13\u5b58\u7684\u57fa\u7840\u4e0a\uff0c\u5728\u7f13\u5b58\u4e0a\u6253\u4e00\u4e2a\u6807\u8bb0\uff1b\u901a\u8fc7\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u5982\u679c\u53d1\u73b0\u6709\u5176\u4ed6\u6838\u5fc3\u8981\u5199\u5165 LL \u6307\u4ee4\u8bfb\u53d6\u7684\u7f13\u5b58\u884c\uff0c\u6216\u8005\u8be5\u7f13\u5b58\u884c\u8981\u88ab Evict\uff0c\u90a3\u5c31\u8bb0\u5f55\u4e00\u4e2a SC \u5931\u8d25\u6807\u8bb0\uff0c\u4f7f\u5f97\u4e0b\u4e00\u6b21 SC \u6307\u4ee4\u5931\u8d25\u3002\u5b9e\u73b0 SC \u6307\u4ee4\u65f6\uff0c\u9996\u5148\u68c0\u67e5\u5b83\u7684\u5730\u5740\u662f\u5426\u548c LL \u6307\u4ee4\u76f8\u540c\uff0c\u5982\u679c\u76f8\u540c\uff0c\u5e76\u4e14\u6ca1\u6709\u89e6\u53d1 SC \u5931\u8d25\u6807\u8bb0\uff0c\u90a3\u5c31\u8fdb\u884c\u5b9e\u9645\u7684\u5199\u5165\u3002\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>Init() {\n    LLvalid = 0;\n    LLaddr = 0;\n}\n\nLL(addr) {\n    data = memory[addr];\n    LLaddr = addr;\n    LLvalid = 1;\n    return data;\n}\n\nSC(addr, data) {\n    if (LLaddr == addr &amp;&amp; LLvalid) {\n        memory[addr] = data;\n        return SUCCESS;\n    } else {\n        return FAIL;\n    }\n}\n\nInvalidate(addr) {\n    if (addr == LLaddr) {\n        LLvalid = 0;\n    }\n}\n</code></pre>"},{"location":"software/atomic_instructions/#_7","title":"\u6d3b\u9501","text":"<p>LL/SC \u5728\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u6f5c\u5728\u7684\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u6d3b\u9501\uff1a\u5f53 LL \u548c SC \u4e4b\u95f4\u6267\u884c\u7684\u6307\u4ee4\u6bd4\u8f83\u591a\uff0c\u82b1\u8d39\u7684\u65f6\u95f4\u6bd4\u8f83\u957f\uff0c\u53ef\u80fd\u4f7f\u5f97 LL/SC \u4e00\u76f4\u88ab\u5176\u4ed6\u6838\u5fc3\u6253\u65ad\uff0c\u6ca1\u6709\u529e\u6cd5\u5b9e\u73b0\u8fdb\u5c55\u3002</p> <p>\u6b64\u5916\uff0c\u7f16\u5199 LL/SC \u7a0b\u5e8f\u7684\u65f6\u5019\u4e5f\u9700\u8981\u5c0f\u5fc3\uff0c\u907f\u514d\u5728\u4e2d\u95f4\u8fdb\u884c\u4e00\u4e9b\u6bd4\u8f83\u590d\u6742\u7684\u64cd\u4f5c\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u64cd\u4f5c\u53ef\u80fd\u5bfc\u81f4 SC \u7684\u65f6\u5019\u603b\u662f\u5931\u8d25\uff1a\u4f8b\u5982\u5728 LL/SC \u4e2d\u9014\u8bbf\u95ee\u5176\u4ed6\u5185\u5b58\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 SC \u8981\u5199\u5165\u7684\u7684\u7f13\u5b58\u884c\u88ab Evict\u3002</p> <p>\u56e0\u4e3a\u8fd9\u4e2a\u95ee\u9898\uff0cRISC-V \u5728\u6807\u51c6\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e9b\u6761\u4ef6\uff0c\u5982\u679c\u6ee1\u8db3\u4e86\u8fd9\u4e9b\u6761\u4ef6\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u6d3b\u9501\u7684\u53d1\u751f\uff1a</p> <ul> <li>The loop comprises only an LR/SC sequence and code to retry the sequence in the case of failure, and must comprise at most 16 instructions placed sequentially in memory.</li> <li>An LR/SC sequence begins with an LR instruction and ends with an SC instruction. The dynamic code executed between the LR and SC instructions can only contain instructions from the base \u201cI\u201d instruction set, excluding loads, stores, backward jumps, taken backward branches, JALR, FENCE, and SYSTEM instructions. If the \u201cC\u201d extension is supported, then compressed forms of the aforementioned \u201cI\u201d instructions are also permitted.</li> <li>The code to retry a failing LR/SC sequence can contain backwards jumps and/or branches to repeat the LR/SC sequence, but otherwise has the same constraint as the code between the LR and SC.</li> <li>The LR and SC addresses must lie within a memory region with the LR/SC eventuality property. The execution environment is responsible for communicating which regions have this property.</li> <li>The SC must be to the same effective address and of the same data size as the latest LR executed by the same hart.</li> </ul> <p>\u56e0\u4e3a LL/SC \u7684\u5c40\u9650\u6027\uff0c\u73b0\u5728\u5f88\u591a\u7b97\u6cd5\u4f1a\u7528\u4e0b\u9762\u8bb2\u5230\u7684 CAS \u6216\u8005 AMO \u6307\u4ee4\u6765\u5b9e\u73b0\u3002</p>"},{"location":"software/atomic_instructions/#cas","title":"CAS","text":""},{"location":"software/atomic_instructions/#_8","title":"\u5b9a\u4e49","text":"<p>CAS\uff08Compare-And-Swap\uff09\u6307\u4ee4\u505a\u7684\u4e8b\u60c5\u662f\uff0c\u628a\u5185\u5b58\u4e2d\u7684\u503c\u548c\u7ed9\u5b9a\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u540c\uff0c\u90a3\u4e48\u5199\u5165\u4e00\u4e2a\u65b0\u7684\u503c\uff1b\u628a\u5199\u5165\u662f\u5426\u6210\u529f\u5199\u5165\u76ee\u7684\u5bc4\u5b58\u5668\u4e2d\uff0c\u6216\u8005\u628a\u65e7\u503c\u5199\u5165\u5230\u76ee\u7684\u5bc4\u5b58\u5668\u4e2d\uff1a</p> <pre><code>cas dest, addr, compare, new\n</code></pre> <p>\u76f8\u5f53\u4e8e\u539f\u5b50\u5730\u5b8c\u6210\u4e86\u5982\u4e0b\u64cd\u4f5c\uff1a</p> <pre><code>if (memory[addr] == compare) {\n    memory[addr] = new;\n    dest = 1;\n} else {\n    dest = 0;\n}\n</code></pre> <p>\u6216\u8005\u8fd4\u56de\u5185\u5b58\u4e2d\u7684\u65e7\u503c\uff1a</p> <pre><code>dest = memory[addr];\nif (memory[addr] == compare) {\n    memory[addr] = new;\n}\n</code></pre>"},{"location":"software/atomic_instructions/#_9","title":"\u5e38\u89c1\u7528\u6cd5","text":"<p>CAS \u6307\u4ee4\u7684\u5e38\u89c1\u7528\u6cd5\u662f\uff0c\u653e\u5728\u5faa\u73af\u4e2d\uff0c\u9996\u5148\u8bfb\u53d6\u5185\u5b58\u4e2d\u7684\u503c\uff0c\u8fdb\u884c\u4e00\u7cfb\u5217\u8ba1\u7b97\uff0c\u7528 CAS \u6307\u4ee4\u8fdb\u884c\u5bf9\u5185\u5b58\u7684\u539f\u5b50\u66f4\u65b0\uff1a\u5982\u679c\u5185\u5b58\u7684\u503c\u6ca1\u6709\u53d8\uff0c\u90a3\u5c31\u628a\u65b0\u7684\u503c\u5199\u5165\uff1b\u5982\u679c\u5185\u5b58\u7684\u503c\u53d8\u4e86\uff0c\u90a3\u5c31\u5faa\u73af\u91cd\u65b0\u5c1d\u8bd5\uff1a</p> <pre><code>loop:\n    # Read\n    load old_data, addr\n    # Modify\n    add new_data, old_data, 1\n    # Compare-And-Swap\n    cas dest, addr, old_data, new_data\n    # Try again if CAS failed\n    goto loop if failed\n</code></pre> <p>\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u539f\u5b50\u52a0\u4e00\u64cd\u4f5c\u3002\u548c LL/SC \u4e00\u6837\uff0c\u4e5f\u9700\u8981\u5728\u5faa\u73af\u4e2d\u4e0d\u65ad\u5c1d\u8bd5\u66f4\u65b0\uff0c\u76f4\u5230\u66f4\u65b0\u6210\u529f\u4e3a\u6b62\u3002</p> <p>\u5bf9\u4e8e\u8fd4\u56de\u5185\u5b58\u4e2d\u65e7\u503c\u7684 CAS \u6307\u4ee4\uff0c\u53ef\u4ee5\u628a dest \u548c old_data \u8fdb\u884c\u6bd4\u8f83\u6765\u5224\u65ad CAS \u662f\u5426\u6210\u529f\u3002\u6709\u7684 CAS \u6307\u4ee4\u65e2\u8fd4\u56de\u4e86 CAS \u662f\u5426\u6210\u529f\u7684\u4fe1\u606f\uff0c\u53c8\u8fd4\u56de\u4e86\u5185\u5b58\u4e2d\u7684\u65e7\u503c\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u770b\u8d77\u6765\u548c LL/SC \u5f88\u50cf\uff0c\u4f46\u662f\u6709\u5982\u4e0b\u7684\u4e0d\u540c\uff1a</p> <ol> <li>LL/SC \u9700\u8981\u4e24\u6761\u539f\u5b50\u6307\u4ee4\uff0c\u5206\u522b\u5728\u5f00\u5934\u7684\u8bfb\u548c\u6700\u540e\u7684\u5199\uff1bCAS \u53ea\u6709\u4e00\u6761\u539f\u5b50\u6307\u4ee4\uff0c\u5728\u6700\u540e\u5b9e\u73b0\u5199\u5165\u3002</li> <li>LL/SC \u9700\u8981\u7684\u64cd\u4f5c\u6570\u6bd4\u8f83\u5c11\uff1aLL \u662f\u4e00\u4e2a\u6e90\u64cd\u4f5c\u6570\uff0c\u4e5f\u5c31\u662f\u8981\u8bfb\u53d6\u7684\u5185\u5b58\u5730\u5740\uff0c\u4e00\u4e2a\u76ee\u7684\u64cd\u4f5c\u6570\uff0c\u7528\u6765\u4fdd\u5b58\u8bfb\u53d6\u7684\u503c\uff1bSC \u662f\u4e24\u4e2a\u6e90\u64cd\u4f5c\u6570\uff0c\u5305\u62ec\u8981\u5199\u5165\u7684\u5185\u5b58\u5730\u5740\u548c\u6570\u636e\uff0c\u4e00\u4e2a\u76ee\u7684\u64cd\u4f5c\u6570\uff0c\u7528\u6765\u4fdd\u5b58 SC \u662f\u5426\u6210\u529f\u7684\u7ed3\u679c\uff1bCAS \u9700\u8981\u7684\u64cd\u4f5c\u6570\u6bd4\u8f83\u591a\uff1a\u4e09\u4e2a\u6e90\u64cd\u4f5c\u6570\uff0c\u5305\u62ec\u5185\u5b58\u5730\u5740\u3001\u6bd4\u8f83\u6570\u636e\u548c\u65b0\u6570\u636e\uff0c\u4e00\u4e2a\u76ee\u7684\u64cd\u4f5c\u6570\uff0c\u7528\u6765\u4fdd\u5b58 CAS \u662f\u5426\u6210\u529f\u6216\u8005\u5185\u5b58\u65e7\u503c\u3002</li> <li>CAS \u53ef\u80fd\u4f1a\u9047\u5230 ABA \u95ee\u9898\uff1a\u5728 Read-Modify-CAS \u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u5185\u5b58\u4e2d\u7684\u503c\u4ece A \u53d8\u6210\u4e86 B\uff0c\u53c8\u4ece B \u53d8\u56de\u4e86 A\uff0cCAS \u4f9d\u7136\u4f1a\u6210\u529f\uff0c\u56e0\u4e3a\u5b83\u5199\u5165\u4e0e\u5426\uff0c\u4ec5\u53d6\u51b3\u4e8e\u6bd4\u8f83\u662f\u5426\u76f8\u7b49\uff1b\u800c LL/SC \u4f1a\u7531\u786c\u4ef6\u76d1\u6d4b\u4e2d\u9014\u7684\u5185\u5b58\u8bbf\u95ee\uff0c\u53ea\u8981\u5185\u5b58\u4e2d\u7684\u503c\u88ab\u5199\u5165\u8fc7\uff0c\u65e0\u8bba\u6700\u540e\u7684\u503c\u662f\u5426\u56de\u5230\u4e86 LL \u8bfb\u53d6\u7684\u503c\uff0c\u90fd\u4f1a\u8ba9 SC \u5931\u8d25\u3002\u4e0b\u9762\u6765\u8ba8\u8bba ABA \u95ee\u9898\u3002</li> </ol>"},{"location":"software/atomic_instructions/#aba","title":"ABA \u95ee\u9898","text":"<p>ABA \u95ee\u9898\u5c31\u662f\u6307\u7684\u5728 Read-Modify-Write \u5faa\u73af\u4e2d\uff0c\u5982\u679c\u5185\u5b58\u4e2d\u7684\u503c\u4ece A \u53d8\u6210\u4e86 B\uff0c\u53c8\u4ece B \u53d8\u6210\u4e86 A\uff0c\u662f\u5426\u4f1a\u5f71\u54cd\u5199\u5165\u662f\u5426\u6210\u529f\u7684\u95ee\u9898\u3002LL/SC \u7684\u7b54\u6848\u662f\uff0c\u5982\u679c\u51fa\u73b0\u4e86 ABA \u7684\u60c5\u51b5\uff0c\u4f1a\u4f7f\u5f97\u5199\u5165\u5931\u8d25\uff1bCAS \u7684\u7b54\u6848\u662f\uff0cABA \u60c5\u51b5\u4e0b\u5199\u5165\u4f9d\u7136\u6210\u529f\u3002</p> <p>\u4e3a\u4ec0\u4e48\u8981\u8ba8\u8bba ABA \u95ee\u9898\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u4e00\u4e9b\u65e0\u9501\u6570\u636e\u7ed3\u6784\u7684\u5b9e\u73b0\uff0c\u662f\u4e0d\u5141\u8bb8 ABA \u60c5\u51b5\u7684\u51fa\u73b0\u7684\u3002\u8fd9\u4e2a\u65f6\u5019\uff0c\u5c31\u9700\u8981\u7528 LL/SC\uff0c\u6216\u8005\u7528\u4e0b\u9762\u8981\u4ecb\u7ecd\u7684 DWCAS\uff08Double Width Compare And Swap\uff09\u6307\u4ee4\uff0c\u800c\u4e0d\u662f CAS \u6307\u4ee4\u3002</p>"},{"location":"software/atomic_instructions/#dwcas","title":"DWCAS","text":"<p>DWCAS\uff08Double Width Compare And Swap\uff09\u6307\u4ee4\u5176\u5b9e\u4e5f\u662f CAS \u6307\u4ee4\uff0c\u53ea\u4e0d\u8fc7\u5b83\u7684\u5185\u5b58\u64cd\u4f5c\u7684\u7c92\u5ea6\u662f\u5904\u7406\u5668\u4f4d\u6570\u7684\u4e24\u500d\uff1a\u4f8b\u5982 32 \u4f4d\u5904\u7406\u5668\uff0cDWCAS \u7684\u64cd\u4f5c\u5bbd\u5ea6\u5c31\u662f 64 \u4f4d\uff1b64 \u4f4d\u5904\u7406\u5668\uff0cDWCAS \u7684\u64cd\u4f5c\u5bbd\u5ea6\u5c31\u662f 128 \u4f4d\u3002</p> <p>\u5f15\u5165 DWCAS \u53ef\u4ee5\u89e3\u51b3 ABA \u7684\u95ee\u9898\uff1a\u65e2\u7136\u95ee\u9898\u51fa\u5728\u503c\u4f1a\u4ece A \u5230 B \u518d\u56de\u5230 A\uff0c\u90a3\u5c31\u8ba9\u503c\u201c\u4e0d\u56de\u5230\u201dA\uff0c\u4e0d\u5c31\u597d\u4e86\uff1f\u6bcf\u6b21\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u9664\u4e86\u539f\u672c\u8981\u66f4\u65b0\u7684\u503c\uff0c\u540c\u65f6\u66f4\u65b0\u4e00\u4e2a counter\uff0c\u8fd9\u4e2a counter \u6bcf\u6b21\u66f4\u65b0\u90fd\u52a0\u4e00\u3002counter \u6ea2\u51fa\u9700\u8981\u5f88\u591a\u5f88\u591a\u6b21 CAS\uff0c\u56e0\u6b64\u53ef\u4ee5\u8ba4\u4e3a\u4e0d\u4f1a\u51fa\u73b0 ABA \u7684\u60c5\u51b5\uff0c\u8fd9\u65f6\u5019\u5c31\u89e3\u51b3\u4e86 ABA \u95ee\u9898\u3002</p> <p>\u4f46\u662f\uff0c\u901a\u5e38\u5904\u7406\u5668\u90fd\u53ea\u4f1a\u63d0\u4f9b\u4e0d\u8d85\u8fc7\u5904\u7406\u5668\u4f4d\u6570\u7684\u5185\u5b58\u6307\u4ee4\uff0c\u4f8b\u5982 32 \u4f4d\u5904\u7406\u5668\u63d0\u4f9b 8 \u4f4d\u300116 \u4f4d\u548c 32 \u4f4d CAS\uff0c\u90a3\u8981\u662f\u9700\u8981\u66f4\u65b0\u7684\u503c\u5df2\u7ecf\u5360\u4e86 32 \u4f4d\uff0c\u600e\u4e48\u540c\u65f6\u66f4\u65b0 counter \u5462\uff1f\u6240\u4ee5\u5c31\u4e0d\u5f97\u4e0d\u5f15\u5165\u4e86 DWCAS\uff0c\u5728 32 \u4f4d\u5904\u7406\u5668\u4e0a\u63d0\u4f9b 64 \u4f4d CAS\uff0c\u591a\u7684\u90a3 32 \u4f4d\u5c31\u53ef\u4ee5\u62ff\u6765\u66f4\u65b0 counter\u3002</p> <p>\u4f46\u662f DWCAS \u5b9e\u73b0\u8d77\u6765\u4e5f\u4f1a\u6bd4\u8f83\u590d\u6742\uff1a\u6bcf\u4e2a\u64cd\u4f5c\u6570\u7684\u4f4d\u5bbd\u90fd\u7ffb\u500d\u4e86\uff0c\u539f\u6765\u7684\u4e00\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u653e\u4e0d\u4e0b\u4e86\uff0c\u600e\u4e48\u529e\uff1f\u4e00\u4e2a\u6734\u7d20\u7684\u529e\u6cd5\u662f\uff0c\u4f20\u66f4\u591a\u7684\u64cd\u4f5c\u6570\uff0c\u4e24\u4e2a\u64cd\u4f5c\u6570\u62fc\u8d77\u6765\u5408\u6210\u4e00\u4e2a\u4e24\u500d\u4f4d\u5bbd\u7684\u503c\uff0c\u4f46\u662f\u8fd9\u6837\u5728\u6307\u4ee4\u7f16\u7801\u4e2d\uff0c\u64cd\u4f5c\u6570\u5360\u7528\u7684\u4f4d\u6570\u592a\u591a\uff1a</p> <pre><code>cas dest_hi, dest_lo, addr, old_data_hi, old_data_lo, new_data_hi, new_data_lo\n</code></pre> <p>\u4e00\u4e2a\u89e3\u51b3\u65b9\u6cd5\u662f\uff0c\u4e00\u4e2a\u64cd\u4f5c\u6570\u5bf9\u5e94\u4e24\u4e2a\u8fde\u7eed\u7684\u901a\u7528\u5bc4\u5b58\u5668\uff0c\u4f8b\u5982\u67d0\u4e2a\u64cd\u4f5c\u6570\u662f 2 \u53f7\u5bc4\u5b58\u5668\uff0c\u4ee3\u8868\u7684\u5c31\u662f 2 \u53f7\u548c 3 \u53f7\u5bc4\u5b58\u5668\u62fc\u63a5\u8d77\u6765\u7684\u4e24\u500d\u4f4d\u5bbd\u7684\u503c\u3002\u5982\u679c\u5e73\u53f0\u6709\u66f4\u5bbd\u7684\u5411\u91cf\u5bc4\u5b58\u5668\uff0c\u4e5f\u53ef\u4ee5\u628a\u64cd\u4f5c\u6570\u653e\u5230\u5411\u91cf\u5bc4\u5b58\u5668\u4e0a\u4f20\u5165\u3002\u4f46\u65e0\u8bba\u5982\u4f55\uff0c\u5355\u6761\u6307\u4ee4\u6d89\u53ca\u5230\u7684\u64cd\u4f5c\u6570\u548c\u5bbd\u5ea6\u90fd\u6bd4\u8f83\u5927\uff0c\u7ed9\u5904\u7406\u5668\u7684\u8bbe\u8ba1\u5e26\u6765\u4e86\u4e00\u5b9a\u7684\u6311\u6218\u3002</p> <p>\u9664\u4e86 DWCAS \u4ee5\u5916\uff0c\u8fd8\u6709\u4e00\u79cd CAS \u53d8\u4f53\uff1aDCAS\uff08Double Compare and Swap\uff09\u3002\u548c DWCAS \u4e0d\u540c\u7684\u662f\uff0cDCAS \u5b9e\u73b0\u7684\u539f\u5b50\u7684\u4e24\u4e2a CAS \u64cd\u4f5c\uff0c\u8fd9\u4e24\u4e2a CAS \u53ef\u4ee5\u64cd\u4f5c\u4e0d\u8fde\u7eed\u7684\u5185\u5b58\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cDWCAS \u53ef\u4ee5\u8ba4\u4e3a\u662f DCAS \u7684\u4e00\u4e2a\u7279\u6b8a\u60c5\u51b5\uff0c\u7279\u6b8a\u5728\u4e8e\u4e24\u4e2a CAS \u64cd\u4f5c\u7684\u662f\u8fde\u7eed\u7684\u5185\u5b58\u3002</p>"},{"location":"software/atomic_instructions/#_10","title":"\u6307\u4ee4\u96c6\u67b6\u6784\u652f\u6301","text":"<p>x86_64 \u6307\u4ee4\u96c6\u63d0\u4f9b\u4e86 CAS \u6307\u4ee4\uff0c\u5e76\u4e14\u63d0\u4f9b\u4e86 DWCAS \u4e24\u500d\u4f4d\u5bbd\u7248\u672c\uff1acmpxchg16b \u6307\u4ee4\uff0c\u5b83\u628a\u5185\u5b58\u4e2d\u7684\u503c\u548c RDX:RAX \u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5c31\u8bbe\u7f6e ZF\uff0c\u5e76\u5f80\u5185\u5b58\u5199\u5165 RCX:RBX\uff1b\u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u6e05\u7a7a ZF \u5e76\u628a\u5185\u5b58\u4e2d\u7684\u503c\u5199\u5165\u5230 RDX:RAX\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u6761\u6307\u4ee4\u91c7\u7528\u7684\u662f\u591a\u4e2a\u6e90\u5bc4\u5b58\u5668\u7684\u65b9\u6848\uff1aRDX\u3001RAX\u3001RCX\u3001RBX \u4e00\u5171\u56db\u4e2a\u6e90 64 \u4f4d\u901a\u7528\u5bc4\u5b58\u5668\uff0c\u5e76\u4e14\u901a\u8fc7\u5b9a\u6b7b\u5bc4\u5b58\u5668\u7f16\u53f7\uff0c\u89e3\u51b3\u4e86\u6307\u4ee4\u7f16\u7801\u7684\u95ee\u9898\u3002\u540c\u65f6\uff0c\u4e00\u6761\u6307\u4ee4\u4e5f\u8981\u5199\u5165\u4e24\u4e2a\u901a\u7528\u5bc4\u5b58\u5668 RDX \u548c RAX\uff0c\u5916\u52a0 FLAGS \u5bc4\u5b58\u5668\u7684 ZF\u3002</p> <p>LoongArch \u4ece V1.1 \u7248\u672c\u5f00\u59cb\uff0c\u652f\u6301\u4e86 AMCAS \u6307\u4ee4\u3002RISC-V \u4e5f\u6709\u53ef\u9009\u7684 Zacas \u6269\u5c55\u3002AArch64 \u4e5f\u63d0\u4f9b\u4e86 CAS \u6307\u4ee4\uff0c\u5e76\u4e14 CASP \u6307\u4ee4\u5b9e\u73b0\u4e86 DWCAS\u3002</p>"},{"location":"software/atomic_instructions/#_11","title":"\u786c\u4ef6\u5b9e\u73b0","text":"<p>CAS \u7684\u786c\u4ef6\u5b9e\u73b0\u4e5f\u6bd4\u8f83\u7b80\u5355\uff1a\u5728\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u4e0b\uff0c\u5f53\u4e00\u4e2a\u7f13\u5b58\u53ef\u4ee5\u5199\u7f13\u5b58\u884c\u7684\u65f6\u5019\uff0c\u5b83\u62e5\u6709\u4e86\u8fd9\u4e2a\u7f13\u5b58\u884c\u7684\u6240\u6709\u6743\u9650\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u5728\u7f13\u5b58\u91cc\u5b9e\u73b0 CAS \u5373\u53ef\uff0c\u5176\u4ed6\u7f13\u5b58\u65e0\u6cd5\u6253\u65ad\u8fd9\u4e2a\u539f\u5b50\u7684\u64cd\u4f5c\u3002</p>"},{"location":"software/atomic_instructions/#amo","title":"AMO","text":""},{"location":"software/atomic_instructions/#_12","title":"\u5b9a\u4e49","text":"<p>AMO\uff08Atomic Memory Operations\uff09\u6307\u7684\u662f\u5bf9\u5185\u5b58\u4e2d\u7684\u503c\u8fdb\u884c\u539f\u5b50\u66f4\u65b0\uff1a\u8bfb\u53d6\u5185\u5b58\u4e2d\u7684\u503c\uff0c\u5199\u5165\u5230\u76ee\u7684\u5bc4\u5b58\u5668\uff0c\u540c\u65f6\u5bf9\u503c\u8fdb\u884c\u4e00\u4e9b\u66f4\u65b0\u64cd\u4f5c\uff0c\u518d\u5199\u5165\u5185\u5b58\u3002\u8fd9\u4e2a\u66f4\u65b0\u64cd\u4f5c\u662f\u9884\u8bbe\u7684\uff0c\u4f8b\u5982\u4f4d\u8fd0\u7b97\uff08AND\u3001OR\u3001XOR \u548c SWAP\uff09\u6216\u8005\u6574\u6570\u8fd0\u7b97\uff08ADD\u3001MIN \u548c MAX\uff09\u7b49\u7b49\u3002\u5b83\u7528\u4e00\u6761\u6307\u4ee4\u5b8c\u6210\u4e86\u524d\u9762 LL/SC \u6216\u8005 CAS \u6307\u4ee4\u7684\u8bfb - \u6539 - \u5199\u5faa\u73af\u505a\u7684\u529f\u80fd\uff0c\u4f46\u662f\u9650\u5236\u4e86\u5141\u8bb8\u7684\u4fee\u6539\u64cd\u4f5c\uff1a</p> <pre><code># Use AMO\n    amoadd dest, addr, 1\n\n# Use CAS\nloop:\n    # Read\n    load old_data, addr\n    # Modify\n    add new_data, old_data, 1\n    # Compare-And-Swap\n    cas dest, addr, old_data, new_data\n    # Try again if CAS failed\n    goto loop if failed\n</code></pre>"},{"location":"software/atomic_instructions/#_13","title":"\u5e38\u89c1\u7528\u6cd5","text":"<p>AMO \u6307\u4ee4\u76f8\u5f53\u4e8e\u662f\u628a\u4e00\u4e9b\u5e38\u89c1\u7684\u8bfb - \u6539 - \u5199\u5faa\u73af\u56fa\u5316\u6210\u4e86\u6307\u4ee4\uff0c\u56e0\u6b64\u539f\u6765\u7528 LL/SC \u6216 CAS \u5b9e\u73b0\u7684\u4e00\u4e9b\u539f\u5b50\u64cd\u4f5c\uff0c\u5982\u679c\u6709\u5bf9\u5e94\u7684 AMO \u6307\u4ee4\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528 AMO \u6307\u4ee4\u5b9e\u73b0\u3002</p>"},{"location":"software/atomic_instructions/#_14","title":"\u6307\u4ee4\u96c6\u67b6\u6784\u652f\u6301","text":"<p>RISC-V \u548c LoongArch \u90fd\u63d0\u4f9b\u4e86 AMO \u6307\u4ee4\uff0c\u5b83\u4eec\u53ef\u4ee5\u5b8c\u6210\u5185\u5b58\u7684\u539f\u5b50\u66f4\u65b0\uff0c\u540c\u65f6\u5f97\u5230\u66f4\u65b0\u524d\u7684\u65e7\u503c\u3002x86 \u6307\u4ee4\u96c6\u4e0b\uff0c\u901a\u8fc7\u7ed9 add \u6307\u4ee4\u6dfb\u52a0 lock \u524d\u7f00\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u539f\u5b50\u66f4\u65b0\u7684\u6548\u679c\uff0c\u5982\u679c\u8981\u5f97\u5230\u66f4\u65b0\u524d\u7684\u65e7\u503c\uff0c\u53ef\u4ee5\u7528 xadd \u6307\u4ee4\u3002</p> <p>AArch64 \u63d0\u4f9b\u4e86 AMO \u6307\u4ee4\uff1aLDADD\u3001LDMAX\u3001STADD\u3001SWP \u7b49\u7b49\u3002</p>"},{"location":"software/atomic_instructions/#_15","title":"\u786c\u4ef6\u5b9e\u73b0","text":"<p>AMO \u6307\u4ee4\u7684\u786c\u4ef6\u5b9e\u73b0\u548c CAS \u7c7b\u4f3c\uff0c\u4e5f\u662f\u628a\u539f\u5b50\u64cd\u4f5c\u4e0b\u653e\u5230\u7f13\u5b58\u4e2d\u53bb\u6267\u884c\u3002\u4f46\u7531\u4e8e AMO \u6307\u4ee4\u9700\u8981\u6d89\u53ca\u5c11\u91cf\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u4f8b\u5982\u4f4d\u8fd0\u7b97\u548c\u6574\u6570\u8fd0\u7b97\uff0c\u56e0\u6b64\u7f13\u5b58\u5185\u90e8\u4e5f\u9700\u8981\u5f15\u5165\u4e00\u4e2a ALU \u7528\u4e8e\u5b9e\u73b0 AMO \u6307\u4ee4\u7684\u8ba1\u7b97\u3002\u56e0\u6b64\uff0c\u76ee\u524d AMO \u6307\u4ee4\u4ec5\u9650\u4e8e\u786c\u4ef6\u5f00\u9500\u6bd4\u8f83\u5c0f\u7684\u4f4d\u8fd0\u7b97\u548c\u6574\u6570\u8fd0\u7b97\uff0c\u6ca1\u6709\u6574\u6570\u4e58\u9664\u6cd5\uff0c\u4e5f\u6ca1\u6709\u6d6e\u70b9\u8fd0\u7b97\u3002</p> <p>\u4f8b\u5982 Rocket Chip \u8bbe\u8ba1\u4e86\u4e00\u4e2a AMOALU\uff0c\u7528\u4e8e\u5728 DCache \u4e2d\u5b9e\u73b0 AMO \u6307\u4ee4\u7684\u8ba1\u7b97\u3002</p>"},{"location":"software/atomic_instructions/#htm","title":"HTM","text":""},{"location":"software/atomic_instructions/#_16","title":"\u5b9a\u4e49","text":"<p>HTM \u662f\u786c\u4ef6\u63d0\u4f9b\u7684\u5728\u5185\u5b58\u4e0a\u7684\u4e8b\u52a1\u3002\u4e8b\u52a1\u8fd9\u4e2a\u6982\u5ff5\u5728\u6570\u636e\u5e93\u4e0a\u6bd4\u8f83\u5e38\u89c1\uff0c\u628a\u591a\u4e2a\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u653e\u5230\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6574\u4e2a\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u3002HTM \u4e5f\u662f\u7c7b\u4f3c\u7684\uff0c\u53ea\u4e0d\u8fc7\u662f\u5728 CPU \u4e0a\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u4e00\u7cfb\u5217\u7684\u6307\u4ee4\u5bf9\u5185\u5b58\u7684\u64cd\u4f5c\u662f\u539f\u5b50\u7684\u3002</p>"},{"location":"software/atomic_instructions/#_17","title":"\u5e38\u89c1\u7528\u6cd5","text":"<p>\u901a\u5e38\uff0c\u5b83\u9700\u8981\u7528\u7279\u5b9a\u7684 begin \u6307\u4ee4\u5f00\u59cb\u4e00\u6bb5\u4e8b\u52a1\uff0c\u6267\u884c\u4e00\u7cfb\u5217\u6307\u4ee4\u540e\uff0c\u518d\u7528\u7279\u5b9a\u7684 end \u6307\u4ee4\u7ed3\u675f\u4e8b\u52a1\u3002\u5982\u679c\u5728\u4e8b\u52a1\u4e2d\u9014\uff0c\u4e8b\u52a1\u88ab\u6253\u65ad\uff0c\u4f8b\u5982\u7a0b\u5e8f\u4e3b\u52a8\u7528\u6307\u4ee4\u6253\u65ad\uff0c\u6216\u8005\u6d89\u53ca\u5230\u7684\u5185\u5b58\u88ab\u5176\u4ed6\u5904\u7406\u5668\u6838\u5fc3\u4fee\u6539\uff0c\u90a3\u4e48\u4e8b\u52a1\u5c31\u4f1a\u88ab\u56de\u6eda\uff0c\u540c\u65f6\u7a0b\u5e8f\u8f6c\u79fb\u5230\u6307\u5b9a\u7684 fallback \u5730\u5740\u7ee7\u7eed\u6267\u884c\uff0c\u8fd9\u4e2a fallback \u5730\u5740\u4f1a\u5728 begin \u6307\u4ee4\u4e2d\u7ed9\u51fa\u3002\u4e0b\u9762\u662f\u4e00\u6bb5\u7528\u786c\u4ef6\u5185\u5b58\u4e8b\u52a1\u5b9e\u73b0\u7684\u539f\u5b50\u52a0\u4e00\uff1a</p> <pre><code>retry:\n    # begin transaction\n    # set fallback address to fail label\n    begin fail\n\n    # do computation\n    load data, addr\n    add data, data, 1\n    store data, addr\n\n    # end transaction\n    end\n\nfail:\n    # retry if transaction failed\n    goto retry\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0cHTM \u652f\u6301\u5d4c\u5957\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u5728\u4e00\u6b21\u4e8b\u52a1\u4e2d\u9014\uff0c\u518d\u5f00\u53e6\u4e00\u4e2a\u4e8b\u52a1\u3002\u4f46\u53ea\u6709\u6700\u5916\u5c42\u7684\u4e8b\u52a1\u7684 end \u6307\u4ee4\u4f1a\u63d0\u4ea4\u4e8b\u52a1\uff0c\u5982\u679c\u9700\u8981\u56de\u6eda\u4e8b\u52a1\uff0c\u4e5f\u4f1a\u56de\u6eda\u5230\u6700\u5916\u5c42\u4e8b\u52a1\uff0c\u518d\u8df3\u8f6c\u5230\u6700\u5916\u5c42\u4e8b\u52a1\u7684 fallback \u5730\u5740\u3002</p>"},{"location":"software/atomic_instructions/#_18","title":"\u6307\u4ee4\u96c6\u67b6\u6784\u652f\u6301","text":"<p>x86_64 \u6307\u4ee4\u96c6\u63d0\u4f9b\u4e86 Transactional Synchronization Extensions (TSX) \u6269\u5c55\uff0c\u5b83\u6709\u4e24\u79cd\u4f7f\u7528\u65b9\u6cd5\uff1aHardware Lock Elision \u548c Restricted Transactional Memory\u3002\u5b83\u7684\u6587\u6863\u5728 Intel 64 and IA-32 Architectures Software Develop's Manual \u7684 Volume 1 Chapter 16 Programming with Intel Transaction Synchronization Extensions\u3002</p> <p>Hardware Lock Elision \u7684\u5e94\u7528\u573a\u666f\u662f\uff0c\u7a0b\u5e8f\u7f16\u5199\u4e86 critical section\uff0c\u5e76\u4e14\u7528\u9501\u6765\u4fdd\u62a4\u5b83\uff0c\u4fdd\u8bc1\u540c\u65f6\u53ea\u6709\u4e00\u4e2a\u6838\u5fc3\u5728\u6267\u884c\u8fd9\u4e2a critical section\u3002\u4f46\u9501\u4f1a\u5e26\u6765\u989d\u5916\u7684\u5f00\u9500\u3002\u65e2\u7136\u6709\u4e86\u786c\u4ef6\u5185\u5b58\u4e8b\u52a1\uff0c\u5c31\u53ef\u4ee5\u5148\u8df3\u8fc7\u52a0\u9501\u8fd9\u4e00\u6b65\uff0c\u5728\u4e8b\u52a1\u91cc\u6267\u884c\u4e00\u6b21 critical section\uff0c\u5728\u539f\u6765\u91ca\u653e\u9501\u7684\u5730\u65b9\u7ed3\u675f\u4e8b\u52a1\u3002\u5982\u679c\u4e8b\u52a1\u6210\u529f\u63d0\u4ea4\uff0c\u8bf4\u660e\u6ca1\u6709\u5176\u4ed6\u6838\u5fc3\u8981\u8fdb\u5165 critical section\uff0c\u90a3\u5c31\u7701\u4e0b\u4e86\u9501\u7684\u5f00\u9500\uff1b\u5982\u679c\u4e8b\u52a1\u6ca1\u6709\u6210\u529f\u63d0\u4ea4\uff0c\u5c31\u4f1a\u56de\u6eda\uff0c\u518d\u6b63\u5e38\u6267\u884c\u5e26\u9501\u7684 critical section\u3002</p> <p>\u5177\u4f53\u5730\uff0c\u5b83\u5728\u52a0\u9501\u7684\u6307\u4ee4\u4e0a\u6dfb\u52a0\u4e00\u4e2a XACQUIRE \u524d\u7f00\uff0c\u5e76\u5728\u91ca\u653e\u9501\u7684\u6307\u4ee4\u4e0a\u6dfb\u52a0\u4e00\u4e2a XRELEASE \u524d\u7f00\u3002\u90a3\u4e48\u5728\u652f\u6301 TSX \u7684\u786c\u4ef6\u4e0a\uff0c\u5904\u7406\u5668\u5c31\u53ef\u4ee5\u7528\u786c\u4ef6\u4e8b\u52a1\u6765\u5c1d\u8bd5\u7ed5\u8fc7\u9501\u3002\u5982\u679c\u5904\u7406\u5668\u4e0d\u652f\u6301 TSX\uff0c\u5c31\u4f1a\u5ffd\u7565\u6389 XACQUIRE \u548c XRELEASE \u524d\u7f00\uff0c\u6b63\u5e38\u4e0a\u9501\u3001\u6267\u884c\u4ee3\u7801\u518d\u91ca\u653e\u9501\u3002</p> <p>Restricted Transactional Memory \u5c31\u662f\u5b8c\u6574\u7684\u786c\u4ef6\u5185\u5b58\u4e8b\u52a1\u652f\u6301\uff1a\u7528 XBEGIN \u6307\u4ee4\u5f00\u59cb\u4e8b\u52a1\uff0c\u7528 XEND \u6307\u4ee4\u7ed3\u675f\u4e8b\u52a1\uff0c\u7528 XABORT \u6307\u4ee4\u6253\u65ad\u5f53\u524d\u4e8b\u52a1\u3002</p> <p>AArch64 \u4ece ARMv9-A \u5f00\u59cb\uff0c\u4e5f\u5f15\u5165\u4e86\u786c\u4ef6\u5185\u5b58\u4e8b\u52a1\u652f\u6301\uff1aTransactional Memory Extension (TME)\u3002\u5b83\u5f15\u5165\u4e86\u5982\u4e0b\u7684\u65b0\u6307\u4ee4\uff1a</p> <ul> <li>TCANCEL imm: \u5bf9\u5e94 x86 \u7684 XABORT\uff0c\u53d6\u6d88\u4e8b\u52a1\uff0c\u4ece TSTART \u4e0b\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u7ee7\u7eed\u6267\u884c\uff0cimm \u4f1a\u88ab\u5199\u5165\u5230 TSTART \u6307\u4ee4\u7684\u76ee\u7684\u5bc4\u5b58\u5668</li> <li>TCOMMIT: \u5bf9\u5e94 x86 \u7684 XEND</li> <li>TSTART Xd: \u5bf9\u5e94 x86 \u7684 XBEGIN\uff0c\u5982\u679c\u4e8b\u52a1\u6210\u529f\u5f00\u59cb\uff0c\u90a3\u4e48\u76ee\u7684\u5bc4\u5b58\u5668\u88ab\u5199\u5165 0\uff1b\u5982\u679c\u4e8b\u52a1\u5931\u8d25\uff0c\u90a3\u4e48\u76ee\u7684\u5bc4\u5b58\u5668\u4f1a\u88ab\u5199\u5165\u4e3a\u4e8b\u52a1\u5931\u8d25\u539f\u56e0</li> <li>TTEST Xd: \u628a\u76ee\u524d\u7684\u4e8b\u52a1\u5d4c\u5957\u5c42\u7ea7\u5199\u5230\u76ee\u7684\u5bc4\u5b58\u5668</li> </ul> <p>\u56e0\u6b64 TME \u7684\u9884\u671f\u4f7f\u7528\u65b9\u6cd5\u662f\uff08\u4f8b\u5b50\u6765\u81ea ARM DDI0617 C1.1 Conventions\uff09\uff1a</p> <pre><code>loop\n    tstart x12     # attempt to start a new transaction\n    cbnz x12, loop # retry forever\n\n    &lt;code&gt;\n\n    tcommit\n</code></pre> <p>\u6b64\u5916\uff0cTME \u6269\u5c55\u4e5f\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u7c7b\u4f3c x86 \u7684 HLE \u7279\u6027\uff1aTransactional Lock Elision\u3002\u4f46\u662f\uff0c\u4e0e x86 \u7684\u5b9e\u73b0\u65b9\u6cd5\u4e0d\u540c\uff0cAArch64 \u7684 TME \u6269\u5c55\u8fd8\u662f\u9700\u8981\u7528\u4e0a\u8ff0\u7684 TSTART \u7b49\u6307\u4ee4\u6765\u5b9e\u73b0 Transactional Lock Elision\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff08\u6765\u81ea ARM DDI0617 C2.3 Acquiring a lock\uff09\uff1a</p> <p>\u83b7\u5f97\u9501\uff1a</p> <pre><code>loop:\n    TSTART X5         # attempt to start a new transaction\n    CBNZ X5, fallback # check if start succeeded\n\n    # CHECK_ACQ(X1)\n    # add the fallback lock to the transactional read set ; and set W5 to 0 if the fallback lock is free.\n    LDAR W5, [X1]\n\n    CBZ W5, enter     # if the fallback lock is free enter the critical region\n    TCANCEL #0xFFFF   # otherwise cancel the transaction with RTRY set to 1\n\nfallback:\n    TBZ X5, #15, lock # if RTRY is 0 take the fallback lock\n    SUB W6, W6, #1    # decrement the retry count\n    CBZ W6, lock      # take the lock if 0\n\n    # WAIT_ACQ(X1==0)\n    # wait until the lock is free\nloop_wait:\n    LDAR W5, [X1]     # load acquire ensures it is ordered before subsequent loads/stores\n    CBNZ W5, loop_wait\n\n    B loop            # retry the transaction\n\nlock:\n    # LOCK(X1)\n    # elision failed, acquire the fallback lock\n\n    PRFM PSTL1KEEP, [X1] # preload into cache in unique state\nloop_lock:\n    LDAXR W5, [X1]       # read lock with acquire\n    CBNZ W5, loop_lock   # check if 0\n    STXR W5, W0, [X1]    # attempt to store new value\n    CBNZ W5, loop_lock   # test if store succeeded and retry if not\n\n    DMB ISH           # block loads/stores from the critical region\n\nenter:\n</code></pre> <p>\u4ee3\u7801\u9996\u5148\u5f00\u59cb\u4e00\u6b21\u4e8b\u52a1\uff0c\u5982\u679c\u53d1\u73b0\u9501\u6ca1\u6709\u88ab\u5176\u4ed6\u7ebf\u7a0b\u83b7\u5f97\uff0c\u90a3\u5c31\u76f4\u63a5\u8df3\u8f6c\u5230 enter \u8fdb\u884c critical section \u7684\u6267\u884c\uff1b\u5982\u679c\u53d1\u73b0\u9501\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u83b7\u5f97\uff0c\u5c31\u53d6\u6d88\u4e8b\u52a1\uff0c\u518d\u6b21\u5faa\u73af\uff0c\u5982\u679c\u5faa\u73af\u591a\u6b21\u8fd8\u662f\u5931\u8d25\uff0c\u90a3\u5c31\u7528\u4f20\u7edf\u7684\u9501\u3002</p> <p>\u5728 critical section \u6700\u540e\u91ca\u653e\u9501\uff1a</p> <pre><code>    # CHECK(X1)\n    # set W5 to 0 if the fallback lock is free\n    LDR W5, [Xx] ; read lock\n\n    CBNZ W5, unlock   # check if 0\n    TCOMMIT           # the lock was elided, exit the transaction\n    B exit\n\nunlock:\n    # UNLOCK(X1)\n    # elision failed, release the fallback lock exit:\n    STLR WZR, [X1]    # clear the lock with release semantics\n\nexit:\n</code></pre> <p>\u9996\u5148\u68c0\u67e5\u4e4b\u524d\u662f\u91c7\u7528\u7684\u54ea\u79cd\u65b9\u6cd5\u201c\u83b7\u5f97\u201d\u4e86\u9501\uff0c\u5982\u679c\u662f\u4e8b\u52a1\uff0c\u90a3\u5c31\u63d0\u4ea4\u4e8b\u52a1\uff1b\u5982\u679c\u662f\u4f20\u7edf\u7684\u9501\uff0c\u90a3\u5c31\u91ca\u653e\u6389\u9501\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u76f8\u6bd4 x86 \u7684\u65b9\u6848\uff0cARM \u7684 TME \u5728\u5b9e\u73b0 Lock Elision \u65f6\uff0c\u6307\u4ee4\u4e0a\u4f1a\u6bd4\u8f83\u5197\u4f59\uff0c\u4f46\u597d\u5904\u662f\u5fae\u67b6\u6784\u7684\u5b9e\u73b0\u4f1a\u6bd4\u8f83\u5bb9\u6613\u3002</p>"},{"location":"software/atomic_instructions/#_19","title":"\u4e0d\u540c\u539f\u5b50\u6307\u4ee4\u95f4\u7684\u5173\u7cfb","text":"<p>\u4e0d\u540c\u539f\u5b50\u6307\u4ee4\u4e4b\u95f4\uff0c\u867d\u7136\u8bed\u4e49\u4e0d\u540c\uff0c\u4f46\u662f\u53ef\u4ee5\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u4e92\u76f8\u5b9e\u73b0\u3002</p> <p>\u7528 LL/SC \u5b9e\u73b0 CAS\uff1a\u9996\u5148\u7528 LL \u8bfb\u53d6\u65e7\u503c\uff0c\u548c\u9884\u671f\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u7528 SC \u5199\u5165\u65b0\u503c\uff0c\u5982\u679c SC \u5199\u5165\u5931\u8d25\uff0c\u5219\u5faa\u73af\u3002</p> <p>\u7528 CAS \u5b9e\u73b0 AMO\uff1a\u9996\u5148\u8bfb\u53d6\u65e7\u503c\uff0c\u7528\u6307\u4ee4\u5b9e\u73b0 AMO \u8981\u505a\u7684\u66f4\u65b0\u64cd\u4f5c\u540e\uff0c\u7528 CAS \u5c1d\u8bd5\u5199\u5165\uff0c\u5982\u679c\u5185\u5b58\u4e2d\u7684\u503c\u7b49\u4e8e\u65e7\u503c\uff0c\u5c31\u628a\u66f4\u65b0\u540e\u7684\u65b0\u503c\u5199\u5165\uff0c\u5982\u679c\u5199\u5165\u5931\u8d25\uff0c\u5219\u5faa\u73af\u3002</p> <p>\u7528 CAS \u5b9e\u73b0 LL/SC\uff1a\u4e0d\u5b8c\u7f8e\uff0c\u53ef\u80fd\u6709 ABA \u95ee\u9898\u3002\u7528\u6b63\u5e38\u7684\u6307\u4ee4\u8bfb\u53d6\u5185\u5b58\u4ee5\u4ee3\u66ff LL\uff0c\u8bb0\u5f55\u4e0b\u8bbf\u95ee\u7684\u5185\u5b58\u5730\u5740\u548c\u8bfb\u53d6\u7684\u503c\uff1b\u5728\u539f\u6765 SC \u7684\u5730\u65b9\uff0c\u5224\u65ad SC \u7684\u5730\u5740\u662f\u5426\u548c\u4e4b\u524d LL \u7684\u76f8\u540c\uff0c\u5982\u679c\u5730\u5740\u76f8\u540c\uff0c\u5219\u7528 CAS \u5c1d\u8bd5\u5199\u5165\uff0c\u5982\u679c\u5185\u5b58\u4e2d\u7684\u503c\u7b49\u4e8e\u4e4b\u524d\u8bfb\u53d6\u7684\u503c\uff0c\u5c31\u5199\u5165 SC \u8981\u5199\u5165\u7684\u503c\u3002</p> <p>\u5173\u4e8e LL/SC \u548c CAS \u5728 Linux \u4e2d\u4f7f\u7528\u7684\u8ba8\u8bba\uff0c\u63a8\u8350\u9605\u8bfb\uff1acmpxchg ll/sc portability\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0cQEMU \u4e3a\u4e86\u6027\u80fd\uff0c\u4f1a\u7528 CAS \u5b9e\u73b0 LL/SC\u3002\u867d\u7136\u5b83\u4f1a\u6709 ABA \u95ee\u9898\uff0c\u4f46\u5b9e\u9645\u4e0a\u5229\u7528 LL/SC \u6765\u907f\u514d ABA \u95ee\u9898\u7684\u4ee3\u7801\u6bd4\u8f83\u5c11\u3002\u5982\u679c\u4e0d\u8fd9\u4e48\u505a\uff0c\u5c31\u9700\u8981\u6bd4\u8f83\u590d\u6742\u7684\u65b9\u6cd5\u6765\u5b9e\u73b0\u7cbe\u786e\u7684 LL/SC \u6a21\u62df\uff0c\u8fd9\u65b9\u9762\u7684\u8bba\u6587\u4e5f\u4e0d\u5c11\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>Kristien, Martin, et al. \"Fast and correct load-link/store-conditional instruction handling in DBT systems.\" IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems 39.11 (2020): 3544-3554.</li> <li>Z. Zhao, Z. Jiang, Y. Chen, X. Gong, W. Wang and P. -C. Yew, \"Enhancing Atomic Instruction Emulation for Cross-ISA Dynamic Binary Translation,\" 2021 IEEE/ACM International Symposium on Code Generation and Optimization (CGO), Seoul, Korea (South), 2021, pp. 351-362, doi: 10.1109/CGO51591.2021.9370312.</li> </ul> <p>\u4f46\u5f88\u9057\u61be\u7684\u662f\uff0c\u8fd9\u4e9b\u5de5\u4f5c\u7684\u6027\u80fd\u90fd\u6ca1\u6709\u8fbe\u5230 CAS \u6a21\u62df\u90a3\u4e48\u597d\uff0c\u6240\u4ee5\u8fd8\u662f\u6ca1\u6709\u88ab QEMU \u91c7\u7528\u3002\u5173\u4e8e QEMU \u4e3a\u4ec0\u4e48\u8981\u91c7\u7528 CAS \u6765\u6a21\u62df LL/SC \u7684\u8ba8\u8bba\uff0c\u53ef\u4ee5\u89c1 cmpxchg-based emulation of atomics\u3002</p>"},{"location":"software/atomic_instructions/#_20","title":"\u7f16\u7a0b\u8bed\u8a00\u652f\u6301","text":"<p>\u76ee\u524d\u5f88\u591a\u7f16\u7a0b\u8bed\u8a00\u90fd\u5185\u7f6e\u4e86\u5bf9\u539f\u5b50\u6307\u4ee4\u7684\u652f\u6301\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>C: C11 \u5f15\u5165\u4e86 stdatomic.h \u5934\u6587\u4ef6</li> <li>C++: C++11 \u5f15\u5165\u4e86 atomic \u5934\u6587\u4ef6</li> <li>Rust\uff1a\u63d0\u4f9b\u4e86 std::sync::atomic</li> </ul> <p>\u6839\u636e\u6307\u4ee4\u96c6\u67b6\u6784\u652f\u6301\u7684\u539f\u5b50\u6307\u4ee4\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7f16\u7a0b\u8bed\u8a00\u7684\u539f\u5b50\u64cd\u4f5c\u4f1a\u88ab\u7ffb\u8bd1\u6210\u5bf9\u5e94\u7684\u6c47\u7f16\u4ee3\u7801\u3002</p>"},{"location":"software/atomic_instructions/#_21","title":"\u5176\u4ed6\u539f\u5b50\u6307\u4ee4","text":"<p>\u4e00\u4e9b\u6307\u4ee4\u96c6\u67b6\u6784\u8fd8\u63d0\u4f9b\u4e86\u5176\u4ed6\u7c7b\u578b\u7684\u539f\u5b50\u6307\u4ee4\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>AArch64 \u63d0\u4f9b\u4e86 64 \u5b57\u8282\u7c92\u5ea6\u7684\u539f\u5b50\u8bfb\u6216\u5199\uff1aLD64B \u4ece\u5185\u5b58\u539f\u5b50\u8bfb\u53d6\u8fde\u7eed 64 \u5b57\u8282\u7684\u6570\u636e\u5230 8 \u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u4e2d\uff1bST64B \u628a\u8fde\u7eed 8 \u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u7684\u503c\u539f\u5b50\u5199\u5165\u5230\u5185\u5b58\u4e2d</li> </ul>"},{"location":"software/atomic_instructions/#_22","title":"\u4e0d\u540c\u6307\u4ee4\u96c6\u67b6\u6784\u5bf9\u539f\u5b50\u6307\u4ee4\u652f\u6301\u7684\u5bf9\u6bd4","text":"ISA LL/SC CAS AMO HTM RISC-V A \u6269\u5c55 Zacas \u6269\u5c55\uff0c\u5e76\u4e14\u652f\u6301\u53cc\u500d\u5bbd\u5ea6 A \u6269\u5c55 \u65e0 LoongArch \u6709\uff0cV1.1 \u652f\u6301\u4e86\u53cc\u500d\u5bbd\u5ea6 \u9700\u8981 V1.1 \u7248\u672c\uff0c\u4e0d\u652f\u6301\u53cc\u500d\u5bbd\u5ea6 \u6709 \u65e0 x86_64 \u65e0 \u6709\uff0c\u5e76\u4e14\u652f\u6301\u53cc\u500d\u5bbd\u5ea6 \u6709 TSX AArch64 \u6709 \u6709\uff0c\u5e76\u4e14\u652f\u6301\u53cc\u500d\u5bbd\u5ea6 \u6709 TME MIPS \u6709\uff0c\u4e5f\u652f\u6301\u53cc\u500d\u5bbd\u5ea6 \u6709\uff0c\u5e76\u4e14\u652f\u6301\u53cc\u500d\u5bbd\u5ea6 \u6709 \u65e0"},{"location":"software/cg/","title":"\u8ba1\u7b97\u673a\u56fe\u5f62\u5b66","text":"<p>\u672c\u6587\u53c2\u8003\u4e86\u5982\u4e0b\u7f51\u7ad9\uff1a</p> <ul> <li>OpenGL Projection Matrix - Song Ho Ahn</li> <li>glOrtho</li> <li>gluPerspective</li> <li>Projection matrices</li> </ul>"},{"location":"software/cg/#_2","title":"\u9f50\u6b21\u5750\u6807","text":"<p>\u9f50\u6b21\u5750\u6807\u662f\u5728 3 \u7ef4\u7684\u5750\u6807 (x, y, z) \u7684\u57fa\u7840\u4e0a\uff0c\u6dfb\u52a0\u4e00\u7ef4\uff0c\u53d8\u6210 (x, y, z, w)\uff0c\u5bf9\u5e94 3 \u7ef4\u7684 (x/w, y/w, z/w)\uff0c\u8fd9\u6837\u505a\u53ef\u4ee5\u65b9\u4fbf\u4e00\u4e9b\u8ba1\u7b97\u3002</p> <p>\u56e0\u6b64\u4ece 3 \u7ef4\u5750\u6807\u8f6c\u6362\u4e3a\u9f50\u6b21\u5750\u6807\u7684\u65f6\u5019\uff0c\u6dfb\u52a0\u4e00\u7ef4 w = 1\uff0c\u53d8\u6210 (x, y, z, 1)\u3002\u4e3a\u4e86\u8ba9 3 \u7ef4\u7684\u5411\u91cf\u548c\u70b9\u5728\u9f50\u6b21\u5750\u6807\u4e0b\u53ef\u4ee5\u8fdb\u884c\u8fd0\u7b97\uff0c\u53ef\u4ee5\u5411 3 \u7ef4\u5411\u91cf\u6dfb\u52a0\u4e00\u7ef4 w=0\uff0c\u6b64\u65f6 w=0 \u8868\u793a\u5411\u91cf\uff0cw \\ne 0 \u8868\u793a\u70b9\u3002</p>"},{"location":"software/cg/#_3","title":"\u5750\u6807\u53d8\u6362","text":"<p>OpenGL \u4e2d\u5750\u6807\u53d8\u6362\u7ecf\u8fc7\u4e86\u5982\u4e0b\u7684\u6b65\u9aa4\uff1a</p> <ol> <li>\u7269\u4f53\u5750\u6807\uff0c4D \u9f50\u6b21\u5750\u6807</li> <li>\u4e58\u4ee5 Model \u548c View \u77e9\u9635\uff0c\u5f97\u5230 4D \u9f50\u6b21\u5750\u6807</li> <li>\u4e58\u4ee5 Projection \u77e9\u9635\uff0c\u5f97\u5230 4D \u9f50\u6b21\u5750\u6807</li> <li>\u628a\u9f50\u6b21\u5750\u6807\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684 3D \u5750\u6807\uff0c\u4e3a Normalized Device Coordinates</li> <li>\u628a 3D \u5750\u6807\u5bf9\u5e94\u5230\u5c4f\u5e55\u4e0a\u7684 2D \u5750\u6807</li> </ol> <p>\u53c2\u8003\uff1aOpenGL Transformation</p>"},{"location":"software/cg/#normalized-device-coordinates","title":"Normalized Device Coordinates","text":"<p>NDC\uff08Normalized Device Coordinates\uff09\u662f\u7ecf\u8fc7\u4e00\u7cfb\u5217\u53d8\u6362\u4ee5\u540e\uff0c\u5f97\u5230\u7684\u6700\u7ec8\u7684 3D \u5750\u6807\u3002</p> <p>\u4ee5 OpenGL \u4e3a\u4f8b\uff0cNDC \u5c31\u662f\u4e00\u4e2a\u5728\u4e09\u4e2a\u5750\u6807\u8f74\u4e0a\u90fd\u5728 [-1, 1] \u4e4b\u95f4\u7684\u7acb\u65b9\u4f53\uff0c\u53ea\u6709\u5728\u8fd9\u4e2a\u7acb\u65b9\u4f53\u4e2d\u7684\u7269\u4f53\u624d\u53ef\u80fd\u88ab\u663e\u793a\u51fa\u6765\u3002</p> <p>NDC \u7684\u5750\u6807\u8303\u56f4\u5728\u4e0d\u540c\u7684\u56fe\u5f62 API \u4e0b\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 OpenGL \u548c WebGL \u662f\u4ece (-1, -1, -1) \u5230 (1, 1, 1)\uff0c\u800c DirectX-12\u3001Metal\u3001Vulkan \u548c WebGPU \u662f\u4ece (-1, -1, 0) \u5230 (1, 1, 1)\uff0c\u4e5f\u5c31\u662f Z \u8f74\u4e0a\u7684\u8303\u56f4\u53ea\u6709 [0, 1]\u3002</p> <p>\u6700\u540e\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\u7684\u65f6\u5019\uff0c\u663e\u793a\u533a\u57df\u7684\u5de6\u4e0b\u89d2\u5c31\u5bf9\u5e94 x=-1, y=-1\uff0c\u53f3\u4e0a\u89d2\u5bf9\u5e94 x=1, y=1\uff08\u4e5f\u53ef\u80fd\u662f\u5de6\u4e0a\u89d2 x=-1, y=-1\uff0c\u53f3\u4e0b\u89d2 x=1, y=1\uff0c\u4e0d\u540c\u7684\u56fe\u5f62 API \u89c4\u5b9a\u4e0d\u540c\uff09\u3002z \u8f74\u5bf9\u5e94\u6df1\u5ea6\uff0c\u663e\u793a\u5728\u524d\u9762\u7684\uff08z \u8f83\u5c0f\u7684\uff09\u4f1a\u906e\u6321\u663e\u793a\u5728\u540e\u9762\u7684\uff08z \u8f83\u5927\u7684\uff09\u3002</p> <p>\u56e0\u6b64 NDC \u5230\u5c4f\u5e55\u5750\u6807\u7684\u5bf9\u5e94\u5173\u7cfb\u662f\uff1a</p> <ol> <li>x \u8f74\uff1a-1 -&gt; x, 1 -&gt; x + w</li> <li>y \u8f74\uff1a-1 -&gt; y, 1 -&gt; y + w</li> <li>z \u8f74\uff1a-1 -&gt; n, 1 -&gt; f</li> </ol> <p>\u5176\u4e2d x, y, w \u548c h \u7528 glViewport \u51fd\u6570\u8bbe\u7f6e\uff0cn \u548c f \u7528 glDepthRange \u8bbe\u7f6e\u3002</p>"},{"location":"software/cg/#_4","title":"\u6b63\u4ea4\u6295\u5f71","text":"<p>\u6b63\u4ea4\u6295\u5f71\u8981\u505a\u7684\u662f\u628a\u4e00\u4e2a\u957f\u65b9\u4f53\u7ebf\u6027\u6620\u5c04\u5230 NDC \u4e2d\uff0c\u4ee5 OpenGL \u4e3a\u4f8b\uff0c\u4e5f\u5c31\u662f\u8981\u6620\u5c04\u5230\u4e09\u4e2a\u7ef4\u5ea6\u4e0a\u90fd\u662f [-1, 1] \u4e4b\u95f4\u7684\u7acb\u65b9\u4f53\u3002</p> <p>\u8fd9\u4e2a\u957f\u65b9\u4f53\u7684\u8fb9\u548c\u5750\u6807\u8f74\u5e73\u884c\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u4ee5\u4e0b\u51e0\u4e2a\u53d8\u91cf\u6765\u5b9a\u4e49\u957f\u65b9\u4f53\u7684\u5750\u6807\uff1a</p> <ol> <li>left, right, top, bottom\uff1a\u5b9a\u4e49\u4e86\u957f\u65b9\u4f53\u4e0a\u5e73\u884c\u4e8e X-Y \u5c4f\u5e55\u7684\u9762\u7684\u4f4d\u7f6e\uff0c\u5176\u4e2d left \u548c right \u5c31\u662f X \u8f74\u4e0a\u7684\u6700\u5c0f\u503c\u548c\u6700\u5927\u503c\uff0cbottom \u548c top \u5c31\u662f Y \u8f74\u4e0a\u7684\u6700\u5c0f\u503c\u548c\u6700\u5927\u503c</li> <li>near\uff0cfar\uff1a\u5b9a\u4e49\u4e86\u957f\u65b9\u4f53\u5728 Z \u8f74\u4e0a\u7684\u533a\u95f4\uff0c\u79bb\u539f\u70b9\u6700\u8fd1\u7684\u5e73\u9762\u7684 Z \u503c\u662f <code>-near</code>\uff0c\u6700\u8fdc\u7684\u5e73\u9762\u7684 Z \u503c\u662f <code>-far</code></li> </ol> <p>\u4e0b\u9762\u7528\u8fd9\u4e9b\u5750\u6807\u7684\u9996\u5b57\u6bcd\u6765\u7b80\u79f0\uff1al \u4ee3\u8868 left\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002</p> <p>\u76ee\u6807\u662f\u628a\u8fd9\u4e2a\u957f\u65b9\u4f53\u6620\u5c04\u5230 [-1, 1] \u7684\u7acb\u65b9\u4f53\u4e0a\u3002</p> <p>\u9996\u5148\u8003\u8651 X \u8f74\uff1a\u8981\u7ebf\u6027\u5730\u628a x=l \u6620\u5c04\u5230 x=-1\uff0c\u628a x=r \u6620\u5c04\u5230 x=1\uff0c\u53ef\u4ee5\u5f97\u5230 x' = \\frac{2}{r-l}x-\\frac{r+l}{r-l}\u3002</p> <p>\u540c\u7406\uff0cY \u5750\u6807\u7684\u8ba1\u7b97\u516c\u5f0f\u662f y' = \\frac{2}{t-b}y-\\frac{t+b}{t-b}\u3002</p> <p>Z \u8f74\u4e0a\u591a\u4e86\u4e00\u4e2a\u8d1f\u53f7\uff1a\u7ebf\u6027\u5730\u628a z=-n \u6620\u5c04\u5230 z=-1\uff0c\u628a z=-f \u6620\u5c04\u5230 z=1\uff0c\u5f97\u5230 z' = \\frac{-2}{f-n}z-\\frac{f+n}{f-n}\u3002</p> <p>\u6ce8\uff1a\u5982\u679c NDC \u7684 Z \u8f74\u8303\u56f4\u662f [0, 1]\uff0c\u90a3\u4e48 Z \u8f74\u7684\u8ba1\u7b97\u516c\u5f0f\u5c31\u662f z' = \\frac{-1}{f-n}z-\\frac{n}{f-n}</p> <p>\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\uff1a</p> \\begin{align} x' = \\frac{2}{r-l}x-\\frac{r+l}{r-l} \\\\ y' = \\frac{2}{t-b}y-\\frac{t+b}{t-b} \\\\ z' = \\frac{-2}{f-n}z-\\frac{f+n}{f-n} \\end{align} <p>\u8003\u8651\u5230\u5b9e\u9645\u91c7\u7528\u7684\u662f\u9f50\u6b21\u5750\u6807\u7cfb\uff0cw \u4e0d\u53d8\uff0c\u6240\u4ee5 w' = w\u3002\u628a\u4e0a\u9762\u7684\u7b49\u5f0f\u5199\u6210\u77e9\u9635\u7684\u5f62\u5f0f\uff0c\u5c31\u662f\uff1a</p>  \\begin{pmatrix} \\frac{2}{r-l} &amp; 0 &amp; 0 &amp; -\\frac{r+l}{r-l} \\\\ 0 &amp; \\frac{2}{t-b} &amp; 0 &amp; -\\frac{t+b}{t-b} \\\\ 0 &amp; 0 &amp; \\frac{-2}{f-n} &amp; -\\frac{f+n}{f-n} \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}  <p>\u8fd9\u6b63\u662f OpenGL \u6b63\u4ea4\u6295\u5f71\u51fd\u6570 glOrtho() \u6240\u8ba1\u7b97\u7684\u77e9\u9635\uff1a</p>    ![](cg_glortho.png){ width=\"300\" }   \u6b63\u4ea4\u6295\u5f71\u77e9\u9635\uff08\u56fe\u6e90 glOrtho\uff09 <p>mesa \u4e2d\u7684\u5b9e\u73b0\uff1a</p> <pre><code>// Source: https://github.com/Mesa3D/mesa/blob/957009978ef6d7121fc0d710d03bc20097d4d46b/src/mesa/math/m_matrix.c#L813C1-L840\nvoid\n_math_float_ortho(float *m,\n                  float left, float right,\n                  float bottom, float top,\n                  float nearval, float farval)\n{\n#define M(row,col)  m[col*4+row]\n   M(0,0) = 2.0F / (right-left);\n   M(0,1) = 0.0F;\n   M(0,2) = 0.0F;\n   M(0,3) = -(right+left) / (right-left);\n\n   M(1,0) = 0.0F;\n   M(1,1) = 2.0F / (top-bottom);\n   M(1,2) = 0.0F;\n   M(1,3) = -(top+bottom) / (top-bottom);\n\n   M(2,0) = 0.0F;\n   M(2,1) = 0.0F;\n   M(2,2) = -2.0F / (farval-nearval);\n   M(2,3) = -(farval+nearval) / (farval-nearval);\n\n   M(3,0) = 0.0F;\n   M(3,1) = 0.0F;\n   M(3,2) = 0.0F;\n   M(3,3) = 1.0F;\n#undef M\n}\n</code></pre>"},{"location":"software/cg/#_5","title":"\u900f\u89c6\u6295\u5f71","text":"<p>\u900f\u89c6\u6295\u5f71\u8981\u505a\u7684\u662f\u628a\u4e00\u4e2a\u56db\u68f1\u53f0\uff08Square Frustum\uff0c\u56db\u68f1\u9525\u6c34\u5e73\u5207\u5f00\uff0c\u5e95\u9762\u548c\u9876\u9762\u662f\u6b63\u65b9\u5f62\uff0c\u5176\u4f59\u56db\u4e2a\u9762\u90fd\u662f\u68af\u5f62\uff09\u6620\u5c04\u5230 NDC \u4e0a\u3002\u5176\u4e2d\u56db\u68f1\u53f0\u7684\u56db\u6761\u68f1\u5ef6\u957f\u4ee5\u540e\uff0c\u4ea4\u4e8e\u539f\u70b9\u3002\u4e5f\u5c31\u662f\u8bf4\u7126\u70b9\u5c31\u662f\u5750\u6807\u8f74\u7684\u539f\u70b9\u3002</p> <p>\u76f8\u6bd4\u6b63\u4ea4\u6295\u5f71\uff0c\u900f\u89c6\u6295\u5f71\u6700\u5927\u7684\u4e0d\u540c\u5728\u4e8e\u5b83\u8fd1\u5927\u8fdc\u5c0f\u7684\u7279\u6027\uff0c\u66f4\u52a0\u8d34\u8fd1\u5b9e\u9645\uff1a\u6b63\u4ea4\u6295\u5f71\u65e0\u8bba\u6df1\u5ea6\u591a\u5c11\uff0c\u770b\u5230\u7684\u7269\u4f53\u5927\u5c0f\u4e0d\u53d8\uff1b\u800c\u5728\u900f\u89c6\u6295\u5f71\u4e2d\uff0c\u4ece\u539f\u70b9\u51fa\u53d1\uff0c\u5230 near \u5e73\u9762\u4e0a\u7684\u4e00\u70b9\u8fde\u6210\u5c04\u7ebf\uff0c\u8fd9\u6761\u5c04\u7ebf\u4e0a\u7684\u70b9\u90fd\u5bf9\u5e94\u540c\u4e00\u4e2a\u5c4f\u5e55\u4e0a\u7684\u70b9\uff0c\u56e0\u6b64\u8fdc\u7684\u7269\u4f53\u5728\u5c4f\u5e55\u4e0a\u770b\u7684\u5c0f\uff0c\u8fd1\u7684\u7269\u4f53\u5728\u5c4f\u5e55\u4e0a\u770b\u5f97\u5927\u3002</p> <p>\u56e0\u6b64\u5728\u5b9e\u73b0\u900f\u89c6\u6295\u5f71\u7684\u65f6\u5019\uff0c\u5c31\u8981\u5229\u7528\u8fd9\u6761\u4ece\u539f\u70b9\u51fa\u53d1\u5230 near \u5e73\u9762\u7684\u4e00\u70b9\u7684\u5c04\u7ebf\uff1a\u7531\u4e8e\u8fd9\u6761\u5c04\u7ebf\u4e0a\u7684\u70b9\u90fd\u5bf9\u5e94\u5c4f\u5e55\u4e0a\u540c\u4e00\u4e2a\u70b9\uff0c\u56e0\u6b64\u5728 NDC \u4e2d\u4e5f\u5bf9\u5e94\u540c\u4e00\u4e2a (x', y') \u5750\u6807\u3002\u90a3\u4e48\uff0c\u5728\u8ba1\u7b97 x' \u548c y' \u7684\u65f6\u5019\uff0c\u5148\u5229\u7528\u76f8\u4f3c\u4e09\u89d2\u5f62\u5173\u7cfb\uff0c\u628a\u70b9\u6620\u5c04\u5230 near \u5e73\u9762\u4e0a\uff08near \u5e73\u9762\u7684 Z \u5750\u6807\u662f z=-n\uff09\uff1a</p> \\begin{align} \\frac{x'}{x} = \\frac{-n}{z} \\\\ \\frac{y'}{y} = \\frac{-n}{z} \\end{align} <p>\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u56db\u68f1\u53f0\u5230\u957f\u65b9\u4f53\u7684\u6620\u5c04\uff0c\u4f46\u662f\u8fd9\u91cc\u6d89\u53ca\u5230\u5bf9 z \u7684\u9664\u6cd5\u8fd0\u7b97\uff0c\u4e3a\u4e86\u5728\u77e9\u9635\u4e2d\u5b9e\u73b0\u9488\u5bf9 z \u7684\u9664\u6cd5\u8fd0\u7b97\uff0c\u9700\u8981\u5229\u7528\u9f50\u6b21\u5750\u6807\u81ea\u5e26\u7684\u9664\u6cd5\uff1a(x, y, z, w) \\to (x/w, y/w, z/w)\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u628a z \u7684\u503c\u632a\u5230 w \u4e0a\uff0c\u5c31\u76f8\u5f53\u4e8e\u5b9e\u73b0\u4e86\u9664\u6cd5\u3002\u6309\u7167\u8fd9\u4e2a\u601d\u8def\uff0c\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u7684\u77e9\u9635\uff1a</p>  \\begin{pmatrix} n &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; n &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; A &amp; B \\\\ 0 &amp; 0 &amp; -1 &amp; 0 \\end{pmatrix}  <p>\u5176\u4e2d A \u548c B \u662f\u672a\u77e5\u6570\u3002\u9a8c\u8bc1\u4e00\u4e0b\u4e0a\u9762\u7684\u77e9\u9635\u662f\u5426\u5b9e\u73b0\u4e86\u9664\u6cd5\uff1a</p> <p>\u9996\u5148\u662f\u751f\u6210\u9f50\u6b21\u5750\u6807\uff1a</p>  (x, y, z) \\to (x, y, z, 1)  <p>\u77e9\u9635\u53d8\u6362\u4ee5\u540e\uff1a</p> \\begin{align} x' &amp;= nx \\\\ y' &amp;= ny \\\\ z' &amp;= Az + B \\\\ w' &amp;= -z \\end{align} <p>\u518d\u4ece\u9f50\u6b21\u5750\u6807\u53d8\u56de\u6765\uff0c\u5f97\u5230 (-\\frac{nx}{z}, -\\frac{ny}{z}, -A-\\frac{B}{z})\u3002\u53ef\u4ee5\u770b\u5230\uff0cx \u548c y \u90fd\u5f97\u5230\u4e86\u548c\u524d\u9762\u7528\u76f8\u4f3c\u4e09\u89d2\u5f62\u8ba1\u7b97\u51fa\u6765\u4e00\u6837\u7684\u7ed3\u679c\uff0c\u4f46\u662f z \u7684\u503c\u51fa\u73b0\u4e86\u53d8\u5316\u3002\u4f46\u662f\u6ca1\u6709\u5173\u7cfb\uff0c\u867d\u7136 z \u7684\u503c\u53d8\u4e86\uff0c\u4f46\u662f\u5b83\u4f9d\u7136\u662f\u4fdd\u5e8f\u7684\uff0c\u53ea\u9700\u8981\u7ee7\u7eed\u4fdd\u8bc1\u5b83\u5728 [-f, -n] \u8303\u56f4\u5373\u53ef\uff1a</p> \\begin{align} -n = -A-\\frac{B}{-n} \\\\ -f = -A-\\frac{B}{-f} \\end{align} <p>\u6c42\u89e3\u53ef\u5f97 A=n+f, B=-nf\uff0c\u56e0\u6b64\u524d\u9762\u7684\u77e9\u9635\u5c31\u662f\uff1a</p>  \\begin{pmatrix} n &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; n &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; n+f &amp; -nf \\\\ 0 &amp; 0 &amp; -1 &amp; 0 \\end{pmatrix}  <p>\u5230\u8fd9\u4e00\u6b65\uff0c\u5c31\u5b8c\u6210\u4e86\u56db\u68f1\u53f0\u5230\u957f\u65b9\u4f53\u7684\u6620\u5c04\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u6b63\u4ea4\u6295\u5f71\u4e86\uff0c\u628a\u957f\u65b9\u4f53\u6620\u5c04\u5230 NDC \u4e0a\uff0c\u56e0\u6b64\u6700\u7ec8\u6574\u4f53\u7684\u6295\u5f71\u77e9\u9635\u5c31\u662f\u628a\u4e24\u4e2a\u77e9\u9635\u4e58\u8d77\u6765\uff08\u6b63\u4ea4\u6295\u5f71\u77e9\u9635\u5de6\u4e58\u4e0a\u9762\u7684\u77e9\u9635\uff09\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</p>  \\begin{pmatrix} \\frac{2}{r-l} &amp; 0 &amp; 0 &amp; -\\frac{r+l}{r-l} \\\\ 0 &amp; \\frac{2}{t-b} &amp; 0 &amp; -\\frac{t+b}{t-b} \\\\ 0 &amp; 0 &amp; \\frac{-2}{f-n} &amp; -\\frac{f+n}{f-n} \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix} \\cdot \\begin{pmatrix} n &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; n &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; n+f &amp; -nf \\\\ 0 &amp; 0 &amp; -1 &amp; 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{2n}{r-l} &amp; 0 &amp; \\frac{r+l}{r-l} &amp; 0 \\\\ 0 &amp; \\frac{2n}{t-b} &amp; \\frac{t+b}{t-b} &amp; 0 \\\\ 0 &amp; 0 &amp; -\\frac{n+f}{f-n} &amp; \\frac{-2nf}{f-n} \\\\ 0 &amp; 0 &amp; -1 &amp; 0 \\end{pmatrix}  <p>\u8fd9\u5c31\u662f\u6700\u7ec8\u7684\u900f\u89c6\u6295\u5f71\u7684\u77e9\u9635\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5b83\u5047\u8bbe\u4e86\u8f93\u5165\u7684\u5750\u6807\u7684 w=1\uff0c\u5982\u679c\u8f93\u5165\u7684\u9f50\u6b21\u5750\u6807\u7684 w \\ne 1\uff0c\u8ba1\u7b97\u7ed3\u679c\u5c31\u4f1a\u6709\u95ee\u9898\u3002\u5728 OpenGL \u4e2d\uff0c\u53ef\u4ee5\u7528 gluPerspective() \u51fd\u6570\u5f97\u5230\u5b83\uff1a</p>    ![](cg_gluperspective.png){ width=\"300\" }   \u900f\u89c6\u6295\u5f71\u77e9\u9635\uff08\u56fe\u6e90 gluPerspective\uff09 <p>\u548c\u4e0a\u9762\u7684\u7ed3\u679c\u770b\u4f3c\u4e0d\u540c\uff0c\u4f46\u53ea\u8981\u8bbe\u5b9a r=-l, t=-b, f=\\frac{n}{t}, aspect=\\frac{r}{t}\uff0c\u4e24\u4e2a\u77e9\u9635\u5c31\u662f\u4e00\u6837\u7684\u3002\u4e5f\u5c31\u662f\u8bf4 gluPerspective \u91c7\u7528\u4e86\u900f\u89c6\u6295\u5f71\u7684\u7279\u6b8a\u60c5\u51b5\uff1a\u5de6\u53f3\u548c\u4e0a\u4e0b\u5bf9\u79f0\u3002</p> <p>\u5176\u4e2d aspect \u662f\u957f\u5bbd\u6bd4\uff08x \u8f74\u9664\u4ee5 y \u8f74\uff09\uff1bf=cot(\\frac{fovy}{2}) \u662f\u8fd9\u4e48\u63a8\u5bfc\u7684\uff1ay \u65b9\u5411\u4e0a\u7684\u89c6\u91ce\u89d2\u5ea6\u4e0a\u4e0b\u5bf9\u79f0\uff0c\u89d2\u5ea6\u5927\u5c0f\u662f fovy\uff0c\u90a3\u4e48\u5728\u6c34\u5e73\u7ebf\u4e0a\u65b9\u7684\u89d2\u5ea6\u5c31\u662f \\frac{fovy}{2}\uff0c\u800c\u8fd9\u4e2a\u89d2\u5ea6\u5728\u4e09\u89d2\u5f62\u4e2d\uff0c\u5b83\u7684\u5bf9\u8fb9\u662f t\uff0c\u90bb\u8fb9\u662f n\uff0c\u6240\u4ee5 tan(\\frac{fovy}{2})=\\frac{t}{n}\uff0c\u53cd\u8fc7\u6765\u5c31\u5f97\u5230 f=\\frac{n}{t}=cot(\\frac{fovy}{2})\u3002</p> <p>\u66f4\u52a0\u901a\u7528\u7684 OpenGL \u51fd\u6570\u662f glFrustum\uff0c\u5b83\u5f97\u5230\u7684\u77e9\u9635\u548c\u4e0a\u9762\u63a8\u5bfc\u51fa\u6765\u7684\u77e9\u9635\u662f\u4e00\u6837\u7684\uff0c\u6ca1\u8003\u8651\u7279\u6b8a\u60c5\u51b5\u3002</p> <p>mesa \u4e2d\u7684\u5b9e\u73b0\uff1a</p> <pre><code>// Source: https://github.com/Mesa3D/mesa/blob/957009978ef6d7121fc0d710d03bc20097d4d46b/src/mesa/math/m_matrix.c#L773-L797\nvoid\n_math_matrix_frustum( GLmatrix *mat,\n              GLfloat left, GLfloat right,\n              GLfloat bottom, GLfloat top,\n              GLfloat nearval, GLfloat farval )\n{\n   GLfloat x, y, a, b, c, d;\n   GLfloat m[16];\n\n   x = (2.0F*nearval) / (right-left);\n   y = (2.0F*nearval) / (top-bottom);\n   a = (right+left) / (right-left);\n   b = (top+bottom) / (top-bottom);\n   c = -(farval+nearval) / ( farval-nearval);\n   d = -(2.0F*farval*nearval) / (farval-nearval);  /* error? */\n\n#define M(row,col)  m[col*4+row]\n   M(0,0) = x;     M(0,1) = 0.0F;  M(0,2) = a;      M(0,3) = 0.0F;\n   M(1,0) = 0.0F;  M(1,1) = y;     M(1,2) = b;      M(1,3) = 0.0F;\n   M(2,0) = 0.0F;  M(2,1) = 0.0F;  M(2,2) = c;      M(2,3) = d;\n   M(3,0) = 0.0F;  M(3,1) = 0.0F;  M(3,2) = -1.0F;  M(3,3) = 0.0F;\n#undef M\n\n   matrix_multf( mat, m, MAT_FLAG_PERSPECTIVE );\n}\n</code></pre>"},{"location":"software/cg/#view","title":"View \u77e9\u9635","text":"<p>OpenGL \u4e2d\uff0c\u7ecf\u8fc7 Model \u548c View \u77e9\u9635\u6620\u5c04\u540e\u5f97\u5230 Eye Coordinates\uff0c\u76f8\u673a\u4f4d\u4e8e (0, 0, 0)\uff0c\u4e14\u770b\u5411 -Z \u8f74\u7684\u65b9\u5411\u3002\u8ba1\u7b97\u76f8\u673a View \u77e9\u9635\u7684 OpenGL \u51fd\u6570\u662f gluLookAt\u3002</p> <p>\u5728\u6620\u5c04\u4e4b\u524d\uff0c\u76f8\u673a\u4f4d\u4e8e\u4e16\u754c\u5750\u6807\u7684 (eyeX, eyeY, eyeZ)\uff0c\u89c6\u7ebf\u770b\u5411 (centerX, centerY, centerZ) \u70b9\uff08\u89c6\u91ce\u6b63\u524d\u65b9\uff09\uff0c\u4ee5\u53ca\u89c6\u91ce\u91cc\u5411\u4e0a\u7684\u65b9\u5411\u5728 3D \u91cc\u7684\u5411\u91cf (upX, upY, upZ)\uff08\u89c6\u91ce\u7684\u4e0a\u65b9\uff0cy \u8f74\uff09\u3002</p> <p>\u90a3\u4e48\u76f8\u673a\u6b63\u5bf9\u7684\u5411\u91cf F=(centerX-eyeX, centerY-eyeY, centerZ-eyeZ)\uff0c\u8fd9\u4e2a\u65b9\u5411\u5728\u6620\u5c04\u540e\u7684\u5750\u6807\u7cfb\u4e2d\u5c31\u662f -Z \u8f74\u3002\u4ee4 UP=(upX, upY, upZ)\uff0cUP \u6700\u7ec8\u5728\u89c6\u91ce\u91cc\u770b\u5230\u7684\u662f\u6cbf y \u8f74\u5411\u4e0a\uff0c\u4f46\u662f\u6620\u5c04\u4ee5\u540e\u53ef\u80fd\u4f1a\u6709 z \u7684\u5206\u91cf\uff0c\u4e5f\u5c31\u662f F \u548c UP \u4e0d\u4e00\u5b9a\u5782\u76f4\uff0c\u540e\u9762\u9700\u8981\u8003\u8651\u8fd9\u4e00\u70b9\u3002</p>    ![](cg_axis_3d.png){ width=\"300\" }   \u76f8\u673a\u7684 eye\uff0cup \u548c center \u793a\u610f\u56fe\uff0c\u5176\u4e2d up \u5728 Y-Z \u5e73\u9762\u5185    ![](cg_axis_2d.png){ width=\"300\" }   center \u548c up \u5bf9\u5e94\u5c4f\u5e55\u7684\u4f4d\u7f6e <p>\u5bf9 F \u8fdb\u884c\u6807\u51c6\u5316\uff0c\u5f97\u5230 f\uff1b\u5bf9 UP \u8fdb\u884c\u6807\u51c6\u5316\uff0c\u5f97\u5230 u\uff1b\u7531\u4e8e u \u548c f \u786e\u5b9a\u4e86 Y-Z \u5e73\u9762\uff0c\u6240\u4ee5\u6c42 X \u65b9\u5411\u7684\u5411\u91cf\uff0c\u76f4\u63a5\u8ba1\u7b97\u53c9\u79ef\u5373\u53ef\uff1as = f \\times u\uff0c\u7531\u4e8e f \u6307\u5411 -Z\uff0cu \u5728 Y-Z \u5e73\u9762\u4e2d Y \u4e3a\u6b63\u7684\u534a\u5e73\u9762\uff0c\u6240\u4ee5\u5f97\u5230\u7684 s \u6307\u5411\u7684\u662f\u5c4f\u5e55\u7684\u53f3\u4fa7\uff0c\u4e0d\u59a8\u89c4\u5b9a\u53f3\u4fa7\u662f X \u6b63\u534a\u8f74\uff08\u53f3\u624b\u7cfb\uff09\u3002\u6b64\u65f6\u518d\u53c9\u79ef\uff0c\u5f97\u5230 Y \u8f74\u7684\u65b9\u5411\uff1ay = s \\times f\u3002</p>    ![](cg_axis_cross.png){ width=\"300\" }   s \u548c y \u5411\u91cf\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u56fe\u4e2d\u6ca1\u6709\u4f53\u73b0\u5411\u91cf\u7684\u957f\u5ea6 <p>\u6b64\u65f6\u4e09\u4e2a\u8f74\u4e0a\u7684\u5411\u91cf\u90fd\u6709\u4e86\uff1aX \u8f74\u6b63\u65b9\u5411\u662f s\uff0cY \u8f74\u6b63\u65b9\u5411\u662f y\uff0cZ \u8f74\u8d1f\u65b9\u5411\u662f f\u3002\u7531\u4e8e\u53c9\u79ef\u4ee5\u524d\u5df2\u7ecf\u505a\u4e86\u6807\u51c6\u5316\uff0c\u6240\u4ee5\u8fd9\u4e09\u4e2a\u5411\u91cf\u90fd\u662f\u5355\u4f4d\u5411\u91cf\u3002\u90a3\u4e48\u5750\u6807\u7cfb\u7684\u53d8\u6362\u77e9\u9635\u5e94\u8be5\u5b9e\u73b0\u4e0b\u9762\u7684\u6620\u5c04\uff1a</p> <ul> <li>Ms = M(s_x, s_y, s_z)^T = (1, 0, 0)^T</li> <li>My = M(y_x, y_y, y_z)^T = (0, 1, 0)^T</li> <li>Mz = M(f_x, f_y, f_z)^T = (0, 0, -1)^T</li> </ul> <p>\u4e8e\u662f\uff1a</p>  M=\\begin{pmatrix} s_x &amp; s_y &amp; s_z \\\\ y_x &amp; y_y &amp; y_z \\\\ -f_x &amp; -f_y &amp; -f_z \\\\ \\end{pmatrix}  <p>\u8fd9\u91cc\u4f9d\u8d56\u4e86\u4e09\u4e2a\u5411\u91cf s y -f \u90fd\u662f\u5355\u4f4d\u5411\u91cf\uff0c\u4e14\u4e92\u76f8\u6b63\u4ea4\u7684\u6027\u8d28\u3002</p> <p>\u628a\u9f50\u6b21\u5750\u6807\u7684 w \u7ef4\u5ea6\u52a0\u56de\u6765\uff0c\u5c31\u662f\uff1a</p>  M=\\begin{pmatrix} s_x &amp; s_y &amp; s_z &amp; 0 \\\\ y_x &amp; y_y &amp; y_z &amp; 0 \\\\ -f_x &amp; -f_y &amp; -f_z &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}  <p>\u4ee5\u4e0a\u77e9\u9635\u89e3\u51b3\u4e86\u76f8\u673a\u5750\u6807\u7cfb\u7684\u95ee\u9898\uff0c\u5269\u4e0b\u5c31\u662f\u628a\u5750\u6807 (eyeX, eyeY, eyeZ) \u632a\u5230 (0, 0, 0) \u4e0a\uff1a</p>  M=\\begin{pmatrix} s_x &amp; s_y &amp; s_z &amp; 0 \\\\ y_x &amp; y_y &amp; y_z &amp; 0 \\\\ -f_x &amp; -f_y &amp; -f_z &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix} \\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; -\\mathrm{eyeX} \\\\ 0 &amp; 1 &amp; 0 &amp; -\\mathrm{eyeY} \\\\ 0 &amp; 0 &amp; 1 &amp; -\\mathrm{eyeZ} \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}  <p>\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u5b8c\u6574\u7684 View \u77e9\u9635\u3002</p> <p>mesa \u4e2d\u7684\u5b9e\u73b0\uff1a</p> <pre><code>// Source: https://gitlab.freedesktop.org/mesa/mesa/-/blob/c6a80dc32ef17bc972d4137ce7444ebed4d28ebb/src/glu/sgi/libutil/project.c#L108\n// Comments added\nvoid gluLookAt(GLdouble eyex, GLdouble eyey, GLdouble eyez, GLdouble centerx,\n    GLdouble centery, GLdouble centerz, GLdouble upx, GLdouble upy,\n    GLdouble upz)\n{\n    float forward[3], side[3], up[3];\n    GLfloat m[4][4];\n\n    /* Compute f = center - eye */\n    forward[0] = centerx - eyex;\n    forward[1] = centery - eyey;\n    forward[2] = centerz - eyez;\n\n    up[0] = upx;\n    up[1] = upy;\n    up[2] = upz;\n\n    normalize(forward);\n\n    /* Side = forward x up */\n    cross(forward, up, side);\n    normalize(side);\n\n    /* Recompute up as: up = side x forward */\n    cross(side, forward, up);\n\n    __gluMakeIdentityf(&amp;m[0][0]);\n\n    /* s_x s_y s_z */\n    m[0][0] = side[0];\n    m[1][0] = side[1];\n    m[2][0] = side[2];\n\n    /* y_x y_y y_z */\n    m[0][1] = up[0];\n    m[1][1] = up[1];\n    m[2][1] = up[2];\n\n    /* -f_x -f_y -f_z */\n    m[0][2] = -forward[0];\n    m[1][2] = -forward[1];\n    m[2][2] = -forward[2];\n\n    /* Update view matrix */\n    glMultMatrixf(&amp;m[0][0]);\n    glTranslated(-eyex, -eyey, -eyez);\n}\n</code></pre>"},{"location":"software/cg/#_6","title":"\u5149\u7ebf\u8ffd\u8e2a","text":"<p>Whitted-style ray-tracing \u662f\u4e00\u79cd\u5178\u578b\u7684\u5149\u7ebf\u8ffd\u8e2a\u7b97\u6cd5\uff0c\u5b83\u7684\u5b9e\u73b0\u601d\u8def\u662f\uff1a</p> <ol> <li>\u5bf9\u4e8e\u8981\u7ed8\u5236\u5728\u5c4f\u5e55\u4e0a\u7684\u70b9\uff0c\u8ba1\u7b97\u5b83\u5728 3 \u7ef4\u7a7a\u95f4\u4e2d\u7684\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u4e0e\u76f8\u673a\u7684\u539f\u70b9\u6784\u6210\u4e00\u4e2a\u5c04\u7ebf</li> <li>\u8ba1\u7b97\u5c04\u7ebf\u4e0e\u573a\u666f\u4e2d\u8868\u9762\u7684\u7b2c\u4e00\u4e2a\u4ea4\u70b9\uff0c\u6839\u636e\u8868\u9762\u7684\u7c7b\u578b\u8fdb\u884c\u4e0d\u540c\u7684\u5904\u7406\uff1a<ol> <li>\u6f2b\u53cd\u5c04\uff08Diffuse\uff09\uff1a\u627e\u5230\u6240\u6709\u7684\u5149\u6e90\uff0c\u627e\u51fa\u90a3\u4e9b\u53ef\u4ee5\u7167\u4eae\u4ea4\u70b9\u7684\u5149\u6e90\uff08\u5149\u6e90\u5230\u4ea4\u70b9\u4e4b\u95f4\u6ca1\u6709\u906e\u6321\uff09\uff0c\u8ba1\u7b97\u51fa\u5149\u6e90\u5bf9\u8fd9\u4e00\u70b9\u7684\u8d21\u732e</li> <li>\u955c\u9762\u53cd\u5c04\uff08Specular\uff09\uff1a\u8ba1\u7b97\u51fa\u53cd\u5c04\u5149\uff0c\u628a\u53cd\u5c04\u5149\u5f53\u6210\u89c6\u7ebf\uff0c\u7ee7\u7eed\u9012\u5f52</li> <li>\u955c\u9762\u53cd\u5c04 + \u6298\u5c04\uff08Refraction\uff09\uff1a\u5206\u522b\u8ba1\u7b97\u51fa\u53cd\u5c04\u5149\u548c\u6298\u5c04\u5149\uff0c\u5206\u522b\u9012\u5f52\u7136\u540e\u6309\u7167 Fresnel \u65b9\u7a0b\u52a0\u6743\u6c42\u548c</li> </ol> </li> </ol> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6240\u6709\u7684\u5149\u7ebf\u5728\u9012\u5f52\u7ec8\u6b62\u7684\u65f6\u5019\uff0c\u8981\u4e48\u662f\u5728\u6f2b\u53cd\u5c04\u8868\u9762\u4e0a\uff0c\u8981\u4e48\u5c31\u662f\u6ca1\u6709\u627e\u5230\u76f8\u4ea4\u7684\u8868\u9762\u3002</p>"},{"location":"software/cg/#_7","title":"\u8f90\u5c04\u5ea6\u91cf\u5b66","text":"<p>\u53c2\u8003 \u8def\u5f84\u8ffd\u8e2a\uff08Path Tracing\uff09\u4e0e\u6e32\u67d3\u65b9\u7a0b (Render Equation) \u548c GAMES101 Lecture 15\uff1a</p> <ul> <li>Radiant energy Q\uff1a\u5149\u6e90\u5411\u7a7a\u95f4\u4e2d\u8f90\u5c04\u7684\u80fd\u91cf\uff0c\u5355\u4f4d\u662f J</li> <li>Radiant flux(power) \\Phi\uff1a\u5149\u6e90\u5728\u5355\u4f4d\u65f6\u95f4\u5185\u5411\u7a7a\u95f4\u4e2d\u8f90\u5c04\u7684\u80fd\u91cf\uff0c\u5355\u4f4d\u662f W</li> <li>Solid angle \\omega\uff1a\u7acb\u4f53\u89d2\uff0c\u5355\u4f4d\u662f steradian/square radian \u7403\u9762\u5ea6\uff0c\u7b80\u5199 sr\uff1b\u662f\u5728\u7403\u9762\u4e0a\u4e00\u4e2a\u5c0f\u5e73\u9762\u7684\u9762\u79ef\u9664\u4ee5\u534a\u5f84\u7684\u5e73\u65b9\uff0c\u5373 \\omega=A/r^2</li> <li>Radiant intensity I\uff1a\u5149\u6e90\u5728\u5355\u4f4d\u7acb\u4f53\u89d2\u5185\u7684 Radiant flux\uff0c\u5355\u4f4d\u662f W/sr</li> <li>Irradiance E\uff1a\u5355\u4f4d\u9762\u79ef\u63a5\u53d7\u5230\u7684 Radiant flux\uff0c\u5373 E=\\Phi/A\uff0c\u5355\u4f4d\u662f W/m^2</li> <li>Radiance L\uff1a\u5355\u4f4d\u9762\u79ef\u4e0b\uff0c\u63a5\u6536\u5230\u6765\u81ea\u5355\u4f4d\u7acb\u4f53\u89d2\u7684 Radiant flux\uff0c\u5355\u4f4d\u662f W/sr \\cdot m^2</li> </ul>"},{"location":"software/cg/#rendering-equation","title":"Rendering equation","text":"<p>\u53c2\u8003 GAMES101 Lecture 15\uff1a</p>  L_o(p, \\omega_o) = L_e(p, \\omega_o) + \\int_{\\Omega} L_i(p, \\omega_i) f_r(p, \\omega_i, \\omega_o) (n \\cdot \\omega_i) \\mathrm{d} \\omega_i  <p>\u542b\u4e49\uff1a\u4ece\u5e73\u9762\u4e0a\u7684 p \u70b9\u51fa\u53d1\uff0c\u5411 \\omega_r \u53d1\u5c04\u7684 Radiance \u5305\u62ec\u4e24\u90e8\u5206\uff1a</p> <ol> <li>L_e(p, \\omega_o)\uff1a\u8fd9\u4e2a\u70b9\u672c\u8eab\u53d1\u7684\u5149\uff0c\u4f8b\u5982\u5149\u6e90</li> <li>\\int_{\\Omega} L_i(p, \\omega_i) f_r(p, \\omega_i, \\omega_o) (n \\cdot \\omega_i) \\mathrm{d} \\omega_i\uff1a\u8003\u8651\u534a\u7403\u9762\u4e0a\u7684\u4efb\u610f\u4e00\u4e2a\u5165\u5c04\u65b9\u5411 \\omega_i\uff0c\u8fd9\u4e2a\u65b9\u5411\u4e0a\u5165\u5c04\u5230 p \u70b9\u7684 Radiance \u662f L_i(p, \\omega_i)\uff0c\u5176\u4e2d\u6709\u4e00\u5b9a\u6bd4\u4f8b\u4f1a\u53cd\u5c04\u5230 \\omega_o \u65b9\u5411\u4e0a\uff0c\u8fd9\u4e2a\u6bd4\u4f8b\u5c31\u662f BRDF f_r(p, \\omega_i, \\omega_o)\uff0c\u6700\u540e\u7531\u4e8e\u5165\u5c04\u65b9\u5411\u548c\u5e73\u9762\u7684\u6cd5\u65b9\u5411\u6709\u4e00\u4e2a\u5939\u89d2 \\theta\uff0c\u6839\u636e Lambert's Cosine Law\uff0c\u9700\u8981\u4e58\u4e0a \\cos \\theta = n \\cdot \\omega_i \u9879\u3002</li> </ol>"},{"location":"software/cg/#bidirectional-reflectance-distribution-function","title":"Bidirectional reflectance distribution function","text":"<p>BRDF\uff08Bidirectional reflectance distribution function\uff09\u6307\u7684\u662f\u5728\u4e00\u4e2a\u8868\u9762\u4e0a\uff0c\u7279\u5b9a\u89d2\u5ea6\uff08\\omega_i\uff09\u7684\u5165\u5c04\u5149\u6709\u591a\u5927\u6bd4\u4f8b\u4f1a\u88ab\u53cd\u5c04\u5230\u7279\u5b9a\u89d2\u5ea6\uff08\\omega_o\uff09\u7684\u51fa\u5c04\u5149\u3002</p> <p>\u5e38\u89c1\u7684 BRDF \u6709\uff1a</p> <ul> <li>Lambertian\uff1a\u4e00\u822c\u7528\u4e8e\u6f2b\u53cd\u5c04\u8868\u9762\uff0c\u5149\u5747\u5300\u53cd\u5c04\u5230\u5404\u4e2a\u89d2\u5ea6\uff0c\u56e0\u6b64\u548c\u51fa\u5c04\u89d2\u5ea6\u65e0\u5173\uff1af=c/\\pi\uff0c\u5176\u4e2d c \u662f\u8868\u9762\u7684\u989c\u8272\uff0c\u9664\u4ee5 \\pi \u662f\u4e3a\u4e86\u6ee1\u8db3\u80fd\u91cf\u5b88\u6052\uff0c\u8ba1\u7b97\u8fc7\u7a0b\u89c1 Deriving Lambertian BRDF from first principles</li> <li>Phong \u548c Blinn-Phong\uff1a\u7528\u4e8e OpenGL Fixed-function pipeline</li> <li>Cook-Torrance\uff1af=k_d\\frac{c}{\\pi} + k_s\\frac{DFG}{4(n \\cdot \\omega_i)(n \\cdot \\omega_o)}\uff0c\u524d\u9762\u7684 k_d\\frac{c}{\\pi} \u548c Lambertian \u4e00\u6837\uff0c\u540e\u9762\u7684 DFG \u8868\u793a\u4e09\u4e2a\u51fd\u6570\u7684\u4e58\u79ef\uff0c\u5206\u522b\u662f Normal Distribution Function\uff0cFresnel Function \u548c Geometric Attenuation Function\uff0c\u8be6\u89c1 Physically-Based Rendering Cook-Torrance Reflectance Model \u548c LearnOpenGL CN - Theory</li> </ul>"},{"location":"software/cg/#api","title":"\u56fe\u5f62 API \u5bf9\u6bd4","text":"<p>\u4e0b\u9762\u7ed9\u51fa\u4e0d\u540c\u56fe\u5f62 API \u6216\u8005\u5e93\u5728\u7ea6\u5b9a\u4e0a\u7684\u4e0d\u540c\uff1a</p> OpenGL Direct3D Metal Vulkan NDC \u91c7\u7528 \u5de6\u624b\u7cfb \u5de6\u624b\u7cfb \u5de6\u624b\u7cfb \u53f3\u624b\u7cfb NDC \u4e2d z \u7684\u8303\u56f4 [-1, 1] [0, 1] [0, 1] [0, 1] NDC (-1, -1) \u5728 \u5de6\u4e0b\u89d2 \u5de6\u4e0b\u89d2 \u5de6\u4e0b\u89d2 \u5de6\u4e0a\u89d2 Framebuffer (0,0) \u5728 \u5de6\u4e0b\u89d2 \u5de6\u4e0a\u89d2 \u5de6\u4e0a\u89d2 \u5de6\u4e0a\u89d2 <p>\u53c2\u8003\uff1a</p> <ul> <li>Unity - Manual: Writing shaders for different graphics APIs</li> <li>Coordinate systems - gpuweb</li> <li>Vulkan \u96c6\u6210\uff1a\u56fe\u5f62 API \u5750\u6807\u7cfb\u5bf9\u6bd4\u53ca\u89e3\u51b3\u65b9\u6848</li> <li>Vulkan\u2019s coordinate system</li> </ul> <p>\u53e6\u5916\u8fd8\u63a8\u8350\u9605\u8bfb\uff1a</p> <ul> <li>What are the coordinates?</li> </ul>"},{"location":"software/cpio/","title":"cpio \u6587\u4ef6\u683c\u5f0f","text":"<p>cpio \u6587\u4ef6\u6709\u591a\u79cd\u4e0d\u540c\u7684\u683c\u5f0f\uff0c\u4e3b\u8981\u6709\u5982\u4e0b\u51e0\u79cd\uff1a</p> <ol> <li>binary/pwb\uff1a\u65e9\u671f\u7684 cpio \u4e8c\u8fdb\u5236\u683c\u5f0f</li> <li>odc\uff1aPOSIX \u6807\u51c6\u5316\u7684 cpio \u683c\u5f0f\uff0c\u6bd4\u8f83\u5e38\u7528</li> <li>newc\uff1aSVR4\uff08System V Release 4\uff09\u5f15\u5165\u7684 cpio \u683c\u5f0f</li> </ol> <p>\u63a8\u8350\u9605\u8bfb\uff1acpio.5\u3002</p>"},{"location":"software/cpio/#odc","title":"odc","text":"<p>cpio \u7684 odc \u6587\u4ef6\u683c\u5f0f\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u7cfb\u5217\u7684 File Entry\u3002\u6bcf\u4e2a File Entry \u7531\u5934\u90e8\uff0c\u6587\u4ef6\u540d\u548c\u6570\u636e\u7ec4\u6210\uff0c\u5176\u5934\u90e8\u683c\u5f0f\u662f\uff1a</p> <pre><code>struct cpio_odc_entry_header {\n  char magic[6];\n  char dev[6];\n  char ino[6];\n  char mode[6];\n  char uid[6];\n  char gid[6];\n  char nlink[6];\n  char rdev[6];\n  char mtime[11];\n  char namesize[6];\n  char filesize[11];\n};\n</code></pre> <p>magic \u5b57\u6bb5\u6052\u4e3a <code>070707</code>\u3002\u5176\u4ed6\u5b57\u6bb5\u90fd\u4fdd\u5b58\u7684\u662f\u6570\u5b57\uff0c\u7528\u516b\u8fdb\u5236\u6570\u8f6c\u6210 ASCII \u7801\u4fdd\u5b58\u3002\u4f8b\u5982\u6587\u4ef6\u540d\u957f\u5ea6\u662f 28\uff0c\u8f6c\u6210\u516b\u8fdb\u5c55\u662f 034\uff0c<code>namesize</code> \u5b57\u6bb5\u662f 6 \u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u6dfb\u52a0\u524d\u7f6e 0\uff0c\u5f97\u5230 <code>000034</code>\uff0c\u7528 ASCII \u4fdd\u5b58\u5728 <code>namesize</code> \u5b57\u6bb5\u3002</p> <p>\u8bfb\u53d6 Entry \u5934\u90e8\u4ee5\u540e\uff0c\u628a\u5176\u4e2d\u7684 <code>namesize</code> \u548c <code>filesize</code> \u5b57\u6bb5\u8f6c\u6362\u6210\u6574\u6570\uff0c\u5c31\u77e5\u9053\u6587\u4ef6\u540d\uff08\u5305\u62ec\u672b\u5c3e 0\uff09\u548c\u6570\u636e\u7684\u957f\u5ea6\u3002\u5934\u90e8\u540e\u9762\u7d27\u63a5\u7740\u5c31\u662f\u6587\u4ef6\u540d\uff0c\u7136\u540e\u662f\u6570\u636e\u3002\u6240\u6709 Entry \u62fc\u63a5\u5728\u4e00\u8d77\uff0c\u5c31\u662f\u5b8c\u6574\u7684 cpio \u6587\u4ef6\u3002\u6ca1\u6709\u989d\u5916\u7684 padding\u3002</p> <p>\u4e3a\u4e86\u8868\u793a cpio \u6587\u4ef6\u7684\u7ed3\u675f\uff0c\u6700\u540e\u4e00\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u662f <code>TRAILER!!!</code>\u3002</p> <p>cpio \u7684\u8bbe\u8ba1\u975e\u5e38\u7b80\u5355\uff0c\u88ab\u7528\u4e8e initramfs \u7b49\u573a\u5408\u3002\u76f8\u6bd4 Tar\uff0ccpio \u6ca1\u6709\u628a\u7ed3\u6784\u4f53\u5bf9\u9f50\u5230 512 \u5b57\u8282\u7684\u8fb9\u754c\uff0c\u5e76\u4e14\u6587\u4ef6\u540d\u4e5f\u91c7\u7528\u4e86\u52a8\u6001\u957f\u5ea6\u7684\u65b9\u6cd5\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff0ccpio \u6587\u4ef6\u7684\u683c\u5f0f\u5c31\u662f\uff1a<code>(\u5934\u90e8\uff0c\u6587\u4ef6\u540d\uff0c\u6570\u636e)*</code>\u3002\u4e3a\u4e86\u8868\u793a\u7ed3\u675f\uff0c\u6700\u540e\u4e00\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u662f\u56fa\u5b9a\u7684 <code>TRAILER!!!</code>\u3002</p>"},{"location":"software/cpio/#newc","title":"newc","text":"<p>newc \u76f8\u6bd4 odc \u683c\u5f0f\uff0c\u4fee\u6539\u4e86\u4e00\u4e9b\u5b57\u6bb5\u7684\u957f\u5ea6\uff0c\u5e76\u4e14\u628a dev \u62c6\u5206\u6210\u4e86 major \u548c minor\uff0c\u6dfb\u52a0\u4e86 crc\uff1a</p> <pre><code>struct cpio_newc_entry_header {\n  char magic[8];\n  char ino[8];\n  char mode[8];\n  char uid[8];\n  char gid[8];\n  char nlink[8];\n  char mtime[8];\n  char filesize[8];\n  char devmajor[8];\n  char devminor[8];\n  char rdevmajor[8];\n  char rdevminor[8];\n  char namesize[8];\n  char check[8];\n};\n</code></pre> <p>\u6b64\u65f6\u7684 magic \u5b57\u6bb5\u662f <code>070701</code> \u6216\u8005 <code>070702</code>\uff0c\u4e0e odc \u8868\u793a\u533a\u5206\u3002</p> <p>\u5982\u679c\u8ba1\u7b97\u4e86 CRC\uff0c\u90a3\u4e48 CRC \u4f1a\u88ab\u586b\u5165 <code>check</code> \u5b57\u6bb5\uff0c\u5e76\u4e14\u8bbe\u7f6e <code>magic</code> \u4e3a <code>070702</code>\uff1b\u5982\u679c\u6ca1\u6709 CRC\uff0c\u90a3\u4e48 <code>magic</code> \u4e3a <code>070701</code>\u3002</p>"},{"location":"software/cpio/#_1","title":"\u5e38\u7528\u547d\u4ee4","text":"<p>\u521b\u5efa cpio\uff1a<code>find . | cpio -ov &gt; archive.cpio</code></p> <p>\u5c55\u5f00 cpio\uff1a<code>cpio -idv &lt; archive.cpio</code></p>"},{"location":"software/dijkstra/","title":"Dijkstra \u7b97\u6cd5","text":"<p>Dijkstra \u89e3\u51b3\u7684\u662f\u56fe\u4e0a\u7684\u5355\u6e90\u6700\u77ed\u8def\u5f84\u95ee\u9898\uff08Single Source Shortest Path\uff0cSSSP\uff09\u3002</p> <p>\u5b9e\u73b0\u5927\u81f4\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>def dijkstra(graph, source):\n    Q = priority_queue()\n\n    # initialize dist and Q\n    dist[source] = 0\n    for v in graph.vertices:\n        if v != source:\n            dist[v] = INF\n\n        Q.add_with_priority(v, dist[v])\n\n    while not Q.empty:\n        # find min dist and relax edge\n        u = Q.extract_min()\n\n        for v in u.neighbors():\n            # relax\n            new_dist = dist[u] + u.dist_to(v)\n            if new_dist &lt; dist[v]:\n                dist[v] = new_dist\n                Q.decrease_priority(v, new_dist)\n</code></pre> <p>Q \u662f\u4e00\u4e2a\u4f18\u5148\u961f\u5217\uff0c\u961f\u5217\u6bcf\u4e2a\u5143\u7d20\u90fd\u6709\u4f18\u5148\u7ea7\uff0c\u652f\u6301\u5982\u4e0b\u64cd\u4f5c\uff1a</p> <ol> <li><code>add_with_priority(element, priority)</code>\uff1a\u63d2\u5165\u65b0\u5143\u7d20</li> <li><code>empty()</code>\uff1a\u5224\u65ad\u961f\u5217\u662f\u5426\u4e3a\u7a7a</li> <li><code>extract_min()</code>\uff1a\u4ece\u961f\u5217\u4e2d\u5220\u9664\u4f18\u5148\u7ea7\u6700\u4f4e\u7684\u5143\u7d20\u5e76\u8fd4\u56de\u8be5\u5143\u7d20</li> <li><code>decrease_priority()</code>\uff1a\u4fee\u6539\u961f\u5217\u4e2d\u7279\u5b9a\u5143\u7d20\u7684\u4f18\u5148\u7ea7\uff0c\u4fdd\u8bc1\u961f\u5217\u4e2d\u6ca1\u6709\u91cd\u590d\u5143\u7d20</li> </ol> <p>\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(|E|T_{dp}+|V|T_{em})\uff0c\u5176\u4e2d E \u662f\u8fb9\u7684\u96c6\u5408\uff0cV \u662f\u9876\u70b9\u7684\u96c6\u5408\uff0cT_{dp} \u662f <code>decrease_priority()</code> \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0cT_{em} \u662f <code>extract_min()</code> \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002</p> <p>\u6839\u636e\u4f18\u5148\u961f\u5217\u7684\u4e0d\u540c\u5b9e\u73b0\uff0c\u5f97\u5230\u4e0d\u540c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a</p> <ol> <li>\u7528\u6570\u7ec4\u5b9e\u73b0\u4f18\u5148\u961f\u5217\uff0c\u5219 T_{dp}=O(1), T_{em}=O(|V|)\uff0c\u56e0\u6b64\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(|E|+|V|^2)=O(|V|^2)</li> <li>\u7528\u5e73\u8861\u6811\u6216\u8005\u5806\u5b9e\u73b0\u4f18\u5148\u961f\u5217\uff0c\u5219 T_{dp}=O(\\log{|V|}), T_{em}=O(\\log{|V|})\uff0c\u7b97\u6cd5\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O((|E|+|V|)\\log{|V|})</li> <li>\u7528 Fibonacci \u5806\u5b9e\u73b0\u4f18\u5148\u961f\u5217\uff0c\u5219 T_{dp}=O(1), T_{em}=O(\\log{|V|})\uff0c\u7b97\u6cd5\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(|E|+|V|\\log{|V|})</li> </ol> <p>\u6700\u8fd1\u4e00\u7bc7\u8bba\u6587 A Randomized Algorithm for Single-Source Shortest Path on Undirected Real-Weighted Graphs \u63d0\u51fa\u4e86 O(|E|\\sqrt{\\log{|V|}\\log{\\log{|V|}}}) \u7684 Dijkstra \u53d8\u79cd\u7b97\u6cd5\u3002</p> <p>\u53c2\u8003\u4e86 Wikipedia\u3002</p>"},{"location":"software/gcc/","title":"GCC Internals","text":"<p>\u672c\u6587\u662f\u5bf9 GNU Compiler Collection Internals \u6587\u6863\u7684\u6574\u7406\u548c\u603b\u7ed3\u3002\u6587\u7ae0\u5f15\u7528\u4e86\u90e8\u5206 GCC \u6e90\u7801\u3002</p>"},{"location":"software/gcc/#rtl","title":"RTL","text":""},{"location":"software/gcc/#rtl_1","title":"\u67e5\u770b RTL","text":"<p>GCC \u7684 RTL \u662f\u91c7\u7528 Lisp \u8bed\u8a00\u63cf\u8ff0\u7684\u4f4e\u5c42\u6b21\u7684\u4e2d\u95f4\u8bed\u8a00\uff0c\u662f\u8f6c\u6362\u4e3a\u673a\u5668\u6307\u4ee4\u524d\u7684\u6700\u540e\u4e00\u4e2a\u8868\u793a\u3002\u5728\u751f\u6210\u6c47\u7f16\u7684\u65f6\u5019\uff0c\u6dfb\u52a0\u53c2\u6570 <code>-dP</code> \u5c31\u53ef\u4ee5\u770b\u5230\u6700\u540e\u7684 RTL \u548c\u6c47\u7f16\u7684\u5bf9\u5e94\u5173\u7cfb\uff1a</p> <pre><code>#(insn 13 8 14 (set (reg/i:DI 10 a0)\n#        (sign_extend:DI (mult:SI (reg:SI 10 a0 [77])\n#                (reg:SI 11 a1 [78])))) \"kb.c\":3:1 21 {*mulsi3_extended}\n#     (expr_list:REG_DEAD (reg:SI 11 a1 [78])\n#        (nil)))\n        mulw    a0,a0,a1        # 13    [c=20 l=4]  *mulsi3_extended\n#(jump_insn 21 20 22 (simple_return) \"kb.c\":3:1 246 {simple_return}\n#     (nil)\n# -&gt; simple_return)\n        ret             # 21    [c=0 l=4]  simple_return\n</code></pre> <p>\u5982\u679c\u60f3\u8981 dump \u51fa\u6bcf\u4e2a RTL pass \u540e\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u6dfb\u52a0\u53c2\u6570\uff1a<code>-fdump-rtl-all</code>\uff0c\u53ef\u4ee5\u770b\u5230\u5f62\u5982\u4e0b\u9762\u7684 RTL \u4ee3\u7801\uff1a</p> <pre><code>;; Function mul (mul, funcdef_no=0, decl_uid=1488, cgraph_uid=1, symbol_order=0)\n\n(note 1 0 5 NOTE_INSN_DELETED)\n(note 5 1 19 [bb 2] NOTE_INSN_BASIC_BLOCK)\n(note 19 5 2 NOTE_INSN_PROLOGUE_END)\n(note 2 19 3 NOTE_INSN_DELETED)\n(note 3 2 4 NOTE_INSN_DELETED)\n(note 4 3 7 NOTE_INSN_FUNCTION_BEG)\n(note 7 4 8 NOTE_INSN_DELETED)\n(note 8 7 13 NOTE_INSN_DELETED)\n(insn 13 8 14 (set (reg/i:DI 10 a0)\n        (sign_extend:DI (mult:SI (reg:SI 10 a0 [77])\n                (reg:SI 11 a1 [78])))) \"kb.c\":3:1 21 {*mulsi3_extended}\n     (expr_list:REG_DEAD (reg:SI 11 a1 [78])\n        (nil)))\n(insn 14 13 20 (use (reg/i:DI 10 a0)) \"kb.c\":3:1 -1\n     (nil))\n(note 20 14 21 NOTE_INSN_EPILOGUE_BEG)\n(jump_insn 21 20 22 (simple_return) \"kb.c\":3:1 246 {simple_return}\n     (nil)\n -&gt; simple_return)\n(barrier 22 21 18)\n(note 18 22 0 NOTE_INSN_DELETED)\n</code></pre>"},{"location":"software/gcc/#rtl_2","title":"\u9605\u8bfb RTL","text":"<p>\u53ef\u4ee5\u770b\u5230 RTL \u662f\u4e00\u7cfb\u5217\u7684 S-exp\uff0c\u6bcf\u4e2a S-exp \u7684\u524d\u4e09\u4e2a\u6574\u6570\u53c2\u6570\u5206\u522b\u662f id\uff0cprev \u548c next\uff0c\u8868\u793a\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u3002\u6838\u5fc3\u662f\u8981\u770b (insn) \u7684\u7b2c\u56db\u4e2a\u53c2\u6570\uff0c\u4f8b\u5982\uff1a</p> <pre><code>(set (reg/i:DI 10 a0)\n        (sign_extend:DI (mult:SI (reg:SI 10 a0 [77])\n                (reg:SI 11 a1 [78]))))\n</code></pre> <p>\u8868\u793a\u8fd9\u4e2a\u6307\u4ee4\u7684\u4f5c\u7528\u662f\uff0c\u628a int32 \u7c7b\u578b\u7684 a0 \u5bc4\u5b58\u5668\u7684\u503c\u4e58\u4ee5 int32 \u7c7b\u578b\u7684 a1 \u5bc4\u5b58\u5668\u7684\u503c\uff0c\u7ed3\u679c\u7b26\u53f7\u6269\u5c55\u5230 int64\uff0c\u5199\u5165\u5230 a0 \u5bc4\u5b58\u5668\u4e2d\u3002\u5176\u4e2d\u8868\u793a\u7c7b\u578b\u7684\u662f DI/SI\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u540d\u5b57\u548c\u4f4d\u6570\u7684\u5bf9\u5e94\u5173\u7cfb\uff1a</p> <ul> <li>\u6574\u6570\uff1aB(Bit)I=1, Q(Quarter)I=8, H(Half)I=16, S(Single)I=32, D(Double)I=64, T(Tetra)I=128</li> <li>\u6d6e\u70b9\uff1aQ(Quarter)F=8, H(Half)F=16, S(Single)F=32, D(Double)F=64, T(Tetra)F=128</li> <li>\u5341\u8fdb\u5236\u6d6e\u70b9\uff1a*D</li> <li>\u6709\u7406\u6570\uff1a*Q</li> <li>\u590d\u6570\uff1a*C</li> </ul> <p>\u7a0d\u5fae\u548c\u4e60\u60ef\u4e0d\u540c\u7684\u662f Q \u8868\u793a Quarter \u800c\u4e0d\u662f Quad\u3002</p> <p>\u5bc4\u5b58\u5668\u7684\u8868\u793a\u65b9\u5f0f\u662f <code>(reg:m n)</code>\uff1a</p> <pre><code>(reg/i:DI 10 a0)\n(reg:SI 10 a0 [77])\n(reg:SI 11 a1 [78])\n</code></pre> <p>\u8fd9\u91cc\u7684 DI/SI \u5c31\u662f\u7c7b\u578b\uff0c10/11 \u662f\u5bc4\u5b58\u5668\u7f16\u53f7\uff0c\u540e\u9762\u7684 a0/a1 \u662f\u5bc4\u5b58\u5668 10/11 \u5728 RISC-V \u67b6\u6784\u91cc\u7684 ABI \u540d\u79f0\u3002<code>/i</code> \u8868\u793a\u8fd9\u4e2a\u5bc4\u5b58\u5668\u4f1a\u4fdd\u5b58\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff08<code>REG_FUNCTION_VALUE_P(x)</code>\uff09\u3002</p>"},{"location":"software/gcc/#_1","title":"\u6307\u4ee4\u6a21\u677f","text":"<p>\u540c\u4e00\u884c\u6700\u540e\u8fd8\u6709\u4e00\u4e2a <code>{*mulsi3_extended}</code>\uff0c\u8fd9\u8868\u793a\u7684\u662f\u8fd9\u4e00\u4e2a insn \u5bf9\u5e94\u4e86\u54ea\u4e00\u4e2a\u89c4\u5219\uff0c\u8fd9\u53ef\u4ee5\u5728 riscv.md \u4e2d\u627e\u5230\uff1a</p> <pre><code>(define_insn \"mulsi3_extended\"\n  [(set (match_operand:DI              0 \"register_operand\" \"=r\")\n    (sign_extend:DI\n        (mult:SI (match_operand:SI 1 \"register_operand\" \" r\")\n             (match_operand:SI 2 \"register_operand\" \" r\"))))]\n  \"(TARGET_ZMMUL || TARGET_MUL) &amp;&amp; TARGET_64BIT\"\n  \"mulw\\t%0,%1,%2\"\n  [(set_attr \"type\" \"imul\")\n   (set_attr \"mode\" \"SI\")])\n</code></pre> <p>\u8fd9\u8868\u793a\u4e00\u4e2a\u6a21\u5f0f\u5339\u914d\u7684\u89c4\u5219\uff0c\u6784\u6210\u4e86\u4ece RTL \u5230\u6307\u4ee4\u7684\u6620\u5c04\u5173\u7cfb\u3002\u6a21\u5f0f\u5339\u914d\u7684\u90e8\u5206\u662f\uff1a</p> <pre><code>  [(set (match_operand:DI              0 \"register_operand\" \"=r\")\n    (sign_extend:DI\n        (mult:SI (match_operand:SI 1 \"register_operand\" \" r\")\n             (match_operand:SI 2 \"register_operand\" \" r\"))))]\n</code></pre> <p>\u610f\u601d\u662f\u53ef\u4ee5\u5339\u914d\u4e24\u4e2a\u64cd\u4f5c\u6570\uff0c\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u6570\u5e94\u5f53\u662f\u5bc4\u5b58\u5668\u64cd\u4f5c\u6570\uff08<code>register_operand</code>\uff0c<code>r</code> \u8868\u793a\u901a\u7528\u5bc4\u5b58\u5668\uff09\uff0c\u7c7b\u578b\u662f int32\uff08<code>:SI</code>\uff09\uff0c\u64cd\u4f5c\u6570\u4e58\u6cd5\u540e\u7b26\u53f7\u6269\u5c55\u5230 int64\uff08<code>:DI</code>\uff09\uff0c\u6700\u540e\u5199\u5165\u4e00\u4e2a\u5bc4\u5b58\u5668\u7684\u76ee\u7684\u64cd\u4f5c\u6570\uff08<code>register_operand</code>\uff0c\u7c7b\u578b\u662f int64 <code>:DI</code>\uff0c\u4fdd\u5b58\u5728\u901a\u7528\u5bc4\u5b58\u5668 <code>r</code>\uff0c<code>=</code> \u8868\u793a\u5199\u5165\uff0c\u65e7\u6570\u636e\u4e22\u5f03\uff09\u3002\u6ee1\u8db3\u8fd9\u4e9b\u8981\u6c42\uff0c\u5c31\u5339\u914d\u4e0a\u4e86 <code>mulsi3_extended</code>\u3002</p> <p>\u4e0b\u4e00\u884c\uff1a</p> <pre><code>  \"(TARGET_ZMMUL || TARGET_MUL) &amp;&amp; TARGET_64BIT\"\n</code></pre> <p>\u6307\u7684\u662f\u989d\u5916\u7684\u6761\u4ef6\uff0c\u7528 C \u4ee3\u7801\u7f16\u5199\u3002\u6bd4\u5982\u8fd9\u91cc\u8981\u7528\u5230 mulw \u6307\u4ee4\uff0c\u4f46\u662f\u5982\u679c\u5f53\u524d\u7684 target \u4e0d\u652f\u6301\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u5c31\u4e0d\u8981\u751f\u6210 mulw \u6307\u4ee4\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u8981\u5236\u5b9a\u9650\u5236\u6761\u4ef6\uff1a\u5b9e\u73b0\u4e86\u4e58\u6cd5\uff0c\u5e76\u4e14\u662f 64 \u4f4d\u3002</p> <p>\u518d\u4e0b\u4e00\u884c\u5c31\u662f\u8f93\u51fa\u7684\u6307\u4ee4\uff1a</p> <pre><code>  \"mulw\\t%0,%1,%2\"\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>%0</code> <code>%1</code> <code>%2</code> \u5c31\u4f1a\u66ff\u6362\u4e3a\u524d\u9762\u5339\u914d\u5f97\u5230\u7684\u64cd\u4f5c\u6570\uff0c\u6ce8\u610f\u524d\u9762 <code>match_operand</code> \u540e\u7684\u6574\u6570\uff0c\u8fd9\u5c31\u662f\u5bf9\u5e94\u7684\u7f16\u53f7\u3002\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u548c GCC \u5185\u8054\u6c47\u7f16\u7684\u8bed\u6cd5\u7279\u522b\u76f8\u4f3c\uff0c\u5305\u62ec\u524d\u9762 <code>match_operand</code> \u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff1a<code>=r</code> \u548c <code>r</code>\uff0c\u5176\u5b9e\u548c\u5185\u8054\u6c47\u7f16\u91cc\u5bf9\u64cd\u4f5c\u6570\u7684 specifier \u4e5f\u662f\u975e\u5e38\u50cf\u7684\u3002</p> <pre><code>  [(set_attr \"type\" \"imul\")\n   (set_attr \"mode\" \"SI\")])\n</code></pre> <p>\u6700\u540e\u662f\u4e00\u4e9b\u989d\u5916\u7684\u5c5e\u6027\uff0c\u8fd9\u4e2a\u662f\u7528\u6765\u7ed9\u8fd0\u7b97\u6807\u8bb0\u7c7b\u578b\u7684\uff0c\u4f8b\u5982\u8981\u9488\u5bf9\u5904\u7406\u5668\u6d41\u6c34\u7ebf\u8fdb\u884c\u4f18\u5316\uff0c\u90a3\u5c31\u9700\u8981\u77e5\u9053\u6bcf\u4e2a\u6307\u4ee4\u4f1a\u88ab\u5206\u5230\u54ea\u4e2a\u6d41\u6c34\u7ebf\u91cc\u9762\u3002</p> <p>\u5b8c\u6574\u7684\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>(define_insn\n  [insn-pattern]\n  \"condition\"\n  \"output-template\"\n  [insn-attribute])\n</code></pre> <p>\u5ffd\u7565\u4e86\u53ef\u9009\u7684\u547d\u540d\u3002</p>"},{"location":"software/gcc/#_2","title":"\u4f8b\u5b50\u56de\u987e","text":"<p>\u56de\u987e\u4e00\u4e0b\u5f00\u5934\u7684\u4f8b\u5b50\uff1a</p> <pre><code>#(insn 13 8 14 (set (reg/i:DI 10 a0)\n#        (sign_extend:DI (mult:SI (reg:SI 10 a0 [77])\n#                (reg:SI 11 a1 [78])))) \"kb.c\":3:1 21 {*mulsi3_extended}\n#     (expr_list:REG_DEAD (reg:SI 11 a1 [78])\n#        (nil)))\n        mulw    a0,a0,a1        # 13    [c=20 l=4]  *mulsi3_extended\n</code></pre> <p>\u8fd9\u4e00\u4e2a insn \u4e0e mulsi3_extended \u76f8\u5339\u914d\uff0c\u64cd\u4f5c\u6570 0 \u5339\u914d\u5230\u4e86 <code>(reg/i:DI 10 a0)</code>\uff0c\u64cd\u4f5c\u6570 1 \u5339\u914d\u5230\u4e86 <code>(reg:SI 10 a0 [77])</code>\uff0c\u64cd\u4f5c\u6570 2 \u5339\u914d\u5230\u4e86 <code>(reg:SI 11 a1 [78])</code>\uff0c\u6240\u4ee5\u6700\u540e\u751f\u6210\u6307\u4ee4\u7684\u65f6\u5019\uff0c\u628a\u5bf9\u5e94\u7684\u5bc4\u5b58\u5668\u540d\u5b57\u586b\u8fdb\u53bb\uff0c\u5c31\u5f97\u5230\u4e86 <code>mulw a0,a0,a1</code>\u3002</p> <p>\u6709\u65f6\u5019\uff0c\u6bd4\u8f83\u590d\u6742\u7684\u6307\u4ee4\u4f1a\u5728 C \u4ee3\u7801\u4e2d\u751f\u6210\uff0c\u4f8b\u5982 <code>simple_return</code>\uff1a</p> <pre><code>(define_insn \"simple_return\"\n  [(simple_return)]\n  \"\"\n{\n  return riscv_output_return ();\n}\n  [(set_attr \"type\" \"jump\")\n   (set_attr \"mode\" \"none\")])\n</code></pre> <p>\u90a3\u4e48\u5339\u914d\u4ee5\u540e\uff0c\u4f1a\u8c03\u7528 <code>riscv_output_return</code> \u51fd\u6570\uff1a</p> <pre><code>const char *\nriscv_output_return ()\n{\n  if (cfun-&gt;machine-&gt;naked_p)\n    return \"\";\n\n  return \"ret\";\n}\n</code></pre> <p>\u5b9e\u73b0\u4e5f\u5f88\u7b80\u5355\uff0c\u9664\u4e86 naked \u51fd\u6570\u4ee5\u5916\uff0c\u90fd\u662f\u4e00\u6761 ret \u6307\u4ee4\u3002</p>"},{"location":"software/gcc/#_3","title":"\u539f\u7406\u63a2\u7a76","text":"<p>\u5177\u4f53\u5730\uff0c\u5728 <code>riscv.md</code> \u4e2d\u5199\u6a21\u5f0f\u5339\u914d\u7684\u65f6\u5019\uff1a</p> <pre><code>  [(set (match_operand:DI              0 \"register_operand\" \"=r\")\n    (sign_extend:DI\n        (mult:SI (match_operand:SI 1 \"register_operand\" \" r\")\n             (match_operand:SI 2 \"register_operand\" \" r\"))))]\n</code></pre> <p>\u4f1a\u5728 <code>gcc/insn-recog.cc</code> \u751f\u6210\u5982\u4e0b\u7684\u4ee3\u7801\uff1a</p> <pre><code>// x1 = (set (reg/i:DI 10 a0)\n//           (sign_extend:DI (mult:SI (reg:SI 10 a0 [77])\n//                   (reg:SI 11 a1 [78]))))\nstatic int\nrecog_7 (rtx x1 ATTRIBUTE_UNUSED,\n    rtx_insn *insn ATTRIBUTE_UNUSED,\n    int *pnum_clobbers ATTRIBUTE_UNUSED)\n{\n  rtx * const operands ATTRIBUTE_UNUSED = &amp;recog_data.operand[0];\n  rtx x2, x3, x4, x5, x6;\n  int res ATTRIBUTE_UNUSED;\n  // x2 = (reg/i:DI 10 a0)\n  x2 = XEXP (x1, 0);\n  // operands[0] = (reg/i:DI 10 a0)\n  operands[0] = x2;\n  // x3 = (sign_extend:DI (mult:SI (reg:SI 10 a0 [77])\n  //                      (reg:SI 11 a1 [78])))\n  x3 = XEXP (x1, 1);\n  // x4 = (mult:SI (reg:SI 10 a0 [77])\n  //               (reg:SI 11 a1 [78]))\n  x4 = XEXP (x3, 0);\n  switch (GET_CODE (x4))\n    {\n    case MULT:\n      if (pattern14 (x3, E_SImode) != 0\n          || !\n#line 869 \"/home/jiegec/ct-ng/.build/riscv64-unknown-linux-gnu/src/gcc/gcc/config/riscv/riscv.md\"\n(TARGET_MUL &amp;&amp; TARGET_64BIT))\n        return -1;\n      return 21; /* *mulsi3_extended */\n    }\n}\n</code></pre> <pre><code>// x1 = (sign_extend:DI (mult:SI (reg:SI 10 a0 [77])\n//                      (reg:SI 11 a1 [78])))\nstatic int\npattern14 (rtx x1, machine_mode i1)\n{\n  rtx * const operands ATTRIBUTE_UNUSED = &amp;recog_data.operand[0];\n  rtx x2, x3, x4;\n  int res ATTRIBUTE_UNUSED;\n  // x2 = (mult:SI (reg:SI 10 a0 [77])\n  //               (reg:SI 11 a1 [78]))\n  // operands[0] = (reg/i:DI 10 a0)\n  x2 = XEXP (x1, 0);\n  if (GET_MODE (x2) != E_SImode\n      || !register_operand (operands[0], E_DImode)\n      || GET_MODE (x1) != E_DImode)\n    return -1;\n  // x3 = (reg:SI 10 a0 [77])\n  x3 = XEXP (x2, 0);\n  // operands[1] = (reg:SI 10 a0 [77])\n  operands[1] = x3;\n  if (!register_operand (operands[1], E_SImode))\n    return -1;\n  // x4 = (reg:SI 11 a1 [78])\n  x4 = XEXP (x2, 1);\n  // operands[2] = (reg:SI 11 a1 [78])\n  operands[2] = x4;\n  if (!register_operand (operands[2], i1))\n    return -1;\n  return 0;\n}\n</code></pre> <p>\u4ee3\u7801\u4e2d\u7528\u6ce8\u91ca\u6807\u6ce8\u4e86\u6bcf\u4e00\u6b65\u5339\u914d\u7684\u5185\u5bb9\uff0c\u53ef\u89c1\u4ee3\u7801\u5728\u5339\u914d\u7684\u540c\u65f6\uff0c\u4e5f\u628a\u64cd\u4f5c\u6570\u4fdd\u5b58\u4e86\u4e0b\u6765\u3002</p>"},{"location":"software/gcc/#_4","title":"\u6307\u4ee4\u62c6\u5206","text":"<p>\u6709\u4e9b\u65f6\u5019\uff0cRTL \u5c42\u6b21\u4e0a\u7684\u6307\u4ee4\u53ef\u80fd\u5bf9\u5e94\u591a\u6761\u5b9e\u9645\u7684\u673a\u5668\u6307\u4ee4\u3002\u4f8b\u5982\u5728 32 \u4f4d target \u4e0a\uff0c\u62f7\u8d1d\u4e00\u4e2a 64 \u4f4d\u6574\u6570\uff0c\u8fd9\u610f\u5473\u7740\u9700\u8981\u628a\u4e00\u4e2a DI \u7c7b\u578b\u7684 move\uff0c\u62c6\u6210\u4e24\u4e2a SI \u7c7b\u578b\u7684 move\uff0c\u5206\u522b\u5904\u7406\u9ad8\u4f4d\u548c\u4f4e\u4f4d\u3002\u4e0b\u9762\u6765\u770b\u4e00\u4e2a rv32 \u7684\u4f8b\u5b50\uff1a</p> <pre><code>;; 64-bit modes for which we provide move patterns.\n(define_mode_iterator MOVE64 [DI DF])\n\n(define_split\n  [(set (match_operand:MOVE64 0 \"nonimmediate_operand\")\n    (match_operand:MOVE64 1 \"move_operand\"))]\n  \"reload_completed\n   &amp;&amp; riscv_split_64bit_move_p (operands[0], operands[1])\"\n  [(const_int 0)]\n{\n  riscv_split_doubleword_move (operands[0], operands[1]);\n  DONE;\n})\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5b83\u4f1a\u5c1d\u8bd5\u5339\u914d\u4ece\u4e00\u4e2a 64 \u4f4d\u6574\u6570\uff08DI\uff09\u6216\u6d6e\u70b9\u6570\uff08DF\uff09\u5230\u53e6\u4e00\u4e2a 64 \u4f4d\u6574\u6570\uff08DI\uff09\u6216\u6d6e\u70b9\u6570\uff08DF\uff09\u7684 set\uff0c\u4e5f\u5c31\u662f move \u64cd\u4f5c\u3002\u5339\u914d\u4e0a\u4ee5\u540e\uff0c\u5224\u65ad\u6761\u4ef6\uff1a</p> <pre><code>  \"reload_completed\n   &amp;&amp; riscv_split_64bit_move_p (operands[0], operands[1])\"\n</code></pre> <p>\u662f\u5426\u6210\u7acb\u3002\u8fd9\u91cc <code>reload_completed == true</code> \u8868\u793a\u5df2\u7ecf\u5b8c\u6210\u5bc4\u5b58\u5668\u5206\u914d\u3002</p> <p>\u5982\u679c\u6210\u7acb\uff0c\u5c31\u8ba4\u4e3a\u53ef\u4ee5\u62c6\u5206 64 \u4f4d\u7684 move \u4e3a\u4e24\u4e2a 32 \u4f4d\u7684 move\uff0c\u5c31\u751f\u6210\u4e0b\u5217 RTL\uff1a</p> <pre><code>  [(const_int 0)]\n</code></pre> <p>\u4f46\u662f\u5b9e\u9645\u4e0a\u4e0d\u4f1a\u751f\u6210\u8fd9\u4e2a\uff0c\u800c\u662f\u8c03\u7528\u540e\u9762\u7684\u4ee3\u7801\u6765\u751f\u6210\u65b0\u7684 RTL \u4ee3\u7801\uff1a</p> <pre><code>{\n  riscv_split_doubleword_move (operands[0], operands[1]);\n  DONE;\n})\n</code></pre> <p>\u5b8c\u6574\u7684 <code>define_split</code> \u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>(define-split\n  [insn-pattern]\n  \"condition\"\n  [new-insn-pattern-1\n   new-insn-pattern-2\n   ...]\n  \"preparation-statements\")\n</code></pre> <p>\u5ffd\u7565\u4e86\u53ef\u9009\u7684\u547d\u540d\u3002</p> <p>\u4e0b\u9762\u6765\u770b\u4e00\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff0c\u8fd9\u4e00\u6bb5\u662f\u5728 split \u4e4b\u524d\u7684 RTL \u4ee3\u7801\uff1a</p> <pre><code>(insn 6 3 13 (set (reg:DI 14 a4 [orig:72 _2 ] [72])\n        (mem/c:DI (plus:SI (reg/f:SI 8 s0)\n                (const_int -24 [0xffffffffffffffe8])) [1 a+0 S8 A64])) \"kb.c\":1:38 134 {*movdi_32bit}\n     (nil))\n</code></pre> <p>\u5b83\u505a\u7684\u4e8b\u60c5\u662f\uff0c\u4ece\u5185\u5b58\u5730\u5740 <code>$s0-24</code> \u8bfb\u53d6\u8bfb\u53d6 8 \u4e2a\u5b57\u8282\uff0c\u5199\u5165\u5230 a4 \u5bc4\u5b58\u5668\u5f53\u4e2d\uff0c\u7531\u4e8e RV32 \u5bc4\u5b58\u5668\u5bbd\u5ea6\u53ea\u6709 32 \u4f4d\uff0c\u6240\u4ee5\u9700\u8981\u62c6\u6210\u4e24\u4e2a\u8bfb\u53d6\uff1a</p> <pre><code>Splitting with gen_split_14 (riscv.md:1510)\ndeleting insn with uid = 6.\ndeleting insn with uid = 6.\n\n(insn 30 3 31 (set (reg:SI 14 a4 [orig:72 _2 ] [72])\n        (mem/c:SI (plus:SI (reg/f:SI 8 s0)\n                (const_int -24 [0xffffffffffffffe8])) [1 a+0 S4 A64])) \"kb.c\":1:38 136 {*movsi_internal}\n     (nil))\n(insn 31 30 32 (set (reg:SI 15 a5 [ _2+4 ])\n        (mem/c:SI (plus:SI (reg/f:SI 8 s0)\n                (const_int -20 [0xffffffffffffffec])) [1 a+4 S4 A32])) \"kb.c\":1:38 136 {*movsi_internal}\n     (nil))\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c64 \u4f4d\u7684\u76ee\u7684\u5bc4\u5b58\u5668\u88ab\u62c6\u6210\u4e86\u4e24\u4e2a 32 \u4f4d\u5bc4\u5b58\u5668\uff0c\u5206\u522b\u662f a4 \u548c a5\uff1b\u5185\u5b58\u8bfb\u53d6\u6307\u4ee4\u4e5f\u62c6\u5206\u6210\u4e86\u4e24\u4e2a SI \u7c7b\u578b\u7684\u8bfb\u53d6\uff0c\u6808\u4e0a\u7684\u504f\u79fb\u4e5f\u505a\u4e86\u76f8\u5e94\u7684\u8c03\u6574\u3002</p> <p>\u6709\u65f6\u5019\u8fd8\u53ef\u4ee5\u89c1\u5230 <code>define_insn_and_split</code>\uff1a</p> <pre><code>(define_insn_and_split\n  [insn-pattern]\n  \"condition\"\n  \"output-template\"\n  \"split-condition\"\n  [new-insn-pattern-1\n   new-insn-pattern-2\n   ...]\n  \"preparation-statements\"\n  [insn-attribute])\n</code></pre> <p>\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a <code>define_insn</code> \u52a0\u4e00\u4e2a <code>define_split</code>\uff0c\u4e8c\u8005\u7684 <code>insn-pattern</code> \u4e00\u81f4\uff1a</p> <pre><code>(define_insn\n  [insn-pattern]\n  \"condition\"\n  \"output-template\"\n  [insn-attribute])\n\n(define_split\n  [insn-pattern]\n  \"split-condition\"\n  [new-insn-pattern-1\n   new-insn-pattern-2\n   ...]\n  \"preparation-statements\")\n</code></pre>"},{"location":"software/tar/","title":"tar \u6587\u4ef6\u683c\u5f0f","text":"<p>\u63a8\u8350\u9605\u8bfb\uff1atar.5\u3002</p>"},{"location":"software/tar/#ustar","title":"ustar","text":"<p>tar \u7684\u6587\u4ef6\u683c\u5f0f\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u7cfb\u5217\u7684 File Entry\uff0c\u6700\u540e\u662f\u4e24\u4e2a 512 \u5b57\u8282\u7684\u5168 0\uff0c\u8868\u793a\u7ed3\u675f\u3002\u6bcf\u4e2a File Entry \u7531\u5934\u90e8\u548c\u6570\u636e\u7ec4\u6210\uff0c\u5934\u90e8\u7684\u683c\u5f0f\u662f\uff1a</p> <pre><code>/* Source: https://www.gnu.org/software/tar/manual/html_node/Standard.html */\n/* tar Header Block, from POSIX 1003.1-1990.  */\n\n/* POSIX header.  */\n\nstruct posix_header\n{                              /* byte offset */\n  char name[100];               /*   0 */\n  char mode[8];                 /* 100 */\n  char uid[8];                  /* 108 */\n  char gid[8];                  /* 116 */\n  char size[12];                /* 124 */\n  char mtime[12];               /* 136 */\n  char chksum[8];               /* 148 */\n  char typeflag;                /* 156 */\n  char linkname[100];           /* 157 */\n  char magic[6];                /* 257 */\n  char version[2];              /* 263 */\n  char uname[32];               /* 265 */\n  char gname[32];               /* 297 */\n  char devmajor[8];             /* 329 */\n  char devminor[8];             /* 337 */\n  char prefix[155];             /* 345 */\n                                /* 500 */\n};\n</code></pre> <p>\u8fd9\u4e2a\u7248\u672c\u53eb\u505a ustar \u683c\u5f0f\uff08Unix Standard TAR\uff09\uff0c\u5728 POSIX.1-1988 \u6807\u51c6\u4e2d\u5b9a\u4e49\u3002\u6240\u4ee5 <code>magic</code> \u5b57\u6bb5\u7684\u5185\u5bb9\u5c31\u662f <code>ustar</code>\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5c31\u662f\u4e00\u7cfb\u5217\u7684 char \u6570\u7ec4\uff0c\u91cc\u9762\u7684\u5f88\u591a\u6570\u5b57\u5b57\u6bb5\uff0c\u4f8b\u5982 <code>mode</code>\uff0c<code>uid</code> \u548c <code>gid</code> \u7b49\uff0c\u90fd\u662f\u7528 ASCII \u7801\u5199\u7684\u3002\u7531\u4e8e\u5934\u90e8\u9700\u8981\u5bf9\u9f50\u5230 512 \u5b57\u8282\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u540e\u9762\u8fd8\u6709 12 \u5b57\u8282\u7684 padding\u3002</p> <p>\u5934\u90e8\u7684 512 \u5b57\u8282\u7ed3\u675f\u540e\uff0c\u7d27\u63a5\u7740\u5c31\u662f\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u5185\u5bb9\u7684\u5927\u5c0f\u5728\u5934\u90e8\u7684 <code>size</code> \u5b57\u6bb5\u5df2\u7ecf\u4fdd\u5b58\uff0c\u628a\u5b57\u7b26\u4e32\u5f53\u6210 8 \u8fdb\u5236\u6570\u8f6c\u6362\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u6587\u4ef6\u957f\u5ea6\u3002\u6587\u4ef6\u4e5f\u8981\u5bf9\u9f50\u5230 512 \u5b57\u8282\uff0c\u6240\u4ee5\u6587\u4ef6\u540e\u9762\u8fd8\u6709\u82e5\u5e72\u4e2a 0 \u4f5c\u4e3a padding\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff0ctar \u6587\u4ef6\u7684\u683c\u5f0f\u5c31\u662f\uff1a<code>(\u5934\u90e8\uff0c\u6570\u636e)*\u7ed3\u5c3e</code>\u3002\u6bcf\u4e00\u4e2a\u90e8\u5206\u90fd\u5bf9\u9f50\u5230 512 \u5b57\u8282\u3002</p>"},{"location":"software/tar/#pax","title":"pax","text":"<p>\u5982\u679c\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u4f1a\u53d1\u73b0\u4e0a\u9762\u7684 <code>posix_header</code> \u91cc\u9762\uff0c<code>name</code> \u5b57\u6bb5\u53ea\u6709 100 \u4e2a\u5b57\u8282\uff0c<code>prefix</code> \u5b57\u6bb5\u4e5f\u53ea\u6709 155 \u4e2a\u5b57\u8282\uff0c\u610f\u5473\u7740\u5982\u679c\u6587\u4ef6\u8def\u5f84\u7279\u522b\u957f\uff0c\u90a3\u5c31\u653e\u4e0d\u4e0b\uff0c\u53ea\u80fd\u622a\u65ad\u4e86\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cPOSIX.1-2001 \u6807\u51c6\u7ed9 tar \u5f15\u5165\u4e86 PAX \u6269\u5c55\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0cPAX \u6269\u5c55\u4ee5\u7279\u6b8a\u7684\u6587\u4ef6\u5f62\u5f0f\u5b58\u5728\u3002\u4f8b\u5982\u8981\u8bb0\u5f55\u4e00\u4e2a\u540d\u5b57\u5f88\u957f\u7684\u6587\u4ef6 <code>'X'*101</code>\uff0c\u5b9e\u9645\u4e0a tar \u4e2d\u8bb0\u5f55\u4e86\u4e24\u4e2a\u6587\u4ef6\uff1a</p> <ol> <li>PaxHeader\uff1a\u7279\u6b8a\u7684 PAX \u6587\u4ef6\uff0c\u4e0d\u5bf9\u5e94\u5b9e\u9645\u7684\u6587\u4ef6</li> <li><code>'X'*100</code>\uff1a\u6587\u4ef6\u540d\u88ab\u622a\u65ad\uff0c\u5176\u4ed6\u4e0d\u53d8</li> </ol> <p>\u8fd9\u4e2a PaxHeader \u5728\u89e3\u538b\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u751f\u6210\u5b9e\u9645\u7684\u6587\u4ef6\u3002\u5b83\u7684\u5185\u5bb9\u662f\u4e00\u4e9b\u952e\u503c\u5bf9\uff0c\u4f8b\u5982\uff1a</p> <pre><code>123 path=XXXXXXXXXXXXXXXXX...\n</code></pre> <p>\u683c\u5f0f\u662f\uff1a<code>length key=value\\n</code>\uff0c\u7136\u540e\u53ef\u4ee5\u6709\u591a\u4e2a\u8fd9\u6837\u7684\u952e\u503c\u5bf9\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u89e3\u51b3 <code>posix_header</code> \u91cc\u540d\u5b57\u957f\u5ea6\u9650\u5236\u7684\u95ee\u9898\uff1a\u53ea\u8981\u5728 PaxHeader \u6587\u4ef6\u91cc\uff0c\u4fdd\u5b58\u4e00\u4e2a key \u4e3a path\uff0cvalue \u4e3a\u5b9e\u9645\u540d\u5b57\u7684\u4fe1\u606f\u3002\u90a3\u4e48 tar \u5728\u770b\u5230 PaxHeader \u7684\u65f6\u5019\uff0c\u8bb0\u5f55\u4e0b\u6765\uff0c\u518d\u9047\u5230\u4e0b\u4e00\u4e2a\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u5c31\u77e5\u9053\u8981\u7528 PaxHeader \u4e2d\u7684 path\uff0c\u800c\u4e0d\u662f\u4fdd\u5b58\u5728 <code>posix_header</code> \u4e2d\u7684 <code>name[100]</code>\u3002</p> <p>\u7c7b\u4f3c\u5730\uff0cPaxHeader \u8fd8\u53ef\u4ee5\u5b58\u5f88\u591a\u5176\u4ed6 <code>posix_header</code> \u4e2d\u6ca1\u6709\u7684\u4fe1\u606f\uff0c\u4f8b\u5982 <code>atime</code>\u3001<code>ctime</code> \u548c <code>uid</code> \u7b49\u7b49\u3002\u5b8c\u6574\u5217\u8868\u53ef\u4ee5\u53c2\u8003 Extended header keywords\u3002</p> <p>\u5b8c\u6574\u7684 pax \u6269\u5c55\u6587\u6863\uff0c\u53ef\u4ee5\u53c2\u8003 pax interchange format\u3002</p>"},{"location":"software/tar/#_1","title":"\u5e38\u7528\u547d\u4ee4","text":"<p>\u538b\u7f29\uff1a<code>tar cvzf archive.tar.gz &lt;sources&gt;</code></p> <p>\u89e3\u538b\uff1a<code>tar xvf archive.tar.gz</code></p> <p>\u5217\u51fa\u538b\u7f29\u5305\u5185\u5bb9\uff1a<code>tar tvf archive.tar.gz</code></p>"},{"location":"software/tar/#tar_1","title":"\u5176\u4ed6 tar \u683c\u5f0f","text":"<p>\u9664\u4e86\u4e0a\u9762\u7684 ustar \u548c pax \u683c\u5f0f\uff0c\u8fd8\u6709\u66f4\u65e9\u671f\u7684 v7 tar \u683c\u5f0f\uff0c\u53d6\u540d v7 \u662f\u56e0\u4e3a\u6700\u65e9\u51fa\u73b0\u5728 1979 \u5e74 Version 7 Unix \u4e2d\u3002</p> <p>\u6b64\u5916\uff0cGNU tar \u4e5f\u66fe\u7ecf\u81ea\u5b9a\u4e49\u4e86 tar \u683c\u5f0f\uff0cmagic \u4ece\u4e0a\u9762\u7684 <code>ustar</code> \u53d8\u6210\u4e86 <code>ustar</code>\uff08\u6ce8\u610f\u591a\u4e86\u4e24\u4e2a\u7a7a\u683c\uff09\uff1a</p> <pre><code>/* Source: https://www.gnu.org/software/tar/manual/html_node/Standard.html */\n/* The old GNU format header conflicts with POSIX format in such a way that\n   POSIX archives may fool old GNU tar's, and POSIX tar's might well be\n   fooled by old GNU tar archives.  An old GNU format header uses the space\n   used by the prefix field in a POSIX header, and cumulates information\n   normally found in a GNU extra header.  With an old GNU tar header, we\n   never see any POSIX header nor GNU extra header.  Supplementary sparse\n   headers are allowed, however.  */\n\nstruct oldgnu_header\n{                              /* byte offset */\n  char unused_pad1[345];        /*   0 */\n  char atime[12];               /* 345 Incr. archive: atime of the file */\n  char ctime[12];               /* 357 Incr. archive: ctime of the file */\n  char offset[12];              /* 369 Multivolume archive: the offset of\n                                   the start of this volume */\n  char longnames[4];            /* 381 Not used */\n  char unused_pad2;             /* 385 */\n  struct sparse sp[SPARSES_IN_OLDGNU_HEADER];\n                                /* 386 */\n  char isextended;              /* 482 Sparse file: Extension sparse header\n                                   follows */\n  char realsize[12];            /* 483 Sparse file: Real size*/\n                                /* 495 */\n};\n\n/* OLDGNU_MAGIC uses both magic and version fields, which are contiguous.\n   Found in an archive, it indicates an old GNU header format, which will be\n   hopefully become obsolescent.  With OLDGNU_MAGIC, uname and gname are\n   valid, though the header is not truly POSIX conforming.  */\n#define OLDGNU_MAGIC \"ustar  \"  /* 7 chars and a null */\n</code></pre> <p>\u4ee5\u53ca schily tar\uff0c\u7b80\u79f0 star\u3002\u867d\u7136\u5386\u53f2\u4e0a\u51fa\u73b0\u4e86\u4e0d\u517c\u5bb9\u7684 tar \u683c\u5f0f\uff0c\u76ee\u524d\u57fa\u672c\u7edf\u4e00\u5230\u4e86 pax \u683c\u5f0f\u4e0a\u3002</p>"},{"location":"software/transformer/","title":"Transformer","text":"<p>\u4e0b\u9762\u53ea\u8003\u8651 Decoder-only \u7684 Transformer\u3002</p>"},{"location":"software/transformer/#_1","title":"\u8ba1\u7b97\u8fc7\u7a0b","text":"<p>\u8f93\u5165 n \u4e2a Token\uff0c\u901a\u8fc7 Text \u548c Position Embedding \u540e\uff0c\u5f97\u5230\u4e00\u4e2a\u5c3a\u5bf8\u4e3a (n, d_{model}) \u7684\u77e9\u9635\uff0c\u5176\u4e2d d_{model} \u4e3a Embedding \u5411\u91cf\u7684\u957f\u5ea6\u3002</p> <p>\u63a5\u7740\uff0c\u7ecf\u8fc7 n_{layer} \u4e2a\u5c42\uff0c\u6bcf\u5c42\u4e2d\u8981\u8fdb\u884c\u5982\u4e0b\u7684\u8ba1\u7b97\uff1a</p> <ol> <li>\u4ece\u4e0a\u4e00\u5c42\u7684\u8f93\u51fa (n, d_{model})\uff0c\u6bcf\u4e2a head \u4e0a\u4e58\u4ee5\u4e09\u4e2a (d_{model}, d_{head}) \u7684\u77e9\u9635\uff0c\u5f97\u5230 Q\uff0cK \u548c V\uff0c\u5c3a\u5bf8\u4e3a (n, d_{head})</li> <li>\u6309\u7167 attention \u6fc0\u6d3b\u516c\u5f0f\uff0c\u5f97\u5230 Z\uff0c\u5c3a\u5bf8\u4e3a (n, d_{head})</li> <li>\u628a\u6240\u6709 head \u7684 Z \u77e9\u9635\u62fc\u8d77\u6765\uff0c\u4fdd\u8bc1 d_{model} = n_{head} * d_{head}\uff0c\u90a3\u4e48\u6240\u6709\u7684 Z \u62fc\u8d77\u6765\u4ee5\u540e\u5f97\u5230\u7684\u77e9\u9635\u7684\u5c3a\u5bf8\u4e3a (n, d_{head})</li> <li>\u4e58\u4ee5\u4e00\u4e2a\u5c3a\u5bf8\u4e3a (d_{model}, d_{model}) \u7684 Projection \u77e9\u9635\uff0c\u5f97\u5230\u65b0\u77e9\u9635 (n, d_{model})</li> <li>\u7ecf\u8fc7\u4e00\u4e2a MLP\uff0cMLP \u7b2c\u4e00\u5c42\u662f (d_{model}, 4*d_{model})\uff0c\u7b2c\u4e8c\u5c42\u662f (4*d_{model}, d_{model})</li> <li>MLP \u8f93\u51fa\u7684\u77e9\u9635\u5c3a\u5bf8\u4e3a (n, d_{model})</li> </ol>"},{"location":"software/transformer/#kv-cache","title":"KV cache","text":"<p>\u5728\u63a8\u7406\u7684\u65f6\u5019\uff0c\u662f\u5728\u5df2\u6709\u7684 context \u7684\u57fa\u7840\u4e0a\uff0c\u751f\u6210\u4e00\u4e2a\u65b0 token\uff0c\u518d\u628a token \u52a0\u5230 context\uff0c\u7ee7\u7eed\u751f\u6210\u4e0b\u4e00\u4e2a token\u3002\u8ba1\u7b97\u7684\u65f6\u5019\uff0c\u7531\u4e8e Attention \u4f1a\u5e26 Mask\uff0c\u65e7 token \u4e0d\u4f1a\u4f9d\u8d56\u65b0 token\uff0c\u56e0\u6b64\u65e7 token \u7684\u90e8\u5206\u4e0d\u4f1a\u53d8\uff0c\u53ef\u4ee5\u53ea\u8003\u8651\u65b0\u5f15\u5165\u7684 token \u5e26\u6765\u7684\u53d8\u5316\u3002</p> <p>\u90a3\u4e48\uff0c\u8ba1\u7b97\u65b0\u7684 token \u7684 Q K V \u4ee5\u540e\uff0c\u5728\u8fdb\u884c Attention \u8ba1\u7b97\u7684\u65f6\u5019\uff0c\u4f1a\u53d1\u73b0\u5148\u524d\u7684 token \u7684 K \u548c V \u90e8\u5206\u4e0d\u53d8\uff0c\u5148\u524d token \u7684 Q \u4e0d\u5f71\u54cd\u5f53\u524d token \u7684\u7ed3\u679c\u3002\u56e0\u6b64\u53ef\u4ee5\u628a\u4e4b\u524d token \u7684 K \u548c V \u4fdd\u5b58\u4e0b\u6765\uff0c\u4e0d\u7528\u91cd\u65b0\u8ba1\u7b97\uff0c\u8fd9\u5c31\u662f KV cache\u3002</p>"},{"location":"software/transformer/#_2","title":"\u53c2\u6570\u91cf\u548c\u6d6e\u70b9\u8ba1\u7b97\u91cf","text":"<p>\u8003\u8651\u6bcf\u5c42\u7684\u53c2\u6570\u91cf\u548c\u6d6e\u70b9\u8ba1\u7b97\u91cf\uff1a</p> <ol> <li>\u8ba1\u7b97 Q\uff0cK \u548c V\uff1a\u53c2\u6570\u662f\u4e09\u4e2a (d_{model}, d_{model}) \u7684\u77e9\u9635\uff0c\u8ba1\u7b97\u91cf\u662f 2 * 3 * n * d_{model}^2</li> <li>\u4e58\u4ee5 Projection \u77e9\u9635\uff1a\u53c2\u6570\u662f (d_{model}, d_{model}) \u7684\u77e9\u9635\uff0c\u8ba1\u7b97\u91cf\u662f 2 * n * d_{model}^2</li> <li>\u4e58\u4ee5 MLP \u7b2c\u4e00\u5c42\uff1a\u53c2\u6570\u662f (d_{model}, 4*d_{model}) \u7684\u77e9\u9635\uff0c\u8ba1\u7b97\u91cf\u662f 2 * 4 * n * d_{model}^2</li> <li>\u4e58\u4ee5 MLP \u7b2c\u4e8c\u5c42\uff1a\u53c2\u6570\u662f (4*d_{model}, d_{model}) \u7684\u77e9\u9635\uff0c\u8ba1\u7b97\u91cf\u662f 2 * 4 * n * d_{model}^2</li> </ol> <p>\u5176\u4f59\u90e8\u5206\u7684\u53c2\u6570\u91cf\u548c\u8ba1\u7b97\u91cf\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\u3002</p> <p>\u56e0\u6b64\u603b\u53c2\u6570\u91cf\uff08\u4e0d\u8003\u8651 Embedding\uff09\u4e3a\uff1a</p>  12n_{layer}d_{model}^2  <p>\u6bcf\u4e2a Token \u7684\u6d6e\u70b9\u8ba1\u7b97\u91cf\u4e3a\uff1a</p>  24n_{layer}d_{model}^2 \\mathrm{FLOP}"},{"location":"software/transformer/#_3","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>Speeding up the GPT - KV cache</li> <li>\u6700\u65b0\u6700\u5168 GPT-3 \u6a21\u578b\u7f51\u7edc\u7ed3\u6784\u8be6\u7ec6\u89e3\u6790</li> <li>Transformer Inference Arithmetic</li> <li>Understanding FLOPs-per-token estimates from OpenAI\u2019s scaling laws</li> <li>\u62c6 Transformer \u7cfb\u5217\u4e8c\uff1aMulti-Head Attention \u673a\u5236\u8be6\u89e3</li> <li>Past_key_values - why not past_key_values_queries?</li> </ul>"},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/category/blog/","title":"Blog","text":""}]}